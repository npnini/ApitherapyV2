var xU=Object.defineProperty;var bU=(i,e,t)=>e in i?xU(i,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):i[e]=t;var Ir=(i,e,t)=>bU(i,typeof e!="symbol"?e+"":e,t);(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))n(r);new MutationObserver(r=>{for(const s of r)if(s.type==="childList")for(const o of s.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&n(o)}).observe(document,{childList:!0,subtree:!0});function t(r){const s={};return r.integrity&&(s.integrity=r.integrity),r.referrerPolicy&&(s.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?s.credentials="include":r.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function n(r){if(r.ep)return;r.ep=!0;const s=t(r);fetch(r.href,s)}})();function LA(i){return i&&i.__esModule&&Object.prototype.hasOwnProperty.call(i,"default")?i.default:i}var SE={exports:{}},q0={};/**
 * @license React
 * react-jsx-runtime.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var HC;function AU(){if(HC)return q0;HC=1;var i=Symbol.for("react.transitional.element"),e=Symbol.for("react.fragment");function t(n,r,s){var o=null;if(s!==void 0&&(o=""+s),r.key!==void 0&&(o=""+r.key),"key"in r){s={};for(var u in r)u!=="key"&&(s[u]=r[u])}else s=r;return r=s.ref,{$$typeof:i,type:n,key:o,ref:r!==void 0?r:null,props:s}}return q0.Fragment=e,q0.jsx=t,q0.jsxs=t,q0}var GC;function SU(){return GC||(GC=1,SE.exports=AU()),SE.exports}var V=SU(),EE={exports:{}},Pn={};/**
 * @license React
 * react.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var jC;function EU(){if(jC)return Pn;jC=1;var i=Symbol.for("react.transitional.element"),e=Symbol.for("react.portal"),t=Symbol.for("react.fragment"),n=Symbol.for("react.strict_mode"),r=Symbol.for("react.profiler"),s=Symbol.for("react.consumer"),o=Symbol.for("react.context"),u=Symbol.for("react.forward_ref"),f=Symbol.for("react.suspense"),p=Symbol.for("react.memo"),g=Symbol.for("react.lazy"),v=Symbol.for("react.activity"),_=Symbol.iterator;function x($){return $===null||typeof $!="object"?null:($=_&&$[_]||$["@@iterator"],typeof $=="function"?$:null)}var E={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},C=Object.assign,w={};function T($,ae,Se){this.props=$,this.context=ae,this.refs=w,this.updater=Se||E}T.prototype.isReactComponent={},T.prototype.setState=function($,ae){if(typeof $!="object"&&typeof $!="function"&&$!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,$,ae,"setState")},T.prototype.forceUpdate=function($){this.updater.enqueueForceUpdate(this,$,"forceUpdate")};function N(){}N.prototype=T.prototype;function L($,ae,Se){this.props=$,this.context=ae,this.refs=w,this.updater=Se||E}var F=L.prototype=new N;F.constructor=L,C(F,T.prototype),F.isPureReactComponent=!0;var G=Array.isArray;function k(){}var O={H:null,A:null,T:null,S:null},D=Object.prototype.hasOwnProperty;function R($,ae,Se){var ke=Se.ref;return{$$typeof:i,type:$,key:ae,ref:ke!==void 0?ke:null,props:Se}}function P($,ae){return R($.type,ae,$.props)}function z($){return typeof $=="object"&&$!==null&&$.$$typeof===i}function Y($){var ae={"=":"=0",":":"=2"};return"$"+$.replace(/[=:]/g,function(Se){return ae[Se]})}var j=/\/+/g;function ce($,ae){return typeof $=="object"&&$!==null&&$.key!=null?Y(""+$.key):ae.toString(36)}function fe($){switch($.status){case"fulfilled":return $.value;case"rejected":throw $.reason;default:switch(typeof $.status=="string"?$.then(k,k):($.status="pending",$.then(function(ae){$.status==="pending"&&($.status="fulfilled",$.value=ae)},function(ae){$.status==="pending"&&($.status="rejected",$.reason=ae)})),$.status){case"fulfilled":return $.value;case"rejected":throw $.reason}}throw $}function te($,ae,Se,ke,dt){var ve=typeof $;(ve==="undefined"||ve==="boolean")&&($=null);var Le=!1;if($===null)Le=!0;else switch(ve){case"bigint":case"string":case"number":Le=!0;break;case"object":switch($.$$typeof){case i:case e:Le=!0;break;case g:return Le=$._init,te(Le($._payload),ae,Se,ke,dt)}}if(Le)return dt=dt($),Le=ke===""?"."+ce($,0):ke,G(dt)?(Se="",Le!=null&&(Se=Le.replace(j,"$&/")+"/"),te(dt,ae,Se,"",function(Dt){return Dt})):dt!=null&&(z(dt)&&(dt=P(dt,Se+(dt.key==null||$&&$.key===dt.key?"":(""+dt.key).replace(j,"$&/")+"/")+Le)),ae.push(dt)),1;Le=0;var lt=ke===""?".":ke+":";if(G($))for(var _t=0;_t<$.length;_t++)ke=$[_t],ve=lt+ce(ke,_t),Le+=te(ke,ae,Se,ve,dt);else if(_t=x($),typeof _t=="function")for($=_t.call($),_t=0;!(ke=$.next()).done;)ke=ke.value,ve=lt+ce(ke,_t++),Le+=te(ke,ae,Se,ve,dt);else if(ve==="object"){if(typeof $.then=="function")return te(fe($),ae,Se,ke,dt);throw ae=String($),Error("Objects are not valid as a React child (found: "+(ae==="[object Object]"?"object with keys {"+Object.keys($).join(", ")+"}":ae)+"). If you meant to render a collection of children, use an array instead.")}return Le}function se($,ae,Se){if($==null)return $;var ke=[],dt=0;return te($,ke,"","",function(ve){return ae.call(Se,ve,dt++)}),ke}function Ae($){if($._status===-1){var ae=$._result;ae=ae(),ae.then(function(Se){($._status===0||$._status===-1)&&($._status=1,$._result=Se)},function(Se){($._status===0||$._status===-1)&&($._status=2,$._result=Se)}),$._status===-1&&($._status=0,$._result=ae)}if($._status===1)return $._result.default;throw $._result}var Pe=typeof reportError=="function"?reportError:function($){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var ae=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof $=="object"&&$!==null&&typeof $.message=="string"?String($.message):String($),error:$});if(!window.dispatchEvent(ae))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",$);return}console.error($)},Re={map:se,forEach:function($,ae,Se){se($,function(){ae.apply(this,arguments)},Se)},count:function($){var ae=0;return se($,function(){ae++}),ae},toArray:function($){return se($,function(ae){return ae})||[]},only:function($){if(!z($))throw Error("React.Children.only expected to receive a single React element child.");return $}};return Pn.Activity=v,Pn.Children=Re,Pn.Component=T,Pn.Fragment=t,Pn.Profiler=r,Pn.PureComponent=L,Pn.StrictMode=n,Pn.Suspense=f,Pn.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=O,Pn.__COMPILER_RUNTIME={__proto__:null,c:function($){return O.H.useMemoCache($)}},Pn.cache=function($){return function(){return $.apply(null,arguments)}},Pn.cacheSignal=function(){return null},Pn.cloneElement=function($,ae,Se){if($==null)throw Error("The argument must be a React element, but you passed "+$+".");var ke=C({},$.props),dt=$.key;if(ae!=null)for(ve in ae.key!==void 0&&(dt=""+ae.key),ae)!D.call(ae,ve)||ve==="key"||ve==="__self"||ve==="__source"||ve==="ref"&&ae.ref===void 0||(ke[ve]=ae[ve]);var ve=arguments.length-2;if(ve===1)ke.children=Se;else if(1<ve){for(var Le=Array(ve),lt=0;lt<ve;lt++)Le[lt]=arguments[lt+2];ke.children=Le}return R($.type,dt,ke)},Pn.createContext=function($){return $={$$typeof:o,_currentValue:$,_currentValue2:$,_threadCount:0,Provider:null,Consumer:null},$.Provider=$,$.Consumer={$$typeof:s,_context:$},$},Pn.createElement=function($,ae,Se){var ke,dt={},ve=null;if(ae!=null)for(ke in ae.key!==void 0&&(ve=""+ae.key),ae)D.call(ae,ke)&&ke!=="key"&&ke!=="__self"&&ke!=="__source"&&(dt[ke]=ae[ke]);var Le=arguments.length-2;if(Le===1)dt.children=Se;else if(1<Le){for(var lt=Array(Le),_t=0;_t<Le;_t++)lt[_t]=arguments[_t+2];dt.children=lt}if($&&$.defaultProps)for(ke in Le=$.defaultProps,Le)dt[ke]===void 0&&(dt[ke]=Le[ke]);return R($,ve,dt)},Pn.createRef=function(){return{current:null}},Pn.forwardRef=function($){return{$$typeof:u,render:$}},Pn.isValidElement=z,Pn.lazy=function($){return{$$typeof:g,_payload:{_status:-1,_result:$},_init:Ae}},Pn.memo=function($,ae){return{$$typeof:p,type:$,compare:ae===void 0?null:ae}},Pn.startTransition=function($){var ae=O.T,Se={};O.T=Se;try{var ke=$(),dt=O.S;dt!==null&&dt(Se,ke),typeof ke=="object"&&ke!==null&&typeof ke.then=="function"&&ke.then(k,Pe)}catch(ve){Pe(ve)}finally{ae!==null&&Se.types!==null&&(ae.types=Se.types),O.T=ae}},Pn.unstable_useCacheRefresh=function(){return O.H.useCacheRefresh()},Pn.use=function($){return O.H.use($)},Pn.useActionState=function($,ae,Se){return O.H.useActionState($,ae,Se)},Pn.useCallback=function($,ae){return O.H.useCallback($,ae)},Pn.useContext=function($){return O.H.useContext($)},Pn.useDebugValue=function(){},Pn.useDeferredValue=function($,ae){return O.H.useDeferredValue($,ae)},Pn.useEffect=function($,ae){return O.H.useEffect($,ae)},Pn.useEffectEvent=function($){return O.H.useEffectEvent($)},Pn.useId=function(){return O.H.useId()},Pn.useImperativeHandle=function($,ae,Se){return O.H.useImperativeHandle($,ae,Se)},Pn.useInsertionEffect=function($,ae){return O.H.useInsertionEffect($,ae)},Pn.useLayoutEffect=function($,ae){return O.H.useLayoutEffect($,ae)},Pn.useMemo=function($,ae){return O.H.useMemo($,ae)},Pn.useOptimistic=function($,ae){return O.H.useOptimistic($,ae)},Pn.useReducer=function($,ae,Se){return O.H.useReducer($,ae,Se)},Pn.useRef=function($){return O.H.useRef($)},Pn.useState=function($){return O.H.useState($)},Pn.useSyncExternalStore=function($,ae,Se){return O.H.useSyncExternalStore($,ae,Se)},Pn.useTransition=function(){return O.H.useTransition()},Pn.version="19.2.4",Pn}var WC;function iy(){return WC||(WC=1,EE.exports=EU()),EE.exports}var be=iy();const OA=LA(be);var TE={exports:{}},X0={},ME={exports:{}},wE={};/**
 * @license React
 * scheduler.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var qC;function TU(){return qC||(qC=1,(function(i){function e(te,se){var Ae=te.length;te.push(se);e:for(;0<Ae;){var Pe=Ae-1>>>1,Re=te[Pe];if(0<r(Re,se))te[Pe]=se,te[Ae]=Re,Ae=Pe;else break e}}function t(te){return te.length===0?null:te[0]}function n(te){if(te.length===0)return null;var se=te[0],Ae=te.pop();if(Ae!==se){te[0]=Ae;e:for(var Pe=0,Re=te.length,$=Re>>>1;Pe<$;){var ae=2*(Pe+1)-1,Se=te[ae],ke=ae+1,dt=te[ke];if(0>r(Se,Ae))ke<Re&&0>r(dt,Se)?(te[Pe]=dt,te[ke]=Ae,Pe=ke):(te[Pe]=Se,te[ae]=Ae,Pe=ae);else if(ke<Re&&0>r(dt,Ae))te[Pe]=dt,te[ke]=Ae,Pe=ke;else break e}}return se}function r(te,se){var Ae=te.sortIndex-se.sortIndex;return Ae!==0?Ae:te.id-se.id}if(i.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var s=performance;i.unstable_now=function(){return s.now()}}else{var o=Date,u=o.now();i.unstable_now=function(){return o.now()-u}}var f=[],p=[],g=1,v=null,_=3,x=!1,E=!1,C=!1,w=!1,T=typeof setTimeout=="function"?setTimeout:null,N=typeof clearTimeout=="function"?clearTimeout:null,L=typeof setImmediate<"u"?setImmediate:null;function F(te){for(var se=t(p);se!==null;){if(se.callback===null)n(p);else if(se.startTime<=te)n(p),se.sortIndex=se.expirationTime,e(f,se);else break;se=t(p)}}function G(te){if(C=!1,F(te),!E)if(t(f)!==null)E=!0,k||(k=!0,Y());else{var se=t(p);se!==null&&fe(G,se.startTime-te)}}var k=!1,O=-1,D=5,R=-1;function P(){return w?!0:!(i.unstable_now()-R<D)}function z(){if(w=!1,k){var te=i.unstable_now();R=te;var se=!0;try{e:{E=!1,C&&(C=!1,N(O),O=-1),x=!0;var Ae=_;try{t:{for(F(te),v=t(f);v!==null&&!(v.expirationTime>te&&P());){var Pe=v.callback;if(typeof Pe=="function"){v.callback=null,_=v.priorityLevel;var Re=Pe(v.expirationTime<=te);if(te=i.unstable_now(),typeof Re=="function"){v.callback=Re,F(te),se=!0;break t}v===t(f)&&n(f),F(te)}else n(f);v=t(f)}if(v!==null)se=!0;else{var $=t(p);$!==null&&fe(G,$.startTime-te),se=!1}}break e}finally{v=null,_=Ae,x=!1}se=void 0}}finally{se?Y():k=!1}}}var Y;if(typeof L=="function")Y=function(){L(z)};else if(typeof MessageChannel<"u"){var j=new MessageChannel,ce=j.port2;j.port1.onmessage=z,Y=function(){ce.postMessage(null)}}else Y=function(){T(z,0)};function fe(te,se){O=T(function(){te(i.unstable_now())},se)}i.unstable_IdlePriority=5,i.unstable_ImmediatePriority=1,i.unstable_LowPriority=4,i.unstable_NormalPriority=3,i.unstable_Profiling=null,i.unstable_UserBlockingPriority=2,i.unstable_cancelCallback=function(te){te.callback=null},i.unstable_forceFrameRate=function(te){0>te||125<te?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):D=0<te?Math.floor(1e3/te):5},i.unstable_getCurrentPriorityLevel=function(){return _},i.unstable_next=function(te){switch(_){case 1:case 2:case 3:var se=3;break;default:se=_}var Ae=_;_=se;try{return te()}finally{_=Ae}},i.unstable_requestPaint=function(){w=!0},i.unstable_runWithPriority=function(te,se){switch(te){case 1:case 2:case 3:case 4:case 5:break;default:te=3}var Ae=_;_=te;try{return se()}finally{_=Ae}},i.unstable_scheduleCallback=function(te,se,Ae){var Pe=i.unstable_now();switch(typeof Ae=="object"&&Ae!==null?(Ae=Ae.delay,Ae=typeof Ae=="number"&&0<Ae?Pe+Ae:Pe):Ae=Pe,te){case 1:var Re=-1;break;case 2:Re=250;break;case 5:Re=1073741823;break;case 4:Re=1e4;break;default:Re=5e3}return Re=Ae+Re,te={id:g++,callback:se,priorityLevel:te,startTime:Ae,expirationTime:Re,sortIndex:-1},Ae>Pe?(te.sortIndex=Ae,e(p,te),t(f)===null&&te===t(p)&&(C?(N(O),O=-1):C=!0,fe(G,Ae-Pe))):(te.sortIndex=Re,e(f,te),E||x||(E=!0,k||(k=!0,Y()))),te},i.unstable_shouldYield=P,i.unstable_wrapCallback=function(te){var se=_;return function(){var Ae=_;_=se;try{return te.apply(this,arguments)}finally{_=Ae}}}})(wE)),wE}var XC;function DN(){return XC||(XC=1,ME.exports=TU()),ME.exports}var CE={exports:{}},ia={};/**
 * @license React
 * react-dom.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var YC;function MU(){if(YC)return ia;YC=1;var i=iy();function e(f){var p="https://react.dev/errors/"+f;if(1<arguments.length){p+="?args[]="+encodeURIComponent(arguments[1]);for(var g=2;g<arguments.length;g++)p+="&args[]="+encodeURIComponent(arguments[g])}return"Minified React error #"+f+"; visit "+p+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function t(){}var n={d:{f:t,r:function(){throw Error(e(522))},D:t,C:t,L:t,m:t,X:t,S:t,M:t},p:0,findDOMNode:null},r=Symbol.for("react.portal");function s(f,p,g){var v=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:r,key:v==null?null:""+v,children:f,containerInfo:p,implementation:g}}var o=i.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function u(f,p){if(f==="font")return"";if(typeof p=="string")return p==="use-credentials"?p:""}return ia.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=n,ia.createPortal=function(f,p){var g=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!p||p.nodeType!==1&&p.nodeType!==9&&p.nodeType!==11)throw Error(e(299));return s(f,p,null,g)},ia.flushSync=function(f){var p=o.T,g=n.p;try{if(o.T=null,n.p=2,f)return f()}finally{o.T=p,n.p=g,n.d.f()}},ia.preconnect=function(f,p){typeof f=="string"&&(p?(p=p.crossOrigin,p=typeof p=="string"?p==="use-credentials"?p:"":void 0):p=null,n.d.C(f,p))},ia.prefetchDNS=function(f){typeof f=="string"&&n.d.D(f)},ia.preinit=function(f,p){if(typeof f=="string"&&p&&typeof p.as=="string"){var g=p.as,v=u(g,p.crossOrigin),_=typeof p.integrity=="string"?p.integrity:void 0,x=typeof p.fetchPriority=="string"?p.fetchPriority:void 0;g==="style"?n.d.S(f,typeof p.precedence=="string"?p.precedence:void 0,{crossOrigin:v,integrity:_,fetchPriority:x}):g==="script"&&n.d.X(f,{crossOrigin:v,integrity:_,fetchPriority:x,nonce:typeof p.nonce=="string"?p.nonce:void 0})}},ia.preinitModule=function(f,p){if(typeof f=="string")if(typeof p=="object"&&p!==null){if(p.as==null||p.as==="script"){var g=u(p.as,p.crossOrigin);n.d.M(f,{crossOrigin:g,integrity:typeof p.integrity=="string"?p.integrity:void 0,nonce:typeof p.nonce=="string"?p.nonce:void 0})}}else p==null&&n.d.M(f)},ia.preload=function(f,p){if(typeof f=="string"&&typeof p=="object"&&p!==null&&typeof p.as=="string"){var g=p.as,v=u(g,p.crossOrigin);n.d.L(f,g,{crossOrigin:v,integrity:typeof p.integrity=="string"?p.integrity:void 0,nonce:typeof p.nonce=="string"?p.nonce:void 0,type:typeof p.type=="string"?p.type:void 0,fetchPriority:typeof p.fetchPriority=="string"?p.fetchPriority:void 0,referrerPolicy:typeof p.referrerPolicy=="string"?p.referrerPolicy:void 0,imageSrcSet:typeof p.imageSrcSet=="string"?p.imageSrcSet:void 0,imageSizes:typeof p.imageSizes=="string"?p.imageSizes:void 0,media:typeof p.media=="string"?p.media:void 0})}},ia.preloadModule=function(f,p){if(typeof f=="string")if(p){var g=u(p.as,p.crossOrigin);n.d.m(f,{as:typeof p.as=="string"&&p.as!=="script"?p.as:void 0,crossOrigin:g,integrity:typeof p.integrity=="string"?p.integrity:void 0})}else n.d.m(f)},ia.requestFormReset=function(f){n.d.r(f)},ia.unstable_batchedUpdates=function(f,p){return f(p)},ia.useFormState=function(f,p,g){return o.H.useFormState(f,p,g)},ia.useFormStatus=function(){return o.H.useHostTransitionStatus()},ia.version="19.2.4",ia}var JC;function wU(){if(JC)return CE.exports;JC=1;function i(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(i)}catch(e){console.error(e)}}return i(),CE.exports=MU(),CE.exports}/**
 * @license React
 * react-dom-client.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var KC;function CU(){if(KC)return X0;KC=1;var i=DN(),e=iy(),t=wU();function n(a){var l="https://react.dev/errors/"+a;if(1<arguments.length){l+="?args[]="+encodeURIComponent(arguments[1]);for(var d=2;d<arguments.length;d++)l+="&args[]="+encodeURIComponent(arguments[d])}return"Minified React error #"+a+"; visit "+l+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function r(a){return!(!a||a.nodeType!==1&&a.nodeType!==9&&a.nodeType!==11)}function s(a){var l=a,d=a;if(a.alternate)for(;l.return;)l=l.return;else{a=l;do l=a,(l.flags&4098)!==0&&(d=l.return),a=l.return;while(a)}return l.tag===3?d:null}function o(a){if(a.tag===13){var l=a.memoizedState;if(l===null&&(a=a.alternate,a!==null&&(l=a.memoizedState)),l!==null)return l.dehydrated}return null}function u(a){if(a.tag===31){var l=a.memoizedState;if(l===null&&(a=a.alternate,a!==null&&(l=a.memoizedState)),l!==null)return l.dehydrated}return null}function f(a){if(s(a)!==a)throw Error(n(188))}function p(a){var l=a.alternate;if(!l){if(l=s(a),l===null)throw Error(n(188));return l!==a?null:a}for(var d=a,m=l;;){var S=d.return;if(S===null)break;var M=S.alternate;if(M===null){if(m=S.return,m!==null){d=m;continue}break}if(S.child===M.child){for(M=S.child;M;){if(M===d)return f(S),a;if(M===m)return f(S),l;M=M.sibling}throw Error(n(188))}if(d.return!==m.return)d=S,m=M;else{for(var H=!1,Q=S.child;Q;){if(Q===d){H=!0,d=S,m=M;break}if(Q===m){H=!0,m=S,d=M;break}Q=Q.sibling}if(!H){for(Q=M.child;Q;){if(Q===d){H=!0,d=M,m=S;break}if(Q===m){H=!0,m=M,d=S;break}Q=Q.sibling}if(!H)throw Error(n(189))}}if(d.alternate!==m)throw Error(n(190))}if(d.tag!==3)throw Error(n(188));return d.stateNode.current===d?a:l}function g(a){var l=a.tag;if(l===5||l===26||l===27||l===6)return a;for(a=a.child;a!==null;){if(l=g(a),l!==null)return l;a=a.sibling}return null}var v=Object.assign,_=Symbol.for("react.element"),x=Symbol.for("react.transitional.element"),E=Symbol.for("react.portal"),C=Symbol.for("react.fragment"),w=Symbol.for("react.strict_mode"),T=Symbol.for("react.profiler"),N=Symbol.for("react.consumer"),L=Symbol.for("react.context"),F=Symbol.for("react.forward_ref"),G=Symbol.for("react.suspense"),k=Symbol.for("react.suspense_list"),O=Symbol.for("react.memo"),D=Symbol.for("react.lazy"),R=Symbol.for("react.activity"),P=Symbol.for("react.memo_cache_sentinel"),z=Symbol.iterator;function Y(a){return a===null||typeof a!="object"?null:(a=z&&a[z]||a["@@iterator"],typeof a=="function"?a:null)}var j=Symbol.for("react.client.reference");function ce(a){if(a==null)return null;if(typeof a=="function")return a.$$typeof===j?null:a.displayName||a.name||null;if(typeof a=="string")return a;switch(a){case C:return"Fragment";case T:return"Profiler";case w:return"StrictMode";case G:return"Suspense";case k:return"SuspenseList";case R:return"Activity"}if(typeof a=="object")switch(a.$$typeof){case E:return"Portal";case L:return a.displayName||"Context";case N:return(a._context.displayName||"Context")+".Consumer";case F:var l=a.render;return a=a.displayName,a||(a=l.displayName||l.name||"",a=a!==""?"ForwardRef("+a+")":"ForwardRef"),a;case O:return l=a.displayName||null,l!==null?l:ce(a.type)||"Memo";case D:l=a._payload,a=a._init;try{return ce(a(l))}catch{}}return null}var fe=Array.isArray,te=e.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,se=t.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,Ae={pending:!1,data:null,method:null,action:null},Pe=[],Re=-1;function $(a){return{current:a}}function ae(a){0>Re||(a.current=Pe[Re],Pe[Re]=null,Re--)}function Se(a,l){Re++,Pe[Re]=a.current,a.current=l}var ke=$(null),dt=$(null),ve=$(null),Le=$(null);function lt(a,l){switch(Se(ve,l),Se(dt,a),Se(ke,null),l.nodeType){case 9:case 11:a=(a=l.documentElement)&&(a=a.namespaceURI)?hC(a):0;break;default:if(a=l.tagName,l=l.namespaceURI)l=hC(l),a=fC(l,a);else switch(a){case"svg":a=1;break;case"math":a=2;break;default:a=0}}ae(ke),Se(ke,a)}function _t(){ae(ke),ae(dt),ae(ve)}function Dt(a){a.memoizedState!==null&&Se(Le,a);var l=ke.current,d=fC(l,a.type);l!==d&&(Se(dt,a),Se(ke,d))}function qt(a){dt.current===a&&(ae(ke),ae(dt)),Le.current===a&&(ae(Le),H0._currentValue=Ae)}var un,Yt;function qe(a){if(un===void 0)try{throw Error()}catch(d){var l=d.stack.trim().match(/\n( *(at )?)/);un=l&&l[1]||"",Yt=-1<d.stack.indexOf(`
    at`)?" (<anonymous>)":-1<d.stack.indexOf("@")?"@unknown:0:0":""}return`
`+un+a+Yt}var rt=!1;function Je(a,l){if(!a||rt)return"";rt=!0;var d=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var m={DetermineComponentFrameRoot:function(){try{if(l){var st=function(){throw Error()};if(Object.defineProperty(st.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(st,[])}catch(We){var Oe=We}Reflect.construct(a,[],st)}else{try{st.call()}catch(We){Oe=We}a.call(st.prototype)}}else{try{throw Error()}catch(We){Oe=We}(st=a())&&typeof st.catch=="function"&&st.catch(function(){})}}catch(We){if(We&&Oe&&typeof We.stack=="string")return[We.stack,Oe.stack]}return[null,null]}};m.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var S=Object.getOwnPropertyDescriptor(m.DetermineComponentFrameRoot,"name");S&&S.configurable&&Object.defineProperty(m.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var M=m.DetermineComponentFrameRoot(),H=M[0],Q=M[1];if(H&&Q){var de=H.split(`
`),Ne=Q.split(`
`);for(S=m=0;m<de.length&&!de[m].includes("DetermineComponentFrameRoot");)m++;for(;S<Ne.length&&!Ne[S].includes("DetermineComponentFrameRoot");)S++;if(m===de.length||S===Ne.length)for(m=de.length-1,S=Ne.length-1;1<=m&&0<=S&&de[m]!==Ne[S];)S--;for(;1<=m&&0<=S;m--,S--)if(de[m]!==Ne[S]){if(m!==1||S!==1)do if(m--,S--,0>S||de[m]!==Ne[S]){var Ke=`
`+de[m].replace(" at new "," at ");return a.displayName&&Ke.includes("<anonymous>")&&(Ke=Ke.replace("<anonymous>",a.displayName)),Ke}while(1<=m&&0<=S);break}}}finally{rt=!1,Error.prepareStackTrace=d}return(d=a?a.displayName||a.name:"")?qe(d):""}function xt(a,l){switch(a.tag){case 26:case 27:case 5:return qe(a.type);case 16:return qe("Lazy");case 13:return a.child!==l&&l!==null?qe("Suspense Fallback"):qe("Suspense");case 19:return qe("SuspenseList");case 0:case 15:return Je(a.type,!1);case 11:return Je(a.type.render,!1);case 1:return Je(a.type,!0);case 31:return qe("Activity");default:return""}}function re(a){try{var l="",d=null;do l+=xt(a,d),d=a,a=a.return;while(a);return l}catch(m){return`
Error generating stack: `+m.message+`
`+m.stack}}var Lt=Object.prototype.hasOwnProperty,vt=i.unstable_scheduleCallback,Qt=i.unstable_cancelCallback,bt=i.unstable_shouldYield,ee=i.unstable_requestPaint,q=i.unstable_now,ge=i.unstable_getCurrentPriorityLevel,Fe=i.unstable_ImmediatePriority,Xe=i.unstable_UserBlockingPriority,Ue=i.unstable_NormalPriority,Ft=i.unstable_LowPriority,Ct=i.unstable_IdlePriority,Xt=i.log,an=i.unstable_setDisableYieldValue,tt=null,it=null;function Ut(a){if(typeof Xt=="function"&&an(a),it&&typeof it.setStrictMode=="function")try{it.setStrictMode(tt,a)}catch{}}var oe=Math.clz32?Math.clz32:ue,Te=Math.log,ot=Math.LN2;function ue(a){return a>>>=0,a===0?32:31-(Te(a)/ot|0)|0}var Ce=256,at=262144,gt=4194304;function ut(a){var l=a&42;if(l!==0)return l;switch(a&-a){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:return a&261888;case 262144:case 524288:case 1048576:case 2097152:return a&3932160;case 4194304:case 8388608:case 16777216:case 33554432:return a&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return a}}function Ye(a,l,d){var m=a.pendingLanes;if(m===0)return 0;var S=0,M=a.suspendedLanes,H=a.pingedLanes;a=a.warmLanes;var Q=m&134217727;return Q!==0?(m=Q&~M,m!==0?S=ut(m):(H&=Q,H!==0?S=ut(H):d||(d=Q&~a,d!==0&&(S=ut(d))))):(Q=m&~M,Q!==0?S=ut(Q):H!==0?S=ut(H):d||(d=m&~a,d!==0&&(S=ut(d)))),S===0?0:l!==0&&l!==S&&(l&M)===0&&(M=S&-S,d=l&-l,M>=d||M===32&&(d&4194048)!==0)?l:S}function pt(a,l){return(a.pendingLanes&~(a.suspendedLanes&~a.pingedLanes)&l)===0}function rn(a,l){switch(a){case 1:case 2:case 4:case 8:case 64:return l+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return l+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Tn(){var a=gt;return gt<<=1,(gt&62914560)===0&&(gt=4194304),a}function yn(a){for(var l=[],d=0;31>d;d++)l.push(a);return l}function Ii(a,l){a.pendingLanes|=l,l!==268435456&&(a.suspendedLanes=0,a.pingedLanes=0,a.warmLanes=0)}function Xi(a,l,d,m,S,M){var H=a.pendingLanes;a.pendingLanes=d,a.suspendedLanes=0,a.pingedLanes=0,a.warmLanes=0,a.expiredLanes&=d,a.entangledLanes&=d,a.errorRecoveryDisabledLanes&=d,a.shellSuspendCounter=0;var Q=a.entanglements,de=a.expirationTimes,Ne=a.hiddenUpdates;for(d=H&~d;0<d;){var Ke=31-oe(d),st=1<<Ke;Q[Ke]=0,de[Ke]=-1;var Oe=Ne[Ke];if(Oe!==null)for(Ne[Ke]=null,Ke=0;Ke<Oe.length;Ke++){var We=Oe[Ke];We!==null&&(We.lane&=-536870913)}d&=~st}m!==0&&As(a,m,0),M!==0&&S===0&&a.tag!==0&&(a.suspendedLanes|=M&~(H&~l))}function As(a,l,d){a.pendingLanes|=l,a.suspendedLanes&=~l;var m=31-oe(l);a.entangledLanes|=l,a.entanglements[m]=a.entanglements[m]|1073741824|d&261930}function fa(a,l){var d=a.entangledLanes|=l;for(a=a.entanglements;d;){var m=31-oe(d),S=1<<m;S&l|a[m]&l&&(a[m]|=l),d&=~S}}function Ss(a,l){var d=l&-l;return d=(d&42)!==0?1:Ws(d),(d&(a.suspendedLanes|l))!==0?0:d}function Ws(a){switch(a){case 2:a=1;break;case 8:a=4;break;case 32:a=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:a=128;break;case 268435456:a=134217728;break;default:a=0}return a}function fr(a){return a&=-a,2<a?8<a?(a&134217727)!==0?32:268435456:8:2}function Es(){var a=se.p;return a!==0?a:(a=window.event,a===void 0?32:LC(a.type))}function sn(a,l){var d=se.p;try{return se.p=a,l()}finally{se.p=d}}var Br=Math.random().toString(36).slice(2),Si="__reactFiber$"+Br,X="__reactProps$"+Br,Z="__reactContainer$"+Br,he="__reactEvents$"+Br,Ie="__reactListeners$"+Br,He="__reactHandles$"+Br,Ge="__reactResources$"+Br,mt="__reactMarker$"+Br;function ht(a){delete a[Si],delete a[X],delete a[he],delete a[Ie],delete a[He]}function Rt(a){var l=a[Si];if(l)return l;for(var d=a.parentNode;d;){if(l=d[Z]||d[Si]){if(d=l.alternate,l.child!==null||d!==null&&d.child!==null)for(a=_C(a);a!==null;){if(d=a[Si])return d;a=_C(a)}return l}a=d,d=a.parentNode}return null}function Tt(a){if(a=a[Si]||a[Z]){var l=a.tag;if(l===5||l===6||l===13||l===31||l===26||l===27||l===3)return a}return null}function wt(a){var l=a.tag;if(l===5||l===26||l===27||l===6)return a.stateNode;throw Error(n(33))}function Mt(a){var l=a[Ge];return l||(l=a[Ge]={hoistableStyles:new Map,hoistableScripts:new Map}),l}function J(a){a[mt]=!0}var le=new Set,ye={};function xe(a,l){me(a,l),me(a+"Capture",l)}function me(a,l){for(ye[a]=l,a=0;a<l.length;a++)le.add(l[a])}var Qe=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),yt={},Ze={};function Pt(a){return Lt.call(Ze,a)?!0:Lt.call(yt,a)?!1:Qe.test(a)?Ze[a]=!0:(yt[a]=!0,!1)}function It(a,l,d){if(Pt(l))if(d===null)a.removeAttribute(l);else{switch(typeof d){case"undefined":case"function":case"symbol":a.removeAttribute(l);return;case"boolean":var m=l.toLowerCase().slice(0,5);if(m!=="data-"&&m!=="aria-"){a.removeAttribute(l);return}}a.setAttribute(l,""+d)}}function jt(a,l,d){if(d===null)a.removeAttribute(l);else{switch(typeof d){case"undefined":case"function":case"symbol":case"boolean":a.removeAttribute(l);return}a.setAttribute(l,""+d)}}function At(a,l,d,m){if(m===null)a.removeAttribute(d);else{switch(typeof m){case"undefined":case"function":case"symbol":case"boolean":a.removeAttribute(d);return}a.setAttributeNS(l,d,""+m)}}function Vt(a){switch(typeof a){case"bigint":case"boolean":case"number":case"string":case"undefined":return a;case"object":return a;default:return""}}function _n(a){var l=a.type;return(a=a.nodeName)&&a.toLowerCase()==="input"&&(l==="checkbox"||l==="radio")}function Kn(a,l,d){var m=Object.getOwnPropertyDescriptor(a.constructor.prototype,l);if(!a.hasOwnProperty(l)&&typeof m<"u"&&typeof m.get=="function"&&typeof m.set=="function"){var S=m.get,M=m.set;return Object.defineProperty(a,l,{configurable:!0,get:function(){return S.call(this)},set:function(H){d=""+H,M.call(this,H)}}),Object.defineProperty(a,l,{enumerable:m.enumerable}),{getValue:function(){return d},setValue:function(H){d=""+H},stopTracking:function(){a._valueTracker=null,delete a[l]}}}}function Zt(a){if(!a._valueTracker){var l=_n(a)?"checked":"value";a._valueTracker=Kn(a,l,""+a[l])}}function zt(a){if(!a)return!1;var l=a._valueTracker;if(!l)return!0;var d=l.getValue(),m="";return a&&(m=_n(a)?a.checked?"true":"false":a.value),a=m,a!==d?(l.setValue(a),!0):!1}function St(a){if(a=a||(typeof document<"u"?document:void 0),typeof a>"u")return null;try{return a.activeElement||a.body}catch{return a.body}}var en=/[\n"\\]/g;function kt(a){return a.replace(en,function(l){return"\\"+l.charCodeAt(0).toString(16)+" "})}function Qn(a,l,d,m,S,M,H,Q){a.name="",H!=null&&typeof H!="function"&&typeof H!="symbol"&&typeof H!="boolean"?a.type=H:a.removeAttribute("type"),l!=null?H==="number"?(l===0&&a.value===""||a.value!=l)&&(a.value=""+Vt(l)):a.value!==""+Vt(l)&&(a.value=""+Vt(l)):H!=="submit"&&H!=="reset"||a.removeAttribute("value"),l!=null?Ln(a,H,Vt(l)):d!=null?Ln(a,H,Vt(d)):m!=null&&a.removeAttribute("value"),S==null&&M!=null&&(a.defaultChecked=!!M),S!=null&&(a.checked=S&&typeof S!="function"&&typeof S!="symbol"),Q!=null&&typeof Q!="function"&&typeof Q!="symbol"&&typeof Q!="boolean"?a.name=""+Vt(Q):a.removeAttribute("name")}function dr(a,l,d,m,S,M,H,Q){if(M!=null&&typeof M!="function"&&typeof M!="symbol"&&typeof M!="boolean"&&(a.type=M),l!=null||d!=null){if(!(M!=="submit"&&M!=="reset"||l!=null)){Zt(a);return}d=d!=null?""+Vt(d):"",l=l!=null?""+Vt(l):d,Q||l===a.value||(a.value=l),a.defaultValue=l}m=m??S,m=typeof m!="function"&&typeof m!="symbol"&&!!m,a.checked=Q?a.checked:!!m,a.defaultChecked=!!m,H!=null&&typeof H!="function"&&typeof H!="symbol"&&typeof H!="boolean"&&(a.name=H),Zt(a)}function Ln(a,l,d){l==="number"&&St(a.ownerDocument)===a||a.defaultValue===""+d||(a.defaultValue=""+d)}function Di(a,l,d,m){if(a=a.options,l){l={};for(var S=0;S<d.length;S++)l["$"+d[S]]=!0;for(d=0;d<a.length;d++)S=l.hasOwnProperty("$"+a[d].value),a[d].selected!==S&&(a[d].selected=S),S&&m&&(a[d].defaultSelected=!0)}else{for(d=""+Vt(d),l=null,S=0;S<a.length;S++){if(a[S].value===d){a[S].selected=!0,m&&(a[S].defaultSelected=!0);return}l!==null||a[S].disabled||(l=a[S])}l!==null&&(l.selected=!0)}}function ui(a,l,d){if(l!=null&&(l=""+Vt(l),l!==a.value&&(a.value=l),d==null)){a.defaultValue!==l&&(a.defaultValue=l);return}a.defaultValue=d!=null?""+Vt(d):""}function Ui(a,l,d,m){if(l==null){if(m!=null){if(d!=null)throw Error(n(92));if(fe(m)){if(1<m.length)throw Error(n(93));m=m[0]}d=m}d==null&&(d=""),l=d}d=Vt(l),a.defaultValue=d,m=a.textContent,m===d&&m!==""&&m!==null&&(a.value=m),Zt(a)}function Ei(a,l){if(l){var d=a.firstChild;if(d&&d===a.lastChild&&d.nodeType===3){d.nodeValue=l;return}}a.textContent=l}var pr=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function mr(a,l,d){var m=l.indexOf("--")===0;d==null||typeof d=="boolean"||d===""?m?a.setProperty(l,""):l==="float"?a.cssFloat="":a[l]="":m?a.setProperty(l,d):typeof d!="number"||d===0||pr.has(l)?l==="float"?a.cssFloat=d:a[l]=(""+d).trim():a[l]=d+"px"}function To(a,l,d){if(l!=null&&typeof l!="object")throw Error(n(62));if(a=a.style,d!=null){for(var m in d)!d.hasOwnProperty(m)||l!=null&&l.hasOwnProperty(m)||(m.indexOf("--")===0?a.setProperty(m,""):m==="float"?a.cssFloat="":a[m]="");for(var S in l)m=l[S],l.hasOwnProperty(S)&&d[S]!==m&&mr(a,S,m)}else for(var M in l)l.hasOwnProperty(M)&&mr(a,M,l[M])}function Ts(a){if(a.indexOf("-")===-1)return!1;switch(a){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var wf=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),Mo=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function qc(a){return Mo.test(""+a)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":a}function no(){}var Yu=null;function da(a){return a=a.target||a.srcElement||window,a.correspondingUseElement&&(a=a.correspondingUseElement),a.nodeType===3?a.parentNode:a}var hl=null,Ra=null;function Kl(a){var l=Tt(a);if(l&&(a=l.stateNode)){var d=a[X]||null;e:switch(a=l.stateNode,l.type){case"input":if(Qn(a,d.value,d.defaultValue,d.defaultValue,d.checked,d.defaultChecked,d.type,d.name),l=d.name,d.type==="radio"&&l!=null){for(d=a;d.parentNode;)d=d.parentNode;for(d=d.querySelectorAll('input[name="'+kt(""+l)+'"][type="radio"]'),l=0;l<d.length;l++){var m=d[l];if(m!==a&&m.form===a.form){var S=m[X]||null;if(!S)throw Error(n(90));Qn(m,S.value,S.defaultValue,S.defaultValue,S.checked,S.defaultChecked,S.type,S.name)}}for(l=0;l<d.length;l++)m=d[l],m.form===a.form&&zt(m)}break e;case"textarea":ui(a,d.value,d.defaultValue);break e;case"select":l=d.value,l!=null&&Di(a,!!d.multiple,l,!1)}}}var Xc=!1;function fl(a,l,d){if(Xc)return a(l,d);Xc=!0;try{var m=a(l);return m}finally{if(Xc=!1,(hl!==null||Ra!==null)&&(po(),hl&&(l=hl,a=Ra,Ra=hl=null,Kl(l),a)))for(l=0;l<a.length;l++)Kl(a[l])}}function Ia(a,l){var d=a.stateNode;if(d===null)return null;var m=d[X]||null;if(m===null)return null;d=m[l];e:switch(l){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(m=!m.disabled)||(a=a.type,m=!(a==="button"||a==="input"||a==="select"||a==="textarea")),a=!m;break e;default:a=!1}if(a)return null;if(d&&typeof d!="function")throw Error(n(231,l,typeof d));return d}var pa=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Yc=!1;if(pa)try{var _i={};Object.defineProperty(_i,"passive",{get:function(){Yc=!0}}),window.addEventListener("test",_i,_i),window.removeEventListener("test",_i,_i)}catch{Yc=!1}var Ms=null,Ju=null,wo=null;function Ql(){if(wo)return wo;var a,l=Ju,d=l.length,m,S="value"in Ms?Ms.value:Ms.textContent,M=S.length;for(a=0;a<d&&l[a]===S[a];a++);var H=d-a;for(m=1;m<=H&&l[d-m]===S[M-m];m++);return wo=S.slice(a,1<m?1-m:void 0)}function Zl(a){var l=a.keyCode;return"charCode"in a?(a=a.charCode,a===0&&l===13&&(a=13)):a=l,a===10&&(a=13),32<=a||a===13?a:0}function io(){return!0}function ro(){return!1}function Wr(a){function l(d,m,S,M,H){this._reactName=d,this._targetInst=S,this.type=m,this.nativeEvent=M,this.target=H,this.currentTarget=null;for(var Q in a)a.hasOwnProperty(Q)&&(d=a[Q],this[Q]=d?d(M):M[Q]);return this.isDefaultPrevented=(M.defaultPrevented!=null?M.defaultPrevented:M.returnValue===!1)?io:ro,this.isPropagationStopped=ro,this}return v(l.prototype,{preventDefault:function(){this.defaultPrevented=!0;var d=this.nativeEvent;d&&(d.preventDefault?d.preventDefault():typeof d.returnValue!="unknown"&&(d.returnValue=!1),this.isDefaultPrevented=io)},stopPropagation:function(){var d=this.nativeEvent;d&&(d.stopPropagation?d.stopPropagation():typeof d.cancelBubble!="unknown"&&(d.cancelBubble=!0),this.isPropagationStopped=io)},persist:function(){},isPersistent:io}),l}var Co={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(a){return a.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},so=Wr(Co),dl=v({},Co,{view:0,detail:0}),Ku=Wr(dl),Ro,Jc,ao,$l=v({},dl,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:pl,button:0,buttons:0,relatedTarget:function(a){return a.relatedTarget===void 0?a.fromElement===a.srcElement?a.toElement:a.fromElement:a.relatedTarget},movementX:function(a){return"movementX"in a?a.movementX:(a!==ao&&(ao&&a.type==="mousemove"?(Ro=a.screenX-ao.screenX,Jc=a.screenY-ao.screenY):Jc=Ro=0,ao=a),Ro)},movementY:function(a){return"movementY"in a?a.movementY:Jc}}),Qu=Wr($l),ec=v({},$l,{dataTransfer:0}),Cf=Wr(ec),Zu=v({},dl,{relatedTarget:0}),tc=Wr(Zu),$u=v({},Co,{animationName:0,elapsedTime:0,pseudoElement:0}),mp=Wr($u),eh=v({},Co,{clipboardData:function(a){return"clipboardData"in a?a.clipboardData:window.clipboardData}}),Rf=Wr(eh),nc=v({},Co,{data:0}),Da=Wr(nc),Kc={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},If={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Df={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function th(a){var l=this.nativeEvent;return l.getModifierState?l.getModifierState(a):(a=Df[a])?!!l[a]:!1}function pl(){return th}var us=v({},dl,{key:function(a){if(a.key){var l=Kc[a.key]||a.key;if(l!=="Unidentified")return l}return a.type==="keypress"?(a=Zl(a),a===13?"Enter":String.fromCharCode(a)):a.type==="keydown"||a.type==="keyup"?If[a.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:pl,charCode:function(a){return a.type==="keypress"?Zl(a):0},keyCode:function(a){return a.type==="keydown"||a.type==="keyup"?a.keyCode:0},which:function(a){return a.type==="keypress"?Zl(a):a.type==="keydown"||a.type==="keyup"?a.keyCode:0}}),Io=Wr(us),Qc=v({},$l,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Do=Wr(Qc),b=v({},dl,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:pl}),U=Wr(b),W=v({},Co,{propertyName:0,elapsedTime:0,pseudoElement:0}),ne=Wr(W),Ee=v({},$l,{deltaX:function(a){return"deltaX"in a?a.deltaX:"wheelDeltaX"in a?-a.wheelDeltaX:0},deltaY:function(a){return"deltaY"in a?a.deltaY:"wheelDeltaY"in a?-a.wheelDeltaY:"wheelDelta"in a?-a.wheelDelta:0},deltaZ:0,deltaMode:0}),ze=Wr(Ee),Ot=v({},Co,{newState:0,oldState:0}),Cn=Wr(Ot),sr=[9,13,27,32],ei=pa&&"CompositionEvent"in window,Fi=null;pa&&"documentMode"in document&&(Fi=document.documentMode);var ws=pa&&"TextEvent"in window&&!Fi,oo=pa&&(!ei||Fi&&8<Fi&&11>=Fi),lo=" ",qs=!1;function ml(a,l){switch(a){case"keyup":return sr.indexOf(l.keyCode)!==-1;case"keydown":return l.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Zc(a){return a=a.detail,typeof a=="object"&&"data"in a?a.data:null}var $c=!1;function Py(a,l){switch(a){case"compositionend":return Zc(l);case"keypress":return l.which!==32?null:(qs=!0,lo);case"textInput":return a=l.data,a===lo&&qs?null:a;default:return null}}function Pg(a,l){if($c)return a==="compositionend"||!ei&&ml(a,l)?(a=Ql(),wo=Ju=Ms=null,$c=!1,a):null;switch(a){case"paste":return null;case"keypress":if(!(l.ctrlKey||l.altKey||l.metaKey)||l.ctrlKey&&l.altKey){if(l.char&&1<l.char.length)return l.char;if(l.which)return String.fromCharCode(l.which)}return null;case"compositionend":return oo&&l.locale!=="ko"?null:l.data;default:return null}}var Bg={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Lg(a){var l=a&&a.nodeName&&a.nodeName.toLowerCase();return l==="input"?!!Bg[a.type]:l==="textarea"}function gp(a,l,d,m){hl?Ra?Ra.push(m):Ra=[m]:hl=m,l=F_(l,"onChange"),0<l.length&&(d=new so("onChange","change",null,d,m),a.push({event:d,listeners:l}))}var ic=null,eu=null;function By(a){sC(a,0)}function nh(a){var l=wt(a);if(zt(l))return a}function Og(a,l){if(a==="change")return l}var No=!1;if(pa){var Nf;if(pa){var Ug="oninput"in document;if(!Ug){var Fg=document.createElement("div");Fg.setAttribute("oninput","return;"),Ug=typeof Fg.oninput=="function"}Nf=Ug}else Nf=!1;No=Nf&&(!document.documentMode||9<document.documentMode)}function Na(){ic&&(ic.detachEvent("onpropertychange",Pf),eu=ic=null)}function Pf(a){if(a.propertyName==="value"&&nh(eu)){var l=[];gp(l,eu,a,da(a)),fl(By,l)}}function Ly(a,l,d){a==="focusin"?(Na(),ic=l,eu=d,ic.attachEvent("onpropertychange",Pf)):a==="focusout"&&Na()}function kg(a){if(a==="selectionchange"||a==="keyup"||a==="keydown")return nh(eu)}function Oy(a,l){if(a==="click")return nh(l)}function Uy(a,l){if(a==="input"||a==="change")return nh(l)}function zg(a,l){return a===l&&(a!==0||1/a===1/l)||a!==a&&l!==l}var Cs=typeof Object.is=="function"?Object.is:zg;function ih(a,l){if(Cs(a,l))return!0;if(typeof a!="object"||a===null||typeof l!="object"||l===null)return!1;var d=Object.keys(a),m=Object.keys(l);if(d.length!==m.length)return!1;for(m=0;m<d.length;m++){var S=d[m];if(!Lt.call(l,S)||!Cs(a[S],l[S]))return!1}return!0}function Bf(a){for(;a&&a.firstChild;)a=a.firstChild;return a}function rh(a,l){var d=Bf(a);a=0;for(var m;d;){if(d.nodeType===3){if(m=a+d.textContent.length,a<=l&&m>=l)return{node:d,offset:l-a};a=m}e:{for(;d;){if(d.nextSibling){d=d.nextSibling;break e}d=d.parentNode}d=void 0}d=Bf(d)}}function Ni(a,l){return a&&l?a===l?!0:a&&a.nodeType===3?!1:l&&l.nodeType===3?Ni(a,l.parentNode):"contains"in a?a.contains(l):a.compareDocumentPosition?!!(a.compareDocumentPosition(l)&16):!1:!1}function Fy(a){a=a!=null&&a.ownerDocument!=null&&a.ownerDocument.defaultView!=null?a.ownerDocument.defaultView:window;for(var l=St(a.document);l instanceof a.HTMLIFrameElement;){try{var d=typeof l.contentWindow.location.href=="string"}catch{d=!1}if(d)a=l.contentWindow;else break;l=St(a.document)}return l}function Vg(a){var l=a&&a.nodeName&&a.nodeName.toLowerCase();return l&&(l==="input"&&(a.type==="text"||a.type==="search"||a.type==="tel"||a.type==="url"||a.type==="password")||l==="textarea"||a.contentEditable==="true")}var ky=pa&&"documentMode"in document&&11>=document.documentMode,Po=null,Bo=null,sh=null,vp=!1;function ah(a,l,d){var m=d.window===d?d.document:d.nodeType===9?d:d.ownerDocument;vp||Po==null||Po!==St(m)||(m=Po,"selectionStart"in m&&Vg(m)?m={start:m.selectionStart,end:m.selectionEnd}:(m=(m.ownerDocument&&m.ownerDocument.defaultView||window).getSelection(),m={anchorNode:m.anchorNode,anchorOffset:m.anchorOffset,focusNode:m.focusNode,focusOffset:m.focusOffset}),sh&&ih(sh,m)||(sh=m,m=F_(Bo,"onSelect"),0<m.length&&(l=new so("onSelect","select",null,l,d),a.push({event:l,listeners:m}),l.target=Po)))}function hs(a,l){var d={};return d[a.toLowerCase()]=l.toLowerCase(),d["Webkit"+a]="webkit"+l,d["Moz"+a]="moz"+l,d}var tu={animationend:hs("Animation","AnimationEnd"),animationiteration:hs("Animation","AnimationIteration"),animationstart:hs("Animation","AnimationStart"),transitionrun:hs("Transition","TransitionRun"),transitionstart:hs("Transition","TransitionStart"),transitioncancel:hs("Transition","TransitionCancel"),transitionend:hs("Transition","TransitionEnd")},Lf={},Hg={};pa&&(Hg=document.createElement("div").style,"AnimationEvent"in window||(delete tu.animationend.animation,delete tu.animationiteration.animation,delete tu.animationstart.animation),"TransitionEvent"in window||delete tu.transitionend.transition);function gl(a){if(Lf[a])return Lf[a];if(!tu[a])return a;var l=tu[a],d;for(d in l)if(l.hasOwnProperty(d)&&d in Hg)return Lf[a]=l[d];return a}var yp=gl("animationend"),Of=gl("animationiteration"),Gg=gl("animationstart"),zy=gl("transitionrun"),qS=gl("transitionstart"),Vy=gl("transitioncancel"),jg=gl("transitionend"),Pa=new Map,Uf="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");Uf.push("scrollEnd");function Ba(a,l){Pa.set(a,l),xe(l,[a])}var Ff=typeof reportError=="function"?reportError:function(a){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var l=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof a=="object"&&a!==null&&typeof a.message=="string"?String(a.message):String(a),error:a});if(!window.dispatchEvent(l))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",a);return}console.error(a)},La=[],vl=0,qr=0;function kf(){for(var a=vl,l=qr=vl=0;l<a;){var d=La[l];La[l++]=null;var m=La[l];La[l++]=null;var S=La[l];La[l++]=null;var M=La[l];if(La[l++]=null,m!==null&&S!==null){var H=m.pending;H===null?S.next=S:(S.next=H.next,H.next=S),m.pending=S}M!==0&&rc(d,S,M)}}function Xr(a,l,d,m){La[vl++]=a,La[vl++]=l,La[vl++]=d,La[vl++]=m,qr|=m,a.lanes|=m,a=a.alternate,a!==null&&(a.lanes|=m)}function _p(a,l,d,m){return Xr(a,l,d,m),Oa(a)}function Rs(a,l){return Xr(a,null,null,l),Oa(a)}function rc(a,l,d){a.lanes|=d;var m=a.alternate;m!==null&&(m.lanes|=d);for(var S=!1,M=a.return;M!==null;)M.childLanes|=d,m=M.alternate,m!==null&&(m.childLanes|=d),M.tag===22&&(a=M.stateNode,a===null||a._visibility&1||(S=!0)),a=M,M=M.return;return a.tag===3?(M=a.stateNode,S&&l!==null&&(S=31-oe(d),a=M.hiddenUpdates,m=a[S],m===null?a[S]=[l]:m.push(l),l.lane=d|536870912),M):null}function Oa(a){if(50<Sc)throw Sc=0,xu=null,Error(n(185));for(var l=a.return;l!==null;)a=l,l=a.return;return a.tag===3?a.stateNode:null}var sc={};function Wg(a,l,d,m){this.tag=a,this.key=d,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=l,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=m,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Yi(a,l,d,m){return new Wg(a,l,d,m)}function xp(a){return a=a.prototype,!(!a||!a.isReactComponent)}function Xs(a,l){var d=a.alternate;return d===null?(d=Yi(a.tag,l,a.key,a.mode),d.elementType=a.elementType,d.type=a.type,d.stateNode=a.stateNode,d.alternate=a,a.alternate=d):(d.pendingProps=l,d.type=a.type,d.flags=0,d.subtreeFlags=0,d.deletions=null),d.flags=a.flags&65011712,d.childLanes=a.childLanes,d.lanes=a.lanes,d.child=a.child,d.memoizedProps=a.memoizedProps,d.memoizedState=a.memoizedState,d.updateQueue=a.updateQueue,l=a.dependencies,d.dependencies=l===null?null:{lanes:l.lanes,firstContext:l.firstContext},d.sibling=a.sibling,d.index=a.index,d.ref=a.ref,d.refCleanup=a.refCleanup,d}function oh(a,l){a.flags&=65011714;var d=a.alternate;return d===null?(a.childLanes=0,a.lanes=l,a.child=null,a.subtreeFlags=0,a.memoizedProps=null,a.memoizedState=null,a.updateQueue=null,a.dependencies=null,a.stateNode=null):(a.childLanes=d.childLanes,a.lanes=d.lanes,a.child=d.child,a.subtreeFlags=0,a.deletions=null,a.memoizedProps=d.memoizedProps,a.memoizedState=d.memoizedState,a.updateQueue=d.updateQueue,a.type=d.type,l=d.dependencies,a.dependencies=l===null?null:{lanes:l.lanes,firstContext:l.firstContext}),a}function Lo(a,l,d,m,S,M){var H=0;if(m=a,typeof a=="function")xp(a)&&(H=1);else if(typeof a=="string")H=lU(a,d,ke.current)?26:a==="html"||a==="head"||a==="body"?27:5;else e:switch(a){case R:return a=Yi(31,d,l,S),a.elementType=R,a.lanes=M,a;case C:return ac(d.children,S,M,l);case w:H=8,S|=24;break;case T:return a=Yi(12,d,l,S|2),a.elementType=T,a.lanes=M,a;case G:return a=Yi(13,d,l,S),a.elementType=G,a.lanes=M,a;case k:return a=Yi(19,d,l,S),a.elementType=k,a.lanes=M,a;default:if(typeof a=="object"&&a!==null)switch(a.$$typeof){case L:H=10;break e;case N:H=9;break e;case F:H=11;break e;case O:H=14;break e;case D:H=16,m=null;break e}H=29,d=Error(n(130,a===null?"null":typeof a,"")),m=null}return l=Yi(H,d,l,S),l.elementType=a,l.type=m,l.lanes=M,l}function ac(a,l,d,m){return a=Yi(7,a,m,l),a.lanes=d,a}function bp(a,l,d){return a=Yi(6,a,null,l),a.lanes=d,a}function lh(a){var l=Yi(18,null,null,0);return l.stateNode=a,l}function Ap(a,l,d){return l=Yi(4,a.children!==null?a.children:[],a.key,l),l.lanes=d,l.stateNode={containerInfo:a.containerInfo,pendingChildren:null,implementation:a.implementation},l}var zf=new WeakMap;function ma(a,l){if(typeof a=="object"&&a!==null){var d=zf.get(a);return d!==void 0?d:(l={value:a,source:l,stack:re(l)},zf.set(a,l),l)}return{value:a,source:l,stack:re(l)}}var oc=[],lc=0,ch=null,uh=0,Ys=[],Hi=0,yl=null,Ji=1,co="";function Oo(a,l){oc[lc++]=uh,oc[lc++]=ch,ch=a,uh=l}function Hy(a,l,d){Ys[Hi++]=Ji,Ys[Hi++]=co,Ys[Hi++]=yl,yl=a;var m=Ji;a=co;var S=32-oe(m)-1;m&=~(1<<S),d+=1;var M=32-oe(l)+S;if(30<M){var H=S-S%5;M=(m&(1<<H)-1).toString(32),m>>=H,S-=H,Ji=1<<32-oe(l)+S|d<<S|m,co=M+a}else Ji=1<<M|d<<S|m,co=a}function Uo(a){a.return!==null&&(Oo(a,1),Hy(a,1,0))}function Sp(a){for(;a===ch;)ch=oc[--lc],oc[lc]=null,uh=oc[--lc],oc[lc]=null;for(;a===yl;)yl=Ys[--Hi],Ys[Hi]=null,co=Ys[--Hi],Ys[Hi]=null,Ji=Ys[--Hi],Ys[Hi]=null}function Ep(a,l){Ys[Hi++]=Ji,Ys[Hi++]=co,Ys[Hi++]=yl,Ji=l.id,co=l.overflow,yl=a}var ar=null,Pi=null,Zn=!1,_l=null,ga=!1,hh=Error(n(519));function Fo(a){var l=Error(n(418,1<arguments.length&&arguments[1]!==void 0&&arguments[1]?"text":"HTML",""));throw ko(ma(l,a)),hh}function Gy(a){var l=a.stateNode,d=a.type,m=a.memoizedProps;switch(l[Si]=a,l[X]=m,d){case"dialog":ni("cancel",l),ni("close",l);break;case"iframe":case"object":case"embed":ni("load",l);break;case"video":case"audio":for(d=0;d<Ja.length;d++)ni(Ja[d],l);break;case"source":ni("error",l);break;case"img":case"image":case"link":ni("error",l),ni("load",l);break;case"details":ni("toggle",l);break;case"input":ni("invalid",l),dr(l,m.value,m.defaultValue,m.checked,m.defaultChecked,m.type,m.name,!0);break;case"select":ni("invalid",l);break;case"textarea":ni("invalid",l),Ui(l,m.value,m.defaultValue,m.children)}d=m.children,typeof d!="string"&&typeof d!="number"&&typeof d!="bigint"||l.textContent===""+d||m.suppressHydrationWarning===!0||cC(l.textContent,d)?(m.popover!=null&&(ni("beforetoggle",l),ni("toggle",l)),m.onScroll!=null&&ni("scroll",l),m.onScrollEnd!=null&&ni("scrollend",l),m.onClick!=null&&(l.onclick=no),l=!0):l=!1,l||Fo(a,!0)}function jy(a){for(ar=a.return;ar;)switch(ar.tag){case 5:case 31:case 13:ga=!1;return;case 27:case 3:ga=!0;return;default:ar=ar.return}}function fh(a){if(a!==ar)return!1;if(!Zn)return jy(a),Zn=!0,!1;var l=a.tag,d;if((d=l!==3&&l!==27)&&((d=l===5)&&(d=a.type,d=!(d!=="form"&&d!=="button")||lE(a.type,a.memoizedProps)),d=!d),d&&Pi&&Fo(a),jy(a),l===13){if(a=a.memoizedState,a=a!==null?a.dehydrated:null,!a)throw Error(n(317));Pi=yC(a)}else if(l===31){if(a=a.memoizedState,a=a!==null?a.dehydrated:null,!a)throw Error(n(317));Pi=yC(a)}else l===27?(l=Pi,Nh(a.type)?(a=dE,dE=null,Pi=a):Pi=l):Pi=ar?$o(a.stateNode.nextSibling):null;return!0}function cc(){Pi=ar=null,Zn=!1}function Tp(){var a=_l;return a!==null&&(lr===null?lr=a:lr.push.apply(lr,a),_l=null),a}function ko(a){_l===null?_l=[a]:_l.push(a)}var dh=$(null),uc=null,zo=null;function xl(a,l,d){Se(dh,l._currentValue),l._currentValue=d}function Vo(a){a._currentValue=dh.current,ae(dh)}function Mp(a,l,d){for(;a!==null;){var m=a.alternate;if((a.childLanes&l)!==l?(a.childLanes|=l,m!==null&&(m.childLanes|=l)):m!==null&&(m.childLanes&l)!==l&&(m.childLanes|=l),a===d)break;a=a.return}}function wp(a,l,d,m){var S=a.child;for(S!==null&&(S.return=a);S!==null;){var M=S.dependencies;if(M!==null){var H=S.child;M=M.firstContext;e:for(;M!==null;){var Q=M;M=S;for(var de=0;de<l.length;de++)if(Q.context===l[de]){M.lanes|=d,Q=M.alternate,Q!==null&&(Q.lanes|=d),Mp(M.return,d,a),m||(H=null);break e}M=Q.next}}else if(S.tag===18){if(H=S.return,H===null)throw Error(n(341));H.lanes|=d,M=H.alternate,M!==null&&(M.lanes|=d),Mp(H,d,a),H=null}else H=S.child;if(H!==null)H.return=S;else for(H=S;H!==null;){if(H===a){H=null;break}if(S=H.sibling,S!==null){S.return=H.return,H=S;break}H=H.return}S=H}}function Ho(a,l,d,m){a=null;for(var S=l,M=!1;S!==null;){if(!M){if((S.flags&524288)!==0)M=!0;else if((S.flags&262144)!==0)break}if(S.tag===10){var H=S.alternate;if(H===null)throw Error(n(387));if(H=H.memoizedProps,H!==null){var Q=S.type;Cs(S.pendingProps.value,H.value)||(a!==null?a.push(Q):a=[Q])}}else if(S===Le.current){if(H=S.alternate,H===null)throw Error(n(387));H.memoizedState.memoizedState!==S.memoizedState.memoizedState&&(a!==null?a.push(H0):a=[H0])}S=S.return}a!==null&&wp(l,a,d,m),l.flags|=262144}function Vf(a){for(a=a.firstContext;a!==null;){if(!Cs(a.context._currentValue,a.memoizedValue))return!0;a=a.next}return!1}function hc(a){uc=a,zo=null,a=a.dependencies,a!==null&&(a.firstContext=null)}function bn(a){return Wy(uc,a)}function ph(a,l){return uc===null&&hc(a),Wy(a,l)}function Wy(a,l){var d=l._currentValue;if(l={context:l,memoizedValue:d,next:null},zo===null){if(a===null)throw Error(n(308));zo=l,a.dependencies={lanes:0,firstContext:l},a.flags|=524288}else zo=zo.next=l;return d}var qy=typeof AbortController<"u"?AbortController:function(){var a=[],l=this.signal={aborted:!1,addEventListener:function(d,m){a.push(m)}};this.abort=function(){l.aborted=!0,a.forEach(function(d){return d()})}},XS=i.unstable_scheduleCallback,YS=i.unstable_NormalPriority,Mr={$$typeof:L,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function qg(){return{controller:new qy,data:new Map,refCount:0}}function nu(a){a.refCount--,a.refCount===0&&XS(YS,function(){a.controller.abort()})}var va=null,Cp=0,bl=0,Ua=null;function Xg(a,l){if(va===null){var d=va=[];Cp=0,bl=Ve(),Ua={status:"pending",value:void 0,then:function(m){d.push(m)}}}return Cp++,l.then(Yg,Yg),l}function Yg(){if(--Cp===0&&va!==null){Ua!==null&&(Ua.status="fulfilled");var a=va;va=null,bl=0,Ua=null;for(var l=0;l<a.length;l++)(0,a[l])()}}function Jg(a,l){var d=[],m={status:"pending",value:null,reason:null,then:function(S){d.push(S)}};return a.then(function(){m.status="fulfilled",m.value=l;for(var S=0;S<d.length;S++)(0,d[S])(l)},function(S){for(m.status="rejected",m.reason=S,S=0;S<d.length;S++)(0,d[S])(void 0)}),m}var Xy=te.S;te.S=function(a,l){O0=q(),typeof l=="object"&&l!==null&&typeof l.then=="function"&&Xg(a,l),Xy!==null&&Xy(a,l)};var fc=$(null);function Rp(){var a=fc.current;return a!==null?a:En.pooledCache}function Hf(a,l){l===null?Se(fc,fc.current):Se(fc,l.pool)}function Kg(){var a=Rp();return a===null?null:{parent:Mr._currentValue,pool:a}}var iu=Error(n(460)),Gf=Error(n(474)),Fn=Error(n(542)),Ip={then:function(){}};function Js(a){return a=a.status,a==="fulfilled"||a==="rejected"}function Dp(a,l,d){switch(d=a[d],d===void 0?a.push(l):d!==l&&(l.then(no,no),l=d),l.status){case"fulfilled":return l.value;case"rejected":throw a=l.reason,au(a),a;default:if(typeof l.status=="string")l.then(no,no);else{if(a=En,a!==null&&100<a.shellSuspendCounter)throw Error(n(482));a=l,a.status="pending",a.then(function(m){if(l.status==="pending"){var S=l;S.status="fulfilled",S.value=m}},function(m){if(l.status==="pending"){var S=l;S.status="rejected",S.reason=m}})}switch(l.status){case"fulfilled":return l.value;case"rejected":throw a=l.reason,au(a),a}throw Go=l,iu}}function ru(a){try{var l=a._init;return l(a._payload)}catch(d){throw d!==null&&typeof d=="object"&&typeof d.then=="function"?(Go=d,iu):d}}var Go=null;function su(){if(Go===null)throw Error(n(459));var a=Go;return Go=null,a}function au(a){if(a===iu||a===Fn)throw Error(n(483))}var ou=null,lu=0;function jf(a){var l=lu;return lu+=1,ou===null&&(ou=[]),Dp(ou,a,l)}function Fa(a,l){l=l.props.ref,a.ref=l!==void 0?l:null}function mh(a,l){throw l.$$typeof===_?Error(n(525)):(a=Object.prototype.toString.call(l),Error(n(31,a==="[object Object]"?"object with keys {"+Object.keys(l).join(", ")+"}":a)))}function Np(a){function l(Me,_e){if(a){var De=Me.deletions;De===null?(Me.deletions=[_e],Me.flags|=16):De.push(_e)}}function d(Me,_e){if(!a)return null;for(;_e!==null;)l(Me,_e),_e=_e.sibling;return null}function m(Me){for(var _e=new Map;Me!==null;)Me.key!==null?_e.set(Me.key,Me):_e.set(Me.index,Me),Me=Me.sibling;return _e}function S(Me,_e){return Me=Xs(Me,_e),Me.index=0,Me.sibling=null,Me}function M(Me,_e,De){return Me.index=De,a?(De=Me.alternate,De!==null?(De=De.index,De<_e?(Me.flags|=67108866,_e):De):(Me.flags|=67108866,_e)):(Me.flags|=1048576,_e)}function H(Me){return a&&Me.alternate===null&&(Me.flags|=67108866),Me}function Q(Me,_e,De,et){return _e===null||_e.tag!==6?(_e=bp(De,Me.mode,et),_e.return=Me,_e):(_e=S(_e,De),_e.return=Me,_e)}function de(Me,_e,De,et){var fn=De.type;return fn===C?Ke(Me,_e,De.props.children,et,De.key):_e!==null&&(_e.elementType===fn||typeof fn=="object"&&fn!==null&&fn.$$typeof===D&&ru(fn)===_e.type)?(_e=S(_e,De.props),Fa(_e,De),_e.return=Me,_e):(_e=Lo(De.type,De.key,De.props,null,Me.mode,et),Fa(_e,De),_e.return=Me,_e)}function Ne(Me,_e,De,et){return _e===null||_e.tag!==4||_e.stateNode.containerInfo!==De.containerInfo||_e.stateNode.implementation!==De.implementation?(_e=Ap(De,Me.mode,et),_e.return=Me,_e):(_e=S(_e,De.children||[]),_e.return=Me,_e)}function Ke(Me,_e,De,et,fn){return _e===null||_e.tag!==7?(_e=ac(De,Me.mode,et,fn),_e.return=Me,_e):(_e=S(_e,De),_e.return=Me,_e)}function st(Me,_e,De){if(typeof _e=="string"&&_e!==""||typeof _e=="number"||typeof _e=="bigint")return _e=bp(""+_e,Me.mode,De),_e.return=Me,_e;if(typeof _e=="object"&&_e!==null){switch(_e.$$typeof){case x:return De=Lo(_e.type,_e.key,_e.props,null,Me.mode,De),Fa(De,_e),De.return=Me,De;case E:return _e=Ap(_e,Me.mode,De),_e.return=Me,_e;case D:return _e=ru(_e),st(Me,_e,De)}if(fe(_e)||Y(_e))return _e=ac(_e,Me.mode,De,null),_e.return=Me,_e;if(typeof _e.then=="function")return st(Me,jf(_e),De);if(_e.$$typeof===L)return st(Me,ph(Me,_e),De);mh(Me,_e)}return null}function Oe(Me,_e,De,et){var fn=_e!==null?_e.key:null;if(typeof De=="string"&&De!==""||typeof De=="number"||typeof De=="bigint")return fn!==null?null:Q(Me,_e,""+De,et);if(typeof De=="object"&&De!==null){switch(De.$$typeof){case x:return De.key===fn?de(Me,_e,De,et):null;case E:return De.key===fn?Ne(Me,_e,De,et):null;case D:return De=ru(De),Oe(Me,_e,De,et)}if(fe(De)||Y(De))return fn!==null?null:Ke(Me,_e,De,et,null);if(typeof De.then=="function")return Oe(Me,_e,jf(De),et);if(De.$$typeof===L)return Oe(Me,_e,ph(Me,De),et);mh(Me,De)}return null}function We(Me,_e,De,et,fn){if(typeof et=="string"&&et!==""||typeof et=="number"||typeof et=="bigint")return Me=Me.get(De)||null,Q(_e,Me,""+et,fn);if(typeof et=="object"&&et!==null){switch(et.$$typeof){case x:return Me=Me.get(et.key===null?De:et.key)||null,de(_e,Me,et,fn);case E:return Me=Me.get(et.key===null?De:et.key)||null,Ne(_e,Me,et,fn);case D:return et=ru(et),We(Me,_e,De,et,fn)}if(fe(et)||Y(et))return Me=Me.get(De)||null,Ke(_e,Me,et,fn,null);if(typeof et.then=="function")return We(Me,_e,De,jf(et),fn);if(et.$$typeof===L)return We(Me,_e,De,ph(_e,et),fn);mh(_e,et)}return null}function nn(Me,_e,De,et){for(var fn=null,vi=null,on=_e,Hn=_e=0,si=null;on!==null&&Hn<De.length;Hn++){on.index>Hn?(si=on,on=null):si=on.sibling;var yi=Oe(Me,on,De[Hn],et);if(yi===null){on===null&&(on=si);break}a&&on&&yi.alternate===null&&l(Me,on),_e=M(yi,_e,Hn),vi===null?fn=yi:vi.sibling=yi,vi=yi,on=si}if(Hn===De.length)return d(Me,on),Zn&&Oo(Me,Hn),fn;if(on===null){for(;Hn<De.length;Hn++)on=st(Me,De[Hn],et),on!==null&&(_e=M(on,_e,Hn),vi===null?fn=on:vi.sibling=on,vi=on);return Zn&&Oo(Me,Hn),fn}for(on=m(on);Hn<De.length;Hn++)si=We(on,Me,Hn,De[Hn],et),si!==null&&(a&&si.alternate!==null&&on.delete(si.key===null?Hn:si.key),_e=M(si,_e,Hn),vi===null?fn=si:vi.sibling=si,vi=si);return a&&on.forEach(function(Uh){return l(Me,Uh)}),Zn&&Oo(Me,Hn),fn}function xn(Me,_e,De,et){if(De==null)throw Error(n(151));for(var fn=null,vi=null,on=_e,Hn=_e=0,si=null,yi=De.next();on!==null&&!yi.done;Hn++,yi=De.next()){on.index>Hn?(si=on,on=null):si=on.sibling;var Uh=Oe(Me,on,yi.value,et);if(Uh===null){on===null&&(on=si);break}a&&on&&Uh.alternate===null&&l(Me,on),_e=M(Uh,_e,Hn),vi===null?fn=Uh:vi.sibling=Uh,vi=Uh,on=si}if(yi.done)return d(Me,on),Zn&&Oo(Me,Hn),fn;if(on===null){for(;!yi.done;Hn++,yi=De.next())yi=st(Me,yi.value,et),yi!==null&&(_e=M(yi,_e,Hn),vi===null?fn=yi:vi.sibling=yi,vi=yi);return Zn&&Oo(Me,Hn),fn}for(on=m(on);!yi.done;Hn++,yi=De.next())yi=We(on,Me,Hn,yi.value,et),yi!==null&&(a&&yi.alternate!==null&&on.delete(yi.key===null?Hn:yi.key),_e=M(yi,_e,Hn),vi===null?fn=yi:vi.sibling=yi,vi=yi);return a&&on.forEach(function(_U){return l(Me,_U)}),Zn&&Oo(Me,Hn),fn}function Oi(Me,_e,De,et){if(typeof De=="object"&&De!==null&&De.type===C&&De.key===null&&(De=De.props.children),typeof De=="object"&&De!==null){switch(De.$$typeof){case x:e:{for(var fn=De.key;_e!==null;){if(_e.key===fn){if(fn=De.type,fn===C){if(_e.tag===7){d(Me,_e.sibling),et=S(_e,De.props.children),et.return=Me,Me=et;break e}}else if(_e.elementType===fn||typeof fn=="object"&&fn!==null&&fn.$$typeof===D&&ru(fn)===_e.type){d(Me,_e.sibling),et=S(_e,De.props),Fa(et,De),et.return=Me,Me=et;break e}d(Me,_e);break}else l(Me,_e);_e=_e.sibling}De.type===C?(et=ac(De.props.children,Me.mode,et,De.key),et.return=Me,Me=et):(et=Lo(De.type,De.key,De.props,null,Me.mode,et),Fa(et,De),et.return=Me,Me=et)}return H(Me);case E:e:{for(fn=De.key;_e!==null;){if(_e.key===fn)if(_e.tag===4&&_e.stateNode.containerInfo===De.containerInfo&&_e.stateNode.implementation===De.implementation){d(Me,_e.sibling),et=S(_e,De.children||[]),et.return=Me,Me=et;break e}else{d(Me,_e);break}else l(Me,_e);_e=_e.sibling}et=Ap(De,Me.mode,et),et.return=Me,Me=et}return H(Me);case D:return De=ru(De),Oi(Me,_e,De,et)}if(fe(De))return nn(Me,_e,De,et);if(Y(De)){if(fn=Y(De),typeof fn!="function")throw Error(n(150));return De=fn.call(De),xn(Me,_e,De,et)}if(typeof De.then=="function")return Oi(Me,_e,jf(De),et);if(De.$$typeof===L)return Oi(Me,_e,ph(Me,De),et);mh(Me,De)}return typeof De=="string"&&De!==""||typeof De=="number"||typeof De=="bigint"?(De=""+De,_e!==null&&_e.tag===6?(d(Me,_e.sibling),et=S(_e,De),et.return=Me,Me=et):(d(Me,_e),et=bp(De,Me.mode,et),et.return=Me,Me=et),H(Me)):d(Me,_e)}return function(Me,_e,De,et){try{lu=0;var fn=Oi(Me,_e,De,et);return ou=null,fn}catch(on){if(on===iu||on===Fn)throw on;var vi=Yi(29,on,null,Me.mode);return vi.lanes=et,vi.return=Me,vi}finally{}}}var Al=Np(!0),Pp=Np(!1),Is=!1;function Wf(a){a.updateQueue={baseState:a.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function Qg(a,l){a=a.updateQueue,l.updateQueue===a&&(l.updateQueue={baseState:a.baseState,firstBaseUpdate:a.firstBaseUpdate,lastBaseUpdate:a.lastBaseUpdate,shared:a.shared,callbacks:null})}function Sl(a){return{lane:a,tag:0,payload:null,callback:null,next:null}}function dc(a,l,d){var m=a.updateQueue;if(m===null)return null;if(m=m.shared,(ln&2)!==0){var S=m.pending;return S===null?l.next=l:(l.next=S.next,S.next=l),m.pending=l,l=Oa(a),rc(a,null,d),l}return Xr(a,m,l,d),Oa(a)}function pc(a,l,d){if(l=l.updateQueue,l!==null&&(l=l.shared,(d&4194048)!==0)){var m=l.lanes;m&=a.pendingLanes,d|=m,l.lanes=d,fa(a,d)}}function hn(a,l){var d=a.updateQueue,m=a.alternate;if(m!==null&&(m=m.updateQueue,d===m)){var S=null,M=null;if(d=d.firstBaseUpdate,d!==null){do{var H={lane:d.lane,tag:d.tag,payload:d.payload,callback:null,next:null};M===null?S=M=H:M=M.next=H,d=d.next}while(d!==null);M===null?S=M=l:M=M.next=l}else S=M=l;d={baseState:m.baseState,firstBaseUpdate:S,lastBaseUpdate:M,shared:m.shared,callbacks:m.callbacks},a.updateQueue=d;return}a=d.lastBaseUpdate,a===null?d.firstBaseUpdate=l:a.next=l,d.lastBaseUpdate=l}var Zg=!1;function qf(){if(Zg){var a=Ua;if(a!==null)throw a}}function gh(a,l,d,m){Zg=!1;var S=a.updateQueue;Is=!1;var M=S.firstBaseUpdate,H=S.lastBaseUpdate,Q=S.shared.pending;if(Q!==null){S.shared.pending=null;var de=Q,Ne=de.next;de.next=null,H===null?M=Ne:H.next=Ne,H=de;var Ke=a.alternate;Ke!==null&&(Ke=Ke.updateQueue,Q=Ke.lastBaseUpdate,Q!==H&&(Q===null?Ke.firstBaseUpdate=Ne:Q.next=Ne,Ke.lastBaseUpdate=de))}if(M!==null){var st=S.baseState;H=0,Ke=Ne=de=null,Q=M;do{var Oe=Q.lane&-536870913,We=Oe!==Q.lane;if(We?(On&Oe)===Oe:(m&Oe)===Oe){Oe!==0&&Oe===bl&&(Zg=!0),Ke!==null&&(Ke=Ke.next={lane:0,tag:Q.tag,payload:Q.payload,callback:null,next:null});e:{var nn=a,xn=Q;Oe=l;var Oi=d;switch(xn.tag){case 1:if(nn=xn.payload,typeof nn=="function"){st=nn.call(Oi,st,Oe);break e}st=nn;break e;case 3:nn.flags=nn.flags&-65537|128;case 0:if(nn=xn.payload,Oe=typeof nn=="function"?nn.call(Oi,st,Oe):nn,Oe==null)break e;st=v({},st,Oe);break e;case 2:Is=!0}}Oe=Q.callback,Oe!==null&&(a.flags|=64,We&&(a.flags|=8192),We=S.callbacks,We===null?S.callbacks=[Oe]:We.push(Oe))}else We={lane:Oe,tag:Q.tag,payload:Q.payload,callback:Q.callback,next:null},Ke===null?(Ne=Ke=We,de=st):Ke=Ke.next=We,H|=Oe;if(Q=Q.next,Q===null){if(Q=S.shared.pending,Q===null)break;We=Q,Q=We.next,We.next=null,S.lastBaseUpdate=We,S.shared.pending=null}}while(!0);Ke===null&&(de=st),S.baseState=de,S.firstBaseUpdate=Ne,S.lastBaseUpdate=Ke,M===null&&(S.shared.lanes=0),Ko|=H,a.lanes=H,a.memoizedState=st}}function vh(a,l){if(typeof a!="function")throw Error(n(191,a));a.call(l)}function Yy(a,l){var d=a.callbacks;if(d!==null)for(a.callbacks=null,a=0;a<d.length;a++)vh(d[a],l)}var yh=$(null),Bp=$(0);function Jy(a,l){a=ba,Se(Bp,a),Se(yh,l),ba=a|l.baseLanes}function $g(){Se(Bp,ba),Se(yh,yh.current)}function Xf(){ba=Bp.current,ae(yh),ae(Bp)}var Ks=$(null),Ds=null;function El(a){var l=a.alternate;Se($n,$n.current&1),Se(Ks,a),Ds===null&&(l===null||yh.current!==null||l.memoizedState!==null)&&(Ds=a)}function e0(a){Se($n,$n.current),Se(Ks,a),Ds===null&&(Ds=a)}function Ky(a){a.tag===22?(Se($n,$n.current),Se(Ks,a),Ds===null&&(Ds=a)):Qs()}function Qs(){Se($n,$n.current),Se(Ks,Ks.current)}function gr(a){ae(Ks),Ds===a&&(Ds=null),ae($n)}var $n=$(0);function ya(a){for(var l=a;l!==null;){if(l.tag===13){var d=l.memoizedState;if(d!==null&&(d=d.dehydrated,d===null||hE(d)||fE(d)))return l}else if(l.tag===19&&(l.memoizedProps.revealOrder==="forwards"||l.memoizedProps.revealOrder==="backwards"||l.memoizedProps.revealOrder==="unstable_legacy-backwards"||l.memoizedProps.revealOrder==="together")){if((l.flags&128)!==0)return l}else if(l.child!==null){l.child.return=l,l=l.child;continue}if(l===a)break;for(;l.sibling===null;){if(l.return===null||l.return===a)return null;l=l.return}l.sibling.return=l.return,l=l.sibling}return null}var Gi=0,Dn=null,Ti=null,qn=null,ka=!1,_h=!1,cu=!1,Lp=0,Yf=0,xh=null,t0=0;function Ki(){throw Error(n(321))}function n0(a,l){if(l===null)return!1;for(var d=0;d<l.length&&d<a.length;d++)if(!Cs(a[d],l[d]))return!1;return!0}function Op(a,l,d,m,S,M){return Gi=M,Dn=l,l.memoizedState=null,l.updateQueue=null,l.lanes=0,te.H=a===null||a.memoizedState===null?C_:A0,cu=!1,M=d(m,S),cu=!1,_h&&(M=uu(l,d,m,S)),Qy(a),M}function Qy(a){te.H=bh;var l=Ti!==null&&Ti.next!==null;if(Gi=0,qn=Ti=Dn=null,ka=!1,Yf=0,xh=null,l)throw Error(n(300));a===null||wr||(a=a.dependencies,a!==null&&Vf(a)&&(wr=!0))}function uu(a,l,d,m){Dn=a;var S=0;do{if(_h&&(xh=null),Yf=0,_h=!1,25<=S)throw Error(n(301));if(S+=1,qn=Ti=null,a.updateQueue!=null){var M=a.updateQueue;M.lastEffect=null,M.events=null,M.stores=null,M.memoCache!=null&&(M.memoCache.index=0)}te.H=za,M=l(d,m)}while(_h);return M}function hu(){var a=te.H,l=a.useState()[0];return l=typeof l.then=="function"?Jf(l):l,a=a.useState()[0],(Ti!==null?Ti.memoizedState:null)!==a&&(Dn.flags|=1024),l}function i0(){var a=Lp!==0;return Lp=0,a}function r0(a,l,d){l.updateQueue=a.updateQueue,l.flags&=-2053,a.lanes&=~d}function s0(a){if(ka){for(a=a.memoizedState;a!==null;){var l=a.queue;l!==null&&(l.pending=null),a=a.next}ka=!1}Gi=0,qn=Ti=Dn=null,_h=!1,Yf=Lp=0,xh=null}function Lr(){var a={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return qn===null?Dn.memoizedState=qn=a:qn=qn.next=a,qn}function vr(){if(Ti===null){var a=Dn.alternate;a=a!==null?a.memoizedState:null}else a=Ti.next;var l=qn===null?Dn.memoizedState:qn.next;if(l!==null)qn=l,Ti=a;else{if(a===null)throw Dn.alternate===null?Error(n(467)):Error(n(310));Ti=a,a={memoizedState:Ti.memoizedState,baseState:Ti.baseState,baseQueue:Ti.baseQueue,queue:Ti.queue,next:null},qn===null?Dn.memoizedState=qn=a:qn=qn.next=a}return qn}function Up(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function Jf(a){var l=Yf;return Yf+=1,xh===null&&(xh=[]),a=Dp(xh,a,l),l=Dn,(qn===null?l.memoizedState:qn.next)===null&&(l=l.alternate,te.H=l===null||l.memoizedState===null?C_:A0),a}function mc(a){if(a!==null&&typeof a=="object"){if(typeof a.then=="function")return Jf(a);if(a.$$typeof===L)return bn(a)}throw Error(n(438,String(a)))}function a0(a){var l=null,d=Dn.updateQueue;if(d!==null&&(l=d.memoCache),l==null){var m=Dn.alternate;m!==null&&(m=m.updateQueue,m!==null&&(m=m.memoCache,m!=null&&(l={data:m.data.map(function(S){return S.slice()}),index:0})))}if(l==null&&(l={data:[],index:0}),d===null&&(d=Up(),Dn.updateQueue=d),d.memoCache=l,d=l.data[l.index],d===void 0)for(d=l.data[l.index]=Array(a),m=0;m<a;m++)d[m]=P;return l.index++,d}function Tl(a,l){return typeof l=="function"?l(a):l}function Fp(a){var l=vr();return o0(l,Ti,a)}function o0(a,l,d){var m=a.queue;if(m===null)throw Error(n(311));m.lastRenderedReducer=d;var S=a.baseQueue,M=m.pending;if(M!==null){if(S!==null){var H=S.next;S.next=M.next,M.next=H}l.baseQueue=S=M,m.pending=null}if(M=a.baseState,S===null)a.memoizedState=M;else{l=S.next;var Q=H=null,de=null,Ne=l,Ke=!1;do{var st=Ne.lane&-536870913;if(st!==Ne.lane?(On&st)===st:(Gi&st)===st){var Oe=Ne.revertLane;if(Oe===0)de!==null&&(de=de.next={lane:0,revertLane:0,gesture:null,action:Ne.action,hasEagerState:Ne.hasEagerState,eagerState:Ne.eagerState,next:null}),st===bl&&(Ke=!0);else if((Gi&Oe)===Oe){Ne=Ne.next,Oe===bl&&(Ke=!0);continue}else st={lane:0,revertLane:Ne.revertLane,gesture:null,action:Ne.action,hasEagerState:Ne.hasEagerState,eagerState:Ne.eagerState,next:null},de===null?(Q=de=st,H=M):de=de.next=st,Dn.lanes|=Oe,Ko|=Oe;st=Ne.action,cu&&d(M,st),M=Ne.hasEagerState?Ne.eagerState:d(M,st)}else Oe={lane:st,revertLane:Ne.revertLane,gesture:Ne.gesture,action:Ne.action,hasEagerState:Ne.hasEagerState,eagerState:Ne.eagerState,next:null},de===null?(Q=de=Oe,H=M):de=de.next=Oe,Dn.lanes|=st,Ko|=st;Ne=Ne.next}while(Ne!==null&&Ne!==l);if(de===null?H=M:de.next=Q,!Cs(M,a.memoizedState)&&(wr=!0,Ke&&(d=Ua,d!==null)))throw d;a.memoizedState=M,a.baseState=H,a.baseQueue=de,m.lastRenderedState=M}return S===null&&(m.lanes=0),[a.memoizedState,m.dispatch]}function l0(a){var l=vr(),d=l.queue;if(d===null)throw Error(n(311));d.lastRenderedReducer=a;var m=d.dispatch,S=d.pending,M=l.memoizedState;if(S!==null){d.pending=null;var H=S=S.next;do M=a(M,H.action),H=H.next;while(H!==S);Cs(M,l.memoizedState)||(wr=!0),l.memoizedState=M,l.baseQueue===null&&(l.baseState=M),d.lastRenderedState=M}return[M,m]}function Zy(a,l,d){var m=Dn,S=vr(),M=Zn;if(M){if(d===void 0)throw Error(n(407));d=d()}else d=l();var H=!Cs((Ti||S).memoizedState,d);if(H&&(S.memoizedState=d,wr=!0),S=S.queue,g0(t_.bind(null,m,S,a),[a]),S.getSnapshot!==l||H||qn!==null&&qn.memoizedState.tag&1){if(m.flags|=2048,gc(9,{destroy:void 0},e_.bind(null,m,S,d,l),null),En===null)throw Error(n(349));M||(Gi&127)!==0||$y(m,l,d)}return d}function $y(a,l,d){a.flags|=16384,a={getSnapshot:l,value:d},l=Dn.updateQueue,l===null?(l=Up(),Dn.updateQueue=l,l.stores=[a]):(d=l.stores,d===null?l.stores=[a]:d.push(a))}function e_(a,l,d,m){l.value=d,l.getSnapshot=m,n_(l)&&i_(a)}function t_(a,l,d){return d(function(){n_(l)&&i_(a)})}function n_(a){var l=a.getSnapshot;a=a.value;try{var d=l();return!Cs(a,d)}catch{return!0}}function i_(a){var l=Rs(a,2);l!==null&&zn(l,a,2)}function c0(a){var l=Lr();if(typeof a=="function"){var d=a;if(a=d(),cu){Ut(!0);try{d()}finally{Ut(!1)}}}return l.memoizedState=l.baseState=a,l.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Tl,lastRenderedState:a},l}function u0(a,l,d,m){return a.baseState=d,o0(a,Ti,typeof m=="function"?m:Tl)}function JS(a,l,d,m,S){if(Hp(a))throw Error(n(485));if(a=l.action,a!==null){var M={payload:S,action:a,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(H){M.listeners.push(H)}};te.T!==null?d(!0):M.isTransition=!1,m(M),d=l.pending,d===null?(M.next=l.pending=M,r_(l,M)):(M.next=d.next,l.pending=d.next=M)}}function r_(a,l){var d=l.action,m=l.payload,S=a.state;if(l.isTransition){var M=te.T,H={};te.T=H;try{var Q=d(S,m),de=te.S;de!==null&&de(H,Q),s_(a,l,Q)}catch(Ne){h0(a,l,Ne)}finally{M!==null&&H.types!==null&&(M.types=H.types),te.T=M}}else try{M=d(S,m),s_(a,l,M)}catch(Ne){h0(a,l,Ne)}}function s_(a,l,d){d!==null&&typeof d=="object"&&typeof d.then=="function"?d.then(function(m){a_(a,l,m)},function(m){return h0(a,l,m)}):a_(a,l,d)}function a_(a,l,d){l.status="fulfilled",l.value=d,o_(l),a.state=d,l=a.pending,l!==null&&(d=l.next,d===l?a.pending=null:(d=d.next,l.next=d,r_(a,d)))}function h0(a,l,d){var m=a.pending;if(a.pending=null,m!==null){m=m.next;do l.status="rejected",l.reason=d,o_(l),l=l.next;while(l!==m)}a.action=null}function o_(a){a=a.listeners;for(var l=0;l<a.length;l++)(0,a[l])()}function f0(a,l){return l}function d0(a,l){if(Zn){var d=En.formState;if(d!==null){e:{var m=Dn;if(Zn){if(Pi){t:{for(var S=Pi,M=ga;S.nodeType!==8;){if(!M){S=null;break t}if(S=$o(S.nextSibling),S===null){S=null;break t}}M=S.data,S=M==="F!"||M==="F"?S:null}if(S){Pi=$o(S.nextSibling),m=S.data==="F!";break e}}Fo(m)}m=!1}m&&(l=d[0])}}return d=Lr(),d.memoizedState=d.baseState=l,m={pending:null,lanes:0,dispatch:null,lastRenderedReducer:f0,lastRenderedState:l},d.queue=m,d=T_.bind(null,Dn,m),m.dispatch=d,m=c0(!1),M=b0.bind(null,Dn,!1,m.queue),m=Lr(),S={state:l,dispatch:null,action:a,pending:null},m.queue=S,d=JS.bind(null,Dn,S,M,d),S.dispatch=d,m.memoizedState=a,[l,d,!1]}function l_(a){var l=vr();return p0(l,Ti,a)}function p0(a,l,d){if(l=o0(a,l,f0)[0],a=Fp(Tl)[0],typeof l=="object"&&l!==null&&typeof l.then=="function")try{var m=Jf(l)}catch(H){throw H===iu?Fn:H}else m=l;l=vr();var S=l.queue,M=S.dispatch;return d!==l.memoizedState&&(Dn.flags|=2048,gc(9,{destroy:void 0},c_.bind(null,S,d),null)),[m,M,a]}function c_(a,l){a.action=l}function m0(a){var l=vr(),d=Ti;if(d!==null)return p0(l,d,a);vr(),l=l.memoizedState,d=vr();var m=d.queue.dispatch;return d.memoizedState=a,[l,m,!1]}function gc(a,l,d,m){return a={tag:a,create:d,deps:m,inst:l,next:null},l=Dn.updateQueue,l===null&&(l=Up(),Dn.updateQueue=l),d=l.lastEffect,d===null?l.lastEffect=a.next=a:(m=d.next,d.next=a,a.next=m,l.lastEffect=a),a}function kp(){return vr().memoizedState}function zp(a,l,d,m){var S=Lr();Dn.flags|=a,S.memoizedState=gc(1|l,{destroy:void 0},d,m===void 0?null:m)}function Vp(a,l,d,m){var S=vr();m=m===void 0?null:m;var M=S.memoizedState.inst;Ti!==null&&m!==null&&n0(m,Ti.memoizedState.deps)?S.memoizedState=gc(l,M,d,m):(Dn.flags|=a,S.memoizedState=gc(1|l,M,d,m))}function u_(a,l){zp(8390656,8,a,l)}function g0(a,l){Vp(2048,8,a,l)}function h_(a){Dn.flags|=4;var l=Dn.updateQueue;if(l===null)l=Up(),Dn.updateQueue=l,l.events=[a];else{var d=l.events;d===null?l.events=[a]:d.push(a)}}function f_(a){var l=vr().memoizedState;return h_({ref:l,nextImpl:a}),function(){if((ln&2)!==0)throw Error(n(440));return l.impl.apply(void 0,arguments)}}function d_(a,l){return Vp(4,2,a,l)}function p_(a,l){return Vp(4,4,a,l)}function m_(a,l){if(typeof l=="function"){a=a();var d=l(a);return function(){typeof d=="function"?d():l(null)}}if(l!=null)return a=a(),l.current=a,function(){l.current=null}}function g_(a,l,d){d=d!=null?d.concat([a]):null,Vp(4,4,m_.bind(null,l,a),d)}function v0(){}function v_(a,l){var d=vr();l=l===void 0?null:l;var m=d.memoizedState;return l!==null&&n0(l,m[1])?m[0]:(d.memoizedState=[a,l],a)}function y_(a,l){var d=vr();l=l===void 0?null:l;var m=d.memoizedState;if(l!==null&&n0(l,m[1]))return m[0];if(m=a(),cu){Ut(!0);try{a()}finally{Ut(!1)}}return d.memoizedState=[m,l],m}function y0(a,l,d){return d===void 0||(Gi&1073741824)!==0&&(On&261930)===0?a.memoizedState=l:(a.memoizedState=d,a=jn(),Dn.lanes|=a,Ko|=a,d)}function __(a,l,d,m){return Cs(d,l)?d:yh.current!==null?(a=y0(a,d,m),Cs(a,l)||(wr=!0),a):(Gi&42)===0||(Gi&1073741824)!==0&&(On&261930)===0?(wr=!0,a.memoizedState=d):(a=jn(),Dn.lanes|=a,Ko|=a,l)}function x_(a,l,d,m,S){var M=se.p;se.p=M!==0&&8>M?M:8;var H=te.T,Q={};te.T=Q,b0(a,!1,l,d);try{var de=S(),Ne=te.S;if(Ne!==null&&Ne(Q,de),de!==null&&typeof de=="object"&&typeof de.then=="function"){var Ke=Jg(de,m);Kf(a,l,Ke,Sa(a))}else Kf(a,l,m,Sa(a))}catch(st){Kf(a,l,{then:function(){},status:"rejected",reason:st},Sa())}finally{se.p=M,H!==null&&Q.types!==null&&(H.types=Q.types),te.T=H}}function KS(){}function _0(a,l,d,m){if(a.tag!==5)throw Error(n(476));var S=b_(a).queue;x_(a,S,l,Ae,d===null?KS:function(){return A_(a),d(m)})}function b_(a){var l=a.memoizedState;if(l!==null)return l;l={memoizedState:Ae,baseState:Ae,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Tl,lastRenderedState:Ae},next:null};var d={};return l.next={memoizedState:d,baseState:d,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Tl,lastRenderedState:d},next:null},a.memoizedState=l,a=a.alternate,a!==null&&(a.memoizedState=l),l}function A_(a){var l=b_(a);l.next===null&&(l=a.alternate.memoizedState),Kf(a,l.next.queue,{},Sa())}function x0(){return bn(H0)}function S_(){return vr().memoizedState}function E_(){return vr().memoizedState}function QS(a){for(var l=a.return;l!==null;){switch(l.tag){case 24:case 3:var d=Sa();a=Sl(d);var m=dc(l,a,d);m!==null&&(zn(m,l,d),pc(m,l,d)),l={cache:qg()},a.payload=l;return}l=l.return}}function ZS(a,l,d){var m=Sa();d={lane:m,revertLane:0,gesture:null,action:d,hasEagerState:!1,eagerState:null,next:null},Hp(a)?M_(l,d):(d=_p(a,l,d,m),d!==null&&(zn(d,a,m),w_(d,l,m)))}function T_(a,l,d){var m=Sa();Kf(a,l,d,m)}function Kf(a,l,d,m){var S={lane:m,revertLane:0,gesture:null,action:d,hasEagerState:!1,eagerState:null,next:null};if(Hp(a))M_(l,S);else{var M=a.alternate;if(a.lanes===0&&(M===null||M.lanes===0)&&(M=l.lastRenderedReducer,M!==null))try{var H=l.lastRenderedState,Q=M(H,d);if(S.hasEagerState=!0,S.eagerState=Q,Cs(Q,H))return Xr(a,l,S,0),En===null&&kf(),!1}catch{}finally{}if(d=_p(a,l,S,m),d!==null)return zn(d,a,m),w_(d,l,m),!0}return!1}function b0(a,l,d,m){if(m={lane:2,revertLane:Ve(),gesture:null,action:m,hasEagerState:!1,eagerState:null,next:null},Hp(a)){if(l)throw Error(n(479))}else l=_p(a,d,m,2),l!==null&&zn(l,a,2)}function Hp(a){var l=a.alternate;return a===Dn||l!==null&&l===Dn}function M_(a,l){_h=ka=!0;var d=a.pending;d===null?l.next=l:(l.next=d.next,d.next=l),a.pending=l}function w_(a,l,d){if((d&4194048)!==0){var m=l.lanes;m&=a.pendingLanes,d|=m,l.lanes=d,fa(a,d)}}var bh={readContext:bn,use:mc,useCallback:Ki,useContext:Ki,useEffect:Ki,useImperativeHandle:Ki,useLayoutEffect:Ki,useInsertionEffect:Ki,useMemo:Ki,useReducer:Ki,useRef:Ki,useState:Ki,useDebugValue:Ki,useDeferredValue:Ki,useTransition:Ki,useSyncExternalStore:Ki,useId:Ki,useHostTransitionStatus:Ki,useFormState:Ki,useActionState:Ki,useOptimistic:Ki,useMemoCache:Ki,useCacheRefresh:Ki};bh.useEffectEvent=Ki;var C_={readContext:bn,use:mc,useCallback:function(a,l){return Lr().memoizedState=[a,l===void 0?null:l],a},useContext:bn,useEffect:u_,useImperativeHandle:function(a,l,d){d=d!=null?d.concat([a]):null,zp(4194308,4,m_.bind(null,l,a),d)},useLayoutEffect:function(a,l){return zp(4194308,4,a,l)},useInsertionEffect:function(a,l){zp(4,2,a,l)},useMemo:function(a,l){var d=Lr();l=l===void 0?null:l;var m=a();if(cu){Ut(!0);try{a()}finally{Ut(!1)}}return d.memoizedState=[m,l],m},useReducer:function(a,l,d){var m=Lr();if(d!==void 0){var S=d(l);if(cu){Ut(!0);try{d(l)}finally{Ut(!1)}}}else S=l;return m.memoizedState=m.baseState=S,a={pending:null,lanes:0,dispatch:null,lastRenderedReducer:a,lastRenderedState:S},m.queue=a,a=a.dispatch=ZS.bind(null,Dn,a),[m.memoizedState,a]},useRef:function(a){var l=Lr();return a={current:a},l.memoizedState=a},useState:function(a){a=c0(a);var l=a.queue,d=T_.bind(null,Dn,l);return l.dispatch=d,[a.memoizedState,d]},useDebugValue:v0,useDeferredValue:function(a,l){var d=Lr();return y0(d,a,l)},useTransition:function(){var a=c0(!1);return a=x_.bind(null,Dn,a.queue,!0,!1),Lr().memoizedState=a,[!1,a]},useSyncExternalStore:function(a,l,d){var m=Dn,S=Lr();if(Zn){if(d===void 0)throw Error(n(407));d=d()}else{if(d=l(),En===null)throw Error(n(349));(On&127)!==0||$y(m,l,d)}S.memoizedState=d;var M={value:d,getSnapshot:l};return S.queue=M,u_(t_.bind(null,m,M,a),[a]),m.flags|=2048,gc(9,{destroy:void 0},e_.bind(null,m,M,d,l),null),d},useId:function(){var a=Lr(),l=En.identifierPrefix;if(Zn){var d=co,m=Ji;d=(m&~(1<<32-oe(m)-1)).toString(32)+d,l="_"+l+"R_"+d,d=Lp++,0<d&&(l+="H"+d.toString(32)),l+="_"}else d=t0++,l="_"+l+"r_"+d.toString(32)+"_";return a.memoizedState=l},useHostTransitionStatus:x0,useFormState:d0,useActionState:d0,useOptimistic:function(a){var l=Lr();l.memoizedState=l.baseState=a;var d={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return l.queue=d,l=b0.bind(null,Dn,!0,d),d.dispatch=l,[a,l]},useMemoCache:a0,useCacheRefresh:function(){return Lr().memoizedState=QS.bind(null,Dn)},useEffectEvent:function(a){var l=Lr(),d={impl:a};return l.memoizedState=d,function(){if((ln&2)!==0)throw Error(n(440));return d.impl.apply(void 0,arguments)}}},A0={readContext:bn,use:mc,useCallback:v_,useContext:bn,useEffect:g0,useImperativeHandle:g_,useInsertionEffect:d_,useLayoutEffect:p_,useMemo:y_,useReducer:Fp,useRef:kp,useState:function(){return Fp(Tl)},useDebugValue:v0,useDeferredValue:function(a,l){var d=vr();return __(d,Ti.memoizedState,a,l)},useTransition:function(){var a=Fp(Tl)[0],l=vr().memoizedState;return[typeof a=="boolean"?a:Jf(a),l]},useSyncExternalStore:Zy,useId:S_,useHostTransitionStatus:x0,useFormState:l_,useActionState:l_,useOptimistic:function(a,l){var d=vr();return u0(d,Ti,a,l)},useMemoCache:a0,useCacheRefresh:E_};A0.useEffectEvent=f_;var za={readContext:bn,use:mc,useCallback:v_,useContext:bn,useEffect:g0,useImperativeHandle:g_,useInsertionEffect:d_,useLayoutEffect:p_,useMemo:y_,useReducer:l0,useRef:kp,useState:function(){return l0(Tl)},useDebugValue:v0,useDeferredValue:function(a,l){var d=vr();return Ti===null?y0(d,a,l):__(d,Ti.memoizedState,a,l)},useTransition:function(){var a=l0(Tl)[0],l=vr().memoizedState;return[typeof a=="boolean"?a:Jf(a),l]},useSyncExternalStore:Zy,useId:S_,useHostTransitionStatus:x0,useFormState:m0,useActionState:m0,useOptimistic:function(a,l){var d=vr();return Ti!==null?u0(d,Ti,a,l):(d.baseState=a,[a,d.queue.dispatch])},useMemoCache:a0,useCacheRefresh:E_};za.useEffectEvent=f_;function Gp(a,l,d,m){l=a.memoizedState,d=d(m,l),d=d==null?l:v({},l,d),a.memoizedState=d,a.lanes===0&&(a.updateQueue.baseState=d)}var Qf={enqueueSetState:function(a,l,d){a=a._reactInternals;var m=Sa(),S=Sl(m);S.payload=l,d!=null&&(S.callback=d),l=dc(a,S,m),l!==null&&(zn(l,a,m),pc(l,a,m))},enqueueReplaceState:function(a,l,d){a=a._reactInternals;var m=Sa(),S=Sl(m);S.tag=1,S.payload=l,d!=null&&(S.callback=d),l=dc(a,S,m),l!==null&&(zn(l,a,m),pc(l,a,m))},enqueueForceUpdate:function(a,l){a=a._reactInternals;var d=Sa(),m=Sl(d);m.tag=2,l!=null&&(m.callback=l),l=dc(a,m,d),l!==null&&(zn(l,a,d),pc(l,a,d))}};function S0(a,l,d,m,S,M,H){return a=a.stateNode,typeof a.shouldComponentUpdate=="function"?a.shouldComponentUpdate(m,M,H):l.prototype&&l.prototype.isPureReactComponent?!ih(d,m)||!ih(S,M):!0}function E0(a,l,d,m){a=l.state,typeof l.componentWillReceiveProps=="function"&&l.componentWillReceiveProps(d,m),typeof l.UNSAFE_componentWillReceiveProps=="function"&&l.UNSAFE_componentWillReceiveProps(d,m),l.state!==a&&Qf.enqueueReplaceState(l,l.state,null)}function vc(a,l){var d=l;if("ref"in l){d={};for(var m in l)m!=="ref"&&(d[m]=l[m])}if(a=a.defaultProps){d===l&&(d=v({},d));for(var S in a)d[S]===void 0&&(d[S]=a[S])}return d}function R_(a){Ff(a)}function T0(a){console.error(a)}function M0(a){Ff(a)}function jp(a,l){try{var d=a.onUncaughtError;d(l.value,{componentStack:l.stack})}catch(m){setTimeout(function(){throw m})}}function I_(a,l,d){try{var m=a.onCaughtError;m(d.value,{componentStack:d.stack,errorBoundary:l.tag===1?l.stateNode:null})}catch(S){setTimeout(function(){throw S})}}function w0(a,l,d){return d=Sl(d),d.tag=3,d.payload={element:null},d.callback=function(){jp(a,l)},d}function C0(a){return a=Sl(a),a.tag=3,a}function D_(a,l,d,m){var S=d.type.getDerivedStateFromError;if(typeof S=="function"){var M=m.value;a.payload=function(){return S(M)},a.callback=function(){I_(l,d,m)}}var H=d.stateNode;H!==null&&typeof H.componentDidCatch=="function"&&(a.callback=function(){I_(l,d,m),typeof S!="function"&&(xr===null?xr=new Set([this]):xr.add(this));var Q=m.stack;this.componentDidCatch(m.value,{componentStack:Q!==null?Q:""})})}function Or(a,l,d,m,S){if(d.flags|=32768,m!==null&&typeof m=="object"&&typeof m.then=="function"){if(l=d.alternate,l!==null&&Ho(l,d,S,!0),d=Ks.current,d!==null){switch(d.tag){case 31:case 13:return Ds===null?Ch():d.alternate===null&&Qi===0&&(Qi=3),d.flags&=-257,d.flags|=65536,d.lanes=S,m===Ip?d.flags|=16384:(l=d.updateQueue,l===null?d.updateQueue=new Set([m]):l.add(m),cd(a,m,S)),!1;case 22:return d.flags|=65536,m===Ip?d.flags|=16384:(l=d.updateQueue,l===null?(l={transitions:null,markerInstances:null,retryQueue:new Set([m])},d.updateQueue=l):(d=l.retryQueue,d===null?l.retryQueue=new Set([m]):d.add(m)),cd(a,m,S)),!1}throw Error(n(435,d.tag))}return cd(a,m,S),Ch(),!1}if(Zn)return l=Ks.current,l!==null?((l.flags&65536)===0&&(l.flags|=256),l.flags|=65536,l.lanes=S,m!==hh&&(a=Error(n(422),{cause:m}),ko(ma(a,d)))):(m!==hh&&(l=Error(n(423),{cause:m}),ko(ma(l,d))),a=a.current.alternate,a.flags|=65536,S&=-S,a.lanes|=S,m=ma(m,d),S=w0(a.stateNode,m,S),hn(a,S),Qi!==4&&(Qi=2)),!1;var M=Error(n(520),{cause:m});if(M=ma(M,d),_u===null?_u=[M]:_u.push(M),Qi!==4&&(Qi=2),l===null)return!0;m=ma(m,d),d=l;do{switch(d.tag){case 3:return d.flags|=65536,a=S&-S,d.lanes|=a,a=w0(d.stateNode,m,a),hn(d,a),!1;case 1:if(l=d.type,M=d.stateNode,(d.flags&128)===0&&(typeof l.getDerivedStateFromError=="function"||M!==null&&typeof M.componentDidCatch=="function"&&(xr===null||!xr.has(M))))return d.flags|=65536,S&=-S,d.lanes|=S,S=C0(S),D_(S,a,d,m),hn(d,S),!1}d=d.return}while(d!==null);return!1}var Wp=Error(n(461)),wr=!1;function Yr(a,l,d,m){l.child=a===null?Pp(l,null,d,m):Al(l,a.child,d,m)}function R0(a,l,d,m,S){d=d.render;var M=l.ref;if("ref"in m){var H={};for(var Q in m)Q!=="ref"&&(H[Q]=m[Q])}else H=m;return hc(l),m=Op(a,l,d,H,M,S),Q=i0(),a!==null&&!wr?(r0(a,l,S),yr(a,l,S)):(Zn&&Q&&Uo(l),l.flags|=1,Yr(a,l,m,S),l.child)}function fu(a,l,d,m,S){if(a===null){var M=d.type;return typeof M=="function"&&!xp(M)&&M.defaultProps===void 0&&d.compare===null?(l.tag=15,l.type=M,qp(a,l,M,m,S)):(a=Lo(d.type,null,m,l,l.mode,S),a.ref=l.ref,a.return=l,l.child=a)}if(M=a.child,!Zp(a,S)){var H=M.memoizedProps;if(d=d.compare,d=d!==null?d:ih,d(H,m)&&a.ref===l.ref)return yr(a,l,S)}return l.flags|=1,a=Xs(M,m),a.ref=l.ref,a.return=l,l.child=a}function qp(a,l,d,m,S){if(a!==null){var M=a.memoizedProps;if(ih(M,m)&&a.ref===l.ref)if(wr=!1,l.pendingProps=m=M,Zp(a,S))(a.flags&131072)!==0&&(wr=!0);else return l.lanes=a.lanes,yr(a,l,S)}return Ah(a,l,d,m,S)}function du(a,l,d,m){var S=m.children,M=a!==null?a.memoizedState:null;if(a===null&&l.stateNode===null&&(l.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),m.mode==="hidden"){if((l.flags&128)!==0){if(M=M!==null?M.baseLanes|d:d,a!==null){for(m=l.child=a.child,S=0;m!==null;)S=S|m.lanes|m.childLanes,m=m.sibling;m=S&~M}else m=0,l.child=null;return Zs(a,l,M,d,m)}if((d&536870912)!==0)l.memoizedState={baseLanes:0,cachePool:null},a!==null&&Hf(l,M!==null?M.cachePool:null),M!==null?Jy(l,M):$g(),Ky(l);else return m=l.lanes=536870912,Zs(a,l,M!==null?M.baseLanes|d:d,d,m)}else M!==null?(Hf(l,M.cachePool),Jy(l,M),Qs(),l.memoizedState=null):(a!==null&&Hf(l,null),$g(),Qs());return Yr(a,l,S,d),l.child}function jo(a,l){return a!==null&&a.tag===22||l.stateNode!==null||(l.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),l.sibling}function Zs(a,l,d,m,S){var M=Rp();return M=M===null?null:{parent:Mr._currentValue,pool:M},l.memoizedState={baseLanes:d,cachePool:M},a!==null&&Hf(l,null),$g(),Ky(l),a!==null&&Ho(a,l,m,!0),l.childLanes=S,null}function Xp(a,l){return l=Qp({mode:l.mode,children:l.children},a.mode),l.ref=a.ref,a.child=l,l.return=a,l}function N_(a,l,d){return Al(l,a.child,null,d),a=Xp(l,l.pendingProps),a.flags|=2,gr(l),l.memoizedState=null,a}function Yp(a,l,d){var m=l.pendingProps,S=(l.flags&128)!==0;if(l.flags&=-129,a===null){if(Zn){if(m.mode==="hidden")return a=Xp(l,m),l.lanes=536870912,jo(null,a);if(e0(l),(a=Pi)?(a=vC(a,ga),a=a!==null&&a.data==="&"?a:null,a!==null&&(l.memoizedState={dehydrated:a,treeContext:yl!==null?{id:Ji,overflow:co}:null,retryLane:536870912,hydrationErrors:null},d=lh(a),d.return=l,l.child=d,ar=l,Pi=null)):a=null,a===null)throw Fo(l);return l.lanes=536870912,null}return Xp(l,m)}var M=a.memoizedState;if(M!==null){var H=M.dehydrated;if(e0(l),S)if(l.flags&256)l.flags&=-257,l=N_(a,l,d);else if(l.memoizedState!==null)l.child=a.child,l.flags|=128,l=null;else throw Error(n(558));else if(wr||Ho(a,l,d,!1),S=(d&a.childLanes)!==0,wr||S){if(m=En,m!==null&&(H=Ss(m,d),H!==0&&H!==M.retryLane))throw M.retryLane=H,Rs(a,H),zn(m,a,H),Wp;Ch(),l=N_(a,l,d)}else a=M.treeContext,Pi=$o(H.nextSibling),ar=l,Zn=!0,_l=null,ga=!1,a!==null&&Ep(l,a),l=Xp(l,m),l.flags|=4096;return l}return a=Xs(a.child,{mode:m.mode,children:m.children}),a.ref=l.ref,l.child=a,a.return=l,a}function pu(a,l){var d=l.ref;if(d===null)a!==null&&a.ref!==null&&(l.flags|=4194816);else{if(typeof d!="function"&&typeof d!="object")throw Error(n(284));(a===null||a.ref!==d)&&(l.flags|=4194816)}}function Ah(a,l,d,m,S){return hc(l),d=Op(a,l,d,m,void 0,S),m=i0(),a!==null&&!wr?(r0(a,l,S),yr(a,l,S)):(Zn&&m&&Uo(l),l.flags|=1,Yr(a,l,d,S),l.child)}function Zf(a,l,d,m,S,M){return hc(l),l.updateQueue=null,d=uu(l,m,d,S),Qy(a),m=i0(),a!==null&&!wr?(r0(a,l,M),yr(a,l,M)):(Zn&&m&&Uo(l),l.flags|=1,Yr(a,l,d,M),l.child)}function Jp(a,l,d,m,S){if(hc(l),l.stateNode===null){var M=sc,H=d.contextType;typeof H=="object"&&H!==null&&(M=bn(H)),M=new d(m,M),l.memoizedState=M.state!==null&&M.state!==void 0?M.state:null,M.updater=Qf,l.stateNode=M,M._reactInternals=l,M=l.stateNode,M.props=m,M.state=l.memoizedState,M.refs={},Wf(l),H=d.contextType,M.context=typeof H=="object"&&H!==null?bn(H):sc,M.state=l.memoizedState,H=d.getDerivedStateFromProps,typeof H=="function"&&(Gp(l,d,H,m),M.state=l.memoizedState),typeof d.getDerivedStateFromProps=="function"||typeof M.getSnapshotBeforeUpdate=="function"||typeof M.UNSAFE_componentWillMount!="function"&&typeof M.componentWillMount!="function"||(H=M.state,typeof M.componentWillMount=="function"&&M.componentWillMount(),typeof M.UNSAFE_componentWillMount=="function"&&M.UNSAFE_componentWillMount(),H!==M.state&&Qf.enqueueReplaceState(M,M.state,null),gh(l,m,M,S),qf(),M.state=l.memoizedState),typeof M.componentDidMount=="function"&&(l.flags|=4194308),m=!0}else if(a===null){M=l.stateNode;var Q=l.memoizedProps,de=vc(d,Q);M.props=de;var Ne=M.context,Ke=d.contextType;H=sc,typeof Ke=="object"&&Ke!==null&&(H=bn(Ke));var st=d.getDerivedStateFromProps;Ke=typeof st=="function"||typeof M.getSnapshotBeforeUpdate=="function",Q=l.pendingProps!==Q,Ke||typeof M.UNSAFE_componentWillReceiveProps!="function"&&typeof M.componentWillReceiveProps!="function"||(Q||Ne!==H)&&E0(l,M,m,H),Is=!1;var Oe=l.memoizedState;M.state=Oe,gh(l,m,M,S),qf(),Ne=l.memoizedState,Q||Oe!==Ne||Is?(typeof st=="function"&&(Gp(l,d,st,m),Ne=l.memoizedState),(de=Is||S0(l,d,de,m,Oe,Ne,H))?(Ke||typeof M.UNSAFE_componentWillMount!="function"&&typeof M.componentWillMount!="function"||(typeof M.componentWillMount=="function"&&M.componentWillMount(),typeof M.UNSAFE_componentWillMount=="function"&&M.UNSAFE_componentWillMount()),typeof M.componentDidMount=="function"&&(l.flags|=4194308)):(typeof M.componentDidMount=="function"&&(l.flags|=4194308),l.memoizedProps=m,l.memoizedState=Ne),M.props=m,M.state=Ne,M.context=H,m=de):(typeof M.componentDidMount=="function"&&(l.flags|=4194308),m=!1)}else{M=l.stateNode,Qg(a,l),H=l.memoizedProps,Ke=vc(d,H),M.props=Ke,st=l.pendingProps,Oe=M.context,Ne=d.contextType,de=sc,typeof Ne=="object"&&Ne!==null&&(de=bn(Ne)),Q=d.getDerivedStateFromProps,(Ne=typeof Q=="function"||typeof M.getSnapshotBeforeUpdate=="function")||typeof M.UNSAFE_componentWillReceiveProps!="function"&&typeof M.componentWillReceiveProps!="function"||(H!==st||Oe!==de)&&E0(l,M,m,de),Is=!1,Oe=l.memoizedState,M.state=Oe,gh(l,m,M,S),qf();var We=l.memoizedState;H!==st||Oe!==We||Is||a!==null&&a.dependencies!==null&&Vf(a.dependencies)?(typeof Q=="function"&&(Gp(l,d,Q,m),We=l.memoizedState),(Ke=Is||S0(l,d,Ke,m,Oe,We,de)||a!==null&&a.dependencies!==null&&Vf(a.dependencies))?(Ne||typeof M.UNSAFE_componentWillUpdate!="function"&&typeof M.componentWillUpdate!="function"||(typeof M.componentWillUpdate=="function"&&M.componentWillUpdate(m,We,de),typeof M.UNSAFE_componentWillUpdate=="function"&&M.UNSAFE_componentWillUpdate(m,We,de)),typeof M.componentDidUpdate=="function"&&(l.flags|=4),typeof M.getSnapshotBeforeUpdate=="function"&&(l.flags|=1024)):(typeof M.componentDidUpdate!="function"||H===a.memoizedProps&&Oe===a.memoizedState||(l.flags|=4),typeof M.getSnapshotBeforeUpdate!="function"||H===a.memoizedProps&&Oe===a.memoizedState||(l.flags|=1024),l.memoizedProps=m,l.memoizedState=We),M.props=m,M.state=We,M.context=de,m=Ke):(typeof M.componentDidUpdate!="function"||H===a.memoizedProps&&Oe===a.memoizedState||(l.flags|=4),typeof M.getSnapshotBeforeUpdate!="function"||H===a.memoizedProps&&Oe===a.memoizedState||(l.flags|=1024),m=!1)}return M=m,pu(a,l),m=(l.flags&128)!==0,M||m?(M=l.stateNode,d=m&&typeof d.getDerivedStateFromError!="function"?null:M.render(),l.flags|=1,a!==null&&m?(l.child=Al(l,a.child,null,S),l.child=Al(l,null,d,S)):Yr(a,l,d,S),l.memoizedState=M.state,a=l.child):a=yr(a,l,S),a}function P_(a,l,d,m){return cc(),l.flags|=256,Yr(a,l,d,m),l.child}var I0={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function fs(a){return{baseLanes:a,cachePool:Kg()}}function Kp(a,l,d){return a=a!==null?a.childLanes&~d:0,l&&(a|=Bs),a}function B_(a,l,d){var m=l.pendingProps,S=!1,M=(l.flags&128)!==0,H;if((H=M)||(H=a!==null&&a.memoizedState===null?!1:($n.current&2)!==0),H&&(S=!0,l.flags&=-129),H=(l.flags&32)!==0,l.flags&=-33,a===null){if(Zn){if(S?El(l):Qs(),(a=Pi)?(a=vC(a,ga),a=a!==null&&a.data!=="&"?a:null,a!==null&&(l.memoizedState={dehydrated:a,treeContext:yl!==null?{id:Ji,overflow:co}:null,retryLane:536870912,hydrationErrors:null},d=lh(a),d.return=l,l.child=d,ar=l,Pi=null)):a=null,a===null)throw Fo(l);return fE(a)?l.lanes=32:l.lanes=536870912,null}var Q=m.children;return m=m.fallback,S?(Qs(),S=l.mode,Q=Qp({mode:"hidden",children:Q},S),m=ac(m,S,d,null),Q.return=l,m.return=l,Q.sibling=m,l.child=Q,m=l.child,m.memoizedState=fs(d),m.childLanes=Kp(a,H,d),l.memoizedState=I0,jo(null,m)):(El(l),$f(l,Q))}var de=a.memoizedState;if(de!==null&&(Q=de.dehydrated,Q!==null)){if(M)l.flags&256?(El(l),l.flags&=-257,l=D0(a,l,d)):l.memoizedState!==null?(Qs(),l.child=a.child,l.flags|=128,l=null):(Qs(),Q=m.fallback,S=l.mode,m=Qp({mode:"visible",children:m.children},S),Q=ac(Q,S,d,null),Q.flags|=2,m.return=l,Q.return=l,m.sibling=Q,l.child=m,Al(l,a.child,null,d),m=l.child,m.memoizedState=fs(d),m.childLanes=Kp(a,H,d),l.memoizedState=I0,l=jo(null,m));else if(El(l),fE(Q)){if(H=Q.nextSibling&&Q.nextSibling.dataset,H)var Ne=H.dgst;H=Ne,m=Error(n(419)),m.stack="",m.digest=H,ko({value:m,source:null,stack:null}),l=D0(a,l,d)}else if(wr||Ho(a,l,d,!1),H=(d&a.childLanes)!==0,wr||H){if(H=En,H!==null&&(m=Ss(H,d),m!==0&&m!==de.retryLane))throw de.retryLane=m,Rs(a,m),zn(H,a,m),Wp;hE(Q)||Ch(),l=D0(a,l,d)}else hE(Q)?(l.flags|=192,l.child=a.child,l=null):(a=de.treeContext,Pi=$o(Q.nextSibling),ar=l,Zn=!0,_l=null,ga=!1,a!==null&&Ep(l,a),l=$f(l,m.children),l.flags|=4096);return l}return S?(Qs(),Q=m.fallback,S=l.mode,de=a.child,Ne=de.sibling,m=Xs(de,{mode:"hidden",children:m.children}),m.subtreeFlags=de.subtreeFlags&65011712,Ne!==null?Q=Xs(Ne,Q):(Q=ac(Q,S,d,null),Q.flags|=2),Q.return=l,m.return=l,m.sibling=Q,l.child=m,jo(null,m),m=l.child,Q=a.child.memoizedState,Q===null?Q=fs(d):(S=Q.cachePool,S!==null?(de=Mr._currentValue,S=S.parent!==de?{parent:de,pool:de}:S):S=Kg(),Q={baseLanes:Q.baseLanes|d,cachePool:S}),m.memoizedState=Q,m.childLanes=Kp(a,H,d),l.memoizedState=I0,jo(a.child,m)):(El(l),d=a.child,a=d.sibling,d=Xs(d,{mode:"visible",children:m.children}),d.return=l,d.sibling=null,a!==null&&(H=l.deletions,H===null?(l.deletions=[a],l.flags|=16):H.push(a)),l.child=d,l.memoizedState=null,d)}function $f(a,l){return l=Qp({mode:"visible",children:l},a.mode),l.return=a,a.child=l}function Qp(a,l){return a=Yi(22,a,null,l),a.lanes=0,a}function D0(a,l,d){return Al(l,a.child,null,d),a=$f(l,l.pendingProps.children),a.flags|=2,l.memoizedState=null,a}function L_(a,l,d){a.lanes|=l;var m=a.alternate;m!==null&&(m.lanes|=l),Mp(a.return,l,d)}function mu(a,l,d,m,S,M){var H=a.memoizedState;H===null?a.memoizedState={isBackwards:l,rendering:null,renderingStartTime:0,last:m,tail:d,tailMode:S,treeForkCount:M}:(H.isBackwards=l,H.rendering=null,H.renderingStartTime=0,H.last=m,H.tail=d,H.tailMode=S,H.treeForkCount=M)}function $s(a,l,d){var m=l.pendingProps,S=m.revealOrder,M=m.tail;m=m.children;var H=$n.current,Q=(H&2)!==0;if(Q?(H=H&1|2,l.flags|=128):H&=1,Se($n,H),Yr(a,l,m,d),m=Zn?uh:0,!Q&&a!==null&&(a.flags&128)!==0)e:for(a=l.child;a!==null;){if(a.tag===13)a.memoizedState!==null&&L_(a,d,l);else if(a.tag===19)L_(a,d,l);else if(a.child!==null){a.child.return=a,a=a.child;continue}if(a===l)break e;for(;a.sibling===null;){if(a.return===null||a.return===l)break e;a=a.return}a.sibling.return=a.return,a=a.sibling}switch(S){case"forwards":for(d=l.child,S=null;d!==null;)a=d.alternate,a!==null&&ya(a)===null&&(S=d),d=d.sibling;d=S,d===null?(S=l.child,l.child=null):(S=d.sibling,d.sibling=null),mu(l,!1,S,d,M,m);break;case"backwards":case"unstable_legacy-backwards":for(d=null,S=l.child,l.child=null;S!==null;){if(a=S.alternate,a!==null&&ya(a)===null){l.child=S;break}a=S.sibling,S.sibling=d,d=S,S=a}mu(l,!0,d,null,M,m);break;case"together":mu(l,!1,null,null,void 0,m);break;default:l.memoizedState=null}return l.child}function yr(a,l,d){if(a!==null&&(l.dependencies=a.dependencies),Ko|=l.lanes,(d&l.childLanes)===0)if(a!==null){if(Ho(a,l,d,!1),(d&l.childLanes)===0)return null}else return null;if(a!==null&&l.child!==a.child)throw Error(n(153));if(l.child!==null){for(a=l.child,d=Xs(a,a.pendingProps),l.child=d,d.return=l;a.sibling!==null;)a=a.sibling,d=d.sibling=Xs(a,a.pendingProps),d.return=l;d.sibling=null}return l.child}function Zp(a,l){return(a.lanes&l)!==0?!0:(a=a.dependencies,!!(a!==null&&Vf(a)))}function $S(a,l,d){switch(l.tag){case 3:lt(l,l.stateNode.containerInfo),xl(l,Mr,a.memoizedState.cache),cc();break;case 27:case 5:Dt(l);break;case 4:lt(l,l.stateNode.containerInfo);break;case 10:xl(l,l.type,l.memoizedProps.value);break;case 31:if(l.memoizedState!==null)return l.flags|=128,e0(l),null;break;case 13:var m=l.memoizedState;if(m!==null)return m.dehydrated!==null?(El(l),l.flags|=128,null):(d&l.child.childLanes)!==0?B_(a,l,d):(El(l),a=yr(a,l,d),a!==null?a.sibling:null);El(l);break;case 19:var S=(a.flags&128)!==0;if(m=(d&l.childLanes)!==0,m||(Ho(a,l,d,!1),m=(d&l.childLanes)!==0),S){if(m)return $s(a,l,d);l.flags|=128}if(S=l.memoizedState,S!==null&&(S.rendering=null,S.tail=null,S.lastEffect=null),Se($n,$n.current),m)break;return null;case 22:return l.lanes=0,du(a,l,d,l.pendingProps);case 24:xl(l,Mr,a.memoizedState.cache)}return yr(a,l,d)}function $p(a,l,d){if(a!==null)if(a.memoizedProps!==l.pendingProps)wr=!0;else{if(!Zp(a,d)&&(l.flags&128)===0)return wr=!1,$S(a,l,d);wr=(a.flags&131072)!==0}else wr=!1,Zn&&(l.flags&1048576)!==0&&Hy(l,uh,l.index);switch(l.lanes=0,l.tag){case 16:e:{var m=l.pendingProps;if(a=ru(l.elementType),l.type=a,typeof a=="function")xp(a)?(m=vc(a,m),l.tag=1,l=Jp(null,l,a,m,d)):(l.tag=0,l=Ah(null,l,a,m,d));else{if(a!=null){var S=a.$$typeof;if(S===F){l.tag=11,l=R0(null,l,a,m,d);break e}else if(S===O){l.tag=14,l=fu(null,l,a,m,d);break e}}throw l=ce(a)||a,Error(n(306,l,""))}}return l;case 0:return Ah(a,l,l.type,l.pendingProps,d);case 1:return m=l.type,S=vc(m,l.pendingProps),Jp(a,l,m,S,d);case 3:e:{if(lt(l,l.stateNode.containerInfo),a===null)throw Error(n(387));m=l.pendingProps;var M=l.memoizedState;S=M.element,Qg(a,l),gh(l,m,null,d);var H=l.memoizedState;if(m=H.cache,xl(l,Mr,m),m!==M.cache&&wp(l,[Mr],d,!0),qf(),m=H.element,M.isDehydrated)if(M={element:m,isDehydrated:!1,cache:H.cache},l.updateQueue.baseState=M,l.memoizedState=M,l.flags&256){l=P_(a,l,m,d);break e}else if(m!==S){S=ma(Error(n(424)),l),ko(S),l=P_(a,l,m,d);break e}else{switch(a=l.stateNode.containerInfo,a.nodeType){case 9:a=a.body;break;default:a=a.nodeName==="HTML"?a.ownerDocument.body:a}for(Pi=$o(a.firstChild),ar=l,Zn=!0,_l=null,ga=!0,d=Pp(l,null,m,d),l.child=d;d;)d.flags=d.flags&-3|4096,d=d.sibling}else{if(cc(),m===S){l=yr(a,l,d);break e}Yr(a,l,m,d)}l=l.child}return l;case 26:return pu(a,l),a===null?(d=SC(l.type,null,l.pendingProps,null))?l.memoizedState=d:Zn||(d=l.type,a=l.pendingProps,m=k_(ve.current).createElement(d),m[Si]=l,m[X]=a,Os(m,d,a),J(m),l.stateNode=m):l.memoizedState=SC(l.type,a.memoizedProps,l.pendingProps,a.memoizedState),null;case 27:return Dt(l),a===null&&Zn&&(m=l.stateNode=xC(l.type,l.pendingProps,ve.current),ar=l,ga=!0,S=Pi,Nh(l.type)?(dE=S,Pi=$o(m.firstChild)):Pi=S),Yr(a,l,l.pendingProps.children,d),pu(a,l),a===null&&(l.flags|=4194304),l.child;case 5:return a===null&&Zn&&((S=m=Pi)&&(m=JO(m,l.type,l.pendingProps,ga),m!==null?(l.stateNode=m,ar=l,Pi=$o(m.firstChild),ga=!1,S=!0):S=!1),S||Fo(l)),Dt(l),S=l.type,M=l.pendingProps,H=a!==null?a.memoizedProps:null,m=M.children,lE(S,M)?m=null:H!==null&&lE(S,H)&&(l.flags|=32),l.memoizedState!==null&&(S=Op(a,l,hu,null,null,d),H0._currentValue=S),pu(a,l),Yr(a,l,m,d),l.child;case 6:return a===null&&Zn&&((a=d=Pi)&&(d=KO(d,l.pendingProps,ga),d!==null?(l.stateNode=d,ar=l,Pi=null,a=!0):a=!1),a||Fo(l)),null;case 13:return B_(a,l,d);case 4:return lt(l,l.stateNode.containerInfo),m=l.pendingProps,a===null?l.child=Al(l,null,m,d):Yr(a,l,m,d),l.child;case 11:return R0(a,l,l.type,l.pendingProps,d);case 7:return Yr(a,l,l.pendingProps,d),l.child;case 8:return Yr(a,l,l.pendingProps.children,d),l.child;case 12:return Yr(a,l,l.pendingProps.children,d),l.child;case 10:return m=l.pendingProps,xl(l,l.type,m.value),Yr(a,l,m.children,d),l.child;case 9:return S=l.type._context,m=l.pendingProps.children,hc(l),S=bn(S),m=m(S),l.flags|=1,Yr(a,l,m,d),l.child;case 14:return fu(a,l,l.type,l.pendingProps,d);case 15:return qp(a,l,l.type,l.pendingProps,d);case 19:return $s(a,l,d);case 31:return Yp(a,l,d);case 22:return du(a,l,d,l.pendingProps);case 24:return hc(l),m=bn(Mr),a===null?(S=Rp(),S===null&&(S=En,M=qg(),S.pooledCache=M,M.refCount++,M!==null&&(S.pooledCacheLanes|=d),S=M),l.memoizedState={parent:m,cache:S},Wf(l),xl(l,Mr,S)):((a.lanes&d)!==0&&(Qg(a,l),gh(l,null,null,d),qf()),S=a.memoizedState,M=l.memoizedState,S.parent!==m?(S={parent:m,cache:m},l.memoizedState=S,l.lanes===0&&(l.memoizedState=l.updateQueue.baseState=S),xl(l,Mr,m)):(m=M.cache,xl(l,Mr,m),m!==S.cache&&wp(l,[Mr],d,!0))),Yr(a,l,l.pendingProps.children,d),l.child;case 29:throw l.pendingProps}throw Error(n(156,l.tag))}function Wo(a){a.flags|=4}function ed(a,l,d,m,S){if((l=(a.mode&32)!==0)&&(l=!1),l){if(a.flags|=16777216,(S&335544128)===S)if(a.stateNode.complete)a.flags|=8192;else if($i())a.flags|=8192;else throw Go=Ip,Gf}else a.flags&=-16777217}function N0(a,l){if(l.type!=="stylesheet"||(l.state.loading&4)!==0)a.flags&=-16777217;else if(a.flags|=16777216,!CC(l))if($i())a.flags|=8192;else throw Go=Ip,Gf}function Ml(a,l){l!==null&&(a.flags|=4),a.flags&16384&&(l=a.tag!==22?Tn():536870912,a.lanes|=l,ki|=l)}function qo(a,l){if(!Zn)switch(a.tailMode){case"hidden":l=a.tail;for(var d=null;l!==null;)l.alternate!==null&&(d=l),l=l.sibling;d===null?a.tail=null:d.sibling=null;break;case"collapsed":d=a.tail;for(var m=null;d!==null;)d.alternate!==null&&(m=d),d=d.sibling;m===null?l||a.tail===null?a.tail=null:a.tail.sibling=null:m.sibling=null}}function Mi(a){var l=a.alternate!==null&&a.alternate.child===a.child,d=0,m=0;if(l)for(var S=a.child;S!==null;)d|=S.lanes|S.childLanes,m|=S.subtreeFlags&65011712,m|=S.flags&65011712,S.return=a,S=S.sibling;else for(S=a.child;S!==null;)d|=S.lanes|S.childLanes,m|=S.subtreeFlags,m|=S.flags,S.return=a,S=S.sibling;return a.subtreeFlags|=m,a.childLanes=d,l}function td(a,l,d){var m=l.pendingProps;switch(Sp(l),l.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Mi(l),null;case 1:return Mi(l),null;case 3:return d=l.stateNode,m=null,a!==null&&(m=a.memoizedState.cache),l.memoizedState.cache!==m&&(l.flags|=2048),Vo(Mr),_t(),d.pendingContext&&(d.context=d.pendingContext,d.pendingContext=null),(a===null||a.child===null)&&(fh(l)?Wo(l):a===null||a.memoizedState.isDehydrated&&(l.flags&256)===0||(l.flags|=1024,Tp())),Mi(l),null;case 26:var S=l.type,M=l.memoizedState;return a===null?(Wo(l),M!==null?(Mi(l),N0(l,M)):(Mi(l),ed(l,S,null,m,d))):M?M!==a.memoizedState?(Wo(l),Mi(l),N0(l,M)):(Mi(l),l.flags&=-16777217):(a=a.memoizedProps,a!==m&&Wo(l),Mi(l),ed(l,S,a,m,d)),null;case 27:if(qt(l),d=ve.current,S=l.type,a!==null&&l.stateNode!=null)a.memoizedProps!==m&&Wo(l);else{if(!m){if(l.stateNode===null)throw Error(n(166));return Mi(l),null}a=ke.current,fh(l)?Gy(l):(a=xC(S,m,d),l.stateNode=a,Wo(l))}return Mi(l),null;case 5:if(qt(l),S=l.type,a!==null&&l.stateNode!=null)a.memoizedProps!==m&&Wo(l);else{if(!m){if(l.stateNode===null)throw Error(n(166));return Mi(l),null}if(M=ke.current,fh(l))Gy(l);else{var H=k_(ve.current);switch(M){case 1:M=H.createElementNS("http://www.w3.org/2000/svg",S);break;case 2:M=H.createElementNS("http://www.w3.org/1998/Math/MathML",S);break;default:switch(S){case"svg":M=H.createElementNS("http://www.w3.org/2000/svg",S);break;case"math":M=H.createElementNS("http://www.w3.org/1998/Math/MathML",S);break;case"script":M=H.createElement("div"),M.innerHTML="<script><\/script>",M=M.removeChild(M.firstChild);break;case"select":M=typeof m.is=="string"?H.createElement("select",{is:m.is}):H.createElement("select"),m.multiple?M.multiple=!0:m.size&&(M.size=m.size);break;default:M=typeof m.is=="string"?H.createElement(S,{is:m.is}):H.createElement(S)}}M[Si]=l,M[X]=m;e:for(H=l.child;H!==null;){if(H.tag===5||H.tag===6)M.appendChild(H.stateNode);else if(H.tag!==4&&H.tag!==27&&H.child!==null){H.child.return=H,H=H.child;continue}if(H===l)break e;for(;H.sibling===null;){if(H.return===null||H.return===l)break e;H=H.return}H.sibling.return=H.return,H=H.sibling}l.stateNode=M;e:switch(Os(M,S,m),S){case"button":case"input":case"select":case"textarea":m=!!m.autoFocus;break e;case"img":m=!0;break e;default:m=!1}m&&Wo(l)}}return Mi(l),ed(l,l.type,a===null?null:a.memoizedProps,l.pendingProps,d),null;case 6:if(a&&l.stateNode!=null)a.memoizedProps!==m&&Wo(l);else{if(typeof m!="string"&&l.stateNode===null)throw Error(n(166));if(a=ve.current,fh(l)){if(a=l.stateNode,d=l.memoizedProps,m=null,S=ar,S!==null)switch(S.tag){case 27:case 5:m=S.memoizedProps}a[Si]=l,a=!!(a.nodeValue===d||m!==null&&m.suppressHydrationWarning===!0||cC(a.nodeValue,d)),a||Fo(l,!0)}else a=k_(a).createTextNode(m),a[Si]=l,l.stateNode=a}return Mi(l),null;case 31:if(d=l.memoizedState,a===null||a.memoizedState!==null){if(m=fh(l),d!==null){if(a===null){if(!m)throw Error(n(318));if(a=l.memoizedState,a=a!==null?a.dehydrated:null,!a)throw Error(n(557));a[Si]=l}else cc(),(l.flags&128)===0&&(l.memoizedState=null),l.flags|=4;Mi(l),a=!1}else d=Tp(),a!==null&&a.memoizedState!==null&&(a.memoizedState.hydrationErrors=d),a=!0;if(!a)return l.flags&256?(gr(l),l):(gr(l),null);if((l.flags&128)!==0)throw Error(n(558))}return Mi(l),null;case 13:if(m=l.memoizedState,a===null||a.memoizedState!==null&&a.memoizedState.dehydrated!==null){if(S=fh(l),m!==null&&m.dehydrated!==null){if(a===null){if(!S)throw Error(n(318));if(S=l.memoizedState,S=S!==null?S.dehydrated:null,!S)throw Error(n(317));S[Si]=l}else cc(),(l.flags&128)===0&&(l.memoizedState=null),l.flags|=4;Mi(l),S=!1}else S=Tp(),a!==null&&a.memoizedState!==null&&(a.memoizedState.hydrationErrors=S),S=!0;if(!S)return l.flags&256?(gr(l),l):(gr(l),null)}return gr(l),(l.flags&128)!==0?(l.lanes=d,l):(d=m!==null,a=a!==null&&a.memoizedState!==null,d&&(m=l.child,S=null,m.alternate!==null&&m.alternate.memoizedState!==null&&m.alternate.memoizedState.cachePool!==null&&(S=m.alternate.memoizedState.cachePool.pool),M=null,m.memoizedState!==null&&m.memoizedState.cachePool!==null&&(M=m.memoizedState.cachePool.pool),M!==S&&(m.flags|=2048)),d!==a&&d&&(l.child.flags|=8192),Ml(l,l.updateQueue),Mi(l),null);case 4:return _t(),a===null&&iE(l.stateNode.containerInfo),Mi(l),null;case 10:return Vo(l.type),Mi(l),null;case 19:if(ae($n),m=l.memoizedState,m===null)return Mi(l),null;if(S=(l.flags&128)!==0,M=m.rendering,M===null)if(S)qo(m,!1);else{if(Qi!==0||a!==null&&(a.flags&128)!==0)for(a=l.child;a!==null;){if(M=ya(a),M!==null){for(l.flags|=128,qo(m,!1),a=M.updateQueue,l.updateQueue=a,Ml(l,a),l.subtreeFlags=0,a=d,d=l.child;d!==null;)oh(d,a),d=d.sibling;return Se($n,$n.current&1|2),Zn&&Oo(l,m.treeForkCount),l.child}a=a.sibling}m.tail!==null&&q()>_r&&(l.flags|=128,S=!0,qo(m,!1),l.lanes=4194304)}else{if(!S)if(a=ya(M),a!==null){if(l.flags|=128,S=!0,a=a.updateQueue,l.updateQueue=a,Ml(l,a),qo(m,!0),m.tail===null&&m.tailMode==="hidden"&&!M.alternate&&!Zn)return Mi(l),null}else 2*q()-m.renderingStartTime>_r&&d!==536870912&&(l.flags|=128,S=!0,qo(m,!1),l.lanes=4194304);m.isBackwards?(M.sibling=l.child,l.child=M):(a=m.last,a!==null?a.sibling=M:l.child=M,m.last=M)}return m.tail!==null?(a=m.tail,m.rendering=a,m.tail=a.sibling,m.renderingStartTime=q(),a.sibling=null,d=$n.current,Se($n,S?d&1|2:d&1),Zn&&Oo(l,m.treeForkCount),a):(Mi(l),null);case 22:case 23:return gr(l),Xf(),m=l.memoizedState!==null,a!==null?a.memoizedState!==null!==m&&(l.flags|=8192):m&&(l.flags|=8192),m?(d&536870912)!==0&&(l.flags&128)===0&&(Mi(l),l.subtreeFlags&6&&(l.flags|=8192)):Mi(l),d=l.updateQueue,d!==null&&Ml(l,d.retryQueue),d=null,a!==null&&a.memoizedState!==null&&a.memoizedState.cachePool!==null&&(d=a.memoizedState.cachePool.pool),m=null,l.memoizedState!==null&&l.memoizedState.cachePool!==null&&(m=l.memoizedState.cachePool.pool),m!==d&&(l.flags|=2048),a!==null&&ae(fc),null;case 24:return d=null,a!==null&&(d=a.memoizedState.cache),l.memoizedState.cache!==d&&(l.flags|=2048),Vo(Mr),Mi(l),null;case 25:return null;case 30:return null}throw Error(n(156,l.tag))}function Va(a,l){switch(Sp(l),l.tag){case 1:return a=l.flags,a&65536?(l.flags=a&-65537|128,l):null;case 3:return Vo(Mr),_t(),a=l.flags,(a&65536)!==0&&(a&128)===0?(l.flags=a&-65537|128,l):null;case 26:case 27:case 5:return qt(l),null;case 31:if(l.memoizedState!==null){if(gr(l),l.alternate===null)throw Error(n(340));cc()}return a=l.flags,a&65536?(l.flags=a&-65537|128,l):null;case 13:if(gr(l),a=l.memoizedState,a!==null&&a.dehydrated!==null){if(l.alternate===null)throw Error(n(340));cc()}return a=l.flags,a&65536?(l.flags=a&-65537|128,l):null;case 19:return ae($n),null;case 4:return _t(),null;case 10:return Vo(l.type),null;case 22:case 23:return gr(l),Xf(),a!==null&&ae(fc),a=l.flags,a&65536?(l.flags=a&-65537|128,l):null;case 24:return Vo(Mr),null;case 25:return null;default:return null}}function _a(a,l){switch(Sp(l),l.tag){case 3:Vo(Mr),_t();break;case 26:case 27:case 5:qt(l);break;case 4:_t();break;case 31:l.memoizedState!==null&&gr(l);break;case 13:gr(l);break;case 19:ae($n);break;case 10:Vo(l.type);break;case 22:case 23:gr(l),Xf(),a!==null&&ae(fc);break;case 24:Vo(Mr)}}function Ha(a,l){try{var d=l.updateQueue,m=d!==null?d.lastEffect:null;if(m!==null){var S=m.next;d=S;do{if((d.tag&a)===a){m=void 0;var M=d.create,H=d.inst;m=M(),H.destroy=m}d=d.next}while(d!==S)}}catch(Q){hi(l,l.return,Q)}}function ns(a,l,d){try{var m=l.updateQueue,S=m!==null?m.lastEffect:null;if(S!==null){var M=S.next;m=M;do{if((m.tag&a)===a){var H=m.inst,Q=H.destroy;if(Q!==void 0){H.destroy=void 0,S=l;var de=d,Ne=Q;try{Ne()}catch(Ke){hi(S,de,Ke)}}}m=m.next}while(m!==M)}}catch(Ke){hi(l,l.return,Ke)}}function uo(a){var l=a.updateQueue;if(l!==null){var d=a.stateNode;try{Yy(l,d)}catch(m){hi(a,a.return,m)}}}function Jr(a,l,d){d.props=vc(a.type,a.memoizedProps),d.state=a.memoizedState;try{d.componentWillUnmount()}catch(m){hi(a,l,m)}}function wl(a,l){try{var d=a.ref;if(d!==null){switch(a.tag){case 26:case 27:case 5:var m=a.stateNode;break;case 30:m=a.stateNode;break;default:m=a.stateNode}typeof d=="function"?a.refCleanup=d(m):d.current=m}}catch(S){hi(a,l,S)}}function is(a,l){var d=a.ref,m=a.refCleanup;if(d!==null)if(typeof m=="function")try{m()}catch(S){hi(a,l,S)}finally{a.refCleanup=null,a=a.alternate,a!=null&&(a.refCleanup=null)}else if(typeof d=="function")try{d(null)}catch(S){hi(a,l,S)}else d.current=null}function nd(a){var l=a.type,d=a.memoizedProps,m=a.stateNode;try{e:switch(l){case"button":case"input":case"select":case"textarea":d.autoFocus&&m.focus();break e;case"img":d.src?m.src=d.src:d.srcSet&&(m.srcset=d.srcSet)}}catch(S){hi(a,a.return,S)}}function Ur(a,l,d){try{var m=a.stateNode;GO(m,a.type,d,l),m[X]=l}catch(S){hi(a,a.return,S)}}function ji(a){return a.tag===5||a.tag===3||a.tag===26||a.tag===27&&Nh(a.type)||a.tag===4}function Xn(a){e:for(;;){for(;a.sibling===null;){if(a.return===null||ji(a.return))return null;a=a.return}for(a.sibling.return=a.return,a=a.sibling;a.tag!==5&&a.tag!==6&&a.tag!==18;){if(a.tag===27&&Nh(a.type)||a.flags&2||a.child===null||a.tag===4)continue e;a.child.return=a,a=a.child}if(!(a.flags&2))return a.stateNode}}function Xo(a,l,d){var m=a.tag;if(m===5||m===6)a=a.stateNode,l?(d.nodeType===9?d.body:d.nodeName==="HTML"?d.ownerDocument.body:d).insertBefore(a,l):(l=d.nodeType===9?d.body:d.nodeName==="HTML"?d.ownerDocument.body:d,l.appendChild(a),d=d._reactRootContainer,d!=null||l.onclick!==null||(l.onclick=no));else if(m!==4&&(m===27&&Nh(a.type)&&(d=a.stateNode,l=null),a=a.child,a!==null))for(Xo(a,l,d),a=a.sibling;a!==null;)Xo(a,l,d),a=a.sibling}function Ns(a,l,d){var m=a.tag;if(m===5||m===6)a=a.stateNode,l?d.insertBefore(a,l):d.appendChild(a);else if(m!==4&&(m===27&&Nh(a.type)&&(d=a.stateNode),a=a.child,a!==null))for(Ns(a,l,d),a=a.sibling;a!==null;)Ns(a,l,d),a=a.sibling}function em(a){var l=a.stateNode,d=a.memoizedProps;try{for(var m=a.type,S=l.attributes;S.length;)l.removeAttributeNode(S[0]);Os(l,m,d),l[Si]=a,l[X]=d}catch(M){hi(a,a.return,M)}}var Ga=!1,Bi=!1,ho=!1,O_=typeof WeakSet=="function"?WeakSet:Set,Kr=null;function eE(a,l){if(a=a.containerInfo,aE=q_,a=Fy(a),Vg(a)){if("selectionStart"in a)var d={start:a.selectionStart,end:a.selectionEnd};else e:{d=(d=a.ownerDocument)&&d.defaultView||window;var m=d.getSelection&&d.getSelection();if(m&&m.rangeCount!==0){d=m.anchorNode;var S=m.anchorOffset,M=m.focusNode;m=m.focusOffset;try{d.nodeType,M.nodeType}catch{d=null;break e}var H=0,Q=-1,de=-1,Ne=0,Ke=0,st=a,Oe=null;t:for(;;){for(var We;st!==d||S!==0&&st.nodeType!==3||(Q=H+S),st!==M||m!==0&&st.nodeType!==3||(de=H+m),st.nodeType===3&&(H+=st.nodeValue.length),(We=st.firstChild)!==null;)Oe=st,st=We;for(;;){if(st===a)break t;if(Oe===d&&++Ne===S&&(Q=H),Oe===M&&++Ke===m&&(de=H),(We=st.nextSibling)!==null)break;st=Oe,Oe=st.parentNode}st=We}d=Q===-1||de===-1?null:{start:Q,end:de}}else d=null}d=d||{start:0,end:0}}else d=null;for(oE={focusedElem:a,selectionRange:d},q_=!1,Kr=l;Kr!==null;)if(l=Kr,a=l.child,(l.subtreeFlags&1028)!==0&&a!==null)a.return=l,Kr=a;else for(;Kr!==null;){switch(l=Kr,M=l.alternate,a=l.flags,l.tag){case 0:if((a&4)!==0&&(a=l.updateQueue,a=a!==null?a.events:null,a!==null))for(d=0;d<a.length;d++)S=a[d],S.ref.impl=S.nextImpl;break;case 11:case 15:break;case 1:if((a&1024)!==0&&M!==null){a=void 0,d=l,S=M.memoizedProps,M=M.memoizedState,m=d.stateNode;try{var nn=vc(d.type,S);a=m.getSnapshotBeforeUpdate(nn,M),m.__reactInternalSnapshotBeforeUpdate=a}catch(xn){hi(d,d.return,xn)}}break;case 3:if((a&1024)!==0){if(a=l.stateNode.containerInfo,d=a.nodeType,d===9)uE(a);else if(d===1)switch(a.nodeName){case"HEAD":case"HTML":case"BODY":uE(a);break;default:a.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((a&1024)!==0)throw Error(n(163))}if(a=l.sibling,a!==null){a.return=l.return,Kr=a;break}Kr=l.return}}function Wi(a,l,d){var m=d.flags;switch(d.tag){case 0:case 11:case 15:qa(a,d),m&4&&Ha(5,d);break;case 1:if(qa(a,d),m&4)if(a=d.stateNode,l===null)try{a.componentDidMount()}catch(H){hi(d,d.return,H)}else{var S=vc(d.type,l.memoizedProps);l=l.memoizedState;try{a.componentDidUpdate(S,l,a.__reactInternalSnapshotBeforeUpdate)}catch(H){hi(d,d.return,H)}}m&64&&uo(d),m&512&&wl(d,d.return);break;case 3:if(qa(a,d),m&64&&(a=d.updateQueue,a!==null)){if(l=null,d.child!==null)switch(d.child.tag){case 27:case 5:l=d.child.stateNode;break;case 1:l=d.child.stateNode}try{Yy(a,l)}catch(H){hi(d,d.return,H)}}break;case 27:l===null&&m&4&&em(d);case 26:case 5:qa(a,d),l===null&&m&4&&nd(d),m&512&&wl(d,d.return);break;case 12:qa(a,d);break;case 31:qa(a,d),m&4&&yc(a,d);break;case 13:qa(a,d),m&4&&Sh(a,d),m&64&&(a=d.memoizedState,a!==null&&(a=a.dehydrated,a!==null&&(d=y.bind(null,d),QO(a,d))));break;case 22:if(m=d.memoizedState!==null||Ga,!m){l=l!==null&&l.memoizedState!==null||Bi,S=Ga;var M=Bi;Ga=m,(Bi=l)&&!M?Ps(a,d,(d.subtreeFlags&8772)!==0):qa(a,d),Ga=S,Bi=M}break;case 30:break;default:qa(a,d)}}function id(a){var l=a.alternate;l!==null&&(a.alternate=null,id(l)),a.child=null,a.deletions=null,a.sibling=null,a.tag===5&&(l=a.stateNode,l!==null&&ht(l)),a.stateNode=null,a.return=null,a.dependencies=null,a.memoizedProps=null,a.memoizedState=null,a.pendingProps=null,a.stateNode=null,a.updateQueue=null}var xi=null,ds=!1;function ja(a,l,d){for(d=d.child;d!==null;)tm(a,l,d),d=d.sibling}function tm(a,l,d){if(it&&typeof it.onCommitFiberUnmount=="function")try{it.onCommitFiberUnmount(tt,d)}catch{}switch(d.tag){case 26:Bi||is(d,l),ja(a,l,d),d.memoizedState?d.memoizedState.count--:d.stateNode&&(d=d.stateNode,d.parentNode.removeChild(d));break;case 27:Bi||is(d,l);var m=xi,S=ds;Nh(d.type)&&(xi=d.stateNode,ds=!1),ja(a,l,d),k0(d.stateNode),xi=m,ds=S;break;case 5:Bi||is(d,l);case 6:if(m=xi,S=ds,xi=null,ja(a,l,d),xi=m,ds=S,xi!==null)if(ds)try{(xi.nodeType===9?xi.body:xi.nodeName==="HTML"?xi.ownerDocument.body:xi).removeChild(d.stateNode)}catch(M){hi(d,l,M)}else try{xi.removeChild(d.stateNode)}catch(M){hi(d,l,M)}break;case 18:xi!==null&&(ds?(a=xi,mC(a.nodeType===9?a.body:a.nodeName==="HTML"?a.ownerDocument.body:a,d.stateNode),cm(a)):mC(xi,d.stateNode));break;case 4:m=xi,S=ds,xi=d.stateNode.containerInfo,ds=!0,ja(a,l,d),xi=m,ds=S;break;case 0:case 11:case 14:case 15:ns(2,d,l),Bi||ns(4,d,l),ja(a,l,d);break;case 1:Bi||(is(d,l),m=d.stateNode,typeof m.componentWillUnmount=="function"&&Jr(d,l,m)),ja(a,l,d);break;case 21:ja(a,l,d);break;case 22:Bi=(m=Bi)||d.memoizedState!==null,ja(a,l,d),Bi=m;break;default:ja(a,l,d)}}function yc(a,l){if(l.memoizedState===null&&(a=l.alternate,a!==null&&(a=a.memoizedState,a!==null))){a=a.dehydrated;try{cm(a)}catch(d){hi(l,l.return,d)}}}function Sh(a,l){if(l.memoizedState===null&&(a=l.alternate,a!==null&&(a=a.memoizedState,a!==null&&(a=a.dehydrated,a!==null))))try{cm(a)}catch(d){hi(l,l.return,d)}}function P0(a){switch(a.tag){case 31:case 13:case 19:var l=a.stateNode;return l===null&&(l=a.stateNode=new O_),l;case 22:return a=a.stateNode,l=a._retryCache,l===null&&(l=a._retryCache=new O_),l;default:throw Error(n(435,a.tag))}}function Cl(a,l){var d=P0(a);l.forEach(function(m){if(!d.has(m)){d.add(m);var S=A.bind(null,a,m);m.then(S,S)}})}function Fr(a,l){var d=l.deletions;if(d!==null)for(var m=0;m<d.length;m++){var S=d[m],M=a,H=l,Q=H;e:for(;Q!==null;){switch(Q.tag){case 27:if(Nh(Q.type)){xi=Q.stateNode,ds=!1;break e}break;case 5:xi=Q.stateNode,ds=!1;break e;case 3:case 4:xi=Q.stateNode.containerInfo,ds=!0;break e}Q=Q.return}if(xi===null)throw Error(n(160));tm(M,H,S),xi=null,ds=!1,M=S.alternate,M!==null&&(M.return=null),S.return=null}if(l.subtreeFlags&13886)for(l=l.child;l!==null;)_c(l,a),l=l.sibling}var Wa=null;function _c(a,l){var d=a.alternate,m=a.flags;switch(a.tag){case 0:case 11:case 14:case 15:Fr(l,a),kr(a),m&4&&(ns(3,a,a.return),Ha(3,a),ns(5,a,a.return));break;case 1:Fr(l,a),kr(a),m&512&&(Bi||d===null||is(d,d.return)),m&64&&Ga&&(a=a.updateQueue,a!==null&&(m=a.callbacks,m!==null&&(d=a.shared.hiddenCallbacks,a.shared.hiddenCallbacks=d===null?m:d.concat(m))));break;case 26:var S=Wa;if(Fr(l,a),kr(a),m&512&&(Bi||d===null||is(d,d.return)),m&4){var M=d!==null?d.memoizedState:null;if(m=a.memoizedState,d===null)if(m===null)if(a.stateNode===null){e:{m=a.type,d=a.memoizedProps,S=S.ownerDocument||S;t:switch(m){case"title":M=S.getElementsByTagName("title")[0],(!M||M[mt]||M[Si]||M.namespaceURI==="http://www.w3.org/2000/svg"||M.hasAttribute("itemprop"))&&(M=S.createElement(m),S.head.insertBefore(M,S.querySelector("head > title"))),Os(M,m,d),M[Si]=a,J(M),m=M;break e;case"link":var H=MC("link","href",S).get(m+(d.href||""));if(H){for(var Q=0;Q<H.length;Q++)if(M=H[Q],M.getAttribute("href")===(d.href==null||d.href===""?null:d.href)&&M.getAttribute("rel")===(d.rel==null?null:d.rel)&&M.getAttribute("title")===(d.title==null?null:d.title)&&M.getAttribute("crossorigin")===(d.crossOrigin==null?null:d.crossOrigin)){H.splice(Q,1);break t}}M=S.createElement(m),Os(M,m,d),S.head.appendChild(M);break;case"meta":if(H=MC("meta","content",S).get(m+(d.content||""))){for(Q=0;Q<H.length;Q++)if(M=H[Q],M.getAttribute("content")===(d.content==null?null:""+d.content)&&M.getAttribute("name")===(d.name==null?null:d.name)&&M.getAttribute("property")===(d.property==null?null:d.property)&&M.getAttribute("http-equiv")===(d.httpEquiv==null?null:d.httpEquiv)&&M.getAttribute("charset")===(d.charSet==null?null:d.charSet)){H.splice(Q,1);break t}}M=S.createElement(m),Os(M,m,d),S.head.appendChild(M);break;default:throw Error(n(468,m))}M[Si]=a,J(M),m=M}a.stateNode=m}else wC(S,a.type,a.stateNode);else a.stateNode=TC(S,m,a.memoizedProps);else M!==m?(M===null?d.stateNode!==null&&(d=d.stateNode,d.parentNode.removeChild(d)):M.count--,m===null?wC(S,a.type,a.stateNode):TC(S,m,a.memoizedProps)):m===null&&a.stateNode!==null&&Ur(a,a.memoizedProps,d.memoizedProps)}break;case 27:Fr(l,a),kr(a),m&512&&(Bi||d===null||is(d,d.return)),d!==null&&m&4&&Ur(a,a.memoizedProps,d.memoizedProps);break;case 5:if(Fr(l,a),kr(a),m&512&&(Bi||d===null||is(d,d.return)),a.flags&32){S=a.stateNode;try{Ei(S,"")}catch(nn){hi(a,a.return,nn)}}m&4&&a.stateNode!=null&&(S=a.memoizedProps,Ur(a,S,d!==null?d.memoizedProps:S)),m&1024&&(ho=!0);break;case 6:if(Fr(l,a),kr(a),m&4){if(a.stateNode===null)throw Error(n(162));m=a.memoizedProps,d=a.stateNode;try{d.nodeValue=m}catch(nn){hi(a,a.return,nn)}}break;case 3:if(H_=null,S=Wa,Wa=z_(l.containerInfo),Fr(l,a),Wa=S,kr(a),m&4&&d!==null&&d.memoizedState.isDehydrated)try{cm(l.containerInfo)}catch(nn){hi(a,a.return,nn)}ho&&(ho=!1,nm(a));break;case 4:m=Wa,Wa=z_(a.stateNode.containerInfo),Fr(l,a),kr(a),Wa=m;break;case 12:Fr(l,a),kr(a);break;case 31:Fr(l,a),kr(a),m&4&&(m=a.updateQueue,m!==null&&(a.updateQueue=null,Cl(a,m)));break;case 13:Fr(l,a),kr(a),a.child.flags&8192&&a.memoizedState!==null!=(d!==null&&d.memoizedState!==null)&&(Eh=q()),m&4&&(m=a.updateQueue,m!==null&&(a.updateQueue=null,Cl(a,m)));break;case 22:S=a.memoizedState!==null;var de=d!==null&&d.memoizedState!==null,Ne=Ga,Ke=Bi;if(Ga=Ne||S,Bi=Ke||de,Fr(l,a),Bi=Ke,Ga=Ne,kr(a),m&8192)e:for(l=a.stateNode,l._visibility=S?l._visibility&-2:l._visibility|1,S&&(d===null||de||Ga||Bi||Yo(a)),d=null,l=a;;){if(l.tag===5||l.tag===26){if(d===null){de=d=l;try{if(M=de.stateNode,S)H=M.style,typeof H.setProperty=="function"?H.setProperty("display","none","important"):H.display="none";else{Q=de.stateNode;var st=de.memoizedProps.style,Oe=st!=null&&st.hasOwnProperty("display")?st.display:null;Q.style.display=Oe==null||typeof Oe=="boolean"?"":(""+Oe).trim()}}catch(nn){hi(de,de.return,nn)}}}else if(l.tag===6){if(d===null){de=l;try{de.stateNode.nodeValue=S?"":de.memoizedProps}catch(nn){hi(de,de.return,nn)}}}else if(l.tag===18){if(d===null){de=l;try{var We=de.stateNode;S?gC(We,!0):gC(de.stateNode,!1)}catch(nn){hi(de,de.return,nn)}}}else if((l.tag!==22&&l.tag!==23||l.memoizedState===null||l===a)&&l.child!==null){l.child.return=l,l=l.child;continue}if(l===a)break e;for(;l.sibling===null;){if(l.return===null||l.return===a)break e;d===l&&(d=null),l=l.return}d===l&&(d=null),l.sibling.return=l.return,l=l.sibling}m&4&&(m=a.updateQueue,m!==null&&(d=m.retryQueue,d!==null&&(m.retryQueue=null,Cl(a,d))));break;case 19:Fr(l,a),kr(a),m&4&&(m=a.updateQueue,m!==null&&(a.updateQueue=null,Cl(a,m)));break;case 30:break;case 21:break;default:Fr(l,a),kr(a)}}function kr(a){var l=a.flags;if(l&2){try{for(var d,m=a.return;m!==null;){if(ji(m)){d=m;break}m=m.return}if(d==null)throw Error(n(160));switch(d.tag){case 27:var S=d.stateNode,M=Xn(a);Ns(a,M,S);break;case 5:var H=d.stateNode;d.flags&32&&(Ei(H,""),d.flags&=-33);var Q=Xn(a);Ns(a,Q,H);break;case 3:case 4:var de=d.stateNode.containerInfo,Ne=Xn(a);Xo(a,Ne,de);break;default:throw Error(n(161))}}catch(Ke){hi(a,a.return,Ke)}a.flags&=-3}l&4096&&(a.flags&=-4097)}function nm(a){if(a.subtreeFlags&1024)for(a=a.child;a!==null;){var l=a;nm(l),l.tag===5&&l.flags&1024&&l.stateNode.reset(),a=a.sibling}}function qa(a,l){if(l.subtreeFlags&8772)for(l=l.child;l!==null;)Wi(a,l.alternate,l),l=l.sibling}function Yo(a){for(a=a.child;a!==null;){var l=a;switch(l.tag){case 0:case 11:case 14:case 15:ns(4,l,l.return),Yo(l);break;case 1:is(l,l.return);var d=l.stateNode;typeof d.componentWillUnmount=="function"&&Jr(l,l.return,d),Yo(l);break;case 27:k0(l.stateNode);case 26:case 5:is(l,l.return),Yo(l);break;case 22:l.memoizedState===null&&Yo(l);break;case 30:Yo(l);break;default:Yo(l)}a=a.sibling}}function Ps(a,l,d){for(d=d&&(l.subtreeFlags&8772)!==0,l=l.child;l!==null;){var m=l.alternate,S=a,M=l,H=M.flags;switch(M.tag){case 0:case 11:case 15:Ps(S,M,d),Ha(4,M);break;case 1:if(Ps(S,M,d),m=M,S=m.stateNode,typeof S.componentDidMount=="function")try{S.componentDidMount()}catch(Ne){hi(m,m.return,Ne)}if(m=M,S=m.updateQueue,S!==null){var Q=m.stateNode;try{var de=S.shared.hiddenCallbacks;if(de!==null)for(S.shared.hiddenCallbacks=null,S=0;S<de.length;S++)vh(de[S],Q)}catch(Ne){hi(m,m.return,Ne)}}d&&H&64&&uo(M),wl(M,M.return);break;case 27:em(M);case 26:case 5:Ps(S,M,d),d&&m===null&&H&4&&nd(M),wl(M,M.return);break;case 12:Ps(S,M,d);break;case 31:Ps(S,M,d),d&&H&4&&yc(S,M);break;case 13:Ps(S,M,d),d&&H&4&&Sh(S,M);break;case 22:M.memoizedState===null&&Ps(S,M,d),wl(M,M.return);break;case 30:break;default:Ps(S,M,d)}l=l.sibling}}function xc(a,l){var d=null;a!==null&&a.memoizedState!==null&&a.memoizedState.cachePool!==null&&(d=a.memoizedState.cachePool.pool),a=null,l.memoizedState!==null&&l.memoizedState.cachePool!==null&&(a=l.memoizedState.cachePool.pool),a!==d&&(a!=null&&a.refCount++,d!=null&&nu(d))}function gu(a,l){a=null,l.alternate!==null&&(a=l.alternate.memoizedState.cache),l=l.memoizedState.cache,l!==a&&(l.refCount++,a!=null&&nu(a))}function rs(a,l,d,m){if(l.subtreeFlags&10256)for(l=l.child;l!==null;)B0(a,l,d,m),l=l.sibling}function B0(a,l,d,m){var S=l.flags;switch(l.tag){case 0:case 11:case 15:rs(a,l,d,m),S&2048&&Ha(9,l);break;case 1:rs(a,l,d,m);break;case 3:rs(a,l,d,m),S&2048&&(a=null,l.alternate!==null&&(a=l.alternate.memoizedState.cache),l=l.memoizedState.cache,l!==a&&(l.refCount++,a!=null&&nu(a)));break;case 12:if(S&2048){rs(a,l,d,m),a=l.stateNode;try{var M=l.memoizedProps,H=M.id,Q=M.onPostCommit;typeof Q=="function"&&Q(H,l.alternate===null?"mount":"update",a.passiveEffectDuration,-0)}catch(de){hi(l,l.return,de)}}else rs(a,l,d,m);break;case 31:rs(a,l,d,m);break;case 13:rs(a,l,d,m);break;case 23:break;case 22:M=l.stateNode,H=l.alternate,l.memoizedState!==null?M._visibility&2?rs(a,l,d,m):Jo(a,l):M._visibility&2?rs(a,l,d,m):(M._visibility|=2,ss(a,l,d,m,(l.subtreeFlags&10256)!==0||!1)),S&2048&&xc(H,l);break;case 24:rs(a,l,d,m),S&2048&&gu(l.alternate,l);break;default:rs(a,l,d,m)}}function ss(a,l,d,m,S){for(S=S&&((l.subtreeFlags&10256)!==0||!1),l=l.child;l!==null;){var M=a,H=l,Q=d,de=m,Ne=H.flags;switch(H.tag){case 0:case 11:case 15:ss(M,H,Q,de,S),Ha(8,H);break;case 23:break;case 22:var Ke=H.stateNode;H.memoizedState!==null?Ke._visibility&2?ss(M,H,Q,de,S):Jo(M,H):(Ke._visibility|=2,ss(M,H,Q,de,S)),S&&Ne&2048&&xc(H.alternate,H);break;case 24:ss(M,H,Q,de,S),S&&Ne&2048&&gu(H.alternate,H);break;default:ss(M,H,Q,de,S)}l=l.sibling}}function Jo(a,l){if(l.subtreeFlags&10256)for(l=l.child;l!==null;){var d=a,m=l,S=m.flags;switch(m.tag){case 22:Jo(d,m),S&2048&&xc(m.alternate,m);break;case 24:Jo(d,m),S&2048&&gu(m.alternate,m);break;default:Jo(d,m)}l=l.sibling}}var vu=8192;function xa(a,l,d){if(a.subtreeFlags&vu)for(a=a.child;a!==null;)im(a,l,d),a=a.sibling}function im(a,l,d){switch(a.tag){case 26:xa(a,l,d),a.flags&vu&&a.memoizedState!==null&&cU(d,Wa,a.memoizedState,a.memoizedProps);break;case 5:xa(a,l,d);break;case 3:case 4:var m=Wa;Wa=z_(a.stateNode.containerInfo),xa(a,l,d),Wa=m;break;case 22:a.memoizedState===null&&(m=a.alternate,m!==null&&m.memoizedState!==null?(m=vu,vu=16777216,xa(a,l,d),vu=m):xa(a,l,d));break;default:xa(a,l,d)}}function yu(a){var l=a.alternate;if(l!==null&&(a=l.child,a!==null)){l.child=null;do l=a.sibling,a.sibling=null,a=l;while(a!==null)}}function bc(a){var l=a.deletions;if((a.flags&16)!==0){if(l!==null)for(var d=0;d<l.length;d++){var m=l[d];Kr=m,or(m,a)}yu(a)}if(a.subtreeFlags&10256)for(a=a.child;a!==null;)ea(a),a=a.sibling}function ea(a){switch(a.tag){case 0:case 11:case 15:bc(a),a.flags&2048&&ns(9,a,a.return);break;case 3:bc(a);break;case 12:bc(a);break;case 22:var l=a.stateNode;a.memoizedState!==null&&l._visibility&2&&(a.return===null||a.return.tag!==13)?(l._visibility&=-3,ta(a)):bc(a);break;default:bc(a)}}function ta(a){var l=a.deletions;if((a.flags&16)!==0){if(l!==null)for(var d=0;d<l.length;d++){var m=l[d];Kr=m,or(m,a)}yu(a)}for(a=a.child;a!==null;){switch(l=a,l.tag){case 0:case 11:case 15:ns(8,l,l.return),ta(l);break;case 22:d=l.stateNode,d._visibility&2&&(d._visibility&=-3,ta(l));break;default:ta(l)}a=a.sibling}}function or(a,l){for(;Kr!==null;){var d=Kr;switch(d.tag){case 0:case 11:case 15:ns(8,d,l);break;case 23:case 22:if(d.memoizedState!==null&&d.memoizedState.cachePool!==null){var m=d.memoizedState.cachePool.pool;m!=null&&m.refCount++}break;case 24:nu(d.memoizedState.cache)}if(m=d.child,m!==null)m.return=d,Kr=m;else e:for(d=a;Kr!==null;){m=Kr;var S=m.sibling,M=m.return;if(id(m),m===d){Kr=null;break e}if(S!==null){S.return=M,Kr=S;break e}Kr=M}}}var Rl={getCacheForType:function(a){var l=bn(Mr),d=l.data.get(a);return d===void 0&&(d=a(),l.data.set(a,d)),d},cacheSignal:function(){return bn(Mr).controller.signal}},Nn=typeof WeakMap=="function"?WeakMap:Map,ln=0,En=null,kn=null,On=0,ti=0,ps=null,Xa=!1,fo=!1,L0=!1,ba=0,Qi=0,Ko=0,Ac=0,rd=0,Bs=0,ki=0,_u=null,lr=null,cr=!1,Eh=0,O0=0,_r=1/0,Zi=null,xr=null,bi=0,Aa=null,Th=null,Ya=0,Mh=0,wh=null,sd=null,Sc=0,xu=null;function Sa(){return(ln&2)!==0&&On!==0?On&-On:te.T!==null?Ve():Es()}function jn(){if(Bs===0)if((On&536870912)===0||Zn){var a=at;at<<=1,(at&3932160)===0&&(at=262144),Bs=a}else Bs=536870912;return a=Ks.current,a!==null&&(a.flags|=32),Bs}function zn(a,l,d){(a===En&&(ti===2||ti===9)||a.cancelPendingCommit!==null)&&(Tc(a,0),Cr(a,On,Bs,!1)),Ii(a,d),((ln&2)===0||a!==En)&&(a===En&&((ln&2)===0&&(Ac|=d),Qi===4&&Cr(a,On,Bs,!1)),Et(a))}function Wn(a,l,d){if((ln&6)!==0)throw Error(n(327));var m=!d&&(l&127)===0&&(l&a.expiredLanes)===0||pt(a,l),S=m?ad(a,l):Ls(a,l,!0),M=m;do{if(S===0){fo&&!m&&Cr(a,l,0,!1);break}else{if(d=a.current.alternate,M&&!Ai(d)){S=Ls(a,l,!1),M=!1;continue}if(S===2){if(M=l,a.errorRecoveryDisabledLanes&M)var H=0;else H=a.pendingLanes&-536870913,H=H!==0?H:H&536870912?536870912:0;if(H!==0){l=H;e:{var Q=a;S=_u;var de=Q.current.memoizedState.isDehydrated;if(de&&(Tc(Q,H).flags|=256),H=Ls(Q,H,!1),H!==2){if(L0&&!de){Q.errorRecoveryDisabledLanes|=M,Ac|=M,S=4;break e}M=lr,lr=S,M!==null&&(lr===null?lr=M:lr.push.apply(lr,M))}S=H}if(M=!1,S!==2)continue}}if(S===1){Tc(a,0),Cr(a,l,0,!0);break}e:{switch(m=a,M=S,M){case 0:case 1:throw Error(n(345));case 4:if((l&4194048)!==l)break;case 6:Cr(m,l,Bs,!Xa);break e;case 2:lr=null;break;case 3:case 5:break;default:throw Error(n(329))}if((l&62914560)===l&&(S=Eh+300-q(),10<S)){if(Cr(m,l,Bs,!Xa),Ye(m,0,!0)!==0)break e;Ya=l,m.timeoutHandle=dC(Yn.bind(null,m,d,lr,Zi,cr,l,Bs,Ac,ki,Xa,M,"Throttled",-0,0),S);break e}Yn(m,d,lr,Zi,cr,l,Bs,Ac,ki,Xa,M,null,-0,0)}}break}while(!0);Et(a)}function Yn(a,l,d,m,S,M,H,Q,de,Ne,Ke,st,Oe,We){if(a.timeoutHandle=-1,st=l.subtreeFlags,st&8192||(st&16785408)===16785408){st={stylesheets:null,count:0,imgCount:0,imgBytes:0,suspenseyImages:[],waitingForImages:!0,waitingForViewTransition:!1,unsuspend:no},im(l,M,st);var nn=(M&62914560)===M?Eh-q():(M&4194048)===M?O0-q():0;if(nn=uU(st,nn),nn!==null){Ya=M,a.cancelPendingCommit=nn(Dl.bind(null,a,l,M,d,m,S,H,Q,de,Ke,st,null,Oe,We)),Cr(a,M,H,!Ne);return}}Dl(a,l,M,d,m,S,H,Q,de)}function Ai(a){for(var l=a;;){var d=l.tag;if((d===0||d===11||d===15)&&l.flags&16384&&(d=l.updateQueue,d!==null&&(d=d.stores,d!==null)))for(var m=0;m<d.length;m++){var S=d[m],M=S.getSnapshot;S=S.value;try{if(!Cs(M(),S))return!1}catch{return!1}}if(d=l.child,l.subtreeFlags&16384&&d!==null)d.return=l,l=d;else{if(l===a)break;for(;l.sibling===null;){if(l.return===null||l.return===a)return!0;l=l.return}l.sibling.return=l.return,l=l.sibling}}return!0}function Cr(a,l,d,m){l&=~rd,l&=~Ac,a.suspendedLanes|=l,a.pingedLanes&=~l,m&&(a.warmLanes|=l),m=a.expirationTimes;for(var S=l;0<S;){var M=31-oe(S),H=1<<M;m[M]=-1,S&=~H}d!==0&&As(a,d,l)}function po(){return(ln&6)===0?(Jt(0),!1):!0}function Ec(){if(kn!==null){if(ti===0)var a=kn.return;else a=kn,zo=uc=null,s0(a),ou=null,lu=0,a=kn;for(;a!==null;)_a(a.alternate,a),a=a.return;kn=null}}function Tc(a,l){var d=a.timeoutHandle;d!==-1&&(a.timeoutHandle=-1,qO(d)),d=a.cancelPendingCommit,d!==null&&(a.cancelPendingCommit=null,d()),Ya=0,Ec(),En=a,kn=d=Xs(a.current,null),On=l,ti=0,ps=null,Xa=!1,fo=pt(a,l),L0=!1,ki=Bs=rd=Ac=Ko=Qi=0,lr=_u=null,cr=!1,(l&8)!==0&&(l|=l&32);var m=a.entangledLanes;if(m!==0)for(a=a.entanglements,m&=l;0<m;){var S=31-oe(m),M=1<<S;l|=a[S],m&=~M}return ba=l,kf(),d}function Qo(a,l){Dn=null,te.H=bh,l===iu||l===Fn?(l=su(),ti=3):l===Gf?(l=su(),ti=4):ti=l===Wp?8:l!==null&&typeof l=="object"&&typeof l.then=="function"?6:1,ps=l,kn===null&&(Qi=1,jp(a,ma(l,a.current)))}function $i(){var a=Ks.current;return a===null?!0:(On&4194048)===On?Ds===null:(On&62914560)===On||(On&536870912)!==0?a===Ds:!1}function Il(){var a=te.H;return te.H=bh,a===null?bh:a}function Mc(){var a=te.A;return te.A=Rl,a}function Ch(){Qi=4,Xa||(On&4194048)!==On&&Ks.current!==null||(fo=!0),(Ko&134217727)===0&&(Ac&134217727)===0||En===null||Cr(En,On,Bs,!1)}function Ls(a,l,d){var m=ln;ln|=2;var S=Il(),M=Mc();(En!==a||On!==l)&&(Zi=null,Tc(a,l)),l=!1;var H=Qi;e:do try{if(ti!==0&&kn!==null){var Q=kn,de=ps;switch(ti){case 8:Ec(),H=6;break e;case 3:case 2:case 9:case 6:Ks.current===null&&(l=!0);var Ne=ti;if(ti=0,ps=null,bu(a,Q,de,Ne),d&&fo){H=0;break e}break;default:Ne=ti,ti=0,ps=null,bu(a,Q,de,Ne)}}Rh(),H=Qi;break}catch(Ke){Qo(a,Ke)}while(!0);return l&&a.shellSuspendCounter++,zo=uc=null,ln=m,te.H=S,te.A=M,kn===null&&(En=null,On=0,kf()),H}function Rh(){for(;kn!==null;)rm(kn)}function ad(a,l){var d=ln;ln|=2;var m=Il(),S=Mc();En!==a||On!==l?(Zi=null,_r=q()+500,Tc(a,l)):fo=pt(a,l);e:do try{if(ti!==0&&kn!==null){l=kn;var M=ps;t:switch(ti){case 1:ti=0,ps=null,bu(a,l,M,1);break;case 2:case 9:if(Js(M)){ti=0,ps=null,od(l);break}l=function(){ti!==2&&ti!==9||En!==a||(ti=7),Et(a)},M.then(l,l);break e;case 3:ti=7;break e;case 4:ti=5;break e;case 7:Js(M)?(ti=0,ps=null,od(l)):(ti=0,ps=null,bu(a,l,M,7));break;case 5:var H=null;switch(kn.tag){case 26:H=kn.memoizedState;case 5:case 27:var Q=kn;if(H?CC(H):Q.stateNode.complete){ti=0,ps=null;var de=Q.sibling;if(de!==null)kn=de;else{var Ne=Q.return;Ne!==null?(kn=Ne,wc(Ne)):kn=null}break t}}ti=0,ps=null,bu(a,l,M,5);break;case 6:ti=0,ps=null,bu(a,l,M,6);break;case 8:Ec(),Qi=6;break e;default:throw Error(n(462))}}na();break}catch(Ke){Qo(a,Ke)}while(!0);return zo=uc=null,te.H=m,te.A=S,ln=d,kn!==null?0:(En=null,On=0,kf(),Qi)}function na(){for(;kn!==null&&!bt();)rm(kn)}function rm(a){var l=$p(a.alternate,a,ba);a.memoizedProps=a.pendingProps,l===null?wc(a):kn=l}function od(a){var l=a,d=l.alternate;switch(l.tag){case 15:case 0:l=Zf(d,l,l.pendingProps,l.type,void 0,On);break;case 11:l=Zf(d,l,l.pendingProps,l.type.render,l.ref,On);break;case 5:s0(l);default:_a(d,l),l=kn=oh(l,ba),l=$p(d,l,ba)}a.memoizedProps=a.pendingProps,l===null?wc(a):kn=l}function bu(a,l,d,m){zo=uc=null,s0(l),ou=null,lu=0;var S=l.return;try{if(Or(a,S,l,d,On)){Qi=1,jp(a,ma(d,a.current)),kn=null;return}}catch(M){if(S!==null)throw kn=S,M;Qi=1,jp(a,ma(d,a.current)),kn=null;return}l.flags&32768?(Zn||m===1?a=!0:fo||(On&536870912)!==0?a=!1:(Xa=a=!0,(m===2||m===9||m===3||m===6)&&(m=Ks.current,m!==null&&m.tag===13&&(m.flags|=16384))),ld(l,a)):wc(l)}function wc(a){var l=a;do{if((l.flags&32768)!==0){ld(l,Xa);return}a=l.return;var d=td(l.alternate,l,ba);if(d!==null){kn=d;return}if(l=l.sibling,l!==null){kn=l;return}kn=l=a}while(l!==null);Qi===0&&(Qi=5)}function ld(a,l){do{var d=Va(a.alternate,a);if(d!==null){d.flags&=32767,kn=d;return}if(d=a.return,d!==null&&(d.flags|=32768,d.subtreeFlags=0,d.deletions=null),!l&&(a=a.sibling,a!==null)){kn=a;return}kn=a=d}while(a!==null);Qi=6,kn=null}function Dl(a,l,d,m,S,M,H,Q,de){a.cancelPendingCommit=null;do Ih();while(bi!==0);if((ln&6)!==0)throw Error(n(327));if(l!==null){if(l===a.current)throw Error(n(177));if(M=l.lanes|l.childLanes,M|=qr,Xi(a,d,M,H,Q,de),a===En&&(kn=En=null,On=0),Th=l,Aa=a,Ya=d,Mh=M,wh=S,sd=m,(l.subtreeFlags&10256)!==0||(l.flags&10256)!==0?(a.callbackNode=null,a.callbackPriority=0,I(Ue,function(){return sm(),null})):(a.callbackNode=null,a.callbackPriority=0),m=(l.flags&13878)!==0,(l.subtreeFlags&13878)!==0||m){m=te.T,te.T=null,S=se.p,se.p=2,H=ln,ln|=4;try{eE(a,l,d)}finally{ln=H,se.p=S,te.T=m}}bi=1,Rr(),Nl(),Au()}}function Rr(){if(bi===1){bi=0;var a=Aa,l=Th,d=(l.flags&13878)!==0;if((l.subtreeFlags&13878)!==0||d){d=te.T,te.T=null;var m=se.p;se.p=2;var S=ln;ln|=4;try{_c(l,a);var M=oE,H=Fy(a.containerInfo),Q=M.focusedElem,de=M.selectionRange;if(H!==Q&&Q&&Q.ownerDocument&&Ni(Q.ownerDocument.documentElement,Q)){if(de!==null&&Vg(Q)){var Ne=de.start,Ke=de.end;if(Ke===void 0&&(Ke=Ne),"selectionStart"in Q)Q.selectionStart=Ne,Q.selectionEnd=Math.min(Ke,Q.value.length);else{var st=Q.ownerDocument||document,Oe=st&&st.defaultView||window;if(Oe.getSelection){var We=Oe.getSelection(),nn=Q.textContent.length,xn=Math.min(de.start,nn),Oi=de.end===void 0?xn:Math.min(de.end,nn);!We.extend&&xn>Oi&&(H=Oi,Oi=xn,xn=H);var Me=rh(Q,xn),_e=rh(Q,Oi);if(Me&&_e&&(We.rangeCount!==1||We.anchorNode!==Me.node||We.anchorOffset!==Me.offset||We.focusNode!==_e.node||We.focusOffset!==_e.offset)){var De=st.createRange();De.setStart(Me.node,Me.offset),We.removeAllRanges(),xn>Oi?(We.addRange(De),We.extend(_e.node,_e.offset)):(De.setEnd(_e.node,_e.offset),We.addRange(De))}}}}for(st=[],We=Q;We=We.parentNode;)We.nodeType===1&&st.push({element:We,left:We.scrollLeft,top:We.scrollTop});for(typeof Q.focus=="function"&&Q.focus(),Q=0;Q<st.length;Q++){var et=st[Q];et.element.scrollLeft=et.left,et.element.scrollTop=et.top}}q_=!!aE,oE=aE=null}finally{ln=S,se.p=m,te.T=d}}a.current=l,bi=2}}function Nl(){if(bi===2){bi=0;var a=Aa,l=Th,d=(l.flags&8772)!==0;if((l.subtreeFlags&8772)!==0||d){d=te.T,te.T=null;var m=se.p;se.p=2;var S=ln;ln|=4;try{Wi(a,l.alternate,l)}finally{ln=S,se.p=m,te.T=d}}bi=3}}function Au(){if(bi===4||bi===3){bi=0,ee();var a=Aa,l=Th,d=Ya,m=sd;(l.subtreeFlags&10256)!==0||(l.flags&10256)!==0?bi=5:(bi=0,Th=Aa=null,Zo(a,a.pendingLanes));var S=a.pendingLanes;if(S===0&&(xr=null),fr(d),l=l.stateNode,it&&typeof it.onCommitFiberRoot=="function")try{it.onCommitFiberRoot(tt,l,void 0,(l.current.flags&128)===128)}catch{}if(m!==null){l=te.T,S=se.p,se.p=2,te.T=null;try{for(var M=a.onRecoverableError,H=0;H<m.length;H++){var Q=m[H];M(Q.value,{componentStack:Q.stack})}}finally{te.T=l,se.p=S}}(Ya&3)!==0&&Ih(),Et(a),S=a.pendingLanes,(d&261930)!==0&&(S&42)!==0?a===xu?Sc++:(Sc=0,xu=a):Sc=0,Jt(0)}}function Zo(a,l){(a.pooledCacheLanes&=l)===0&&(l=a.pooledCache,l!=null&&(a.pooledCache=null,nu(l)))}function Ih(){return Rr(),Nl(),Au(),sm()}function sm(){if(bi!==5)return!1;var a=Aa,l=Mh;Mh=0;var d=fr(Ya),m=te.T,S=se.p;try{se.p=32>d?32:d,te.T=null,d=wh,wh=null;var M=Aa,H=Ya;if(bi=0,Th=Aa=null,Ya=0,(ln&6)!==0)throw Error(n(331));var Q=ln;if(ln|=4,ea(M.current),B0(M,M.current,H,d),ln=Q,Jt(0,!1),it&&typeof it.onPostCommitFiberRoot=="function")try{it.onPostCommitFiberRoot(tt,M)}catch{}return!0}finally{se.p=S,te.T=m,Zo(a,l)}}function U0(a,l,d){l=ma(d,l),l=w0(a.stateNode,l,2),a=dc(a,l,2),a!==null&&(Ii(a,2),Et(a))}function hi(a,l,d){if(a.tag===3)U0(a,a,d);else for(;l!==null;){if(l.tag===3){U0(l,a,d);break}else if(l.tag===1){var m=l.stateNode;if(typeof l.type.getDerivedStateFromError=="function"||typeof m.componentDidCatch=="function"&&(xr===null||!xr.has(m))){a=ma(d,a),d=C0(2),m=dc(l,d,2),m!==null&&(D_(d,m,l,a),Ii(m,2),Et(m));break}}l=l.return}}function cd(a,l,d){var m=a.pingCache;if(m===null){m=a.pingCache=new Nn;var S=new Set;m.set(l,S)}else S=m.get(l),S===void 0&&(S=new Set,m.set(l,S));S.has(d)||(L0=!0,S.add(d),a=c.bind(null,a,l,d),l.then(a,a))}function c(a,l,d){var m=a.pingCache;m!==null&&m.delete(l),a.pingedLanes|=a.suspendedLanes&d,a.warmLanes&=~d,En===a&&(On&d)===d&&(Qi===4||Qi===3&&(On&62914560)===On&&300>q()-Eh?(ln&2)===0&&Tc(a,0):rd|=d,ki===On&&(ki=0)),Et(a)}function h(a,l){l===0&&(l=Tn()),a=Rs(a,l),a!==null&&(Ii(a,l),Et(a))}function y(a){var l=a.memoizedState,d=0;l!==null&&(d=l.retryLane),h(a,d)}function A(a,l){var d=0;switch(a.tag){case 31:case 13:var m=a.stateNode,S=a.memoizedState;S!==null&&(d=S.retryLane);break;case 19:m=a.stateNode;break;case 22:m=a.stateNode._retryCache;break;default:throw Error(n(314))}m!==null&&m.delete(l),h(a,d)}function I(a,l){return vt(a,l)}var B=null,K=null,pe=!1,je=!1,ft=!1,Bt=0;function Et(a){a!==K&&a.next===null&&(K===null?B=K=a:K=K.next=a),je=!0,pe||(pe=!0,we())}function Jt(a,l){if(!ft&&je){ft=!0;do for(var d=!1,m=B;m!==null;){if(a!==0){var S=m.pendingLanes;if(S===0)var M=0;else{var H=m.suspendedLanes,Q=m.pingedLanes;M=(1<<31-oe(42|a)+1)-1,M&=S&~(H&~Q),M=M&201326741?M&201326741|1:M?M|2:0}M!==0&&(d=!0,Be(m,M))}else M=On,M=Ye(m,m===En?M:0,m.cancelPendingCommit!==null||m.timeoutHandle!==-1),(M&3)===0||pt(m,M)||(d=!0,Be(m,M));m=m.next}while(d);ft=!1}}function Rn(){br()}function br(){je=pe=!1;var a=0;Bt!==0&&WO()&&(a=Bt);for(var l=q(),d=null,m=B;m!==null;){var S=m.next,M=Dh(m,l);M===0?(m.next=null,d===null?B=S:d.next=S,S===null&&(K=d)):(d=m,(a!==0||(M&3)!==0)&&(je=!0)),m=S}bi!==0&&bi!==5||Jt(a),Bt!==0&&(Bt=0)}function Dh(a,l){for(var d=a.suspendedLanes,m=a.pingedLanes,S=a.expirationTimes,M=a.pendingLanes&-62914561;0<M;){var H=31-oe(M),Q=1<<H,de=S[H];de===-1?((Q&d)===0||(Q&m)!==0)&&(S[H]=rn(Q,l)):de<=l&&(a.expiredLanes|=Q),M&=~Q}if(l=En,d=On,d=Ye(a,a===l?d:0,a.cancelPendingCommit!==null||a.timeoutHandle!==-1),m=a.callbackNode,d===0||a===l&&(ti===2||ti===9)||a.cancelPendingCommit!==null)return m!==null&&m!==null&&Qt(m),a.callbackNode=null,a.callbackPriority=0;if((d&3)===0||pt(a,d)){if(l=d&-d,l===a.callbackPriority)return l;switch(m!==null&&Qt(m),fr(d)){case 2:case 8:d=Xe;break;case 32:d=Ue;break;case 268435456:d=Ct;break;default:d=Ue}return m=Cc.bind(null,a),d=vt(d,m),a.callbackPriority=l,a.callbackNode=d,l}return m!==null&&m!==null&&Qt(m),a.callbackPriority=2,a.callbackNode=null,2}function Cc(a,l){if(bi!==0&&bi!==5)return a.callbackNode=null,a.callbackPriority=0,null;var d=a.callbackNode;if(Ih()&&a.callbackNode!==d)return null;var m=On;return m=Ye(a,a===En?m:0,a.cancelPendingCommit!==null||a.timeoutHandle!==-1),m===0?null:(Wn(a,m,l),Dh(a,q()),a.callbackNode!=null&&a.callbackNode===d?Cc.bind(null,a):null)}function Be(a,l){if(Ih())return null;Wn(a,l,!0)}function we(){XO(function(){(ln&6)!==0?vt(Fe,Rn):br()})}function Ve(){if(Bt===0){var a=bl;a===0&&(a=Ce,Ce<<=1,(Ce&261888)===0&&(Ce=256)),Bt=a}return Bt}function Nt(a){return a==null||typeof a=="symbol"||typeof a=="boolean"?null:typeof a=="function"?a:qc(""+a)}function pn(a,l){var d=l.ownerDocument.createElement("input");return d.name=l.name,d.value=l.value,a.id&&d.setAttribute("form",a.id),l.parentNode.insertBefore(d,l),a=new FormData(a),d.parentNode.removeChild(d),a}function er(a,l,d,m,S){if(l==="submit"&&d&&d.stateNode===S){var M=Nt((S[X]||null).action),H=m.submitter;H&&(l=(l=H[X]||null)?Nt(l.formAction):H.getAttribute("formAction"),l!==null&&(M=l,H=null));var Q=new so("action","action",null,m,S);a.push({event:Q,listeners:[{instance:null,listener:function(){if(m.defaultPrevented){if(Bt!==0){var de=H?pn(S,H):new FormData(S);_0(d,{pending:!0,data:de,method:S.method,action:M},null,de)}}else typeof M=="function"&&(Q.preventDefault(),de=H?pn(S,H):new FormData(S),_0(d,{pending:!0,data:de,method:S.method,action:M},M,de))},currentTarget:S}]})}}for(var mn=0;mn<Uf.length;mn++){var ri=Uf[mn],Qr=ri.toLowerCase(),di=ri[0].toUpperCase()+ri.slice(1);Ba(Qr,"on"+di)}Ba(yp,"onAnimationEnd"),Ba(Of,"onAnimationIteration"),Ba(Gg,"onAnimationStart"),Ba("dblclick","onDoubleClick"),Ba("focusin","onFocus"),Ba("focusout","onBlur"),Ba(zy,"onTransitionRun"),Ba(qS,"onTransitionStart"),Ba(Vy,"onTransitionCancel"),Ba(jg,"onTransitionEnd"),me("onMouseEnter",["mouseout","mouseover"]),me("onMouseLeave",["mouseout","mouseover"]),me("onPointerEnter",["pointerout","pointerover"]),me("onPointerLeave",["pointerout","pointerover"]),xe("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),xe("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),xe("onBeforeInput",["compositionend","keypress","textInput","paste"]),xe("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),xe("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),xe("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Ja="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),tE=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(Ja));function sC(a,l){l=(l&4)!==0;for(var d=0;d<a.length;d++){var m=a[d],S=m.event;m=m.listeners;e:{var M=void 0;if(l)for(var H=m.length-1;0<=H;H--){var Q=m[H],de=Q.instance,Ne=Q.currentTarget;if(Q=Q.listener,de!==M&&S.isPropagationStopped())break e;M=Q,S.currentTarget=Ne;try{M(S)}catch(Ke){Ff(Ke)}S.currentTarget=null,M=de}else for(H=0;H<m.length;H++){if(Q=m[H],de=Q.instance,Ne=Q.currentTarget,Q=Q.listener,de!==M&&S.isPropagationStopped())break e;M=Q,S.currentTarget=Ne;try{M(S)}catch(Ke){Ff(Ke)}S.currentTarget=null,M=de}}}}function ni(a,l){var d=l[he];d===void 0&&(d=l[he]=new Set);var m=a+"__bubble";d.has(m)||(aC(l,a,2,!1),d.add(m))}function nE(a,l,d){var m=0;l&&(m|=4),aC(d,a,m,l)}var U_="_reactListening"+Math.random().toString(36).slice(2);function iE(a){if(!a[U_]){a[U_]=!0,le.forEach(function(d){d!=="selectionchange"&&(tE.has(d)||nE(d,!1,a),nE(d,!0,a))});var l=a.nodeType===9?a:a.ownerDocument;l===null||l[U_]||(l[U_]=!0,nE("selectionchange",!1,l))}}function aC(a,l,d,m){switch(LC(l)){case 2:var S=dU;break;case 8:S=pU;break;default:S=yE}d=S.bind(null,l,d,a),S=void 0,!Yc||l!=="touchstart"&&l!=="touchmove"&&l!=="wheel"||(S=!0),m?S!==void 0?a.addEventListener(l,d,{capture:!0,passive:S}):a.addEventListener(l,d,!0):S!==void 0?a.addEventListener(l,d,{passive:S}):a.addEventListener(l,d,!1)}function rE(a,l,d,m,S){var M=m;if((l&1)===0&&(l&2)===0&&m!==null)e:for(;;){if(m===null)return;var H=m.tag;if(H===3||H===4){var Q=m.stateNode.containerInfo;if(Q===S)break;if(H===4)for(H=m.return;H!==null;){var de=H.tag;if((de===3||de===4)&&H.stateNode.containerInfo===S)return;H=H.return}for(;Q!==null;){if(H=Rt(Q),H===null)return;if(de=H.tag,de===5||de===6||de===26||de===27){m=M=H;continue e}Q=Q.parentNode}}m=m.return}fl(function(){var Ne=M,Ke=da(d),st=[];e:{var Oe=Pa.get(a);if(Oe!==void 0){var We=so,nn=a;switch(a){case"keypress":if(Zl(d)===0)break e;case"keydown":case"keyup":We=Io;break;case"focusin":nn="focus",We=tc;break;case"focusout":nn="blur",We=tc;break;case"beforeblur":case"afterblur":We=tc;break;case"click":if(d.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":We=Qu;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":We=Cf;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":We=U;break;case yp:case Of:case Gg:We=mp;break;case jg:We=ne;break;case"scroll":case"scrollend":We=Ku;break;case"wheel":We=ze;break;case"copy":case"cut":case"paste":We=Rf;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":We=Do;break;case"toggle":case"beforetoggle":We=Cn}var xn=(l&4)!==0,Oi=!xn&&(a==="scroll"||a==="scrollend"),Me=xn?Oe!==null?Oe+"Capture":null:Oe;xn=[];for(var _e=Ne,De;_e!==null;){var et=_e;if(De=et.stateNode,et=et.tag,et!==5&&et!==26&&et!==27||De===null||Me===null||(et=Ia(_e,Me),et!=null&&xn.push(F0(_e,et,De))),Oi)break;_e=_e.return}0<xn.length&&(Oe=new We(Oe,nn,null,d,Ke),st.push({event:Oe,listeners:xn}))}}if((l&7)===0){e:{if(Oe=a==="mouseover"||a==="pointerover",We=a==="mouseout"||a==="pointerout",Oe&&d!==Yu&&(nn=d.relatedTarget||d.fromElement)&&(Rt(nn)||nn[Z]))break e;if((We||Oe)&&(Oe=Ke.window===Ke?Ke:(Oe=Ke.ownerDocument)?Oe.defaultView||Oe.parentWindow:window,We?(nn=d.relatedTarget||d.toElement,We=Ne,nn=nn?Rt(nn):null,nn!==null&&(Oi=s(nn),xn=nn.tag,nn!==Oi||xn!==5&&xn!==27&&xn!==6)&&(nn=null)):(We=null,nn=Ne),We!==nn)){if(xn=Qu,et="onMouseLeave",Me="onMouseEnter",_e="mouse",(a==="pointerout"||a==="pointerover")&&(xn=Do,et="onPointerLeave",Me="onPointerEnter",_e="pointer"),Oi=We==null?Oe:wt(We),De=nn==null?Oe:wt(nn),Oe=new xn(et,_e+"leave",We,d,Ke),Oe.target=Oi,Oe.relatedTarget=De,et=null,Rt(Ke)===Ne&&(xn=new xn(Me,_e+"enter",nn,d,Ke),xn.target=De,xn.relatedTarget=Oi,et=xn),Oi=et,We&&nn)t:{for(xn=zO,Me=We,_e=nn,De=0,et=Me;et;et=xn(et))De++;et=0;for(var fn=_e;fn;fn=xn(fn))et++;for(;0<De-et;)Me=xn(Me),De--;for(;0<et-De;)_e=xn(_e),et--;for(;De--;){if(Me===_e||_e!==null&&Me===_e.alternate){xn=Me;break t}Me=xn(Me),_e=xn(_e)}xn=null}else xn=null;We!==null&&oC(st,Oe,We,xn,!1),nn!==null&&Oi!==null&&oC(st,Oi,nn,xn,!0)}}e:{if(Oe=Ne?wt(Ne):window,We=Oe.nodeName&&Oe.nodeName.toLowerCase(),We==="select"||We==="input"&&Oe.type==="file")var vi=Og;else if(Lg(Oe))if(No)vi=Uy;else{vi=kg;var on=Ly}else We=Oe.nodeName,!We||We.toLowerCase()!=="input"||Oe.type!=="checkbox"&&Oe.type!=="radio"?Ne&&Ts(Ne.elementType)&&(vi=Og):vi=Oy;if(vi&&(vi=vi(a,Ne))){gp(st,vi,d,Ke);break e}on&&on(a,Oe,Ne),a==="focusout"&&Ne&&Oe.type==="number"&&Ne.memoizedProps.value!=null&&Ln(Oe,"number",Oe.value)}switch(on=Ne?wt(Ne):window,a){case"focusin":(Lg(on)||on.contentEditable==="true")&&(Po=on,Bo=Ne,sh=null);break;case"focusout":sh=Bo=Po=null;break;case"mousedown":vp=!0;break;case"contextmenu":case"mouseup":case"dragend":vp=!1,ah(st,d,Ke);break;case"selectionchange":if(ky)break;case"keydown":case"keyup":ah(st,d,Ke)}var Hn;if(ei)e:{switch(a){case"compositionstart":var si="onCompositionStart";break e;case"compositionend":si="onCompositionEnd";break e;case"compositionupdate":si="onCompositionUpdate";break e}si=void 0}else $c?ml(a,d)&&(si="onCompositionEnd"):a==="keydown"&&d.keyCode===229&&(si="onCompositionStart");si&&(oo&&d.locale!=="ko"&&($c||si!=="onCompositionStart"?si==="onCompositionEnd"&&$c&&(Hn=Ql()):(Ms=Ke,Ju="value"in Ms?Ms.value:Ms.textContent,$c=!0)),on=F_(Ne,si),0<on.length&&(si=new Da(si,a,null,d,Ke),st.push({event:si,listeners:on}),Hn?si.data=Hn:(Hn=Zc(d),Hn!==null&&(si.data=Hn)))),(Hn=ws?Py(a,d):Pg(a,d))&&(si=F_(Ne,"onBeforeInput"),0<si.length&&(on=new Da("onBeforeInput","beforeinput",null,d,Ke),st.push({event:on,listeners:si}),on.data=Hn)),er(st,a,Ne,d,Ke)}sC(st,l)})}function F0(a,l,d){return{instance:a,listener:l,currentTarget:d}}function F_(a,l){for(var d=l+"Capture",m=[];a!==null;){var S=a,M=S.stateNode;if(S=S.tag,S!==5&&S!==26&&S!==27||M===null||(S=Ia(a,d),S!=null&&m.unshift(F0(a,S,M)),S=Ia(a,l),S!=null&&m.push(F0(a,S,M))),a.tag===3)return m;a=a.return}return[]}function zO(a){if(a===null)return null;do a=a.return;while(a&&a.tag!==5&&a.tag!==27);return a||null}function oC(a,l,d,m,S){for(var M=l._reactName,H=[];d!==null&&d!==m;){var Q=d,de=Q.alternate,Ne=Q.stateNode;if(Q=Q.tag,de!==null&&de===m)break;Q!==5&&Q!==26&&Q!==27||Ne===null||(de=Ne,S?(Ne=Ia(d,M),Ne!=null&&H.unshift(F0(d,Ne,de))):S||(Ne=Ia(d,M),Ne!=null&&H.push(F0(d,Ne,de)))),d=d.return}H.length!==0&&a.push({event:l,listeners:H})}var VO=/\r\n?/g,HO=/\u0000|\uFFFD/g;function lC(a){return(typeof a=="string"?a:""+a).replace(VO,`
`).replace(HO,"")}function cC(a,l){return l=lC(l),lC(a)===l}function Li(a,l,d,m,S,M){switch(d){case"children":typeof m=="string"?l==="body"||l==="textarea"&&m===""||Ei(a,m):(typeof m=="number"||typeof m=="bigint")&&l!=="body"&&Ei(a,""+m);break;case"className":jt(a,"class",m);break;case"tabIndex":jt(a,"tabindex",m);break;case"dir":case"role":case"viewBox":case"width":case"height":jt(a,d,m);break;case"style":To(a,m,M);break;case"data":if(l!=="object"){jt(a,"data",m);break}case"src":case"href":if(m===""&&(l!=="a"||d!=="href")){a.removeAttribute(d);break}if(m==null||typeof m=="function"||typeof m=="symbol"||typeof m=="boolean"){a.removeAttribute(d);break}m=qc(""+m),a.setAttribute(d,m);break;case"action":case"formAction":if(typeof m=="function"){a.setAttribute(d,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof M=="function"&&(d==="formAction"?(l!=="input"&&Li(a,l,"name",S.name,S,null),Li(a,l,"formEncType",S.formEncType,S,null),Li(a,l,"formMethod",S.formMethod,S,null),Li(a,l,"formTarget",S.formTarget,S,null)):(Li(a,l,"encType",S.encType,S,null),Li(a,l,"method",S.method,S,null),Li(a,l,"target",S.target,S,null)));if(m==null||typeof m=="symbol"||typeof m=="boolean"){a.removeAttribute(d);break}m=qc(""+m),a.setAttribute(d,m);break;case"onClick":m!=null&&(a.onclick=no);break;case"onScroll":m!=null&&ni("scroll",a);break;case"onScrollEnd":m!=null&&ni("scrollend",a);break;case"dangerouslySetInnerHTML":if(m!=null){if(typeof m!="object"||!("__html"in m))throw Error(n(61));if(d=m.__html,d!=null){if(S.children!=null)throw Error(n(60));a.innerHTML=d}}break;case"multiple":a.multiple=m&&typeof m!="function"&&typeof m!="symbol";break;case"muted":a.muted=m&&typeof m!="function"&&typeof m!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(m==null||typeof m=="function"||typeof m=="boolean"||typeof m=="symbol"){a.removeAttribute("xlink:href");break}d=qc(""+m),a.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",d);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":m!=null&&typeof m!="function"&&typeof m!="symbol"?a.setAttribute(d,""+m):a.removeAttribute(d);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":m&&typeof m!="function"&&typeof m!="symbol"?a.setAttribute(d,""):a.removeAttribute(d);break;case"capture":case"download":m===!0?a.setAttribute(d,""):m!==!1&&m!=null&&typeof m!="function"&&typeof m!="symbol"?a.setAttribute(d,m):a.removeAttribute(d);break;case"cols":case"rows":case"size":case"span":m!=null&&typeof m!="function"&&typeof m!="symbol"&&!isNaN(m)&&1<=m?a.setAttribute(d,m):a.removeAttribute(d);break;case"rowSpan":case"start":m==null||typeof m=="function"||typeof m=="symbol"||isNaN(m)?a.removeAttribute(d):a.setAttribute(d,m);break;case"popover":ni("beforetoggle",a),ni("toggle",a),It(a,"popover",m);break;case"xlinkActuate":At(a,"http://www.w3.org/1999/xlink","xlink:actuate",m);break;case"xlinkArcrole":At(a,"http://www.w3.org/1999/xlink","xlink:arcrole",m);break;case"xlinkRole":At(a,"http://www.w3.org/1999/xlink","xlink:role",m);break;case"xlinkShow":At(a,"http://www.w3.org/1999/xlink","xlink:show",m);break;case"xlinkTitle":At(a,"http://www.w3.org/1999/xlink","xlink:title",m);break;case"xlinkType":At(a,"http://www.w3.org/1999/xlink","xlink:type",m);break;case"xmlBase":At(a,"http://www.w3.org/XML/1998/namespace","xml:base",m);break;case"xmlLang":At(a,"http://www.w3.org/XML/1998/namespace","xml:lang",m);break;case"xmlSpace":At(a,"http://www.w3.org/XML/1998/namespace","xml:space",m);break;case"is":It(a,"is",m);break;case"innerText":case"textContent":break;default:(!(2<d.length)||d[0]!=="o"&&d[0]!=="O"||d[1]!=="n"&&d[1]!=="N")&&(d=wf.get(d)||d,It(a,d,m))}}function sE(a,l,d,m,S,M){switch(d){case"style":To(a,m,M);break;case"dangerouslySetInnerHTML":if(m!=null){if(typeof m!="object"||!("__html"in m))throw Error(n(61));if(d=m.__html,d!=null){if(S.children!=null)throw Error(n(60));a.innerHTML=d}}break;case"children":typeof m=="string"?Ei(a,m):(typeof m=="number"||typeof m=="bigint")&&Ei(a,""+m);break;case"onScroll":m!=null&&ni("scroll",a);break;case"onScrollEnd":m!=null&&ni("scrollend",a);break;case"onClick":m!=null&&(a.onclick=no);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!ye.hasOwnProperty(d))e:{if(d[0]==="o"&&d[1]==="n"&&(S=d.endsWith("Capture"),l=d.slice(2,S?d.length-7:void 0),M=a[X]||null,M=M!=null?M[d]:null,typeof M=="function"&&a.removeEventListener(l,M,S),typeof m=="function")){typeof M!="function"&&M!==null&&(d in a?a[d]=null:a.hasAttribute(d)&&a.removeAttribute(d)),a.addEventListener(l,m,S);break e}d in a?a[d]=m:m===!0?a.setAttribute(d,""):It(a,d,m)}}}function Os(a,l,d){switch(l){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":ni("error",a),ni("load",a);var m=!1,S=!1,M;for(M in d)if(d.hasOwnProperty(M)){var H=d[M];if(H!=null)switch(M){case"src":m=!0;break;case"srcSet":S=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(n(137,l));default:Li(a,l,M,H,d,null)}}S&&Li(a,l,"srcSet",d.srcSet,d,null),m&&Li(a,l,"src",d.src,d,null);return;case"input":ni("invalid",a);var Q=M=H=S=null,de=null,Ne=null;for(m in d)if(d.hasOwnProperty(m)){var Ke=d[m];if(Ke!=null)switch(m){case"name":S=Ke;break;case"type":H=Ke;break;case"checked":de=Ke;break;case"defaultChecked":Ne=Ke;break;case"value":M=Ke;break;case"defaultValue":Q=Ke;break;case"children":case"dangerouslySetInnerHTML":if(Ke!=null)throw Error(n(137,l));break;default:Li(a,l,m,Ke,d,null)}}dr(a,M,Q,de,Ne,H,S,!1);return;case"select":ni("invalid",a),m=H=M=null;for(S in d)if(d.hasOwnProperty(S)&&(Q=d[S],Q!=null))switch(S){case"value":M=Q;break;case"defaultValue":H=Q;break;case"multiple":m=Q;default:Li(a,l,S,Q,d,null)}l=M,d=H,a.multiple=!!m,l!=null?Di(a,!!m,l,!1):d!=null&&Di(a,!!m,d,!0);return;case"textarea":ni("invalid",a),M=S=m=null;for(H in d)if(d.hasOwnProperty(H)&&(Q=d[H],Q!=null))switch(H){case"value":m=Q;break;case"defaultValue":S=Q;break;case"children":M=Q;break;case"dangerouslySetInnerHTML":if(Q!=null)throw Error(n(91));break;default:Li(a,l,H,Q,d,null)}Ui(a,m,S,M);return;case"option":for(de in d)if(d.hasOwnProperty(de)&&(m=d[de],m!=null))switch(de){case"selected":a.selected=m&&typeof m!="function"&&typeof m!="symbol";break;default:Li(a,l,de,m,d,null)}return;case"dialog":ni("beforetoggle",a),ni("toggle",a),ni("cancel",a),ni("close",a);break;case"iframe":case"object":ni("load",a);break;case"video":case"audio":for(m=0;m<Ja.length;m++)ni(Ja[m],a);break;case"image":ni("error",a),ni("load",a);break;case"details":ni("toggle",a);break;case"embed":case"source":case"link":ni("error",a),ni("load",a);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(Ne in d)if(d.hasOwnProperty(Ne)&&(m=d[Ne],m!=null))switch(Ne){case"children":case"dangerouslySetInnerHTML":throw Error(n(137,l));default:Li(a,l,Ne,m,d,null)}return;default:if(Ts(l)){for(Ke in d)d.hasOwnProperty(Ke)&&(m=d[Ke],m!==void 0&&sE(a,l,Ke,m,d,void 0));return}}for(Q in d)d.hasOwnProperty(Q)&&(m=d[Q],m!=null&&Li(a,l,Q,m,d,null))}function GO(a,l,d,m){switch(l){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var S=null,M=null,H=null,Q=null,de=null,Ne=null,Ke=null;for(We in d){var st=d[We];if(d.hasOwnProperty(We)&&st!=null)switch(We){case"checked":break;case"value":break;case"defaultValue":de=st;default:m.hasOwnProperty(We)||Li(a,l,We,null,m,st)}}for(var Oe in m){var We=m[Oe];if(st=d[Oe],m.hasOwnProperty(Oe)&&(We!=null||st!=null))switch(Oe){case"type":M=We;break;case"name":S=We;break;case"checked":Ne=We;break;case"defaultChecked":Ke=We;break;case"value":H=We;break;case"defaultValue":Q=We;break;case"children":case"dangerouslySetInnerHTML":if(We!=null)throw Error(n(137,l));break;default:We!==st&&Li(a,l,Oe,We,m,st)}}Qn(a,H,Q,de,Ne,Ke,M,S);return;case"select":We=H=Q=Oe=null;for(M in d)if(de=d[M],d.hasOwnProperty(M)&&de!=null)switch(M){case"value":break;case"multiple":We=de;default:m.hasOwnProperty(M)||Li(a,l,M,null,m,de)}for(S in m)if(M=m[S],de=d[S],m.hasOwnProperty(S)&&(M!=null||de!=null))switch(S){case"value":Oe=M;break;case"defaultValue":Q=M;break;case"multiple":H=M;default:M!==de&&Li(a,l,S,M,m,de)}l=Q,d=H,m=We,Oe!=null?Di(a,!!d,Oe,!1):!!m!=!!d&&(l!=null?Di(a,!!d,l,!0):Di(a,!!d,d?[]:"",!1));return;case"textarea":We=Oe=null;for(Q in d)if(S=d[Q],d.hasOwnProperty(Q)&&S!=null&&!m.hasOwnProperty(Q))switch(Q){case"value":break;case"children":break;default:Li(a,l,Q,null,m,S)}for(H in m)if(S=m[H],M=d[H],m.hasOwnProperty(H)&&(S!=null||M!=null))switch(H){case"value":Oe=S;break;case"defaultValue":We=S;break;case"children":break;case"dangerouslySetInnerHTML":if(S!=null)throw Error(n(91));break;default:S!==M&&Li(a,l,H,S,m,M)}ui(a,Oe,We);return;case"option":for(var nn in d)if(Oe=d[nn],d.hasOwnProperty(nn)&&Oe!=null&&!m.hasOwnProperty(nn))switch(nn){case"selected":a.selected=!1;break;default:Li(a,l,nn,null,m,Oe)}for(de in m)if(Oe=m[de],We=d[de],m.hasOwnProperty(de)&&Oe!==We&&(Oe!=null||We!=null))switch(de){case"selected":a.selected=Oe&&typeof Oe!="function"&&typeof Oe!="symbol";break;default:Li(a,l,de,Oe,m,We)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var xn in d)Oe=d[xn],d.hasOwnProperty(xn)&&Oe!=null&&!m.hasOwnProperty(xn)&&Li(a,l,xn,null,m,Oe);for(Ne in m)if(Oe=m[Ne],We=d[Ne],m.hasOwnProperty(Ne)&&Oe!==We&&(Oe!=null||We!=null))switch(Ne){case"children":case"dangerouslySetInnerHTML":if(Oe!=null)throw Error(n(137,l));break;default:Li(a,l,Ne,Oe,m,We)}return;default:if(Ts(l)){for(var Oi in d)Oe=d[Oi],d.hasOwnProperty(Oi)&&Oe!==void 0&&!m.hasOwnProperty(Oi)&&sE(a,l,Oi,void 0,m,Oe);for(Ke in m)Oe=m[Ke],We=d[Ke],!m.hasOwnProperty(Ke)||Oe===We||Oe===void 0&&We===void 0||sE(a,l,Ke,Oe,m,We);return}}for(var Me in d)Oe=d[Me],d.hasOwnProperty(Me)&&Oe!=null&&!m.hasOwnProperty(Me)&&Li(a,l,Me,null,m,Oe);for(st in m)Oe=m[st],We=d[st],!m.hasOwnProperty(st)||Oe===We||Oe==null&&We==null||Li(a,l,st,Oe,m,We)}function uC(a){switch(a){case"css":case"script":case"font":case"img":case"image":case"input":case"link":return!0;default:return!1}}function jO(){if(typeof performance.getEntriesByType=="function"){for(var a=0,l=0,d=performance.getEntriesByType("resource"),m=0;m<d.length;m++){var S=d[m],M=S.transferSize,H=S.initiatorType,Q=S.duration;if(M&&Q&&uC(H)){for(H=0,Q=S.responseEnd,m+=1;m<d.length;m++){var de=d[m],Ne=de.startTime;if(Ne>Q)break;var Ke=de.transferSize,st=de.initiatorType;Ke&&uC(st)&&(de=de.responseEnd,H+=Ke*(de<Q?1:(Q-Ne)/(de-Ne)))}if(--m,l+=8*(M+H)/(S.duration/1e3),a++,10<a)break}}if(0<a)return l/a/1e6}return navigator.connection&&(a=navigator.connection.downlink,typeof a=="number")?a:5}var aE=null,oE=null;function k_(a){return a.nodeType===9?a:a.ownerDocument}function hC(a){switch(a){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function fC(a,l){if(a===0)switch(l){case"svg":return 1;case"math":return 2;default:return 0}return a===1&&l==="foreignObject"?0:a}function lE(a,l){return a==="textarea"||a==="noscript"||typeof l.children=="string"||typeof l.children=="number"||typeof l.children=="bigint"||typeof l.dangerouslySetInnerHTML=="object"&&l.dangerouslySetInnerHTML!==null&&l.dangerouslySetInnerHTML.__html!=null}var cE=null;function WO(){var a=window.event;return a&&a.type==="popstate"?a===cE?!1:(cE=a,!0):(cE=null,!1)}var dC=typeof setTimeout=="function"?setTimeout:void 0,qO=typeof clearTimeout=="function"?clearTimeout:void 0,pC=typeof Promise=="function"?Promise:void 0,XO=typeof queueMicrotask=="function"?queueMicrotask:typeof pC<"u"?function(a){return pC.resolve(null).then(a).catch(YO)}:dC;function YO(a){setTimeout(function(){throw a})}function Nh(a){return a==="head"}function mC(a,l){var d=l,m=0;do{var S=d.nextSibling;if(a.removeChild(d),S&&S.nodeType===8)if(d=S.data,d==="/$"||d==="/&"){if(m===0){a.removeChild(S),cm(l);return}m--}else if(d==="$"||d==="$?"||d==="$~"||d==="$!"||d==="&")m++;else if(d==="html")k0(a.ownerDocument.documentElement);else if(d==="head"){d=a.ownerDocument.head,k0(d);for(var M=d.firstChild;M;){var H=M.nextSibling,Q=M.nodeName;M[mt]||Q==="SCRIPT"||Q==="STYLE"||Q==="LINK"&&M.rel.toLowerCase()==="stylesheet"||d.removeChild(M),M=H}}else d==="body"&&k0(a.ownerDocument.body);d=S}while(d);cm(l)}function gC(a,l){var d=a;a=0;do{var m=d.nextSibling;if(d.nodeType===1?l?(d._stashedDisplay=d.style.display,d.style.display="none"):(d.style.display=d._stashedDisplay||"",d.getAttribute("style")===""&&d.removeAttribute("style")):d.nodeType===3&&(l?(d._stashedText=d.nodeValue,d.nodeValue=""):d.nodeValue=d._stashedText||""),m&&m.nodeType===8)if(d=m.data,d==="/$"){if(a===0)break;a--}else d!=="$"&&d!=="$?"&&d!=="$~"&&d!=="$!"||a++;d=m}while(d)}function uE(a){var l=a.firstChild;for(l&&l.nodeType===10&&(l=l.nextSibling);l;){var d=l;switch(l=l.nextSibling,d.nodeName){case"HTML":case"HEAD":case"BODY":uE(d),ht(d);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(d.rel.toLowerCase()==="stylesheet")continue}a.removeChild(d)}}function JO(a,l,d,m){for(;a.nodeType===1;){var S=d;if(a.nodeName.toLowerCase()!==l.toLowerCase()){if(!m&&(a.nodeName!=="INPUT"||a.type!=="hidden"))break}else if(m){if(!a[mt])switch(l){case"meta":if(!a.hasAttribute("itemprop"))break;return a;case"link":if(M=a.getAttribute("rel"),M==="stylesheet"&&a.hasAttribute("data-precedence"))break;if(M!==S.rel||a.getAttribute("href")!==(S.href==null||S.href===""?null:S.href)||a.getAttribute("crossorigin")!==(S.crossOrigin==null?null:S.crossOrigin)||a.getAttribute("title")!==(S.title==null?null:S.title))break;return a;case"style":if(a.hasAttribute("data-precedence"))break;return a;case"script":if(M=a.getAttribute("src"),(M!==(S.src==null?null:S.src)||a.getAttribute("type")!==(S.type==null?null:S.type)||a.getAttribute("crossorigin")!==(S.crossOrigin==null?null:S.crossOrigin))&&M&&a.hasAttribute("async")&&!a.hasAttribute("itemprop"))break;return a;default:return a}}else if(l==="input"&&a.type==="hidden"){var M=S.name==null?null:""+S.name;if(S.type==="hidden"&&a.getAttribute("name")===M)return a}else return a;if(a=$o(a.nextSibling),a===null)break}return null}function KO(a,l,d){if(l==="")return null;for(;a.nodeType!==3;)if((a.nodeType!==1||a.nodeName!=="INPUT"||a.type!=="hidden")&&!d||(a=$o(a.nextSibling),a===null))return null;return a}function vC(a,l){for(;a.nodeType!==8;)if((a.nodeType!==1||a.nodeName!=="INPUT"||a.type!=="hidden")&&!l||(a=$o(a.nextSibling),a===null))return null;return a}function hE(a){return a.data==="$?"||a.data==="$~"}function fE(a){return a.data==="$!"||a.data==="$?"&&a.ownerDocument.readyState!=="loading"}function QO(a,l){var d=a.ownerDocument;if(a.data==="$~")a._reactRetry=l;else if(a.data!=="$?"||d.readyState!=="loading")l();else{var m=function(){l(),d.removeEventListener("DOMContentLoaded",m)};d.addEventListener("DOMContentLoaded",m),a._reactRetry=m}}function $o(a){for(;a!=null;a=a.nextSibling){var l=a.nodeType;if(l===1||l===3)break;if(l===8){if(l=a.data,l==="$"||l==="$!"||l==="$?"||l==="$~"||l==="&"||l==="F!"||l==="F")break;if(l==="/$"||l==="/&")return null}}return a}var dE=null;function yC(a){a=a.nextSibling;for(var l=0;a;){if(a.nodeType===8){var d=a.data;if(d==="/$"||d==="/&"){if(l===0)return $o(a.nextSibling);l--}else d!=="$"&&d!=="$!"&&d!=="$?"&&d!=="$~"&&d!=="&"||l++}a=a.nextSibling}return null}function _C(a){a=a.previousSibling;for(var l=0;a;){if(a.nodeType===8){var d=a.data;if(d==="$"||d==="$!"||d==="$?"||d==="$~"||d==="&"){if(l===0)return a;l--}else d!=="/$"&&d!=="/&"||l++}a=a.previousSibling}return null}function xC(a,l,d){switch(l=k_(d),a){case"html":if(a=l.documentElement,!a)throw Error(n(452));return a;case"head":if(a=l.head,!a)throw Error(n(453));return a;case"body":if(a=l.body,!a)throw Error(n(454));return a;default:throw Error(n(451))}}function k0(a){for(var l=a.attributes;l.length;)a.removeAttributeNode(l[0]);ht(a)}var el=new Map,bC=new Set;function z_(a){return typeof a.getRootNode=="function"?a.getRootNode():a.nodeType===9?a:a.ownerDocument}var Su=se.d;se.d={f:ZO,r:$O,D:eU,C:tU,L:nU,m:iU,X:sU,S:rU,M:aU};function ZO(){var a=Su.f(),l=po();return a||l}function $O(a){var l=Tt(a);l!==null&&l.tag===5&&l.type==="form"?A_(l):Su.r(a)}var am=typeof document>"u"?null:document;function AC(a,l,d){var m=am;if(m&&typeof l=="string"&&l){var S=kt(l);S='link[rel="'+a+'"][href="'+S+'"]',typeof d=="string"&&(S+='[crossorigin="'+d+'"]'),bC.has(S)||(bC.add(S),a={rel:a,crossOrigin:d,href:l},m.querySelector(S)===null&&(l=m.createElement("link"),Os(l,"link",a),J(l),m.head.appendChild(l)))}}function eU(a){Su.D(a),AC("dns-prefetch",a,null)}function tU(a,l){Su.C(a,l),AC("preconnect",a,l)}function nU(a,l,d){Su.L(a,l,d);var m=am;if(m&&a&&l){var S='link[rel="preload"][as="'+kt(l)+'"]';l==="image"&&d&&d.imageSrcSet?(S+='[imagesrcset="'+kt(d.imageSrcSet)+'"]',typeof d.imageSizes=="string"&&(S+='[imagesizes="'+kt(d.imageSizes)+'"]')):S+='[href="'+kt(a)+'"]';var M=S;switch(l){case"style":M=om(a);break;case"script":M=lm(a)}el.has(M)||(a=v({rel:"preload",href:l==="image"&&d&&d.imageSrcSet?void 0:a,as:l},d),el.set(M,a),m.querySelector(S)!==null||l==="style"&&m.querySelector(z0(M))||l==="script"&&m.querySelector(V0(M))||(l=m.createElement("link"),Os(l,"link",a),J(l),m.head.appendChild(l)))}}function iU(a,l){Su.m(a,l);var d=am;if(d&&a){var m=l&&typeof l.as=="string"?l.as:"script",S='link[rel="modulepreload"][as="'+kt(m)+'"][href="'+kt(a)+'"]',M=S;switch(m){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":M=lm(a)}if(!el.has(M)&&(a=v({rel:"modulepreload",href:a},l),el.set(M,a),d.querySelector(S)===null)){switch(m){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(d.querySelector(V0(M)))return}m=d.createElement("link"),Os(m,"link",a),J(m),d.head.appendChild(m)}}}function rU(a,l,d){Su.S(a,l,d);var m=am;if(m&&a){var S=Mt(m).hoistableStyles,M=om(a);l=l||"default";var H=S.get(M);if(!H){var Q={loading:0,preload:null};if(H=m.querySelector(z0(M)))Q.loading=5;else{a=v({rel:"stylesheet",href:a,"data-precedence":l},d),(d=el.get(M))&&pE(a,d);var de=H=m.createElement("link");J(de),Os(de,"link",a),de._p=new Promise(function(Ne,Ke){de.onload=Ne,de.onerror=Ke}),de.addEventListener("load",function(){Q.loading|=1}),de.addEventListener("error",function(){Q.loading|=2}),Q.loading|=4,V_(H,l,m)}H={type:"stylesheet",instance:H,count:1,state:Q},S.set(M,H)}}}function sU(a,l){Su.X(a,l);var d=am;if(d&&a){var m=Mt(d).hoistableScripts,S=lm(a),M=m.get(S);M||(M=d.querySelector(V0(S)),M||(a=v({src:a,async:!0},l),(l=el.get(S))&&mE(a,l),M=d.createElement("script"),J(M),Os(M,"link",a),d.head.appendChild(M)),M={type:"script",instance:M,count:1,state:null},m.set(S,M))}}function aU(a,l){Su.M(a,l);var d=am;if(d&&a){var m=Mt(d).hoistableScripts,S=lm(a),M=m.get(S);M||(M=d.querySelector(V0(S)),M||(a=v({src:a,async:!0,type:"module"},l),(l=el.get(S))&&mE(a,l),M=d.createElement("script"),J(M),Os(M,"link",a),d.head.appendChild(M)),M={type:"script",instance:M,count:1,state:null},m.set(S,M))}}function SC(a,l,d,m){var S=(S=ve.current)?z_(S):null;if(!S)throw Error(n(446));switch(a){case"meta":case"title":return null;case"style":return typeof d.precedence=="string"&&typeof d.href=="string"?(l=om(d.href),d=Mt(S).hoistableStyles,m=d.get(l),m||(m={type:"style",instance:null,count:0,state:null},d.set(l,m)),m):{type:"void",instance:null,count:0,state:null};case"link":if(d.rel==="stylesheet"&&typeof d.href=="string"&&typeof d.precedence=="string"){a=om(d.href);var M=Mt(S).hoistableStyles,H=M.get(a);if(H||(S=S.ownerDocument||S,H={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},M.set(a,H),(M=S.querySelector(z0(a)))&&!M._p&&(H.instance=M,H.state.loading=5),el.has(a)||(d={rel:"preload",as:"style",href:d.href,crossOrigin:d.crossOrigin,integrity:d.integrity,media:d.media,hrefLang:d.hrefLang,referrerPolicy:d.referrerPolicy},el.set(a,d),M||oU(S,a,d,H.state))),l&&m===null)throw Error(n(528,""));return H}if(l&&m!==null)throw Error(n(529,""));return null;case"script":return l=d.async,d=d.src,typeof d=="string"&&l&&typeof l!="function"&&typeof l!="symbol"?(l=lm(d),d=Mt(S).hoistableScripts,m=d.get(l),m||(m={type:"script",instance:null,count:0,state:null},d.set(l,m)),m):{type:"void",instance:null,count:0,state:null};default:throw Error(n(444,a))}}function om(a){return'href="'+kt(a)+'"'}function z0(a){return'link[rel="stylesheet"]['+a+"]"}function EC(a){return v({},a,{"data-precedence":a.precedence,precedence:null})}function oU(a,l,d,m){a.querySelector('link[rel="preload"][as="style"]['+l+"]")?m.loading=1:(l=a.createElement("link"),m.preload=l,l.addEventListener("load",function(){return m.loading|=1}),l.addEventListener("error",function(){return m.loading|=2}),Os(l,"link",d),J(l),a.head.appendChild(l))}function lm(a){return'[src="'+kt(a)+'"]'}function V0(a){return"script[async]"+a}function TC(a,l,d){if(l.count++,l.instance===null)switch(l.type){case"style":var m=a.querySelector('style[data-href~="'+kt(d.href)+'"]');if(m)return l.instance=m,J(m),m;var S=v({},d,{"data-href":d.href,"data-precedence":d.precedence,href:null,precedence:null});return m=(a.ownerDocument||a).createElement("style"),J(m),Os(m,"style",S),V_(m,d.precedence,a),l.instance=m;case"stylesheet":S=om(d.href);var M=a.querySelector(z0(S));if(M)return l.state.loading|=4,l.instance=M,J(M),M;m=EC(d),(S=el.get(S))&&pE(m,S),M=(a.ownerDocument||a).createElement("link"),J(M);var H=M;return H._p=new Promise(function(Q,de){H.onload=Q,H.onerror=de}),Os(M,"link",m),l.state.loading|=4,V_(M,d.precedence,a),l.instance=M;case"script":return M=lm(d.src),(S=a.querySelector(V0(M)))?(l.instance=S,J(S),S):(m=d,(S=el.get(M))&&(m=v({},d),mE(m,S)),a=a.ownerDocument||a,S=a.createElement("script"),J(S),Os(S,"link",m),a.head.appendChild(S),l.instance=S);case"void":return null;default:throw Error(n(443,l.type))}else l.type==="stylesheet"&&(l.state.loading&4)===0&&(m=l.instance,l.state.loading|=4,V_(m,d.precedence,a));return l.instance}function V_(a,l,d){for(var m=d.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),S=m.length?m[m.length-1]:null,M=S,H=0;H<m.length;H++){var Q=m[H];if(Q.dataset.precedence===l)M=Q;else if(M!==S)break}M?M.parentNode.insertBefore(a,M.nextSibling):(l=d.nodeType===9?d.head:d,l.insertBefore(a,l.firstChild))}function pE(a,l){a.crossOrigin==null&&(a.crossOrigin=l.crossOrigin),a.referrerPolicy==null&&(a.referrerPolicy=l.referrerPolicy),a.title==null&&(a.title=l.title)}function mE(a,l){a.crossOrigin==null&&(a.crossOrigin=l.crossOrigin),a.referrerPolicy==null&&(a.referrerPolicy=l.referrerPolicy),a.integrity==null&&(a.integrity=l.integrity)}var H_=null;function MC(a,l,d){if(H_===null){var m=new Map,S=H_=new Map;S.set(d,m)}else S=H_,m=S.get(d),m||(m=new Map,S.set(d,m));if(m.has(a))return m;for(m.set(a,null),d=d.getElementsByTagName(a),S=0;S<d.length;S++){var M=d[S];if(!(M[mt]||M[Si]||a==="link"&&M.getAttribute("rel")==="stylesheet")&&M.namespaceURI!=="http://www.w3.org/2000/svg"){var H=M.getAttribute(l)||"";H=a+H;var Q=m.get(H);Q?Q.push(M):m.set(H,[M])}}return m}function wC(a,l,d){a=a.ownerDocument||a,a.head.insertBefore(d,l==="title"?a.querySelector("head > title"):null)}function lU(a,l,d){if(d===1||l.itemProp!=null)return!1;switch(a){case"meta":case"title":return!0;case"style":if(typeof l.precedence!="string"||typeof l.href!="string"||l.href==="")break;return!0;case"link":if(typeof l.rel!="string"||typeof l.href!="string"||l.href===""||l.onLoad||l.onError)break;switch(l.rel){case"stylesheet":return a=l.disabled,typeof l.precedence=="string"&&a==null;default:return!0}case"script":if(l.async&&typeof l.async!="function"&&typeof l.async!="symbol"&&!l.onLoad&&!l.onError&&l.src&&typeof l.src=="string")return!0}return!1}function CC(a){return!(a.type==="stylesheet"&&(a.state.loading&3)===0)}function cU(a,l,d,m){if(d.type==="stylesheet"&&(typeof m.media!="string"||matchMedia(m.media).matches!==!1)&&(d.state.loading&4)===0){if(d.instance===null){var S=om(m.href),M=l.querySelector(z0(S));if(M){l=M._p,l!==null&&typeof l=="object"&&typeof l.then=="function"&&(a.count++,a=G_.bind(a),l.then(a,a)),d.state.loading|=4,d.instance=M,J(M);return}M=l.ownerDocument||l,m=EC(m),(S=el.get(S))&&pE(m,S),M=M.createElement("link"),J(M);var H=M;H._p=new Promise(function(Q,de){H.onload=Q,H.onerror=de}),Os(M,"link",m),d.instance=M}a.stylesheets===null&&(a.stylesheets=new Map),a.stylesheets.set(d,l),(l=d.state.preload)&&(d.state.loading&3)===0&&(a.count++,d=G_.bind(a),l.addEventListener("load",d),l.addEventListener("error",d))}}var gE=0;function uU(a,l){return a.stylesheets&&a.count===0&&W_(a,a.stylesheets),0<a.count||0<a.imgCount?function(d){var m=setTimeout(function(){if(a.stylesheets&&W_(a,a.stylesheets),a.unsuspend){var M=a.unsuspend;a.unsuspend=null,M()}},6e4+l);0<a.imgBytes&&gE===0&&(gE=62500*jO());var S=setTimeout(function(){if(a.waitingForImages=!1,a.count===0&&(a.stylesheets&&W_(a,a.stylesheets),a.unsuspend)){var M=a.unsuspend;a.unsuspend=null,M()}},(a.imgBytes>gE?50:800)+l);return a.unsuspend=d,function(){a.unsuspend=null,clearTimeout(m),clearTimeout(S)}}:null}function G_(){if(this.count--,this.count===0&&(this.imgCount===0||!this.waitingForImages)){if(this.stylesheets)W_(this,this.stylesheets);else if(this.unsuspend){var a=this.unsuspend;this.unsuspend=null,a()}}}var j_=null;function W_(a,l){a.stylesheets=null,a.unsuspend!==null&&(a.count++,j_=new Map,l.forEach(hU,a),j_=null,G_.call(a))}function hU(a,l){if(!(l.state.loading&4)){var d=j_.get(a);if(d)var m=d.get(null);else{d=new Map,j_.set(a,d);for(var S=a.querySelectorAll("link[data-precedence],style[data-precedence]"),M=0;M<S.length;M++){var H=S[M];(H.nodeName==="LINK"||H.getAttribute("media")!=="not all")&&(d.set(H.dataset.precedence,H),m=H)}m&&d.set(null,m)}S=l.instance,H=S.getAttribute("data-precedence"),M=d.get(H)||m,M===m&&d.set(null,S),d.set(H,S),this.count++,m=G_.bind(this),S.addEventListener("load",m),S.addEventListener("error",m),M?M.parentNode.insertBefore(S,M.nextSibling):(a=a.nodeType===9?a.head:a,a.insertBefore(S,a.firstChild)),l.state.loading|=4}}var H0={$$typeof:L,Provider:null,Consumer:null,_currentValue:Ae,_currentValue2:Ae,_threadCount:0};function fU(a,l,d,m,S,M,H,Q,de){this.tag=1,this.containerInfo=a,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=yn(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=yn(0),this.hiddenUpdates=yn(null),this.identifierPrefix=m,this.onUncaughtError=S,this.onCaughtError=M,this.onRecoverableError=H,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=de,this.incompleteTransitions=new Map}function RC(a,l,d,m,S,M,H,Q,de,Ne,Ke,st){return a=new fU(a,l,d,H,de,Ne,Ke,st,Q),l=1,M===!0&&(l|=24),M=Yi(3,null,null,l),a.current=M,M.stateNode=a,l=qg(),l.refCount++,a.pooledCache=l,l.refCount++,M.memoizedState={element:m,isDehydrated:d,cache:l},Wf(M),a}function IC(a){return a?(a=sc,a):sc}function DC(a,l,d,m,S,M){S=IC(S),m.context===null?m.context=S:m.pendingContext=S,m=Sl(l),m.payload={element:d},M=M===void 0?null:M,M!==null&&(m.callback=M),d=dc(a,m,l),d!==null&&(zn(d,a,l),pc(d,a,l))}function NC(a,l){if(a=a.memoizedState,a!==null&&a.dehydrated!==null){var d=a.retryLane;a.retryLane=d!==0&&d<l?d:l}}function vE(a,l){NC(a,l),(a=a.alternate)&&NC(a,l)}function PC(a){if(a.tag===13||a.tag===31){var l=Rs(a,67108864);l!==null&&zn(l,a,67108864),vE(a,67108864)}}function BC(a){if(a.tag===13||a.tag===31){var l=Sa();l=Ws(l);var d=Rs(a,l);d!==null&&zn(d,a,l),vE(a,l)}}var q_=!0;function dU(a,l,d,m){var S=te.T;te.T=null;var M=se.p;try{se.p=2,yE(a,l,d,m)}finally{se.p=M,te.T=S}}function pU(a,l,d,m){var S=te.T;te.T=null;var M=se.p;try{se.p=8,yE(a,l,d,m)}finally{se.p=M,te.T=S}}function yE(a,l,d,m){if(q_){var S=_E(m);if(S===null)rE(a,l,m,X_,d),OC(a,m);else if(gU(S,a,l,d,m))m.stopPropagation();else if(OC(a,m),l&4&&-1<mU.indexOf(a)){for(;S!==null;){var M=Tt(S);if(M!==null)switch(M.tag){case 3:if(M=M.stateNode,M.current.memoizedState.isDehydrated){var H=ut(M.pendingLanes);if(H!==0){var Q=M;for(Q.pendingLanes|=2,Q.entangledLanes|=2;H;){var de=1<<31-oe(H);Q.entanglements[1]|=de,H&=~de}Et(M),(ln&6)===0&&(_r=q()+500,Jt(0))}}break;case 31:case 13:Q=Rs(M,2),Q!==null&&zn(Q,M,2),po(),vE(M,2)}if(M=_E(m),M===null&&rE(a,l,m,X_,d),M===S)break;S=M}S!==null&&m.stopPropagation()}else rE(a,l,m,null,d)}}function _E(a){return a=da(a),xE(a)}var X_=null;function xE(a){if(X_=null,a=Rt(a),a!==null){var l=s(a);if(l===null)a=null;else{var d=l.tag;if(d===13){if(a=o(l),a!==null)return a;a=null}else if(d===31){if(a=u(l),a!==null)return a;a=null}else if(d===3){if(l.stateNode.current.memoizedState.isDehydrated)return l.tag===3?l.stateNode.containerInfo:null;a=null}else l!==a&&(a=null)}}return X_=a,null}function LC(a){switch(a){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(ge()){case Fe:return 2;case Xe:return 8;case Ue:case Ft:return 32;case Ct:return 268435456;default:return 32}default:return 32}}var bE=!1,Ph=null,Bh=null,Lh=null,G0=new Map,j0=new Map,Oh=[],mU="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function OC(a,l){switch(a){case"focusin":case"focusout":Ph=null;break;case"dragenter":case"dragleave":Bh=null;break;case"mouseover":case"mouseout":Lh=null;break;case"pointerover":case"pointerout":G0.delete(l.pointerId);break;case"gotpointercapture":case"lostpointercapture":j0.delete(l.pointerId)}}function W0(a,l,d,m,S,M){return a===null||a.nativeEvent!==M?(a={blockedOn:l,domEventName:d,eventSystemFlags:m,nativeEvent:M,targetContainers:[S]},l!==null&&(l=Tt(l),l!==null&&PC(l)),a):(a.eventSystemFlags|=m,l=a.targetContainers,S!==null&&l.indexOf(S)===-1&&l.push(S),a)}function gU(a,l,d,m,S){switch(l){case"focusin":return Ph=W0(Ph,a,l,d,m,S),!0;case"dragenter":return Bh=W0(Bh,a,l,d,m,S),!0;case"mouseover":return Lh=W0(Lh,a,l,d,m,S),!0;case"pointerover":var M=S.pointerId;return G0.set(M,W0(G0.get(M)||null,a,l,d,m,S)),!0;case"gotpointercapture":return M=S.pointerId,j0.set(M,W0(j0.get(M)||null,a,l,d,m,S)),!0}return!1}function UC(a){var l=Rt(a.target);if(l!==null){var d=s(l);if(d!==null){if(l=d.tag,l===13){if(l=o(d),l!==null){a.blockedOn=l,sn(a.priority,function(){BC(d)});return}}else if(l===31){if(l=u(d),l!==null){a.blockedOn=l,sn(a.priority,function(){BC(d)});return}}else if(l===3&&d.stateNode.current.memoizedState.isDehydrated){a.blockedOn=d.tag===3?d.stateNode.containerInfo:null;return}}}a.blockedOn=null}function Y_(a){if(a.blockedOn!==null)return!1;for(var l=a.targetContainers;0<l.length;){var d=_E(a.nativeEvent);if(d===null){d=a.nativeEvent;var m=new d.constructor(d.type,d);Yu=m,d.target.dispatchEvent(m),Yu=null}else return l=Tt(d),l!==null&&PC(l),a.blockedOn=d,!1;l.shift()}return!0}function FC(a,l,d){Y_(a)&&d.delete(l)}function vU(){bE=!1,Ph!==null&&Y_(Ph)&&(Ph=null),Bh!==null&&Y_(Bh)&&(Bh=null),Lh!==null&&Y_(Lh)&&(Lh=null),G0.forEach(FC),j0.forEach(FC)}function J_(a,l){a.blockedOn===l&&(a.blockedOn=null,bE||(bE=!0,i.unstable_scheduleCallback(i.unstable_NormalPriority,vU)))}var K_=null;function kC(a){K_!==a&&(K_=a,i.unstable_scheduleCallback(i.unstable_NormalPriority,function(){K_===a&&(K_=null);for(var l=0;l<a.length;l+=3){var d=a[l],m=a[l+1],S=a[l+2];if(typeof m!="function"){if(xE(m||d)===null)continue;break}var M=Tt(d);M!==null&&(a.splice(l,3),l-=3,_0(M,{pending:!0,data:S,method:d.method,action:m},m,S))}}))}function cm(a){function l(de){return J_(de,a)}Ph!==null&&J_(Ph,a),Bh!==null&&J_(Bh,a),Lh!==null&&J_(Lh,a),G0.forEach(l),j0.forEach(l);for(var d=0;d<Oh.length;d++){var m=Oh[d];m.blockedOn===a&&(m.blockedOn=null)}for(;0<Oh.length&&(d=Oh[0],d.blockedOn===null);)UC(d),d.blockedOn===null&&Oh.shift();if(d=(a.ownerDocument||a).$$reactFormReplay,d!=null)for(m=0;m<d.length;m+=3){var S=d[m],M=d[m+1],H=S[X]||null;if(typeof M=="function")H||kC(d);else if(H){var Q=null;if(M&&M.hasAttribute("formAction")){if(S=M,H=M[X]||null)Q=H.formAction;else if(xE(S)!==null)continue}else Q=H.action;typeof Q=="function"?d[m+1]=Q:(d.splice(m,3),m-=3),kC(d)}}}function zC(){function a(M){M.canIntercept&&M.info==="react-transition"&&M.intercept({handler:function(){return new Promise(function(H){return S=H})},focusReset:"manual",scroll:"manual"})}function l(){S!==null&&(S(),S=null),m||setTimeout(d,20)}function d(){if(!m&&!navigation.transition){var M=navigation.currentEntry;M&&M.url!=null&&navigation.navigate(M.url,{state:M.getState(),info:"react-transition",history:"replace"})}}if(typeof navigation=="object"){var m=!1,S=null;return navigation.addEventListener("navigate",a),navigation.addEventListener("navigatesuccess",l),navigation.addEventListener("navigateerror",l),setTimeout(d,100),function(){m=!0,navigation.removeEventListener("navigate",a),navigation.removeEventListener("navigatesuccess",l),navigation.removeEventListener("navigateerror",l),S!==null&&(S(),S=null)}}}function AE(a){this._internalRoot=a}Q_.prototype.render=AE.prototype.render=function(a){var l=this._internalRoot;if(l===null)throw Error(n(409));var d=l.current,m=Sa();DC(d,m,a,l,null,null)},Q_.prototype.unmount=AE.prototype.unmount=function(){var a=this._internalRoot;if(a!==null){this._internalRoot=null;var l=a.containerInfo;DC(a.current,2,null,a,null,null),po(),l[Z]=null}};function Q_(a){this._internalRoot=a}Q_.prototype.unstable_scheduleHydration=function(a){if(a){var l=Es();a={blockedOn:null,target:a,priority:l};for(var d=0;d<Oh.length&&l!==0&&l<Oh[d].priority;d++);Oh.splice(d,0,a),d===0&&UC(a)}};var VC=e.version;if(VC!=="19.2.4")throw Error(n(527,VC,"19.2.4"));se.findDOMNode=function(a){var l=a._reactInternals;if(l===void 0)throw typeof a.render=="function"?Error(n(188)):(a=Object.keys(a).join(","),Error(n(268,a)));return a=p(l),a=a!==null?g(a):null,a=a===null?null:a.stateNode,a};var yU={bundleType:0,version:"19.2.4",rendererPackageName:"react-dom",currentDispatcherRef:te,reconcilerVersion:"19.2.4"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Z_=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Z_.isDisabled&&Z_.supportsFiber)try{tt=Z_.inject(yU),it=Z_}catch{}}return X0.createRoot=function(a,l){if(!r(a))throw Error(n(299));var d=!1,m="",S=R_,M=T0,H=M0;return l!=null&&(l.unstable_strictMode===!0&&(d=!0),l.identifierPrefix!==void 0&&(m=l.identifierPrefix),l.onUncaughtError!==void 0&&(S=l.onUncaughtError),l.onCaughtError!==void 0&&(M=l.onCaughtError),l.onRecoverableError!==void 0&&(H=l.onRecoverableError)),l=RC(a,1,!1,null,null,d,m,null,S,M,H,zC),a[Z]=l.current,iE(a),new AE(l)},X0.hydrateRoot=function(a,l,d){if(!r(a))throw Error(n(299));var m=!1,S="",M=R_,H=T0,Q=M0,de=null;return d!=null&&(d.unstable_strictMode===!0&&(m=!0),d.identifierPrefix!==void 0&&(S=d.identifierPrefix),d.onUncaughtError!==void 0&&(M=d.onUncaughtError),d.onCaughtError!==void 0&&(H=d.onCaughtError),d.onRecoverableError!==void 0&&(Q=d.onRecoverableError),d.formState!==void 0&&(de=d.formState)),l=RC(a,1,!0,l,d??null,m,S,de,M,H,Q,zC),l.context=IC(null),d=l.current,m=Sa(),m=Ws(m),S=Sl(m),S.callback=null,dc(d,S,m),d=m,l.current.lanes=d,Ii(l,d),Et(l),a[Z]=l.current,iE(a),new Q_(l)},X0.version="19.2.4",X0}var QC;function RU(){if(QC)return TE.exports;QC=1;function i(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(i)}catch(e){console.error(e)}}return i(),TE.exports=CU(),TE.exports}var NN=RU();const IU=LA(NN),DU=()=>{};var ZC={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const PN=function(i){const e=[];let t=0;for(let n=0;n<i.length;n++){let r=i.charCodeAt(n);r<128?e[t++]=r:r<2048?(e[t++]=r>>6|192,e[t++]=r&63|128):(r&64512)===55296&&n+1<i.length&&(i.charCodeAt(n+1)&64512)===56320?(r=65536+((r&1023)<<10)+(i.charCodeAt(++n)&1023),e[t++]=r>>18|240,e[t++]=r>>12&63|128,e[t++]=r>>6&63|128,e[t++]=r&63|128):(e[t++]=r>>12|224,e[t++]=r>>6&63|128,e[t++]=r&63|128)}return e},NU=function(i){const e=[];let t=0,n=0;for(;t<i.length;){const r=i[t++];if(r<128)e[n++]=String.fromCharCode(r);else if(r>191&&r<224){const s=i[t++];e[n++]=String.fromCharCode((r&31)<<6|s&63)}else if(r>239&&r<365){const s=i[t++],o=i[t++],u=i[t++],f=((r&7)<<18|(s&63)<<12|(o&63)<<6|u&63)-65536;e[n++]=String.fromCharCode(55296+(f>>10)),e[n++]=String.fromCharCode(56320+(f&1023))}else{const s=i[t++],o=i[t++];e[n++]=String.fromCharCode((r&15)<<12|(s&63)<<6|o&63)}}return e.join("")},BN={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(i,e){if(!Array.isArray(i))throw Error("encodeByteArray takes an array as a parameter");this.init_();const t=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,n=[];for(let r=0;r<i.length;r+=3){const s=i[r],o=r+1<i.length,u=o?i[r+1]:0,f=r+2<i.length,p=f?i[r+2]:0,g=s>>2,v=(s&3)<<4|u>>4;let _=(u&15)<<2|p>>6,x=p&63;f||(x=64,o||(_=64)),n.push(t[g],t[v],t[_],t[x])}return n.join("")},encodeString(i,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(i):this.encodeByteArray(PN(i),e)},decodeString(i,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(i):NU(this.decodeStringToByteArray(i,e))},decodeStringToByteArray(i,e){this.init_();const t=e?this.charToByteMapWebSafe_:this.charToByteMap_,n=[];for(let r=0;r<i.length;){const s=t[i.charAt(r++)],u=r<i.length?t[i.charAt(r)]:0;++r;const p=r<i.length?t[i.charAt(r)]:64;++r;const v=r<i.length?t[i.charAt(r)]:64;if(++r,s==null||u==null||p==null||v==null)throw new PU;const _=s<<2|u>>4;if(n.push(_),p!==64){const x=u<<4&240|p>>2;if(n.push(x),v!==64){const E=p<<6&192|v;n.push(E)}}}return n},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let i=0;i<this.ENCODED_VALS.length;i++)this.byteToCharMap_[i]=this.ENCODED_VALS.charAt(i),this.charToByteMap_[this.byteToCharMap_[i]]=i,this.byteToCharMapWebSafe_[i]=this.ENCODED_VALS_WEBSAFE.charAt(i),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[i]]=i,i>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(i)]=i,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(i)]=i)}}};class PU extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const BU=function(i){const e=PN(i);return BN.encodeByteArray(e,!0)},yb=function(i){return BU(i).replace(/\./g,"")},LN=function(i){try{return BN.decodeString(i,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function LU(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const OU=()=>LU().__FIREBASE_DEFAULTS__,UU=()=>{if(typeof process>"u"||typeof ZC>"u")return;const i=ZC.__FIREBASE_DEFAULTS__;if(i)return JSON.parse(i)},FU=()=>{if(typeof document>"u")return;let i;try{i=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=i&&LN(i[1]);return e&&JSON.parse(e)},UA=()=>{try{return DU()||OU()||UU()||FU()}catch(i){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${i}`);return}},ON=i=>{var e,t;return(t=(e=UA())==null?void 0:e.emulatorHosts)==null?void 0:t[i]},kU=i=>{const e=ON(i);if(!e)return;const t=e.lastIndexOf(":");if(t<=0||t+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const n=parseInt(e.substring(t+1),10);return e[0]==="["?[e.substring(1,t-1),n]:[e.substring(0,t),n]},UN=()=>{var i;return(i=UA())==null?void 0:i.config},FN=i=>{var e;return(e=UA())==null?void 0:e[`_${i}`]};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zU{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}wrapCallback(e){return(t,n)=>{t?this.reject(t):this.resolve(n),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(t):e(t,n))}}}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function yg(i){try{return(i.startsWith("http://")||i.startsWith("https://")?new URL(i).hostname:i).endsWith(".cloudworkstations.dev")}catch{return!1}}async function kN(i){return(await fetch(i,{credentials:"include"})).ok}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function VU(i,e){if(i.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const t={alg:"none",type:"JWT"},n=e||"demo-project",r=i.iat||0,s=i.sub||i.user_id;if(!s)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const o={iss:`https://securetoken.google.com/${n}`,aud:n,iat:r,exp:r+3600,auth_time:r,sub:s,user_id:s,firebase:{sign_in_provider:"custom",identities:{}},...i};return[yb(JSON.stringify(t)),yb(JSON.stringify(o)),""].join(".")}const _v={};function HU(){const i={prod:[],emulator:[]};for(const e of Object.keys(_v))_v[e]?i.emulator.push(e):i.prod.push(e);return i}function GU(i){let e=document.getElementById(i),t=!1;return e||(e=document.createElement("div"),e.setAttribute("id",i),t=!0),{created:t,element:e}}let $C=!1;function zN(i,e){if(typeof window>"u"||typeof document>"u"||!yg(window.location.host)||_v[i]===e||_v[i]||$C)return;_v[i]=e;function t(_){return`__firebase__banner__${_}`}const n="__firebase__banner",s=HU().prod.length>0;function o(){const _=document.getElementById(n);_&&_.remove()}function u(_){_.style.display="flex",_.style.background="#7faaf0",_.style.position="fixed",_.style.bottom="5px",_.style.left="5px",_.style.padding=".5em",_.style.borderRadius="5px",_.style.alignItems="center"}function f(_,x){_.setAttribute("width","24"),_.setAttribute("id",x),_.setAttribute("height","24"),_.setAttribute("viewBox","0 0 24 24"),_.setAttribute("fill","none"),_.style.marginLeft="-6px"}function p(){const _=document.createElement("span");return _.style.cursor="pointer",_.style.marginLeft="16px",_.style.fontSize="24px",_.innerHTML=" &times;",_.onclick=()=>{$C=!0,o()},_}function g(_,x){_.setAttribute("id",x),_.innerText="Learn more",_.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",_.setAttribute("target","__blank"),_.style.paddingLeft="5px",_.style.textDecoration="underline"}function v(){const _=GU(n),x=t("text"),E=document.getElementById(x)||document.createElement("span"),C=t("learnmore"),w=document.getElementById(C)||document.createElement("a"),T=t("preprendIcon"),N=document.getElementById(T)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(_.created){const L=_.element;u(L),g(w,C);const F=p();f(N,T),L.append(N,E,w,F),document.body.appendChild(L)}s?(E.innerText="Preview backend disconnected.",N.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(N.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,E.innerText="Preview backend running in this workspace."),E.setAttribute("id",x)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",v):v()}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ua(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function jU(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(ua())}function WU(){var e;const i=(e=UA())==null?void 0:e.forceEnvironment;if(i==="node")return!0;if(i==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function qU(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function XU(){const i=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof i=="object"&&i.id!==void 0}function YU(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function JU(){const i=ua();return i.indexOf("MSIE ")>=0||i.indexOf("Trident/")>=0}function KU(){return!WU()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function QU(){try{return typeof indexedDB=="object"}catch{return!1}}function ZU(){return new Promise((i,e)=>{try{let t=!0;const n="validate-browser-context-for-indexeddb-analytics-module",r=self.indexedDB.open(n);r.onsuccess=()=>{r.result.close(),t||self.indexedDB.deleteDatabase(n),i(!0)},r.onupgradeneeded=()=>{t=!1},r.onerror=()=>{var s;e(((s=r.error)==null?void 0:s.message)||"")}}catch(t){e(t)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $U="FirebaseError";class qu extends Error{constructor(e,t,n){super(t),this.code=e,this.customData=n,this.name=$U,Object.setPrototypeOf(this,qu.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,ry.prototype.create)}}class ry{constructor(e,t,n){this.service=e,this.serviceName=t,this.errors=n}create(e,...t){const n=t[0]||{},r=`${this.service}/${e}`,s=this.errors[e],o=s?eF(s,n):"Error",u=`${this.serviceName}: ${o} (${r}).`;return new qu(r,u,n)}}function eF(i,e){return i.replace(tF,(t,n)=>{const r=e[n];return r!=null?String(r):`<${n}?>`})}const tF=/\{\$([^}]+)}/g;function nF(i){for(const e in i)if(Object.prototype.hasOwnProperty.call(i,e))return!1;return!0}function Wd(i,e){if(i===e)return!0;const t=Object.keys(i),n=Object.keys(e);for(const r of t){if(!n.includes(r))return!1;const s=i[r],o=e[r];if(eR(s)&&eR(o)){if(!Wd(s,o))return!1}else if(s!==o)return!1}for(const r of n)if(!t.includes(r))return!1;return!0}function eR(i){return i!==null&&typeof i=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function sy(i){const e=[];for(const[t,n]of Object.entries(i))Array.isArray(n)?n.forEach(r=>{e.push(encodeURIComponent(t)+"="+encodeURIComponent(r))}):e.push(encodeURIComponent(t)+"="+encodeURIComponent(n));return e.length?"&"+e.join("&"):""}function iF(i,e){const t=new rF(i,e);return t.subscribe.bind(t)}class rF{constructor(e,t){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then(()=>{e(this)}).catch(n=>{this.error(n)})}next(e){this.forEachObserver(t=>{t.next(e)})}error(e){this.forEachObserver(t=>{t.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,t,n){let r;if(e===void 0&&t===void 0&&n===void 0)throw new Error("Missing Observer.");sF(e,["next","error","complete"])?r=e:r={next:e,error:t,complete:n},r.next===void 0&&(r.next=RE),r.error===void 0&&(r.error=RE),r.complete===void 0&&(r.complete=RE);const s=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?r.error(this.finalError):r.complete()}catch{}}),this.observers.push(r),s}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let t=0;t<this.observers.length;t++)this.sendOne(t,e)}sendOne(e,t){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{t(this.observers[e])}catch(n){typeof console<"u"&&console.error&&console.error(n)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function sF(i,e){if(typeof i!="object"||i===null)return!1;for(const t of e)if(t in i&&typeof i[t]=="function")return!0;return!1}function RE(){}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Vs(i){return i&&i._delegate?i._delegate:i}class qd{constructor(e,t,n){this.name=e,this.instanceFactory=t,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Td="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let aF=class{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){const n=new zU;if(this.instancesDeferred.set(t,n),this.isInitialized(t)||this.shouldAutoInitialize())try{const r=this.getOrInitializeService({instanceIdentifier:t});r&&n.resolve(r)}catch{}}return this.instancesDeferred.get(t).promise}getImmediate(e){const t=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),n=(e==null?void 0:e.optional)??!1;if(this.isInitialized(t)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:t})}catch(r){if(n)return null;throw r}else{if(n)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(lF(e))try{this.getOrInitializeService({instanceIdentifier:Td})}catch{}for(const[t,n]of this.instancesDeferred.entries()){const r=this.normalizeInstanceIdentifier(t);try{const s=this.getOrInitializeService({instanceIdentifier:r});n.resolve(s)}catch{}}}}clearInstance(e=Td){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(t=>"INTERNAL"in t).map(t=>t.INTERNAL.delete()),...e.filter(t=>"_delete"in t).map(t=>t._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=Td){return this.instances.has(e)}getOptions(e=Td){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:t={}}=e,n=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(n))throw Error(`${this.name}(${n}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const r=this.getOrInitializeService({instanceIdentifier:n,options:t});for(const[s,o]of this.instancesDeferred.entries()){const u=this.normalizeInstanceIdentifier(s);n===u&&o.resolve(r)}return r}onInit(e,t){const n=this.normalizeInstanceIdentifier(t),r=this.onInitCallbacks.get(n)??new Set;r.add(e),this.onInitCallbacks.set(n,r);const s=this.instances.get(n);return s&&e(s,n),()=>{r.delete(e)}}invokeOnInitCallbacks(e,t){const n=this.onInitCallbacks.get(t);if(n)for(const r of n)try{r(e,t)}catch{}}getOrInitializeService({instanceIdentifier:e,options:t={}}){let n=this.instances.get(e);if(!n&&this.component&&(n=this.component.instanceFactory(this.container,{instanceIdentifier:oF(e),options:t}),this.instances.set(e,n),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(n,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,n)}catch{}return n||null}normalizeInstanceIdentifier(e=Td){return this.component?this.component.multipleInstances?e:Td:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}};function oF(i){return i===Td?void 0:i}function lF(i){return i.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cF{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const t=new aF(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var ai;(function(i){i[i.DEBUG=0]="DEBUG",i[i.VERBOSE=1]="VERBOSE",i[i.INFO=2]="INFO",i[i.WARN=3]="WARN",i[i.ERROR=4]="ERROR",i[i.SILENT=5]="SILENT"})(ai||(ai={}));const uF={debug:ai.DEBUG,verbose:ai.VERBOSE,info:ai.INFO,warn:ai.WARN,error:ai.ERROR,silent:ai.SILENT},hF=ai.INFO,fF={[ai.DEBUG]:"log",[ai.VERBOSE]:"log",[ai.INFO]:"info",[ai.WARN]:"warn",[ai.ERROR]:"error"},dF=(i,e,...t)=>{if(e<i.logLevel)return;const n=new Date().toISOString(),r=fF[e];if(r)console[r](`[${n}]  ${i.name}:`,...t);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class QT{constructor(e){this.name=e,this._logLevel=hF,this._logHandler=dF,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in ai))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?uF[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,ai.DEBUG,...e),this._logHandler(this,ai.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,ai.VERBOSE,...e),this._logHandler(this,ai.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,ai.INFO,...e),this._logHandler(this,ai.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,ai.WARN,...e),this._logHandler(this,ai.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,ai.ERROR,...e),this._logHandler(this,ai.ERROR,...e)}}const pF=(i,e)=>e.some(t=>i instanceof t);let tR,nR;function mF(){return tR||(tR=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function gF(){return nR||(nR=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const VN=new WeakMap,J1=new WeakMap,HN=new WeakMap,IE=new WeakMap,ZT=new WeakMap;function vF(i){const e=new Promise((t,n)=>{const r=()=>{i.removeEventListener("success",s),i.removeEventListener("error",o)},s=()=>{t(rf(i.result)),r()},o=()=>{n(i.error),r()};i.addEventListener("success",s),i.addEventListener("error",o)});return e.then(t=>{t instanceof IDBCursor&&VN.set(t,i)}).catch(()=>{}),ZT.set(e,i),e}function yF(i){if(J1.has(i))return;const e=new Promise((t,n)=>{const r=()=>{i.removeEventListener("complete",s),i.removeEventListener("error",o),i.removeEventListener("abort",o)},s=()=>{t(),r()},o=()=>{n(i.error||new DOMException("AbortError","AbortError")),r()};i.addEventListener("complete",s),i.addEventListener("error",o),i.addEventListener("abort",o)});J1.set(i,e)}let K1={get(i,e,t){if(i instanceof IDBTransaction){if(e==="done")return J1.get(i);if(e==="objectStoreNames")return i.objectStoreNames||HN.get(i);if(e==="store")return t.objectStoreNames[1]?void 0:t.objectStore(t.objectStoreNames[0])}return rf(i[e])},set(i,e,t){return i[e]=t,!0},has(i,e){return i instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in i}};function _F(i){K1=i(K1)}function xF(i){return i===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...t){const n=i.call(DE(this),e,...t);return HN.set(n,e.sort?e.sort():[e]),rf(n)}:gF().includes(i)?function(...e){return i.apply(DE(this),e),rf(VN.get(this))}:function(...e){return rf(i.apply(DE(this),e))}}function bF(i){return typeof i=="function"?xF(i):(i instanceof IDBTransaction&&yF(i),pF(i,mF())?new Proxy(i,K1):i)}function rf(i){if(i instanceof IDBRequest)return vF(i);if(IE.has(i))return IE.get(i);const e=bF(i);return e!==i&&(IE.set(i,e),ZT.set(e,i)),e}const DE=i=>ZT.get(i);function AF(i,e,{blocked:t,upgrade:n,blocking:r,terminated:s}={}){const o=indexedDB.open(i,e),u=rf(o);return n&&o.addEventListener("upgradeneeded",f=>{n(rf(o.result),f.oldVersion,f.newVersion,rf(o.transaction),f)}),t&&o.addEventListener("blocked",f=>t(f.oldVersion,f.newVersion,f)),u.then(f=>{s&&f.addEventListener("close",()=>s()),r&&f.addEventListener("versionchange",p=>r(p.oldVersion,p.newVersion,p))}).catch(()=>{}),u}const SF=["get","getKey","getAll","getAllKeys","count"],EF=["put","add","delete","clear"],NE=new Map;function iR(i,e){if(!(i instanceof IDBDatabase&&!(e in i)&&typeof e=="string"))return;if(NE.get(e))return NE.get(e);const t=e.replace(/FromIndex$/,""),n=e!==t,r=EF.includes(t);if(!(t in(n?IDBIndex:IDBObjectStore).prototype)||!(r||SF.includes(t)))return;const s=async function(o,...u){const f=this.transaction(o,r?"readwrite":"readonly");let p=f.store;return n&&(p=p.index(u.shift())),(await Promise.all([p[t](...u),r&&f.done]))[0]};return NE.set(e,s),s}_F(i=>({...i,get:(e,t,n)=>iR(e,t)||i.get(e,t,n),has:(e,t)=>!!iR(e,t)||i.has(e,t)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class TF{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(t=>{if(MF(t)){const n=t.getImmediate();return`${n.library}/${n.version}`}else return null}).filter(t=>t).join(" ")}}function MF(i){const e=i.getComponent();return(e==null?void 0:e.type)==="VERSION"}const Q1="@firebase/app",rR="0.14.7";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const zu=new QT("@firebase/app"),wF="@firebase/app-compat",CF="@firebase/analytics-compat",RF="@firebase/analytics",IF="@firebase/app-check-compat",DF="@firebase/app-check",NF="@firebase/auth",PF="@firebase/auth-compat",BF="@firebase/database",LF="@firebase/data-connect",OF="@firebase/database-compat",UF="@firebase/functions",FF="@firebase/functions-compat",kF="@firebase/installations",zF="@firebase/installations-compat",VF="@firebase/messaging",HF="@firebase/messaging-compat",GF="@firebase/performance",jF="@firebase/performance-compat",WF="@firebase/remote-config",qF="@firebase/remote-config-compat",XF="@firebase/storage",YF="@firebase/storage-compat",JF="@firebase/firestore",KF="@firebase/ai",QF="@firebase/firestore-compat",ZF="firebase",$F="12.8.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Z1="[DEFAULT]",e4={[Q1]:"fire-core",[wF]:"fire-core-compat",[RF]:"fire-analytics",[CF]:"fire-analytics-compat",[DF]:"fire-app-check",[IF]:"fire-app-check-compat",[NF]:"fire-auth",[PF]:"fire-auth-compat",[BF]:"fire-rtdb",[LF]:"fire-data-connect",[OF]:"fire-rtdb-compat",[UF]:"fire-fn",[FF]:"fire-fn-compat",[kF]:"fire-iid",[zF]:"fire-iid-compat",[VF]:"fire-fcm",[HF]:"fire-fcm-compat",[GF]:"fire-perf",[jF]:"fire-perf-compat",[WF]:"fire-rc",[qF]:"fire-rc-compat",[XF]:"fire-gcs",[YF]:"fire-gcs-compat",[JF]:"fire-fst",[QF]:"fire-fst-compat",[KF]:"fire-vertex","fire-js":"fire-js",[ZF]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _b=new Map,t4=new Map,$1=new Map;function sR(i,e){try{i.container.addComponent(e)}catch(t){zu.debug(`Component ${e.name} failed to register with FirebaseApp ${i.name}`,t)}}function Km(i){const e=i.name;if($1.has(e))return zu.debug(`There were multiple attempts to register component ${e}.`),!1;$1.set(e,i);for(const t of _b.values())sR(t,i);for(const t of t4.values())sR(t,i);return!0}function $T(i,e){const t=i.container.getProvider("heartbeat").getImmediate({optional:!0});return t&&t.triggerHeartbeat(),i.container.getProvider(e)}function Fl(i){return i==null?!1:i.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const n4={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},sf=new ry("app","Firebase",n4);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class i4{constructor(e,t,n){this._isDeleted=!1,this._options={...e},this._config={...t},this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=n,this.container.addComponent(new qd("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw sf.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _g=$F;function GN(i,e={}){let t=i;typeof e!="object"&&(e={name:e});const n={name:Z1,automaticDataCollectionEnabled:!0,...e},r=n.name;if(typeof r!="string"||!r)throw sf.create("bad-app-name",{appName:String(r)});if(t||(t=UN()),!t)throw sf.create("no-options");const s=_b.get(r);if(s){if(Wd(t,s.options)&&Wd(n,s.config))return s;throw sf.create("duplicate-app",{appName:r})}const o=new cF(r);for(const f of $1.values())o.addComponent(f);const u=new i4(t,n,o);return _b.set(r,u),u}function jN(i=Z1){const e=_b.get(i);if(!e&&i===Z1&&UN())return GN();if(!e)throw sf.create("no-app",{appName:i});return e}function af(i,e,t){let n=e4[i]??i;t&&(n+=`-${t}`);const r=n.match(/\s|\//),s=e.match(/\s|\//);if(r||s){const o=[`Unable to register library "${n}" with version "${e}":`];r&&o.push(`library name "${n}" contains illegal characters (whitespace or "/")`),r&&s&&o.push("and"),s&&o.push(`version name "${e}" contains illegal characters (whitespace or "/")`),zu.warn(o.join(" "));return}Km(new qd(`${n}-version`,()=>({library:n,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const r4="firebase-heartbeat-database",s4=1,Lv="firebase-heartbeat-store";let PE=null;function WN(){return PE||(PE=AF(r4,s4,{upgrade:(i,e)=>{switch(e){case 0:try{i.createObjectStore(Lv)}catch(t){console.warn(t)}}}}).catch(i=>{throw sf.create("idb-open",{originalErrorMessage:i.message})})),PE}async function a4(i){try{const t=(await WN()).transaction(Lv),n=await t.objectStore(Lv).get(qN(i));return await t.done,n}catch(e){if(e instanceof qu)zu.warn(e.message);else{const t=sf.create("idb-get",{originalErrorMessage:e==null?void 0:e.message});zu.warn(t.message)}}}async function aR(i,e){try{const n=(await WN()).transaction(Lv,"readwrite");await n.objectStore(Lv).put(e,qN(i)),await n.done}catch(t){if(t instanceof qu)zu.warn(t.message);else{const n=sf.create("idb-set",{originalErrorMessage:t==null?void 0:t.message});zu.warn(n.message)}}}function qN(i){return`${i.name}!${i.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const o4=1024,l4=30;class c4{constructor(e){this.container=e,this._heartbeatsCache=null;const t=this.container.getProvider("app").getImmediate();this._storage=new h4(t),this._heartbeatsCachePromise=this._storage.read().then(n=>(this._heartbeatsCache=n,n))}async triggerHeartbeat(){var e,t;try{const r=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),s=oR();if(((e=this._heartbeatsCache)==null?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((t=this._heartbeatsCache)==null?void 0:t.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===s||this._heartbeatsCache.heartbeats.some(o=>o.date===s))return;if(this._heartbeatsCache.heartbeats.push({date:s,agent:r}),this._heartbeatsCache.heartbeats.length>l4){const o=f4(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(o,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(n){zu.warn(n)}}async getHeartbeatsHeader(){var e;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)==null?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const t=oR(),{heartbeatsToSend:n,unsentEntries:r}=u4(this._heartbeatsCache.heartbeats),s=yb(JSON.stringify({version:2,heartbeats:n}));return this._heartbeatsCache.lastSentHeartbeatDate=t,r.length>0?(this._heartbeatsCache.heartbeats=r,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),s}catch(t){return zu.warn(t),""}}}function oR(){return new Date().toISOString().substring(0,10)}function u4(i,e=o4){const t=[];let n=i.slice();for(const r of i){const s=t.find(o=>o.agent===r.agent);if(s){if(s.dates.push(r.date),lR(t)>e){s.dates.pop();break}}else if(t.push({agent:r.agent,dates:[r.date]}),lR(t)>e){t.pop();break}n=n.slice(1)}return{heartbeatsToSend:t,unsentEntries:n}}class h4{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return QU()?ZU().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const t=await a4(this.app);return t!=null&&t.heartbeats?t:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){if(await this._canUseIndexedDBPromise){const n=await this.read();return aR(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??n.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){if(await this._canUseIndexedDBPromise){const n=await this.read();return aR(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??n.lastSentHeartbeatDate,heartbeats:[...n.heartbeats,...e.heartbeats]})}else return}}function lR(i){return yb(JSON.stringify({version:2,heartbeats:i})).length}function f4(i){if(i.length===0)return-1;let e=0,t=i[0].date;for(let n=1;n<i.length;n++)i[n].date<t&&(t=i[n].date,e=n);return e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function d4(i){Km(new qd("platform-logger",e=>new TF(e),"PRIVATE")),Km(new qd("heartbeat",e=>new c4(e),"PRIVATE")),af(Q1,rR,i),af(Q1,rR,"esm2020"),af("fire-js","")}d4("");var p4="firebase",m4="12.8.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */af(p4,m4,"app");function XN(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const g4=XN,YN=new ry("auth","Firebase",XN());/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const xb=new QT("@firebase/auth");function v4(i,...e){xb.logLevel<=ai.WARN&&xb.warn(`Auth (${_g}): ${i}`,...e)}function nb(i,...e){xb.logLevel<=ai.ERROR&&xb.error(`Auth (${_g}): ${i}`,...e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Vc(i,...e){throw tM(i,...e)}function Vl(i,...e){return tM(i,...e)}function eM(i,e,t){const n={...g4(),[e]:t};return new ry("auth","Firebase",n).create(e,{appName:i.name})}function zd(i){return eM(i,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function y4(i,e,t){const n=t;if(!(e instanceof n))throw n.name!==e.constructor.name&&Vc(i,"argument-error"),eM(i,"argument-error",`Type of ${e.constructor.name} does not match expected instance.Did you pass a reference from a different Auth SDK?`)}function tM(i,...e){if(typeof i!="string"){const t=e[0],n=[...e.slice(1)];return n[0]&&(n[0].appName=i.name),i._errorFactory.create(t,...n)}return YN.create(i,...e)}function Mn(i,e,...t){if(!i)throw tM(e,...t)}function Bu(i){const e="INTERNAL ASSERTION FAILED: "+i;throw nb(e),new Error(e)}function Vu(i,e){i||Bu(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function eT(){var i;return typeof self<"u"&&((i=self.location)==null?void 0:i.href)||""}function _4(){return cR()==="http:"||cR()==="https:"}function cR(){var i;return typeof self<"u"&&((i=self.location)==null?void 0:i.protocol)||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function x4(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(_4()||XU()||"connection"in navigator)?navigator.onLine:!0}function b4(){if(typeof navigator>"u")return null;const i=navigator;return i.languages&&i.languages[0]||i.language||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ay{constructor(e,t){this.shortDelay=e,this.longDelay=t,Vu(t>e,"Short delay should be less than long delay!"),this.isMobile=jU()||YU()}get(){return x4()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function nM(i,e){Vu(i.emulator,"Emulator should always be set here");const{url:t}=i.emulator;return e?`${t}${e.startsWith("/")?e.slice(1):e}`:t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class JN{static initialize(e,t,n){this.fetchImpl=e,t&&(this.headersImpl=t),n&&(this.responseImpl=n)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;Bu("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;Bu("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;Bu("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const A4={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const S4=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],E4=new ay(3e4,6e4);function iM(i,e){return i.tenantId&&!e.tenantId?{...e,tenantId:i.tenantId}:e}async function xg(i,e,t,n,r={}){return KN(i,r,async()=>{let s={},o={};n&&(e==="GET"?o=n:s={body:JSON.stringify(n)});const u=sy({key:i.config.apiKey,...o}).slice(1),f=await i._getAdditionalHeaders();f["Content-Type"]="application/json",i.languageCode&&(f["X-Firebase-Locale"]=i.languageCode);const p={method:e,headers:f,...s};return qU()||(p.referrerPolicy="no-referrer"),i.emulatorConfig&&yg(i.emulatorConfig.host)&&(p.credentials="include"),JN.fetch()(await QN(i,i.config.apiHost,t,u),p)})}async function KN(i,e,t){i._canInitEmulator=!1;const n={...A4,...e};try{const r=new M4(i),s=await Promise.race([t(),r.promise]);r.clearNetworkTimeout();const o=await s.json();if("needConfirmation"in o)throw $_(i,"account-exists-with-different-credential",o);if(s.ok&&!("errorMessage"in o))return o;{const u=s.ok?o.errorMessage:o.error.message,[f,p]=u.split(" : ");if(f==="FEDERATED_USER_ID_ALREADY_LINKED")throw $_(i,"credential-already-in-use",o);if(f==="EMAIL_EXISTS")throw $_(i,"email-already-in-use",o);if(f==="USER_DISABLED")throw $_(i,"user-disabled",o);const g=n[f]||f.toLowerCase().replace(/[_\s]+/g,"-");if(p)throw eM(i,g,p);Vc(i,g)}}catch(r){if(r instanceof qu)throw r;Vc(i,"network-request-failed",{message:String(r)})}}async function T4(i,e,t,n,r={}){const s=await xg(i,e,t,n,r);return"mfaPendingCredential"in s&&Vc(i,"multi-factor-auth-required",{_serverResponse:s}),s}async function QN(i,e,t,n){const r=`${e}${t}?${n}`,s=i,o=s.config.emulator?nM(i.config,r):`${i.config.apiScheme}://${r}`;return S4.includes(t)&&(await s._persistenceManagerAvailable,s._getPersistenceType()==="COOKIE")?s._getPersistence()._getFinalTarget(o).toString():o}class M4{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((t,n)=>{this.timer=setTimeout(()=>n(Vl(this.auth,"network-request-failed")),E4.get())})}}function $_(i,e,t){const n={appName:i.name};t.email&&(n.email=t.email),t.phoneNumber&&(n.phoneNumber=t.phoneNumber);const r=Vl(i,e,n);return r.customData._tokenResponse=t,r}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function w4(i,e){return xg(i,"POST","/v1/accounts:delete",e)}async function bb(i,e){return xg(i,"POST","/v1/accounts:lookup",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function xv(i){if(i)try{const e=new Date(Number(i));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function C4(i,e=!1){const t=Vs(i),n=await t.getIdToken(e),r=rM(n);Mn(r&&r.exp&&r.auth_time&&r.iat,t.auth,"internal-error");const s=typeof r.firebase=="object"?r.firebase:void 0,o=s==null?void 0:s.sign_in_provider;return{claims:r,token:n,authTime:xv(BE(r.auth_time)),issuedAtTime:xv(BE(r.iat)),expirationTime:xv(BE(r.exp)),signInProvider:o||null,signInSecondFactor:(s==null?void 0:s.sign_in_second_factor)||null}}function BE(i){return Number(i)*1e3}function rM(i){const[e,t,n]=i.split(".");if(e===void 0||t===void 0||n===void 0)return nb("JWT malformed, contained fewer than 3 sections"),null;try{const r=LN(t);return r?JSON.parse(r):(nb("Failed to decode base64 JWT payload"),null)}catch(r){return nb("Caught error parsing JWT payload as JSON",r==null?void 0:r.toString()),null}}function uR(i){const e=rM(i);return Mn(e,"internal-error"),Mn(typeof e.exp<"u","internal-error"),Mn(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Ov(i,e,t=!1){if(t)return e;try{return await e}catch(n){throw n instanceof qu&&R4(n)&&i.auth.currentUser===i&&await i.auth.signOut(),n}}function R4({code:i}){return i==="auth/user-disabled"||i==="auth/user-token-expired"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class I4{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){if(e){const t=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),t}else{this.errorBackoff=3e4;const n=(this.user.stsTokenManager.expirationTime??0)-Date.now()-3e5;return Math.max(0,n)}}schedule(e=!1){if(!this.isRunning)return;const t=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},t)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){(e==null?void 0:e.code)==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tT{constructor(e,t){this.createdAt=e,this.lastLoginAt=t,this._initializeTime()}_initializeTime(){this.lastSignInTime=xv(this.lastLoginAt),this.creationTime=xv(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Ab(i){var v;const e=i.auth,t=await i.getIdToken(),n=await Ov(i,bb(e,{idToken:t}));Mn(n==null?void 0:n.users.length,e,"internal-error");const r=n.users[0];i._notifyReloadListener(r);const s=(v=r.providerUserInfo)!=null&&v.length?ZN(r.providerUserInfo):[],o=N4(i.providerData,s),u=i.isAnonymous,f=!(i.email&&r.passwordHash)&&!(o!=null&&o.length),p=u?f:!1,g={uid:r.localId,displayName:r.displayName||null,photoURL:r.photoUrl||null,email:r.email||null,emailVerified:r.emailVerified||!1,phoneNumber:r.phoneNumber||null,tenantId:r.tenantId||null,providerData:o,metadata:new tT(r.createdAt,r.lastLoginAt),isAnonymous:p};Object.assign(i,g)}async function D4(i){const e=Vs(i);await Ab(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function N4(i,e){return[...i.filter(n=>!e.some(r=>r.providerId===n.providerId)),...e]}function ZN(i){return i.map(({providerId:e,...t})=>({providerId:e,uid:t.rawId||"",displayName:t.displayName||null,email:t.email||null,phoneNumber:t.phoneNumber||null,photoURL:t.photoUrl||null}))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function P4(i,e){const t=await KN(i,{},async()=>{const n=sy({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:r,apiKey:s}=i.config,o=await QN(i,r,"/v1/token",`key=${s}`),u=await i._getAdditionalHeaders();u["Content-Type"]="application/x-www-form-urlencoded";const f={method:"POST",headers:u,body:n};return i.emulatorConfig&&yg(i.emulatorConfig.host)&&(f.credentials="include"),JN.fetch()(o,f)});return{accessToken:t.access_token,expiresIn:t.expires_in,refreshToken:t.refresh_token}}async function B4(i,e){return xg(i,"POST","/v2/accounts:revokeToken",iM(i,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class km{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){Mn(e.idToken,"internal-error"),Mn(typeof e.idToken<"u","internal-error"),Mn(typeof e.refreshToken<"u","internal-error");const t="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):uR(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}updateFromIdToken(e){Mn(e.length!==0,"internal-error");const t=uR(e);this.updateTokensAndExpiration(e,null,t)}async getToken(e,t=!1){return!t&&this.accessToken&&!this.isExpired?this.accessToken:(Mn(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,t){const{accessToken:n,refreshToken:r,expiresIn:s}=await P4(e,t);this.updateTokensAndExpiration(n,r,Number(s))}updateTokensAndExpiration(e,t,n){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+n*1e3}static fromJSON(e,t){const{refreshToken:n,accessToken:r,expirationTime:s}=t,o=new km;return n&&(Mn(typeof n=="string","internal-error",{appName:e}),o.refreshToken=n),r&&(Mn(typeof r=="string","internal-error",{appName:e}),o.accessToken=r),s&&(Mn(typeof s=="number","internal-error",{appName:e}),o.expirationTime=s),o}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new km,this.toJSON())}_performRefresh(){return Bu("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Fh(i,e){Mn(typeof i=="string"||typeof i>"u","internal-error",{appName:e})}class kl{constructor({uid:e,auth:t,stsTokenManager:n,...r}){this.providerId="firebase",this.proactiveRefresh=new I4(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=e,this.auth=t,this.stsTokenManager=n,this.accessToken=n.accessToken,this.displayName=r.displayName||null,this.email=r.email||null,this.emailVerified=r.emailVerified||!1,this.phoneNumber=r.phoneNumber||null,this.photoURL=r.photoURL||null,this.isAnonymous=r.isAnonymous||!1,this.tenantId=r.tenantId||null,this.providerData=r.providerData?[...r.providerData]:[],this.metadata=new tT(r.createdAt||void 0,r.lastLoginAt||void 0)}async getIdToken(e){const t=await Ov(this,this.stsTokenManager.getToken(this.auth,e));return Mn(t,this.auth,"internal-error"),this.accessToken!==t&&(this.accessToken=t,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),t}getIdTokenResult(e){return C4(this,e)}reload(){return D4(this)}_assign(e){this!==e&&(Mn(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(t=>({...t})),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const t=new kl({...this,auth:e,stsTokenManager:this.stsTokenManager._clone()});return t.metadata._copy(this.metadata),t}_onReload(e){Mn(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,t=!1){let n=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),n=!0),t&&await Ab(this),await this.auth._persistUserIfCurrent(this),n&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(Fl(this.auth.app))return Promise.reject(zd(this.auth));const e=await this.getIdToken();return await Ov(this,w4(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return{uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>({...e})),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId,...this.metadata.toJSON(),apiKey:this.auth.config.apiKey,appName:this.auth.name}}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,t){const n=t.displayName??void 0,r=t.email??void 0,s=t.phoneNumber??void 0,o=t.photoURL??void 0,u=t.tenantId??void 0,f=t._redirectEventId??void 0,p=t.createdAt??void 0,g=t.lastLoginAt??void 0,{uid:v,emailVerified:_,isAnonymous:x,providerData:E,stsTokenManager:C}=t;Mn(v&&C,e,"internal-error");const w=km.fromJSON(this.name,C);Mn(typeof v=="string",e,"internal-error"),Fh(n,e.name),Fh(r,e.name),Mn(typeof _=="boolean",e,"internal-error"),Mn(typeof x=="boolean",e,"internal-error"),Fh(s,e.name),Fh(o,e.name),Fh(u,e.name),Fh(f,e.name),Fh(p,e.name),Fh(g,e.name);const T=new kl({uid:v,auth:e,email:r,emailVerified:_,displayName:n,isAnonymous:x,photoURL:o,phoneNumber:s,tenantId:u,stsTokenManager:w,createdAt:p,lastLoginAt:g});return E&&Array.isArray(E)&&(T.providerData=E.map(N=>({...N}))),f&&(T._redirectEventId=f),T}static async _fromIdTokenResponse(e,t,n=!1){const r=new km;r.updateFromServerResponse(t);const s=new kl({uid:t.localId,auth:e,stsTokenManager:r,isAnonymous:n});return await Ab(s),s}static async _fromGetAccountInfoResponse(e,t,n){const r=t.users[0];Mn(r.localId!==void 0,"internal-error");const s=r.providerUserInfo!==void 0?ZN(r.providerUserInfo):[],o=!(r.email&&r.passwordHash)&&!(s!=null&&s.length),u=new km;u.updateFromIdToken(n);const f=new kl({uid:r.localId,auth:e,stsTokenManager:u,isAnonymous:o}),p={uid:r.localId,displayName:r.displayName||null,photoURL:r.photoUrl||null,email:r.email||null,emailVerified:r.emailVerified||!1,phoneNumber:r.phoneNumber||null,tenantId:r.tenantId||null,providerData:s,metadata:new tT(r.createdAt,r.lastLoginAt),isAnonymous:!(r.email&&r.passwordHash)&&!(s!=null&&s.length)};return Object.assign(f,p),f}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const hR=new Map;function Lu(i){Vu(i instanceof Function,"Expected a class definition");let e=hR.get(i);return e?(Vu(e instanceof i,"Instance stored in cache mismatched with class"),e):(e=new i,hR.set(i,e),e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $N{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,t){this.storage[e]=t}async _get(e){const t=this.storage[e];return t===void 0?null:t}async _remove(e){delete this.storage[e]}_addListener(e,t){}_removeListener(e,t){}}$N.type="NONE";const fR=$N;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ib(i,e,t){return`firebase:${i}:${e}:${t}`}class zm{constructor(e,t,n){this.persistence=e,this.auth=t,this.userKey=n;const{config:r,name:s}=this.auth;this.fullUserKey=ib(this.userKey,r.apiKey,s),this.fullPersistenceKey=ib("persistence",r.apiKey,s),this.boundEventHandler=t._onStorageEvent.bind(t),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);if(!e)return null;if(typeof e=="string"){const t=await bb(this.auth,{idToken:e}).catch(()=>{});return t?kl._fromGetAccountInfoResponse(this.auth,t,e):null}return kl._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const t=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,t)return this.setCurrentUser(t)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,t,n="authUser"){if(!t.length)return new zm(Lu(fR),e,n);const r=(await Promise.all(t.map(async p=>{if(await p._isAvailable())return p}))).filter(p=>p);let s=r[0]||Lu(fR);const o=ib(n,e.config.apiKey,e.name);let u=null;for(const p of t)try{const g=await p._get(o);if(g){let v;if(typeof g=="string"){const _=await bb(e,{idToken:g}).catch(()=>{});if(!_)break;v=await kl._fromGetAccountInfoResponse(e,_,g)}else v=kl._fromJSON(e,g);p!==s&&(u=v),s=p;break}}catch{}const f=r.filter(p=>p._shouldAllowMigration);return!s._shouldAllowMigration||!f.length?new zm(s,e,n):(s=f[0],u&&await s._set(o,u.toJSON()),await Promise.all(t.map(async p=>{if(p!==s)try{await p._remove(o)}catch{}})),new zm(s,e,n))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function dR(i){const e=i.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(i3(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(e3(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(s3(e))return"Blackberry";if(a3(e))return"Webos";if(t3(e))return"Safari";if((e.includes("chrome/")||n3(e))&&!e.includes("edge/"))return"Chrome";if(r3(e))return"Android";{const t=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,n=i.match(t);if((n==null?void 0:n.length)===2)return n[1]}return"Other"}function e3(i=ua()){return/firefox\//i.test(i)}function t3(i=ua()){const e=i.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function n3(i=ua()){return/crios\//i.test(i)}function i3(i=ua()){return/iemobile/i.test(i)}function r3(i=ua()){return/android/i.test(i)}function s3(i=ua()){return/blackberry/i.test(i)}function a3(i=ua()){return/webos/i.test(i)}function sM(i=ua()){return/iphone|ipad|ipod/i.test(i)||/macintosh/i.test(i)&&/mobile/i.test(i)}function L4(i=ua()){var e;return sM(i)&&!!((e=window.navigator)!=null&&e.standalone)}function O4(){return JU()&&document.documentMode===10}function o3(i=ua()){return sM(i)||r3(i)||a3(i)||s3(i)||/windows phone/i.test(i)||i3(i)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function l3(i,e=[]){let t;switch(i){case"Browser":t=dR(ua());break;case"Worker":t=`${dR(ua())}-${i}`;break;default:t=i}const n=e.length?e.join(","):"FirebaseCore-web";return`${t}/JsCore/${_g}/${n}`}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class U4{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,t){const n=s=>new Promise((o,u)=>{try{const f=e(s);o(f)}catch(f){u(f)}});n.onAbort=t,this.queue.push(n);const r=this.queue.length-1;return()=>{this.queue[r]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const t=[];try{for(const n of this.queue)await n(e),n.onAbort&&t.push(n.onAbort)}catch(n){t.reverse();for(const r of t)try{r()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:n==null?void 0:n.message})}}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function F4(i,e={}){return xg(i,"GET","/v2/passwordPolicy",iM(i,e))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const k4=6;class z4{constructor(e){var n;const t=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=t.minPasswordLength??k4,t.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=t.maxPasswordLength),t.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=t.containsLowercaseCharacter),t.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=t.containsUppercaseCharacter),t.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=t.containsNumericCharacter),t.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=t.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=((n=e.allowedNonAlphanumericCharacters)==null?void 0:n.join(""))??"",this.forceUpgradeOnSignin=e.forceUpgradeOnSignin??!1,this.schemaVersion=e.schemaVersion}validatePassword(e){const t={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,t),this.validatePasswordCharacterOptions(e,t),t.isValid&&(t.isValid=t.meetsMinPasswordLength??!0),t.isValid&&(t.isValid=t.meetsMaxPasswordLength??!0),t.isValid&&(t.isValid=t.containsLowercaseLetter??!0),t.isValid&&(t.isValid=t.containsUppercaseLetter??!0),t.isValid&&(t.isValid=t.containsNumericCharacter??!0),t.isValid&&(t.isValid=t.containsNonAlphanumericCharacter??!0),t}validatePasswordLengthOptions(e,t){const n=this.customStrengthOptions.minPasswordLength,r=this.customStrengthOptions.maxPasswordLength;n&&(t.meetsMinPasswordLength=e.length>=n),r&&(t.meetsMaxPasswordLength=e.length<=r)}validatePasswordCharacterOptions(e,t){this.updatePasswordCharacterOptionsStatuses(t,!1,!1,!1,!1);let n;for(let r=0;r<e.length;r++)n=e.charAt(r),this.updatePasswordCharacterOptionsStatuses(t,n>="a"&&n<="z",n>="A"&&n<="Z",n>="0"&&n<="9",this.allowedNonAlphanumericCharacters.includes(n))}updatePasswordCharacterOptionsStatuses(e,t,n,r,s){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=t)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=n)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=r)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=s))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class V4{constructor(e,t,n,r){this.app=e,this.heartbeatServiceProvider=t,this.appCheckServiceProvider=n,this.config=r,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new pR(this),this.idTokenSubscription=new pR(this),this.beforeStateQueue=new U4(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=YN,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=r.sdkClientVersion,this._persistenceManagerAvailable=new Promise(s=>this._resolvePersistenceManagerAvailable=s)}_initializeWithPersistence(e,t){return t&&(this._popupRedirectResolver=Lu(t)),this._initializationPromise=this.queue(async()=>{var n,r,s;if(!this._deleted&&(this.persistenceManager=await zm.create(this,e),(n=this._resolvePersistenceManagerAvailable)==null||n.call(this),!this._deleted)){if((r=this._popupRedirectResolver)!=null&&r._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(t),this.lastNotifiedUid=((s=this.currentUser)==null?void 0:s.uid)||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const t=await bb(this,{idToken:e}),n=await kl._fromGetAccountInfoResponse(this,t,e);await this.directlySetCurrentUser(n)}catch(t){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",t),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){var s;if(Fl(this.app)){const o=this.app.settings.authIdToken;return o?new Promise(u=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(o).then(u,u))}):this.directlySetCurrentUser(null)}const t=await this.assertedPersistence.getCurrentUser();let n=t,r=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const o=(s=this.redirectUser)==null?void 0:s._redirectEventId,u=n==null?void 0:n._redirectEventId,f=await this.tryRedirectSignIn(e);(!o||o===u)&&(f!=null&&f.user)&&(n=f.user,r=!0)}if(!n)return this.directlySetCurrentUser(null);if(!n._redirectEventId){if(r)try{await this.beforeStateQueue.runMiddleware(n)}catch(o){n=t,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(o))}return n?this.reloadAndSetCurrentUserOrClear(n):this.directlySetCurrentUser(null)}return Mn(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===n._redirectEventId?this.directlySetCurrentUser(n):this.reloadAndSetCurrentUserOrClear(n)}async tryRedirectSignIn(e){let t=null;try{t=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return t}async reloadAndSetCurrentUserOrClear(e){try{await Ab(e)}catch(t){if((t==null?void 0:t.code)!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=b4()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(Fl(this.app))return Promise.reject(zd(this));const t=e?Vs(e):null;return t&&Mn(t.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(t&&t._clone(this))}async _updateCurrentUser(e,t=!1){if(!this._deleted)return e&&Mn(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),t||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return Fl(this.app)?Promise.reject(zd(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return Fl(this.app)?Promise.reject(zd(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(Lu(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const t=this._getPasswordPolicyInternal();return t.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):t.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await F4(this),t=new z4(e);this.tenantId===null?this._projectPasswordPolicy=t:this._tenantPasswordPolicies[this.tenantId]=t}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new ry("auth","Firebase",e())}onAuthStateChanged(e,t,n){return this.registerStateListener(this.authStateSubscription,e,t,n)}beforeAuthStateChanged(e,t){return this.beforeStateQueue.pushCallback(e,t)}onIdTokenChanged(e,t,n){return this.registerStateListener(this.idTokenSubscription,e,t,n)}authStateReady(){return new Promise((e,t)=>{if(this.currentUser)e();else{const n=this.onAuthStateChanged(()=>{n(),e()},t)}})}async revokeAccessToken(e){if(this.currentUser){const t=await this.currentUser.getIdToken(),n={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:t};this.tenantId!=null&&(n.tenantId=this.tenantId),await B4(this,n)}}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)==null?void 0:e.toJSON()}}async _setRedirectUser(e,t){const n=await this.getOrInitRedirectPersistenceManager(t);return e===null?n.removeCurrentUser():n.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const t=e&&Lu(e)||this._popupRedirectResolver;Mn(t,this,"argument-error"),this.redirectPersistenceManager=await zm.create(this,[Lu(t._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var t,n;return this._isInitialized&&await this.queue(async()=>{}),((t=this._currentUser)==null?void 0:t._redirectEventId)===e?this._currentUser:((n=this.redirectUser)==null?void 0:n._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var t;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const e=((t=this.currentUser)==null?void 0:t.uid)??null;this.lastNotifiedUid!==e&&(this.lastNotifiedUid=e,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,t,n,r){if(this._deleted)return()=>{};const s=typeof t=="function"?t:t.next.bind(t);let o=!1;const u=this._isInitialized?Promise.resolve():this._initializationPromise;if(Mn(u,this,"internal-error"),u.then(()=>{o||s(this.currentUser)}),typeof t=="function"){const f=e.addObserver(t,n,r);return()=>{o=!0,f()}}else{const f=e.addObserver(t);return()=>{o=!0,f()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return Mn(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=l3(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var r;const e={"X-Client-Version":this.clientVersion};this.app.options.appId&&(e["X-Firebase-gmpid"]=this.app.options.appId);const t=await((r=this.heartbeatServiceProvider.getImmediate({optional:!0}))==null?void 0:r.getHeartbeatsHeader());t&&(e["X-Firebase-Client"]=t);const n=await this._getAppCheckToken();return n&&(e["X-Firebase-AppCheck"]=n),e}async _getAppCheckToken(){var t;if(Fl(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=await((t=this.appCheckServiceProvider.getImmediate({optional:!0}))==null?void 0:t.getToken());return e!=null&&e.error&&v4(`Error while retrieving App Check token: ${e.error}`),e==null?void 0:e.token}}function FA(i){return Vs(i)}class pR{constructor(e){this.auth=e,this.observer=null,this.addObserver=iF(t=>this.observer=t)}get next(){return Mn(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let aM={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function H4(i){aM=i}function G4(i){return aM.loadJS(i)}function j4(){return aM.gapiScript}function W4(i){return`__${i}${Math.floor(Math.random()*1e6)}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function q4(i,e){const t=$T(i,"auth");if(t.isInitialized()){const r=t.getImmediate(),s=t.getOptions();if(Wd(s,e??{}))return r;Vc(r,"already-initialized")}return t.initialize({options:e})}function X4(i,e){const t=(e==null?void 0:e.persistence)||[],n=(Array.isArray(t)?t:[t]).map(Lu);e!=null&&e.errorMap&&i._updateErrorMap(e.errorMap),i._initializeWithPersistence(n,e==null?void 0:e.popupRedirectResolver)}function Y4(i,e,t){const n=FA(i);Mn(/^https?:\/\//.test(e),n,"invalid-emulator-scheme");const r=!1,s=c3(e),{host:o,port:u}=J4(e),f=u===null?"":`:${u}`,p={url:`${s}//${o}${f}/`},g=Object.freeze({host:o,port:u,protocol:s.replace(":",""),options:Object.freeze({disableWarnings:r})});if(!n._canInitEmulator){Mn(n.config.emulator&&n.emulatorConfig,n,"emulator-config-failed"),Mn(Wd(p,n.config.emulator)&&Wd(g,n.emulatorConfig),n,"emulator-config-failed");return}n.config.emulator=p,n.emulatorConfig=g,n.settings.appVerificationDisabledForTesting=!0,yg(o)?(kN(`${s}//${o}${f}`),zN("Auth",!0)):K4()}function c3(i){const e=i.indexOf(":");return e<0?"":i.substr(0,e+1)}function J4(i){const e=c3(i),t=/(\/\/)?([^?#/]+)/.exec(i.substr(e.length));if(!t)return{host:"",port:null};const n=t[2].split("@").pop()||"",r=/^(\[[^\]]+\])(:|$)/.exec(n);if(r){const s=r[1];return{host:s,port:mR(n.substr(s.length+1))}}else{const[s,o]=n.split(":");return{host:s,port:mR(o)}}}function mR(i){if(!i)return null;const e=Number(i);return isNaN(e)?null:e}function K4(){function i(){const e=document.createElement("p"),t=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",t.position="fixed",t.width="100%",t.backgroundColor="#ffffff",t.border=".1em solid #000000",t.color="#b50000",t.bottom="0px",t.left="0px",t.margin="0px",t.zIndex="10000",t.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",i):i())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class u3{constructor(e,t){this.providerId=e,this.signInMethod=t}toJSON(){return Bu("not implemented")}_getIdTokenResponse(e){return Bu("not implemented")}_linkToIdToken(e,t){return Bu("not implemented")}_getReauthenticationResolver(e){return Bu("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Vm(i,e){return T4(i,"POST","/v1/accounts:signInWithIdp",iM(i,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Q4="http://localhost";class Xd extends u3{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const t=new Xd(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(t.idToken=e.idToken),e.accessToken&&(t.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(t.nonce=e.nonce),e.pendingToken&&(t.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(t.accessToken=e.oauthToken,t.secret=e.oauthTokenSecret):Vc("argument-error"),t}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e,{providerId:n,signInMethod:r,...s}=t;if(!n||!r)return null;const o=new Xd(n,r);return o.idToken=s.idToken||void 0,o.accessToken=s.accessToken||void 0,o.secret=s.secret,o.nonce=s.nonce,o.pendingToken=s.pendingToken||null,o}_getIdTokenResponse(e){const t=this.buildRequest();return Vm(e,t)}_linkToIdToken(e,t){const n=this.buildRequest();return n.idToken=t,Vm(e,n)}_getReauthenticationResolver(e){const t=this.buildRequest();return t.autoCreate=!1,Vm(e,t)}buildRequest(){const e={requestUri:Q4,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const t={};this.idToken&&(t.id_token=this.idToken),this.accessToken&&(t.access_token=this.accessToken),this.secret&&(t.oauth_token_secret=this.secret),t.providerId=this.providerId,this.nonce&&!this.pendingToken&&(t.nonce=this.nonce),e.postBody=sy(t)}return e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oM{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oy extends oM{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yh extends oy{constructor(){super("facebook.com")}static credential(e){return Xd._fromParams({providerId:Yh.PROVIDER_ID,signInMethod:Yh.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Yh.credentialFromTaggedObject(e)}static credentialFromError(e){return Yh.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Yh.credential(e.oauthAccessToken)}catch{return null}}}Yh.FACEBOOK_SIGN_IN_METHOD="facebook.com";Yh.PROVIDER_ID="facebook.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pc extends oy{constructor(){super("google.com"),this.addScope("profile")}static credential(e,t){return Xd._fromParams({providerId:Pc.PROVIDER_ID,signInMethod:Pc.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:t})}static credentialFromResult(e){return Pc.credentialFromTaggedObject(e)}static credentialFromError(e){return Pc.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:t,oauthAccessToken:n}=e;if(!t&&!n)return null;try{return Pc.credential(t,n)}catch{return null}}}Pc.GOOGLE_SIGN_IN_METHOD="google.com";Pc.PROVIDER_ID="google.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jh extends oy{constructor(){super("github.com")}static credential(e){return Xd._fromParams({providerId:Jh.PROVIDER_ID,signInMethod:Jh.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Jh.credentialFromTaggedObject(e)}static credentialFromError(e){return Jh.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Jh.credential(e.oauthAccessToken)}catch{return null}}}Jh.GITHUB_SIGN_IN_METHOD="github.com";Jh.PROVIDER_ID="github.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Kh extends oy{constructor(){super("twitter.com")}static credential(e,t){return Xd._fromParams({providerId:Kh.PROVIDER_ID,signInMethod:Kh.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:t})}static credentialFromResult(e){return Kh.credentialFromTaggedObject(e)}static credentialFromError(e){return Kh.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:t,oauthTokenSecret:n}=e;if(!t||!n)return null;try{return Kh.credential(t,n)}catch{return null}}}Kh.TWITTER_SIGN_IN_METHOD="twitter.com";Kh.PROVIDER_ID="twitter.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qm{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,t,n,r=!1){const s=await kl._fromIdTokenResponse(e,n,r),o=gR(n);return new Qm({user:s,providerId:o,_tokenResponse:n,operationType:t})}static async _forOperation(e,t,n){await e._updateTokensIfNecessary(n,!0);const r=gR(n);return new Qm({user:e,providerId:r,_tokenResponse:n,operationType:t})}}function gR(i){return i.providerId?i.providerId:"phoneNumber"in i?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Sb extends qu{constructor(e,t,n,r){super(t.code,t.message),this.operationType=n,this.user=r,Object.setPrototypeOf(this,Sb.prototype),this.customData={appName:e.name,tenantId:e.tenantId??void 0,_serverResponse:t.customData._serverResponse,operationType:n}}static _fromErrorAndOperation(e,t,n,r){return new Sb(e,t,n,r)}}function h3(i,e,t,n){return(e==="reauthenticate"?t._getReauthenticationResolver(i):t._getIdTokenResponse(i)).catch(s=>{throw s.code==="auth/multi-factor-auth-required"?Sb._fromErrorAndOperation(i,s,e,n):s})}async function Z4(i,e,t=!1){const n=await Ov(i,e._linkToIdToken(i.auth,await i.getIdToken()),t);return Qm._forOperation(i,"link",n)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function $4(i,e,t=!1){const{auth:n}=i;if(Fl(n.app))return Promise.reject(zd(n));const r="reauthenticate";try{const s=await Ov(i,h3(n,r,e,i),t);Mn(s.idToken,n,"internal-error");const o=rM(s.idToken);Mn(o,n,"internal-error");const{sub:u}=o;return Mn(i.uid===u,n,"user-mismatch"),Qm._forOperation(i,r,s)}catch(s){throw(s==null?void 0:s.code)==="auth/user-not-found"&&Vc(n,"user-mismatch"),s}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function ek(i,e,t=!1){if(Fl(i.app))return Promise.reject(zd(i));const n="signIn",r=await h3(i,n,e),s=await Qm._fromIdTokenResponse(i,n,r);return t||await i._updateCurrentUser(s.user),s}function tk(i,e,t,n){return Vs(i).onIdTokenChanged(e,t,n)}function nk(i,e,t){return Vs(i).beforeAuthStateChanged(e,t)}function ik(i,e,t,n){return Vs(i).onAuthStateChanged(e,t,n)}function rk(i){return Vs(i).signOut()}const Eb="__sak";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class f3{constructor(e,t){this.storageRetriever=e,this.type=t}_isAvailable(){try{return this.storage?(this.storage.setItem(Eb,"1"),this.storage.removeItem(Eb),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,t){return this.storage.setItem(e,JSON.stringify(t)),Promise.resolve()}_get(e){const t=this.storage.getItem(e);return Promise.resolve(t?JSON.parse(t):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const sk=1e3,ak=10;class d3 extends f3{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,t)=>this.onStorageEvent(e,t),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=o3(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const t of Object.keys(this.listeners)){const n=this.storage.getItem(t),r=this.localCache[t];n!==r&&e(t,r,n)}}onStorageEvent(e,t=!1){if(!e.key){this.forAllChangedKeys((o,u,f)=>{this.notifyListeners(o,f)});return}const n=e.key;t?this.detachListener():this.stopPolling();const r=()=>{const o=this.storage.getItem(n);!t&&this.localCache[n]===o||this.notifyListeners(n,o)},s=this.storage.getItem(n);O4()&&s!==e.newValue&&e.newValue!==e.oldValue?setTimeout(r,ak):r()}notifyListeners(e,t){this.localCache[e]=t;const n=this.listeners[e];if(n)for(const r of Array.from(n))r(t&&JSON.parse(t))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,t,n)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:t,newValue:n}),!0)})},sk)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,t){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,t){await super._set(e,t),this.localCache[e]=JSON.stringify(t)}async _get(e){const t=await super._get(e);return this.localCache[e]=JSON.stringify(t),t}async _remove(e){await super._remove(e),delete this.localCache[e]}}d3.type="LOCAL";const ok=d3;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class p3 extends f3{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,t){}_removeListener(e,t){}}p3.type="SESSION";const m3=p3;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function lk(i){return Promise.all(i.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(t){return{fulfilled:!1,reason:t}}}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kA{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const t=this.receivers.find(r=>r.isListeningto(e));if(t)return t;const n=new kA(e);return this.receivers.push(n),n}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const t=e,{eventId:n,eventType:r,data:s}=t.data,o=this.handlersMap[r];if(!(o!=null&&o.size))return;t.ports[0].postMessage({status:"ack",eventId:n,eventType:r});const u=Array.from(o).map(async p=>p(t.origin,s)),f=await lk(u);t.ports[0].postMessage({status:"done",eventId:n,eventType:r,response:f})}_subscribe(e,t){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(t)}_unsubscribe(e,t){this.handlersMap[e]&&t&&this.handlersMap[e].delete(t),(!t||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}kA.receivers=[];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function lM(i="",e=10){let t="";for(let n=0;n<e;n++)t+=Math.floor(Math.random()*10);return i+t}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ck{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,t,n=50){const r=typeof MessageChannel<"u"?new MessageChannel:null;if(!r)throw new Error("connection_unavailable");let s,o;return new Promise((u,f)=>{const p=lM("",20);r.port1.start();const g=setTimeout(()=>{f(new Error("unsupported_event"))},n);o={messageChannel:r,onMessage(v){const _=v;if(_.data.eventId===p)switch(_.data.status){case"ack":clearTimeout(g),s=setTimeout(()=>{f(new Error("timeout"))},3e3);break;case"done":clearTimeout(s),u(_.data.response);break;default:clearTimeout(g),clearTimeout(s),f(new Error("invalid_response"));break}}},this.handlers.add(o),r.port1.addEventListener("message",o.onMessage),this.target.postMessage({eventType:e,eventId:p,data:t},[r.port2])}).finally(()=>{o&&this.removeMessageHandler(o)})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Uc(){return window}function uk(i){Uc().location.href=i}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function g3(){return typeof Uc().WorkerGlobalScope<"u"&&typeof Uc().importScripts=="function"}async function hk(){if(!(navigator!=null&&navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function fk(){var i;return((i=navigator==null?void 0:navigator.serviceWorker)==null?void 0:i.controller)||null}function dk(){return g3()?self:null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const v3="firebaseLocalStorageDb",pk=1,Tb="firebaseLocalStorage",y3="fbase_key";class ly{constructor(e){this.request=e}toPromise(){return new Promise((e,t)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{t(this.request.error)})})}}function zA(i,e){return i.transaction([Tb],e?"readwrite":"readonly").objectStore(Tb)}function mk(){const i=indexedDB.deleteDatabase(v3);return new ly(i).toPromise()}function nT(){const i=indexedDB.open(v3,pk);return new Promise((e,t)=>{i.addEventListener("error",()=>{t(i.error)}),i.addEventListener("upgradeneeded",()=>{const n=i.result;try{n.createObjectStore(Tb,{keyPath:y3})}catch(r){t(r)}}),i.addEventListener("success",async()=>{const n=i.result;n.objectStoreNames.contains(Tb)?e(n):(n.close(),await mk(),e(await nT()))})})}async function vR(i,e,t){const n=zA(i,!0).put({[y3]:e,value:t});return new ly(n).toPromise()}async function gk(i,e){const t=zA(i,!1).get(e),n=await new ly(t).toPromise();return n===void 0?null:n.value}function yR(i,e){const t=zA(i,!0).delete(e);return new ly(t).toPromise()}const vk=800,yk=3;class _3{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await nT(),this.db)}async _withRetries(e){let t=0;for(;;)try{const n=await this._openDb();return await e(n)}catch(n){if(t++>yk)throw n;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return g3()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=kA._getInstance(dk()),this.receiver._subscribe("keyChanged",async(e,t)=>({keyProcessed:(await this._poll()).includes(t.key)})),this.receiver._subscribe("ping",async(e,t)=>["keyChanged"])}async initializeSender(){var t,n;if(this.activeServiceWorker=await hk(),!this.activeServiceWorker)return;this.sender=new ck(this.activeServiceWorker);const e=await this.sender._send("ping",{},800);e&&(t=e[0])!=null&&t.fulfilled&&(n=e[0])!=null&&n.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||fk()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await nT();return await vR(e,Eb,"1"),await yR(e,Eb),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,t){return this._withPendingWrite(async()=>(await this._withRetries(n=>vR(n,e,t)),this.localCache[e]=t,this.notifyServiceWorker(e)))}async _get(e){const t=await this._withRetries(n=>gk(n,e));return this.localCache[e]=t,t}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(t=>yR(t,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(r=>{const s=zA(r,!1).getAll();return new ly(s).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const t=[],n=new Set;if(e.length!==0)for(const{fbase_key:r,value:s}of e)n.add(r),JSON.stringify(this.localCache[r])!==JSON.stringify(s)&&(this.notifyListeners(r,s),t.push(r));for(const r of Object.keys(this.localCache))this.localCache[r]&&!n.has(r)&&(this.notifyListeners(r,null),t.push(r));return t}notifyListeners(e,t){this.localCache[e]=t;const n=this.listeners[e];if(n)for(const r of Array.from(n))r(t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),vk)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,t){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}_3.type="LOCAL";const _k=_3;new ay(3e4,6e4);/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function x3(i,e){return e?Lu(e):(Mn(i._popupRedirectResolver,i,"argument-error"),i._popupRedirectResolver)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cM extends u3{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return Vm(e,this._buildIdpRequest())}_linkToIdToken(e,t){return Vm(e,this._buildIdpRequest(t))}_getReauthenticationResolver(e){return Vm(e,this._buildIdpRequest())}_buildIdpRequest(e){const t={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(t.idToken=e),t}}function xk(i){return ek(i.auth,new cM(i),i.bypassAuthState)}function bk(i){const{auth:e,user:t}=i;return Mn(t,e,"internal-error"),$4(t,new cM(i),i.bypassAuthState)}async function Ak(i){const{auth:e,user:t}=i;return Mn(t,e,"internal-error"),Z4(t,new cM(i),i.bypassAuthState)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class b3{constructor(e,t,n,r,s=!1){this.auth=e,this.resolver=n,this.user=r,this.bypassAuthState=s,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(t)?t:[t]}execute(){return new Promise(async(e,t)=>{this.pendingPromise={resolve:e,reject:t};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(n){this.reject(n)}})}async onAuthEvent(e){const{urlResponse:t,sessionId:n,postBody:r,tenantId:s,error:o,type:u}=e;if(o){this.reject(o);return}const f={auth:this.auth,requestUri:t,sessionId:n,tenantId:s||void 0,postBody:r||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(u)(f))}catch(p){this.reject(p)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return xk;case"linkViaPopup":case"linkViaRedirect":return Ak;case"reauthViaPopup":case"reauthViaRedirect":return bk;default:Vc(this.auth,"internal-error")}}resolve(e){Vu(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){Vu(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Sk=new ay(2e3,1e4);async function Ek(i,e,t){if(Fl(i.app))return Promise.reject(Vl(i,"operation-not-supported-in-this-environment"));const n=FA(i);y4(i,e,oM);const r=x3(n,t);return new Id(n,"signInViaPopup",e,r).executeNotNull()}class Id extends b3{constructor(e,t,n,r,s){super(e,t,r,s),this.provider=n,this.authWindow=null,this.pollId=null,Id.currentPopupAction&&Id.currentPopupAction.cancel(),Id.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return Mn(e,this.auth,"internal-error"),e}async onExecution(){Vu(this.filter.length===1,"Popup operations only handle one event");const e=lM();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(t=>{this.reject(t)}),this.resolver._isIframeWebStorageSupported(this.auth,t=>{t||this.reject(Vl(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){var e;return((e=this.authWindow)==null?void 0:e.associatedEvent)||null}cancel(){this.reject(Vl(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,Id.currentPopupAction=null}pollUserCancellation(){const e=()=>{var t,n;if((n=(t=this.authWindow)==null?void 0:t.window)!=null&&n.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(Vl(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,Sk.get())};e()}}Id.currentPopupAction=null;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Tk="pendingRedirect",rb=new Map;class Mk extends b3{constructor(e,t,n=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],t,void 0,n),this.eventId=null}async execute(){let e=rb.get(this.auth._key());if(!e){try{const n=await wk(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(n)}catch(t){e=()=>Promise.reject(t)}rb.set(this.auth._key(),e)}return this.bypassAuthState||rb.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const t=await this.auth._redirectUserForId(e.eventId);if(t)return this.user=t,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function wk(i,e){const t=Ik(e),n=Rk(i);if(!await n._isAvailable())return!1;const r=await n._get(t)==="true";return await n._remove(t),r}function Ck(i,e){rb.set(i._key(),e)}function Rk(i){return Lu(i._redirectPersistence)}function Ik(i){return ib(Tk,i.config.apiKey,i.name)}async function Dk(i,e,t=!1){if(Fl(i.app))return Promise.reject(zd(i));const n=FA(i),r=x3(n,e),o=await new Mk(n,r,t).execute();return o&&!t&&(delete o.user._redirectEventId,await n._persistUserIfCurrent(o.user),await n._setRedirectUser(null,e)),o}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Nk=600*1e3;class Pk{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let t=!1;return this.consumers.forEach(n=>{this.isEventForConsumer(e,n)&&(t=!0,this.sendToConsumer(e,n),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!Bk(e)||(this.hasHandledPotentialRedirect=!0,t||(this.queuedRedirectEvent=e,t=!0)),t}sendToConsumer(e,t){var n;if(e.error&&!A3(e)){const r=((n=e.error.code)==null?void 0:n.split("auth/")[1])||"internal-error";t.onError(Vl(this.auth,r))}else t.onAuthEvent(e)}isEventForConsumer(e,t){const n=t.eventId===null||!!e.eventId&&e.eventId===t.eventId;return t.filter.includes(e.type)&&n}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=Nk&&this.cachedEventUids.clear(),this.cachedEventUids.has(_R(e))}saveEventToCache(e){this.cachedEventUids.add(_R(e)),this.lastProcessedEventTime=Date.now()}}function _R(i){return[i.type,i.eventId,i.sessionId,i.tenantId].filter(e=>e).join("-")}function A3({type:i,error:e}){return i==="unknown"&&(e==null?void 0:e.code)==="auth/no-auth-event"}function Bk(i){switch(i.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return A3(i);default:return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Lk(i,e={}){return xg(i,"GET","/v1/projects",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ok=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,Uk=/^https?/;async function Fk(i){if(i.config.emulator)return;const{authorizedDomains:e}=await Lk(i);for(const t of e)try{if(kk(t))return}catch{}Vc(i,"unauthorized-domain")}function kk(i){const e=eT(),{protocol:t,hostname:n}=new URL(e);if(i.startsWith("chrome-extension://")){const o=new URL(i);return o.hostname===""&&n===""?t==="chrome-extension:"&&i.replace("chrome-extension://","")===e.replace("chrome-extension://",""):t==="chrome-extension:"&&o.hostname===n}if(!Uk.test(t))return!1;if(Ok.test(i))return n===i;const r=i.replace(/\./g,"\\.");return new RegExp("^(.+\\."+r+"|"+r+")$","i").test(n)}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const zk=new ay(3e4,6e4);function xR(){const i=Uc().___jsl;if(i!=null&&i.H){for(const e of Object.keys(i.H))if(i.H[e].r=i.H[e].r||[],i.H[e].L=i.H[e].L||[],i.H[e].r=[...i.H[e].L],i.CP)for(let t=0;t<i.CP.length;t++)i.CP[t]=null}}function Vk(i){return new Promise((e,t)=>{var r,s,o;function n(){xR(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{xR(),t(Vl(i,"network-request-failed"))},timeout:zk.get()})}if((s=(r=Uc().gapi)==null?void 0:r.iframes)!=null&&s.Iframe)e(gapi.iframes.getContext());else if((o=Uc().gapi)!=null&&o.load)n();else{const u=W4("iframefcb");return Uc()[u]=()=>{gapi.load?n():t(Vl(i,"network-request-failed"))},G4(`${j4()}?onload=${u}`).catch(f=>t(f))}}).catch(e=>{throw sb=null,e})}let sb=null;function Hk(i){return sb=sb||Vk(i),sb}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Gk=new ay(5e3,15e3),jk="__/auth/iframe",Wk="emulator/auth/iframe",qk={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},Xk=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function Yk(i){const e=i.config;Mn(e.authDomain,i,"auth-domain-config-required");const t=e.emulator?nM(e,Wk):`https://${i.config.authDomain}/${jk}`,n={apiKey:e.apiKey,appName:i.name,v:_g},r=Xk.get(i.config.apiHost);r&&(n.eid=r);const s=i._getFrameworks();return s.length&&(n.fw=s.join(",")),`${t}?${sy(n).slice(1)}`}async function Jk(i){const e=await Hk(i),t=Uc().gapi;return Mn(t,i,"internal-error"),e.open({where:document.body,url:Yk(i),messageHandlersFilter:t.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:qk,dontclear:!0},n=>new Promise(async(r,s)=>{await n.restyle({setHideOnLeave:!1});const o=Vl(i,"network-request-failed"),u=Uc().setTimeout(()=>{s(o)},Gk.get());function f(){Uc().clearTimeout(u),r(n)}n.ping(f).then(f,()=>{s(o)})}))}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Kk={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},Qk=500,Zk=600,$k="_blank",ez="http://localhost";class bR{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function tz(i,e,t,n=Qk,r=Zk){const s=Math.max((window.screen.availHeight-r)/2,0).toString(),o=Math.max((window.screen.availWidth-n)/2,0).toString();let u="";const f={...Kk,width:n.toString(),height:r.toString(),top:s,left:o},p=ua().toLowerCase();t&&(u=n3(p)?$k:t),e3(p)&&(e=e||ez,f.scrollbars="yes");const g=Object.entries(f).reduce((_,[x,E])=>`${_}${x}=${E},`,"");if(L4(p)&&u!=="_self")return nz(e||"",u),new bR(null);const v=window.open(e||"",u,g);Mn(v,i,"popup-blocked");try{v.focus()}catch{}return new bR(v)}function nz(i,e){const t=document.createElement("a");t.href=i,t.target=e;const n=document.createEvent("MouseEvent");n.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),t.dispatchEvent(n)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const iz="__/auth/handler",rz="emulator/auth/handler",sz=encodeURIComponent("fac");async function AR(i,e,t,n,r,s){Mn(i.config.authDomain,i,"auth-domain-config-required"),Mn(i.config.apiKey,i,"invalid-api-key");const o={apiKey:i.config.apiKey,appName:i.name,authType:t,redirectUrl:n,v:_g,eventId:r};if(e instanceof oM){e.setDefaultLanguage(i.languageCode),o.providerId=e.providerId||"",nF(e.getCustomParameters())||(o.customParameters=JSON.stringify(e.getCustomParameters()));for(const[g,v]of Object.entries({}))o[g]=v}if(e instanceof oy){const g=e.getScopes().filter(v=>v!=="");g.length>0&&(o.scopes=g.join(","))}i.tenantId&&(o.tid=i.tenantId);const u=o;for(const g of Object.keys(u))u[g]===void 0&&delete u[g];const f=await i._getAppCheckToken(),p=f?`#${sz}=${encodeURIComponent(f)}`:"";return`${az(i)}?${sy(u).slice(1)}${p}`}function az({config:i}){return i.emulator?nM(i,rz):`https://${i.authDomain}/${iz}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const LE="webStorageSupport";class oz{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=m3,this._completeRedirectFn=Dk,this._overrideRedirectResult=Ck}async _openPopup(e,t,n,r){var o;Vu((o=this.eventManagers[e._key()])==null?void 0:o.manager,"_initialize() not called before _openPopup()");const s=await AR(e,t,n,eT(),r);return tz(e,s,lM())}async _openRedirect(e,t,n,r){await this._originValidation(e);const s=await AR(e,t,n,eT(),r);return uk(s),new Promise(()=>{})}_initialize(e){const t=e._key();if(this.eventManagers[t]){const{manager:r,promise:s}=this.eventManagers[t];return r?Promise.resolve(r):(Vu(s,"If manager is not set, promise should be"),s)}const n=this.initAndGetManager(e);return this.eventManagers[t]={promise:n},n.catch(()=>{delete this.eventManagers[t]}),n}async initAndGetManager(e){const t=await Jk(e),n=new Pk(e);return t.register("authEvent",r=>(Mn(r==null?void 0:r.authEvent,e,"invalid-auth-event"),{status:n.onEvent(r.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:n},this.iframes[e._key()]=t,n}_isIframeWebStorageSupported(e,t){this.iframes[e._key()].send(LE,{type:LE},r=>{var o;const s=(o=r==null?void 0:r[0])==null?void 0:o[LE];s!==void 0&&t(!!s),Vc(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=Fk(e)),this.originValidationPromises[t]}get _shouldInitProactively(){return o3()||t3()||sM()}}const lz=oz;var SR="@firebase/auth",ER="1.12.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cz{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)==null?void 0:e.uid)||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const t=this.auth.onIdTokenChanged(n=>{e((n==null?void 0:n.stsTokenManager.accessToken)||null)});this.internalListeners.set(e,t),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}assertAuthConfigured(){Mn(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function uz(i){switch(i){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function hz(i){Km(new qd("auth",(e,{options:t})=>{const n=e.getProvider("app").getImmediate(),r=e.getProvider("heartbeat"),s=e.getProvider("app-check-internal"),{apiKey:o,authDomain:u}=n.options;Mn(o&&!o.includes(":"),"invalid-api-key",{appName:n.name});const f={apiKey:o,authDomain:u,clientPlatform:i,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:l3(i)},p=new V4(n,r,s,f);return X4(p,t),p},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,t,n)=>{e.getProvider("auth-internal").initialize()})),Km(new qd("auth-internal",e=>{const t=FA(e.getProvider("auth").getImmediate());return(n=>new cz(n))(t)},"PRIVATE").setInstantiationMode("EXPLICIT")),af(SR,ER,uz(i)),af(SR,ER,"esm2020")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const fz=300,dz=FN("authIdTokenMaxAge")||fz;let TR=null;const pz=i=>async e=>{const t=e&&await e.getIdTokenResult(),n=t&&(new Date().getTime()-Date.parse(t.issuedAtTime))/1e3;if(n&&n>dz)return;const r=t==null?void 0:t.token;TR!==r&&(TR=r,await fetch(i,{method:r?"POST":"DELETE",headers:r?{Authorization:`Bearer ${r}`}:{}}))};function mz(i=jN()){const e=$T(i,"auth");if(e.isInitialized())return e.getImmediate();const t=q4(i,{popupRedirectResolver:lz,persistence:[_k,ok,m3]}),n=FN("authTokenSyncURL");if(n&&typeof isSecureContext=="boolean"&&isSecureContext){const s=new URL(n,location.origin);if(location.origin===s.origin){const o=pz(s.toString());nk(t,o,()=>o(t.currentUser)),tk(t,u=>o(u))}}const r=ON("auth");return r&&Y4(t,`http://${r}`),t}function gz(){var i;return((i=document.getElementsByTagName("head"))==null?void 0:i[0])??document}H4({loadJS(i){return new Promise((e,t)=>{const n=document.createElement("script");n.setAttribute("src",i),n.onload=e,n.onerror=r=>{const s=Vl("internal-error");s.customData=r,t(s)},n.type="text/javascript",n.charset="UTF-8",gz().appendChild(n)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});hz("Browser");var MR=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var of,S3;(function(){var i;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function e(O,D){function R(){}R.prototype=D.prototype,O.F=D.prototype,O.prototype=new R,O.prototype.constructor=O,O.D=function(P,z,Y){for(var j=Array(arguments.length-2),ce=2;ce<arguments.length;ce++)j[ce-2]=arguments[ce];return D.prototype[z].apply(P,j)}}function t(){this.blockSize=-1}function n(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.C=Array(this.blockSize),this.o=this.h=0,this.u()}e(n,t),n.prototype.u=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function r(O,D,R){R||(R=0);const P=Array(16);if(typeof D=="string")for(var z=0;z<16;++z)P[z]=D.charCodeAt(R++)|D.charCodeAt(R++)<<8|D.charCodeAt(R++)<<16|D.charCodeAt(R++)<<24;else for(z=0;z<16;++z)P[z]=D[R++]|D[R++]<<8|D[R++]<<16|D[R++]<<24;D=O.g[0],R=O.g[1],z=O.g[2];let Y=O.g[3],j;j=D+(Y^R&(z^Y))+P[0]+3614090360&4294967295,D=R+(j<<7&4294967295|j>>>25),j=Y+(z^D&(R^z))+P[1]+3905402710&4294967295,Y=D+(j<<12&4294967295|j>>>20),j=z+(R^Y&(D^R))+P[2]+606105819&4294967295,z=Y+(j<<17&4294967295|j>>>15),j=R+(D^z&(Y^D))+P[3]+3250441966&4294967295,R=z+(j<<22&4294967295|j>>>10),j=D+(Y^R&(z^Y))+P[4]+4118548399&4294967295,D=R+(j<<7&4294967295|j>>>25),j=Y+(z^D&(R^z))+P[5]+1200080426&4294967295,Y=D+(j<<12&4294967295|j>>>20),j=z+(R^Y&(D^R))+P[6]+2821735955&4294967295,z=Y+(j<<17&4294967295|j>>>15),j=R+(D^z&(Y^D))+P[7]+4249261313&4294967295,R=z+(j<<22&4294967295|j>>>10),j=D+(Y^R&(z^Y))+P[8]+1770035416&4294967295,D=R+(j<<7&4294967295|j>>>25),j=Y+(z^D&(R^z))+P[9]+2336552879&4294967295,Y=D+(j<<12&4294967295|j>>>20),j=z+(R^Y&(D^R))+P[10]+4294925233&4294967295,z=Y+(j<<17&4294967295|j>>>15),j=R+(D^z&(Y^D))+P[11]+2304563134&4294967295,R=z+(j<<22&4294967295|j>>>10),j=D+(Y^R&(z^Y))+P[12]+1804603682&4294967295,D=R+(j<<7&4294967295|j>>>25),j=Y+(z^D&(R^z))+P[13]+4254626195&4294967295,Y=D+(j<<12&4294967295|j>>>20),j=z+(R^Y&(D^R))+P[14]+2792965006&4294967295,z=Y+(j<<17&4294967295|j>>>15),j=R+(D^z&(Y^D))+P[15]+1236535329&4294967295,R=z+(j<<22&4294967295|j>>>10),j=D+(z^Y&(R^z))+P[1]+4129170786&4294967295,D=R+(j<<5&4294967295|j>>>27),j=Y+(R^z&(D^R))+P[6]+3225465664&4294967295,Y=D+(j<<9&4294967295|j>>>23),j=z+(D^R&(Y^D))+P[11]+643717713&4294967295,z=Y+(j<<14&4294967295|j>>>18),j=R+(Y^D&(z^Y))+P[0]+3921069994&4294967295,R=z+(j<<20&4294967295|j>>>12),j=D+(z^Y&(R^z))+P[5]+3593408605&4294967295,D=R+(j<<5&4294967295|j>>>27),j=Y+(R^z&(D^R))+P[10]+38016083&4294967295,Y=D+(j<<9&4294967295|j>>>23),j=z+(D^R&(Y^D))+P[15]+3634488961&4294967295,z=Y+(j<<14&4294967295|j>>>18),j=R+(Y^D&(z^Y))+P[4]+3889429448&4294967295,R=z+(j<<20&4294967295|j>>>12),j=D+(z^Y&(R^z))+P[9]+568446438&4294967295,D=R+(j<<5&4294967295|j>>>27),j=Y+(R^z&(D^R))+P[14]+3275163606&4294967295,Y=D+(j<<9&4294967295|j>>>23),j=z+(D^R&(Y^D))+P[3]+4107603335&4294967295,z=Y+(j<<14&4294967295|j>>>18),j=R+(Y^D&(z^Y))+P[8]+1163531501&4294967295,R=z+(j<<20&4294967295|j>>>12),j=D+(z^Y&(R^z))+P[13]+2850285829&4294967295,D=R+(j<<5&4294967295|j>>>27),j=Y+(R^z&(D^R))+P[2]+4243563512&4294967295,Y=D+(j<<9&4294967295|j>>>23),j=z+(D^R&(Y^D))+P[7]+1735328473&4294967295,z=Y+(j<<14&4294967295|j>>>18),j=R+(Y^D&(z^Y))+P[12]+2368359562&4294967295,R=z+(j<<20&4294967295|j>>>12),j=D+(R^z^Y)+P[5]+4294588738&4294967295,D=R+(j<<4&4294967295|j>>>28),j=Y+(D^R^z)+P[8]+2272392833&4294967295,Y=D+(j<<11&4294967295|j>>>21),j=z+(Y^D^R)+P[11]+1839030562&4294967295,z=Y+(j<<16&4294967295|j>>>16),j=R+(z^Y^D)+P[14]+4259657740&4294967295,R=z+(j<<23&4294967295|j>>>9),j=D+(R^z^Y)+P[1]+2763975236&4294967295,D=R+(j<<4&4294967295|j>>>28),j=Y+(D^R^z)+P[4]+1272893353&4294967295,Y=D+(j<<11&4294967295|j>>>21),j=z+(Y^D^R)+P[7]+4139469664&4294967295,z=Y+(j<<16&4294967295|j>>>16),j=R+(z^Y^D)+P[10]+3200236656&4294967295,R=z+(j<<23&4294967295|j>>>9),j=D+(R^z^Y)+P[13]+681279174&4294967295,D=R+(j<<4&4294967295|j>>>28),j=Y+(D^R^z)+P[0]+3936430074&4294967295,Y=D+(j<<11&4294967295|j>>>21),j=z+(Y^D^R)+P[3]+3572445317&4294967295,z=Y+(j<<16&4294967295|j>>>16),j=R+(z^Y^D)+P[6]+76029189&4294967295,R=z+(j<<23&4294967295|j>>>9),j=D+(R^z^Y)+P[9]+3654602809&4294967295,D=R+(j<<4&4294967295|j>>>28),j=Y+(D^R^z)+P[12]+3873151461&4294967295,Y=D+(j<<11&4294967295|j>>>21),j=z+(Y^D^R)+P[15]+530742520&4294967295,z=Y+(j<<16&4294967295|j>>>16),j=R+(z^Y^D)+P[2]+3299628645&4294967295,R=z+(j<<23&4294967295|j>>>9),j=D+(z^(R|~Y))+P[0]+4096336452&4294967295,D=R+(j<<6&4294967295|j>>>26),j=Y+(R^(D|~z))+P[7]+1126891415&4294967295,Y=D+(j<<10&4294967295|j>>>22),j=z+(D^(Y|~R))+P[14]+2878612391&4294967295,z=Y+(j<<15&4294967295|j>>>17),j=R+(Y^(z|~D))+P[5]+4237533241&4294967295,R=z+(j<<21&4294967295|j>>>11),j=D+(z^(R|~Y))+P[12]+1700485571&4294967295,D=R+(j<<6&4294967295|j>>>26),j=Y+(R^(D|~z))+P[3]+2399980690&4294967295,Y=D+(j<<10&4294967295|j>>>22),j=z+(D^(Y|~R))+P[10]+4293915773&4294967295,z=Y+(j<<15&4294967295|j>>>17),j=R+(Y^(z|~D))+P[1]+2240044497&4294967295,R=z+(j<<21&4294967295|j>>>11),j=D+(z^(R|~Y))+P[8]+1873313359&4294967295,D=R+(j<<6&4294967295|j>>>26),j=Y+(R^(D|~z))+P[15]+4264355552&4294967295,Y=D+(j<<10&4294967295|j>>>22),j=z+(D^(Y|~R))+P[6]+2734768916&4294967295,z=Y+(j<<15&4294967295|j>>>17),j=R+(Y^(z|~D))+P[13]+1309151649&4294967295,R=z+(j<<21&4294967295|j>>>11),j=D+(z^(R|~Y))+P[4]+4149444226&4294967295,D=R+(j<<6&4294967295|j>>>26),j=Y+(R^(D|~z))+P[11]+3174756917&4294967295,Y=D+(j<<10&4294967295|j>>>22),j=z+(D^(Y|~R))+P[2]+718787259&4294967295,z=Y+(j<<15&4294967295|j>>>17),j=R+(Y^(z|~D))+P[9]+3951481745&4294967295,O.g[0]=O.g[0]+D&4294967295,O.g[1]=O.g[1]+(z+(j<<21&4294967295|j>>>11))&4294967295,O.g[2]=O.g[2]+z&4294967295,O.g[3]=O.g[3]+Y&4294967295}n.prototype.v=function(O,D){D===void 0&&(D=O.length);const R=D-this.blockSize,P=this.C;let z=this.h,Y=0;for(;Y<D;){if(z==0)for(;Y<=R;)r(this,O,Y),Y+=this.blockSize;if(typeof O=="string"){for(;Y<D;)if(P[z++]=O.charCodeAt(Y++),z==this.blockSize){r(this,P),z=0;break}}else for(;Y<D;)if(P[z++]=O[Y++],z==this.blockSize){r(this,P),z=0;break}}this.h=z,this.o+=D},n.prototype.A=function(){var O=Array((this.h<56?this.blockSize:this.blockSize*2)-this.h);O[0]=128;for(var D=1;D<O.length-8;++D)O[D]=0;D=this.o*8;for(var R=O.length-8;R<O.length;++R)O[R]=D&255,D/=256;for(this.v(O),O=Array(16),D=0,R=0;R<4;++R)for(let P=0;P<32;P+=8)O[D++]=this.g[R]>>>P&255;return O};function s(O,D){var R=u;return Object.prototype.hasOwnProperty.call(R,O)?R[O]:R[O]=D(O)}function o(O,D){this.h=D;const R=[];let P=!0;for(let z=O.length-1;z>=0;z--){const Y=O[z]|0;P&&Y==D||(R[z]=Y,P=!1)}this.g=R}var u={};function f(O){return-128<=O&&O<128?s(O,function(D){return new o([D|0],D<0?-1:0)}):new o([O|0],O<0?-1:0)}function p(O){if(isNaN(O)||!isFinite(O))return v;if(O<0)return w(p(-O));const D=[];let R=1;for(let P=0;O>=R;P++)D[P]=O/R|0,R*=4294967296;return new o(D,0)}function g(O,D){if(O.length==0)throw Error("number format error: empty string");if(D=D||10,D<2||36<D)throw Error("radix out of range: "+D);if(O.charAt(0)=="-")return w(g(O.substring(1),D));if(O.indexOf("-")>=0)throw Error('number format error: interior "-" character');const R=p(Math.pow(D,8));let P=v;for(let Y=0;Y<O.length;Y+=8){var z=Math.min(8,O.length-Y);const j=parseInt(O.substring(Y,Y+z),D);z<8?(z=p(Math.pow(D,z)),P=P.j(z).add(p(j))):(P=P.j(R),P=P.add(p(j)))}return P}var v=f(0),_=f(1),x=f(16777216);i=o.prototype,i.m=function(){if(C(this))return-w(this).m();let O=0,D=1;for(let R=0;R<this.g.length;R++){const P=this.i(R);O+=(P>=0?P:4294967296+P)*D,D*=4294967296}return O},i.toString=function(O){if(O=O||10,O<2||36<O)throw Error("radix out of range: "+O);if(E(this))return"0";if(C(this))return"-"+w(this).toString(O);const D=p(Math.pow(O,6));var R=this;let P="";for(;;){const z=F(R,D).g;R=T(R,z.j(D));let Y=((R.g.length>0?R.g[0]:R.h)>>>0).toString(O);if(R=z,E(R))return Y+P;for(;Y.length<6;)Y="0"+Y;P=Y+P}},i.i=function(O){return O<0?0:O<this.g.length?this.g[O]:this.h};function E(O){if(O.h!=0)return!1;for(let D=0;D<O.g.length;D++)if(O.g[D]!=0)return!1;return!0}function C(O){return O.h==-1}i.l=function(O){return O=T(this,O),C(O)?-1:E(O)?0:1};function w(O){const D=O.g.length,R=[];for(let P=0;P<D;P++)R[P]=~O.g[P];return new o(R,~O.h).add(_)}i.abs=function(){return C(this)?w(this):this},i.add=function(O){const D=Math.max(this.g.length,O.g.length),R=[];let P=0;for(let z=0;z<=D;z++){let Y=P+(this.i(z)&65535)+(O.i(z)&65535),j=(Y>>>16)+(this.i(z)>>>16)+(O.i(z)>>>16);P=j>>>16,Y&=65535,j&=65535,R[z]=j<<16|Y}return new o(R,R[R.length-1]&-2147483648?-1:0)};function T(O,D){return O.add(w(D))}i.j=function(O){if(E(this)||E(O))return v;if(C(this))return C(O)?w(this).j(w(O)):w(w(this).j(O));if(C(O))return w(this.j(w(O)));if(this.l(x)<0&&O.l(x)<0)return p(this.m()*O.m());const D=this.g.length+O.g.length,R=[];for(var P=0;P<2*D;P++)R[P]=0;for(P=0;P<this.g.length;P++)for(let z=0;z<O.g.length;z++){const Y=this.i(P)>>>16,j=this.i(P)&65535,ce=O.i(z)>>>16,fe=O.i(z)&65535;R[2*P+2*z]+=j*fe,N(R,2*P+2*z),R[2*P+2*z+1]+=Y*fe,N(R,2*P+2*z+1),R[2*P+2*z+1]+=j*ce,N(R,2*P+2*z+1),R[2*P+2*z+2]+=Y*ce,N(R,2*P+2*z+2)}for(O=0;O<D;O++)R[O]=R[2*O+1]<<16|R[2*O];for(O=D;O<2*D;O++)R[O]=0;return new o(R,0)};function N(O,D){for(;(O[D]&65535)!=O[D];)O[D+1]+=O[D]>>>16,O[D]&=65535,D++}function L(O,D){this.g=O,this.h=D}function F(O,D){if(E(D))throw Error("division by zero");if(E(O))return new L(v,v);if(C(O))return D=F(w(O),D),new L(w(D.g),w(D.h));if(C(D))return D=F(O,w(D)),new L(w(D.g),D.h);if(O.g.length>30){if(C(O)||C(D))throw Error("slowDivide_ only works with positive integers.");for(var R=_,P=D;P.l(O)<=0;)R=G(R),P=G(P);var z=k(R,1),Y=k(P,1);for(P=k(P,2),R=k(R,2);!E(P);){var j=Y.add(P);j.l(O)<=0&&(z=z.add(R),Y=j),P=k(P,1),R=k(R,1)}return D=T(O,z.j(D)),new L(z,D)}for(z=v;O.l(D)>=0;){for(R=Math.max(1,Math.floor(O.m()/D.m())),P=Math.ceil(Math.log(R)/Math.LN2),P=P<=48?1:Math.pow(2,P-48),Y=p(R),j=Y.j(D);C(j)||j.l(O)>0;)R-=P,Y=p(R),j=Y.j(D);E(Y)&&(Y=_),z=z.add(Y),O=T(O,j)}return new L(z,O)}i.B=function(O){return F(this,O).h},i.and=function(O){const D=Math.max(this.g.length,O.g.length),R=[];for(let P=0;P<D;P++)R[P]=this.i(P)&O.i(P);return new o(R,this.h&O.h)},i.or=function(O){const D=Math.max(this.g.length,O.g.length),R=[];for(let P=0;P<D;P++)R[P]=this.i(P)|O.i(P);return new o(R,this.h|O.h)},i.xor=function(O){const D=Math.max(this.g.length,O.g.length),R=[];for(let P=0;P<D;P++)R[P]=this.i(P)^O.i(P);return new o(R,this.h^O.h)};function G(O){const D=O.g.length+1,R=[];for(let P=0;P<D;P++)R[P]=O.i(P)<<1|O.i(P-1)>>>31;return new o(R,O.h)}function k(O,D){const R=D>>5;D%=32;const P=O.g.length-R,z=[];for(let Y=0;Y<P;Y++)z[Y]=D>0?O.i(Y+R)>>>D|O.i(Y+R+1)<<32-D:O.i(Y+R);return new o(z,O.h)}n.prototype.digest=n.prototype.A,n.prototype.reset=n.prototype.u,n.prototype.update=n.prototype.v,S3=n,o.prototype.add=o.prototype.add,o.prototype.multiply=o.prototype.j,o.prototype.modulo=o.prototype.B,o.prototype.compare=o.prototype.l,o.prototype.toNumber=o.prototype.m,o.prototype.toString=o.prototype.toString,o.prototype.getBits=o.prototype.i,o.fromNumber=p,o.fromString=g,of=o}).apply(typeof MR<"u"?MR:typeof self<"u"?self:typeof window<"u"?window:{});var ex=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var E3,fv,T3,ab,iT,M3,w3,C3;(function(){var i,e=Object.defineProperty;function t(b){b=[typeof globalThis=="object"&&globalThis,b,typeof window=="object"&&window,typeof self=="object"&&self,typeof ex=="object"&&ex];for(var U=0;U<b.length;++U){var W=b[U];if(W&&W.Math==Math)return W}throw Error("Cannot find global object")}var n=t(this);function r(b,U){if(U)e:{var W=n;b=b.split(".");for(var ne=0;ne<b.length-1;ne++){var Ee=b[ne];if(!(Ee in W))break e;W=W[Ee]}b=b[b.length-1],ne=W[b],U=U(ne),U!=ne&&U!=null&&e(W,b,{configurable:!0,writable:!0,value:U})}}r("Symbol.dispose",function(b){return b||Symbol("Symbol.dispose")}),r("Array.prototype.values",function(b){return b||function(){return this[Symbol.iterator]()}}),r("Object.entries",function(b){return b||function(U){var W=[],ne;for(ne in U)Object.prototype.hasOwnProperty.call(U,ne)&&W.push([ne,U[ne]]);return W}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var s=s||{},o=this||self;function u(b){var U=typeof b;return U=="object"&&b!=null||U=="function"}function f(b,U,W){return b.call.apply(b.bind,arguments)}function p(b,U,W){return p=f,p.apply(null,arguments)}function g(b,U){var W=Array.prototype.slice.call(arguments,1);return function(){var ne=W.slice();return ne.push.apply(ne,arguments),b.apply(this,ne)}}function v(b,U){function W(){}W.prototype=U.prototype,b.Z=U.prototype,b.prototype=new W,b.prototype.constructor=b,b.Ob=function(ne,Ee,ze){for(var Ot=Array(arguments.length-2),Cn=2;Cn<arguments.length;Cn++)Ot[Cn-2]=arguments[Cn];return U.prototype[Ee].apply(ne,Ot)}}var _=typeof AsyncContext<"u"&&typeof AsyncContext.Snapshot=="function"?b=>b&&AsyncContext.Snapshot.wrap(b):b=>b;function x(b){const U=b.length;if(U>0){const W=Array(U);for(let ne=0;ne<U;ne++)W[ne]=b[ne];return W}return[]}function E(b,U){for(let ne=1;ne<arguments.length;ne++){const Ee=arguments[ne];var W=typeof Ee;if(W=W!="object"?W:Ee?Array.isArray(Ee)?"array":W:"null",W=="array"||W=="object"&&typeof Ee.length=="number"){W=b.length||0;const ze=Ee.length||0;b.length=W+ze;for(let Ot=0;Ot<ze;Ot++)b[W+Ot]=Ee[Ot]}else b.push(Ee)}}class C{constructor(U,W){this.i=U,this.j=W,this.h=0,this.g=null}get(){let U;return this.h>0?(this.h--,U=this.g,this.g=U.next,U.next=null):U=this.i(),U}}function w(b){o.setTimeout(()=>{throw b},0)}function T(){var b=O;let U=null;return b.g&&(U=b.g,b.g=b.g.next,b.g||(b.h=null),U.next=null),U}class N{constructor(){this.h=this.g=null}add(U,W){const ne=L.get();ne.set(U,W),this.h?this.h.next=ne:this.g=ne,this.h=ne}}var L=new C(()=>new F,b=>b.reset());class F{constructor(){this.next=this.g=this.h=null}set(U,W){this.h=U,this.g=W,this.next=null}reset(){this.next=this.g=this.h=null}}let G,k=!1,O=new N,D=()=>{const b=Promise.resolve(void 0);G=()=>{b.then(R)}};function R(){for(var b;b=T();){try{b.h.call(b.g)}catch(W){w(W)}var U=L;U.j(b),U.h<100&&(U.h++,b.next=U.g,U.g=b)}k=!1}function P(){this.u=this.u,this.C=this.C}P.prototype.u=!1,P.prototype.dispose=function(){this.u||(this.u=!0,this.N())},P.prototype[Symbol.dispose]=function(){this.dispose()},P.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function z(b,U){this.type=b,this.g=this.target=U,this.defaultPrevented=!1}z.prototype.h=function(){this.defaultPrevented=!0};var Y=(function(){if(!o.addEventListener||!Object.defineProperty)return!1;var b=!1,U=Object.defineProperty({},"passive",{get:function(){b=!0}});try{const W=()=>{};o.addEventListener("test",W,U),o.removeEventListener("test",W,U)}catch{}return b})();function j(b){return/^[\s\xa0]*$/.test(b)}function ce(b,U){z.call(this,b?b.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,b&&this.init(b,U)}v(ce,z),ce.prototype.init=function(b,U){const W=this.type=b.type,ne=b.changedTouches&&b.changedTouches.length?b.changedTouches[0]:null;this.target=b.target||b.srcElement,this.g=U,U=b.relatedTarget,U||(W=="mouseover"?U=b.fromElement:W=="mouseout"&&(U=b.toElement)),this.relatedTarget=U,ne?(this.clientX=ne.clientX!==void 0?ne.clientX:ne.pageX,this.clientY=ne.clientY!==void 0?ne.clientY:ne.pageY,this.screenX=ne.screenX||0,this.screenY=ne.screenY||0):(this.clientX=b.clientX!==void 0?b.clientX:b.pageX,this.clientY=b.clientY!==void 0?b.clientY:b.pageY,this.screenX=b.screenX||0,this.screenY=b.screenY||0),this.button=b.button,this.key=b.key||"",this.ctrlKey=b.ctrlKey,this.altKey=b.altKey,this.shiftKey=b.shiftKey,this.metaKey=b.metaKey,this.pointerId=b.pointerId||0,this.pointerType=b.pointerType,this.state=b.state,this.i=b,b.defaultPrevented&&ce.Z.h.call(this)},ce.prototype.h=function(){ce.Z.h.call(this);const b=this.i;b.preventDefault?b.preventDefault():b.returnValue=!1};var fe="closure_listenable_"+(Math.random()*1e6|0),te=0;function se(b,U,W,ne,Ee){this.listener=b,this.proxy=null,this.src=U,this.type=W,this.capture=!!ne,this.ha=Ee,this.key=++te,this.da=this.fa=!1}function Ae(b){b.da=!0,b.listener=null,b.proxy=null,b.src=null,b.ha=null}function Pe(b,U,W){for(const ne in b)U.call(W,b[ne],ne,b)}function Re(b,U){for(const W in b)U.call(void 0,b[W],W,b)}function $(b){const U={};for(const W in b)U[W]=b[W];return U}const ae="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function Se(b,U){let W,ne;for(let Ee=1;Ee<arguments.length;Ee++){ne=arguments[Ee];for(W in ne)b[W]=ne[W];for(let ze=0;ze<ae.length;ze++)W=ae[ze],Object.prototype.hasOwnProperty.call(ne,W)&&(b[W]=ne[W])}}function ke(b){this.src=b,this.g={},this.h=0}ke.prototype.add=function(b,U,W,ne,Ee){const ze=b.toString();b=this.g[ze],b||(b=this.g[ze]=[],this.h++);const Ot=ve(b,U,ne,Ee);return Ot>-1?(U=b[Ot],W||(U.fa=!1)):(U=new se(U,this.src,ze,!!ne,Ee),U.fa=W,b.push(U)),U};function dt(b,U){const W=U.type;if(W in b.g){var ne=b.g[W],Ee=Array.prototype.indexOf.call(ne,U,void 0),ze;(ze=Ee>=0)&&Array.prototype.splice.call(ne,Ee,1),ze&&(Ae(U),b.g[W].length==0&&(delete b.g[W],b.h--))}}function ve(b,U,W,ne){for(let Ee=0;Ee<b.length;++Ee){const ze=b[Ee];if(!ze.da&&ze.listener==U&&ze.capture==!!W&&ze.ha==ne)return Ee}return-1}var Le="closure_lm_"+(Math.random()*1e6|0),lt={};function _t(b,U,W,ne,Ee){if(Array.isArray(U)){for(let ze=0;ze<U.length;ze++)_t(b,U[ze],W,ne,Ee);return null}return W=re(W),b&&b[fe]?b.J(U,W,u(ne)?!!ne.capture:!1,Ee):Dt(b,U,W,!1,ne,Ee)}function Dt(b,U,W,ne,Ee,ze){if(!U)throw Error("Invalid event type");const Ot=u(Ee)?!!Ee.capture:!!Ee;let Cn=Je(b);if(Cn||(b[Le]=Cn=new ke(b)),W=Cn.add(U,W,ne,Ot,ze),W.proxy)return W;if(ne=qt(),W.proxy=ne,ne.src=b,ne.listener=W,b.addEventListener)Y||(Ee=Ot),Ee===void 0&&(Ee=!1),b.addEventListener(U.toString(),ne,Ee);else if(b.attachEvent)b.attachEvent(qe(U.toString()),ne);else if(b.addListener&&b.removeListener)b.addListener(ne);else throw Error("addEventListener and attachEvent are unavailable.");return W}function qt(){function b(W){return U.call(b.src,b.listener,W)}const U=rt;return b}function un(b,U,W,ne,Ee){if(Array.isArray(U))for(var ze=0;ze<U.length;ze++)un(b,U[ze],W,ne,Ee);else ne=u(ne)?!!ne.capture:!!ne,W=re(W),b&&b[fe]?(b=b.i,ze=String(U).toString(),ze in b.g&&(U=b.g[ze],W=ve(U,W,ne,Ee),W>-1&&(Ae(U[W]),Array.prototype.splice.call(U,W,1),U.length==0&&(delete b.g[ze],b.h--)))):b&&(b=Je(b))&&(U=b.g[U.toString()],b=-1,U&&(b=ve(U,W,ne,Ee)),(W=b>-1?U[b]:null)&&Yt(W))}function Yt(b){if(typeof b!="number"&&b&&!b.da){var U=b.src;if(U&&U[fe])dt(U.i,b);else{var W=b.type,ne=b.proxy;U.removeEventListener?U.removeEventListener(W,ne,b.capture):U.detachEvent?U.detachEvent(qe(W),ne):U.addListener&&U.removeListener&&U.removeListener(ne),(W=Je(U))?(dt(W,b),W.h==0&&(W.src=null,U[Le]=null)):Ae(b)}}}function qe(b){return b in lt?lt[b]:lt[b]="on"+b}function rt(b,U){if(b.da)b=!0;else{U=new ce(U,this);const W=b.listener,ne=b.ha||b.src;b.fa&&Yt(b),b=W.call(ne,U)}return b}function Je(b){return b=b[Le],b instanceof ke?b:null}var xt="__closure_events_fn_"+(Math.random()*1e9>>>0);function re(b){return typeof b=="function"?b:(b[xt]||(b[xt]=function(U){return b.handleEvent(U)}),b[xt])}function Lt(){P.call(this),this.i=new ke(this),this.M=this,this.G=null}v(Lt,P),Lt.prototype[fe]=!0,Lt.prototype.removeEventListener=function(b,U,W,ne){un(this,b,U,W,ne)};function vt(b,U){var W,ne=b.G;if(ne)for(W=[];ne;ne=ne.G)W.push(ne);if(b=b.M,ne=U.type||U,typeof U=="string")U=new z(U,b);else if(U instanceof z)U.target=U.target||b;else{var Ee=U;U=new z(ne,b),Se(U,Ee)}Ee=!0;let ze,Ot;if(W)for(Ot=W.length-1;Ot>=0;Ot--)ze=U.g=W[Ot],Ee=Qt(ze,ne,!0,U)&&Ee;if(ze=U.g=b,Ee=Qt(ze,ne,!0,U)&&Ee,Ee=Qt(ze,ne,!1,U)&&Ee,W)for(Ot=0;Ot<W.length;Ot++)ze=U.g=W[Ot],Ee=Qt(ze,ne,!1,U)&&Ee}Lt.prototype.N=function(){if(Lt.Z.N.call(this),this.i){var b=this.i;for(const U in b.g){const W=b.g[U];for(let ne=0;ne<W.length;ne++)Ae(W[ne]);delete b.g[U],b.h--}}this.G=null},Lt.prototype.J=function(b,U,W,ne){return this.i.add(String(b),U,!1,W,ne)},Lt.prototype.K=function(b,U,W,ne){return this.i.add(String(b),U,!0,W,ne)};function Qt(b,U,W,ne){if(U=b.i.g[String(U)],!U)return!0;U=U.concat();let Ee=!0;for(let ze=0;ze<U.length;++ze){const Ot=U[ze];if(Ot&&!Ot.da&&Ot.capture==W){const Cn=Ot.listener,sr=Ot.ha||Ot.src;Ot.fa&&dt(b.i,Ot),Ee=Cn.call(sr,ne)!==!1&&Ee}}return Ee&&!ne.defaultPrevented}function bt(b,U){if(typeof b!="function")if(b&&typeof b.handleEvent=="function")b=p(b.handleEvent,b);else throw Error("Invalid listener argument");return Number(U)>2147483647?-1:o.setTimeout(b,U||0)}function ee(b){b.g=bt(()=>{b.g=null,b.i&&(b.i=!1,ee(b))},b.l);const U=b.h;b.h=null,b.m.apply(null,U)}class q extends P{constructor(U,W){super(),this.m=U,this.l=W,this.h=null,this.i=!1,this.g=null}j(U){this.h=arguments,this.g?this.i=!0:ee(this)}N(){super.N(),this.g&&(o.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function ge(b){P.call(this),this.h=b,this.g={}}v(ge,P);var Fe=[];function Xe(b){Pe(b.g,function(U,W){this.g.hasOwnProperty(W)&&Yt(U)},b),b.g={}}ge.prototype.N=function(){ge.Z.N.call(this),Xe(this)},ge.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var Ue=o.JSON.stringify,Ft=o.JSON.parse,Ct=class{stringify(b){return o.JSON.stringify(b,void 0)}parse(b){return o.JSON.parse(b,void 0)}};function Xt(){}function an(){}var tt={OPEN:"a",hb:"b",ERROR:"c",tb:"d"};function it(){z.call(this,"d")}v(it,z);function Ut(){z.call(this,"c")}v(Ut,z);var oe={},Te=null;function ot(){return Te=Te||new Lt}oe.Ia="serverreachability";function ue(b){z.call(this,oe.Ia,b)}v(ue,z);function Ce(b){const U=ot();vt(U,new ue(U))}oe.STAT_EVENT="statevent";function at(b,U){z.call(this,oe.STAT_EVENT,b),this.stat=U}v(at,z);function gt(b){const U=ot();vt(U,new at(U,b))}oe.Ja="timingevent";function ut(b,U){z.call(this,oe.Ja,b),this.size=U}v(ut,z);function Ye(b,U){if(typeof b!="function")throw Error("Fn must not be null and must be a function");return o.setTimeout(function(){b()},U)}function pt(){this.g=!0}pt.prototype.ua=function(){this.g=!1};function rn(b,U,W,ne,Ee,ze){b.info(function(){if(b.g)if(ze){var Ot="",Cn=ze.split("&");for(let ei=0;ei<Cn.length;ei++){var sr=Cn[ei].split("=");if(sr.length>1){const Fi=sr[0];sr=sr[1];const ws=Fi.split("_");Ot=ws.length>=2&&ws[1]=="type"?Ot+(Fi+"="+sr+"&"):Ot+(Fi+"=redacted&")}}}else Ot=null;else Ot=ze;return"XMLHTTP REQ ("+ne+") [attempt "+Ee+"]: "+U+`
`+W+`
`+Ot})}function Tn(b,U,W,ne,Ee,ze,Ot){b.info(function(){return"XMLHTTP RESP ("+ne+") [ attempt "+Ee+"]: "+U+`
`+W+`
`+ze+" "+Ot})}function yn(b,U,W,ne){b.info(function(){return"XMLHTTP TEXT ("+U+"): "+Xi(b,W)+(ne?" "+ne:"")})}function Ii(b,U){b.info(function(){return"TIMEOUT: "+U})}pt.prototype.info=function(){};function Xi(b,U){if(!b.g)return U;if(!U)return null;try{const ze=JSON.parse(U);if(ze){for(b=0;b<ze.length;b++)if(Array.isArray(ze[b])){var W=ze[b];if(!(W.length<2)){var ne=W[1];if(Array.isArray(ne)&&!(ne.length<1)){var Ee=ne[0];if(Ee!="noop"&&Ee!="stop"&&Ee!="close")for(let Ot=1;Ot<ne.length;Ot++)ne[Ot]=""}}}}return Ue(ze)}catch{return U}}var As={NO_ERROR:0,cb:1,qb:2,pb:3,kb:4,ob:5,rb:6,Ga:7,TIMEOUT:8,ub:9},fa={ib:"complete",Fb:"success",ERROR:"error",Ga:"abort",xb:"ready",yb:"readystatechange",TIMEOUT:"timeout",sb:"incrementaldata",wb:"progress",lb:"downloadprogress",Nb:"uploadprogress"},Ss;function Ws(){}v(Ws,Xt),Ws.prototype.g=function(){return new XMLHttpRequest},Ss=new Ws;function fr(b){return encodeURIComponent(String(b))}function Es(b){var U=1;b=b.split(":");const W=[];for(;U>0&&b.length;)W.push(b.shift()),U--;return b.length&&W.push(b.join(":")),W}function sn(b,U,W,ne){this.j=b,this.i=U,this.l=W,this.S=ne||1,this.V=new ge(this),this.H=45e3,this.J=null,this.o=!1,this.u=this.B=this.A=this.M=this.F=this.T=this.D=null,this.G=[],this.g=null,this.C=0,this.m=this.v=null,this.X=-1,this.K=!1,this.P=0,this.O=null,this.W=this.L=this.U=this.R=!1,this.h=new Br}function Br(){this.i=null,this.g="",this.h=!1}var Si={},X={};function Z(b,U,W){b.M=1,b.A=zt(At(U)),b.u=W,b.R=!0,he(b,null)}function he(b,U){b.F=Date.now(),mt(b),b.B=At(b.A);var W=b.B,ne=b.S;Array.isArray(ne)||(ne=[String(ne)]),Ts(W.i,"t",ne),b.C=0,W=b.j.L,b.h=new Br,b.g=Df(b.j,W?U:null,!b.u),b.P>0&&(b.O=new q(p(b.Y,b,b.g),b.P)),U=b.V,W=b.g,ne=b.ba;var Ee="readystatechange";Array.isArray(Ee)||(Ee&&(Fe[0]=Ee.toString()),Ee=Fe);for(let ze=0;ze<Ee.length;ze++){const Ot=_t(W,Ee[ze],ne||U.handleEvent,!1,U.h||U);if(!Ot)break;U.g[Ot.key]=Ot}U=b.J?$(b.J):{},b.u?(b.v||(b.v="POST"),U["Content-Type"]="application/x-www-form-urlencoded",b.g.ea(b.B,b.v,b.u,U)):(b.v="GET",b.g.ea(b.B,b.v,null,U)),Ce(),rn(b.i,b.v,b.B,b.l,b.S,b.u)}sn.prototype.ba=function(b){b=b.target;const U=this.O;U&&ro(b)==3?U.j():this.Y(b)},sn.prototype.Y=function(b){try{if(b==this.g)e:{const Cn=ro(this.g),sr=this.g.ya(),ei=this.g.ca();if(!(Cn<3)&&(Cn!=3||this.g&&(this.h.h||this.g.la()||Wr(this.g)))){this.K||Cn!=4||sr==7||(sr==8||ei<=0?Ce(3):Ce(2)),Rt(this);var U=this.g.ca();this.X=U;var W=Ie(this);if(this.o=U==200,Tn(this.i,this.v,this.B,this.l,this.S,Cn,U),this.o){if(this.U&&!this.L){t:{if(this.g){var ne,Ee=this.g;if((ne=Ee.g?Ee.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!j(ne)){var ze=ne;break t}}ze=null}if(b=ze)yn(this.i,this.l,b,"Initial handshake response via X-HTTP-Initial-Response"),this.L=!0,Mt(this,b);else{this.o=!1,this.m=3,gt(12),wt(this),Tt(this);break e}}if(this.R){b=!0;let Fi;for(;!this.K&&this.C<W.length;)if(Fi=Ge(this,W),Fi==X){Cn==4&&(this.m=4,gt(14),b=!1),yn(this.i,this.l,null,"[Incomplete Response]");break}else if(Fi==Si){this.m=4,gt(15),yn(this.i,this.l,W,"[Invalid Chunk]"),b=!1;break}else yn(this.i,this.l,Fi,null),Mt(this,Fi);if(He(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),Cn!=4||W.length!=0||this.h.h||(this.m=1,gt(16),b=!1),this.o=this.o&&b,!b)yn(this.i,this.l,W,"[Invalid Chunked Response]"),wt(this),Tt(this);else if(W.length>0&&!this.W){this.W=!0;var Ot=this.j;Ot.g==this&&Ot.aa&&!Ot.P&&(Ot.j.info("Great, no buffering proxy detected. Bytes received: "+W.length),$u(Ot),Ot.P=!0,gt(11))}}else yn(this.i,this.l,W,null),Mt(this,W);Cn==4&&wt(this),this.o&&!this.K&&(Cn==4?Rf(this.j,this):(this.o=!1,mt(this)))}else Co(this.g),U==400&&W.indexOf("Unknown SID")>0?(this.m=3,gt(12)):(this.m=0,gt(13)),wt(this),Tt(this)}}}catch{}finally{}};function Ie(b){if(!He(b))return b.g.la();const U=Wr(b.g);if(U==="")return"";let W="";const ne=U.length,Ee=ro(b.g)==4;if(!b.h.i){if(typeof TextDecoder>"u")return wt(b),Tt(b),"";b.h.i=new o.TextDecoder}for(let ze=0;ze<ne;ze++)b.h.h=!0,W+=b.h.i.decode(U[ze],{stream:!(Ee&&ze==ne-1)});return U.length=0,b.h.g+=W,b.C=0,b.h.g}function He(b){return b.g?b.v=="GET"&&b.M!=2&&b.j.Aa:!1}function Ge(b,U){var W=b.C,ne=U.indexOf(`
`,W);return ne==-1?X:(W=Number(U.substring(W,ne)),isNaN(W)?Si:(ne+=1,ne+W>U.length?X:(U=U.slice(ne,ne+W),b.C=ne+W,U)))}sn.prototype.cancel=function(){this.K=!0,wt(this)};function mt(b){b.T=Date.now()+b.H,ht(b,b.H)}function ht(b,U){if(b.D!=null)throw Error("WatchDog timer not null");b.D=Ye(p(b.aa,b),U)}function Rt(b){b.D&&(o.clearTimeout(b.D),b.D=null)}sn.prototype.aa=function(){this.D=null;const b=Date.now();b-this.T>=0?(Ii(this.i,this.B),this.M!=2&&(Ce(),gt(17)),wt(this),this.m=2,Tt(this)):ht(this,this.T-b)};function Tt(b){b.j.I==0||b.K||Rf(b.j,b)}function wt(b){Rt(b);var U=b.O;U&&typeof U.dispose=="function"&&U.dispose(),b.O=null,Xe(b.V),b.g&&(U=b.g,b.g=null,U.abort(),U.dispose())}function Mt(b,U){try{var W=b.j;if(W.I!=0&&(W.g==b||me(W.h,b))){if(!b.L&&me(W.h,b)&&W.I==3){try{var ne=W.Ba.g.parse(U)}catch{ne=null}if(Array.isArray(ne)&&ne.length==3){var Ee=ne;if(Ee[0]==0){e:if(!W.v){if(W.g)if(W.g.F+3e3<b.F)eh(W),Ro(W);else break e;tc(W),gt(18)}}else W.xa=Ee[1],0<W.xa-W.K&&Ee[2]<37500&&W.F&&W.A==0&&!W.C&&(W.C=Ye(p(W.Va,W),6e3));xe(W.h)<=1&&W.ta&&(W.ta=void 0)}else Da(W,11)}else if((b.L||W.g==b)&&eh(W),!j(U))for(Ee=W.Ba.g.parse(U),U=0;U<Ee.length;U++){let ei=Ee[U];const Fi=ei[0];if(!(Fi<=W.K))if(W.K=Fi,ei=ei[1],W.I==2)if(ei[0]=="c"){W.M=ei[1],W.ba=ei[2];const ws=ei[3];ws!=null&&(W.ka=ws,W.j.info("VER="+W.ka));const oo=ei[4];oo!=null&&(W.za=oo,W.j.info("SVER="+W.za));const lo=ei[5];lo!=null&&typeof lo=="number"&&lo>0&&(ne=1.5*lo,W.O=ne,W.j.info("backChannelRequestTimeoutMs_="+ne)),ne=W;const qs=b.g;if(qs){const ml=qs.g?qs.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(ml){var ze=ne.h;ze.g||ml.indexOf("spdy")==-1&&ml.indexOf("quic")==-1&&ml.indexOf("h2")==-1||(ze.j=ze.l,ze.g=new Set,ze.h&&(Qe(ze,ze.h),ze.h=null))}if(ne.G){const Zc=qs.g?qs.g.getResponseHeader("X-HTTP-Session-Id"):null;Zc&&(ne.wa=Zc,Zt(ne.J,ne.G,Zc))}}W.I=3,W.l&&W.l.ra(),W.aa&&(W.T=Date.now()-b.F,W.j.info("Handshake RTT: "+W.T+"ms")),ne=W;var Ot=b;if(ne.na=If(ne,ne.L?ne.ba:null,ne.W),Ot.L){yt(ne.h,Ot);var Cn=Ot,sr=ne.O;sr&&(Cn.H=sr),Cn.D&&(Rt(Cn),mt(Cn)),ne.g=Ot}else Zu(ne);W.i.length>0&&ao(W)}else ei[0]!="stop"&&ei[0]!="close"||Da(W,7);else W.I==3&&(ei[0]=="stop"||ei[0]=="close"?ei[0]=="stop"?Da(W,7):Ku(W):ei[0]!="noop"&&W.l&&W.l.qa(ei),W.A=0)}}Ce(4)}catch{}}var J=class{constructor(b,U){this.g=b,this.map=U}};function le(b){this.l=b||10,o.PerformanceNavigationTiming?(b=o.performance.getEntriesByType("navigation"),b=b.length>0&&(b[0].nextHopProtocol=="hq"||b[0].nextHopProtocol=="h2")):b=!!(o.chrome&&o.chrome.loadTimes&&o.chrome.loadTimes()&&o.chrome.loadTimes().wasFetchedViaSpdy),this.j=b?this.l:1,this.g=null,this.j>1&&(this.g=new Set),this.h=null,this.i=[]}function ye(b){return b.h?!0:b.g?b.g.size>=b.j:!1}function xe(b){return b.h?1:b.g?b.g.size:0}function me(b,U){return b.h?b.h==U:b.g?b.g.has(U):!1}function Qe(b,U){b.g?b.g.add(U):b.h=U}function yt(b,U){b.h&&b.h==U?b.h=null:b.g&&b.g.has(U)&&b.g.delete(U)}le.prototype.cancel=function(){if(this.i=Ze(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const b of this.g.values())b.cancel();this.g.clear()}};function Ze(b){if(b.h!=null)return b.i.concat(b.h.G);if(b.g!=null&&b.g.size!==0){let U=b.i;for(const W of b.g.values())U=U.concat(W.G);return U}return x(b.i)}var Pt=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function It(b,U){if(b){b=b.split("&");for(let W=0;W<b.length;W++){const ne=b[W].indexOf("=");let Ee,ze=null;ne>=0?(Ee=b[W].substring(0,ne),ze=b[W].substring(ne+1)):Ee=b[W],U(Ee,ze?decodeURIComponent(ze.replace(/\+/g," ")):"")}}}function jt(b){this.g=this.o=this.j="",this.u=null,this.m=this.h="",this.l=!1;let U;b instanceof jt?(this.l=b.l,Vt(this,b.j),this.o=b.o,this.g=b.g,_n(this,b.u),this.h=b.h,Kn(this,wf(b.i)),this.m=b.m):b&&(U=String(b).match(Pt))?(this.l=!1,Vt(this,U[1]||"",!0),this.o=St(U[2]||""),this.g=St(U[3]||"",!0),_n(this,U[4]),this.h=St(U[5]||"",!0),Kn(this,U[6]||"",!0),this.m=St(U[7]||"")):(this.l=!1,this.i=new Ui(null,this.l))}jt.prototype.toString=function(){const b=[];var U=this.j;U&&b.push(en(U,Qn,!0),":");var W=this.g;return(W||U=="file")&&(b.push("//"),(U=this.o)&&b.push(en(U,Qn,!0),"@"),b.push(fr(W).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),W=this.u,W!=null&&b.push(":",String(W))),(W=this.h)&&(this.g&&W.charAt(0)!="/"&&b.push("/"),b.push(en(W,W.charAt(0)=="/"?Ln:dr,!0))),(W=this.i.toString())&&b.push("?",W),(W=this.m)&&b.push("#",en(W,ui)),b.join("")},jt.prototype.resolve=function(b){const U=At(this);let W=!!b.j;W?Vt(U,b.j):W=!!b.o,W?U.o=b.o:W=!!b.g,W?U.g=b.g:W=b.u!=null;var ne=b.h;if(W)_n(U,b.u);else if(W=!!b.h){if(ne.charAt(0)!="/")if(this.g&&!this.h)ne="/"+ne;else{var Ee=U.h.lastIndexOf("/");Ee!=-1&&(ne=U.h.slice(0,Ee+1)+ne)}if(Ee=ne,Ee==".."||Ee==".")ne="";else if(Ee.indexOf("./")!=-1||Ee.indexOf("/.")!=-1){ne=Ee.lastIndexOf("/",0)==0,Ee=Ee.split("/");const ze=[];for(let Ot=0;Ot<Ee.length;){const Cn=Ee[Ot++];Cn=="."?ne&&Ot==Ee.length&&ze.push(""):Cn==".."?((ze.length>1||ze.length==1&&ze[0]!="")&&ze.pop(),ne&&Ot==Ee.length&&ze.push("")):(ze.push(Cn),ne=!0)}ne=ze.join("/")}else ne=Ee}return W?U.h=ne:W=b.i.toString()!=="",W?Kn(U,wf(b.i)):W=!!b.m,W&&(U.m=b.m),U};function At(b){return new jt(b)}function Vt(b,U,W){b.j=W?St(U,!0):U,b.j&&(b.j=b.j.replace(/:$/,""))}function _n(b,U){if(U){if(U=Number(U),isNaN(U)||U<0)throw Error("Bad port number "+U);b.u=U}else b.u=null}function Kn(b,U,W){U instanceof Ui?(b.i=U,qc(b.i,b.l)):(W||(U=en(U,Di)),b.i=new Ui(U,b.l))}function Zt(b,U,W){b.i.set(U,W)}function zt(b){return Zt(b,"zx",Math.floor(Math.random()*2147483648).toString(36)+Math.abs(Math.floor(Math.random()*2147483648)^Date.now()).toString(36)),b}function St(b,U){return b?U?decodeURI(b.replace(/%25/g,"%2525")):decodeURIComponent(b):""}function en(b,U,W){return typeof b=="string"?(b=encodeURI(b).replace(U,kt),W&&(b=b.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),b):null}function kt(b){return b=b.charCodeAt(0),"%"+(b>>4&15).toString(16)+(b&15).toString(16)}var Qn=/[#\/\?@]/g,dr=/[#\?:]/g,Ln=/[#\?]/g,Di=/[#\?@]/g,ui=/#/g;function Ui(b,U){this.h=this.g=null,this.i=b||null,this.j=!!U}function Ei(b){b.g||(b.g=new Map,b.h=0,b.i&&It(b.i,function(U,W){b.add(decodeURIComponent(U.replace(/\+/g," ")),W)}))}i=Ui.prototype,i.add=function(b,U){Ei(this),this.i=null,b=Mo(this,b);let W=this.g.get(b);return W||this.g.set(b,W=[]),W.push(U),this.h+=1,this};function pr(b,U){Ei(b),U=Mo(b,U),b.g.has(U)&&(b.i=null,b.h-=b.g.get(U).length,b.g.delete(U))}function mr(b,U){return Ei(b),U=Mo(b,U),b.g.has(U)}i.forEach=function(b,U){Ei(this),this.g.forEach(function(W,ne){W.forEach(function(Ee){b.call(U,Ee,ne,this)},this)},this)};function To(b,U){Ei(b);let W=[];if(typeof U=="string")mr(b,U)&&(W=W.concat(b.g.get(Mo(b,U))));else for(b=Array.from(b.g.values()),U=0;U<b.length;U++)W=W.concat(b[U]);return W}i.set=function(b,U){return Ei(this),this.i=null,b=Mo(this,b),mr(this,b)&&(this.h-=this.g.get(b).length),this.g.set(b,[U]),this.h+=1,this},i.get=function(b,U){return b?(b=To(this,b),b.length>0?String(b[0]):U):U};function Ts(b,U,W){pr(b,U),W.length>0&&(b.i=null,b.g.set(Mo(b,U),x(W)),b.h+=W.length)}i.toString=function(){if(this.i)return this.i;if(!this.g)return"";const b=[],U=Array.from(this.g.keys());for(let ne=0;ne<U.length;ne++){var W=U[ne];const Ee=fr(W);W=To(this,W);for(let ze=0;ze<W.length;ze++){let Ot=Ee;W[ze]!==""&&(Ot+="="+fr(W[ze])),b.push(Ot)}}return this.i=b.join("&")};function wf(b){const U=new Ui;return U.i=b.i,b.g&&(U.g=new Map(b.g),U.h=b.h),U}function Mo(b,U){return U=String(U),b.j&&(U=U.toLowerCase()),U}function qc(b,U){U&&!b.j&&(Ei(b),b.i=null,b.g.forEach(function(W,ne){const Ee=ne.toLowerCase();ne!=Ee&&(pr(this,ne),Ts(this,Ee,W))},b)),b.j=U}function no(b,U){const W=new pt;if(o.Image){const ne=new Image;ne.onload=g(da,W,"TestLoadImage: loaded",!0,U,ne),ne.onerror=g(da,W,"TestLoadImage: error",!1,U,ne),ne.onabort=g(da,W,"TestLoadImage: abort",!1,U,ne),ne.ontimeout=g(da,W,"TestLoadImage: timeout",!1,U,ne),o.setTimeout(function(){ne.ontimeout&&ne.ontimeout()},1e4),ne.src=b}else U(!1)}function Yu(b,U){const W=new pt,ne=new AbortController,Ee=setTimeout(()=>{ne.abort(),da(W,"TestPingServer: timeout",!1,U)},1e4);fetch(b,{signal:ne.signal}).then(ze=>{clearTimeout(Ee),ze.ok?da(W,"TestPingServer: ok",!0,U):da(W,"TestPingServer: server error",!1,U)}).catch(()=>{clearTimeout(Ee),da(W,"TestPingServer: error",!1,U)})}function da(b,U,W,ne,Ee){try{Ee&&(Ee.onload=null,Ee.onerror=null,Ee.onabort=null,Ee.ontimeout=null),ne(W)}catch{}}function hl(){this.g=new Ct}function Ra(b){this.i=b.Sb||null,this.h=b.ab||!1}v(Ra,Xt),Ra.prototype.g=function(){return new Kl(this.i,this.h)};function Kl(b,U){Lt.call(this),this.H=b,this.o=U,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.A=new Headers,this.h=null,this.F="GET",this.D="",this.g=!1,this.B=this.j=this.l=null,this.v=new AbortController}v(Kl,Lt),i=Kl.prototype,i.open=function(b,U){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.F=b,this.D=U,this.readyState=1,Ia(this)},i.send=function(b){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");if(this.v.signal.aborted)throw this.abort(),Error("Request was aborted.");this.g=!0;const U={headers:this.A,method:this.F,credentials:this.m,cache:void 0,signal:this.v.signal};b&&(U.body=b),(this.H||o).fetch(new Request(this.D,U)).then(this.Pa.bind(this),this.ga.bind(this))},i.abort=function(){this.response=this.responseText="",this.A=new Headers,this.status=0,this.v.abort(),this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),this.readyState>=1&&this.g&&this.readyState!=4&&(this.g=!1,fl(this)),this.readyState=0},i.Pa=function(b){if(this.g&&(this.l=b,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=b.headers,this.readyState=2,Ia(this)),this.g&&(this.readyState=3,Ia(this),this.g)))if(this.responseType==="arraybuffer")b.arrayBuffer().then(this.Na.bind(this),this.ga.bind(this));else if(typeof o.ReadableStream<"u"&&"body"in b){if(this.j=b.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.B=new TextDecoder;Xc(this)}else b.text().then(this.Oa.bind(this),this.ga.bind(this))};function Xc(b){b.j.read().then(b.Ma.bind(b)).catch(b.ga.bind(b))}i.Ma=function(b){if(this.g){if(this.o&&b.value)this.response.push(b.value);else if(!this.o){var U=b.value?b.value:new Uint8Array(0);(U=this.B.decode(U,{stream:!b.done}))&&(this.response=this.responseText+=U)}b.done?fl(this):Ia(this),this.readyState==3&&Xc(this)}},i.Oa=function(b){this.g&&(this.response=this.responseText=b,fl(this))},i.Na=function(b){this.g&&(this.response=b,fl(this))},i.ga=function(){this.g&&fl(this)};function fl(b){b.readyState=4,b.l=null,b.j=null,b.B=null,Ia(b)}i.setRequestHeader=function(b,U){this.A.append(b,U)},i.getResponseHeader=function(b){return this.h&&this.h.get(b.toLowerCase())||""},i.getAllResponseHeaders=function(){if(!this.h)return"";const b=[],U=this.h.entries();for(var W=U.next();!W.done;)W=W.value,b.push(W[0]+": "+W[1]),W=U.next();return b.join(`\r
`)};function Ia(b){b.onreadystatechange&&b.onreadystatechange.call(b)}Object.defineProperty(Kl.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(b){this.m=b?"include":"same-origin"}});function pa(b){let U="";return Pe(b,function(W,ne){U+=ne,U+=":",U+=W,U+=`\r
`}),U}function Yc(b,U,W){e:{for(ne in W){var ne=!1;break e}ne=!0}ne||(W=pa(W),typeof b=="string"?W!=null&&fr(W):Zt(b,U,W))}function _i(b){Lt.call(this),this.headers=new Map,this.L=b||null,this.h=!1,this.g=null,this.D="",this.o=0,this.l="",this.j=this.B=this.v=this.A=!1,this.m=null,this.F="",this.H=!1}v(_i,Lt);var Ms=/^https?$/i,Ju=["POST","PUT"];i=_i.prototype,i.Fa=function(b){this.H=b},i.ea=function(b,U,W,ne){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+b);U=U?U.toUpperCase():"GET",this.D=b,this.l="",this.o=0,this.A=!1,this.h=!0,this.g=this.L?this.L.g():Ss.g(),this.g.onreadystatechange=_(p(this.Ca,this));try{this.B=!0,this.g.open(U,String(b),!0),this.B=!1}catch(ze){wo(this,ze);return}if(b=W||"",W=new Map(this.headers),ne)if(Object.getPrototypeOf(ne)===Object.prototype)for(var Ee in ne)W.set(Ee,ne[Ee]);else if(typeof ne.keys=="function"&&typeof ne.get=="function")for(const ze of ne.keys())W.set(ze,ne.get(ze));else throw Error("Unknown input type for opt_headers: "+String(ne));ne=Array.from(W.keys()).find(ze=>ze.toLowerCase()=="content-type"),Ee=o.FormData&&b instanceof o.FormData,!(Array.prototype.indexOf.call(Ju,U,void 0)>=0)||ne||Ee||W.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[ze,Ot]of W)this.g.setRequestHeader(ze,Ot);this.F&&(this.g.responseType=this.F),"withCredentials"in this.g&&this.g.withCredentials!==this.H&&(this.g.withCredentials=this.H);try{this.m&&(clearTimeout(this.m),this.m=null),this.v=!0,this.g.send(b),this.v=!1}catch(ze){wo(this,ze)}};function wo(b,U){b.h=!1,b.g&&(b.j=!0,b.g.abort(),b.j=!1),b.l=U,b.o=5,Ql(b),io(b)}function Ql(b){b.A||(b.A=!0,vt(b,"complete"),vt(b,"error"))}i.abort=function(b){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.o=b||7,vt(this,"complete"),vt(this,"abort"),io(this))},i.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),io(this,!0)),_i.Z.N.call(this)},i.Ca=function(){this.u||(this.B||this.v||this.j?Zl(this):this.Xa())},i.Xa=function(){Zl(this)};function Zl(b){if(b.h&&typeof s<"u"){if(b.v&&ro(b)==4)setTimeout(b.Ca.bind(b),0);else if(vt(b,"readystatechange"),ro(b)==4){b.h=!1;try{const ze=b.ca();e:switch(ze){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var U=!0;break e;default:U=!1}var W;if(!(W=U)){var ne;if(ne=ze===0){let Ot=String(b.D).match(Pt)[1]||null;!Ot&&o.self&&o.self.location&&(Ot=o.self.location.protocol.slice(0,-1)),ne=!Ms.test(Ot?Ot.toLowerCase():"")}W=ne}if(W)vt(b,"complete"),vt(b,"success");else{b.o=6;try{var Ee=ro(b)>2?b.g.statusText:""}catch{Ee=""}b.l=Ee+" ["+b.ca()+"]",Ql(b)}}finally{io(b)}}}}function io(b,U){if(b.g){b.m&&(clearTimeout(b.m),b.m=null);const W=b.g;b.g=null,U||vt(b,"ready");try{W.onreadystatechange=null}catch{}}}i.isActive=function(){return!!this.g};function ro(b){return b.g?b.g.readyState:0}i.ca=function(){try{return ro(this)>2?this.g.status:-1}catch{return-1}},i.la=function(){try{return this.g?this.g.responseText:""}catch{return""}},i.La=function(b){if(this.g){var U=this.g.responseText;return b&&U.indexOf(b)==0&&(U=U.substring(b.length)),Ft(U)}};function Wr(b){try{if(!b.g)return null;if("response"in b.g)return b.g.response;switch(b.F){case"":case"text":return b.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in b.g)return b.g.mozResponseArrayBuffer}return null}catch{return null}}function Co(b){const U={};b=(b.g&&ro(b)>=2&&b.g.getAllResponseHeaders()||"").split(`\r
`);for(let ne=0;ne<b.length;ne++){if(j(b[ne]))continue;var W=Es(b[ne]);const Ee=W[0];if(W=W[1],typeof W!="string")continue;W=W.trim();const ze=U[Ee]||[];U[Ee]=ze,ze.push(W)}Re(U,function(ne){return ne.join(", ")})}i.ya=function(){return this.o},i.Ha=function(){return typeof this.l=="string"?this.l:String(this.l)};function so(b,U,W){return W&&W.internalChannelParams&&W.internalChannelParams[b]||U}function dl(b){this.za=0,this.i=[],this.j=new pt,this.ba=this.na=this.J=this.W=this.g=this.wa=this.G=this.H=this.u=this.U=this.o=null,this.Ya=this.V=0,this.Sa=so("failFast",!1,b),this.F=this.C=this.v=this.m=this.l=null,this.X=!0,this.xa=this.K=-1,this.Y=this.A=this.D=0,this.Qa=so("baseRetryDelayMs",5e3,b),this.Za=so("retryDelaySeedMs",1e4,b),this.Ta=so("forwardChannelMaxRetries",2,b),this.va=so("forwardChannelRequestTimeoutMs",2e4,b),this.ma=b&&b.xmlHttpFactory||void 0,this.Ua=b&&b.Rb||void 0,this.Aa=b&&b.useFetchStreams||!1,this.O=void 0,this.L=b&&b.supportsCrossDomainXhr||!1,this.M="",this.h=new le(b&&b.concurrentRequestLimit),this.Ba=new hl,this.S=b&&b.fastHandshake||!1,this.R=b&&b.encodeInitMessageHeaders||!1,this.S&&this.R&&(this.R=!1),this.Ra=b&&b.Pb||!1,b&&b.ua&&this.j.ua(),b&&b.forceLongPolling&&(this.X=!1),this.aa=!this.S&&this.X&&b&&b.detectBufferingProxy||!1,this.ia=void 0,b&&b.longPollingTimeout&&b.longPollingTimeout>0&&(this.ia=b.longPollingTimeout),this.ta=void 0,this.T=0,this.P=!1,this.ja=this.B=null}i=dl.prototype,i.ka=8,i.I=1,i.connect=function(b,U,W,ne){gt(0),this.W=b,this.H=U||{},W&&ne!==void 0&&(this.H.OSID=W,this.H.OAID=ne),this.F=this.X,this.J=If(this,null,this.W),ao(this)};function Ku(b){if(Jc(b),b.I==3){var U=b.V++,W=At(b.J);if(Zt(W,"SID",b.M),Zt(W,"RID",U),Zt(W,"TYPE","terminate"),ec(b,W),U=new sn(b,b.j,U),U.M=2,U.A=zt(At(W)),W=!1,o.navigator&&o.navigator.sendBeacon)try{W=o.navigator.sendBeacon(U.A.toString(),"")}catch{}!W&&o.Image&&(new Image().src=U.A,W=!0),W||(U.g=Df(U.j,null),U.g.ea(U.A)),U.F=Date.now(),mt(U)}Kc(b)}function Ro(b){b.g&&($u(b),b.g.cancel(),b.g=null)}function Jc(b){Ro(b),b.v&&(o.clearTimeout(b.v),b.v=null),eh(b),b.h.cancel(),b.m&&(typeof b.m=="number"&&o.clearTimeout(b.m),b.m=null)}function ao(b){if(!ye(b.h)&&!b.m){b.m=!0;var U=b.Ea;G||D(),k||(G(),k=!0),O.add(U,b),b.D=0}}function $l(b,U){return xe(b.h)>=b.h.j-(b.m?1:0)?!1:b.m?(b.i=U.G.concat(b.i),!0):b.I==1||b.I==2||b.D>=(b.Sa?0:b.Ta)?!1:(b.m=Ye(p(b.Ea,b,U),nc(b,b.D)),b.D++,!0)}i.Ea=function(b){if(this.m)if(this.m=null,this.I==1){if(!b){this.V=Math.floor(Math.random()*1e5),b=this.V++;const Ee=new sn(this,this.j,b);let ze=this.o;if(this.U&&(ze?(ze=$(ze),Se(ze,this.U)):ze=this.U),this.u!==null||this.R||(Ee.J=ze,ze=null),this.S)e:{for(var U=0,W=0;W<this.i.length;W++){t:{var ne=this.i[W];if("__data__"in ne.map&&(ne=ne.map.__data__,typeof ne=="string")){ne=ne.length;break t}ne=void 0}if(ne===void 0)break;if(U+=ne,U>4096){U=W;break e}if(U===4096||W===this.i.length-1){U=W+1;break e}}U=1e3}else U=1e3;U=Cf(this,Ee,U),W=At(this.J),Zt(W,"RID",b),Zt(W,"CVER",22),this.G&&Zt(W,"X-HTTP-Session-Id",this.G),ec(this,W),ze&&(this.R?U="headers="+fr(pa(ze))+"&"+U:this.u&&Yc(W,this.u,ze)),Qe(this.h,Ee),this.Ra&&Zt(W,"TYPE","init"),this.S?(Zt(W,"$req",U),Zt(W,"SID","null"),Ee.U=!0,Z(Ee,W,null)):Z(Ee,W,U),this.I=2}}else this.I==3&&(b?Qu(this,b):this.i.length==0||ye(this.h)||Qu(this))};function Qu(b,U){var W;U?W=U.l:W=b.V++;const ne=At(b.J);Zt(ne,"SID",b.M),Zt(ne,"RID",W),Zt(ne,"AID",b.K),ec(b,ne),b.u&&b.o&&Yc(ne,b.u,b.o),W=new sn(b,b.j,W,b.D+1),b.u===null&&(W.J=b.o),U&&(b.i=U.G.concat(b.i)),U=Cf(b,W,1e3),W.H=Math.round(b.va*.5)+Math.round(b.va*.5*Math.random()),Qe(b.h,W),Z(W,ne,U)}function ec(b,U){b.H&&Pe(b.H,function(W,ne){Zt(U,ne,W)}),b.l&&Pe({},function(W,ne){Zt(U,ne,W)})}function Cf(b,U,W){W=Math.min(b.i.length,W);const ne=b.l?p(b.l.Ka,b.l,b):null;e:{var Ee=b.i;let Cn=-1;for(;;){const sr=["count="+W];Cn==-1?W>0?(Cn=Ee[0].g,sr.push("ofs="+Cn)):Cn=0:sr.push("ofs="+Cn);let ei=!0;for(let Fi=0;Fi<W;Fi++){var ze=Ee[Fi].g;const ws=Ee[Fi].map;if(ze-=Cn,ze<0)Cn=Math.max(0,Ee[Fi].g-100),ei=!1;else try{ze="req"+ze+"_"||"";try{var Ot=ws instanceof Map?ws:Object.entries(ws);for(const[oo,lo]of Ot){let qs=lo;u(lo)&&(qs=Ue(lo)),sr.push(ze+oo+"="+encodeURIComponent(qs))}}catch(oo){throw sr.push(ze+"type="+encodeURIComponent("_badmap")),oo}}catch{ne&&ne(ws)}}if(ei){Ot=sr.join("&");break e}}Ot=void 0}return b=b.i.splice(0,W),U.G=b,Ot}function Zu(b){if(!b.g&&!b.v){b.Y=1;var U=b.Da;G||D(),k||(G(),k=!0),O.add(U,b),b.A=0}}function tc(b){return b.g||b.v||b.A>=3?!1:(b.Y++,b.v=Ye(p(b.Da,b),nc(b,b.A)),b.A++,!0)}i.Da=function(){if(this.v=null,mp(this),this.aa&&!(this.P||this.g==null||this.T<=0)){var b=4*this.T;this.j.info("BP detection timer enabled: "+b),this.B=Ye(p(this.Wa,this),b)}},i.Wa=function(){this.B&&(this.B=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.P=!0,gt(10),Ro(this),mp(this))};function $u(b){b.B!=null&&(o.clearTimeout(b.B),b.B=null)}function mp(b){b.g=new sn(b,b.j,"rpc",b.Y),b.u===null&&(b.g.J=b.o),b.g.P=0;var U=At(b.na);Zt(U,"RID","rpc"),Zt(U,"SID",b.M),Zt(U,"AID",b.K),Zt(U,"CI",b.F?"0":"1"),!b.F&&b.ia&&Zt(U,"TO",b.ia),Zt(U,"TYPE","xmlhttp"),ec(b,U),b.u&&b.o&&Yc(U,b.u,b.o),b.O&&(b.g.H=b.O);var W=b.g;b=b.ba,W.M=1,W.A=zt(At(U)),W.u=null,W.R=!0,he(W,b)}i.Va=function(){this.C!=null&&(this.C=null,Ro(this),tc(this),gt(19))};function eh(b){b.C!=null&&(o.clearTimeout(b.C),b.C=null)}function Rf(b,U){var W=null;if(b.g==U){eh(b),$u(b),b.g=null;var ne=2}else if(me(b.h,U))W=U.G,yt(b.h,U),ne=1;else return;if(b.I!=0){if(U.o)if(ne==1){W=U.u?U.u.length:0,U=Date.now()-U.F;var Ee=b.D;ne=ot(),vt(ne,new ut(ne,W)),ao(b)}else Zu(b);else if(Ee=U.m,Ee==3||Ee==0&&U.X>0||!(ne==1&&$l(b,U)||ne==2&&tc(b)))switch(W&&W.length>0&&(U=b.h,U.i=U.i.concat(W)),Ee){case 1:Da(b,5);break;case 4:Da(b,10);break;case 3:Da(b,6);break;default:Da(b,2)}}}function nc(b,U){let W=b.Qa+Math.floor(Math.random()*b.Za);return b.isActive()||(W*=2),W*U}function Da(b,U){if(b.j.info("Error code "+U),U==2){var W=p(b.bb,b),ne=b.Ua;const Ee=!ne;ne=new jt(ne||"//www.google.com/images/cleardot.gif"),o.location&&o.location.protocol=="http"||Vt(ne,"https"),zt(ne),Ee?no(ne.toString(),W):Yu(ne.toString(),W)}else gt(2);b.I=0,b.l&&b.l.pa(U),Kc(b),Jc(b)}i.bb=function(b){b?(this.j.info("Successfully pinged google.com"),gt(2)):(this.j.info("Failed to ping google.com"),gt(1))};function Kc(b){if(b.I=0,b.ja=[],b.l){const U=Ze(b.h);(U.length!=0||b.i.length!=0)&&(E(b.ja,U),E(b.ja,b.i),b.h.i.length=0,x(b.i),b.i.length=0),b.l.oa()}}function If(b,U,W){var ne=W instanceof jt?At(W):new jt(W);if(ne.g!="")U&&(ne.g=U+"."+ne.g),_n(ne,ne.u);else{var Ee=o.location;ne=Ee.protocol,U=U?U+"."+Ee.hostname:Ee.hostname,Ee=+Ee.port;const ze=new jt(null);ne&&Vt(ze,ne),U&&(ze.g=U),Ee&&_n(ze,Ee),W&&(ze.h=W),ne=ze}return W=b.G,U=b.wa,W&&U&&Zt(ne,W,U),Zt(ne,"VER",b.ka),ec(b,ne),ne}function Df(b,U,W){if(U&&!b.L)throw Error("Can't create secondary domain capable XhrIo object.");return U=b.Aa&&!b.ma?new _i(new Ra({ab:W})):new _i(b.ma),U.Fa(b.L),U}i.isActive=function(){return!!this.l&&this.l.isActive(this)};function th(){}i=th.prototype,i.ra=function(){},i.qa=function(){},i.pa=function(){},i.oa=function(){},i.isActive=function(){return!0},i.Ka=function(){};function pl(){}pl.prototype.g=function(b,U){return new us(b,U)};function us(b,U){Lt.call(this),this.g=new dl(U),this.l=b,this.h=U&&U.messageUrlParams||null,b=U&&U.messageHeaders||null,U&&U.clientProtocolHeaderRequired&&(b?b["X-Client-Protocol"]="webchannel":b={"X-Client-Protocol":"webchannel"}),this.g.o=b,b=U&&U.initMessageHeaders||null,U&&U.messageContentType&&(b?b["X-WebChannel-Content-Type"]=U.messageContentType:b={"X-WebChannel-Content-Type":U.messageContentType}),U&&U.sa&&(b?b["X-WebChannel-Client-Profile"]=U.sa:b={"X-WebChannel-Client-Profile":U.sa}),this.g.U=b,(b=U&&U.Qb)&&!j(b)&&(this.g.u=b),this.A=U&&U.supportsCrossDomainXhr||!1,this.v=U&&U.sendRawJson||!1,(U=U&&U.httpSessionIdParam)&&!j(U)&&(this.g.G=U,b=this.h,b!==null&&U in b&&(b=this.h,U in b&&delete b[U])),this.j=new Do(this)}v(us,Lt),us.prototype.m=function(){this.g.l=this.j,this.A&&(this.g.L=!0),this.g.connect(this.l,this.h||void 0)},us.prototype.close=function(){Ku(this.g)},us.prototype.o=function(b){var U=this.g;if(typeof b=="string"){var W={};W.__data__=b,b=W}else this.v&&(W={},W.__data__=Ue(b),b=W);U.i.push(new J(U.Ya++,b)),U.I==3&&ao(U)},us.prototype.N=function(){this.g.l=null,delete this.j,Ku(this.g),delete this.g,us.Z.N.call(this)};function Io(b){it.call(this),b.__headers__&&(this.headers=b.__headers__,this.statusCode=b.__status__,delete b.__headers__,delete b.__status__);var U=b.__sm__;if(U){e:{for(const W in U){b=W;break e}b=void 0}(this.i=b)&&(b=this.i,U=U!==null&&b in U?U[b]:void 0),this.data=U}else this.data=b}v(Io,it);function Qc(){Ut.call(this),this.status=1}v(Qc,Ut);function Do(b){this.g=b}v(Do,th),Do.prototype.ra=function(){vt(this.g,"a")},Do.prototype.qa=function(b){vt(this.g,new Io(b))},Do.prototype.pa=function(b){vt(this.g,new Qc)},Do.prototype.oa=function(){vt(this.g,"b")},pl.prototype.createWebChannel=pl.prototype.g,us.prototype.send=us.prototype.o,us.prototype.open=us.prototype.m,us.prototype.close=us.prototype.close,C3=function(){return new pl},w3=function(){return ot()},M3=oe,iT={jb:0,mb:1,nb:2,Hb:3,Mb:4,Jb:5,Kb:6,Ib:7,Gb:8,Lb:9,PROXY:10,NOPROXY:11,Eb:12,Ab:13,Bb:14,zb:15,Cb:16,Db:17,fb:18,eb:19,gb:20},As.NO_ERROR=0,As.TIMEOUT=8,As.HTTP_ERROR=6,ab=As,fa.COMPLETE="complete",T3=fa,an.EventType=tt,tt.OPEN="a",tt.CLOSE="b",tt.ERROR="c",tt.MESSAGE="d",Lt.prototype.listen=Lt.prototype.J,fv=an,_i.prototype.listenOnce=_i.prototype.K,_i.prototype.getLastError=_i.prototype.Ha,_i.prototype.getLastErrorCode=_i.prototype.ya,_i.prototype.getStatus=_i.prototype.ca,_i.prototype.getResponseJson=_i.prototype.La,_i.prototype.getResponseText=_i.prototype.la,_i.prototype.send=_i.prototype.ea,_i.prototype.setWithCredentials=_i.prototype.Fa,E3=_i}).apply(typeof ex<"u"?ex:typeof self<"u"?self:typeof window<"u"?window:{});/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let la=class{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}};la.UNAUTHENTICATED=new la(null),la.GOOGLE_CREDENTIALS=new la("google-credentials-uid"),la.FIRST_PARTY=new la("first-party-uid"),la.MOCK_USER=new la("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let bg="12.8.0";function vz(i){bg=i}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Yd=new QT("@firebase/firestore");function Bm(){return Yd.logLevel}function $t(i,...e){if(Yd.logLevel<=ai.DEBUG){const t=e.map(uM);Yd.debug(`Firestore (${bg}): ${i}`,...t)}}function Hu(i,...e){if(Yd.logLevel<=ai.ERROR){const t=e.map(uM);Yd.error(`Firestore (${bg}): ${i}`,...t)}}function Zm(i,...e){if(Yd.logLevel<=ai.WARN){const t=e.map(uM);Yd.warn(`Firestore (${bg}): ${i}`,...t)}}function uM(i){if(typeof i=="string")return i;try{return(function(t){return JSON.stringify(t)})(i)}catch{return i}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Sn(i,e,t){let n="Unexpected state";typeof e=="string"?n=e:t=e,R3(i,n,t)}function R3(i,e,t){let n=`FIRESTORE (${bg}) INTERNAL ASSERTION FAILED: ${e} (ID: ${i.toString(16)})`;if(t!==void 0)try{n+=" CONTEXT: "+JSON.stringify(t)}catch{n+=" CONTEXT: "+t}throw Hu(n),new Error(n)}function Ri(i,e,t,n){let r="Unexpected state";typeof t=="string"?r=t:n=t,i||R3(e,r,n)}function Bn(i,e){return i}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const nt={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class Kt extends qu{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Uu{constructor(){this.promise=new Promise(((e,t)=>{this.resolve=e,this.reject=t}))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class I3{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class yz{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable((()=>t(la.UNAUTHENTICATED)))}shutdown(){}}class _z{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable((()=>t(this.token.user)))}shutdown(){this.changeListener=null}}class xz{constructor(e){this.t=e,this.currentUser=la.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){Ri(this.o===void 0,42304);let n=this.i;const r=f=>this.i!==n?(n=this.i,t(f)):Promise.resolve();let s=new Uu;this.o=()=>{this.i++,this.currentUser=this.u(),s.resolve(),s=new Uu,e.enqueueRetryable((()=>r(this.currentUser)))};const o=()=>{const f=s;e.enqueueRetryable((async()=>{await f.promise,await r(this.currentUser)}))},u=f=>{$t("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=f,this.o&&(this.auth.addAuthTokenListener(this.o),o())};this.t.onInit((f=>u(f))),setTimeout((()=>{if(!this.auth){const f=this.t.getImmediate({optional:!0});f?u(f):($t("FirebaseAuthCredentialsProvider","Auth not yet detected"),s.resolve(),s=new Uu)}}),0),o()}getToken(){const e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then((n=>this.i!==e?($t("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):n?(Ri(typeof n.accessToken=="string",31837,{l:n}),new I3(n.accessToken,this.currentUser)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return Ri(e===null||typeof e=="string",2055,{h:e}),new la(e)}}class bz{constructor(e,t,n){this.P=e,this.T=t,this.I=n,this.type="FirstParty",this.user=la.FIRST_PARTY,this.R=new Map}A(){return this.I?this.I():null}get headers(){this.R.set("X-Goog-AuthUser",this.P);const e=this.A();return e&&this.R.set("Authorization",e),this.T&&this.R.set("X-Goog-Iam-Authorization-Token",this.T),this.R}}class Az{constructor(e,t,n){this.P=e,this.T=t,this.I=n}getToken(){return Promise.resolve(new bz(this.P,this.T,this.I))}start(e,t){e.enqueueRetryable((()=>t(la.FIRST_PARTY)))}shutdown(){}invalidateToken(){}}class wR{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class Sz{constructor(e,t){this.V=t,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,Fl(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,t){Ri(this.o===void 0,3512);const n=s=>{s.error!=null&&$t("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${s.error.message}`);const o=s.token!==this.m;return this.m=s.token,$t("FirebaseAppCheckTokenProvider",`Received ${o?"new":"existing"} token.`),o?t(s.token):Promise.resolve()};this.o=s=>{e.enqueueRetryable((()=>n(s)))};const r=s=>{$t("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=s,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit((s=>r(s))),setTimeout((()=>{if(!this.appCheck){const s=this.V.getImmediate({optional:!0});s?r(s):$t("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}}),0)}getToken(){if(this.p)return Promise.resolve(new wR(this.p));const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then((t=>t?(Ri(typeof t.token=="string",44558,{tokenResult:t}),this.m=t.token,new wR(t.token)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ez(i){const e=typeof self<"u"&&(self.crypto||self.msCrypto),t=new Uint8Array(i);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(t);else for(let n=0;n<i;n++)t[n]=Math.floor(256*Math.random());return t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hM{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=62*Math.floor(4.129032258064516);let n="";for(;n.length<20;){const r=Ez(40);for(let s=0;s<r.length;++s)n.length<20&&r[s]<t&&(n+=e.charAt(r[s]%62))}return n}}function li(i,e){return i<e?-1:i>e?1:0}function rT(i,e){const t=Math.min(i.length,e.length);for(let n=0;n<t;n++){const r=i.charAt(n),s=e.charAt(n);if(r!==s)return OE(r)===OE(s)?li(r,s):OE(r)?1:-1}return li(i.length,e.length)}const Tz=55296,Mz=57343;function OE(i){const e=i.charCodeAt(0);return e>=Tz&&e<=Mz}function $m(i,e,t){return i.length===e.length&&i.every(((n,r)=>t(n,e[r])))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const CR="__name__";class Nc{constructor(e,t,n){t===void 0?t=0:t>e.length&&Sn(637,{offset:t,range:e.length}),n===void 0?n=e.length-t:n>e.length-t&&Sn(1746,{length:n,range:e.length-t}),this.segments=e,this.offset=t,this.len=n}get length(){return this.len}isEqual(e){return Nc.comparator(this,e)===0}child(e){const t=this.segments.slice(this.offset,this.limit());return e instanceof Nc?e.forEach((n=>{t.push(n)})):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,n=this.limit();t<n;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){const n=Math.min(e.length,t.length);for(let r=0;r<n;r++){const s=Nc.compareSegments(e.get(r),t.get(r));if(s!==0)return s}return li(e.length,t.length)}static compareSegments(e,t){const n=Nc.isNumericId(e),r=Nc.isNumericId(t);return n&&!r?-1:!n&&r?1:n&&r?Nc.extractNumericId(e).compare(Nc.extractNumericId(t)):rT(e,t)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return of.fromString(e.substring(4,e.length-2))}}class qi extends Nc{construct(e,t,n){return new qi(e,t,n)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const t=[];for(const n of e){if(n.indexOf("//")>=0)throw new Kt(nt.INVALID_ARGUMENT,`Invalid segment (${n}). Paths must not contain // in them.`);t.push(...n.split("/").filter((r=>r.length>0)))}return new qi(t)}static emptyPath(){return new qi([])}}const wz=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class ks extends Nc{construct(e,t,n){return new ks(e,t,n)}static isValidIdentifier(e){return wz.test(e)}canonicalString(){return this.toArray().map((e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),ks.isValidIdentifier(e)||(e="`"+e+"`"),e))).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===CR}static keyField(){return new ks([CR])}static fromServerFormat(e){const t=[];let n="",r=0;const s=()=>{if(n.length===0)throw new Kt(nt.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(n),n=""};let o=!1;for(;r<e.length;){const u=e[r];if(u==="\\"){if(r+1===e.length)throw new Kt(nt.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const f=e[r+1];if(f!=="\\"&&f!=="."&&f!=="`")throw new Kt(nt.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);n+=f,r+=2}else u==="`"?(o=!o,r++):u!=="."||o?(n+=u,r++):(s(),r++)}if(s(),o)throw new Kt(nt.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new ks(t)}static emptyPath(){return new ks([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dn{constructor(e){this.path=e}static fromPath(e){return new dn(qi.fromString(e))}static fromName(e){return new dn(qi.fromString(e).popFirst(5))}static empty(){return new dn(qi.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&qi.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,t){return qi.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new dn(new qi(e.slice()))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function D3(i,e,t){if(!t)throw new Kt(nt.INVALID_ARGUMENT,`Function ${i}() cannot be called with an empty ${e}.`)}function Cz(i,e,t,n){if(e===!0&&n===!0)throw new Kt(nt.INVALID_ARGUMENT,`${i} and ${t} cannot be used together.`)}function RR(i){if(!dn.isDocumentKey(i))throw new Kt(nt.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${i} has ${i.length}.`)}function IR(i){if(dn.isDocumentKey(i))throw new Kt(nt.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${i} has ${i.length}.`)}function N3(i){return typeof i=="object"&&i!==null&&(Object.getPrototypeOf(i)===Object.prototype||Object.getPrototypeOf(i)===null)}function VA(i){if(i===void 0)return"undefined";if(i===null)return"null";if(typeof i=="string")return i.length>20&&(i=`${i.substring(0,20)}...`),JSON.stringify(i);if(typeof i=="number"||typeof i=="boolean")return""+i;if(typeof i=="object"){if(i instanceof Array)return"an array";{const e=(function(n){return n.constructor?n.constructor.name:null})(i);return e?`a custom ${e} object`:"an object"}}return typeof i=="function"?"a function":Sn(12329,{type:typeof i})}function jl(i,e){if("_delegate"in i&&(i=i._delegate),!(i instanceof e)){if(e.name===i.constructor.name)throw new Kt(nt.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const t=VA(i);throw new Kt(nt.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${t}`)}}return i}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ts(i,e){const t={typeString:i};return e&&(t.value=e),t}function cy(i,e){if(!N3(i))throw new Kt(nt.INVALID_ARGUMENT,"JSON must be an object");let t;for(const n in e)if(e[n]){const r=e[n].typeString,s="value"in e[n]?{value:e[n].value}:void 0;if(!(n in i)){t=`JSON missing required field: '${n}'`;break}const o=i[n];if(r&&typeof o!==r){t=`JSON field '${n}' must be a ${r}.`;break}if(s!==void 0&&o!==s.value){t=`Expected '${n}' field to equal '${s.value}'`;break}}if(t)throw new Kt(nt.INVALID_ARGUMENT,t);return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const DR=-62135596800,NR=1e6;class tr{static now(){return tr.fromMillis(Date.now())}static fromDate(e){return tr.fromMillis(e.getTime())}static fromMillis(e){const t=Math.floor(e/1e3),n=Math.floor((e-1e3*t)*NR);return new tr(t,n)}constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new Kt(nt.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new Kt(nt.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<DR)throw new Kt(nt.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new Kt(nt.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/NR}_compareTo(e){return this.seconds===e.seconds?li(this.nanoseconds,e.nanoseconds):li(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:tr._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(e){if(cy(e,tr._jsonSchema))return new tr(e.seconds,e.nanoseconds)}valueOf(){const e=this.seconds-DR;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}tr._jsonSchemaVersion="firestore/timestamp/1.0",tr._jsonSchema={type:ts("string",tr._jsonSchemaVersion),seconds:ts("number"),nanoseconds:ts("number")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class In{static fromTimestamp(e){return new In(e)}static min(){return new In(new tr(0,0))}static max(){return new In(new tr(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Uv=-1;function Rz(i,e){const t=i.toTimestamp().seconds,n=i.toTimestamp().nanoseconds+1,r=In.fromTimestamp(n===1e9?new tr(t+1,0):new tr(t,n));return new hf(r,dn.empty(),e)}function Iz(i){return new hf(i.readTime,i.key,Uv)}class hf{constructor(e,t,n){this.readTime=e,this.documentKey=t,this.largestBatchId=n}static min(){return new hf(In.min(),dn.empty(),Uv)}static max(){return new hf(In.max(),dn.empty(),Uv)}}function Dz(i,e){let t=i.readTime.compareTo(e.readTime);return t!==0?t:(t=dn.comparator(i.documentKey,e.documentKey),t!==0?t:li(i.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Nz="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class Pz{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach((e=>e()))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Ag(i){if(i.code!==nt.FAILED_PRECONDITION||i.message!==Nz)throw i;$t("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ct{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e((t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)}),(t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)}))}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&Sn(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new ct(((n,r)=>{this.nextCallback=s=>{this.wrapSuccess(e,s).next(n,r)},this.catchCallback=s=>{this.wrapFailure(t,s).next(n,r)}}))}toPromise(){return new Promise(((e,t)=>{this.next(e,t)}))}wrapUserFunction(e){try{const t=e();return t instanceof ct?t:ct.resolve(t)}catch(t){return ct.reject(t)}}wrapSuccess(e,t){return e?this.wrapUserFunction((()=>e(t))):ct.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction((()=>e(t))):ct.reject(t)}static resolve(e){return new ct(((t,n)=>{t(e)}))}static reject(e){return new ct(((t,n)=>{n(e)}))}static waitFor(e){return new ct(((t,n)=>{let r=0,s=0,o=!1;e.forEach((u=>{++r,u.next((()=>{++s,o&&s===r&&t()}),(f=>n(f)))})),o=!0,s===r&&t()}))}static or(e){let t=ct.resolve(!1);for(const n of e)t=t.next((r=>r?ct.resolve(r):n()));return t}static forEach(e,t){const n=[];return e.forEach(((r,s)=>{n.push(t.call(this,r,s))})),this.waitFor(n)}static mapArray(e,t){return new ct(((n,r)=>{const s=e.length,o=new Array(s);let u=0;for(let f=0;f<s;f++){const p=f;t(e[p]).next((g=>{o[p]=g,++u,u===s&&n(o)}),(g=>r(g)))}}))}static doWhile(e,t){return new ct(((n,r)=>{const s=()=>{e()===!0?t().next((()=>{s()}),r):n()};s()}))}}function Bz(i){const e=i.match(/Android ([\d.]+)/i),t=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(t)}function Sg(i){return i.name==="IndexedDbTransactionError"}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class HA{constructor(e,t){this.previousValue=e,t&&(t.sequenceNumberHandler=n=>this.ae(n),this.ue=n=>t.writeSequenceNumber(n))}ae(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ue&&this.ue(e),e}}HA.ce=-1;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const fM=-1;function GA(i){return i==null}function Mb(i){return i===0&&1/i==-1/0}function Lz(i){return typeof i=="number"&&Number.isInteger(i)&&!Mb(i)&&i<=Number.MAX_SAFE_INTEGER&&i>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const P3="";function Oz(i){let e="";for(let t=0;t<i.length;t++)e.length>0&&(e=PR(e)),e=Uz(i.get(t),e);return PR(e)}function Uz(i,e){let t=e;const n=i.length;for(let r=0;r<n;r++){const s=i.charAt(r);switch(s){case"\0":t+="";break;case P3:t+="";break;default:t+=s}}return t}function PR(i){return i+P3+""}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function BR(i){let e=0;for(const t in i)Object.prototype.hasOwnProperty.call(i,t)&&e++;return e}function Af(i,e){for(const t in i)Object.prototype.hasOwnProperty.call(i,t)&&e(t,i[t])}function B3(i){for(const e in i)if(Object.prototype.hasOwnProperty.call(i,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Tr{constructor(e,t){this.comparator=e,this.root=t||Us.EMPTY}insert(e,t){return new Tr(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,Us.BLACK,null,null))}remove(e){return new Tr(this.comparator,this.root.remove(e,this.comparator).copy(null,null,Us.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){const n=this.comparator(e,t.key);if(n===0)return t.value;n<0?t=t.left:n>0&&(t=t.right)}return null}indexOf(e){let t=0,n=this.root;for(;!n.isEmpty();){const r=this.comparator(e,n.key);if(r===0)return t+n.left.size;r<0?n=n.left:(t+=n.left.size+1,n=n.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal(((t,n)=>(e(t,n),!1)))}toString(){const e=[];return this.inorderTraversal(((t,n)=>(e.push(`${t}:${n}`),!1))),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new tx(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new tx(this.root,e,this.comparator,!1)}getReverseIterator(){return new tx(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new tx(this.root,e,this.comparator,!0)}}class tx{constructor(e,t,n,r){this.isReverse=r,this.nodeStack=[];let s=1;for(;!e.isEmpty();)if(s=t?n(e.key,t):1,t&&r&&(s*=-1),s<0)e=this.isReverse?e.left:e.right;else{if(s===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class Us{constructor(e,t,n,r,s){this.key=e,this.value=t,this.color=n??Us.RED,this.left=r??Us.EMPTY,this.right=s??Us.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,n,r,s){return new Us(e??this.key,t??this.value,n??this.color,r??this.left,s??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,n){let r=this;const s=n(e,r.key);return r=s<0?r.copy(null,null,null,r.left.insert(e,t,n),null):s===0?r.copy(null,t,null,null,null):r.copy(null,null,null,null,r.right.insert(e,t,n)),r.fixUp()}removeMin(){if(this.left.isEmpty())return Us.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let n,r=this;if(t(e,r.key)<0)r.left.isEmpty()||r.left.isRed()||r.left.left.isRed()||(r=r.moveRedLeft()),r=r.copy(null,null,null,r.left.remove(e,t),null);else{if(r.left.isRed()&&(r=r.rotateRight()),r.right.isEmpty()||r.right.isRed()||r.right.left.isRed()||(r=r.moveRedRight()),t(e,r.key)===0){if(r.right.isEmpty())return Us.EMPTY;n=r.right.min(),r=r.copy(n.key,n.value,null,null,r.right.removeMin())}r=r.copy(null,null,null,null,r.right.remove(e,t))}return r.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,Us.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,Us.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw Sn(43730,{key:this.key,value:this.value});if(this.right.isRed())throw Sn(14113,{key:this.key,value:this.value});const e=this.left.check();if(e!==this.right.check())throw Sn(27949);return e+(this.isRed()?0:1)}}Us.EMPTY=null,Us.RED=!0,Us.BLACK=!1;Us.EMPTY=new class{constructor(){this.size=0}get key(){throw Sn(57766)}get value(){throw Sn(16141)}get color(){throw Sn(16727)}get left(){throw Sn(29726)}get right(){throw Sn(36894)}copy(e,t,n,r,s){return this}insert(e,t,n){return new Us(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class as{constructor(e){this.comparator=e,this.data=new Tr(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal(((t,n)=>(e(t),!1)))}forEachInRange(e,t){const n=this.data.getIteratorFrom(e[0]);for(;n.hasNext();){const r=n.getNext();if(this.comparator(r.key,e[1])>=0)return;t(r.key)}}forEachWhile(e,t){let n;for(n=t!==void 0?this.data.getIteratorFrom(t):this.data.getIterator();n.hasNext();)if(!e(n.getNext().key))return}firstAfterOrEqual(e){const t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new LR(this.data.getIterator())}getIteratorFrom(e){return new LR(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach((n=>{t=t.add(n)})),t}isEqual(e){if(!(e instanceof as)||this.size!==e.size)return!1;const t=this.data.getIterator(),n=e.data.getIterator();for(;t.hasNext();){const r=t.getNext().key,s=n.getNext().key;if(this.comparator(r,s)!==0)return!1}return!0}toArray(){const e=[];return this.forEach((t=>{e.push(t)})),e}toString(){const e=[];return this.forEach((t=>e.push(t))),"SortedSet("+e.toString()+")"}copy(e){const t=new as(this.comparator);return t.data=e,t}}class LR{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _o{constructor(e){this.fields=e,e.sort(ks.comparator)}static empty(){return new _o([])}unionWith(e){let t=new as(ks.comparator);for(const n of this.fields)t=t.add(n);for(const n of e)t=t.add(n);return new _o(t.toArray())}covers(e){for(const t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return $m(this.fields,e.fields,((t,n)=>t.isEqual(n)))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class L3 extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hs{constructor(e){this.binaryString=e}static fromBase64String(e){const t=(function(r){try{return atob(r)}catch(s){throw typeof DOMException<"u"&&s instanceof DOMException?new L3("Invalid base64 string: "+s):s}})(e);return new Hs(t)}static fromUint8Array(e){const t=(function(r){let s="";for(let o=0;o<r.length;++o)s+=String.fromCharCode(r[o]);return s})(e);return new Hs(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return(function(t){return btoa(t)})(this.binaryString)}toUint8Array(){return(function(t){const n=new Uint8Array(t.length);for(let r=0;r<t.length;r++)n[r]=t.charCodeAt(r);return n})(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return li(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}Hs.EMPTY_BYTE_STRING=new Hs("");const Fz=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function ff(i){if(Ri(!!i,39018),typeof i=="string"){let e=0;const t=Fz.exec(i);if(Ri(!!t,46558,{timestamp:i}),t[1]){let r=t[1];r=(r+"000000000").substr(0,9),e=Number(r)}const n=new Date(i);return{seconds:Math.floor(n.getTime()/1e3),nanos:e}}return{seconds:Vr(i.seconds),nanos:Vr(i.nanos)}}function Vr(i){return typeof i=="number"?i:typeof i=="string"?Number(i):0}function df(i){return typeof i=="string"?Hs.fromBase64String(i):Hs.fromUint8Array(i)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const O3="server_timestamp",U3="__type__",F3="__previous_value__",k3="__local_write_time__";function dM(i){var t,n;return((n=(((t=i==null?void 0:i.mapValue)==null?void 0:t.fields)||{})[U3])==null?void 0:n.stringValue)===O3}function jA(i){const e=i.mapValue.fields[F3];return dM(e)?jA(e):e}function Fv(i){const e=ff(i.mapValue.fields[k3].timestampValue);return new tr(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kz{constructor(e,t,n,r,s,o,u,f,p,g,v){this.databaseId=e,this.appId=t,this.persistenceKey=n,this.host=r,this.ssl=s,this.forceLongPolling=o,this.autoDetectLongPolling=u,this.longPollingOptions=f,this.useFetchStreams=p,this.isUsingEmulator=g,this.apiKey=v}}const wb="(default)";class kv{constructor(e,t){this.projectId=e,this.database=t||wb}static empty(){return new kv("","")}get isDefaultDatabase(){return this.database===wb}isEqual(e){return e instanceof kv&&e.projectId===this.projectId&&e.database===this.database}}function zz(i,e){if(!Object.prototype.hasOwnProperty.apply(i.options,["projectId"]))throw new Kt(nt.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new kv(i.options.projectId,e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const z3="__type__",Vz="__max__",nx={mapValue:{}},V3="__vector__",Cb="value";function pf(i){return"nullValue"in i?0:"booleanValue"in i?1:"integerValue"in i||"doubleValue"in i?2:"timestampValue"in i?3:"stringValue"in i?5:"bytesValue"in i?6:"referenceValue"in i?7:"geoPointValue"in i?8:"arrayValue"in i?9:"mapValue"in i?dM(i)?4:Gz(i)?9007199254740991:Hz(i)?10:11:Sn(28295,{value:i})}function Hc(i,e){if(i===e)return!0;const t=pf(i);if(t!==pf(e))return!1;switch(t){case 0:case 9007199254740991:return!0;case 1:return i.booleanValue===e.booleanValue;case 4:return Fv(i).isEqual(Fv(e));case 3:return(function(r,s){if(typeof r.timestampValue=="string"&&typeof s.timestampValue=="string"&&r.timestampValue.length===s.timestampValue.length)return r.timestampValue===s.timestampValue;const o=ff(r.timestampValue),u=ff(s.timestampValue);return o.seconds===u.seconds&&o.nanos===u.nanos})(i,e);case 5:return i.stringValue===e.stringValue;case 6:return(function(r,s){return df(r.bytesValue).isEqual(df(s.bytesValue))})(i,e);case 7:return i.referenceValue===e.referenceValue;case 8:return(function(r,s){return Vr(r.geoPointValue.latitude)===Vr(s.geoPointValue.latitude)&&Vr(r.geoPointValue.longitude)===Vr(s.geoPointValue.longitude)})(i,e);case 2:return(function(r,s){if("integerValue"in r&&"integerValue"in s)return Vr(r.integerValue)===Vr(s.integerValue);if("doubleValue"in r&&"doubleValue"in s){const o=Vr(r.doubleValue),u=Vr(s.doubleValue);return o===u?Mb(o)===Mb(u):isNaN(o)&&isNaN(u)}return!1})(i,e);case 9:return $m(i.arrayValue.values||[],e.arrayValue.values||[],Hc);case 10:case 11:return(function(r,s){const o=r.mapValue.fields||{},u=s.mapValue.fields||{};if(BR(o)!==BR(u))return!1;for(const f in o)if(o.hasOwnProperty(f)&&(u[f]===void 0||!Hc(o[f],u[f])))return!1;return!0})(i,e);default:return Sn(52216,{left:i})}}function zv(i,e){return(i.values||[]).find((t=>Hc(t,e)))!==void 0}function eg(i,e){if(i===e)return 0;const t=pf(i),n=pf(e);if(t!==n)return li(t,n);switch(t){case 0:case 9007199254740991:return 0;case 1:return li(i.booleanValue,e.booleanValue);case 2:return(function(s,o){const u=Vr(s.integerValue||s.doubleValue),f=Vr(o.integerValue||o.doubleValue);return u<f?-1:u>f?1:u===f?0:isNaN(u)?isNaN(f)?0:-1:1})(i,e);case 3:return OR(i.timestampValue,e.timestampValue);case 4:return OR(Fv(i),Fv(e));case 5:return rT(i.stringValue,e.stringValue);case 6:return(function(s,o){const u=df(s),f=df(o);return u.compareTo(f)})(i.bytesValue,e.bytesValue);case 7:return(function(s,o){const u=s.split("/"),f=o.split("/");for(let p=0;p<u.length&&p<f.length;p++){const g=li(u[p],f[p]);if(g!==0)return g}return li(u.length,f.length)})(i.referenceValue,e.referenceValue);case 8:return(function(s,o){const u=li(Vr(s.latitude),Vr(o.latitude));return u!==0?u:li(Vr(s.longitude),Vr(o.longitude))})(i.geoPointValue,e.geoPointValue);case 9:return UR(i.arrayValue,e.arrayValue);case 10:return(function(s,o){var _,x,E,C;const u=s.fields||{},f=o.fields||{},p=(_=u[Cb])==null?void 0:_.arrayValue,g=(x=f[Cb])==null?void 0:x.arrayValue,v=li(((E=p==null?void 0:p.values)==null?void 0:E.length)||0,((C=g==null?void 0:g.values)==null?void 0:C.length)||0);return v!==0?v:UR(p,g)})(i.mapValue,e.mapValue);case 11:return(function(s,o){if(s===nx.mapValue&&o===nx.mapValue)return 0;if(s===nx.mapValue)return 1;if(o===nx.mapValue)return-1;const u=s.fields||{},f=Object.keys(u),p=o.fields||{},g=Object.keys(p);f.sort(),g.sort();for(let v=0;v<f.length&&v<g.length;++v){const _=rT(f[v],g[v]);if(_!==0)return _;const x=eg(u[f[v]],p[g[v]]);if(x!==0)return x}return li(f.length,g.length)})(i.mapValue,e.mapValue);default:throw Sn(23264,{he:t})}}function OR(i,e){if(typeof i=="string"&&typeof e=="string"&&i.length===e.length)return li(i,e);const t=ff(i),n=ff(e),r=li(t.seconds,n.seconds);return r!==0?r:li(t.nanos,n.nanos)}function UR(i,e){const t=i.values||[],n=e.values||[];for(let r=0;r<t.length&&r<n.length;++r){const s=eg(t[r],n[r]);if(s)return s}return li(t.length,n.length)}function tg(i){return sT(i)}function sT(i){return"nullValue"in i?"null":"booleanValue"in i?""+i.booleanValue:"integerValue"in i?""+i.integerValue:"doubleValue"in i?""+i.doubleValue:"timestampValue"in i?(function(t){const n=ff(t);return`time(${n.seconds},${n.nanos})`})(i.timestampValue):"stringValue"in i?i.stringValue:"bytesValue"in i?(function(t){return df(t).toBase64()})(i.bytesValue):"referenceValue"in i?(function(t){return dn.fromName(t).toString()})(i.referenceValue):"geoPointValue"in i?(function(t){return`geo(${t.latitude},${t.longitude})`})(i.geoPointValue):"arrayValue"in i?(function(t){let n="[",r=!0;for(const s of t.values||[])r?r=!1:n+=",",n+=sT(s);return n+"]"})(i.arrayValue):"mapValue"in i?(function(t){const n=Object.keys(t.fields||{}).sort();let r="{",s=!0;for(const o of n)s?s=!1:r+=",",r+=`${o}:${sT(t.fields[o])}`;return r+"}"})(i.mapValue):Sn(61005,{value:i})}function ob(i){switch(pf(i)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const e=jA(i);return e?16+ob(e):16;case 5:return 2*i.stringValue.length;case 6:return df(i.bytesValue).approximateByteSize();case 7:return i.referenceValue.length;case 9:return(function(n){return(n.values||[]).reduce(((r,s)=>r+ob(s)),0)})(i.arrayValue);case 10:case 11:return(function(n){let r=0;return Af(n.fields,((s,o)=>{r+=s.length+ob(o)})),r})(i.mapValue);default:throw Sn(13486,{value:i})}}function FR(i,e){return{referenceValue:`projects/${i.projectId}/databases/${i.database}/documents/${e.path.canonicalString()}`}}function aT(i){return!!i&&"integerValue"in i}function pM(i){return!!i&&"arrayValue"in i}function kR(i){return!!i&&"nullValue"in i}function zR(i){return!!i&&"doubleValue"in i&&isNaN(Number(i.doubleValue))}function lb(i){return!!i&&"mapValue"in i}function Hz(i){var t,n;return((n=(((t=i==null?void 0:i.mapValue)==null?void 0:t.fields)||{})[z3])==null?void 0:n.stringValue)===V3}function bv(i){if(i.geoPointValue)return{geoPointValue:{...i.geoPointValue}};if(i.timestampValue&&typeof i.timestampValue=="object")return{timestampValue:{...i.timestampValue}};if(i.mapValue){const e={mapValue:{fields:{}}};return Af(i.mapValue.fields,((t,n)=>e.mapValue.fields[t]=bv(n))),e}if(i.arrayValue){const e={arrayValue:{values:[]}};for(let t=0;t<(i.arrayValue.values||[]).length;++t)e.arrayValue.values[t]=bv(i.arrayValue.values[t]);return e}return{...i}}function Gz(i){return(((i.mapValue||{}).fields||{}).__type__||{}).stringValue===Vz}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $a{constructor(e){this.value=e}static empty(){return new $a({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let n=0;n<e.length-1;++n)if(t=(t.mapValue.fields||{})[e.get(n)],!lb(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=bv(t)}setAll(e){let t=ks.emptyPath(),n={},r=[];e.forEach(((o,u)=>{if(!t.isImmediateParentOf(u)){const f=this.getFieldsMap(t);this.applyChanges(f,n,r),n={},r=[],t=u.popLast()}o?n[u.lastSegment()]=bv(o):r.push(u.lastSegment())}));const s=this.getFieldsMap(t);this.applyChanges(s,n,r)}delete(e){const t=this.field(e.popLast());lb(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return Hc(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let n=0;n<e.length;++n){let r=t.mapValue.fields[e.get(n)];lb(r)&&r.mapValue.fields||(r={mapValue:{fields:{}}},t.mapValue.fields[e.get(n)]=r),t=r}return t.mapValue.fields}applyChanges(e,t,n){Af(t,((r,s)=>e[r]=s));for(const r of n)delete e[r]}clone(){return new $a(bv(this.value))}}function H3(i){const e=[];return Af(i.fields,((t,n)=>{const r=new ks([t]);if(lb(n)){const s=H3(n.mapValue).fields;if(s.length===0)e.push(r);else for(const o of s)e.push(r.child(o))}else e.push(r)})),new _o(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ca{constructor(e,t,n,r,s,o,u){this.key=e,this.documentType=t,this.version=n,this.readTime=r,this.createTime=s,this.data=o,this.documentState=u}static newInvalidDocument(e){return new ca(e,0,In.min(),In.min(),In.min(),$a.empty(),0)}static newFoundDocument(e,t,n,r){return new ca(e,1,t,In.min(),n,r,0)}static newNoDocument(e,t){return new ca(e,2,t,In.min(),In.min(),$a.empty(),0)}static newUnknownDocument(e,t){return new ca(e,3,t,In.min(),In.min(),$a.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(In.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=$a.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=$a.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=In.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof ca&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new ca(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Rb{constructor(e,t){this.position=e,this.inclusive=t}}function VR(i,e,t){let n=0;for(let r=0;r<i.position.length;r++){const s=e[r],o=i.position[r];if(s.field.isKeyField()?n=dn.comparator(dn.fromName(o.referenceValue),t.key):n=eg(o,t.data.field(s.field)),s.dir==="desc"&&(n*=-1),n!==0)break}return n}function HR(i,e){if(i===null)return e===null;if(e===null||i.inclusive!==e.inclusive||i.position.length!==e.position.length)return!1;for(let t=0;t<i.position.length;t++)if(!Hc(i.position[t],e.position[t]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vv{constructor(e,t="asc"){this.field=e,this.dir=t}}function jz(i,e){return i.dir===e.dir&&i.field.isEqual(e.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class G3{}class es extends G3{constructor(e,t,n){super(),this.field=e,this.op=t,this.value=n}static create(e,t,n){return e.isKeyField()?t==="in"||t==="not-in"?this.createKeyFieldInFilter(e,t,n):new qz(e,t,n):t==="array-contains"?new Jz(e,n):t==="in"?new Kz(e,n):t==="not-in"?new Qz(e,n):t==="array-contains-any"?new Zz(e,n):new es(e,t,n)}static createKeyFieldInFilter(e,t,n){return t==="in"?new Xz(e,n):new Yz(e,n)}matches(e){const t=e.data.field(this.field);return this.op==="!="?t!==null&&t.nullValue===void 0&&this.matchesComparison(eg(t,this.value)):t!==null&&pf(this.value)===pf(t)&&this.matchesComparison(eg(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return Sn(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class Wl extends G3{constructor(e,t){super(),this.filters=e,this.op=t,this.Pe=null}static create(e,t){return new Wl(e,t)}matches(e){return j3(this)?this.filters.find((t=>!t.matches(e)))===void 0:this.filters.find((t=>t.matches(e)))!==void 0}getFlattenedFilters(){return this.Pe!==null||(this.Pe=this.filters.reduce(((e,t)=>e.concat(t.getFlattenedFilters())),[])),this.Pe}getFilters(){return Object.assign([],this.filters)}}function j3(i){return i.op==="and"}function W3(i){return Wz(i)&&j3(i)}function Wz(i){for(const e of i.filters)if(e instanceof Wl)return!1;return!0}function oT(i){if(i instanceof es)return i.field.canonicalString()+i.op.toString()+tg(i.value);if(W3(i))return i.filters.map((e=>oT(e))).join(",");{const e=i.filters.map((t=>oT(t))).join(",");return`${i.op}(${e})`}}function q3(i,e){return i instanceof es?(function(n,r){return r instanceof es&&n.op===r.op&&n.field.isEqual(r.field)&&Hc(n.value,r.value)})(i,e):i instanceof Wl?(function(n,r){return r instanceof Wl&&n.op===r.op&&n.filters.length===r.filters.length?n.filters.reduce(((s,o,u)=>s&&q3(o,r.filters[u])),!0):!1})(i,e):void Sn(19439)}function X3(i){return i instanceof es?(function(t){return`${t.field.canonicalString()} ${t.op} ${tg(t.value)}`})(i):i instanceof Wl?(function(t){return t.op.toString()+" {"+t.getFilters().map(X3).join(" ,")+"}"})(i):"Filter"}class qz extends es{constructor(e,t,n){super(e,t,n),this.key=dn.fromName(n.referenceValue)}matches(e){const t=dn.comparator(e.key,this.key);return this.matchesComparison(t)}}class Xz extends es{constructor(e,t){super(e,"in",t),this.keys=Y3("in",t)}matches(e){return this.keys.some((t=>t.isEqual(e.key)))}}class Yz extends es{constructor(e,t){super(e,"not-in",t),this.keys=Y3("not-in",t)}matches(e){return!this.keys.some((t=>t.isEqual(e.key)))}}function Y3(i,e){var t;return(((t=e.arrayValue)==null?void 0:t.values)||[]).map((n=>dn.fromName(n.referenceValue)))}class Jz extends es{constructor(e,t){super(e,"array-contains",t)}matches(e){const t=e.data.field(this.field);return pM(t)&&zv(t.arrayValue,this.value)}}class Kz extends es{constructor(e,t){super(e,"in",t)}matches(e){const t=e.data.field(this.field);return t!==null&&zv(this.value.arrayValue,t)}}class Qz extends es{constructor(e,t){super(e,"not-in",t)}matches(e){if(zv(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const t=e.data.field(this.field);return t!==null&&t.nullValue===void 0&&!zv(this.value.arrayValue,t)}}class Zz extends es{constructor(e,t){super(e,"array-contains-any",t)}matches(e){const t=e.data.field(this.field);return!(!pM(t)||!t.arrayValue.values)&&t.arrayValue.values.some((n=>zv(this.value.arrayValue,n)))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $z{constructor(e,t=null,n=[],r=[],s=null,o=null,u=null){this.path=e,this.collectionGroup=t,this.orderBy=n,this.filters=r,this.limit=s,this.startAt=o,this.endAt=u,this.Te=null}}function GR(i,e=null,t=[],n=[],r=null,s=null,o=null){return new $z(i,e,t,n,r,s,o)}function mM(i){const e=Bn(i);if(e.Te===null){let t=e.path.canonicalString();e.collectionGroup!==null&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map((n=>oT(n))).join(","),t+="|ob:",t+=e.orderBy.map((n=>(function(s){return s.field.canonicalString()+s.dir})(n))).join(","),GA(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map((n=>tg(n))).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map((n=>tg(n))).join(",")),e.Te=t}return e.Te}function gM(i,e){if(i.limit!==e.limit||i.orderBy.length!==e.orderBy.length)return!1;for(let t=0;t<i.orderBy.length;t++)if(!jz(i.orderBy[t],e.orderBy[t]))return!1;if(i.filters.length!==e.filters.length)return!1;for(let t=0;t<i.filters.length;t++)if(!q3(i.filters[t],e.filters[t]))return!1;return i.collectionGroup===e.collectionGroup&&!!i.path.isEqual(e.path)&&!!HR(i.startAt,e.startAt)&&HR(i.endAt,e.endAt)}function lT(i){return dn.isDocumentKey(i.path)&&i.collectionGroup===null&&i.filters.length===0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Eg{constructor(e,t=null,n=[],r=[],s=null,o="F",u=null,f=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=n,this.filters=r,this.limit=s,this.limitType=o,this.startAt=u,this.endAt=f,this.Ie=null,this.Ee=null,this.Re=null,this.startAt,this.endAt}}function eV(i,e,t,n,r,s,o,u){return new Eg(i,e,t,n,r,s,o,u)}function vM(i){return new Eg(i)}function jR(i){return i.filters.length===0&&i.limit===null&&i.startAt==null&&i.endAt==null&&(i.explicitOrderBy.length===0||i.explicitOrderBy.length===1&&i.explicitOrderBy[0].field.isKeyField())}function tV(i){return dn.isDocumentKey(i.path)&&i.collectionGroup===null&&i.filters.length===0}function J3(i){return i.collectionGroup!==null}function Av(i){const e=Bn(i);if(e.Ie===null){e.Ie=[];const t=new Set;for(const s of e.explicitOrderBy)e.Ie.push(s),t.add(s.field.canonicalString());const n=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(o){let u=new as(ks.comparator);return o.filters.forEach((f=>{f.getFlattenedFilters().forEach((p=>{p.isInequality()&&(u=u.add(p.field))}))})),u})(e).forEach((s=>{t.has(s.canonicalString())||s.isKeyField()||e.Ie.push(new Vv(s,n))})),t.has(ks.keyField().canonicalString())||e.Ie.push(new Vv(ks.keyField(),n))}return e.Ie}function Fc(i){const e=Bn(i);return e.Ee||(e.Ee=nV(e,Av(i))),e.Ee}function nV(i,e){if(i.limitType==="F")return GR(i.path,i.collectionGroup,e,i.filters,i.limit,i.startAt,i.endAt);{e=e.map((r=>{const s=r.dir==="desc"?"asc":"desc";return new Vv(r.field,s)}));const t=i.endAt?new Rb(i.endAt.position,i.endAt.inclusive):null,n=i.startAt?new Rb(i.startAt.position,i.startAt.inclusive):null;return GR(i.path,i.collectionGroup,e,i.filters,i.limit,t,n)}}function cT(i,e){const t=i.filters.concat([e]);return new Eg(i.path,i.collectionGroup,i.explicitOrderBy.slice(),t,i.limit,i.limitType,i.startAt,i.endAt)}function iV(i,e){const t=i.explicitOrderBy.concat([e]);return new Eg(i.path,i.collectionGroup,t,i.filters.slice(),i.limit,i.limitType,i.startAt,i.endAt)}function uT(i,e,t){return new Eg(i.path,i.collectionGroup,i.explicitOrderBy.slice(),i.filters.slice(),e,t,i.startAt,i.endAt)}function WA(i,e){return gM(Fc(i),Fc(e))&&i.limitType===e.limitType}function K3(i){return`${mM(Fc(i))}|lt:${i.limitType}`}function Lm(i){return`Query(target=${(function(t){let n=t.path.canonicalString();return t.collectionGroup!==null&&(n+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(n+=`, filters: [${t.filters.map((r=>X3(r))).join(", ")}]`),GA(t.limit)||(n+=", limit: "+t.limit),t.orderBy.length>0&&(n+=`, orderBy: [${t.orderBy.map((r=>(function(o){return`${o.field.canonicalString()} (${o.dir})`})(r))).join(", ")}]`),t.startAt&&(n+=", startAt: ",n+=t.startAt.inclusive?"b:":"a:",n+=t.startAt.position.map((r=>tg(r))).join(",")),t.endAt&&(n+=", endAt: ",n+=t.endAt.inclusive?"a:":"b:",n+=t.endAt.position.map((r=>tg(r))).join(",")),`Target(${n})`})(Fc(i))}; limitType=${i.limitType})`}function qA(i,e){return e.isFoundDocument()&&(function(n,r){const s=r.key.path;return n.collectionGroup!==null?r.key.hasCollectionId(n.collectionGroup)&&n.path.isPrefixOf(s):dn.isDocumentKey(n.path)?n.path.isEqual(s):n.path.isImmediateParentOf(s)})(i,e)&&(function(n,r){for(const s of Av(n))if(!s.field.isKeyField()&&r.data.field(s.field)===null)return!1;return!0})(i,e)&&(function(n,r){for(const s of n.filters)if(!s.matches(r))return!1;return!0})(i,e)&&(function(n,r){return!(n.startAt&&!(function(o,u,f){const p=VR(o,u,f);return o.inclusive?p<=0:p<0})(n.startAt,Av(n),r)||n.endAt&&!(function(o,u,f){const p=VR(o,u,f);return o.inclusive?p>=0:p>0})(n.endAt,Av(n),r))})(i,e)}function rV(i){return i.collectionGroup||(i.path.length%2==1?i.path.lastSegment():i.path.get(i.path.length-2))}function Q3(i){return(e,t)=>{let n=!1;for(const r of Av(i)){const s=sV(r,e,t);if(s!==0)return s;n=n||r.field.isKeyField()}return 0}}function sV(i,e,t){const n=i.field.isKeyField()?dn.comparator(e.key,t.key):(function(s,o,u){const f=o.data.field(s),p=u.data.field(s);return f!==null&&p!==null?eg(f,p):Sn(42886)})(i.field,e,t);switch(i.dir){case"asc":return n;case"desc":return-1*n;default:return Sn(19790,{direction:i.dir})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class op{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){const t=this.mapKeyFn(e),n=this.inner[t];if(n!==void 0){for(const[r,s]of n)if(this.equalsFn(r,e))return s}}has(e){return this.get(e)!==void 0}set(e,t){const n=this.mapKeyFn(e),r=this.inner[n];if(r===void 0)return this.inner[n]=[[e,t]],void this.innerSize++;for(let s=0;s<r.length;s++)if(this.equalsFn(r[s][0],e))return void(r[s]=[e,t]);r.push([e,t]),this.innerSize++}delete(e){const t=this.mapKeyFn(e),n=this.inner[t];if(n===void 0)return!1;for(let r=0;r<n.length;r++)if(this.equalsFn(n[r][0],e))return n.length===1?delete this.inner[t]:n.splice(r,1),this.innerSize--,!0;return!1}forEach(e){Af(this.inner,((t,n)=>{for(const[r,s]of n)e(r,s)}))}isEmpty(){return B3(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const aV=new Tr(dn.comparator);function Gu(){return aV}const Z3=new Tr(dn.comparator);function dv(...i){let e=Z3;for(const t of i)e=e.insert(t.key,t);return e}function $3(i){let e=Z3;return i.forEach(((t,n)=>e=e.insert(t,n.overlayedDocument))),e}function Dd(){return Sv()}function eP(){return Sv()}function Sv(){return new op((i=>i.toString()),((i,e)=>i.isEqual(e)))}const oV=new Tr(dn.comparator),lV=new as(dn.comparator);function ci(...i){let e=lV;for(const t of i)e=e.add(t);return e}const cV=new as(li);function uV(){return cV}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function yM(i,e){if(i.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Mb(e)?"-0":e}}function tP(i){return{integerValue:""+i}}function hV(i,e){return Lz(e)?tP(e):yM(i,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class XA{constructor(){this._=void 0}}function fV(i,e,t){return i instanceof Ib?(function(r,s){const o={fields:{[U3]:{stringValue:O3},[k3]:{timestampValue:{seconds:r.seconds,nanos:r.nanoseconds}}}};return s&&dM(s)&&(s=jA(s)),s&&(o.fields[F3]=s),{mapValue:o}})(t,e):i instanceof Hv?iP(i,e):i instanceof Gv?rP(i,e):(function(r,s){const o=nP(r,s),u=WR(o)+WR(r.Ae);return aT(o)&&aT(r.Ae)?tP(u):yM(r.serializer,u)})(i,e)}function dV(i,e,t){return i instanceof Hv?iP(i,e):i instanceof Gv?rP(i,e):t}function nP(i,e){return i instanceof Db?(function(n){return aT(n)||(function(s){return!!s&&"doubleValue"in s})(n)})(e)?e:{integerValue:0}:null}class Ib extends XA{}class Hv extends XA{constructor(e){super(),this.elements=e}}function iP(i,e){const t=sP(e);for(const n of i.elements)t.some((r=>Hc(r,n)))||t.push(n);return{arrayValue:{values:t}}}class Gv extends XA{constructor(e){super(),this.elements=e}}function rP(i,e){let t=sP(e);for(const n of i.elements)t=t.filter((r=>!Hc(r,n)));return{arrayValue:{values:t}}}class Db extends XA{constructor(e,t){super(),this.serializer=e,this.Ae=t}}function WR(i){return Vr(i.integerValue||i.doubleValue)}function sP(i){return pM(i)&&i.arrayValue.values?i.arrayValue.values.slice():[]}function pV(i,e){return i.field.isEqual(e.field)&&(function(n,r){return n instanceof Hv&&r instanceof Hv||n instanceof Gv&&r instanceof Gv?$m(n.elements,r.elements,Hc):n instanceof Db&&r instanceof Db?Hc(n.Ae,r.Ae):n instanceof Ib&&r instanceof Ib})(i.transform,e.transform)}class mV{constructor(e,t){this.version=e,this.transformResults=t}}class al{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new al}static exists(e){return new al(void 0,e)}static updateTime(e){return new al(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function cb(i,e){return i.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(i.updateTime):i.exists===void 0||i.exists===e.isFoundDocument()}class YA{}function aP(i,e){if(!i.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return i.isNoDocument()?new _M(i.key,al.none()):new uy(i.key,i.data,al.none());{const t=i.data,n=$a.empty();let r=new as(ks.comparator);for(let s of e.fields)if(!r.has(s)){let o=t.field(s);o===null&&s.length>1&&(s=s.popLast(),o=t.field(s)),o===null?n.delete(s):n.set(s,o),r=r.add(s)}return new Sf(i.key,n,new _o(r.toArray()),al.none())}}function gV(i,e,t){i instanceof uy?(function(r,s,o){const u=r.value.clone(),f=XR(r.fieldTransforms,s,o.transformResults);u.setAll(f),s.convertToFoundDocument(o.version,u).setHasCommittedMutations()})(i,e,t):i instanceof Sf?(function(r,s,o){if(!cb(r.precondition,s))return void s.convertToUnknownDocument(o.version);const u=XR(r.fieldTransforms,s,o.transformResults),f=s.data;f.setAll(oP(r)),f.setAll(u),s.convertToFoundDocument(o.version,f).setHasCommittedMutations()})(i,e,t):(function(r,s,o){s.convertToNoDocument(o.version).setHasCommittedMutations()})(0,e,t)}function Ev(i,e,t,n){return i instanceof uy?(function(s,o,u,f){if(!cb(s.precondition,o))return u;const p=s.value.clone(),g=YR(s.fieldTransforms,f,o);return p.setAll(g),o.convertToFoundDocument(o.version,p).setHasLocalMutations(),null})(i,e,t,n):i instanceof Sf?(function(s,o,u,f){if(!cb(s.precondition,o))return u;const p=YR(s.fieldTransforms,f,o),g=o.data;return g.setAll(oP(s)),g.setAll(p),o.convertToFoundDocument(o.version,g).setHasLocalMutations(),u===null?null:u.unionWith(s.fieldMask.fields).unionWith(s.fieldTransforms.map((v=>v.field)))})(i,e,t,n):(function(s,o,u){return cb(s.precondition,o)?(o.convertToNoDocument(o.version).setHasLocalMutations(),null):u})(i,e,t)}function vV(i,e){let t=null;for(const n of i.fieldTransforms){const r=e.data.field(n.field),s=nP(n.transform,r||null);s!=null&&(t===null&&(t=$a.empty()),t.set(n.field,s))}return t||null}function qR(i,e){return i.type===e.type&&!!i.key.isEqual(e.key)&&!!i.precondition.isEqual(e.precondition)&&!!(function(n,r){return n===void 0&&r===void 0||!(!n||!r)&&$m(n,r,((s,o)=>pV(s,o)))})(i.fieldTransforms,e.fieldTransforms)&&(i.type===0?i.value.isEqual(e.value):i.type!==1||i.data.isEqual(e.data)&&i.fieldMask.isEqual(e.fieldMask))}class uy extends YA{constructor(e,t,n,r=[]){super(),this.key=e,this.value=t,this.precondition=n,this.fieldTransforms=r,this.type=0}getFieldMask(){return null}}class Sf extends YA{constructor(e,t,n,r,s=[]){super(),this.key=e,this.data=t,this.fieldMask=n,this.precondition=r,this.fieldTransforms=s,this.type=1}getFieldMask(){return this.fieldMask}}function oP(i){const e=new Map;return i.fieldMask.fields.forEach((t=>{if(!t.isEmpty()){const n=i.data.field(t);e.set(t,n)}})),e}function XR(i,e,t){const n=new Map;Ri(i.length===t.length,32656,{Ve:t.length,de:i.length});for(let r=0;r<t.length;r++){const s=i[r],o=s.transform,u=e.data.field(s.field);n.set(s.field,dV(o,u,t[r]))}return n}function YR(i,e,t){const n=new Map;for(const r of i){const s=r.transform,o=t.data.field(r.field);n.set(r.field,fV(s,o,e))}return n}class _M extends YA{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class yV extends YA{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _V{constructor(e,t,n,r){this.batchId=e,this.localWriteTime=t,this.baseMutations=n,this.mutations=r}applyToRemoteDocument(e,t){const n=t.mutationResults;for(let r=0;r<this.mutations.length;r++){const s=this.mutations[r];s.key.isEqual(e.key)&&gV(s,e,n[r])}}applyToLocalView(e,t){for(const n of this.baseMutations)n.key.isEqual(e.key)&&(t=Ev(n,e,t,this.localWriteTime));for(const n of this.mutations)n.key.isEqual(e.key)&&(t=Ev(n,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){const n=eP();return this.mutations.forEach((r=>{const s=e.get(r.key),o=s.overlayedDocument;let u=this.applyToLocalView(o,s.mutatedFields);u=t.has(r.key)?null:u;const f=aP(o,u);f!==null&&n.set(r.key,f),o.isValidDocument()||o.convertToNoDocument(In.min())})),n}keys(){return this.mutations.reduce(((e,t)=>e.add(t.key)),ci())}isEqual(e){return this.batchId===e.batchId&&$m(this.mutations,e.mutations,((t,n)=>qR(t,n)))&&$m(this.baseMutations,e.baseMutations,((t,n)=>qR(t,n)))}}class xM{constructor(e,t,n,r){this.batch=e,this.commitVersion=t,this.mutationResults=n,this.docVersions=r}static from(e,t,n){Ri(e.mutations.length===n.length,58842,{me:e.mutations.length,fe:n.length});let r=(function(){return oV})();const s=e.mutations;for(let o=0;o<s.length;o++)r=r.insert(s[o].key,n[o].version);return new xM(e,t,n,r)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xV{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bV{constructor(e,t){this.count=e,this.unchangedNames=t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var $r,pi;function AV(i){switch(i){case nt.OK:return Sn(64938);case nt.CANCELLED:case nt.UNKNOWN:case nt.DEADLINE_EXCEEDED:case nt.RESOURCE_EXHAUSTED:case nt.INTERNAL:case nt.UNAVAILABLE:case nt.UNAUTHENTICATED:return!1;case nt.INVALID_ARGUMENT:case nt.NOT_FOUND:case nt.ALREADY_EXISTS:case nt.PERMISSION_DENIED:case nt.FAILED_PRECONDITION:case nt.ABORTED:case nt.OUT_OF_RANGE:case nt.UNIMPLEMENTED:case nt.DATA_LOSS:return!0;default:return Sn(15467,{code:i})}}function lP(i){if(i===void 0)return Hu("GRPC error has no .code"),nt.UNKNOWN;switch(i){case $r.OK:return nt.OK;case $r.CANCELLED:return nt.CANCELLED;case $r.UNKNOWN:return nt.UNKNOWN;case $r.DEADLINE_EXCEEDED:return nt.DEADLINE_EXCEEDED;case $r.RESOURCE_EXHAUSTED:return nt.RESOURCE_EXHAUSTED;case $r.INTERNAL:return nt.INTERNAL;case $r.UNAVAILABLE:return nt.UNAVAILABLE;case $r.UNAUTHENTICATED:return nt.UNAUTHENTICATED;case $r.INVALID_ARGUMENT:return nt.INVALID_ARGUMENT;case $r.NOT_FOUND:return nt.NOT_FOUND;case $r.ALREADY_EXISTS:return nt.ALREADY_EXISTS;case $r.PERMISSION_DENIED:return nt.PERMISSION_DENIED;case $r.FAILED_PRECONDITION:return nt.FAILED_PRECONDITION;case $r.ABORTED:return nt.ABORTED;case $r.OUT_OF_RANGE:return nt.OUT_OF_RANGE;case $r.UNIMPLEMENTED:return nt.UNIMPLEMENTED;case $r.DATA_LOSS:return nt.DATA_LOSS;default:return Sn(39323,{code:i})}}(pi=$r||($r={}))[pi.OK=0]="OK",pi[pi.CANCELLED=1]="CANCELLED",pi[pi.UNKNOWN=2]="UNKNOWN",pi[pi.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",pi[pi.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",pi[pi.NOT_FOUND=5]="NOT_FOUND",pi[pi.ALREADY_EXISTS=6]="ALREADY_EXISTS",pi[pi.PERMISSION_DENIED=7]="PERMISSION_DENIED",pi[pi.UNAUTHENTICATED=16]="UNAUTHENTICATED",pi[pi.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",pi[pi.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",pi[pi.ABORTED=10]="ABORTED",pi[pi.OUT_OF_RANGE=11]="OUT_OF_RANGE",pi[pi.UNIMPLEMENTED=12]="UNIMPLEMENTED",pi[pi.INTERNAL=13]="INTERNAL",pi[pi.UNAVAILABLE=14]="UNAVAILABLE",pi[pi.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function SV(){return new TextEncoder}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const EV=new of([4294967295,4294967295],0);function JR(i){const e=SV().encode(i),t=new S3;return t.update(e),new Uint8Array(t.digest())}function KR(i){const e=new DataView(i.buffer),t=e.getUint32(0,!0),n=e.getUint32(4,!0),r=e.getUint32(8,!0),s=e.getUint32(12,!0);return[new of([t,n],0),new of([r,s],0)]}class bM{constructor(e,t,n){if(this.bitmap=e,this.padding=t,this.hashCount=n,t<0||t>=8)throw new pv(`Invalid padding: ${t}`);if(n<0)throw new pv(`Invalid hash count: ${n}`);if(e.length>0&&this.hashCount===0)throw new pv(`Invalid hash count: ${n}`);if(e.length===0&&t!==0)throw new pv(`Invalid padding when bitmap length is 0: ${t}`);this.ge=8*e.length-t,this.pe=of.fromNumber(this.ge)}ye(e,t,n){let r=e.add(t.multiply(of.fromNumber(n)));return r.compare(EV)===1&&(r=new of([r.getBits(0),r.getBits(1)],0)),r.modulo(this.pe).toNumber()}we(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(this.ge===0)return!1;const t=JR(e),[n,r]=KR(t);for(let s=0;s<this.hashCount;s++){const o=this.ye(n,r,s);if(!this.we(o))return!1}return!0}static create(e,t,n){const r=e%8==0?0:8-e%8,s=new Uint8Array(Math.ceil(e/8)),o=new bM(s,r,t);return n.forEach((u=>o.insert(u))),o}insert(e){if(this.ge===0)return;const t=JR(e),[n,r]=KR(t);for(let s=0;s<this.hashCount;s++){const o=this.ye(n,r,s);this.be(o)}}be(e){const t=Math.floor(e/8),n=e%8;this.bitmap[t]|=1<<n}}class pv extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class JA{constructor(e,t,n,r,s){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=n,this.documentUpdates=r,this.resolvedLimboDocuments=s}static createSynthesizedRemoteEventForCurrentChange(e,t,n){const r=new Map;return r.set(e,hy.createSynthesizedTargetChangeForCurrentChange(e,t,n)),new JA(In.min(),r,new Tr(li),Gu(),ci())}}class hy{constructor(e,t,n,r,s){this.resumeToken=e,this.current=t,this.addedDocuments=n,this.modifiedDocuments=r,this.removedDocuments=s}static createSynthesizedTargetChangeForCurrentChange(e,t,n){return new hy(n,t,ci(),ci(),ci())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ub{constructor(e,t,n,r){this.Se=e,this.removedTargetIds=t,this.key=n,this.De=r}}class cP{constructor(e,t){this.targetId=e,this.Ce=t}}class uP{constructor(e,t,n=Hs.EMPTY_BYTE_STRING,r=null){this.state=e,this.targetIds=t,this.resumeToken=n,this.cause=r}}class QR{constructor(){this.ve=0,this.Fe=ZR(),this.Me=Hs.EMPTY_BYTE_STRING,this.xe=!1,this.Oe=!0}get current(){return this.xe}get resumeToken(){return this.Me}get Ne(){return this.ve!==0}get Be(){return this.Oe}Le(e){e.approximateByteSize()>0&&(this.Oe=!0,this.Me=e)}ke(){let e=ci(),t=ci(),n=ci();return this.Fe.forEach(((r,s)=>{switch(s){case 0:e=e.add(r);break;case 2:t=t.add(r);break;case 1:n=n.add(r);break;default:Sn(38017,{changeType:s})}})),new hy(this.Me,this.xe,e,t,n)}Ke(){this.Oe=!1,this.Fe=ZR()}qe(e,t){this.Oe=!0,this.Fe=this.Fe.insert(e,t)}Ue(e){this.Oe=!0,this.Fe=this.Fe.remove(e)}$e(){this.ve+=1}We(){this.ve-=1,Ri(this.ve>=0,3241,{ve:this.ve})}Qe(){this.Oe=!0,this.xe=!0}}class TV{constructor(e){this.Ge=e,this.ze=new Map,this.je=Gu(),this.He=ix(),this.Je=ix(),this.Ze=new Tr(li)}Xe(e){for(const t of e.Se)e.De&&e.De.isFoundDocument()?this.Ye(t,e.De):this.et(t,e.key,e.De);for(const t of e.removedTargetIds)this.et(t,e.key,e.De)}tt(e){this.forEachTarget(e,(t=>{const n=this.nt(t);switch(e.state){case 0:this.rt(t)&&n.Le(e.resumeToken);break;case 1:n.We(),n.Ne||n.Ke(),n.Le(e.resumeToken);break;case 2:n.We(),n.Ne||this.removeTarget(t);break;case 3:this.rt(t)&&(n.Qe(),n.Le(e.resumeToken));break;case 4:this.rt(t)&&(this.it(t),n.Le(e.resumeToken));break;default:Sn(56790,{state:e.state})}}))}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.ze.forEach(((n,r)=>{this.rt(r)&&t(r)}))}st(e){const t=e.targetId,n=e.Ce.count,r=this.ot(t);if(r){const s=r.target;if(lT(s))if(n===0){const o=new dn(s.path);this.et(t,o,ca.newNoDocument(o,In.min()))}else Ri(n===1,20013,{expectedCount:n});else{const o=this._t(t);if(o!==n){const u=this.ut(e),f=u?this.ct(u,e,o):1;if(f!==0){this.it(t);const p=f===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ze=this.Ze.insert(t,p)}}}}}ut(e){const t=e.Ce.unchangedNames;if(!t||!t.bits)return null;const{bits:{bitmap:n="",padding:r=0},hashCount:s=0}=t;let o,u;try{o=df(n).toUint8Array()}catch(f){if(f instanceof L3)return Zm("Decoding the base64 bloom filter in existence filter failed ("+f.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw f}try{u=new bM(o,r,s)}catch(f){return Zm(f instanceof pv?"BloomFilter error: ":"Applying bloom filter failed: ",f),null}return u.ge===0?null:u}ct(e,t,n){return t.Ce.count===n-this.Pt(e,t.targetId)?0:2}Pt(e,t){const n=this.Ge.getRemoteKeysForTarget(t);let r=0;return n.forEach((s=>{const o=this.Ge.ht(),u=`projects/${o.projectId}/databases/${o.database}/documents/${s.path.canonicalString()}`;e.mightContain(u)||(this.et(t,s,null),r++)})),r}Tt(e){const t=new Map;this.ze.forEach(((s,o)=>{const u=this.ot(o);if(u){if(s.current&&lT(u.target)){const f=new dn(u.target.path);this.It(f).has(o)||this.Et(o,f)||this.et(o,f,ca.newNoDocument(f,e))}s.Be&&(t.set(o,s.ke()),s.Ke())}}));let n=ci();this.Je.forEach(((s,o)=>{let u=!0;o.forEachWhile((f=>{const p=this.ot(f);return!p||p.purpose==="TargetPurposeLimboResolution"||(u=!1,!1)})),u&&(n=n.add(s))})),this.je.forEach(((s,o)=>o.setReadTime(e)));const r=new JA(e,t,this.Ze,this.je,n);return this.je=Gu(),this.He=ix(),this.Je=ix(),this.Ze=new Tr(li),r}Ye(e,t){if(!this.rt(e))return;const n=this.Et(e,t.key)?2:0;this.nt(e).qe(t.key,n),this.je=this.je.insert(t.key,t),this.He=this.He.insert(t.key,this.It(t.key).add(e)),this.Je=this.Je.insert(t.key,this.Rt(t.key).add(e))}et(e,t,n){if(!this.rt(e))return;const r=this.nt(e);this.Et(e,t)?r.qe(t,1):r.Ue(t),this.Je=this.Je.insert(t,this.Rt(t).delete(e)),this.Je=this.Je.insert(t,this.Rt(t).add(e)),n&&(this.je=this.je.insert(t,n))}removeTarget(e){this.ze.delete(e)}_t(e){const t=this.nt(e).ke();return this.Ge.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}$e(e){this.nt(e).$e()}nt(e){let t=this.ze.get(e);return t||(t=new QR,this.ze.set(e,t)),t}Rt(e){let t=this.Je.get(e);return t||(t=new as(li),this.Je=this.Je.insert(e,t)),t}It(e){let t=this.He.get(e);return t||(t=new as(li),this.He=this.He.insert(e,t)),t}rt(e){const t=this.ot(e)!==null;return t||$t("WatchChangeAggregator","Detected inactive target",e),t}ot(e){const t=this.ze.get(e);return t&&t.Ne?null:this.Ge.At(e)}it(e){this.ze.set(e,new QR),this.Ge.getRemoteKeysForTarget(e).forEach((t=>{this.et(e,t,null)}))}Et(e,t){return this.Ge.getRemoteKeysForTarget(e).has(t)}}function ix(){return new Tr(dn.comparator)}function ZR(){return new Tr(dn.comparator)}const MV={asc:"ASCENDING",desc:"DESCENDING"},wV={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},CV={and:"AND",or:"OR"};class RV{constructor(e,t){this.databaseId=e,this.useProto3Json=t}}function hT(i,e){return i.useProto3Json||GA(e)?e:{value:e}}function Nb(i,e){return i.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function hP(i,e){return i.useProto3Json?e.toBase64():e.toUint8Array()}function IV(i,e){return Nb(i,e.toTimestamp())}function kc(i){return Ri(!!i,49232),In.fromTimestamp((function(t){const n=ff(t);return new tr(n.seconds,n.nanos)})(i))}function AM(i,e){return fT(i,e).canonicalString()}function fT(i,e){const t=(function(r){return new qi(["projects",r.projectId,"databases",r.database])})(i).child("documents");return e===void 0?t:t.child(e)}function fP(i){const e=qi.fromString(i);return Ri(vP(e),10190,{key:e.toString()}),e}function dT(i,e){return AM(i.databaseId,e.path)}function UE(i,e){const t=fP(e);if(t.get(1)!==i.databaseId.projectId)throw new Kt(nt.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+t.get(1)+" vs "+i.databaseId.projectId);if(t.get(3)!==i.databaseId.database)throw new Kt(nt.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+t.get(3)+" vs "+i.databaseId.database);return new dn(pP(t))}function dP(i,e){return AM(i.databaseId,e)}function DV(i){const e=fP(i);return e.length===4?qi.emptyPath():pP(e)}function pT(i){return new qi(["projects",i.databaseId.projectId,"databases",i.databaseId.database]).canonicalString()}function pP(i){return Ri(i.length>4&&i.get(4)==="documents",29091,{key:i.toString()}),i.popFirst(5)}function $R(i,e,t){return{name:dT(i,e),fields:t.value.mapValue.fields}}function NV(i,e){let t;if("targetChange"in e){e.targetChange;const n=(function(p){return p==="NO_CHANGE"?0:p==="ADD"?1:p==="REMOVE"?2:p==="CURRENT"?3:p==="RESET"?4:Sn(39313,{state:p})})(e.targetChange.targetChangeType||"NO_CHANGE"),r=e.targetChange.targetIds||[],s=(function(p,g){return p.useProto3Json?(Ri(g===void 0||typeof g=="string",58123),Hs.fromBase64String(g||"")):(Ri(g===void 0||g instanceof Buffer||g instanceof Uint8Array,16193),Hs.fromUint8Array(g||new Uint8Array))})(i,e.targetChange.resumeToken),o=e.targetChange.cause,u=o&&(function(p){const g=p.code===void 0?nt.UNKNOWN:lP(p.code);return new Kt(g,p.message||"")})(o);t=new uP(n,r,s,u||null)}else if("documentChange"in e){e.documentChange;const n=e.documentChange;n.document,n.document.name,n.document.updateTime;const r=UE(i,n.document.name),s=kc(n.document.updateTime),o=n.document.createTime?kc(n.document.createTime):In.min(),u=new $a({mapValue:{fields:n.document.fields}}),f=ca.newFoundDocument(r,s,o,u),p=n.targetIds||[],g=n.removedTargetIds||[];t=new ub(p,g,f.key,f)}else if("documentDelete"in e){e.documentDelete;const n=e.documentDelete;n.document;const r=UE(i,n.document),s=n.readTime?kc(n.readTime):In.min(),o=ca.newNoDocument(r,s),u=n.removedTargetIds||[];t=new ub([],u,o.key,o)}else if("documentRemove"in e){e.documentRemove;const n=e.documentRemove;n.document;const r=UE(i,n.document),s=n.removedTargetIds||[];t=new ub([],s,r,null)}else{if(!("filter"in e))return Sn(11601,{Vt:e});{e.filter;const n=e.filter;n.targetId;const{count:r=0,unchangedNames:s}=n,o=new bV(r,s),u=n.targetId;t=new cP(u,o)}}return t}function PV(i,e){let t;if(e instanceof uy)t={update:$R(i,e.key,e.value)};else if(e instanceof _M)t={delete:dT(i,e.key)};else if(e instanceof Sf)t={update:$R(i,e.key,e.data),updateMask:HV(e.fieldMask)};else{if(!(e instanceof yV))return Sn(16599,{dt:e.type});t={verify:dT(i,e.key)}}return e.fieldTransforms.length>0&&(t.updateTransforms=e.fieldTransforms.map((n=>(function(s,o){const u=o.transform;if(u instanceof Ib)return{fieldPath:o.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(u instanceof Hv)return{fieldPath:o.field.canonicalString(),appendMissingElements:{values:u.elements}};if(u instanceof Gv)return{fieldPath:o.field.canonicalString(),removeAllFromArray:{values:u.elements}};if(u instanceof Db)return{fieldPath:o.field.canonicalString(),increment:u.Ae};throw Sn(20930,{transform:o.transform})})(0,n)))),e.precondition.isNone||(t.currentDocument=(function(r,s){return s.updateTime!==void 0?{updateTime:IV(r,s.updateTime)}:s.exists!==void 0?{exists:s.exists}:Sn(27497)})(i,e.precondition)),t}function BV(i,e){return i&&i.length>0?(Ri(e!==void 0,14353),i.map((t=>(function(r,s){let o=r.updateTime?kc(r.updateTime):kc(s);return o.isEqual(In.min())&&(o=kc(s)),new mV(o,r.transformResults||[])})(t,e)))):[]}function LV(i,e){return{documents:[dP(i,e.path)]}}function OV(i,e){const t={structuredQuery:{}},n=e.path;let r;e.collectionGroup!==null?(r=n,t.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(r=n.popLast(),t.structuredQuery.from=[{collectionId:n.lastSegment()}]),t.parent=dP(i,r);const s=(function(p){if(p.length!==0)return gP(Wl.create(p,"and"))})(e.filters);s&&(t.structuredQuery.where=s);const o=(function(p){if(p.length!==0)return p.map((g=>(function(_){return{field:Om(_.field),direction:kV(_.dir)}})(g)))})(e.orderBy);o&&(t.structuredQuery.orderBy=o);const u=hT(i,e.limit);return u!==null&&(t.structuredQuery.limit=u),e.startAt&&(t.structuredQuery.startAt=(function(p){return{before:p.inclusive,values:p.position}})(e.startAt)),e.endAt&&(t.structuredQuery.endAt=(function(p){return{before:!p.inclusive,values:p.position}})(e.endAt)),{ft:t,parent:r}}function UV(i){let e=DV(i.parent);const t=i.structuredQuery,n=t.from?t.from.length:0;let r=null;if(n>0){Ri(n===1,65062);const g=t.from[0];g.allDescendants?r=g.collectionId:e=e.child(g.collectionId)}let s=[];t.where&&(s=(function(v){const _=mP(v);return _ instanceof Wl&&W3(_)?_.getFilters():[_]})(t.where));let o=[];t.orderBy&&(o=(function(v){return v.map((_=>(function(E){return new Vv(Um(E.field),(function(w){switch(w){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}})(E.direction))})(_)))})(t.orderBy));let u=null;t.limit&&(u=(function(v){let _;return _=typeof v=="object"?v.value:v,GA(_)?null:_})(t.limit));let f=null;t.startAt&&(f=(function(v){const _=!!v.before,x=v.values||[];return new Rb(x,_)})(t.startAt));let p=null;return t.endAt&&(p=(function(v){const _=!v.before,x=v.values||[];return new Rb(x,_)})(t.endAt)),eV(e,r,o,s,u,"F",f,p)}function FV(i,e){const t=(function(r){switch(r){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return Sn(28987,{purpose:r})}})(e.purpose);return t==null?null:{"goog-listen-tags":t}}function mP(i){return i.unaryFilter!==void 0?(function(t){switch(t.unaryFilter.op){case"IS_NAN":const n=Um(t.unaryFilter.field);return es.create(n,"==",{doubleValue:NaN});case"IS_NULL":const r=Um(t.unaryFilter.field);return es.create(r,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const s=Um(t.unaryFilter.field);return es.create(s,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const o=Um(t.unaryFilter.field);return es.create(o,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return Sn(61313);default:return Sn(60726)}})(i):i.fieldFilter!==void 0?(function(t){return es.create(Um(t.fieldFilter.field),(function(r){switch(r){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return Sn(58110);default:return Sn(50506)}})(t.fieldFilter.op),t.fieldFilter.value)})(i):i.compositeFilter!==void 0?(function(t){return Wl.create(t.compositeFilter.filters.map((n=>mP(n))),(function(r){switch(r){case"AND":return"and";case"OR":return"or";default:return Sn(1026)}})(t.compositeFilter.op))})(i):Sn(30097,{filter:i})}function kV(i){return MV[i]}function zV(i){return wV[i]}function VV(i){return CV[i]}function Om(i){return{fieldPath:i.canonicalString()}}function Um(i){return ks.fromServerFormat(i.fieldPath)}function gP(i){return i instanceof es?(function(t){if(t.op==="=="){if(zR(t.value))return{unaryFilter:{field:Om(t.field),op:"IS_NAN"}};if(kR(t.value))return{unaryFilter:{field:Om(t.field),op:"IS_NULL"}}}else if(t.op==="!="){if(zR(t.value))return{unaryFilter:{field:Om(t.field),op:"IS_NOT_NAN"}};if(kR(t.value))return{unaryFilter:{field:Om(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Om(t.field),op:zV(t.op),value:t.value}}})(i):i instanceof Wl?(function(t){const n=t.getFilters().map((r=>gP(r)));return n.length===1?n[0]:{compositeFilter:{op:VV(t.op),filters:n}}})(i):Sn(54877,{filter:i})}function HV(i){const e=[];return i.fields.forEach((t=>e.push(t.canonicalString()))),{fieldPaths:e}}function vP(i){return i.length>=4&&i.get(0)==="projects"&&i.get(2)==="databases"}function yP(i){return!!i&&typeof i._toProto=="function"&&i._protoValueType==="ProtoValue"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zh{constructor(e,t,n,r,s=In.min(),o=In.min(),u=Hs.EMPTY_BYTE_STRING,f=null){this.target=e,this.targetId=t,this.purpose=n,this.sequenceNumber=r,this.snapshotVersion=s,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=u,this.expectedCount=f}withSequenceNumber(e){return new Zh(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new Zh(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new Zh(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new Zh(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class GV{constructor(e){this.yt=e}}function jV(i){const e=UV({parent:i.parent,structuredQuery:i.structuredQuery});return i.limitType==="LAST"?uT(e,e.limit,"L"):e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class WV{constructor(){this.Sn=new qV}addToCollectionParentIndex(e,t){return this.Sn.add(t),ct.resolve()}getCollectionParents(e,t){return ct.resolve(this.Sn.getEntries(t))}addFieldIndex(e,t){return ct.resolve()}deleteFieldIndex(e,t){return ct.resolve()}deleteAllFieldIndexes(e){return ct.resolve()}createTargetIndexes(e,t){return ct.resolve()}getDocumentsMatchingTarget(e,t){return ct.resolve(null)}getIndexType(e,t){return ct.resolve(0)}getFieldIndexes(e,t){return ct.resolve([])}getNextCollectionGroupToUpdate(e){return ct.resolve(null)}getMinOffset(e,t){return ct.resolve(hf.min())}getMinOffsetFromCollectionGroup(e,t){return ct.resolve(hf.min())}updateCollectionGroup(e,t,n){return ct.resolve()}updateIndexEntries(e,t){return ct.resolve()}}class qV{constructor(){this.index={}}add(e){const t=e.lastSegment(),n=e.popLast(),r=this.index[t]||new as(qi.comparator),s=!r.has(n);return this.index[t]=r.add(n),s}has(e){const t=e.lastSegment(),n=e.popLast(),r=this.index[t];return r&&r.has(n)}getEntries(e){return(this.index[e]||new as(qi.comparator)).toArray()}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const eI={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},_P=41943040;class Za{static withCacheSize(e){return new Za(e,Za.DEFAULT_COLLECTION_PERCENTILE,Za.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,t,n){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Za.DEFAULT_COLLECTION_PERCENTILE=10,Za.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,Za.DEFAULT=new Za(_P,Za.DEFAULT_COLLECTION_PERCENTILE,Za.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),Za.DISABLED=new Za(-1,0,0);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ng{constructor(e){this.sr=e}next(){return this.sr+=2,this.sr}static _r(){return new ng(0)}static ar(){return new ng(-1)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const tI="LruGarbageCollector",XV=1048576;function nI([i,e],[t,n]){const r=li(i,t);return r===0?li(e,n):r}class YV{constructor(e){this.Pr=e,this.buffer=new as(nI),this.Tr=0}Ir(){return++this.Tr}Er(e){const t=[e,this.Ir()];if(this.buffer.size<this.Pr)this.buffer=this.buffer.add(t);else{const n=this.buffer.last();nI(t,n)<0&&(this.buffer=this.buffer.delete(n).add(t))}}get maxValue(){return this.buffer.last()[0]}}class JV{constructor(e,t,n){this.garbageCollector=e,this.asyncQueue=t,this.localStore=n,this.Rr=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Ar(6e4)}stop(){this.Rr&&(this.Rr.cancel(),this.Rr=null)}get started(){return this.Rr!==null}Ar(e){$t(tI,`Garbage collection scheduled in ${e}ms`),this.Rr=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,(async()=>{this.Rr=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(t){Sg(t)?$t(tI,"Ignoring IndexedDB error during garbage collection: ",t):await Ag(t)}await this.Ar(3e5)}))}}class KV{constructor(e,t){this.Vr=e,this.params=t}calculateTargetCount(e,t){return this.Vr.dr(e).next((n=>Math.floor(t/100*n)))}nthSequenceNumber(e,t){if(t===0)return ct.resolve(HA.ce);const n=new YV(t);return this.Vr.forEachTarget(e,(r=>n.Er(r.sequenceNumber))).next((()=>this.Vr.mr(e,(r=>n.Er(r))))).next((()=>n.maxValue))}removeTargets(e,t,n){return this.Vr.removeTargets(e,t,n)}removeOrphanedDocuments(e,t){return this.Vr.removeOrphanedDocuments(e,t)}collect(e,t){return this.params.cacheSizeCollectionThreshold===-1?($t("LruGarbageCollector","Garbage collection skipped; disabled"),ct.resolve(eI)):this.getCacheSize(e).next((n=>n<this.params.cacheSizeCollectionThreshold?($t("LruGarbageCollector",`Garbage collection skipped; Cache size ${n} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),eI):this.gr(e,t)))}getCacheSize(e){return this.Vr.getCacheSize(e)}gr(e,t){let n,r,s,o,u,f,p;const g=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next((v=>(v>this.params.maximumSequenceNumbersToCollect?($t("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${v}`),r=this.params.maximumSequenceNumbersToCollect):r=v,o=Date.now(),this.nthSequenceNumber(e,r)))).next((v=>(n=v,u=Date.now(),this.removeTargets(e,n,t)))).next((v=>(s=v,f=Date.now(),this.removeOrphanedDocuments(e,n)))).next((v=>(p=Date.now(),Bm()<=ai.DEBUG&&$t("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${o-g}ms
	Determined least recently used ${r} in `+(u-o)+`ms
	Removed ${s} targets in `+(f-u)+`ms
	Removed ${v} documents in `+(p-f)+`ms
Total Duration: ${p-g}ms`),ct.resolve({didRun:!0,sequenceNumbersCollected:r,targetsRemoved:s,documentsRemoved:v}))))}}function QV(i,e){return new KV(i,e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ZV{constructor(){this.changes=new op((e=>e.toString()),((e,t)=>e.isEqual(t))),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,ca.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();const n=this.changes.get(t);return n!==void 0?ct.resolve(n):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $V{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class e6{constructor(e,t,n,r){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=n,this.indexManager=r}getDocument(e,t){let n=null;return this.documentOverlayCache.getOverlay(e,t).next((r=>(n=r,this.remoteDocumentCache.getEntry(e,t)))).next((r=>(n!==null&&Ev(n.mutation,r,_o.empty(),tr.now()),r)))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next((n=>this.getLocalViewOfDocuments(e,n,ci()).next((()=>n))))}getLocalViewOfDocuments(e,t,n=ci()){const r=Dd();return this.populateOverlays(e,r,t).next((()=>this.computeViews(e,t,r,n).next((s=>{let o=dv();return s.forEach(((u,f)=>{o=o.insert(u,f.overlayedDocument)})),o}))))}getOverlayedDocuments(e,t){const n=Dd();return this.populateOverlays(e,n,t).next((()=>this.computeViews(e,t,n,ci())))}populateOverlays(e,t,n){const r=[];return n.forEach((s=>{t.has(s)||r.push(s)})),this.documentOverlayCache.getOverlays(e,r).next((s=>{s.forEach(((o,u)=>{t.set(o,u)}))}))}computeViews(e,t,n,r){let s=Gu();const o=Sv(),u=(function(){return Sv()})();return t.forEach(((f,p)=>{const g=n.get(p.key);r.has(p.key)&&(g===void 0||g.mutation instanceof Sf)?s=s.insert(p.key,p):g!==void 0?(o.set(p.key,g.mutation.getFieldMask()),Ev(g.mutation,p,g.mutation.getFieldMask(),tr.now())):o.set(p.key,_o.empty())})),this.recalculateAndSaveOverlays(e,s).next((f=>(f.forEach(((p,g)=>o.set(p,g))),t.forEach(((p,g)=>u.set(p,new $V(g,o.get(p)??null)))),u)))}recalculateAndSaveOverlays(e,t){const n=Sv();let r=new Tr(((o,u)=>o-u)),s=ci();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next((o=>{for(const u of o)u.keys().forEach((f=>{const p=t.get(f);if(p===null)return;let g=n.get(f)||_o.empty();g=u.applyToLocalView(p,g),n.set(f,g);const v=(r.get(u.batchId)||ci()).add(f);r=r.insert(u.batchId,v)}))})).next((()=>{const o=[],u=r.getReverseIterator();for(;u.hasNext();){const f=u.getNext(),p=f.key,g=f.value,v=eP();g.forEach((_=>{if(!s.has(_)){const x=aP(t.get(_),n.get(_));x!==null&&v.set(_,x),s=s.add(_)}})),o.push(this.documentOverlayCache.saveOverlays(e,p,v))}return ct.waitFor(o)})).next((()=>n))}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next((n=>this.recalculateAndSaveOverlays(e,n)))}getDocumentsMatchingQuery(e,t,n,r){return tV(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):J3(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,n,r):this.getDocumentsMatchingCollectionQuery(e,t,n,r)}getNextDocuments(e,t,n,r){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,n,r).next((s=>{const o=r-s.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,n.largestBatchId,r-s.size):ct.resolve(Dd());let u=Uv,f=s;return o.next((p=>ct.forEach(p,((g,v)=>(u<v.largestBatchId&&(u=v.largestBatchId),s.get(g)?ct.resolve():this.remoteDocumentCache.getEntry(e,g).next((_=>{f=f.insert(g,_)}))))).next((()=>this.populateOverlays(e,p,s))).next((()=>this.computeViews(e,f,p,ci()))).next((g=>({batchId:u,changes:$3(g)})))))}))}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new dn(t)).next((n=>{let r=dv();return n.isFoundDocument()&&(r=r.insert(n.key,n)),r}))}getDocumentsMatchingCollectionGroupQuery(e,t,n,r){const s=t.collectionGroup;let o=dv();return this.indexManager.getCollectionParents(e,s).next((u=>ct.forEach(u,(f=>{const p=(function(v,_){return new Eg(_,null,v.explicitOrderBy.slice(),v.filters.slice(),v.limit,v.limitType,v.startAt,v.endAt)})(t,f.child(s));return this.getDocumentsMatchingCollectionQuery(e,p,n,r).next((g=>{g.forEach(((v,_)=>{o=o.insert(v,_)}))}))})).next((()=>o))))}getDocumentsMatchingCollectionQuery(e,t,n,r){let s;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,n.largestBatchId).next((o=>(s=o,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,n,s,r)))).next((o=>{s.forEach(((f,p)=>{const g=p.getKey();o.get(g)===null&&(o=o.insert(g,ca.newInvalidDocument(g)))}));let u=dv();return o.forEach(((f,p)=>{const g=s.get(f);g!==void 0&&Ev(g.mutation,p,_o.empty(),tr.now()),qA(t,p)&&(u=u.insert(f,p))})),u}))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class t6{constructor(e){this.serializer=e,this.Nr=new Map,this.Br=new Map}getBundleMetadata(e,t){return ct.resolve(this.Nr.get(t))}saveBundleMetadata(e,t){return this.Nr.set(t.id,(function(r){return{id:r.id,version:r.version,createTime:kc(r.createTime)}})(t)),ct.resolve()}getNamedQuery(e,t){return ct.resolve(this.Br.get(t))}saveNamedQuery(e,t){return this.Br.set(t.name,(function(r){return{name:r.name,query:jV(r.bundledQuery),readTime:kc(r.readTime)}})(t)),ct.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class n6{constructor(){this.overlays=new Tr(dn.comparator),this.Lr=new Map}getOverlay(e,t){return ct.resolve(this.overlays.get(t))}getOverlays(e,t){const n=Dd();return ct.forEach(t,(r=>this.getOverlay(e,r).next((s=>{s!==null&&n.set(r,s)})))).next((()=>n))}saveOverlays(e,t,n){return n.forEach(((r,s)=>{this.bt(e,t,s)})),ct.resolve()}removeOverlaysForBatchId(e,t,n){const r=this.Lr.get(n);return r!==void 0&&(r.forEach((s=>this.overlays=this.overlays.remove(s))),this.Lr.delete(n)),ct.resolve()}getOverlaysForCollection(e,t,n){const r=Dd(),s=t.length+1,o=new dn(t.child("")),u=this.overlays.getIteratorFrom(o);for(;u.hasNext();){const f=u.getNext().value,p=f.getKey();if(!t.isPrefixOf(p.path))break;p.path.length===s&&f.largestBatchId>n&&r.set(f.getKey(),f)}return ct.resolve(r)}getOverlaysForCollectionGroup(e,t,n,r){let s=new Tr(((p,g)=>p-g));const o=this.overlays.getIterator();for(;o.hasNext();){const p=o.getNext().value;if(p.getKey().getCollectionGroup()===t&&p.largestBatchId>n){let g=s.get(p.largestBatchId);g===null&&(g=Dd(),s=s.insert(p.largestBatchId,g)),g.set(p.getKey(),p)}}const u=Dd(),f=s.getIterator();for(;f.hasNext()&&(f.getNext().value.forEach(((p,g)=>u.set(p,g))),!(u.size()>=r)););return ct.resolve(u)}bt(e,t,n){const r=this.overlays.get(n.key);if(r!==null){const o=this.Lr.get(r.largestBatchId).delete(n.key);this.Lr.set(r.largestBatchId,o)}this.overlays=this.overlays.insert(n.key,new xV(t,n));let s=this.Lr.get(t);s===void 0&&(s=ci(),this.Lr.set(t,s)),this.Lr.set(t,s.add(n.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class i6{constructor(){this.sessionToken=Hs.EMPTY_BYTE_STRING}getSessionToken(e){return ct.resolve(this.sessionToken)}setSessionToken(e,t){return this.sessionToken=t,ct.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class SM{constructor(){this.kr=new as(gs.Kr),this.qr=new as(gs.Ur)}isEmpty(){return this.kr.isEmpty()}addReference(e,t){const n=new gs(e,t);this.kr=this.kr.add(n),this.qr=this.qr.add(n)}$r(e,t){e.forEach((n=>this.addReference(n,t)))}removeReference(e,t){this.Wr(new gs(e,t))}Qr(e,t){e.forEach((n=>this.removeReference(n,t)))}Gr(e){const t=new dn(new qi([])),n=new gs(t,e),r=new gs(t,e+1),s=[];return this.qr.forEachInRange([n,r],(o=>{this.Wr(o),s.push(o.key)})),s}zr(){this.kr.forEach((e=>this.Wr(e)))}Wr(e){this.kr=this.kr.delete(e),this.qr=this.qr.delete(e)}jr(e){const t=new dn(new qi([])),n=new gs(t,e),r=new gs(t,e+1);let s=ci();return this.qr.forEachInRange([n,r],(o=>{s=s.add(o.key)})),s}containsKey(e){const t=new gs(e,0),n=this.kr.firstAfterOrEqual(t);return n!==null&&e.isEqual(n.key)}}class gs{constructor(e,t){this.key=e,this.Hr=t}static Kr(e,t){return dn.comparator(e.key,t.key)||li(e.Hr,t.Hr)}static Ur(e,t){return li(e.Hr,t.Hr)||dn.comparator(e.key,t.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class r6{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.Yn=1,this.Jr=new as(gs.Kr)}checkEmpty(e){return ct.resolve(this.mutationQueue.length===0)}addMutationBatch(e,t,n,r){const s=this.Yn;this.Yn++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const o=new _V(s,t,n,r);this.mutationQueue.push(o);for(const u of r)this.Jr=this.Jr.add(new gs(u.key,s)),this.indexManager.addToCollectionParentIndex(e,u.key.path.popLast());return ct.resolve(o)}lookupMutationBatch(e,t){return ct.resolve(this.Zr(t))}getNextMutationBatchAfterBatchId(e,t){const n=t+1,r=this.Xr(n),s=r<0?0:r;return ct.resolve(this.mutationQueue.length>s?this.mutationQueue[s]:null)}getHighestUnacknowledgedBatchId(){return ct.resolve(this.mutationQueue.length===0?fM:this.Yn-1)}getAllMutationBatches(e){return ct.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){const n=new gs(t,0),r=new gs(t,Number.POSITIVE_INFINITY),s=[];return this.Jr.forEachInRange([n,r],(o=>{const u=this.Zr(o.Hr);s.push(u)})),ct.resolve(s)}getAllMutationBatchesAffectingDocumentKeys(e,t){let n=new as(li);return t.forEach((r=>{const s=new gs(r,0),o=new gs(r,Number.POSITIVE_INFINITY);this.Jr.forEachInRange([s,o],(u=>{n=n.add(u.Hr)}))})),ct.resolve(this.Yr(n))}getAllMutationBatchesAffectingQuery(e,t){const n=t.path,r=n.length+1;let s=n;dn.isDocumentKey(s)||(s=s.child(""));const o=new gs(new dn(s),0);let u=new as(li);return this.Jr.forEachWhile((f=>{const p=f.key.path;return!!n.isPrefixOf(p)&&(p.length===r&&(u=u.add(f.Hr)),!0)}),o),ct.resolve(this.Yr(u))}Yr(e){const t=[];return e.forEach((n=>{const r=this.Zr(n);r!==null&&t.push(r)})),t}removeMutationBatch(e,t){Ri(this.ei(t.batchId,"removed")===0,55003),this.mutationQueue.shift();let n=this.Jr;return ct.forEach(t.mutations,(r=>{const s=new gs(r.key,t.batchId);return n=n.delete(s),this.referenceDelegate.markPotentiallyOrphaned(e,r.key)})).next((()=>{this.Jr=n}))}nr(e){}containsKey(e,t){const n=new gs(t,0),r=this.Jr.firstAfterOrEqual(n);return ct.resolve(t.isEqual(r&&r.key))}performConsistencyCheck(e){return this.mutationQueue.length,ct.resolve()}ei(e,t){return this.Xr(e)}Xr(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Zr(e){const t=this.Xr(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class s6{constructor(e){this.ti=e,this.docs=(function(){return new Tr(dn.comparator)})(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){const n=t.key,r=this.docs.get(n),s=r?r.size:0,o=this.ti(t);return this.docs=this.docs.insert(n,{document:t.mutableCopy(),size:o}),this.size+=o-s,this.indexManager.addToCollectionParentIndex(e,n.path.popLast())}removeEntry(e){const t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){const n=this.docs.get(t);return ct.resolve(n?n.document.mutableCopy():ca.newInvalidDocument(t))}getEntries(e,t){let n=Gu();return t.forEach((r=>{const s=this.docs.get(r);n=n.insert(r,s?s.document.mutableCopy():ca.newInvalidDocument(r))})),ct.resolve(n)}getDocumentsMatchingQuery(e,t,n,r){let s=Gu();const o=t.path,u=new dn(o.child("__id-9223372036854775808__")),f=this.docs.getIteratorFrom(u);for(;f.hasNext();){const{key:p,value:{document:g}}=f.getNext();if(!o.isPrefixOf(p.path))break;p.path.length>o.length+1||Dz(Iz(g),n)<=0||(r.has(g.key)||qA(t,g))&&(s=s.insert(g.key,g.mutableCopy()))}return ct.resolve(s)}getAllFromCollectionGroup(e,t,n,r){Sn(9500)}ni(e,t){return ct.forEach(this.docs,(n=>t(n)))}newChangeBuffer(e){return new a6(this)}getSize(e){return ct.resolve(this.size)}}class a6 extends ZV{constructor(e){super(),this.Mr=e}applyChanges(e){const t=[];return this.changes.forEach(((n,r)=>{r.isValidDocument()?t.push(this.Mr.addEntry(e,r)):this.Mr.removeEntry(n)})),ct.waitFor(t)}getFromCache(e,t){return this.Mr.getEntry(e,t)}getAllFromCache(e,t){return this.Mr.getEntries(e,t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class o6{constructor(e){this.persistence=e,this.ri=new op((t=>mM(t)),gM),this.lastRemoteSnapshotVersion=In.min(),this.highestTargetId=0,this.ii=0,this.si=new SM,this.targetCount=0,this.oi=ng._r()}forEachTarget(e,t){return this.ri.forEach(((n,r)=>t(r))),ct.resolve()}getLastRemoteSnapshotVersion(e){return ct.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return ct.resolve(this.ii)}allocateTargetId(e){return this.highestTargetId=this.oi.next(),ct.resolve(this.highestTargetId)}setTargetsMetadata(e,t,n){return n&&(this.lastRemoteSnapshotVersion=n),t>this.ii&&(this.ii=t),ct.resolve()}lr(e){this.ri.set(e.target,e);const t=e.targetId;t>this.highestTargetId&&(this.oi=new ng(t),this.highestTargetId=t),e.sequenceNumber>this.ii&&(this.ii=e.sequenceNumber)}addTargetData(e,t){return this.lr(t),this.targetCount+=1,ct.resolve()}updateTargetData(e,t){return this.lr(t),ct.resolve()}removeTargetData(e,t){return this.ri.delete(t.target),this.si.Gr(t.targetId),this.targetCount-=1,ct.resolve()}removeTargets(e,t,n){let r=0;const s=[];return this.ri.forEach(((o,u)=>{u.sequenceNumber<=t&&n.get(u.targetId)===null&&(this.ri.delete(o),s.push(this.removeMatchingKeysForTargetId(e,u.targetId)),r++)})),ct.waitFor(s).next((()=>r))}getTargetCount(e){return ct.resolve(this.targetCount)}getTargetData(e,t){const n=this.ri.get(t)||null;return ct.resolve(n)}addMatchingKeys(e,t,n){return this.si.$r(t,n),ct.resolve()}removeMatchingKeys(e,t,n){this.si.Qr(t,n);const r=this.persistence.referenceDelegate,s=[];return r&&t.forEach((o=>{s.push(r.markPotentiallyOrphaned(e,o))})),ct.waitFor(s)}removeMatchingKeysForTargetId(e,t){return this.si.Gr(t),ct.resolve()}getMatchingKeysForTargetId(e,t){const n=this.si.jr(t);return ct.resolve(n)}containsKey(e,t){return ct.resolve(this.si.containsKey(t))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xP{constructor(e,t){this._i={},this.overlays={},this.ai=new HA(0),this.ui=!1,this.ui=!0,this.ci=new i6,this.referenceDelegate=e(this),this.li=new o6(this),this.indexManager=new WV,this.remoteDocumentCache=(function(r){return new s6(r)})((n=>this.referenceDelegate.hi(n))),this.serializer=new GV(t),this.Pi=new t6(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.ui=!1,Promise.resolve()}get started(){return this.ui}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new n6,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let n=this._i[e.toKey()];return n||(n=new r6(t,this.referenceDelegate),this._i[e.toKey()]=n),n}getGlobalsCache(){return this.ci}getTargetCache(){return this.li}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Pi}runTransaction(e,t,n){$t("MemoryPersistence","Starting transaction:",e);const r=new l6(this.ai.next());return this.referenceDelegate.Ti(),n(r).next((s=>this.referenceDelegate.Ii(r).next((()=>s)))).toPromise().then((s=>(r.raiseOnCommittedEvent(),s)))}Ei(e,t){return ct.or(Object.values(this._i).map((n=>()=>n.containsKey(e,t))))}}class l6 extends Pz{constructor(e){super(),this.currentSequenceNumber=e}}class EM{constructor(e){this.persistence=e,this.Ri=new SM,this.Ai=null}static Vi(e){return new EM(e)}get di(){if(this.Ai)return this.Ai;throw Sn(60996)}addReference(e,t,n){return this.Ri.addReference(n,t),this.di.delete(n.toString()),ct.resolve()}removeReference(e,t,n){return this.Ri.removeReference(n,t),this.di.add(n.toString()),ct.resolve()}markPotentiallyOrphaned(e,t){return this.di.add(t.toString()),ct.resolve()}removeTarget(e,t){this.Ri.Gr(t.targetId).forEach((r=>this.di.add(r.toString())));const n=this.persistence.getTargetCache();return n.getMatchingKeysForTargetId(e,t.targetId).next((r=>{r.forEach((s=>this.di.add(s.toString())))})).next((()=>n.removeTargetData(e,t)))}Ti(){this.Ai=new Set}Ii(e){const t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return ct.forEach(this.di,(n=>{const r=dn.fromPath(n);return this.mi(e,r).next((s=>{s||t.removeEntry(r,In.min())}))})).next((()=>(this.Ai=null,t.apply(e))))}updateLimboDocument(e,t){return this.mi(e,t).next((n=>{n?this.di.delete(t.toString()):this.di.add(t.toString())}))}hi(e){return 0}mi(e,t){return ct.or([()=>ct.resolve(this.Ri.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Ei(e,t)])}}class Pb{constructor(e,t){this.persistence=e,this.fi=new op((n=>Oz(n.path)),((n,r)=>n.isEqual(r))),this.garbageCollector=QV(this,t)}static Vi(e,t){return new Pb(e,t)}Ti(){}Ii(e){return ct.resolve()}forEachTarget(e,t){return this.persistence.getTargetCache().forEachTarget(e,t)}dr(e){const t=this.pr(e);return this.persistence.getTargetCache().getTargetCount(e).next((n=>t.next((r=>n+r))))}pr(e){let t=0;return this.mr(e,(n=>{t++})).next((()=>t))}mr(e,t){return ct.forEach(this.fi,((n,r)=>this.wr(e,n,r).next((s=>s?ct.resolve():t(r)))))}removeTargets(e,t,n){return this.persistence.getTargetCache().removeTargets(e,t,n)}removeOrphanedDocuments(e,t){let n=0;const r=this.persistence.getRemoteDocumentCache(),s=r.newChangeBuffer();return r.ni(e,(o=>this.wr(e,o,t).next((u=>{u||(n++,s.removeEntry(o,In.min()))})))).next((()=>s.apply(e))).next((()=>n))}markPotentiallyOrphaned(e,t){return this.fi.set(t,e.currentSequenceNumber),ct.resolve()}removeTarget(e,t){const n=t.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,n)}addReference(e,t,n){return this.fi.set(n,e.currentSequenceNumber),ct.resolve()}removeReference(e,t,n){return this.fi.set(n,e.currentSequenceNumber),ct.resolve()}updateLimboDocument(e,t){return this.fi.set(t,e.currentSequenceNumber),ct.resolve()}hi(e){let t=e.key.toString().length;return e.isFoundDocument()&&(t+=ob(e.data.value)),t}wr(e,t,n){return ct.or([()=>this.persistence.Ei(e,t),()=>this.persistence.getTargetCache().containsKey(e,t),()=>{const r=this.fi.get(t);return ct.resolve(r!==void 0&&r>n)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class TM{constructor(e,t,n,r){this.targetId=e,this.fromCache=t,this.Ts=n,this.Is=r}static Es(e,t){let n=ci(),r=ci();for(const s of t.docChanges)switch(s.type){case 0:n=n.add(s.doc.key);break;case 1:r=r.add(s.doc.key)}return new TM(e,t.fromCache,n,r)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class c6{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class u6{constructor(){this.Rs=!1,this.As=!1,this.Vs=100,this.ds=(function(){return KU()?8:Bz(ua())>0?6:4})()}initialize(e,t){this.fs=e,this.indexManager=t,this.Rs=!0}getDocumentsMatchingQuery(e,t,n,r){const s={result:null};return this.gs(e,t).next((o=>{s.result=o})).next((()=>{if(!s.result)return this.ps(e,t,r,n).next((o=>{s.result=o}))})).next((()=>{if(s.result)return;const o=new c6;return this.ys(e,t,o).next((u=>{if(s.result=u,this.As)return this.ws(e,t,o,u.size)}))})).next((()=>s.result))}ws(e,t,n,r){return n.documentReadCount<this.Vs?(Bm()<=ai.DEBUG&&$t("QueryEngine","SDK will not create cache indexes for query:",Lm(t),"since it only creates cache indexes for collection contains","more than or equal to",this.Vs,"documents"),ct.resolve()):(Bm()<=ai.DEBUG&&$t("QueryEngine","Query:",Lm(t),"scans",n.documentReadCount,"local documents and returns",r,"documents as results."),n.documentReadCount>this.ds*r?(Bm()<=ai.DEBUG&&$t("QueryEngine","The SDK decides to create cache indexes for query:",Lm(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,Fc(t))):ct.resolve())}gs(e,t){if(jR(t))return ct.resolve(null);let n=Fc(t);return this.indexManager.getIndexType(e,n).next((r=>r===0?null:(t.limit!==null&&r===1&&(t=uT(t,null,"F"),n=Fc(t)),this.indexManager.getDocumentsMatchingTarget(e,n).next((s=>{const o=ci(...s);return this.fs.getDocuments(e,o).next((u=>this.indexManager.getMinOffset(e,n).next((f=>{const p=this.bs(t,u);return this.Ss(t,p,o,f.readTime)?this.gs(e,uT(t,null,"F")):this.Ds(e,p,t,f)}))))})))))}ps(e,t,n,r){return jR(t)||r.isEqual(In.min())?ct.resolve(null):this.fs.getDocuments(e,n).next((s=>{const o=this.bs(t,s);return this.Ss(t,o,n,r)?ct.resolve(null):(Bm()<=ai.DEBUG&&$t("QueryEngine","Re-using previous result from %s to execute query: %s",r.toString(),Lm(t)),this.Ds(e,o,t,Rz(r,Uv)).next((u=>u)))}))}bs(e,t){let n=new as(Q3(e));return t.forEach(((r,s)=>{qA(e,s)&&(n=n.add(s))})),n}Ss(e,t,n,r){if(e.limit===null)return!1;if(n.size!==t.size)return!0;const s=e.limitType==="F"?t.last():t.first();return!!s&&(s.hasPendingWrites||s.version.compareTo(r)>0)}ys(e,t,n){return Bm()<=ai.DEBUG&&$t("QueryEngine","Using full collection scan to execute query:",Lm(t)),this.fs.getDocumentsMatchingQuery(e,t,hf.min(),n)}Ds(e,t,n,r){return this.fs.getDocumentsMatchingQuery(e,n,r).next((s=>(t.forEach((o=>{s=s.insert(o.key,o)})),s)))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const MM="LocalStore",h6=3e8;class f6{constructor(e,t,n,r){this.persistence=e,this.Cs=t,this.serializer=r,this.vs=new Tr(li),this.Fs=new op((s=>mM(s)),gM),this.Ms=new Map,this.xs=e.getRemoteDocumentCache(),this.li=e.getTargetCache(),this.Pi=e.getBundleCache(),this.Os(n)}Os(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new e6(this.xs,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.xs.setIndexManager(this.indexManager),this.Cs.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",(t=>e.collect(t,this.vs)))}}function d6(i,e,t,n){return new f6(i,e,t,n)}async function bP(i,e){const t=Bn(i);return await t.persistence.runTransaction("Handle user change","readonly",(n=>{let r;return t.mutationQueue.getAllMutationBatches(n).next((s=>(r=s,t.Os(e),t.mutationQueue.getAllMutationBatches(n)))).next((s=>{const o=[],u=[];let f=ci();for(const p of r){o.push(p.batchId);for(const g of p.mutations)f=f.add(g.key)}for(const p of s){u.push(p.batchId);for(const g of p.mutations)f=f.add(g.key)}return t.localDocuments.getDocuments(n,f).next((p=>({Ns:p,removedBatchIds:o,addedBatchIds:u})))}))}))}function p6(i,e){const t=Bn(i);return t.persistence.runTransaction("Acknowledge batch","readwrite-primary",(n=>{const r=e.batch.keys(),s=t.xs.newChangeBuffer({trackRemovals:!0});return(function(u,f,p,g){const v=p.batch,_=v.keys();let x=ct.resolve();return _.forEach((E=>{x=x.next((()=>g.getEntry(f,E))).next((C=>{const w=p.docVersions.get(E);Ri(w!==null,48541),C.version.compareTo(w)<0&&(v.applyToRemoteDocument(C,p),C.isValidDocument()&&(C.setReadTime(p.commitVersion),g.addEntry(C)))}))})),x.next((()=>u.mutationQueue.removeMutationBatch(f,v)))})(t,n,e,s).next((()=>s.apply(n))).next((()=>t.mutationQueue.performConsistencyCheck(n))).next((()=>t.documentOverlayCache.removeOverlaysForBatchId(n,r,e.batch.batchId))).next((()=>t.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(n,(function(u){let f=ci();for(let p=0;p<u.mutationResults.length;++p)u.mutationResults[p].transformResults.length>0&&(f=f.add(u.batch.mutations[p].key));return f})(e)))).next((()=>t.localDocuments.getDocuments(n,r)))}))}function AP(i){const e=Bn(i);return e.persistence.runTransaction("Get last remote snapshot version","readonly",(t=>e.li.getLastRemoteSnapshotVersion(t)))}function m6(i,e){const t=Bn(i),n=e.snapshotVersion;let r=t.vs;return t.persistence.runTransaction("Apply remote event","readwrite-primary",(s=>{const o=t.xs.newChangeBuffer({trackRemovals:!0});r=t.vs;const u=[];e.targetChanges.forEach(((g,v)=>{const _=r.get(v);if(!_)return;u.push(t.li.removeMatchingKeys(s,g.removedDocuments,v).next((()=>t.li.addMatchingKeys(s,g.addedDocuments,v))));let x=_.withSequenceNumber(s.currentSequenceNumber);e.targetMismatches.get(v)!==null?x=x.withResumeToken(Hs.EMPTY_BYTE_STRING,In.min()).withLastLimboFreeSnapshotVersion(In.min()):g.resumeToken.approximateByteSize()>0&&(x=x.withResumeToken(g.resumeToken,n)),r=r.insert(v,x),(function(C,w,T){return C.resumeToken.approximateByteSize()===0||w.snapshotVersion.toMicroseconds()-C.snapshotVersion.toMicroseconds()>=h6?!0:T.addedDocuments.size+T.modifiedDocuments.size+T.removedDocuments.size>0})(_,x,g)&&u.push(t.li.updateTargetData(s,x))}));let f=Gu(),p=ci();if(e.documentUpdates.forEach((g=>{e.resolvedLimboDocuments.has(g)&&u.push(t.persistence.referenceDelegate.updateLimboDocument(s,g))})),u.push(g6(s,o,e.documentUpdates).next((g=>{f=g.Bs,p=g.Ls}))),!n.isEqual(In.min())){const g=t.li.getLastRemoteSnapshotVersion(s).next((v=>t.li.setTargetsMetadata(s,s.currentSequenceNumber,n)));u.push(g)}return ct.waitFor(u).next((()=>o.apply(s))).next((()=>t.localDocuments.getLocalViewOfDocuments(s,f,p))).next((()=>f))})).then((s=>(t.vs=r,s)))}function g6(i,e,t){let n=ci(),r=ci();return t.forEach((s=>n=n.add(s))),e.getEntries(i,n).next((s=>{let o=Gu();return t.forEach(((u,f)=>{const p=s.get(u);f.isFoundDocument()!==p.isFoundDocument()&&(r=r.add(u)),f.isNoDocument()&&f.version.isEqual(In.min())?(e.removeEntry(u,f.readTime),o=o.insert(u,f)):!p.isValidDocument()||f.version.compareTo(p.version)>0||f.version.compareTo(p.version)===0&&p.hasPendingWrites?(e.addEntry(f),o=o.insert(u,f)):$t(MM,"Ignoring outdated watch update for ",u,". Current version:",p.version," Watch version:",f.version)})),{Bs:o,Ls:r}}))}function v6(i,e){const t=Bn(i);return t.persistence.runTransaction("Get next mutation batch","readonly",(n=>(e===void 0&&(e=fM),t.mutationQueue.getNextMutationBatchAfterBatchId(n,e))))}function y6(i,e){const t=Bn(i);return t.persistence.runTransaction("Allocate target","readwrite",(n=>{let r;return t.li.getTargetData(n,e).next((s=>s?(r=s,ct.resolve(r)):t.li.allocateTargetId(n).next((o=>(r=new Zh(e,o,"TargetPurposeListen",n.currentSequenceNumber),t.li.addTargetData(n,r).next((()=>r)))))))})).then((n=>{const r=t.vs.get(n.targetId);return(r===null||n.snapshotVersion.compareTo(r.snapshotVersion)>0)&&(t.vs=t.vs.insert(n.targetId,n),t.Fs.set(e,n.targetId)),n}))}async function mT(i,e,t){const n=Bn(i),r=n.vs.get(e),s=t?"readwrite":"readwrite-primary";try{t||await n.persistence.runTransaction("Release target",s,(o=>n.persistence.referenceDelegate.removeTarget(o,r)))}catch(o){if(!Sg(o))throw o;$t(MM,`Failed to update sequence numbers for target ${e}: ${o}`)}n.vs=n.vs.remove(e),n.Fs.delete(r.target)}function iI(i,e,t){const n=Bn(i);let r=In.min(),s=ci();return n.persistence.runTransaction("Execute query","readwrite",(o=>(function(f,p,g){const v=Bn(f),_=v.Fs.get(g);return _!==void 0?ct.resolve(v.vs.get(_)):v.li.getTargetData(p,g)})(n,o,Fc(e)).next((u=>{if(u)return r=u.lastLimboFreeSnapshotVersion,n.li.getMatchingKeysForTargetId(o,u.targetId).next((f=>{s=f}))})).next((()=>n.Cs.getDocumentsMatchingQuery(o,e,t?r:In.min(),t?s:ci()))).next((u=>(_6(n,rV(e),u),{documents:u,ks:s})))))}function _6(i,e,t){let n=i.Ms.get(e)||In.min();t.forEach(((r,s)=>{s.readTime.compareTo(n)>0&&(n=s.readTime)})),i.Ms.set(e,n)}class rI{constructor(){this.activeTargetIds=uV()}Qs(e){this.activeTargetIds=this.activeTargetIds.add(e)}Gs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Ws(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class x6{constructor(){this.vo=new rI,this.Fo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,n){}addLocalQueryTarget(e,t=!0){return t&&this.vo.Qs(e),this.Fo[e]||"not-current"}updateQueryState(e,t,n){this.Fo[e]=t}removeLocalQueryTarget(e){this.vo.Gs(e)}isLocalQueryTarget(e){return this.vo.activeTargetIds.has(e)}clearQueryState(e){delete this.Fo[e]}getAllActiveQueryTargets(){return this.vo.activeTargetIds}isActiveQueryTarget(e){return this.vo.activeTargetIds.has(e)}start(){return this.vo=new rI,Promise.resolve()}handleUserChange(e,t,n){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class b6{Mo(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const sI="ConnectivityMonitor";class aI{constructor(){this.xo=()=>this.Oo(),this.No=()=>this.Bo(),this.Lo=[],this.ko()}Mo(e){this.Lo.push(e)}shutdown(){window.removeEventListener("online",this.xo),window.removeEventListener("offline",this.No)}ko(){window.addEventListener("online",this.xo),window.addEventListener("offline",this.No)}Oo(){$t(sI,"Network connectivity changed: AVAILABLE");for(const e of this.Lo)e(0)}Bo(){$t(sI,"Network connectivity changed: UNAVAILABLE");for(const e of this.Lo)e(1)}static v(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let rx=null;function gT(){return rx===null?rx=(function(){return 268435456+Math.round(2147483648*Math.random())})():rx++,"0x"+rx.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const FE="RestConnection",A6={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery",ExecutePipeline:"executePipeline"};class S6{get Ko(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const t=e.ssl?"https":"http",n=encodeURIComponent(this.databaseId.projectId),r=encodeURIComponent(this.databaseId.database);this.qo=t+"://"+e.host,this.Uo=`projects/${n}/databases/${r}`,this.$o=this.databaseId.database===wb?`project_id=${n}`:`project_id=${n}&database_id=${r}`}Wo(e,t,n,r,s){const o=gT(),u=this.Qo(e,t.toUriEncodedString());$t(FE,`Sending RPC '${e}' ${o}:`,u,n);const f={"google-cloud-resource-prefix":this.Uo,"x-goog-request-params":this.$o};this.Go(f,r,s);const{host:p}=new URL(u),g=yg(p);return this.zo(e,u,f,n,g).then((v=>($t(FE,`Received RPC '${e}' ${o}: `,v),v)),(v=>{throw Zm(FE,`RPC '${e}' ${o} failed with error: `,v,"url: ",u,"request:",n),v}))}jo(e,t,n,r,s,o){return this.Wo(e,t,n,r,s)}Go(e,t,n){e["X-Goog-Api-Client"]=(function(){return"gl-js/ fire/"+bg})(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),t&&t.headers.forEach(((r,s)=>e[s]=r)),n&&n.headers.forEach(((r,s)=>e[s]=r))}Qo(e,t){const n=A6[e];let r=`${this.qo}/v1/${t}:${n}`;return this.databaseInfo.apiKey&&(r=`${r}?key=${encodeURIComponent(this.databaseInfo.apiKey)}`),r}terminate(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class E6{constructor(e){this.Ho=e.Ho,this.Jo=e.Jo}Zo(e){this.Xo=e}Yo(e){this.e_=e}t_(e){this.n_=e}onMessage(e){this.r_=e}close(){this.Jo()}send(e){this.Ho(e)}i_(){this.Xo()}s_(){this.e_()}o_(e){this.n_(e)}__(e){this.r_(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ra="WebChannelConnection",Y0=(i,e,t)=>{i.listen(e,(n=>{try{t(n)}catch(r){setTimeout((()=>{throw r}),0)}}))};class Hm extends S6{constructor(e){super(e),this.a_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}static u_(){if(!Hm.c_){const e=w3();Y0(e,M3.STAT_EVENT,(t=>{t.stat===iT.PROXY?$t(ra,"STAT_EVENT: detected buffering proxy"):t.stat===iT.NOPROXY&&$t(ra,"STAT_EVENT: detected no buffering proxy")})),Hm.c_=!0}}zo(e,t,n,r,s){const o=gT();return new Promise(((u,f)=>{const p=new E3;p.setWithCredentials(!0),p.listenOnce(T3.COMPLETE,(()=>{try{switch(p.getLastErrorCode()){case ab.NO_ERROR:const v=p.getResponseJson();$t(ra,`XHR for RPC '${e}' ${o} received:`,JSON.stringify(v)),u(v);break;case ab.TIMEOUT:$t(ra,`RPC '${e}' ${o} timed out`),f(new Kt(nt.DEADLINE_EXCEEDED,"Request time out"));break;case ab.HTTP_ERROR:const _=p.getStatus();if($t(ra,`RPC '${e}' ${o} failed with status:`,_,"response text:",p.getResponseText()),_>0){let x=p.getResponseJson();Array.isArray(x)&&(x=x[0]);const E=x==null?void 0:x.error;if(E&&E.status&&E.message){const C=(function(T){const N=T.toLowerCase().replace(/_/g,"-");return Object.values(nt).indexOf(N)>=0?N:nt.UNKNOWN})(E.status);f(new Kt(C,E.message))}else f(new Kt(nt.UNKNOWN,"Server responded with status "+p.getStatus()))}else f(new Kt(nt.UNAVAILABLE,"Connection failed."));break;default:Sn(9055,{l_:e,streamId:o,h_:p.getLastErrorCode(),P_:p.getLastError()})}}finally{$t(ra,`RPC '${e}' ${o} completed.`)}}));const g=JSON.stringify(r);$t(ra,`RPC '${e}' ${o} sending request:`,r),p.send(t,"POST",g,n,15)}))}T_(e,t,n){const r=gT(),s=[this.qo,"/","google.firestore.v1.Firestore","/",e,"/channel"],o=this.createWebChannelTransport(),u={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},f=this.longPollingOptions.timeoutSeconds;f!==void 0&&(u.longPollingTimeout=Math.round(1e3*f)),this.useFetchStreams&&(u.useFetchStreams=!0),this.Go(u.initMessageHeaders,t,n),u.encodeInitMessageHeaders=!0;const p=s.join("");$t(ra,`Creating RPC '${e}' stream ${r}: ${p}`,u);const g=o.createWebChannel(p,u);this.I_(g);let v=!1,_=!1;const x=new E6({Ho:E=>{_?$t(ra,`Not sending because RPC '${e}' stream ${r} is closed:`,E):(v||($t(ra,`Opening RPC '${e}' stream ${r} transport.`),g.open(),v=!0),$t(ra,`RPC '${e}' stream ${r} sending:`,E),g.send(E))},Jo:()=>g.close()});return Y0(g,fv.EventType.OPEN,(()=>{_||($t(ra,`RPC '${e}' stream ${r} transport opened.`),x.i_())})),Y0(g,fv.EventType.CLOSE,(()=>{_||(_=!0,$t(ra,`RPC '${e}' stream ${r} transport closed`),x.o_(),this.E_(g))})),Y0(g,fv.EventType.ERROR,(E=>{_||(_=!0,Zm(ra,`RPC '${e}' stream ${r} transport errored. Name:`,E.name,"Message:",E.message),x.o_(new Kt(nt.UNAVAILABLE,"The operation could not be completed")))})),Y0(g,fv.EventType.MESSAGE,(E=>{var C;if(!_){const w=E.data[0];Ri(!!w,16349);const T=w,N=(T==null?void 0:T.error)||((C=T[0])==null?void 0:C.error);if(N){$t(ra,`RPC '${e}' stream ${r} received error:`,N);const L=N.status;let F=(function(O){const D=$r[O];if(D!==void 0)return lP(D)})(L),G=N.message;F===void 0&&(F=nt.INTERNAL,G="Unknown error status: "+L+" with message "+N.message),_=!0,x.o_(new Kt(F,G)),g.close()}else $t(ra,`RPC '${e}' stream ${r} received:`,w),x.__(w)}})),Hm.u_(),setTimeout((()=>{x.s_()}),0),x}terminate(){this.a_.forEach((e=>e.close())),this.a_=[]}I_(e){this.a_.push(e)}E_(e){this.a_=this.a_.filter((t=>t===e))}Go(e,t,n){super.Go(e,t,n),this.databaseInfo.apiKey&&(e["x-goog-api-key"]=this.databaseInfo.apiKey)}createWebChannelTransport(){return C3()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function T6(i){return new Hm(i)}function kE(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function KA(i){return new RV(i,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Hm.c_=!1;class SP{constructor(e,t,n=1e3,r=1.5,s=6e4){this.Ci=e,this.timerId=t,this.R_=n,this.A_=r,this.V_=s,this.d_=0,this.m_=null,this.f_=Date.now(),this.reset()}reset(){this.d_=0}g_(){this.d_=this.V_}p_(e){this.cancel();const t=Math.floor(this.d_+this.y_()),n=Math.max(0,Date.now()-this.f_),r=Math.max(0,t-n);r>0&&$t("ExponentialBackoff",`Backing off for ${r} ms (base delay: ${this.d_} ms, delay with jitter: ${t} ms, last attempt: ${n} ms ago)`),this.m_=this.Ci.enqueueAfterDelay(this.timerId,r,(()=>(this.f_=Date.now(),e()))),this.d_*=this.A_,this.d_<this.R_&&(this.d_=this.R_),this.d_>this.V_&&(this.d_=this.V_)}w_(){this.m_!==null&&(this.m_.skipDelay(),this.m_=null)}cancel(){this.m_!==null&&(this.m_.cancel(),this.m_=null)}y_(){return(Math.random()-.5)*this.d_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const oI="PersistentStream";class EP{constructor(e,t,n,r,s,o,u,f){this.Ci=e,this.b_=n,this.S_=r,this.connection=s,this.authCredentialsProvider=o,this.appCheckCredentialsProvider=u,this.listener=f,this.state=0,this.D_=0,this.C_=null,this.v_=null,this.stream=null,this.F_=0,this.M_=new SP(e,t)}x_(){return this.state===1||this.state===5||this.O_()}O_(){return this.state===2||this.state===3}start(){this.F_=0,this.state!==4?this.auth():this.N_()}async stop(){this.x_()&&await this.close(0)}B_(){this.state=0,this.M_.reset()}L_(){this.O_()&&this.C_===null&&(this.C_=this.Ci.enqueueAfterDelay(this.b_,6e4,(()=>this.k_())))}K_(e){this.q_(),this.stream.send(e)}async k_(){if(this.O_())return this.close(0)}q_(){this.C_&&(this.C_.cancel(),this.C_=null)}U_(){this.v_&&(this.v_.cancel(),this.v_=null)}async close(e,t){this.q_(),this.U_(),this.M_.cancel(),this.D_++,e!==4?this.M_.reset():t&&t.code===nt.RESOURCE_EXHAUSTED?(Hu(t.toString()),Hu("Using maximum backoff delay to prevent overloading the backend."),this.M_.g_()):t&&t.code===nt.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.W_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.t_(t)}W_(){}auth(){this.state=1;const e=this.Q_(this.D_),t=this.D_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then((([n,r])=>{this.D_===t&&this.G_(n,r)}),(n=>{e((()=>{const r=new Kt(nt.UNKNOWN,"Fetching auth token failed: "+n.message);return this.z_(r)}))}))}G_(e,t){const n=this.Q_(this.D_);this.stream=this.j_(e,t),this.stream.Zo((()=>{n((()=>this.listener.Zo()))})),this.stream.Yo((()=>{n((()=>(this.state=2,this.v_=this.Ci.enqueueAfterDelay(this.S_,1e4,(()=>(this.O_()&&(this.state=3),Promise.resolve()))),this.listener.Yo())))})),this.stream.t_((r=>{n((()=>this.z_(r)))})),this.stream.onMessage((r=>{n((()=>++this.F_==1?this.H_(r):this.onNext(r)))}))}N_(){this.state=5,this.M_.p_((async()=>{this.state=0,this.start()}))}z_(e){return $t(oI,`close with error: ${e}`),this.stream=null,this.close(4,e)}Q_(e){return t=>{this.Ci.enqueueAndForget((()=>this.D_===e?t():($t(oI,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())))}}}class M6 extends EP{constructor(e,t,n,r,s,o){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,n,r,o),this.serializer=s}j_(e,t){return this.connection.T_("Listen",e,t)}H_(e){return this.onNext(e)}onNext(e){this.M_.reset();const t=NV(this.serializer,e),n=(function(s){if(!("targetChange"in s))return In.min();const o=s.targetChange;return o.targetIds&&o.targetIds.length?In.min():o.readTime?kc(o.readTime):In.min()})(e);return this.listener.J_(t,n)}Z_(e){const t={};t.database=pT(this.serializer),t.addTarget=(function(s,o){let u;const f=o.target;if(u=lT(f)?{documents:LV(s,f)}:{query:OV(s,f).ft},u.targetId=o.targetId,o.resumeToken.approximateByteSize()>0){u.resumeToken=hP(s,o.resumeToken);const p=hT(s,o.expectedCount);p!==null&&(u.expectedCount=p)}else if(o.snapshotVersion.compareTo(In.min())>0){u.readTime=Nb(s,o.snapshotVersion.toTimestamp());const p=hT(s,o.expectedCount);p!==null&&(u.expectedCount=p)}return u})(this.serializer,e);const n=FV(this.serializer,e);n&&(t.labels=n),this.K_(t)}X_(e){const t={};t.database=pT(this.serializer),t.removeTarget=e,this.K_(t)}}class w6 extends EP{constructor(e,t,n,r,s,o){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,n,r,o),this.serializer=s}get Y_(){return this.F_>0}start(){this.lastStreamToken=void 0,super.start()}W_(){this.Y_&&this.ea([])}j_(e,t){return this.connection.T_("Write",e,t)}H_(e){return Ri(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,Ri(!e.writeResults||e.writeResults.length===0,55816),this.listener.ta()}onNext(e){Ri(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.M_.reset();const t=BV(e.writeResults,e.commitTime),n=kc(e.commitTime);return this.listener.na(n,t)}ra(){const e={};e.database=pT(this.serializer),this.K_(e)}ea(e){const t={streamToken:this.lastStreamToken,writes:e.map((n=>PV(this.serializer,n)))};this.K_(t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class C6{}class R6 extends C6{constructor(e,t,n,r){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=n,this.serializer=r,this.ia=!1}sa(){if(this.ia)throw new Kt(nt.FAILED_PRECONDITION,"The client has already been terminated.")}Wo(e,t,n,r){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([s,o])=>this.connection.Wo(e,fT(t,n),r,s,o))).catch((s=>{throw s.name==="FirebaseError"?(s.code===nt.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),s):new Kt(nt.UNKNOWN,s.toString())}))}jo(e,t,n,r,s){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([o,u])=>this.connection.jo(e,fT(t,n),r,o,u,s))).catch((o=>{throw o.name==="FirebaseError"?(o.code===nt.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new Kt(nt.UNKNOWN,o.toString())}))}terminate(){this.ia=!0,this.connection.terminate()}}function I6(i,e,t,n){return new R6(i,e,t,n)}class D6{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.oa=0,this._a=null,this.aa=!0}ua(){this.oa===0&&(this.ca("Unknown"),this._a=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,(()=>(this._a=null,this.la("Backend didn't respond within 10 seconds."),this.ca("Offline"),Promise.resolve()))))}ha(e){this.state==="Online"?this.ca("Unknown"):(this.oa++,this.oa>=1&&(this.Pa(),this.la(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.ca("Offline")))}set(e){this.Pa(),this.oa=0,e==="Online"&&(this.aa=!1),this.ca(e)}ca(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}la(e){const t=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.aa?(Hu(t),this.aa=!1):$t("OnlineStateTracker",t)}Pa(){this._a!==null&&(this._a.cancel(),this._a=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Jd="RemoteStore";class N6{constructor(e,t,n,r,s){this.localStore=e,this.datastore=t,this.asyncQueue=n,this.remoteSyncer={},this.Ta=[],this.Ia=new Map,this.Ea=new Set,this.Ra=[],this.Aa=s,this.Aa.Mo((o=>{n.enqueueAndForget((async()=>{lp(this)&&($t(Jd,"Restarting streams for network reachability change."),await(async function(f){const p=Bn(f);p.Ea.add(4),await fy(p),p.Va.set("Unknown"),p.Ea.delete(4),await QA(p)})(this))}))})),this.Va=new D6(n,r)}}async function QA(i){if(lp(i))for(const e of i.Ra)await e(!0)}async function fy(i){for(const e of i.Ra)await e(!1)}function TP(i,e){const t=Bn(i);t.Ia.has(e.targetId)||(t.Ia.set(e.targetId,e),IM(t)?RM(t):Tg(t).O_()&&CM(t,e))}function wM(i,e){const t=Bn(i),n=Tg(t);t.Ia.delete(e),n.O_()&&MP(t,e),t.Ia.size===0&&(n.O_()?n.L_():lp(t)&&t.Va.set("Unknown"))}function CM(i,e){if(i.da.$e(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(In.min())>0){const t=i.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(t)}Tg(i).Z_(e)}function MP(i,e){i.da.$e(e),Tg(i).X_(e)}function RM(i){i.da=new TV({getRemoteKeysForTarget:e=>i.remoteSyncer.getRemoteKeysForTarget(e),At:e=>i.Ia.get(e)||null,ht:()=>i.datastore.serializer.databaseId}),Tg(i).start(),i.Va.ua()}function IM(i){return lp(i)&&!Tg(i).x_()&&i.Ia.size>0}function lp(i){return Bn(i).Ea.size===0}function wP(i){i.da=void 0}async function P6(i){i.Va.set("Online")}async function B6(i){i.Ia.forEach(((e,t)=>{CM(i,e)}))}async function L6(i,e){wP(i),IM(i)?(i.Va.ha(e),RM(i)):i.Va.set("Unknown")}async function O6(i,e,t){if(i.Va.set("Online"),e instanceof uP&&e.state===2&&e.cause)try{await(async function(r,s){const o=s.cause;for(const u of s.targetIds)r.Ia.has(u)&&(await r.remoteSyncer.rejectListen(u,o),r.Ia.delete(u),r.da.removeTarget(u))})(i,e)}catch(n){$t(Jd,"Failed to remove targets %s: %s ",e.targetIds.join(","),n),await Bb(i,n)}else if(e instanceof ub?i.da.Xe(e):e instanceof cP?i.da.st(e):i.da.tt(e),!t.isEqual(In.min()))try{const n=await AP(i.localStore);t.compareTo(n)>=0&&await(function(s,o){const u=s.da.Tt(o);return u.targetChanges.forEach(((f,p)=>{if(f.resumeToken.approximateByteSize()>0){const g=s.Ia.get(p);g&&s.Ia.set(p,g.withResumeToken(f.resumeToken,o))}})),u.targetMismatches.forEach(((f,p)=>{const g=s.Ia.get(f);if(!g)return;s.Ia.set(f,g.withResumeToken(Hs.EMPTY_BYTE_STRING,g.snapshotVersion)),MP(s,f);const v=new Zh(g.target,f,p,g.sequenceNumber);CM(s,v)})),s.remoteSyncer.applyRemoteEvent(u)})(i,t)}catch(n){$t(Jd,"Failed to raise snapshot:",n),await Bb(i,n)}}async function Bb(i,e,t){if(!Sg(e))throw e;i.Ea.add(1),await fy(i),i.Va.set("Offline"),t||(t=()=>AP(i.localStore)),i.asyncQueue.enqueueRetryable((async()=>{$t(Jd,"Retrying IndexedDB access"),await t(),i.Ea.delete(1),await QA(i)}))}function CP(i,e){return e().catch((t=>Bb(i,t,e)))}async function ZA(i){const e=Bn(i),t=mf(e);let n=e.Ta.length>0?e.Ta[e.Ta.length-1].batchId:fM;for(;U6(e);)try{const r=await v6(e.localStore,n);if(r===null){e.Ta.length===0&&t.L_();break}n=r.batchId,F6(e,r)}catch(r){await Bb(e,r)}RP(e)&&IP(e)}function U6(i){return lp(i)&&i.Ta.length<10}function F6(i,e){i.Ta.push(e);const t=mf(i);t.O_()&&t.Y_&&t.ea(e.mutations)}function RP(i){return lp(i)&&!mf(i).x_()&&i.Ta.length>0}function IP(i){mf(i).start()}async function k6(i){mf(i).ra()}async function z6(i){const e=mf(i);for(const t of i.Ta)e.ea(t.mutations)}async function V6(i,e,t){const n=i.Ta.shift(),r=xM.from(n,e,t);await CP(i,(()=>i.remoteSyncer.applySuccessfulWrite(r))),await ZA(i)}async function H6(i,e){e&&mf(i).Y_&&await(async function(n,r){if((function(o){return AV(o)&&o!==nt.ABORTED})(r.code)){const s=n.Ta.shift();mf(n).B_(),await CP(n,(()=>n.remoteSyncer.rejectFailedWrite(s.batchId,r))),await ZA(n)}})(i,e),RP(i)&&IP(i)}async function lI(i,e){const t=Bn(i);t.asyncQueue.verifyOperationInProgress(),$t(Jd,"RemoteStore received new credentials");const n=lp(t);t.Ea.add(3),await fy(t),n&&t.Va.set("Unknown"),await t.remoteSyncer.handleCredentialChange(e),t.Ea.delete(3),await QA(t)}async function G6(i,e){const t=Bn(i);e?(t.Ea.delete(2),await QA(t)):e||(t.Ea.add(2),await fy(t),t.Va.set("Unknown"))}function Tg(i){return i.ma||(i.ma=(function(t,n,r){const s=Bn(t);return s.sa(),new M6(n,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,r)})(i.datastore,i.asyncQueue,{Zo:P6.bind(null,i),Yo:B6.bind(null,i),t_:L6.bind(null,i),J_:O6.bind(null,i)}),i.Ra.push((async e=>{e?(i.ma.B_(),IM(i)?RM(i):i.Va.set("Unknown")):(await i.ma.stop(),wP(i))}))),i.ma}function mf(i){return i.fa||(i.fa=(function(t,n,r){const s=Bn(t);return s.sa(),new w6(n,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,r)})(i.datastore,i.asyncQueue,{Zo:()=>Promise.resolve(),Yo:k6.bind(null,i),t_:H6.bind(null,i),ta:z6.bind(null,i),na:V6.bind(null,i)}),i.Ra.push((async e=>{e?(i.fa.B_(),await ZA(i)):(await i.fa.stop(),i.Ta.length>0&&($t(Jd,`Stopping write stream with ${i.Ta.length} pending writes`),i.Ta=[]))}))),i.fa}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class DM{constructor(e,t,n,r,s){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=n,this.op=r,this.removalCallback=s,this.deferred=new Uu,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch((o=>{}))}get promise(){return this.deferred.promise}static createAndSchedule(e,t,n,r,s){const o=Date.now()+n,u=new DM(e,t,o,r,s);return u.start(n),u}start(e){this.timerHandle=setTimeout((()=>this.handleDelayElapsed()),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new Kt(nt.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget((()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then((e=>this.deferred.resolve(e)))):Promise.resolve()))}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function NM(i,e){if(Hu("AsyncQueue",`${e}: ${i}`),Sg(i))return new Kt(nt.UNAVAILABLE,`${e}: ${i}`);throw i}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gm{static emptySet(e){return new Gm(e.comparator)}constructor(e){this.comparator=e?(t,n)=>e(t,n)||dn.comparator(t.key,n.key):(t,n)=>dn.comparator(t.key,n.key),this.keyedMap=dv(),this.sortedSet=new Tr(this.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal(((t,n)=>(e(t),!1)))}add(e){const t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){const t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof Gm)||this.size!==e.size)return!1;const t=this.sortedSet.getIterator(),n=e.sortedSet.getIterator();for(;t.hasNext();){const r=t.getNext().key,s=n.getNext().key;if(!r.isEqual(s))return!1}return!0}toString(){const e=[];return this.forEach((t=>{e.push(t.toString())})),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,t){const n=new Gm;return n.comparator=this.comparator,n.keyedMap=e,n.sortedSet=t,n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cI{constructor(){this.ga=new Tr(dn.comparator)}track(e){const t=e.doc.key,n=this.ga.get(t);n?e.type!==0&&n.type===3?this.ga=this.ga.insert(t,e):e.type===3&&n.type!==1?this.ga=this.ga.insert(t,{type:n.type,doc:e.doc}):e.type===2&&n.type===2?this.ga=this.ga.insert(t,{type:2,doc:e.doc}):e.type===2&&n.type===0?this.ga=this.ga.insert(t,{type:0,doc:e.doc}):e.type===1&&n.type===0?this.ga=this.ga.remove(t):e.type===1&&n.type===2?this.ga=this.ga.insert(t,{type:1,doc:n.doc}):e.type===0&&n.type===1?this.ga=this.ga.insert(t,{type:2,doc:e.doc}):Sn(63341,{Vt:e,pa:n}):this.ga=this.ga.insert(t,e)}ya(){const e=[];return this.ga.inorderTraversal(((t,n)=>{e.push(n)})),e}}class ig{constructor(e,t,n,r,s,o,u,f,p){this.query=e,this.docs=t,this.oldDocs=n,this.docChanges=r,this.mutatedKeys=s,this.fromCache=o,this.syncStateChanged=u,this.excludesMetadataChanges=f,this.hasCachedResults=p}static fromInitialDocuments(e,t,n,r,s){const o=[];return t.forEach((u=>{o.push({type:0,doc:u})})),new ig(e,t,Gm.emptySet(t),o,n,r,!0,!1,s)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&WA(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const t=this.docChanges,n=e.docChanges;if(t.length!==n.length)return!1;for(let r=0;r<t.length;r++)if(t[r].type!==n[r].type||!t[r].doc.isEqual(n[r].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class j6{constructor(){this.wa=void 0,this.ba=[]}Sa(){return this.ba.some((e=>e.Da()))}}class W6{constructor(){this.queries=uI(),this.onlineState="Unknown",this.Ca=new Set}terminate(){(function(t,n){const r=Bn(t),s=r.queries;r.queries=uI(),s.forEach(((o,u)=>{for(const f of u.ba)f.onError(n)}))})(this,new Kt(nt.ABORTED,"Firestore shutting down"))}}function uI(){return new op((i=>K3(i)),WA)}async function DP(i,e){const t=Bn(i);let n=3;const r=e.query;let s=t.queries.get(r);s?!s.Sa()&&e.Da()&&(n=2):(s=new j6,n=e.Da()?0:1);try{switch(n){case 0:s.wa=await t.onListen(r,!0);break;case 1:s.wa=await t.onListen(r,!1);break;case 2:await t.onFirstRemoteStoreListen(r)}}catch(o){const u=NM(o,`Initialization of query '${Lm(e.query)}' failed`);return void e.onError(u)}t.queries.set(r,s),s.ba.push(e),e.va(t.onlineState),s.wa&&e.Fa(s.wa)&&PM(t)}async function NP(i,e){const t=Bn(i),n=e.query;let r=3;const s=t.queries.get(n);if(s){const o=s.ba.indexOf(e);o>=0&&(s.ba.splice(o,1),s.ba.length===0?r=e.Da()?0:1:!s.Sa()&&e.Da()&&(r=2))}switch(r){case 0:return t.queries.delete(n),t.onUnlisten(n,!0);case 1:return t.queries.delete(n),t.onUnlisten(n,!1);case 2:return t.onLastRemoteStoreUnlisten(n);default:return}}function q6(i,e){const t=Bn(i);let n=!1;for(const r of e){const s=r.query,o=t.queries.get(s);if(o){for(const u of o.ba)u.Fa(r)&&(n=!0);o.wa=r}}n&&PM(t)}function X6(i,e,t){const n=Bn(i),r=n.queries.get(e);if(r)for(const s of r.ba)s.onError(t);n.queries.delete(e)}function PM(i){i.Ca.forEach((e=>{e.next()}))}var vT,hI;(hI=vT||(vT={})).Ma="default",hI.Cache="cache";class PP{constructor(e,t,n){this.query=e,this.xa=t,this.Oa=!1,this.Na=null,this.onlineState="Unknown",this.options=n||{}}Fa(e){if(!this.options.includeMetadataChanges){const n=[];for(const r of e.docChanges)r.type!==3&&n.push(r);e=new ig(e.query,e.docs,e.oldDocs,n,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.Oa?this.Ba(e)&&(this.xa.next(e),t=!0):this.La(e,this.onlineState)&&(this.ka(e),t=!0),this.Na=e,t}onError(e){this.xa.error(e)}va(e){this.onlineState=e;let t=!1;return this.Na&&!this.Oa&&this.La(this.Na,e)&&(this.ka(this.Na),t=!0),t}La(e,t){if(!e.fromCache||!this.Da())return!0;const n=t!=="Offline";return(!this.options.Ka||!n)&&(!e.docs.isEmpty()||e.hasCachedResults||t==="Offline")}Ba(e){if(e.docChanges.length>0)return!0;const t=this.Na&&this.Na.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&this.options.includeMetadataChanges===!0}ka(e){e=ig.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Oa=!0,this.xa.next(e)}Da(){return this.options.source!==vT.Cache}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class BP{constructor(e){this.key=e}}class LP{constructor(e){this.key=e}}class Y6{constructor(e,t){this.query=e,this.Za=t,this.Xa=null,this.hasCachedResults=!1,this.current=!1,this.Ya=ci(),this.mutatedKeys=ci(),this.eu=Q3(e),this.tu=new Gm(this.eu)}get nu(){return this.Za}ru(e,t){const n=t?t.iu:new cI,r=t?t.tu:this.tu;let s=t?t.mutatedKeys:this.mutatedKeys,o=r,u=!1;const f=this.query.limitType==="F"&&r.size===this.query.limit?r.last():null,p=this.query.limitType==="L"&&r.size===this.query.limit?r.first():null;if(e.inorderTraversal(((g,v)=>{const _=r.get(g),x=qA(this.query,v)?v:null,E=!!_&&this.mutatedKeys.has(_.key),C=!!x&&(x.hasLocalMutations||this.mutatedKeys.has(x.key)&&x.hasCommittedMutations);let w=!1;_&&x?_.data.isEqual(x.data)?E!==C&&(n.track({type:3,doc:x}),w=!0):this.su(_,x)||(n.track({type:2,doc:x}),w=!0,(f&&this.eu(x,f)>0||p&&this.eu(x,p)<0)&&(u=!0)):!_&&x?(n.track({type:0,doc:x}),w=!0):_&&!x&&(n.track({type:1,doc:_}),w=!0,(f||p)&&(u=!0)),w&&(x?(o=o.add(x),s=C?s.add(g):s.delete(g)):(o=o.delete(g),s=s.delete(g)))})),this.query.limit!==null)for(;o.size>this.query.limit;){const g=this.query.limitType==="F"?o.last():o.first();o=o.delete(g.key),s=s.delete(g.key),n.track({type:1,doc:g})}return{tu:o,iu:n,Ss:u,mutatedKeys:s}}su(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,n,r){const s=this.tu;this.tu=e.tu,this.mutatedKeys=e.mutatedKeys;const o=e.iu.ya();o.sort(((g,v)=>(function(x,E){const C=w=>{switch(w){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return Sn(20277,{Vt:w})}};return C(x)-C(E)})(g.type,v.type)||this.eu(g.doc,v.doc))),this.ou(n),r=r??!1;const u=t&&!r?this._u():[],f=this.Ya.size===0&&this.current&&!r?1:0,p=f!==this.Xa;return this.Xa=f,o.length!==0||p?{snapshot:new ig(this.query,e.tu,s,o,e.mutatedKeys,f===0,p,!1,!!n&&n.resumeToken.approximateByteSize()>0),au:u}:{au:u}}va(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({tu:this.tu,iu:new cI,mutatedKeys:this.mutatedKeys,Ss:!1},!1)):{au:[]}}uu(e){return!this.Za.has(e)&&!!this.tu.has(e)&&!this.tu.get(e).hasLocalMutations}ou(e){e&&(e.addedDocuments.forEach((t=>this.Za=this.Za.add(t))),e.modifiedDocuments.forEach((t=>{})),e.removedDocuments.forEach((t=>this.Za=this.Za.delete(t))),this.current=e.current)}_u(){if(!this.current)return[];const e=this.Ya;this.Ya=ci(),this.tu.forEach((n=>{this.uu(n.key)&&(this.Ya=this.Ya.add(n.key))}));const t=[];return e.forEach((n=>{this.Ya.has(n)||t.push(new LP(n))})),this.Ya.forEach((n=>{e.has(n)||t.push(new BP(n))})),t}cu(e){this.Za=e.ks,this.Ya=ci();const t=this.ru(e.documents);return this.applyChanges(t,!0)}lu(){return ig.fromInitialDocuments(this.query,this.tu,this.mutatedKeys,this.Xa===0,this.hasCachedResults)}}const BM="SyncEngine";class J6{constructor(e,t,n){this.query=e,this.targetId=t,this.view=n}}class K6{constructor(e){this.key=e,this.hu=!1}}class Q6{constructor(e,t,n,r,s,o){this.localStore=e,this.remoteStore=t,this.eventManager=n,this.sharedClientState=r,this.currentUser=s,this.maxConcurrentLimboResolutions=o,this.Pu={},this.Tu=new op((u=>K3(u)),WA),this.Iu=new Map,this.Eu=new Set,this.Ru=new Tr(dn.comparator),this.Au=new Map,this.Vu=new SM,this.du={},this.mu=new Map,this.fu=ng.ar(),this.onlineState="Unknown",this.gu=void 0}get isPrimaryClient(){return this.gu===!0}}async function Z6(i,e,t=!0){const n=VP(i);let r;const s=n.Tu.get(e);return s?(n.sharedClientState.addLocalQueryTarget(s.targetId),r=s.view.lu()):r=await OP(n,e,t,!0),r}async function $6(i,e){const t=VP(i);await OP(t,e,!0,!1)}async function OP(i,e,t,n){const r=await y6(i.localStore,Fc(e)),s=r.targetId,o=i.sharedClientState.addLocalQueryTarget(s,t);let u;return n&&(u=await e5(i,e,s,o==="current",r.resumeToken)),i.isPrimaryClient&&t&&TP(i.remoteStore,r),u}async function e5(i,e,t,n,r){i.pu=(v,_,x)=>(async function(C,w,T,N){let L=w.view.ru(T);L.Ss&&(L=await iI(C.localStore,w.query,!1).then((({documents:O})=>w.view.ru(O,L))));const F=N&&N.targetChanges.get(w.targetId),G=N&&N.targetMismatches.get(w.targetId)!=null,k=w.view.applyChanges(L,C.isPrimaryClient,F,G);return dI(C,w.targetId,k.au),k.snapshot})(i,v,_,x);const s=await iI(i.localStore,e,!0),o=new Y6(e,s.ks),u=o.ru(s.documents),f=hy.createSynthesizedTargetChangeForCurrentChange(t,n&&i.onlineState!=="Offline",r),p=o.applyChanges(u,i.isPrimaryClient,f);dI(i,t,p.au);const g=new J6(e,t,o);return i.Tu.set(e,g),i.Iu.has(t)?i.Iu.get(t).push(e):i.Iu.set(t,[e]),p.snapshot}async function t5(i,e,t){const n=Bn(i),r=n.Tu.get(e),s=n.Iu.get(r.targetId);if(s.length>1)return n.Iu.set(r.targetId,s.filter((o=>!WA(o,e)))),void n.Tu.delete(e);n.isPrimaryClient?(n.sharedClientState.removeLocalQueryTarget(r.targetId),n.sharedClientState.isActiveQueryTarget(r.targetId)||await mT(n.localStore,r.targetId,!1).then((()=>{n.sharedClientState.clearQueryState(r.targetId),t&&wM(n.remoteStore,r.targetId),yT(n,r.targetId)})).catch(Ag)):(yT(n,r.targetId),await mT(n.localStore,r.targetId,!0))}async function n5(i,e){const t=Bn(i),n=t.Tu.get(e),r=t.Iu.get(n.targetId);t.isPrimaryClient&&r.length===1&&(t.sharedClientState.removeLocalQueryTarget(n.targetId),wM(t.remoteStore,n.targetId))}async function i5(i,e,t){const n=u5(i);try{const r=await(function(o,u){const f=Bn(o),p=tr.now(),g=u.reduce(((x,E)=>x.add(E.key)),ci());let v,_;return f.persistence.runTransaction("Locally write mutations","readwrite",(x=>{let E=Gu(),C=ci();return f.xs.getEntries(x,g).next((w=>{E=w,E.forEach(((T,N)=>{N.isValidDocument()||(C=C.add(T))}))})).next((()=>f.localDocuments.getOverlayedDocuments(x,E))).next((w=>{v=w;const T=[];for(const N of u){const L=vV(N,v.get(N.key).overlayedDocument);L!=null&&T.push(new Sf(N.key,L,H3(L.value.mapValue),al.exists(!0)))}return f.mutationQueue.addMutationBatch(x,p,T,u)})).next((w=>{_=w;const T=w.applyToLocalDocumentSet(v,C);return f.documentOverlayCache.saveOverlays(x,w.batchId,T)}))})).then((()=>({batchId:_.batchId,changes:$3(v)})))})(n.localStore,e);n.sharedClientState.addPendingMutation(r.batchId),(function(o,u,f){let p=o.du[o.currentUser.toKey()];p||(p=new Tr(li)),p=p.insert(u,f),o.du[o.currentUser.toKey()]=p})(n,r.batchId,t),await dy(n,r.changes),await ZA(n.remoteStore)}catch(r){const s=NM(r,"Failed to persist write");t.reject(s)}}async function UP(i,e){const t=Bn(i);try{const n=await m6(t.localStore,e);e.targetChanges.forEach(((r,s)=>{const o=t.Au.get(s);o&&(Ri(r.addedDocuments.size+r.modifiedDocuments.size+r.removedDocuments.size<=1,22616),r.addedDocuments.size>0?o.hu=!0:r.modifiedDocuments.size>0?Ri(o.hu,14607):r.removedDocuments.size>0&&(Ri(o.hu,42227),o.hu=!1))})),await dy(t,n,e)}catch(n){await Ag(n)}}function fI(i,e,t){const n=Bn(i);if(n.isPrimaryClient&&t===0||!n.isPrimaryClient&&t===1){const r=[];n.Tu.forEach(((s,o)=>{const u=o.view.va(e);u.snapshot&&r.push(u.snapshot)})),(function(o,u){const f=Bn(o);f.onlineState=u;let p=!1;f.queries.forEach(((g,v)=>{for(const _ of v.ba)_.va(u)&&(p=!0)})),p&&PM(f)})(n.eventManager,e),r.length&&n.Pu.J_(r),n.onlineState=e,n.isPrimaryClient&&n.sharedClientState.setOnlineState(e)}}async function r5(i,e,t){const n=Bn(i);n.sharedClientState.updateQueryState(e,"rejected",t);const r=n.Au.get(e),s=r&&r.key;if(s){let o=new Tr(dn.comparator);o=o.insert(s,ca.newNoDocument(s,In.min()));const u=ci().add(s),f=new JA(In.min(),new Map,new Tr(li),o,u);await UP(n,f),n.Ru=n.Ru.remove(s),n.Au.delete(e),LM(n)}else await mT(n.localStore,e,!1).then((()=>yT(n,e,t))).catch(Ag)}async function s5(i,e){const t=Bn(i),n=e.batch.batchId;try{const r=await p6(t.localStore,e);kP(t,n,null),FP(t,n),t.sharedClientState.updateMutationState(n,"acknowledged"),await dy(t,r)}catch(r){await Ag(r)}}async function a5(i,e,t){const n=Bn(i);try{const r=await(function(o,u){const f=Bn(o);return f.persistence.runTransaction("Reject batch","readwrite-primary",(p=>{let g;return f.mutationQueue.lookupMutationBatch(p,u).next((v=>(Ri(v!==null,37113),g=v.keys(),f.mutationQueue.removeMutationBatch(p,v)))).next((()=>f.mutationQueue.performConsistencyCheck(p))).next((()=>f.documentOverlayCache.removeOverlaysForBatchId(p,g,u))).next((()=>f.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(p,g))).next((()=>f.localDocuments.getDocuments(p,g)))}))})(n.localStore,e);kP(n,e,t),FP(n,e),n.sharedClientState.updateMutationState(e,"rejected",t),await dy(n,r)}catch(r){await Ag(r)}}function FP(i,e){(i.mu.get(e)||[]).forEach((t=>{t.resolve()})),i.mu.delete(e)}function kP(i,e,t){const n=Bn(i);let r=n.du[n.currentUser.toKey()];if(r){const s=r.get(e);s&&(t?s.reject(t):s.resolve(),r=r.remove(e)),n.du[n.currentUser.toKey()]=r}}function yT(i,e,t=null){i.sharedClientState.removeLocalQueryTarget(e);for(const n of i.Iu.get(e))i.Tu.delete(n),t&&i.Pu.yu(n,t);i.Iu.delete(e),i.isPrimaryClient&&i.Vu.Gr(e).forEach((n=>{i.Vu.containsKey(n)||zP(i,n)}))}function zP(i,e){i.Eu.delete(e.path.canonicalString());const t=i.Ru.get(e);t!==null&&(wM(i.remoteStore,t),i.Ru=i.Ru.remove(e),i.Au.delete(t),LM(i))}function dI(i,e,t){for(const n of t)n instanceof BP?(i.Vu.addReference(n.key,e),o5(i,n)):n instanceof LP?($t(BM,"Document no longer in limbo: "+n.key),i.Vu.removeReference(n.key,e),i.Vu.containsKey(n.key)||zP(i,n.key)):Sn(19791,{wu:n})}function o5(i,e){const t=e.key,n=t.path.canonicalString();i.Ru.get(t)||i.Eu.has(n)||($t(BM,"New document in limbo: "+t),i.Eu.add(n),LM(i))}function LM(i){for(;i.Eu.size>0&&i.Ru.size<i.maxConcurrentLimboResolutions;){const e=i.Eu.values().next().value;i.Eu.delete(e);const t=new dn(qi.fromString(e)),n=i.fu.next();i.Au.set(n,new K6(t)),i.Ru=i.Ru.insert(t,n),TP(i.remoteStore,new Zh(Fc(vM(t.path)),n,"TargetPurposeLimboResolution",HA.ce))}}async function dy(i,e,t){const n=Bn(i),r=[],s=[],o=[];n.Tu.isEmpty()||(n.Tu.forEach(((u,f)=>{o.push(n.pu(f,e,t).then((p=>{var g;if((p||t)&&n.isPrimaryClient){const v=p?!p.fromCache:(g=t==null?void 0:t.targetChanges.get(f.targetId))==null?void 0:g.current;n.sharedClientState.updateQueryState(f.targetId,v?"current":"not-current")}if(p){r.push(p);const v=TM.Es(f.targetId,p);s.push(v)}})))})),await Promise.all(o),n.Pu.J_(r),await(async function(f,p){const g=Bn(f);try{await g.persistence.runTransaction("notifyLocalViewChanges","readwrite",(v=>ct.forEach(p,(_=>ct.forEach(_.Ts,(x=>g.persistence.referenceDelegate.addReference(v,_.targetId,x))).next((()=>ct.forEach(_.Is,(x=>g.persistence.referenceDelegate.removeReference(v,_.targetId,x)))))))))}catch(v){if(!Sg(v))throw v;$t(MM,"Failed to update sequence numbers: "+v)}for(const v of p){const _=v.targetId;if(!v.fromCache){const x=g.vs.get(_),E=x.snapshotVersion,C=x.withLastLimboFreeSnapshotVersion(E);g.vs=g.vs.insert(_,C)}}})(n.localStore,s))}async function l5(i,e){const t=Bn(i);if(!t.currentUser.isEqual(e)){$t(BM,"User change. New user:",e.toKey());const n=await bP(t.localStore,e);t.currentUser=e,(function(s,o){s.mu.forEach((u=>{u.forEach((f=>{f.reject(new Kt(nt.CANCELLED,o))}))})),s.mu.clear()})(t,"'waitForPendingWrites' promise is rejected due to a user change."),t.sharedClientState.handleUserChange(e,n.removedBatchIds,n.addedBatchIds),await dy(t,n.Ns)}}function c5(i,e){const t=Bn(i),n=t.Au.get(e);if(n&&n.hu)return ci().add(n.key);{let r=ci();const s=t.Iu.get(e);if(!s)return r;for(const o of s){const u=t.Tu.get(o);r=r.unionWith(u.view.nu)}return r}}function VP(i){const e=Bn(i);return e.remoteStore.remoteSyncer.applyRemoteEvent=UP.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=c5.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=r5.bind(null,e),e.Pu.J_=q6.bind(null,e.eventManager),e.Pu.yu=X6.bind(null,e.eventManager),e}function u5(i){const e=Bn(i);return e.remoteStore.remoteSyncer.applySuccessfulWrite=s5.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=a5.bind(null,e),e}class Lb{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=KA(e.databaseInfo.databaseId),this.sharedClientState=this.Du(e),this.persistence=this.Cu(e),await this.persistence.start(),this.localStore=this.vu(e),this.gcScheduler=this.Fu(e,this.localStore),this.indexBackfillerScheduler=this.Mu(e,this.localStore)}Fu(e,t){return null}Mu(e,t){return null}vu(e){return d6(this.persistence,new u6,e.initialUser,this.serializer)}Cu(e){return new xP(EM.Vi,this.serializer)}Du(e){return new x6}async terminate(){var e,t;(e=this.gcScheduler)==null||e.stop(),(t=this.indexBackfillerScheduler)==null||t.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}Lb.provider={build:()=>new Lb};class h5 extends Lb{constructor(e){super(),this.cacheSizeBytes=e}Fu(e,t){Ri(this.persistence.referenceDelegate instanceof Pb,46915);const n=this.persistence.referenceDelegate.garbageCollector;return new JV(n,e.asyncQueue,t)}Cu(e){const t=this.cacheSizeBytes!==void 0?Za.withCacheSize(this.cacheSizeBytes):Za.DEFAULT;return new xP((n=>Pb.Vi(n,t)),this.serializer)}}class _T{async initialize(e,t){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(t),this.remoteStore=this.createRemoteStore(t),this.eventManager=this.createEventManager(t),this.syncEngine=this.createSyncEngine(t,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=n=>fI(this.syncEngine,n,1),this.remoteStore.remoteSyncer.handleCredentialChange=l5.bind(null,this.syncEngine),await G6(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return(function(){return new W6})()}createDatastore(e){const t=KA(e.databaseInfo.databaseId),n=T6(e.databaseInfo);return I6(e.authCredentials,e.appCheckCredentials,n,t)}createRemoteStore(e){return(function(n,r,s,o,u){return new N6(n,r,s,o,u)})(this.localStore,this.datastore,e.asyncQueue,(t=>fI(this.syncEngine,t,0)),(function(){return aI.v()?new aI:new b6})())}createSyncEngine(e,t){return(function(r,s,o,u,f,p,g){const v=new Q6(r,s,o,u,f,p);return g&&(v.gu=!0),v})(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}async terminate(){var e,t;await(async function(r){const s=Bn(r);$t(Jd,"RemoteStore shutting down."),s.Ea.add(5),await fy(s),s.Aa.shutdown(),s.Va.set("Unknown")})(this.remoteStore),(e=this.datastore)==null||e.terminate(),(t=this.eventManager)==null||t.terminate()}}_T.provider={build:()=>new _T};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class HP{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ou(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ou(this.observer.error,e):Hu("Uncaught Error in snapshot listener:",e.toString()))}Nu(){this.muted=!0}Ou(e,t){setTimeout((()=>{this.muted||e(t)}),0)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const gf="FirestoreClient";class f5{constructor(e,t,n,r,s){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=n,this._databaseInfo=r,this.user=la.UNAUTHENTICATED,this.clientId=hM.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=s,this.authCredentials.start(n,(async o=>{$t(gf,"Received user=",o.uid),await this.authCredentialListener(o),this.user=o})),this.appCheckCredentials.start(n,(o=>($t(gf,"Received new app check token=",o),this.appCheckCredentialListener(o,this.user))))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this._databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new Uu;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted((async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){const n=NM(t,"Failed to shutdown persistence");e.reject(n)}})),e.promise}}async function zE(i,e){i.asyncQueue.verifyOperationInProgress(),$t(gf,"Initializing OfflineComponentProvider");const t=i.configuration;await e.initialize(t);let n=t.initialUser;i.setCredentialChangeListener((async r=>{n.isEqual(r)||(await bP(e.localStore,r),n=r)})),e.persistence.setDatabaseDeletedListener((()=>i.terminate())),i._offlineComponents=e}async function pI(i,e){i.asyncQueue.verifyOperationInProgress();const t=await d5(i);$t(gf,"Initializing OnlineComponentProvider"),await e.initialize(t,i.configuration),i.setCredentialChangeListener((n=>lI(e.remoteStore,n))),i.setAppCheckTokenChangeListener(((n,r)=>lI(e.remoteStore,r))),i._onlineComponents=e}async function d5(i){if(!i._offlineComponents)if(i._uninitializedComponentsProvider){$t(gf,"Using user provided OfflineComponentProvider");try{await zE(i,i._uninitializedComponentsProvider._offline)}catch(e){const t=e;if(!(function(r){return r.name==="FirebaseError"?r.code===nt.FAILED_PRECONDITION||r.code===nt.UNIMPLEMENTED:!(typeof DOMException<"u"&&r instanceof DOMException)||r.code===22||r.code===20||r.code===11})(t))throw t;Zm("Error using user provided cache. Falling back to memory cache: "+t),await zE(i,new Lb)}}else $t(gf,"Using default OfflineComponentProvider"),await zE(i,new h5(void 0));return i._offlineComponents}async function GP(i){return i._onlineComponents||(i._uninitializedComponentsProvider?($t(gf,"Using user provided OnlineComponentProvider"),await pI(i,i._uninitializedComponentsProvider._online)):($t(gf,"Using default OnlineComponentProvider"),await pI(i,new _T))),i._onlineComponents}function p5(i){return GP(i).then((e=>e.syncEngine))}async function jP(i){const e=await GP(i),t=e.eventManager;return t.onListen=Z6.bind(null,e.syncEngine),t.onUnlisten=t5.bind(null,e.syncEngine),t.onFirstRemoteStoreListen=$6.bind(null,e.syncEngine),t.onLastRemoteStoreUnlisten=n5.bind(null,e.syncEngine),t}function m5(i,e,t={}){const n=new Uu;return i.asyncQueue.enqueueAndForget((async()=>(function(s,o,u,f,p){const g=new HP({next:_=>{g.Nu(),o.enqueueAndForget((()=>NP(s,v)));const x=_.docs.has(u);!x&&_.fromCache?p.reject(new Kt(nt.UNAVAILABLE,"Failed to get document because the client is offline.")):x&&_.fromCache&&f&&f.source==="server"?p.reject(new Kt(nt.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):p.resolve(_)},error:_=>p.reject(_)}),v=new PP(vM(u.path),g,{includeMetadataChanges:!0,Ka:!0});return DP(s,v)})(await jP(i),i.asyncQueue,e,t,n))),n.promise}function g5(i,e,t={}){const n=new Uu;return i.asyncQueue.enqueueAndForget((async()=>(function(s,o,u,f,p){const g=new HP({next:_=>{g.Nu(),o.enqueueAndForget((()=>NP(s,v))),_.fromCache&&f.source==="server"?p.reject(new Kt(nt.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):p.resolve(_)},error:_=>p.reject(_)}),v=new PP(u,g,{includeMetadataChanges:!0,Ka:!0});return DP(s,v)})(await jP(i),i.asyncQueue,e,t,n))),n.promise}function v5(i,e){const t=new Uu;return i.asyncQueue.enqueueAndForget((async()=>i5(await p5(i),e,t))),t.promise}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function WP(i){const e={};return i.timeoutSeconds!==void 0&&(e.timeoutSeconds=i.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const y5="ComponentProvider",mI=new Map;function _5(i,e,t,n,r){return new kz(i,e,t,r.host,r.ssl,r.experimentalForceLongPolling,r.experimentalAutoDetectLongPolling,WP(r.experimentalLongPollingOptions),r.useFetchStreams,r.isUsingEmulator,n)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const qP="firestore.googleapis.com",gI=!0;class vI{constructor(e){if(e.host===void 0){if(e.ssl!==void 0)throw new Kt(nt.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=qP,this.ssl=gI}else this.host=e.host,this.ssl=e.ssl??gI;if(this.isUsingEmulator=e.emulatorOptions!==void 0,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=_P;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<XV)throw new Kt(nt.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}Cz("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=WP(e.experimentalLongPollingOptions??{}),(function(n){if(n.timeoutSeconds!==void 0){if(isNaN(n.timeoutSeconds))throw new Kt(nt.INVALID_ARGUMENT,`invalid long polling timeout: ${n.timeoutSeconds} (must not be NaN)`);if(n.timeoutSeconds<5)throw new Kt(nt.INVALID_ARGUMENT,`invalid long polling timeout: ${n.timeoutSeconds} (minimum allowed value is 5)`);if(n.timeoutSeconds>30)throw new Kt(nt.INVALID_ARGUMENT,`invalid long polling timeout: ${n.timeoutSeconds} (maximum allowed value is 30)`)}})(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&(function(n,r){return n.timeoutSeconds===r.timeoutSeconds})(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class $A{constructor(e,t,n,r){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=n,this._app=r,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new vI({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new Kt(nt.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new Kt(nt.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new vI(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=(function(n){if(!n)return new yz;switch(n.type){case"firstParty":return new Az(n.sessionIndex||"0",n.iamToken||null,n.authTokenFactory||null);case"provider":return n.client;default:throw new Kt(nt.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}})(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return(function(t){const n=mI.get(t);n&&($t(y5,"Removing Datastore"),mI.delete(t),n.terminate())})(this),Promise.resolve()}}function x5(i,e,t,n={}){var p;i=jl(i,$A);const r=yg(e),s=i._getSettings(),o={...s,emulatorOptions:i._getEmulatorOptions()},u=`${e}:${t}`;r&&(kN(`https://${u}`),zN("Firestore",!0)),s.host!==qP&&s.host!==u&&Zm("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const f={...s,host:u,ssl:r,emulatorOptions:n};if(!Wd(f,o)&&(i._setSettings(f),n.mockUserToken)){let g,v;if(typeof n.mockUserToken=="string")g=n.mockUserToken,v=la.MOCK_USER;else{g=VU(n.mockUserToken,(p=i._app)==null?void 0:p.options.projectId);const _=n.mockUserToken.sub||n.mockUserToken.user_id;if(!_)throw new Kt(nt.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");v=new la(_)}i._authCredentials=new _z(new I3(g,v))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cp{constructor(e,t,n){this.converter=t,this._query=n,this.type="query",this.firestore=e}withConverter(e){return new cp(this.firestore,e,this._query)}}class Gr{constructor(e,t,n){this.converter=t,this._key=n,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new lf(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new Gr(this.firestore,e,this._key)}toJSON(){return{type:Gr._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(e,t,n){if(cy(t,Gr._jsonSchema))return new Gr(e,n||null,new dn(qi.fromString(t.referencePath)))}}Gr._jsonSchemaVersion="firestore/documentReference/1.0",Gr._jsonSchema={type:ts("string",Gr._jsonSchemaVersion),referencePath:ts("string")};class lf extends cp{constructor(e,t,n){super(e,t,vM(n)),this._path=n,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new Gr(this.firestore,null,new dn(e))}withConverter(e){return new lf(this.firestore,e,this._path)}}function Lc(i,e,...t){if(i=Vs(i),D3("collection","path",e),i instanceof $A){const n=qi.fromString(e,...t);return IR(n),new lf(i,null,n)}{if(!(i instanceof Gr||i instanceof lf))throw new Kt(nt.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const n=i._path.child(qi.fromString(e,...t));return IR(n),new lf(i.firestore,null,n)}}function vo(i,e,...t){if(i=Vs(i),arguments.length===1&&(e=hM.newId()),D3("doc","path",e),i instanceof $A){const n=qi.fromString(e,...t);return RR(n),new Gr(i,null,new dn(n))}{if(!(i instanceof Gr||i instanceof lf))throw new Kt(nt.INVALID_ARGUMENT,"Expected first argument to doc() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const n=i._path.child(qi.fromString(e,...t));return RR(n),new Gr(i.firestore,i instanceof lf?i.converter:null,new dn(n))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const yI="AsyncQueue";class _I{constructor(e=Promise.resolve()){this.Yu=[],this.ec=!1,this.tc=[],this.nc=null,this.rc=!1,this.sc=!1,this.oc=[],this.M_=new SP(this,"async_queue_retry"),this._c=()=>{const n=kE();n&&$t(yI,"Visibility state changed to "+n.visibilityState),this.M_.w_()},this.ac=e;const t=kE();t&&typeof t.addEventListener=="function"&&t.addEventListener("visibilitychange",this._c)}get isShuttingDown(){return this.ec}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.uc(),this.cc(e)}enterRestrictedMode(e){if(!this.ec){this.ec=!0,this.sc=e||!1;const t=kE();t&&typeof t.removeEventListener=="function"&&t.removeEventListener("visibilitychange",this._c)}}enqueue(e){if(this.uc(),this.ec)return new Promise((()=>{}));const t=new Uu;return this.cc((()=>this.ec&&this.sc?Promise.resolve():(e().then(t.resolve,t.reject),t.promise))).then((()=>t.promise))}enqueueRetryable(e){this.enqueueAndForget((()=>(this.Yu.push(e),this.lc())))}async lc(){if(this.Yu.length!==0){try{await this.Yu[0](),this.Yu.shift(),this.M_.reset()}catch(e){if(!Sg(e))throw e;$t(yI,"Operation failed with retryable error: "+e)}this.Yu.length>0&&this.M_.p_((()=>this.lc()))}}cc(e){const t=this.ac.then((()=>(this.rc=!0,e().catch((n=>{throw this.nc=n,this.rc=!1,Hu("INTERNAL UNHANDLED ERROR: ",xI(n)),n})).then((n=>(this.rc=!1,n))))));return this.ac=t,t}enqueueAfterDelay(e,t,n){this.uc(),this.oc.indexOf(e)>-1&&(t=0);const r=DM.createAndSchedule(this,e,t,n,(s=>this.hc(s)));return this.tc.push(r),r}uc(){this.nc&&Sn(47125,{Pc:xI(this.nc)})}verifyOperationInProgress(){}async Tc(){let e;do e=this.ac,await e;while(e!==this.ac)}Ic(e){for(const t of this.tc)if(t.timerId===e)return!0;return!1}Ec(e){return this.Tc().then((()=>{this.tc.sort(((t,n)=>t.targetTimeMs-n.targetTimeMs));for(const t of this.tc)if(t.skipDelay(),e!=="all"&&t.timerId===e)break;return this.Tc()}))}Rc(e){this.oc.push(e)}hc(e){const t=this.tc.indexOf(e);this.tc.splice(t,1)}}function xI(i){let e=i.message||"";return i.stack&&(e=i.stack.includes(i.message)?i.stack:i.message+`
`+i.stack),e}class up extends $A{constructor(e,t,n,r){super(e,t,n,r),this.type="firestore",this._queue=new _I,this._persistenceKey=(r==null?void 0:r.name)||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new _I(e),this._firestoreClient=void 0,await e}}}function b5(i,e){const t=typeof i=="object"?i:jN(),n=typeof i=="string"?i:wb,r=$T(t,"firestore").getImmediate({identifier:n});if(!r._initialized){const s=kU("firestore");s&&x5(r,...s)}return r}function OM(i){if(i._terminated)throw new Kt(nt.FAILED_PRECONDITION,"The client has already been terminated.");return i._firestoreClient||A5(i),i._firestoreClient}function A5(i){var n,r,s,o;const e=i._freezeSettings(),t=_5(i._databaseId,((n=i._app)==null?void 0:n.options.appId)||"",i._persistenceKey,(r=i._app)==null?void 0:r.options.apiKey,e);i._componentsProvider||(s=e.localCache)!=null&&s._offlineComponentProvider&&((o=e.localCache)!=null&&o._onlineComponentProvider)&&(i._componentsProvider={_offline:e.localCache._offlineComponentProvider,_online:e.localCache._onlineComponentProvider}),i._firestoreClient=new f5(i._authCredentials,i._appCheckCredentials,i._queue,t,i._componentsProvider&&(function(f){const p=f==null?void 0:f._online.build();return{_offline:f==null?void 0:f._offline.build(p),_online:p}})(i._componentsProvider))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class il{constructor(e){this._byteString=e}static fromBase64String(e){try{return new il(Hs.fromBase64String(e))}catch(t){throw new Kt(nt.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(e){return new il(Hs.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}toJSON(){return{type:il._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(e){if(cy(e,il._jsonSchema))return il.fromBase64String(e.bytes)}}il._jsonSchemaVersion="firestore/bytes/1.0",il._jsonSchema={type:ts("string",il._jsonSchemaVersion),bytes:ts("string")};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class UM{constructor(...e){for(let t=0;t<e.length;++t)if(e[t].length===0)throw new Kt(nt.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new ks(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class FM{constructor(e){this._methodName=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zc{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new Kt(nt.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new Kt(nt.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}_compareTo(e){return li(this._lat,e._lat)||li(this._long,e._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:zc._jsonSchemaVersion}}static fromJSON(e){if(cy(e,zc._jsonSchema))return new zc(e.latitude,e.longitude)}}zc._jsonSchemaVersion="firestore/geoPoint/1.0",zc._jsonSchema={type:ts("string",zc._jsonSchemaVersion),latitude:ts("number"),longitude:ts("number")};/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hl{constructor(e){this._values=(e||[]).map((t=>t))}toArray(){return this._values.map((e=>e))}isEqual(e){return(function(n,r){if(n.length!==r.length)return!1;for(let s=0;s<n.length;++s)if(n[s]!==r[s])return!1;return!0})(this._values,e._values)}toJSON(){return{type:Hl._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(e){if(cy(e,Hl._jsonSchema)){if(Array.isArray(e.vectorValues)&&e.vectorValues.every((t=>typeof t=="number")))return new Hl(e.vectorValues);throw new Kt(nt.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}}Hl._jsonSchemaVersion="firestore/vectorValue/1.0",Hl._jsonSchema={type:ts("string",Hl._jsonSchemaVersion),vectorValues:ts("object")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const S5=/^__.*__$/;class E5{constructor(e,t,n){this.data=e,this.fieldMask=t,this.fieldTransforms=n}toMutation(e,t){return this.fieldMask!==null?new Sf(e,this.data,this.fieldMask,t,this.fieldTransforms):new uy(e,this.data,t,this.fieldTransforms)}}class XP{constructor(e,t,n){this.data=e,this.fieldMask=t,this.fieldTransforms=n}toMutation(e,t){return new Sf(e,this.data,this.fieldMask,t,this.fieldTransforms)}}function YP(i){switch(i){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw Sn(40011,{dataSource:i})}}class kM{constructor(e,t,n,r,s,o){this.settings=e,this.databaseId=t,this.serializer=n,this.ignoreUndefinedProperties=r,s===void 0&&this.validatePath(),this.fieldTransforms=s||[],this.fieldMask=o||[]}get path(){return this.settings.path}get dataSource(){return this.settings.dataSource}contextWith(e){return new kM({...this.settings,...e},this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}childContextForField(e){var r;const t=(r=this.path)==null?void 0:r.child(e),n=this.contextWith({path:t,arrayElement:!1});return n.validatePathSegment(e),n}childContextForFieldPath(e){var r;const t=(r=this.path)==null?void 0:r.child(e),n=this.contextWith({path:t,arrayElement:!1});return n.validatePath(),n}childContextForArray(e){return this.contextWith({path:void 0,arrayElement:!0})}createError(e){return Ob(e,this.settings.methodName,this.settings.hasConverter||!1,this.path,this.settings.targetDoc)}contains(e){return this.fieldMask.find((t=>e.isPrefixOf(t)))!==void 0||this.fieldTransforms.find((t=>e.isPrefixOf(t.field)))!==void 0}validatePath(){if(this.path)for(let e=0;e<this.path.length;e++)this.validatePathSegment(this.path.get(e))}validatePathSegment(e){if(e.length===0)throw this.createError("Document fields must not be empty");if(YP(this.dataSource)&&S5.test(e))throw this.createError('Document fields cannot begin and end with "__"')}}class T5{constructor(e,t,n){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=n||KA(e)}createContext(e,t,n,r=!1){return new kM({dataSource:e,methodName:t,targetDoc:n,path:ks.emptyPath(),arrayElement:!1,hasConverter:r},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function eS(i){const e=i._freezeSettings(),t=KA(i._databaseId);return new T5(i._databaseId,!!e.ignoreUndefinedProperties,t)}function JP(i,e,t,n,r,s={}){const o=i.createContext(s.merge||s.mergeFields?2:0,e,t,r);zM("Data must be an object, but it was:",o,n);const u=KP(n,o);let f,p;if(s.merge)f=new _o(o.fieldMask),p=o.fieldTransforms;else if(s.mergeFields){const g=[];for(const v of s.mergeFields){const _=Kd(e,v,t);if(!o.contains(_))throw new Kt(nt.INVALID_ARGUMENT,`Field '${_}' is specified in your field mask but missing from your input data.`);$P(g,_)||g.push(_)}f=new _o(g),p=o.fieldTransforms.filter((v=>f.covers(v.field)))}else f=null,p=o.fieldTransforms;return new E5(new $a(u),f,p)}class tS extends FM{_toFieldTransform(e){if(e.dataSource!==2)throw e.dataSource===1?e.createError(`${this._methodName}() can only appear at the top level of your update data`):e.createError(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof tS}}function M5(i,e,t,n){const r=i.createContext(1,e,t);zM("Data must be an object, but it was:",r,n);const s=[],o=$a.empty();Af(n,((f,p)=>{const g=ZP(e,f,t);p=Vs(p);const v=r.childContextForFieldPath(g);if(p instanceof tS)s.push(g);else{const _=py(p,v);_!=null&&(s.push(g),o.set(g,_))}}));const u=new _o(s);return new XP(o,u,r.fieldTransforms)}function w5(i,e,t,n,r,s){const o=i.createContext(1,e,t),u=[Kd(e,n,t)],f=[r];if(s.length%2!=0)throw new Kt(nt.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let _=0;_<s.length;_+=2)u.push(Kd(e,s[_])),f.push(s[_+1]);const p=[],g=$a.empty();for(let _=u.length-1;_>=0;--_)if(!$P(p,u[_])){const x=u[_];let E=f[_];E=Vs(E);const C=o.childContextForFieldPath(x);if(E instanceof tS)p.push(x);else{const w=py(E,C);w!=null&&(p.push(x),g.set(x,w))}}const v=new _o(p);return new XP(g,v,o.fieldTransforms)}function C5(i,e,t,n=!1){return py(t,i.createContext(n?4:3,e))}function py(i,e){if(QP(i=Vs(i)))return zM("Unsupported field value:",e,i),KP(i,e);if(i instanceof FM)return(function(n,r){if(!YP(r.dataSource))throw r.createError(`${n._methodName}() can only be used with update() and set()`);if(!r.path)throw r.createError(`${n._methodName}() is not currently supported inside arrays`);const s=n._toFieldTransform(r);s&&r.fieldTransforms.push(s)})(i,e),null;if(i===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),i instanceof Array){if(e.settings.arrayElement&&e.dataSource!==4)throw e.createError("Nested arrays are not supported");return(function(n,r){const s=[];let o=0;for(const u of n){let f=py(u,r.childContextForArray(o));f==null&&(f={nullValue:"NULL_VALUE"}),s.push(f),o++}return{arrayValue:{values:s}}})(i,e)}return(function(n,r){if((n=Vs(n))===null)return{nullValue:"NULL_VALUE"};if(typeof n=="number")return hV(r.serializer,n);if(typeof n=="boolean")return{booleanValue:n};if(typeof n=="string")return{stringValue:n};if(n instanceof Date){const s=tr.fromDate(n);return{timestampValue:Nb(r.serializer,s)}}if(n instanceof tr){const s=new tr(n.seconds,1e3*Math.floor(n.nanoseconds/1e3));return{timestampValue:Nb(r.serializer,s)}}if(n instanceof zc)return{geoPointValue:{latitude:n.latitude,longitude:n.longitude}};if(n instanceof il)return{bytesValue:hP(r.serializer,n._byteString)};if(n instanceof Gr){const s=r.databaseId,o=n.firestore._databaseId;if(!o.isEqual(s))throw r.createError(`Document reference is for database ${o.projectId}/${o.database} but should be for database ${s.projectId}/${s.database}`);return{referenceValue:AM(n.firestore._databaseId||r.databaseId,n._key.path)}}if(n instanceof Hl)return(function(o,u){const f=o instanceof Hl?o.toArray():o;return{mapValue:{fields:{[z3]:{stringValue:V3},[Cb]:{arrayValue:{values:f.map((g=>{if(typeof g!="number")throw u.createError("VectorValues must only contain numeric values.");return yM(u.serializer,g)}))}}}}}})(n,r);if(yP(n))return n._toProto(r.serializer);throw r.createError(`Unsupported field value: ${VA(n)}`)})(i,e)}function KP(i,e){const t={};return B3(i)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):Af(i,((n,r)=>{const s=py(r,e.childContextForField(n));s!=null&&(t[n]=s)})),{mapValue:{fields:t}}}function QP(i){return!(typeof i!="object"||i===null||i instanceof Array||i instanceof Date||i instanceof tr||i instanceof zc||i instanceof il||i instanceof Gr||i instanceof FM||i instanceof Hl||yP(i))}function zM(i,e,t){if(!QP(t)||!N3(t)){const n=VA(t);throw n==="an object"?e.createError(i+" a custom object"):e.createError(i+" "+n)}}function Kd(i,e,t){if((e=Vs(e))instanceof UM)return e._internalPath;if(typeof e=="string")return ZP(i,e);throw Ob("Field path arguments must be of type string or ",i,!1,void 0,t)}const R5=new RegExp("[~\\*/\\[\\]]");function ZP(i,e,t){if(e.search(R5)>=0)throw Ob(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,i,!1,void 0,t);try{return new UM(...e.split("."))._internalPath}catch{throw Ob(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,i,!1,void 0,t)}}function Ob(i,e,t,n,r){const s=n&&!n.isEmpty(),o=r!==void 0;let u=`Function ${e}() called with invalid data`;t&&(u+=" (via `toFirestore()`)"),u+=". ";let f="";return(s||o)&&(f+=" (found",s&&(f+=` in field ${n}`),o&&(f+=` in document ${r}`),f+=")"),new Kt(nt.INVALID_ARGUMENT,u+i+f)}function $P(i,e){return i.some((t=>t.isEqual(e)))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class I5{convertValue(e,t="none"){switch(pf(e)){case 0:return null;case 1:return e.booleanValue;case 2:return Vr(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(df(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 11:return this.convertObject(e.mapValue,t);case 10:return this.convertVectorValue(e.mapValue);default:throw Sn(62114,{value:e})}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e,t="none"){const n={};return Af(e,((r,s)=>{n[r]=this.convertValue(s,t)})),n}convertVectorValue(e){var n,r,s;const t=(s=(r=(n=e.fields)==null?void 0:n[Cb].arrayValue)==null?void 0:r.values)==null?void 0:s.map((o=>Vr(o.doubleValue)));return new Hl(t)}convertGeoPoint(e){return new zc(Vr(e.latitude),Vr(e.longitude))}convertArray(e,t){return(e.values||[]).map((n=>this.convertValue(n,t)))}convertServerTimestamp(e,t){switch(t){case"previous":const n=jA(e);return n==null?null:this.convertValue(n,t);case"estimate":return this.convertTimestamp(Fv(e));default:return null}}convertTimestamp(e){const t=ff(e);return new tr(t.seconds,t.nanos)}convertDocumentKey(e,t){const n=qi.fromString(e);Ri(vP(n),9688,{name:e});const r=new kv(n.get(1),n.get(3)),s=new dn(n.popFirst(5));return r.isEqual(t)||Hu(`Document ${s} contains a document reference within a different database (${r.projectId}/${r.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),s}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eB extends I5{constructor(e){super(),this.firestore=e}convertBytes(e){return new il(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new Gr(this.firestore,null,t)}}const bI="@firebase/firestore",AI="4.10.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tB{constructor(e,t,n,r,s){this._firestore=e,this._userDataWriter=t,this._key=n,this._document=r,this._converter=s}get id(){return this._key.path.lastSegment()}get ref(){return new Gr(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new D5(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}_fieldsProto(){var e;return((e=this._document)==null?void 0:e.data.clone().value.mapValue.fields)??void 0}get(e){if(this._document){const t=this._document.data.field(Kd("DocumentSnapshot.get",e));if(t!==null)return this._userDataWriter.convertValue(t)}}}class D5 extends tB{data(){return super.data()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function N5(i){if(i.limitType==="L"&&i.explicitOrderBy.length===0)throw new Kt(nt.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class VM{}class nB extends VM{}function hb(i,e,...t){let n=[];e instanceof VM&&n.push(e),n=n.concat(t),(function(s){const o=s.filter((f=>f instanceof HM)).length,u=s.filter((f=>f instanceof nS)).length;if(o>1||o>0&&u>0)throw new Kt(nt.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")})(n);for(const r of n)i=r._apply(i);return i}class nS extends nB{constructor(e,t,n){super(),this._field=e,this._op=t,this._value=n,this.type="where"}static _create(e,t,n){return new nS(e,t,n)}_apply(e){const t=this._parse(e);return iB(e._query,t),new cp(e.firestore,e.converter,cT(e._query,t))}_parse(e){const t=eS(e.firestore);return(function(s,o,u,f,p,g,v){let _;if(p.isKeyField()){if(g==="array-contains"||g==="array-contains-any")throw new Kt(nt.INVALID_ARGUMENT,`Invalid Query. You can't perform '${g}' queries on documentId().`);if(g==="in"||g==="not-in"){EI(v,g);const E=[];for(const C of v)E.push(SI(f,s,C));_={arrayValue:{values:E}}}else _=SI(f,s,v)}else g!=="in"&&g!=="not-in"&&g!=="array-contains-any"||EI(v,g),_=C5(u,o,v,g==="in"||g==="not-in");return es.create(p,g,_)})(e._query,"where",t,e.firestore._databaseId,this._field,this._op,this._value)}}function VE(i,e,t){const n=e,r=Kd("where",i);return nS._create(r,n,t)}class HM extends VM{constructor(e,t){super(),this.type=e,this._queryConstraints=t}static _create(e,t){return new HM(e,t)}_parse(e){const t=this._queryConstraints.map((n=>n._parse(e))).filter((n=>n.getFilters().length>0));return t.length===1?t[0]:Wl.create(t,this._getOperator())}_apply(e){const t=this._parse(e);return t.getFilters().length===0?e:((function(r,s){let o=r;const u=s.getFlattenedFilters();for(const f of u)iB(o,f),o=cT(o,f)})(e._query,t),new cp(e.firestore,e.converter,cT(e._query,t)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}class GM extends nB{constructor(e,t){super(),this._field=e,this._direction=t,this.type="orderBy"}static _create(e,t){return new GM(e,t)}_apply(e){const t=(function(r,s,o){if(r.startAt!==null)throw new Kt(nt.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(r.endAt!==null)throw new Kt(nt.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new Vv(s,o)})(e._query,this._field,this._direction);return new cp(e.firestore,e.converter,iV(e._query,t))}}function P5(i,e="asc"){const t=e,n=Kd("orderBy",i);return GM._create(n,t)}function SI(i,e,t){if(typeof(t=Vs(t))=="string"){if(t==="")throw new Kt(nt.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!J3(e)&&t.indexOf("/")!==-1)throw new Kt(nt.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${t}' contains a '/' character.`);const n=e.path.child(qi.fromString(t));if(!dn.isDocumentKey(n))throw new Kt(nt.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${n}' is not because it has an odd number of segments (${n.length}).`);return FR(i,new dn(n))}if(t instanceof Gr)return FR(i,t._key);throw new Kt(nt.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${VA(t)}.`)}function EI(i,e){if(!Array.isArray(i)||i.length===0)throw new Kt(nt.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function iB(i,e){const t=(function(r,s){for(const o of r)for(const u of o.getFlattenedFilters())if(s.indexOf(u.op)>=0)return u.op;return null})(i.filters,(function(r){switch(r){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}})(e.op));if(t!==null)throw t===e.op?new Kt(nt.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new Kt(nt.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${t.toString()}' filters.`)}function rB(i,e,t){let n;return n=i?t&&(t.merge||t.mergeFields)?i.toFirestore(e,t):i.toFirestore(e):e,n}class mv{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class Vd extends tB{constructor(e,t,n,r,s,o){super(e,t,n,r,o),this._firestore=e,this._firestoreImpl=e,this.metadata=s}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const t=new fb(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){const n=this._document.data.field(Kd("DocumentSnapshot.get",e));if(n!==null)return this._userDataWriter.convertValue(n,t.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new Kt(nt.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e=this._document,t={};return t.type=Vd._jsonSchemaVersion,t.bundle="",t.bundleSource="DocumentSnapshot",t.bundleName=this._key.toString(),!e||!e.isValidDocument()||!e.isFoundDocument()?t:(this._userDataWriter.convertObjectMap(e.data.value.mapValue.fields,"previous"),t.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),t)}}Vd._jsonSchemaVersion="firestore/documentSnapshot/1.0",Vd._jsonSchema={type:ts("string",Vd._jsonSchemaVersion),bundleSource:ts("string","DocumentSnapshot"),bundleName:ts("string"),bundle:ts("string")};class fb extends Vd{data(e={}){return super.data(e)}}class jm{constructor(e,t,n,r){this._firestore=e,this._userDataWriter=t,this._snapshot=r,this.metadata=new mv(r.hasPendingWrites,r.fromCache),this.query=n}get docs(){const e=[];return this.forEach((t=>e.push(t))),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,t){this._snapshot.docs.forEach((n=>{e.call(t,new fb(this._firestore,this._userDataWriter,n.key,n,new mv(this._snapshot.mutatedKeys.has(n.key),this._snapshot.fromCache),this.query.converter))}))}docChanges(e={}){const t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new Kt(nt.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=(function(r,s){if(r._snapshot.oldDocs.isEmpty()){let o=0;return r._snapshot.docChanges.map((u=>{const f=new fb(r._firestore,r._userDataWriter,u.doc.key,u.doc,new mv(r._snapshot.mutatedKeys.has(u.doc.key),r._snapshot.fromCache),r.query.converter);return u.doc,{type:"added",doc:f,oldIndex:-1,newIndex:o++}}))}{let o=r._snapshot.oldDocs;return r._snapshot.docChanges.filter((u=>s||u.type!==3)).map((u=>{const f=new fb(r._firestore,r._userDataWriter,u.doc.key,u.doc,new mv(r._snapshot.mutatedKeys.has(u.doc.key),r._snapshot.fromCache),r.query.converter);let p=-1,g=-1;return u.type!==0&&(p=o.indexOf(u.doc.key),o=o.delete(u.doc.key)),u.type!==1&&(o=o.add(u.doc),g=o.indexOf(u.doc.key)),{type:B5(u.type),doc:f,oldIndex:p,newIndex:g}}))}})(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new Kt(nt.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e={};e.type=jm._jsonSchemaVersion,e.bundleSource="QuerySnapshot",e.bundleName=hM.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;const t=[],n=[],r=[];return this.docs.forEach((s=>{s._document!==null&&(t.push(s._document),n.push(this._userDataWriter.convertObjectMap(s._document.data.value.mapValue.fields,"previous")),r.push(s.ref.path))})),e.bundle=(this._firestore,this.query._query,e.bundleName,"NOT SUPPORTED"),e}}function B5(i){switch(i){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return Sn(61501,{type:i})}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */jm._jsonSchemaVersion="firestore/querySnapshot/1.0",jm._jsonSchema={type:ts("string",jm._jsonSchemaVersion),bundleSource:ts("string","QuerySnapshot"),bundleName:ts("string"),bundle:ts("string")};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function jM(i){i=jl(i,Gr);const e=jl(i.firestore,up),t=OM(e);return m5(t,i._key).then((n=>L5(e,i,n)))}function cf(i){i=jl(i,cp);const e=jl(i.firestore,up),t=OM(e),n=new eB(e);return N5(i._query),g5(t,i._query).then((r=>new jm(e,n,i,r)))}function db(i,e,t){i=jl(i,Gr);const n=jl(i.firestore,up),r=rB(i.converter,e,t),s=eS(n);return iS(n,[JP(s,"setDoc",i._key,r,i.converter!==null,t).toMutation(i._key,al.none())])}function WM(i,e,t,...n){i=jl(i,Gr);const r=jl(i.firestore,up),s=eS(r);let o;return o=typeof(e=Vs(e))=="string"||e instanceof UM?w5(s,"updateDoc",i._key,e,t,n):M5(s,"updateDoc",i._key,e),iS(r,[o.toMutation(i._key,al.exists(!0))])}function qM(i){return iS(jl(i.firestore,up),[new _M(i._key,al.none())])}function sB(i,e){const t=jl(i.firestore,up),n=vo(i),r=rB(i.converter,e),s=eS(i.firestore);return iS(t,[JP(s,"addDoc",n._key,r,i.converter!==null,{}).toMutation(n._key,al.exists(!1))]).then((()=>n))}function iS(i,e){const t=OM(i);return v5(t,e)}function L5(i,e,t){const n=t.docs.get(e._key),r=new eB(i);return new Vd(i,r,e._key,n,new mv(t.hasPendingWrites,t.fromCache),e.converter)}(function(e,t=!0){vz(_g),Km(new qd("firestore",((n,{instanceIdentifier:r,options:s})=>{const o=n.getProvider("app").getImmediate(),u=new up(new xz(n.getProvider("auth-internal")),new Sz(o,n.getProvider("app-check-internal")),zz(o,r),o);return s={useFetchStreams:t,...s},u._setSettings(s),u}),"PUBLIC").setMultipleInstances(!0)),af(bI,AI,e),af(bI,AI,"esm2020")})();const O5={apiKey:"AIzaSyDfYd5Q2rflez7dCaPzXIkpmnXbxPrHIkE",authDomain:"apitherapyv2.firebaseapp.com",projectId:"apitherapyv2",storageBucket:"apitherapyv2.appspot.com",messagingSenderId:"362764787801",appId:"1:362764787801:web:1f21a3eeca3128d9109148",measurementId:"G-N8KWP7F555"},aB=GN(O5),xT=mz(aB);new Pc;const Nr=b5(aB);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const oB=(...i)=>i.filter((e,t,n)=>!!e&&e.trim()!==""&&n.indexOf(e)===t).join(" ").trim();/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const U5=i=>i.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase();/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const F5=i=>i.replace(/^([A-Z])|[\s-_]+(\w)/g,(e,t,n)=>n?n.toUpperCase():t.toLowerCase());/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const TI=i=>{const e=F5(i);return e.charAt(0).toUpperCase()+e.slice(1)};/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var k5={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const z5=i=>{for(const e in i)if(e.startsWith("aria-")||e==="role"||e==="title")return!0;return!1};/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const V5=be.forwardRef(({color:i="currentColor",size:e=24,strokeWidth:t=2,absoluteStrokeWidth:n,className:r="",children:s,iconNode:o,...u},f)=>be.createElement("svg",{ref:f,...k5,width:e,height:e,stroke:i,strokeWidth:n?Number(t)*24/Number(e):t,className:oB("lucide",r),...!s&&!z5(u)&&{"aria-hidden":"true"},...u},[...o.map(([p,g])=>be.createElement(p,g)),...Array.isArray(s)?s:[s]]));/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Vi=(i,e)=>{const t=be.forwardRef(({className:n,...r},s)=>be.createElement(V5,{ref:s,iconNode:e,className:oB(`lucide-${U5(TI(i))}`,`lucide-${i}`,n),...r}));return t.displayName=TI(i),t};/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const H5=[["path",{d:"M22 12h-2.48a2 2 0 0 0-1.93 1.46l-2.35 8.36a.25.25 0 0 1-.48 0L9.24 2.18a.25.25 0 0 0-.48 0l-2.35 8.36A2 2 0 0 1 4.49 12H2",key:"169zse"}]],G5=Vi("activity",H5);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const j5=[["path",{d:"M4.5 3h15",key:"c7n0jr"}],["path",{d:"M6 3v16a2 2 0 0 0 2 2h8a2 2 0 0 0 2-2V3",key:"m1uhx7"}],["path",{d:"M6 14h12",key:"4cwo0f"}]],W5=Vi("beaker",j5);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const q5=[["path",{d:"M12 5a3 3 0 1 0-5.997.125 4 4 0 0 0-2.526 5.77 4 4 0 0 0 .556 6.588A4 4 0 1 0 12 18Z",key:"l5xja"}],["path",{d:"M9 13a4.5 4.5 0 0 0 3-4",key:"10igwf"}],["path",{d:"M6.003 5.125A3 3 0 0 0 6.401 6.5",key:"105sqy"}],["path",{d:"M3.477 10.896a4 4 0 0 1 .585-.396",key:"ql3yin"}],["path",{d:"M6 18a4 4 0 0 1-1.967-.516",key:"2e4loj"}],["path",{d:"M12 13h4",key:"1ku699"}],["path",{d:"M12 18h6a2 2 0 0 1 2 2v1",key:"105ag5"}],["path",{d:"M12 8h8",key:"1lhi5i"}],["path",{d:"M16 8V5a2 2 0 0 1 2-2",key:"u6izg6"}],["circle",{cx:"16",cy:"13",r:".5",key:"ry7gng"}],["circle",{cx:"18",cy:"3",r:".5",key:"1aiba7"}],["circle",{cx:"20",cy:"21",r:".5",key:"yhc1fs"}],["circle",{cx:"20",cy:"8",r:".5",key:"1e43v0"}]],X5=Vi("brain-circuit",q5);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Y5=[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]],lB=Vi("calendar",Y5);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const J5=[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]],cB=Vi("chevron-down",J5);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const K5=[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]],XM=Vi("chevron-left",K5);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Q5=[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]],Z5=Vi("chevron-right",Q5);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $5=[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]],MI=Vi("circle-check-big",$5);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const e9=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M8 12h8",key:"1wcyev"}],["path",{d:"M12 8v8",key:"napkw2"}]],uB=Vi("circle-plus",e9);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const t9=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]],n9=Vi("circle-x",t9);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const i9=[["path",{d:"M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z",key:"1oefj6"}],["path",{d:"M14 2v5a1 1 0 0 0 1 1h5",key:"wfsgrz"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]],bT=Vi("file-text",i9);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const r9=[["path",{d:"M3 5h.01",key:"18ugdj"}],["path",{d:"M3 12h.01",key:"nlz23k"}],["path",{d:"M3 19h.01",key:"noohij"}],["path",{d:"M8 5h13",key:"1pao27"}],["path",{d:"M8 12h13",key:"1za7za"}],["path",{d:"M8 19h13",key:"m83p4d"}]],hB=Vi("list",r9);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const s9=[["path",{d:"M12 2v4",key:"3427ic"}],["path",{d:"m16.2 7.8 2.9-2.9",key:"r700ao"}],["path",{d:"M18 12h4",key:"wj9ykh"}],["path",{d:"m16.2 16.2 2.9 2.9",key:"1bxg5t"}],["path",{d:"M12 18v4",key:"jadmvz"}],["path",{d:"m4.9 19.1 2.9-2.9",key:"bwix9q"}],["path",{d:"M2 12h4",key:"j09sii"}],["path",{d:"m4.9 4.9 2.9 2.9",key:"giyufr"}]],jv=Vi("loader",s9);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const a9=[["path",{d:"m16 17 5-5-5-5",key:"1bji2h"}],["path",{d:"M21 12H9",key:"dn1m92"}],["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}]],o9=Vi("log-out",a9);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const l9=[["path",{d:"m22 7-8.991 5.727a2 2 0 0 1-2.009 0L2 7",key:"132q7q"}],["rect",{x:"2",y:"4",width:"20",height:"16",rx:"2",key:"izxlao"}]],c9=Vi("mail",l9);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const u9=[["path",{d:"M20 10c0 4.993-5.539 10.193-7.399 11.799a1 1 0 0 1-1.202 0C9.539 20.193 4 14.993 4 10a8 8 0 0 1 16 0",key:"1r0f0z"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]],h9=Vi("map-pin",u9);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const f9=[["path",{d:"M14 4.1 12 6",key:"ita8i4"}],["path",{d:"m5.1 8-2.9-.8",key:"1go3kf"}],["path",{d:"m6 12-1.9 2",key:"mnht97"}],["path",{d:"M7.2 2.2 8 5.1",key:"1cfko1"}],["path",{d:"M9.037 9.69a.498.498 0 0 1 .653-.653l11 4.5a.5.5 0 0 1-.074.949l-4.349 1.041a1 1 0 0 0-.74.739l-1.04 4.35a.5.5 0 0 1-.95.074z",key:"s0h3yz"}]],d9=Vi("mouse-pointer-click",f9);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const p9=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]],fB=Vi("plus",p9);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const m9=[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]],dB=Vi("save",m9);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const g9=[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]],v9=Vi("search",g9);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const y9=[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}]],_9=Vi("shield",y9);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const x9=[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a1 1 0 0 1 3 3l-9.013 9.014a2 2 0 0 1-.853.505l-2.873.84a.5.5 0 0 1-.62-.62l.84-2.873a2 2 0 0 1 .506-.852z",key:"ohrbg2"}]],YM=Vi("square-pen",x9);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const b9=[["path",{d:"m18 2 4 4",key:"22kx64"}],["path",{d:"m17 7 3-3",key:"1w1zoj"}],["path",{d:"M19 9 8.7 19.3c-1 1-2.5 1-3.4 0l-.6-.6c-1-1-1-2.5 0-3.4L15 5",key:"1exhtz"}],["path",{d:"m9 11 4 4",key:"rovt3i"}],["path",{d:"m5 19-3 3",key:"59f2uf"}],["path",{d:"m14 4 6 6",key:"yqp9t2"}]],A9=Vi("syringe",b9);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const S9=[["path",{d:"M10 11v6",key:"nco0om"}],["path",{d:"M14 11v6",key:"outv1u"}],["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]],rS=Vi("trash-2",S9);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const E9=[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]],my=Vi("triangle-alert",E9);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const T9=[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]],JM=Vi("user",T9);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const M9=[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["path",{d:"M16 3.128a4 4 0 0 1 0 7.744",key:"16gr8j"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}]],w9=Vi("users",M9),C9=()=>{const i=async()=>{const e=new Pc;try{await Ek(xT,e)}catch(t){console.error("Firebase Popup Error:",t)}};return V.jsx("div",{className:"w-full h-screen flex flex-col items-center justify-center bg-slate-900 text-white",children:V.jsxs("div",{className:"flex flex-col items-center p-8 rounded-2xl shadow-2xl bg-slate-800 border border-slate-700",children:[V.jsxs("div",{className:"flex items-center mb-6",children:[V.jsx(W5,{size:36,className:"text-yellow-400"}),V.jsx("h1",{className:"ml-3 text-3xl font-bold tracking-tighter",children:"APITherapy"})]}),V.jsx("p",{className:"text-slate-300 mb-8",children:"Welcome. Please sign in to continue."}),V.jsxs("button",{id:"google-signin-button",onClick:i,className:"flex items-center justify-center w-full px-6 py-3 bg-blue-600 rounded-lg font-semibold text-white hover:bg-blue-700 transition-colors",children:[V.jsxs("svg",{className:"w-5 h-5 mr-3",viewBox:"0 0 48 48",children:[V.jsx("path",{fill:"#FFC107",d:"M43.611,20.083H42V20H24v8h11.303c-1.649,4.657-6.08,8-11.303,8c-6.627,0-12-5.373-12-12s5.373-12,12-12c3.059,0,5.842,1.154,7.961,3.039l5.657-5.657C34.046,6.053,29.268,4,24,4C12.955,4,4,12.955,4,24s8.955,20,20,20s20-8.955,20-20C44,22.659,43.862,21.35,43.611,20.083z"}),V.jsx("path",{fill:"#FF3D00",d:"M6.306,14.691l6.571,4.819C14.655,15.108,18.961,12,24,12c3.059,0,5.842,1.154,7.961,3.039l5.657-5.657C34.046,6.053,29.268,4,24,4C16.318,4,9.656,8.337,6.306,14.691z"}),V.jsx("path",{fill:"#4CAF50",d:"M24,44c5.166,0,9.86-1.977,13.409-5.192l-6.19-5.238C29.211,35.091,26.715,36,24,36c-5.202,0-9.619-3.317-11.283-7.946l-6.522,5.025C9.505,39.556,16.227,44,24,44z"}),V.jsx("path",{fill:"#1976D2",d:"M43.611,20.083H42V20H24v8h11.303c-0.792,2.237-2.231,4.166-4.087,5.571l6.19,5.238C43.021,36.25,44,30.2,44,24C44,22.659,43.862,21.35,43.611,20.083z"})]}),"Sign In with Google"]})]})})},R9=({user:i,patients:e,onAddPatient:t,onStartTreatment:n,onUpdatePatient:r,onShowTreatments:s,onDeletePatient:o})=>{const[u,f]=be.useState(""),[p,g]=be.useState(null),v=e.filter(C=>C.fullName.toLowerCase().includes(u.toLowerCase())||C.identityNumber.toLowerCase().includes(u.toLowerCase())||C.email.toLowerCase().includes(u.toLowerCase())),_=C=>{g(C)},x=()=>{p&&(o(p.id),g(null))},E=()=>{g(null)};return V.jsxs("div",{className:"space-y-8 animate-fade-in",children:[V.jsxs("div",{className:"flex justify-between items-center",children:[V.jsxs("div",{children:[V.jsxs("h2",{className:"text-3xl font-black text-slate-900 tracking-tighter",children:["Welcome, ",(i.displayName||"").split(" ")[0],"!"]}),V.jsx("p",{className:"text-slate-500",children:"Your central hub for patient management."})]}),V.jsxs("button",{onClick:t,className:"bg-yellow-500 hover:bg-yellow-400 text-slate-900 font-bold py-3 px-6 rounded-xl transition flex items-center gap-2 shadow-lg shadow-yellow-500/10",children:[V.jsx(uB,{size:16}),"Add New Patient"]})]}),V.jsxs("div",{className:"relative",children:[V.jsx(v9,{size:16,className:"absolute left-4 top-1/2 -translate-y-1/2 text-slate-400"}),V.jsx("input",{type:"text",placeholder:"Search by name, ID, or email...",value:u,onChange:C=>f(C.target.value),className:"w-full pl-12 pr-4 py-4 bg-white border border-slate-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-yellow-500"})]}),V.jsxs("div",{className:"bg-white rounded-3xl border border-slate-100 shadow-sm",children:[V.jsxs("div",{className:"p-6 grid grid-cols-12 gap-4 font-black text-slate-400 text-[10px] uppercase tracking-widest border-b",children:[V.jsx("div",{className:"col-span-3",children:"Patient"}),V.jsx("div",{className:"col-span-2",children:"Contact"}),V.jsx("div",{className:"col-span-2",children:"Condition"}),V.jsx("div",{children:"Severity"}),V.jsx("div",{children:"Last Treatment"}),V.jsx("div",{className:"col-span-2 text-right pr-4",children:"Actions"})]}),V.jsx("div",{className:"divide-y divide-slate-100",children:v.length>0?v.map(C=>V.jsxs("div",{className:"grid grid-cols-12 gap-4 items-center p-6 group",children:[V.jsxs("div",{className:"col-span-3 flex items-center gap-3",children:[V.jsx("div",{className:"w-10 h-10 rounded-full bg-slate-100 flex items-center justify-center font-black text-slate-500 text-xs",children:C.fullName.slice(0,2)}),V.jsxs("div",{children:[V.jsx("p",{className:"font-bold text-slate-800 text-sm",children:C.fullName}),V.jsxs("p",{className:"font-mono text-xs text-slate-500",children:["ID: ",C.identityNumber]})]})]}),V.jsxs("div",{className:"col-span-2",children:[V.jsxs("a",{href:`mailto:${C.email}`,className:"text-xs text-slate-600 hover:text-yellow-600 flex items-center gap-2",children:[V.jsx(c9,{size:12})," ",C.email]}),V.jsx("p",{className:"font-mono text-xs text-slate-500 pt-1",children:C.mobile})]}),V.jsx("div",{className:"col-span-2 text-xs font-bold text-slate-600 uppercase tracking-wider",children:C.condition}),V.jsx("div",{children:V.jsx("span",{className:`px-3 py-1 text-xs font-bold rounded-full ${C.severity==="Severe"?"bg-red-100 text-red-800":C.severity==="Moderate"?"bg-orange-100 text-orange-800":"bg-green-100 text-green-800"}`,children:C.severity})}),V.jsx("div",{className:"text-xs font-bold text-slate-500",children:C.lastTreatment||"No treatments"}),V.jsxs("div",{className:"col-span-2 flex items-center justify-end gap-1",children:[V.jsx("button",{onClick:()=>r(C),className:"p-2 text-slate-400 hover:text-slate-800 transition rounded-lg",children:V.jsx(YM,{size:14})}),V.jsx("button",{onClick:()=>s(C),className:"p-2 text-slate-400 hover:text-slate-800 transition rounded-lg",children:V.jsx(bT,{size:14})}),(!C.lastTreatment||C.lastTreatment==="")&&V.jsx("button",{onClick:()=>_(C),className:"p-2 text-slate-400 hover:text-red-500 transition rounded-lg",children:V.jsx(rS,{size:14})}),V.jsxs("button",{onClick:()=>n(C),className:"bg-slate-900 text-white font-bold py-2 pl-3 pr-2 rounded-lg text-xs flex items-center gap-1.5 group-hover:bg-yellow-500 group-hover:text-slate-900 transition-all",children:["Start ",V.jsx(Z5,{size:14})]})]})]},C.id)):V.jsxs("div",{className:"text-center p-12 text-slate-500",children:[V.jsx(JM,{className:"mx-auto mb-4",size:40}),V.jsx("h3",{className:"font-bold text-lg",children:"No Patients Found"}),V.jsx("p",{className:"text-sm",children:"No patients match your search criteria. Try adding a new patient."})]})})]}),p&&V.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 animate-fade-in",children:V.jsxs("div",{className:"bg-white rounded-2xl p-8 shadow-2xl max-w-sm w-full text-center",children:[V.jsx(my,{className:"mx-auto text-red-500",size:48}),V.jsx("h3",{className:"text-xl font-black text-slate-800 mt-4",children:"Confirm Deletion"}),V.jsxs("p",{className:"text-slate-500 mt-2",children:["Are you sure you want to delete ",V.jsx("span",{className:"font-bold",children:p.fullName}),"? This action cannot be undone."]}),V.jsxs("div",{className:"flex gap-4 mt-6",children:[V.jsx("button",{onClick:E,className:"w-full py-3 rounded-xl text-sm font-bold text-slate-600 bg-slate-100 hover:bg-slate-200 transition",children:"Cancel"}),V.jsx("button",{onClick:x,className:"w-full py-3 rounded-xl text-sm font-bold text-white bg-red-500 hover:bg-red-600 transition",children:"Delete Patient"})]})]})})]})},I9=i=>{if(!i||!/\d{4}-\d{2}-\d{2}/.test(i))return"";const[e,t,n]=i.split("-");return`${n}/${t}/${e}`},D9=({value:i,onChange:e,...t})=>{const n=be.useRef(null),r=()=>{var s;(s=n.current)==null||s.showPicker()};return V.jsxs("div",{className:"relative w-full",onClick:r,children:[V.jsx("input",{type:"text",value:I9(i),readOnly:!0,placeholder:"dd/mm/yyyy",className:"w-full p-3 mt-1 bg-white border border-slate-200 rounded-xl cursor-pointer pr-10"}),V.jsx(lB,{size:18,className:"absolute right-3 top-1/2 -translate-y-1/2 mt-0.5 text-slate-400 pointer-events-none"}),V.jsx("input",{...t,ref:n,type:"date",value:i||"",onChange:e,className:"absolute top-0 left-0 w-full h-full opacity-0 cursor-pointer",tabIndex:-1})]})},N9=({patient:i,user:e,onSave:t,onBack:n,onStartTreatment:r,saveStatus:s,errorMessage:o})=>{const[u,f]=be.useState({...i}),[p,g]=be.useState({}),v=i.caretakerId?e.fullName:"Not Assigned",x=(T=>{if(!T)return null;const N=new Date(T);if(isNaN(N.getTime()))return null;const L=new Date;let F=L.getFullYear()-N.getFullYear();const G=L.getMonth()-N.getMonth();return(G<0||G===0&&L.getDate()<N.getDate())&&F--,F})(u.birthDate),E=()=>{const T={};return(!u.email||!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(u.email))&&(T.email="Please enter a valid email address."),u.birthDate||(T.birthDate="Birth date is required."),g(T),Object.keys(T).length===0},C=T=>{const{name:N,value:L}=T.target;f(F=>({...F,[N]:L})),p[N]&&g(F=>({...F,[N]:""}))},w=T=>{T.preventDefault(),E()&&t(u)};return V.jsxs("form",{onSubmit:w,className:"max-w-4xl mx-auto bg-white rounded-3xl p-8 shadow-lg border border-slate-100 animate-fade-in",children:[V.jsxs("div",{className:"flex justify-between items-center mb-6",children:[V.jsx("h2",{className:"text-2xl font-black text-slate-800 tracking-tighter",children:"Patient Information"}),V.jsxs("button",{type:"button",onClick:n,className:"flex items-center gap-2 text-sm font-bold text-slate-600 hover:text-slate-900 transition",children:[V.jsx(XM,{size:16})," Back"]})]}),V.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[V.jsxs("div",{className:"space-y-4",children:[V.jsx(J0,{label:"Full Name",id:"fullName",name:"fullName",value:u.fullName,onChange:C,required:!0}),V.jsxs("div",{children:[V.jsx(J0,{label:"Email Address",id:"email",name:"email",type:"email",value:u.email,onChange:C}),p.email&&V.jsx("p",{className:"text-red-500 text-xs mt-1",children:p.email})]}),V.jsx(J0,{label:"Mobile Number",id:"mobile",name:"mobile",value:u.mobile,onChange:C,required:!0}),V.jsx(J0,{label:"Identity Number",id:"identityNumber",name:"identityNumber",value:u.identityNumber,onChange:C,required:!0})]}),V.jsxs("div",{className:"space-y-4",children:[V.jsx(J0,{label:"Condition",id:"condition",name:"condition",value:u.condition,onChange:C,required:!0}),V.jsxs("div",{className:"relative",children:[V.jsx("label",{className:"text-[10px] font-bold text-slate-500 uppercase",htmlFor:"severity",children:"Severity"}),V.jsxs("select",{id:"severity",name:"severity",value:u.severity,onChange:C,className:"w-full p-3 mt-1 bg-white border border-slate-200 rounded-xl appearance-none",required:!0,children:[V.jsx("option",{value:"Mild",children:"Mild"}),V.jsx("option",{value:"Moderate",children:"Moderate"}),V.jsx("option",{value:"Severe",children:"Severe"})]}),V.jsx(cB,{size:16,className:"absolute right-4 top-10 text-slate-400 pointer-events-none"})]}),V.jsxs("div",{children:[V.jsx("label",{className:"text-[10px] font-bold text-slate-500 uppercase",htmlFor:"birthDate",children:"Birth Date"}),V.jsx(D9,{id:"birthDate",name:"birthDate",value:u.birthDate||"",onChange:C}),p.birthDate&&V.jsx("p",{className:"text-red-500 text-xs mt-1",children:p.birthDate})]}),V.jsx(wI,{label:"Age",value:x!==null?`${x} years old`:"N/A"}),V.jsx(wI,{label:"Caretaker",value:v})]})]}),s==="error"&&o&&V.jsx("div",{className:"mt-4 text-red-600 bg-red-100 p-3 rounded-lg",children:o}),V.jsxs("div",{className:"mt-8 flex justify-between items-center",children:[V.jsxs("button",{type:"button",onClick:r,className:"px-6 py-3 rounded-xl text-sm font-bold text-white bg-yellow-500 hover:bg-yellow-400 transition flex items-center gap-2",children:[V.jsx(fB,{size:16}),"Start New Treatment"]}),V.jsxs("div",{className:"flex gap-4",children:[V.jsx("button",{type:"button",onClick:n,className:"px-6 py-3 rounded-xl text-sm font-bold text-slate-600 bg-slate-100 hover:bg-slate-200 transition",children:"Cancel"}),V.jsx("button",{type:"submit",className:"px-8 py-3 rounded-xl text-sm font-bold text-white bg-slate-900 hover:bg-slate-800 transition",children:"Save Changes"})]})]})]})},J0=({label:i,id:e,...t})=>V.jsxs("div",{children:[V.jsx("label",{className:"text-[10px] font-bold text-slate-500 uppercase",htmlFor:e,children:i}),V.jsx("input",{id:e,...t,className:"w-full p-3 mt-1 bg-white border border-slate-200 rounded-xl"})]}),wI=({label:i,value:e})=>V.jsxs("div",{children:[V.jsx("label",{className:"text-[10px] font-bold text-slate-500 uppercase",children:i}),V.jsx("p",{style:{cursor:"not-allowed"},className:"font-mono text-sm p-3 mt-1 bg-slate-50 border border-slate-100 rounded-xl",children:e||"Not Assigned"})]}),P9=({user:i,onLogout:e,onAdminClick:t,onUserDetailsClick:n,onPatientsClick:r,onPointsAdminClick:s})=>{var f;const[o,u]=be.useState(!1);return i?V.jsxs("div",{className:"w-64 bg-slate-900 text-white flex flex-col min-h-screen",children:[V.jsx("div",{className:"p-4 border-b border-slate-800",children:V.jsx("h2",{className:"text-xl font-black tracking-tighter",children:"APITHERAPYCARE"})}),V.jsxs("nav",{className:"flex-grow p-4 space-y-2",children:[V.jsxs("button",{onClick:n,className:"w-full flex items-center p-3 rounded-xl hover:bg-slate-800 transition text-sm font-bold",children:[V.jsx(JM,{size:18,className:"mr-3"}),V.jsx("span",{children:"My Profile"})]}),V.jsxs("button",{onClick:r,className:"w-full flex items-center p-3 rounded-xl hover:bg-slate-800 transition text-sm font-bold",children:[V.jsx(w9,{size:18,className:"mr-3"}),V.jsx("span",{children:"Patients"})]}),i.role==="admin"&&V.jsxs("div",{children:[V.jsxs("button",{onClick:()=>u(!o),className:"w-full flex justify-between items-center p-3 rounded-xl hover:bg-slate-800 transition text-sm font-bold",children:[V.jsxs("div",{className:"flex items-center",children:[V.jsx(_9,{size:18,className:"mr-3"}),V.jsx("span",{children:"Configuration"})]}),V.jsx(cB,{size:16,className:`transform transition-transform ${o?"rotate-180":""}`})]}),o&&V.jsxs("div",{className:"pl-8 mt-2 space-y-1",children:[V.jsx("button",{onClick:t,className:"w-full text-left p-2 rounded-lg hover:bg-slate-700 transition text-sm",children:"Protocol Configuration"}),V.jsx("button",{onClick:s,className:"w-full text-left p-2 rounded-lg hover:bg-slate-700 transition text-sm",children:"Points Configuration"})]})]})]}),V.jsxs("div",{className:"p-4 border-t border-slate-800",children:[V.jsxs("div",{className:"flex items-center mb-4",children:[V.jsx("div",{className:"w-10 h-10 rounded-full bg-slate-700 flex items-center justify-center font-bold mr-3",children:((f=i.fullName)==null?void 0:f.charAt(0).toUpperCase())||"A"}),V.jsxs("div",{children:[V.jsx("div",{className:"font-bold text-sm",children:i.fullName||"Anonymous User"}),V.jsx("div",{className:"text-xs text-slate-400 capitalize",children:i.role||"User"})]})]}),V.jsxs("button",{onClick:e,className:"w-full flex items-center justify-center p-3 rounded-xl bg-red-600 hover:bg-red-700 transition text-sm font-bold",children:[V.jsx(o9,{size:16,className:"mr-2"}),V.jsx("span",{children:"Logout"})]})]})]}):V.jsx("div",{className:"w-64 bg-slate-900 text-white flex flex-col min-h-screen p-4",children:V.jsx("div",{className:"flex-grow",children:V.jsx("h2",{className:"text-xl font-black tracking-tighter",children:"APITHERAPYCARE"})})})},B9=()=>{const[i,e]=be.useState([]),[t,n]=be.useState([]),[r,s]=be.useState(!0),[o,u]=be.useState(!1),[f,p]=be.useState(null),[g,v]=be.useState(null),[_,x]=be.useState(null),E=be.useCallback(async()=>{s(!0);try{const k=Lc(Nr,"protocols"),D=(await cf(k)).docs.map(Y=>({...Y.data(),id:Y.id})).sort((Y,j)=>Y.name.localeCompare(j.name));e(D);const R=Lc(Nr,"acupuncture_points"),z=(await cf(R)).docs.map(Y=>({...Y.data(),id:Y.id})).sort((Y,j)=>Y.code.localeCompare(j.code));n(z)}catch(k){console.error("Error fetching data:",k),alert("Could not fetch data.")}s(!1)},[]);be.useEffect(()=>{E()},[E]);const C=k=>{var D,R,P;return(D=k.name)!=null&&D.trim()?(R=k.description)!=null&&R.trim()?(P=k.rationale)!=null&&P.trim()?!k.points||k.points.length===0?(x("At least one point must be selected."),!1):!k.id&&i.some(Y=>Y.name.toLowerCase()===k.name.trim().toLowerCase()&&Y.id!==k.id)?(x("A protocol with this name already exists."),!1):(x(null),!0):(x("Protocol rationale is required."),!1):(x("Protocol description is required."),!1):(x("Protocol name is required."),!1)},w=async()=>{if(f&&C(f)){u(!0);try{const k={name:f.name.trim(),description:f.description.trim(),rationale:f.rationale.trim(),points:f.points};if(f.id){const O=vo(Nr,"protocols",f.id);await WM(O,k)}else await sB(Lc(Nr,"protocols"),k);p(null),E()}catch(k){x("Failed to save protocol."),console.error("Error saving protocol:",k)}u(!1)}},T=async()=>{if(g){s(!0);try{await qM(vo(Nr,"protocols",g.id)),E()}catch(k){console.error("Error deleting protocol:",k),alert("Failed to delete protocol.")}s(!1),v(null)}},N=k=>{const O=(k.points||[]).map(D=>typeof D=="string"?D:D.id);x(null),p({...k,points:O})},L=()=>{x(null),p({name:"",description:"",rationale:"",points:[]})},F=()=>{if(!f)return null;const k=O=>{const D=f.points||[],R=D.includes(O)?D.filter(P=>P!==O):[...D,O];p({...f,points:R})};return V.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-60 flex items-center justify-center z-50 p-4 animate-fade-in-fast",children:V.jsxs("div",{className:"bg-white rounded-2xl p-8 shadow-2xl w-full max-w-2xl m-4 transform transition-all",children:[V.jsx("h2",{className:"text-2xl font-black text-slate-900 tracking-tighter mb-4",children:f.id?"Edit Protocol":"Add New Protocol"}),_&&V.jsx("p",{className:"bg-red-100 text-red-700 p-3 rounded-lg text-sm mb-4",children:_}),o?V.jsx("div",{className:"flex justify-center items-center h-64",children:V.jsx(jv,{className:"animate-spin text-red-600",size:32})}):V.jsxs("div",{className:"space-y-4",children:[V.jsx("input",{type:"text",placeholder:"Protocol Name",value:f.name||"",onChange:O=>p({...f,name:O.target.value}),className:"w-full p-3 bg-slate-100 border border-slate-200 rounded-xl"}),V.jsx("textarea",{placeholder:"Protocol Description",value:f.description||"",onChange:O=>p({...f,description:O.target.value}),className:"w-full p-3 bg-slate-100 border border-slate-200 rounded-xl h-24"}),V.jsx("textarea",{placeholder:"Protocol Rationale",value:f.rationale||"",onChange:O=>p({...f,rationale:O.target.value}),className:"w-full p-3 bg-slate-100 border border-slate-200 rounded-xl h-24"}),V.jsxs("div",{children:[V.jsx("h3",{className:"text-sm font-bold text-slate-600 mb-2",children:"Select Points"}),V.jsx("div",{className:"max-h-60 overflow-y-auto p-3 bg-slate-50 border border-slate-200 rounded-xl grid grid-cols-2 md:grid-cols-3 gap-2",children:t.map(O=>V.jsxs("label",{className:`flex items-center space-x-2 p-2 rounded-lg cursor-pointer transition-colors text-sm ${(f.points||[]).includes(O.id)?"bg-red-100 text-red-800 font-semibold":"bg-white hover:bg-slate-100"}`,children:[V.jsx("input",{type:"checkbox",checked:(f.points||[]).includes(O.id),onChange:()=>k(O.id),className:"form-checkbox h-4 w-4 text-red-600 border-slate-300 rounded focus:ring-red-500"}),V.jsx("span",{className:"font-bold",children:O.code}),V.jsx("span",{className:"text-slate-600 truncate",children:O.label})]},O.id))})]})]}),V.jsxs("div",{className:"flex justify-end space-x-3 mt-6",children:[V.jsx("button",{onClick:()=>p(null),className:"font-bold text-slate-600 py-2 px-5",children:"Cancel"}),V.jsxs("button",{onClick:w,disabled:o,className:"bg-slate-800 text-white font-bold py-2 px-6 rounded-lg shadow hover:bg-slate-900 transition disabled:bg-slate-400 disabled:cursor-wait flex items-center",children:[V.jsx(dB,{size:16,className:"mr-2"})," ",o?"Saving...":"Save Protocol"]})]})]})})},G=()=>g?V.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-60 flex items-center justify-center z-50 p-4 animate-fade-in-fast",children:V.jsxs("div",{className:"bg-white rounded-2xl p-8 shadow-2xl w-full max-w-md m-4",children:[V.jsxs("div",{className:"flex items-start",children:[V.jsx("div",{className:"flex-shrink-0 flex items-center justify-center h-12 w-12 rounded-full bg-red-100 sm:mx-0 sm:h-10 sm:w-10 mr-4",children:V.jsx(my,{className:"h-6 w-6 text-red-600","aria-hidden":"true"})}),V.jsxs("div",{children:[V.jsx("h2",{className:"text-xl font-bold text-slate-900",children:"Delete Protocol"}),V.jsxs("p",{className:"text-slate-600 mt-2",children:["Are you sure you want to delete ",V.jsx("span",{className:"font-bold",children:g.name}),"? This action cannot be undone."]})]})]}),V.jsxs("div",{className:"flex justify-end space-x-3 mt-6",children:[V.jsx("button",{onClick:()=>v(null),className:"font-bold text-slate-600 py-2 px-5 rounded-lg hover:bg-slate-100 transition",children:"Cancel"}),V.jsx("button",{onClick:T,className:"bg-red-600 text-white font-bold py-2 px-5 rounded-lg shadow hover:bg-red-700 transition",children:"Confirm Delete"})]})]})}):null;return V.jsxs("div",{className:"p-8 max-w-7xl mx-auto animate-fade-in",children:[V.jsxs("div",{className:"flex justify-between items-center mb-6",children:[V.jsx("h1",{className:"text-3xl font-black text-slate-900 tracking-tighter",children:"Protocol Configuration"}),V.jsxs("button",{onClick:L,className:"bg-red-600 hover:bg-red-700 text-white font-bold py-2 px-4 rounded-lg flex items-center shadow-lg transition",children:[V.jsx(fB,{size:18,className:"mr-2"}),"Add New Protocol"]})]}),r?V.jsx("div",{className:"flex justify-center items-center p-16",children:V.jsx(jv,{className:"animate-spin text-red-600",size:40})}):V.jsx("div",{className:"bg-white rounded-3xl shadow-lg border border-slate-100",children:V.jsx("ul",{className:"divide-y divide-slate-100",children:i.length===0?V.jsx("p",{className:"p-8 text-center text-slate-500",children:"No protocols found. Click 'Add New Protocol' to start."}):i.map(k=>V.jsxs("li",{className:"p-4 flex justify-between items-center hover:bg-slate-50 transition-colors",children:[V.jsxs("div",{children:[V.jsx("p",{className:"font-bold text-slate-800",children:k.name}),V.jsx("p",{className:"text-sm text-slate-500 truncate max-w-xl",children:k.description}),V.jsxs("p",{className:"text-xs text-slate-400 font-mono mt-1",children:[(k.points||[]).length," points"]})]}),V.jsxs("div",{className:"flex space-x-4",children:[V.jsx("button",{onClick:()=>N(k),className:"text-slate-600 hover:text-slate-900",children:V.jsx(YM,{size:18})}),V.jsx("button",{onClick:()=>k.id&&v(k),className:"text-red-500 hover:text-red-700",children:V.jsx(rS,{size:18})})]})]},k.id))})}),F(),G()]})},L9=()=>{const[i,e]=be.useState([]),[t,n]=be.useState(!0),[r,s]=be.useState(null),[o,u]=be.useState(null),[f,p]=be.useState(null),[g,v]=be.useState(null),[_,x]=be.useState(!1),E=OA.useMemo(()=>Lc(Nr,"acupuncture_points"),[]),C=be.useCallback(async()=>{n(!0),p(null);try{const G=(await cf(E)).docs.map(k=>({...k.data(),id:k.id}));G.sort((k,O)=>k.code.localeCompare(O.code)),e(G)}catch(F){p("Failed to fetch points. Please try again."),console.error(F)}n(!1)},[E]);be.useEffect(()=>{C()},[C]);const w=(F,G)=>F.code.trim()?F.label.trim()?F.description.trim()?G&&i.some(O=>O.code.toLowerCase()===F.code.trim().toLowerCase())?(v(`A point with the code "${F.code.trim().toUpperCase()}" already exists.`),!1):(v(null),!0):(v("Point description is required."),!1):(v("Point label is required."),!1):(v("Point code is required."),!1),T=async F=>{const G=!F.id;if(!w(F,G))return;x(!0);const k=F.code.trim().toUpperCase(),O={code:k,label:F.label.trim(),description:F.description.trim(),position:F.position};try{if(G){const D=vo(Nr,"acupuncture_points",k);await db(D,O)}else{const D=vo(Nr,"acupuncture_points",F.id);await WM(D,O)}s(null),C()}catch(D){v("Failed to save point. Please try again."),console.error(D)}finally{x(!1)}},N=async()=>{if(o){x(!0);try{const F=vo(Nr,"acupuncture_points",o.id);await qM(F),C()}catch(F){p("Failed to delete point."),console.error(F)}x(!1),u(null)}},L=()=>{s(null),v(null)};return V.jsxs("div",{className:"p-8 max-w-7xl mx-auto animate-fade-in",children:[V.jsxs("div",{className:"flex justify-between items-center mb-6",children:[V.jsx("h1",{className:"text-3xl font-black text-slate-900 tracking-tighter",children:"Acupuncture Points"}),V.jsx("div",{children:V.jsxs("button",{onClick:()=>{v(null),s({id:"",code:"",label:"",description:"",position:{x:0,y:0,z:0}})},className:"bg-red-600 text-white font-bold py-2 px-4 rounded-lg flex items-center shadow-lg hover:bg-red-700 transition",children:[V.jsx(uB,{size:18,className:"mr-2"})," Add New Point"]})})]}),f&&V.jsx("p",{className:"text-red-500 bg-red-100 p-3 rounded-lg mb-4 text-center",children:f}),r&&V.jsx(O9,{point:r,onSave:T,onCancel:L,error:g,isSubmitting:_,points:i}),o&&V.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-60 flex items-center justify-center z-50 p-4 animate-fade-in-fast",children:V.jsxs("div",{className:"bg-white rounded-2xl p-8 shadow-2xl w-full max-w-md m-4",children:[V.jsxs("div",{className:"flex items-start",children:[V.jsx("div",{className:"flex-shrink-0 flex items-center justify-center h-12 w-12 rounded-full bg-red-100 sm:mx-0 sm:h-10 sm:w-10 mr-4",children:V.jsx(my,{className:"h-6 w-6 text-red-600","aria-hidden":"true"})}),V.jsxs("div",{children:[V.jsx("h2",{className:"text-xl font-bold text-slate-900",children:"Delete Point"}),V.jsxs("p",{className:"text-slate-600 mt-2",children:["Are you sure you want to delete ",V.jsx("span",{className:"font-bold",children:o.code}),"? This action cannot be undone."]})]})]}),V.jsxs("div",{className:"flex justify-end space-x-3 mt-6",children:[V.jsx("button",{onClick:()=>u(null),disabled:_,className:"font-bold text-slate-600 py-2 px-5 rounded-lg hover:bg-slate-100 transition disabled:opacity-50",children:"Cancel"}),V.jsx("button",{onClick:N,disabled:_,className:"bg-red-600 text-white font-bold py-2 px-5 rounded-lg shadow hover:bg-red-700 transition disabled:bg-red-400 disabled:cursor-wait",children:_?"Deleting...":"Confirm Delete"})]})]})}),V.jsx("div",{className:"bg-white rounded-3xl shadow-lg border border-slate-100 overflow-hidden",children:V.jsx("div",{className:"overflow-x-auto",children:V.jsxs("table",{className:"min-w-full divide-y divide-slate-200",children:[V.jsx("thead",{className:"bg-slate-50",children:V.jsxs("tr",{children:[V.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-bold text-slate-500 uppercase tracking-wider",children:"Code"}),V.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-bold text-slate-500 uppercase tracking-wider",children:"Label"}),V.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-bold text-slate-500 uppercase tracking-wider",children:"Description"}),V.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-bold text-slate-500 uppercase tracking-wider",children:"Position (x, y, z)"}),V.jsx("th",{scope:"col",className:"relative px-6 py-3",children:V.jsx("span",{className:"sr-only",children:"Actions"})})]})}),V.jsx("tbody",{className:"bg-white divide-y divide-slate-100",children:t&&!o?V.jsx("tr",{children:V.jsx("td",{colSpan:5,className:"text-center p-16",children:V.jsx(jv,{className:"animate-spin text-red-600",size:32})})}):i.length===0?V.jsx("tr",{children:V.jsx("td",{colSpan:5,className:"text-center p-8 text-slate-500",children:"No points found."})}):i.map(F=>V.jsxs("tr",{className:"hover:bg-slate-50",children:[V.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-bold text-red-600",children:F.code}),V.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-slate-800",children:F.label}),V.jsx("td",{className:"px-6 py-4 text-sm text-slate-600 max-w-xs truncate",title:F.description,children:F.description}),V.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-slate-500 font-mono",children:`(${F.position.x}, ${F.position.y}, ${F.position.z})`}),V.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium",children:[V.jsx("button",{onClick:()=>{v(null),s(F)},className:"text-slate-600 hover:text-slate-900 mr-4",children:V.jsx(YM,{size:18})}),V.jsx("button",{onClick:()=>u(F),className:"text-red-500 hover:text-red-700",children:V.jsx(rS,{size:18})})]})]},F.id))})]})})})]})},O9=({point:i,points:e,onSave:t,onCancel:n,error:r,isSubmitting:s})=>{const[o,u]=be.useState(i),[f,p]=be.useState(null);be.useEffect(()=>{u(i)},[i]);const g=E=>{const{name:C,value:w}=E.target;u(T=>({...T,[C]:w}))},v=E=>{const{name:C,value:w}=E.target;u(T=>({...T,position:{...T.position,[C]:parseFloat(w)||0}}))},_=E=>{if(E.preventDefault(),!o.code.trim()){p("Point code is required.");return}if(!o.label.trim()){p("Point label is required.");return}if(!o.description.trim()){p("Description is required.");return}if(!i.id&&e.some(T=>T.code.toLowerCase()===o.code.trim().toLowerCase())){p(`A point with the code "${o.code.trim().toUpperCase()}" already exists.`);return}p(null),t(o)},x=!!o.id;return V.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 animate-fade-in-fast",children:V.jsx("div",{className:"bg-white rounded-2xl p-8 shadow-2xl w-full max-w-lg m-4",children:V.jsxs("form",{onSubmit:_,className:"space-y-4",children:[V.jsx("h2",{className:"text-xl font-black text-slate-900 tracking-tighter mb-4",children:x?"Edit Point":"Add New Point"}),(r||f)&&V.jsx("p",{className:"bg-red-100 text-red-700 p-3 rounded-lg text-sm",children:r||f}),V.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[V.jsx("input",{type:"text",name:"code",value:o.code,onChange:g,placeholder:"Code (e.g. ST36)",className:"p-3 bg-slate-100 border border-slate-200 rounded-xl disabled:bg-slate-200 disabled:text-slate-500 disabled:cursor-not-allowed",required:!0,disabled:x}),V.jsx("input",{type:"text",name:"label",value:o.label,onChange:g,placeholder:"Label (e.g. Zusanli)",className:"p-3 bg-slate-100 border border-slate-200 rounded-xl",required:!0})]}),V.jsx("textarea",{name:"description",value:o.description,onChange:g,placeholder:"Description",className:"w-full p-3 bg-slate-100 border border-slate-200 rounded-xl",rows:3,required:!0}),V.jsxs("div",{children:[V.jsx("label",{className:"text-sm font-bold text-slate-600",children:"3D Position"}),V.jsxs("div",{className:"grid grid-cols-3 gap-2 mt-1",children:[V.jsx("input",{type:"number",name:"x",step:"0.01",value:o.position.x,onChange:v,placeholder:"X",className:"p-3 bg-slate-100 border border-slate-200 rounded-xl"}),V.jsx("input",{type:"number",name:"y",step:"0.01",value:o.position.y,onChange:v,placeholder:"Y",className:"p-3 bg-slate-100 border border-slate-200 rounded-xl"}),V.jsx("input",{type:"number",name:"z",step:"0.01",value:o.position.z,onChange:v,placeholder:"Z",className:"p-3 bg-slate-100 border border-slate-200 rounded-xl"})]})]}),V.jsxs("div",{className:"flex justify-end gap-3 pt-4",children:[V.jsx("button",{type:"button",onClick:n,disabled:s,className:"font-bold text-slate-600 py-2 px-5",children:"Cancel"}),V.jsxs("button",{type:"submit",disabled:s,className:"bg-slate-800 text-white font-bold py-2 px-5 rounded-lg flex items-center shadow hover:bg-slate-900 transition disabled:bg-slate-400 disabled:cursor-wait",children:[V.jsx(dB,{size:16,className:"mr-2"}),s?"Saving...":"Save Point"]})]})]})})})},U9=({patient:i,onBack:e,onProtocolSelect:t,treatmentNotes:n,setTreatmentNotes:r})=>{const[s,o]=be.useState([]),[u,f]=be.useState([]),[p,g]=be.useState(!1),[v,_]=be.useState(!1),[x,E]=be.useState(!1),C=n.report.trim()!==""&&n.bloodPressure.trim()!==""&&n.heartRate.trim()!=="";be.useEffect(()=>{(async()=>{g(!0);const L=(await cf(Lc(Nr,"protocols"))).docs.map(F=>({...F.data(),id:F.id}));o(L),g(!1)})()},[]);const w=async()=>{if(!C)return;_(!0),E(!1),await new Promise(N=>setTimeout(N,1500));const T=s.slice(0,3);f(T),_(!1)};return V.jsxs("div",{className:"max-w-4xl mx-auto animate-fade-in",children:[V.jsxs("div",{className:"flex justify-between items-center mb-6",children:[V.jsxs("div",{children:[V.jsx("h2",{className:"text-3xl font-black text-slate-900 tracking-tighter",children:"Start New Treatment"}),V.jsxs("p",{className:"text-slate-500",children:["For patient: ",i.fullName]})]}),V.jsxs("button",{onClick:e,className:"flex items-center gap-2 text-sm font-bold text-slate-600 hover:text-slate-900 transition",children:[V.jsx(XM,{size:16})," Back to Dashboard"]})]}),V.jsxs("div",{className:"bg-white rounded-3xl p-8 border border-slate-100 shadow-lg",children:[V.jsxs("div",{className:"mb-6",children:[V.jsx("label",{className:"text-[10px] font-bold text-slate-500 uppercase",htmlFor:"patientReport",children:"Patient Report *"}),V.jsx("textarea",{id:"patientReport",value:n.report,onChange:T=>r({...n,report:T.target.value}),className:"w-full p-3 mt-1 bg-slate-50 border border-slate-200 rounded-xl",rows:5,placeholder:"Describe the patient\\'s current condition and reason for treatment..."})]}),V.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 mb-8",children:[V.jsxs("div",{children:[V.jsx("label",{className:"text-[10px] font-bold text-slate-500 uppercase",htmlFor:"bloodPressure",children:"Blood Pressure *"}),V.jsx("input",{id:"bloodPressure",type:"text",value:n.bloodPressure,onChange:T=>r({...n,bloodPressure:T.target.value}),className:"w-full p-3 mt-1 bg-slate-50 border border-slate-200 rounded-xl",placeholder:"e.g., 120/80"})]}),V.jsxs("div",{children:[V.jsx("label",{className:"text-[10px] font-bold text-slate-500 uppercase",htmlFor:"heartRate",children:"Heart Rate *"}),V.jsx("input",{id:"heartRate",type:"text",value:n.heartRate,onChange:T=>r({...n,heartRate:T.target.value}),className:"w-full p-3 mt-1 bg-slate-50 border border-slate-200 rounded-xl",placeholder:"e.g., 72 bpm"})]})]}),V.jsx("div",{className:"text-center mb-8",children:V.jsx("button",{onClick:w,disabled:!C||v,className:"bg-yellow-500 hover:bg-yellow-400 text-slate-900 font-bold py-3 px-8 rounded-xl transition flex items-center gap-2 shadow-lg shadow-yellow-500/10 mx-auto disabled:bg-slate-300 disabled:text-slate-500 disabled:shadow-none disabled:cursor-not-allowed",children:v?V.jsx(V.Fragment,{children:"Finding Protocols..."}):V.jsxs(V.Fragment,{children:[V.jsx(X5,{size:16})," Find Suggested Protocols"]})})}),v?V.jsx("div",{className:"text-center p-8 text-slate-500",children:"Analyzing report and finding best protocols..."}):u.length>0&&V.jsxs("div",{className:"animate-fade-in",children:[V.jsx("h3",{className:"text-xl font-bold mb-4 text-center",children:"AI Suggested Protocols"}),V.jsx("div",{className:"space-y-3 mb-8",children:u.map(T=>V.jsxs("div",{onClick:()=>t(T),className:"bg-slate-50 border-2 border-slate-200 hover:border-yellow-500 rounded-xl p-4 cursor-pointer transition-all",children:[V.jsx("h4",{className:"font-bold text-slate-800",children:T.name}),V.jsx("p",{className:"text-sm text-slate-600",children:T.description})]},T.id))})]}),V.jsxs("div",{className:"flex items-center gap-4 my-8",children:[V.jsx("div",{className:"flex-grow h-px bg-slate-200"}),V.jsx("span",{className:"text-slate-400 font-semibold text-sm",children:"OR"}),V.jsx("div",{className:"flex-grow h-px bg-slate-200"})]}),V.jsx("div",{className:"text-center",children:V.jsxs("button",{onClick:()=>E(!x),disabled:!C||s.length===0&&!p,className:"bg-slate-800 hover:bg-slate-700 text-white font-bold py-3 px-8 rounded-xl transition flex items-center gap-2 shadow-lg shadow-slate-800/10 mx-auto disabled:bg-slate-300 disabled:text-slate-500 disabled:shadow-none disabled:cursor-not-allowed",children:[V.jsx(hB,{size:16})," ",x?"Hide Full List":"Select from Full List"]})}),x&&V.jsxs("div",{className:"animate-fade-in mt-8",children:[V.jsx("h3",{className:"text-xl font-bold mb-4 text-center",children:"All Protocols"}),p?V.jsx("div",{className:"text-center p-8 text-slate-500",children:"Loading protocols..."}):s.length===0?V.jsx("div",{className:"text-center p-8 text-slate-500",children:"No protocols found. Please add protocols in the admin section."}):V.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:s.map(T=>V.jsx("div",{onClick:()=>t(T),className:"bg-white border-2 border-slate-200 hover:border-yellow-500 rounded-xl p-4 cursor-pointer transition-all",children:V.jsx("h4",{className:"font-bold text-slate-800",children:T.name})},T.id))})]})]})]})};/**
 * @license
 * Copyright 2010-2025 Three.js Authors
 * SPDX-License-Identifier: MIT
 */const gy="182",Md={LEFT:0,MIDDLE:1,RIGHT:2,ROTATE:0,DOLLY:1,PAN:2},wd={ROTATE:0,PAN:1,DOLLY_PAN:2,DOLLY_ROTATE:3},pB=0,AT=1,mB=2,F9=3,gB=0,Wm=1,Tv=2,Nd=3,Gc=0,Ca=1,yo=2,Gl=0,Hd=1,ST=2,ET=3,TT=4,vB=5,Qh=100,yB=101,_B=102,xB=103,bB=104,AB=200,SB=201,EB=202,TB=203,Ub=204,Fb=205,MB=206,wB=207,CB=208,RB=209,IB=210,DB=211,NB=212,PB=213,BB=214,kb=0,zb=1,Vb=2,Qd=3,Hb=4,Gb=5,jb=6,Wb=7,vy=0,LB=1,OB=2,ol=0,KM=1,QM=2,ZM=3,sS=4,$M=5,ew=6,tw=7,MT="attached",UB="detached",vf=300,ql=301,yf=302,rg=303,Wv=304,Mg=306,_f=1e3,Sr=1001,sg=1002,Pr=1003,aS=1004,k9=1004,Pd=1005,z9=1005,Jn=1006,qm=1007,V9=1007,sl=1008,wT=1008,vs=1009,oS=1010,lS=1011,ag=1012,yy=1013,So=1014,ir=1015,Er=1016,cS=1017,uS=1018,og=1020,nw=35902,iw=35899,rw=1021,sw=1022,jr=1023,jc=1026,$h=1027,_y=1028,xy=1029,Zd=1030,hS=1031,H9=1032,fS=1033,Mv=33776,wv=33777,Cv=33778,Rv=33779,qb=35840,Xb=35841,Yb=35842,Jb=35843,Kb=36196,Qb=37492,Zb=37496,$b=37488,eA=37489,tA=37490,nA=37491,iA=37808,rA=37809,sA=37810,aA=37811,oA=37812,lA=37813,cA=37814,uA=37815,hA=37816,fA=37817,dA=37818,pA=37819,mA=37820,gA=37821,vA=36492,yA=36494,_A=36495,xA=36283,bA=36284,AA=36285,SA=36286,FB=2200,kB=2201,zB=2202,lg=2300,cg=2301,pb=2302,Bd=2400,Ld=2401,qv=2402,dS=2500,aw=2501,VB=0,ow=1,EA=2,HB=3200,G9=3201,j9=3202,W9=3203,Ef=0,GB=1,Nu="",Fs="srgb",Xl="srgb-linear",Xv="linear",wi="srgb",q9="",X9="rg",Y9="ga",J9=0,Cd=7680,K9=7681,Q9=7682,Z9=7683,$9=34055,eH=34056,tH=5386,nH=512,iH=513,rH=514,sH=515,aH=516,oH=517,lH=518,CT=519,jB=512,WB=513,qB=514,pS=515,XB=516,YB=517,mS=518,JB=519,Yv=35044,cH=35048,uH=35040,hH=35045,fH=35049,dH=35041,pH=35046,mH=35050,gH=35042,vH="100",RT="300 es",xo=2e3,ug=2001,yH={COMPUTE:"compute",RENDER:"render"},_H={PERSPECTIVE:"perspective",LINEAR:"linear",FLAT:"flat"},xH={NORMAL:"normal",CENTROID:"centroid",SAMPLE:"sample",FIRST:"first",EITHER:"either"};function KB(i){for(let e=i.length-1;e>=0;--e)if(i[e]>=65535)return!0;return!1}const bH={Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array};function Fm(i,e){return new bH[i](e)}function QB(i){return ArrayBuffer.isView(i)&&!(i instanceof DataView)}function Jv(i){return document.createElementNS("http://www.w3.org/1999/xhtml",i)}function ZB(){const i=Jv("canvas");return i.style.display="block",i}const CI={};let xf=null;function AH(i){xf=i}function SH(){return xf}function Kv(...i){const e="THREE."+i.shift();xf?xf("log",e,...i):console.log(e,...i)}function Ht(...i){const e="THREE."+i.shift();xf?xf("warn",e,...i):console.warn(e,...i)}function cn(...i){const e="THREE."+i.shift();xf?xf("error",e,...i):console.error(e,...i)}function hg(...i){const e=i.join(" ");e in CI||(CI[e]=!0,Ht(...i))}function EH(i,e,t){return new Promise(function(n,r){function s(){switch(i.clientWaitSync(e,i.SYNC_FLUSH_COMMANDS_BIT,0)){case i.WAIT_FAILED:r();break;case i.TIMEOUT_EXPIRED:setTimeout(s,t);break;default:n()}}setTimeout(s,t)})}let Wc=class{addEventListener(e,t){this._listeners===void 0&&(this._listeners={});const n=this._listeners;n[e]===void 0&&(n[e]=[]),n[e].indexOf(t)===-1&&n[e].push(t)}hasEventListener(e,t){const n=this._listeners;return n===void 0?!1:n[e]!==void 0&&n[e].indexOf(t)!==-1}removeEventListener(e,t){const n=this._listeners;if(n===void 0)return;const r=n[e];if(r!==void 0){const s=r.indexOf(t);s!==-1&&r.splice(s,1)}}dispatchEvent(e){const t=this._listeners;if(t===void 0)return;const n=t[e.type];if(n!==void 0){e.target=this;const r=n.slice(0);for(let s=0,o=r.length;s<o;s++)r[s].call(this,e);e.target=null}}};const sa=["00","01","02","03","04","05","06","07","08","09","0a","0b","0c","0d","0e","0f","10","11","12","13","14","15","16","17","18","19","1a","1b","1c","1d","1e","1f","20","21","22","23","24","25","26","27","28","29","2a","2b","2c","2d","2e","2f","30","31","32","33","34","35","36","37","38","39","3a","3b","3c","3d","3e","3f","40","41","42","43","44","45","46","47","48","49","4a","4b","4c","4d","4e","4f","50","51","52","53","54","55","56","57","58","59","5a","5b","5c","5d","5e","5f","60","61","62","63","64","65","66","67","68","69","6a","6b","6c","6d","6e","6f","70","71","72","73","74","75","76","77","78","79","7a","7b","7c","7d","7e","7f","80","81","82","83","84","85","86","87","88","89","8a","8b","8c","8d","8e","8f","90","91","92","93","94","95","96","97","98","99","9a","9b","9c","9d","9e","9f","a0","a1","a2","a3","a4","a5","a6","a7","a8","a9","aa","ab","ac","ad","ae","af","b0","b1","b2","b3","b4","b5","b6","b7","b8","b9","ba","bb","bc","bd","be","bf","c0","c1","c2","c3","c4","c5","c6","c7","c8","c9","ca","cb","cc","cd","ce","cf","d0","d1","d2","d3","d4","d5","d6","d7","d8","d9","da","db","dc","dd","de","df","e0","e1","e2","e3","e4","e5","e6","e7","e8","e9","ea","eb","ec","ed","ee","ef","f0","f1","f2","f3","f4","f5","f6","f7","f8","f9","fa","fb","fc","fd","fe","ff"];let RI=1234567;const Gd=Math.PI/180,fg=180/Math.PI;function bo(){const i=Math.random()*4294967295|0,e=Math.random()*4294967295|0,t=Math.random()*4294967295|0,n=Math.random()*4294967295|0;return(sa[i&255]+sa[i>>8&255]+sa[i>>16&255]+sa[i>>24&255]+"-"+sa[e&255]+sa[e>>8&255]+"-"+sa[e>>16&15|64]+sa[e>>24&255]+"-"+sa[t&63|128]+sa[t>>8&255]+"-"+sa[t>>16&255]+sa[t>>24&255]+sa[n&255]+sa[n>>8&255]+sa[n>>16&255]+sa[n>>24&255]).toLowerCase()}function An(i,e,t){return Math.max(e,Math.min(t,i))}function lw(i,e){return(i%e+e)%e}function TH(i,e,t,n,r){return n+(i-e)*(r-n)/(t-e)}function MH(i,e,t){return i!==e?(t-i)/(e-i):0}function Iv(i,e,t){return(1-t)*i+t*e}function wH(i,e,t,n){return Iv(i,e,1-Math.exp(-t*n))}function CH(i,e=1){return e-Math.abs(lw(i,e*2)-e)}function RH(i,e,t){return i<=e?0:i>=t?1:(i=(i-e)/(t-e),i*i*(3-2*i))}function IH(i,e,t){return i<=e?0:i>=t?1:(i=(i-e)/(t-e),i*i*i*(i*(i*6-15)+10))}function DH(i,e){return i+Math.floor(Math.random()*(e-i+1))}function NH(i,e){return i+Math.random()*(e-i)}function PH(i){return i*(.5-Math.random())}function BH(i){i!==void 0&&(RI=i);let e=RI+=1831565813;return e=Math.imul(e^e>>>15,e|1),e^=e+Math.imul(e^e>>>7,e|61),((e^e>>>14)>>>0)/4294967296}function LH(i){return i*Gd}function OH(i){return i*fg}function UH(i){return(i&i-1)===0&&i!==0}function FH(i){return Math.pow(2,Math.ceil(Math.log(i)/Math.LN2))}function kH(i){return Math.pow(2,Math.floor(Math.log(i)/Math.LN2))}function zH(i,e,t,n,r){const s=Math.cos,o=Math.sin,u=s(t/2),f=o(t/2),p=s((e+n)/2),g=o((e+n)/2),v=s((e-n)/2),_=o((e-n)/2),x=s((n-e)/2),E=o((n-e)/2);switch(r){case"XYX":i.set(u*g,f*v,f*_,u*p);break;case"YZY":i.set(f*_,u*g,f*v,u*p);break;case"ZXZ":i.set(f*v,f*_,u*g,u*p);break;case"XZX":i.set(u*g,f*E,f*x,u*p);break;case"YXY":i.set(f*x,u*g,f*E,u*p);break;case"ZYZ":i.set(f*E,f*x,u*g,u*p);break;default:Ht("MathUtils: .setQuaternionFromProperEuler() encountered an unknown order: "+r)}}function wa(i,e){switch(e.constructor){case Float32Array:return i;case Uint32Array:return i/4294967295;case Uint16Array:return i/65535;case Uint8Array:return i/255;case Int32Array:return Math.max(i/2147483647,-1);case Int16Array:return Math.max(i/32767,-1);case Int8Array:return Math.max(i/127,-1);default:throw new Error("Invalid component type.")}}function Vn(i,e){switch(e.constructor){case Float32Array:return i;case Uint32Array:return Math.round(i*4294967295);case Uint16Array:return Math.round(i*65535);case Uint8Array:return Math.round(i*255);case Int32Array:return Math.round(i*2147483647);case Int16Array:return Math.round(i*32767);case Int8Array:return Math.round(i*127);default:throw new Error("Invalid component type.")}}const $B={DEG2RAD:Gd,RAD2DEG:fg,generateUUID:bo,clamp:An,euclideanModulo:lw,mapLinear:TH,inverseLerp:MH,lerp:Iv,damp:wH,pingpong:CH,smoothstep:RH,smootherstep:IH,randInt:DH,randFloat:NH,randFloatSpread:PH,seededRandom:BH,degToRad:LH,radToDeg:OH,isPowerOfTwo:UH,ceilPowerOfTwo:FH,floorPowerOfTwo:kH,setQuaternionFromProperEuler:zH,normalize:Vn,denormalize:wa};class $e{constructor(e=0,t=0){$e.prototype.isVector2=!0,this.x=e,this.y=t}get width(){return this.x}set width(e){this.x=e}get height(){return this.y}set height(e){this.y=e}set(e,t){return this.x=e,this.y=t,this}setScalar(e){return this.x=e,this.y=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y)}copy(e){return this.x=e.x,this.y=e.y,this}add(e){return this.x+=e.x,this.y+=e.y,this}addScalar(e){return this.x+=e,this.y+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this}subScalar(e){return this.x-=e,this.y-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this}multiply(e){return this.x*=e.x,this.y*=e.y,this}multiplyScalar(e){return this.x*=e,this.y*=e,this}divide(e){return this.x/=e.x,this.y/=e.y,this}divideScalar(e){return this.multiplyScalar(1/e)}applyMatrix3(e){const t=this.x,n=this.y,r=e.elements;return this.x=r[0]*t+r[3]*n+r[6],this.y=r[1]*t+r[4]*n+r[7],this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this}clamp(e,t){return this.x=An(this.x,e.x,t.x),this.y=An(this.y,e.y,t.y),this}clampScalar(e,t){return this.x=An(this.x,e,t),this.y=An(this.y,e,t),this}clampLength(e,t){const n=this.length();return this.divideScalar(n||1).multiplyScalar(An(n,e,t))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this}negate(){return this.x=-this.x,this.y=-this.y,this}dot(e){return this.x*e.x+this.y*e.y}cross(e){return this.x*e.y-this.y*e.x}lengthSq(){return this.x*this.x+this.y*this.y}length(){return Math.sqrt(this.x*this.x+this.y*this.y)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)}normalize(){return this.divideScalar(this.length()||1)}angle(){return Math.atan2(-this.y,-this.x)+Math.PI}angleTo(e){const t=Math.sqrt(this.lengthSq()*e.lengthSq());if(t===0)return Math.PI/2;const n=this.dot(e)/t;return Math.acos(An(n,-1,1))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){const t=this.x-e.x,n=this.y-e.y;return t*t+n*n}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this}lerpVectors(e,t,n){return this.x=e.x+(t.x-e.x)*n,this.y=e.y+(t.y-e.y)*n,this}equals(e){return e.x===this.x&&e.y===this.y}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this}rotateAround(e,t){const n=Math.cos(t),r=Math.sin(t),s=this.x-e.x,o=this.y-e.y;return this.x=s*n-o*r+e.x,this.y=s*r+o*n+e.y,this}random(){return this.x=Math.random(),this.y=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y}}class ys{constructor(e=0,t=0,n=0,r=1){this.isQuaternion=!0,this._x=e,this._y=t,this._z=n,this._w=r}static slerpFlat(e,t,n,r,s,o,u){let f=n[r+0],p=n[r+1],g=n[r+2],v=n[r+3],_=s[o+0],x=s[o+1],E=s[o+2],C=s[o+3];if(u<=0){e[t+0]=f,e[t+1]=p,e[t+2]=g,e[t+3]=v;return}if(u>=1){e[t+0]=_,e[t+1]=x,e[t+2]=E,e[t+3]=C;return}if(v!==C||f!==_||p!==x||g!==E){let w=f*_+p*x+g*E+v*C;w<0&&(_=-_,x=-x,E=-E,C=-C,w=-w);let T=1-u;if(w<.9995){const N=Math.acos(w),L=Math.sin(N);T=Math.sin(T*N)/L,u=Math.sin(u*N)/L,f=f*T+_*u,p=p*T+x*u,g=g*T+E*u,v=v*T+C*u}else{f=f*T+_*u,p=p*T+x*u,g=g*T+E*u,v=v*T+C*u;const N=1/Math.sqrt(f*f+p*p+g*g+v*v);f*=N,p*=N,g*=N,v*=N}}e[t]=f,e[t+1]=p,e[t+2]=g,e[t+3]=v}static multiplyQuaternionsFlat(e,t,n,r,s,o){const u=n[r],f=n[r+1],p=n[r+2],g=n[r+3],v=s[o],_=s[o+1],x=s[o+2],E=s[o+3];return e[t]=u*E+g*v+f*x-p*_,e[t+1]=f*E+g*_+p*v-u*x,e[t+2]=p*E+g*x+u*_-f*v,e[t+3]=g*E-u*v-f*_-p*x,e}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get w(){return this._w}set w(e){this._w=e,this._onChangeCallback()}set(e,t,n,r){return this._x=e,this._y=t,this._z=n,this._w=r,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._w)}copy(e){return this._x=e.x,this._y=e.y,this._z=e.z,this._w=e.w,this._onChangeCallback(),this}setFromEuler(e,t=!0){const n=e._x,r=e._y,s=e._z,o=e._order,u=Math.cos,f=Math.sin,p=u(n/2),g=u(r/2),v=u(s/2),_=f(n/2),x=f(r/2),E=f(s/2);switch(o){case"XYZ":this._x=_*g*v+p*x*E,this._y=p*x*v-_*g*E,this._z=p*g*E+_*x*v,this._w=p*g*v-_*x*E;break;case"YXZ":this._x=_*g*v+p*x*E,this._y=p*x*v-_*g*E,this._z=p*g*E-_*x*v,this._w=p*g*v+_*x*E;break;case"ZXY":this._x=_*g*v-p*x*E,this._y=p*x*v+_*g*E,this._z=p*g*E+_*x*v,this._w=p*g*v-_*x*E;break;case"ZYX":this._x=_*g*v-p*x*E,this._y=p*x*v+_*g*E,this._z=p*g*E-_*x*v,this._w=p*g*v+_*x*E;break;case"YZX":this._x=_*g*v+p*x*E,this._y=p*x*v+_*g*E,this._z=p*g*E-_*x*v,this._w=p*g*v-_*x*E;break;case"XZY":this._x=_*g*v-p*x*E,this._y=p*x*v-_*g*E,this._z=p*g*E+_*x*v,this._w=p*g*v+_*x*E;break;default:Ht("Quaternion: .setFromEuler() encountered an unknown order: "+o)}return t===!0&&this._onChangeCallback(),this}setFromAxisAngle(e,t){const n=t/2,r=Math.sin(n);return this._x=e.x*r,this._y=e.y*r,this._z=e.z*r,this._w=Math.cos(n),this._onChangeCallback(),this}setFromRotationMatrix(e){const t=e.elements,n=t[0],r=t[4],s=t[8],o=t[1],u=t[5],f=t[9],p=t[2],g=t[6],v=t[10],_=n+u+v;if(_>0){const x=.5/Math.sqrt(_+1);this._w=.25/x,this._x=(g-f)*x,this._y=(s-p)*x,this._z=(o-r)*x}else if(n>u&&n>v){const x=2*Math.sqrt(1+n-u-v);this._w=(g-f)/x,this._x=.25*x,this._y=(r+o)/x,this._z=(s+p)/x}else if(u>v){const x=2*Math.sqrt(1+u-n-v);this._w=(s-p)/x,this._x=(r+o)/x,this._y=.25*x,this._z=(f+g)/x}else{const x=2*Math.sqrt(1+v-n-u);this._w=(o-r)/x,this._x=(s+p)/x,this._y=(f+g)/x,this._z=.25*x}return this._onChangeCallback(),this}setFromUnitVectors(e,t){let n=e.dot(t)+1;return n<1e-8?(n=0,Math.abs(e.x)>Math.abs(e.z)?(this._x=-e.y,this._y=e.x,this._z=0,this._w=n):(this._x=0,this._y=-e.z,this._z=e.y,this._w=n)):(this._x=e.y*t.z-e.z*t.y,this._y=e.z*t.x-e.x*t.z,this._z=e.x*t.y-e.y*t.x,this._w=n),this.normalize()}angleTo(e){return 2*Math.acos(Math.abs(An(this.dot(e),-1,1)))}rotateTowards(e,t){const n=this.angleTo(e);if(n===0)return this;const r=Math.min(1,t/n);return this.slerp(e,r),this}identity(){return this.set(0,0,0,1)}invert(){return this.conjugate()}conjugate(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this}dot(e){return this._x*e._x+this._y*e._y+this._z*e._z+this._w*e._w}lengthSq(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w}length(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)}normalize(){let e=this.length();return e===0?(this._x=0,this._y=0,this._z=0,this._w=1):(e=1/e,this._x=this._x*e,this._y=this._y*e,this._z=this._z*e,this._w=this._w*e),this._onChangeCallback(),this}multiply(e){return this.multiplyQuaternions(this,e)}premultiply(e){return this.multiplyQuaternions(e,this)}multiplyQuaternions(e,t){const n=e._x,r=e._y,s=e._z,o=e._w,u=t._x,f=t._y,p=t._z,g=t._w;return this._x=n*g+o*u+r*p-s*f,this._y=r*g+o*f+s*u-n*p,this._z=s*g+o*p+n*f-r*u,this._w=o*g-n*u-r*f-s*p,this._onChangeCallback(),this}slerp(e,t){if(t<=0)return this;if(t>=1)return this.copy(e);let n=e._x,r=e._y,s=e._z,o=e._w,u=this.dot(e);u<0&&(n=-n,r=-r,s=-s,o=-o,u=-u);let f=1-t;if(u<.9995){const p=Math.acos(u),g=Math.sin(p);f=Math.sin(f*p)/g,t=Math.sin(t*p)/g,this._x=this._x*f+n*t,this._y=this._y*f+r*t,this._z=this._z*f+s*t,this._w=this._w*f+o*t,this._onChangeCallback()}else this._x=this._x*f+n*t,this._y=this._y*f+r*t,this._z=this._z*f+s*t,this._w=this._w*f+o*t,this.normalize();return this}slerpQuaternions(e,t,n){return this.copy(e).slerp(t,n)}random(){const e=2*Math.PI*Math.random(),t=2*Math.PI*Math.random(),n=Math.random(),r=Math.sqrt(1-n),s=Math.sqrt(n);return this.set(r*Math.sin(e),r*Math.cos(e),s*Math.sin(t),s*Math.cos(t))}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._w===this._w}fromArray(e,t=0){return this._x=e[t],this._y=e[t+1],this._z=e[t+2],this._w=e[t+3],this._onChangeCallback(),this}toArray(e=[],t=0){return e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._w,e}fromBufferAttribute(e,t){return this._x=e.getX(t),this._y=e.getY(t),this._z=e.getZ(t),this._w=e.getW(t),this._onChangeCallback(),this}toJSON(){return this.toArray()}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._w}}class ie{constructor(e=0,t=0,n=0){ie.prototype.isVector3=!0,this.x=e,this.y=t,this.z=n}set(e,t,n){return n===void 0&&(n=this.z),this.x=e,this.y=t,this.z=n,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this}multiplyVectors(e,t){return this.x=e.x*t.x,this.y=e.y*t.y,this.z=e.z*t.z,this}applyEuler(e){return this.applyQuaternion(II.setFromEuler(e))}applyAxisAngle(e,t){return this.applyQuaternion(II.setFromAxisAngle(e,t))}applyMatrix3(e){const t=this.x,n=this.y,r=this.z,s=e.elements;return this.x=s[0]*t+s[3]*n+s[6]*r,this.y=s[1]*t+s[4]*n+s[7]*r,this.z=s[2]*t+s[5]*n+s[8]*r,this}applyNormalMatrix(e){return this.applyMatrix3(e).normalize()}applyMatrix4(e){const t=this.x,n=this.y,r=this.z,s=e.elements,o=1/(s[3]*t+s[7]*n+s[11]*r+s[15]);return this.x=(s[0]*t+s[4]*n+s[8]*r+s[12])*o,this.y=(s[1]*t+s[5]*n+s[9]*r+s[13])*o,this.z=(s[2]*t+s[6]*n+s[10]*r+s[14])*o,this}applyQuaternion(e){const t=this.x,n=this.y,r=this.z,s=e.x,o=e.y,u=e.z,f=e.w,p=2*(o*r-u*n),g=2*(u*t-s*r),v=2*(s*n-o*t);return this.x=t+f*p+o*v-u*g,this.y=n+f*g+u*p-s*v,this.z=r+f*v+s*g-o*p,this}project(e){return this.applyMatrix4(e.matrixWorldInverse).applyMatrix4(e.projectionMatrix)}unproject(e){return this.applyMatrix4(e.projectionMatrixInverse).applyMatrix4(e.matrixWorld)}transformDirection(e){const t=this.x,n=this.y,r=this.z,s=e.elements;return this.x=s[0]*t+s[4]*n+s[8]*r,this.y=s[1]*t+s[5]*n+s[9]*r,this.z=s[2]*t+s[6]*n+s[10]*r,this.normalize()}divide(e){return this.x/=e.x,this.y/=e.y,this.z/=e.z,this}divideScalar(e){return this.multiplyScalar(1/e)}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this}clamp(e,t){return this.x=An(this.x,e.x,t.x),this.y=An(this.y,e.y,t.y),this.z=An(this.z,e.z,t.z),this}clampScalar(e,t){return this.x=An(this.x,e,t),this.y=An(this.y,e,t),this.z=An(this.z,e,t),this}clampLength(e,t){const n=this.length();return this.divideScalar(n||1).multiplyScalar(An(n,e,t))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this.z=Math.trunc(this.z),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this}lerpVectors(e,t,n){return this.x=e.x+(t.x-e.x)*n,this.y=e.y+(t.y-e.y)*n,this.z=e.z+(t.z-e.z)*n,this}cross(e){return this.crossVectors(this,e)}crossVectors(e,t){const n=e.x,r=e.y,s=e.z,o=t.x,u=t.y,f=t.z;return this.x=r*f-s*u,this.y=s*o-n*f,this.z=n*u-r*o,this}projectOnVector(e){const t=e.lengthSq();if(t===0)return this.set(0,0,0);const n=e.dot(this)/t;return this.copy(e).multiplyScalar(n)}projectOnPlane(e){return HE.copy(this).projectOnVector(e),this.sub(HE)}reflect(e){return this.sub(HE.copy(e).multiplyScalar(2*this.dot(e)))}angleTo(e){const t=Math.sqrt(this.lengthSq()*e.lengthSq());if(t===0)return Math.PI/2;const n=this.dot(e)/t;return Math.acos(An(n,-1,1))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){const t=this.x-e.x,n=this.y-e.y,r=this.z-e.z;return t*t+n*n+r*r}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)+Math.abs(this.z-e.z)}setFromSpherical(e){return this.setFromSphericalCoords(e.radius,e.phi,e.theta)}setFromSphericalCoords(e,t,n){const r=Math.sin(t)*e;return this.x=r*Math.sin(n),this.y=Math.cos(t)*e,this.z=r*Math.cos(n),this}setFromCylindrical(e){return this.setFromCylindricalCoords(e.radius,e.theta,e.y)}setFromCylindricalCoords(e,t,n){return this.x=e*Math.sin(t),this.y=n,this.z=e*Math.cos(t),this}setFromMatrixPosition(e){const t=e.elements;return this.x=t[12],this.y=t[13],this.z=t[14],this}setFromMatrixScale(e){const t=this.setFromMatrixColumn(e,0).length(),n=this.setFromMatrixColumn(e,1).length(),r=this.setFromMatrixColumn(e,2).length();return this.x=t,this.y=n,this.z=r,this}setFromMatrixColumn(e,t){return this.fromArray(e.elements,t*4)}setFromMatrix3Column(e,t){return this.fromArray(e.elements,t*3)}setFromEuler(e){return this.x=e._x,this.y=e._y,this.z=e._z,this}setFromColor(e){return this.x=e.r,this.y=e.g,this.z=e.b,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this.z=e[t+2],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this}randomDirection(){const e=Math.random()*Math.PI*2,t=Math.random()*2-1,n=Math.sqrt(1-t*t);return this.x=n*Math.cos(e),this.y=t,this.z=n*Math.sin(e),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z}}const HE=new ie,II=new ys;class Un{constructor(e,t,n,r,s,o,u,f,p){Un.prototype.isMatrix3=!0,this.elements=[1,0,0,0,1,0,0,0,1],e!==void 0&&this.set(e,t,n,r,s,o,u,f,p)}set(e,t,n,r,s,o,u,f,p){const g=this.elements;return g[0]=e,g[1]=r,g[2]=u,g[3]=t,g[4]=s,g[5]=f,g[6]=n,g[7]=o,g[8]=p,this}identity(){return this.set(1,0,0,0,1,0,0,0,1),this}copy(e){const t=this.elements,n=e.elements;return t[0]=n[0],t[1]=n[1],t[2]=n[2],t[3]=n[3],t[4]=n[4],t[5]=n[5],t[6]=n[6],t[7]=n[7],t[8]=n[8],this}extractBasis(e,t,n){return e.setFromMatrix3Column(this,0),t.setFromMatrix3Column(this,1),n.setFromMatrix3Column(this,2),this}setFromMatrix4(e){const t=e.elements;return this.set(t[0],t[4],t[8],t[1],t[5],t[9],t[2],t[6],t[10]),this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,t){const n=e.elements,r=t.elements,s=this.elements,o=n[0],u=n[3],f=n[6],p=n[1],g=n[4],v=n[7],_=n[2],x=n[5],E=n[8],C=r[0],w=r[3],T=r[6],N=r[1],L=r[4],F=r[7],G=r[2],k=r[5],O=r[8];return s[0]=o*C+u*N+f*G,s[3]=o*w+u*L+f*k,s[6]=o*T+u*F+f*O,s[1]=p*C+g*N+v*G,s[4]=p*w+g*L+v*k,s[7]=p*T+g*F+v*O,s[2]=_*C+x*N+E*G,s[5]=_*w+x*L+E*k,s[8]=_*T+x*F+E*O,this}multiplyScalar(e){const t=this.elements;return t[0]*=e,t[3]*=e,t[6]*=e,t[1]*=e,t[4]*=e,t[7]*=e,t[2]*=e,t[5]*=e,t[8]*=e,this}determinant(){const e=this.elements,t=e[0],n=e[1],r=e[2],s=e[3],o=e[4],u=e[5],f=e[6],p=e[7],g=e[8];return t*o*g-t*u*p-n*s*g+n*u*f+r*s*p-r*o*f}invert(){const e=this.elements,t=e[0],n=e[1],r=e[2],s=e[3],o=e[4],u=e[5],f=e[6],p=e[7],g=e[8],v=g*o-u*p,_=u*f-g*s,x=p*s-o*f,E=t*v+n*_+r*x;if(E===0)return this.set(0,0,0,0,0,0,0,0,0);const C=1/E;return e[0]=v*C,e[1]=(r*p-g*n)*C,e[2]=(u*n-r*o)*C,e[3]=_*C,e[4]=(g*t-r*f)*C,e[5]=(r*s-u*t)*C,e[6]=x*C,e[7]=(n*f-p*t)*C,e[8]=(o*t-n*s)*C,this}transpose(){let e;const t=this.elements;return e=t[1],t[1]=t[3],t[3]=e,e=t[2],t[2]=t[6],t[6]=e,e=t[5],t[5]=t[7],t[7]=e,this}getNormalMatrix(e){return this.setFromMatrix4(e).invert().transpose()}transposeIntoArray(e){const t=this.elements;return e[0]=t[0],e[1]=t[3],e[2]=t[6],e[3]=t[1],e[4]=t[4],e[5]=t[7],e[6]=t[2],e[7]=t[5],e[8]=t[8],this}setUvTransform(e,t,n,r,s,o,u){const f=Math.cos(s),p=Math.sin(s);return this.set(n*f,n*p,-n*(f*o+p*u)+o+e,-r*p,r*f,-r*(-p*o+f*u)+u+t,0,0,1),this}scale(e,t){return this.premultiply(GE.makeScale(e,t)),this}rotate(e){return this.premultiply(GE.makeRotation(-e)),this}translate(e,t){return this.premultiply(GE.makeTranslation(e,t)),this}makeTranslation(e,t){return e.isVector2?this.set(1,0,e.x,0,1,e.y,0,0,1):this.set(1,0,e,0,1,t,0,0,1),this}makeRotation(e){const t=Math.cos(e),n=Math.sin(e);return this.set(t,-n,0,n,t,0,0,0,1),this}makeScale(e,t){return this.set(e,0,0,0,t,0,0,0,1),this}equals(e){const t=this.elements,n=e.elements;for(let r=0;r<9;r++)if(t[r]!==n[r])return!1;return!0}fromArray(e,t=0){for(let n=0;n<9;n++)this.elements[n]=e[n+t];return this}toArray(e=[],t=0){const n=this.elements;return e[t]=n[0],e[t+1]=n[1],e[t+2]=n[2],e[t+3]=n[3],e[t+4]=n[4],e[t+5]=n[5],e[t+6]=n[6],e[t+7]=n[7],e[t+8]=n[8],e}clone(){return new this.constructor().fromArray(this.elements)}}const GE=new Un,DI=new Un().set(.4123908,.3575843,.1804808,.212639,.7151687,.0721923,.0193308,.1191948,.9505322),NI=new Un().set(3.2409699,-1.5373832,-.4986108,-.9692436,1.8759675,.0415551,.0556301,-.203977,1.0569715);function VH(){const i={enabled:!0,workingColorSpace:Xl,spaces:{},convert:function(r,s,o){return this.enabled===!1||s===o||!s||!o||(this.spaces[s].transfer===wi&&(r.r=Fu(r.r),r.g=Fu(r.g),r.b=Fu(r.b)),this.spaces[s].primaries!==this.spaces[o].primaries&&(r.applyMatrix3(this.spaces[s].toXYZ),r.applyMatrix3(this.spaces[o].fromXYZ)),this.spaces[o].transfer===wi&&(r.r=Xm(r.r),r.g=Xm(r.g),r.b=Xm(r.b))),r},workingToColorSpace:function(r,s){return this.convert(r,this.workingColorSpace,s)},colorSpaceToWorking:function(r,s){return this.convert(r,s,this.workingColorSpace)},getPrimaries:function(r){return this.spaces[r].primaries},getTransfer:function(r){return r===Nu?Xv:this.spaces[r].transfer},getToneMappingMode:function(r){return this.spaces[r].outputColorSpaceConfig.toneMappingMode||"standard"},getLuminanceCoefficients:function(r,s=this.workingColorSpace){return r.fromArray(this.spaces[s].luminanceCoefficients)},define:function(r){Object.assign(this.spaces,r)},_getMatrix:function(r,s,o){return r.copy(this.spaces[s].toXYZ).multiply(this.spaces[o].fromXYZ)},_getDrawingBufferColorSpace:function(r){return this.spaces[r].outputColorSpaceConfig.drawingBufferColorSpace},_getUnpackColorSpace:function(r=this.workingColorSpace){return this.spaces[r].workingColorSpaceConfig.unpackColorSpace},fromWorkingColorSpace:function(r,s){return hg("ColorManagement: .fromWorkingColorSpace() has been renamed to .workingToColorSpace()."),i.workingToColorSpace(r,s)},toWorkingColorSpace:function(r,s){return hg("ColorManagement: .toWorkingColorSpace() has been renamed to .colorSpaceToWorking()."),i.colorSpaceToWorking(r,s)}},e=[.64,.33,.3,.6,.15,.06],t=[.2126,.7152,.0722],n=[.3127,.329];return i.define({[Xl]:{primaries:e,whitePoint:n,transfer:Xv,toXYZ:DI,fromXYZ:NI,luminanceCoefficients:t,workingColorSpaceConfig:{unpackColorSpace:Fs},outputColorSpaceConfig:{drawingBufferColorSpace:Fs}},[Fs]:{primaries:e,whitePoint:n,transfer:wi,toXYZ:DI,fromXYZ:NI,luminanceCoefficients:t,outputColorSpaceConfig:{drawingBufferColorSpace:Fs}}}),i}const oi=VH();function Fu(i){return i<.04045?i*.0773993808:Math.pow(i*.9478672986+.0521327014,2.4)}function Xm(i){return i<.0031308?i*12.92:1.055*Math.pow(i,.41666)-.055}let um;class eL{static getDataURL(e,t="image/png"){if(/^data:/i.test(e.src)||typeof HTMLCanvasElement>"u")return e.src;let n;if(e instanceof HTMLCanvasElement)n=e;else{um===void 0&&(um=Jv("canvas")),um.width=e.width,um.height=e.height;const r=um.getContext("2d");e instanceof ImageData?r.putImageData(e,0,0):r.drawImage(e,0,0,e.width,e.height),n=um}return n.toDataURL(t)}static sRGBToLinear(e){if(typeof HTMLImageElement<"u"&&e instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&e instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&e instanceof ImageBitmap){const t=Jv("canvas");t.width=e.width,t.height=e.height;const n=t.getContext("2d");n.drawImage(e,0,0,e.width,e.height);const r=n.getImageData(0,0,e.width,e.height),s=r.data;for(let o=0;o<s.length;o++)s[o]=Fu(s[o]/255)*255;return n.putImageData(r,0,0),t}else if(e.data){const t=e.data.slice(0);for(let n=0;n<t.length;n++)t instanceof Uint8Array||t instanceof Uint8ClampedArray?t[n]=Math.floor(Fu(t[n]/255)*255):t[n]=Fu(t[n]);return{data:t,width:e.width,height:e.height}}else return Ht("ImageUtils.sRGBToLinear(): Unsupported image type. No color space conversion applied."),e}}let HH=0;class ef{constructor(e=null){this.isSource=!0,Object.defineProperty(this,"id",{value:HH++}),this.uuid=bo(),this.data=e,this.dataReady=!0,this.version=0}getSize(e){const t=this.data;return typeof HTMLVideoElement<"u"&&t instanceof HTMLVideoElement?e.set(t.videoWidth,t.videoHeight,0):typeof VideoFrame<"u"&&t instanceof VideoFrame?e.set(t.displayHeight,t.displayWidth,0):t!==null?e.set(t.width,t.height,t.depth||0):e.set(0,0,0),e}set needsUpdate(e){e===!0&&this.version++}toJSON(e){const t=e===void 0||typeof e=="string";if(!t&&e.images[this.uuid]!==void 0)return e.images[this.uuid];const n={uuid:this.uuid,url:""},r=this.data;if(r!==null){let s;if(Array.isArray(r)){s=[];for(let o=0,u=r.length;o<u;o++)r[o].isDataTexture?s.push(jE(r[o].image)):s.push(jE(r[o]))}else s=jE(r);n.url=s}return t||(e.images[this.uuid]=n),n}}function jE(i){return typeof HTMLImageElement<"u"&&i instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&i instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&i instanceof ImageBitmap?eL.getDataURL(i):i.data?{data:Array.from(i.data),width:i.width,height:i.height,type:i.data.constructor.name}:(Ht("Texture: Unable to serialize Texture."),{})}let GH=0;const WE=new ie;class Ci extends Wc{constructor(e=Ci.DEFAULT_IMAGE,t=Ci.DEFAULT_MAPPING,n=Sr,r=Sr,s=Jn,o=sl,u=jr,f=vs,p=Ci.DEFAULT_ANISOTROPY,g=Nu){super(),this.isTexture=!0,Object.defineProperty(this,"id",{value:GH++}),this.uuid=bo(),this.name="",this.source=new ef(e),this.mipmaps=[],this.mapping=t,this.channel=0,this.wrapS=n,this.wrapT=r,this.magFilter=s,this.minFilter=o,this.anisotropy=p,this.format=u,this.internalFormat=null,this.type=f,this.offset=new $e(0,0),this.repeat=new $e(1,1),this.center=new $e(0,0),this.rotation=0,this.matrixAutoUpdate=!0,this.matrix=new Un,this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,this.colorSpace=g,this.userData={},this.updateRanges=[],this.version=0,this.onUpdate=null,this.renderTarget=null,this.isRenderTargetTexture=!1,this.isArrayTexture=!!(e&&e.depth&&e.depth>1),this.pmremVersion=0}get width(){return this.source.getSize(WE).x}get height(){return this.source.getSize(WE).y}get depth(){return this.source.getSize(WE).z}get image(){return this.source.data}set image(e=null){this.source.data=e}updateMatrix(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)}addUpdateRange(e,t){this.updateRanges.push({start:e,count:t})}clearUpdateRanges(){this.updateRanges.length=0}clone(){return new this.constructor().copy(this)}copy(e){return this.name=e.name,this.source=e.source,this.mipmaps=e.mipmaps.slice(0),this.mapping=e.mapping,this.channel=e.channel,this.wrapS=e.wrapS,this.wrapT=e.wrapT,this.magFilter=e.magFilter,this.minFilter=e.minFilter,this.anisotropy=e.anisotropy,this.format=e.format,this.internalFormat=e.internalFormat,this.type=e.type,this.offset.copy(e.offset),this.repeat.copy(e.repeat),this.center.copy(e.center),this.rotation=e.rotation,this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrix.copy(e.matrix),this.generateMipmaps=e.generateMipmaps,this.premultiplyAlpha=e.premultiplyAlpha,this.flipY=e.flipY,this.unpackAlignment=e.unpackAlignment,this.colorSpace=e.colorSpace,this.renderTarget=e.renderTarget,this.isRenderTargetTexture=e.isRenderTargetTexture,this.isArrayTexture=e.isArrayTexture,this.userData=JSON.parse(JSON.stringify(e.userData)),this.needsUpdate=!0,this}setValues(e){for(const t in e){const n=e[t];if(n===void 0){Ht(`Texture.setValues(): parameter '${t}' has value of undefined.`);continue}const r=this[t];if(r===void 0){Ht(`Texture.setValues(): property '${t}' does not exist.`);continue}r&&n&&r.isVector2&&n.isVector2||r&&n&&r.isVector3&&n.isVector3||r&&n&&r.isMatrix3&&n.isMatrix3?r.copy(n):this[t]=n}}toJSON(e){const t=e===void 0||typeof e=="string";if(!t&&e.textures[this.uuid]!==void 0)return e.textures[this.uuid];const n={metadata:{version:4.7,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,image:this.source.toJSON(e).uuid,mapping:this.mapping,channel:this.channel,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,internalFormat:this.internalFormat,type:this.type,colorSpace:this.colorSpace,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY,generateMipmaps:this.generateMipmaps,premultiplyAlpha:this.premultiplyAlpha,unpackAlignment:this.unpackAlignment};return Object.keys(this.userData).length>0&&(n.userData=this.userData),t||(e.textures[this.uuid]=n),n}dispose(){this.dispatchEvent({type:"dispose"})}transformUv(e){if(this.mapping!==vf)return e;if(e.applyMatrix3(this.matrix),e.x<0||e.x>1)switch(this.wrapS){case _f:e.x=e.x-Math.floor(e.x);break;case Sr:e.x=e.x<0?0:1;break;case sg:Math.abs(Math.floor(e.x)%2)===1?e.x=Math.ceil(e.x)-e.x:e.x=e.x-Math.floor(e.x);break}if(e.y<0||e.y>1)switch(this.wrapT){case _f:e.y=e.y-Math.floor(e.y);break;case Sr:e.y=e.y<0?0:1;break;case sg:Math.abs(Math.floor(e.y)%2)===1?e.y=Math.ceil(e.y)-e.y:e.y=e.y-Math.floor(e.y);break}return this.flipY&&(e.y=1-e.y),e}set needsUpdate(e){e===!0&&(this.version++,this.source.needsUpdate=!0)}set needsPMREMUpdate(e){e===!0&&this.pmremVersion++}}Ci.DEFAULT_IMAGE=null;Ci.DEFAULT_MAPPING=vf;Ci.DEFAULT_ANISOTROPY=1;class zi{constructor(e=0,t=0,n=0,r=1){zi.prototype.isVector4=!0,this.x=e,this.y=t,this.z=n,this.w=r}get width(){return this.z}set width(e){this.z=e}get height(){return this.w}set height(e){this.w=e}set(e,t,n,r){return this.x=e,this.y=t,this.z=n,this.w=r,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this.w=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setW(e){return this.w=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;case 3:this.w=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z,this.w)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this.w=e.w!==void 0?e.w:1,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this.w+=e.w,this}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this.w+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this.w=e.w+t.w,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this.w+=e.w*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this.w-=e.w,this}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this.w-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this.w=e.w-t.w,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this.w*=e.w,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this.w*=e,this}applyMatrix4(e){const t=this.x,n=this.y,r=this.z,s=this.w,o=e.elements;return this.x=o[0]*t+o[4]*n+o[8]*r+o[12]*s,this.y=o[1]*t+o[5]*n+o[9]*r+o[13]*s,this.z=o[2]*t+o[6]*n+o[10]*r+o[14]*s,this.w=o[3]*t+o[7]*n+o[11]*r+o[15]*s,this}divide(e){return this.x/=e.x,this.y/=e.y,this.z/=e.z,this.w/=e.w,this}divideScalar(e){return this.multiplyScalar(1/e)}setAxisAngleFromQuaternion(e){this.w=2*Math.acos(e.w);const t=Math.sqrt(1-e.w*e.w);return t<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=e.x/t,this.y=e.y/t,this.z=e.z/t),this}setAxisAngleFromRotationMatrix(e){let t,n,r,s;const f=e.elements,p=f[0],g=f[4],v=f[8],_=f[1],x=f[5],E=f[9],C=f[2],w=f[6],T=f[10];if(Math.abs(g-_)<.01&&Math.abs(v-C)<.01&&Math.abs(E-w)<.01){if(Math.abs(g+_)<.1&&Math.abs(v+C)<.1&&Math.abs(E+w)<.1&&Math.abs(p+x+T-3)<.1)return this.set(1,0,0,0),this;t=Math.PI;const L=(p+1)/2,F=(x+1)/2,G=(T+1)/2,k=(g+_)/4,O=(v+C)/4,D=(E+w)/4;return L>F&&L>G?L<.01?(n=0,r=.707106781,s=.707106781):(n=Math.sqrt(L),r=k/n,s=O/n):F>G?F<.01?(n=.707106781,r=0,s=.707106781):(r=Math.sqrt(F),n=k/r,s=D/r):G<.01?(n=.707106781,r=.707106781,s=0):(s=Math.sqrt(G),n=O/s,r=D/s),this.set(n,r,s,t),this}let N=Math.sqrt((w-E)*(w-E)+(v-C)*(v-C)+(_-g)*(_-g));return Math.abs(N)<.001&&(N=1),this.x=(w-E)/N,this.y=(v-C)/N,this.z=(_-g)/N,this.w=Math.acos((p+x+T-1)/2),this}setFromMatrixPosition(e){const t=e.elements;return this.x=t[12],this.y=t[13],this.z=t[14],this.w=t[15],this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this.w=Math.min(this.w,e.w),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this.w=Math.max(this.w,e.w),this}clamp(e,t){return this.x=An(this.x,e.x,t.x),this.y=An(this.y,e.y,t.y),this.z=An(this.z,e.z,t.z),this.w=An(this.w,e.w,t.w),this}clampScalar(e,t){return this.x=An(this.x,e,t),this.y=An(this.y,e,t),this.z=An(this.z,e,t),this.w=An(this.w,e,t),this}clampLength(e,t){const n=this.length();return this.divideScalar(n||1).multiplyScalar(An(n,e,t))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this.z=Math.trunc(this.z),this.w=Math.trunc(this.w),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z+this.w*e.w}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this.w+=(e.w-this.w)*t,this}lerpVectors(e,t,n){return this.x=e.x+(t.x-e.x)*n,this.y=e.y+(t.y-e.y)*n,this.z=e.z+(t.z-e.z)*n,this.w=e.w+(t.w-e.w)*n,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z&&e.w===this.w}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this.z=e[t+2],this.w=e[t+3],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e[t+3]=this.w,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this.w=e.getW(t),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this.w=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z,yield this.w}}class cw extends Wc{constructor(e=1,t=1,n={}){super(),n=Object.assign({generateMipmaps:!1,internalFormat:null,minFilter:Jn,depthBuffer:!0,stencilBuffer:!1,resolveDepthBuffer:!0,resolveStencilBuffer:!0,depthTexture:null,samples:0,count:1,depth:1,multiview:!1},n),this.isRenderTarget=!0,this.width=e,this.height=t,this.depth=n.depth,this.scissor=new zi(0,0,e,t),this.scissorTest=!1,this.viewport=new zi(0,0,e,t);const r={width:e,height:t,depth:n.depth},s=new Ci(r);this.textures=[];const o=n.count;for(let u=0;u<o;u++)this.textures[u]=s.clone(),this.textures[u].isRenderTargetTexture=!0,this.textures[u].renderTarget=this;this._setTextureOptions(n),this.depthBuffer=n.depthBuffer,this.stencilBuffer=n.stencilBuffer,this.resolveDepthBuffer=n.resolveDepthBuffer,this.resolveStencilBuffer=n.resolveStencilBuffer,this._depthTexture=null,this.depthTexture=n.depthTexture,this.samples=n.samples,this.multiview=n.multiview}_setTextureOptions(e={}){const t={minFilter:Jn,generateMipmaps:!1,flipY:!1,internalFormat:null};e.mapping!==void 0&&(t.mapping=e.mapping),e.wrapS!==void 0&&(t.wrapS=e.wrapS),e.wrapT!==void 0&&(t.wrapT=e.wrapT),e.wrapR!==void 0&&(t.wrapR=e.wrapR),e.magFilter!==void 0&&(t.magFilter=e.magFilter),e.minFilter!==void 0&&(t.minFilter=e.minFilter),e.format!==void 0&&(t.format=e.format),e.type!==void 0&&(t.type=e.type),e.anisotropy!==void 0&&(t.anisotropy=e.anisotropy),e.colorSpace!==void 0&&(t.colorSpace=e.colorSpace),e.flipY!==void 0&&(t.flipY=e.flipY),e.generateMipmaps!==void 0&&(t.generateMipmaps=e.generateMipmaps),e.internalFormat!==void 0&&(t.internalFormat=e.internalFormat);for(let n=0;n<this.textures.length;n++)this.textures[n].setValues(t)}get texture(){return this.textures[0]}set texture(e){this.textures[0]=e}set depthTexture(e){this._depthTexture!==null&&(this._depthTexture.renderTarget=null),e!==null&&(e.renderTarget=this),this._depthTexture=e}get depthTexture(){return this._depthTexture}setSize(e,t,n=1){if(this.width!==e||this.height!==t||this.depth!==n){this.width=e,this.height=t,this.depth=n;for(let r=0,s=this.textures.length;r<s;r++)this.textures[r].image.width=e,this.textures[r].image.height=t,this.textures[r].image.depth=n,this.textures[r].isData3DTexture!==!0&&(this.textures[r].isArrayTexture=this.textures[r].image.depth>1);this.dispose()}this.viewport.set(0,0,e,t),this.scissor.set(0,0,e,t)}clone(){return new this.constructor().copy(this)}copy(e){this.width=e.width,this.height=e.height,this.depth=e.depth,this.scissor.copy(e.scissor),this.scissorTest=e.scissorTest,this.viewport.copy(e.viewport),this.textures.length=0;for(let t=0,n=e.textures.length;t<n;t++){this.textures[t]=e.textures[t].clone(),this.textures[t].isRenderTargetTexture=!0,this.textures[t].renderTarget=this;const r=Object.assign({},e.textures[t].image);this.textures[t].source=new ef(r)}return this.depthBuffer=e.depthBuffer,this.stencilBuffer=e.stencilBuffer,this.resolveDepthBuffer=e.resolveDepthBuffer,this.resolveStencilBuffer=e.resolveStencilBuffer,e.depthTexture!==null&&(this.depthTexture=e.depthTexture.clone()),this.samples=e.samples,this}dispose(){this.dispatchEvent({type:"dispose"})}}class _s extends cw{constructor(e=1,t=1,n={}){super(e,t,n),this.isWebGLRenderTarget=!0}}class gS extends Ci{constructor(e=null,t=1,n=1,r=1){super(null),this.isDataArrayTexture=!0,this.image={data:e,width:t,height:n,depth:r},this.magFilter=Pr,this.minFilter=Pr,this.wrapR=Sr,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1,this.layerUpdates=new Set}addLayerUpdate(e){this.layerUpdates.add(e)}clearLayerUpdates(){this.layerUpdates.clear()}}class jH extends _s{constructor(e=1,t=1,n=1,r={}){super(e,t,r),this.isWebGLArrayRenderTarget=!0,this.depth=n,this.texture=new gS(null,e,t,n),this._setTextureOptions(r),this.texture.isRenderTargetTexture=!0}}class vS extends Ci{constructor(e=null,t=1,n=1,r=1){super(null),this.isData3DTexture=!0,this.image={data:e,width:t,height:n,depth:r},this.magFilter=Pr,this.minFilter=Pr,this.wrapR=Sr,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}class WH extends _s{constructor(e=1,t=1,n=1,r={}){super(e,t,r),this.isWebGL3DRenderTarget=!0,this.depth=n,this.texture=new vS(null,e,t,n),this._setTextureOptions(r),this.texture.isRenderTargetTexture=!0}}class xs{constructor(e=new ie(1/0,1/0,1/0),t=new ie(-1/0,-1/0,-1/0)){this.isBox3=!0,this.min=e,this.max=t}set(e,t){return this.min.copy(e),this.max.copy(t),this}setFromArray(e){this.makeEmpty();for(let t=0,n=e.length;t<n;t+=3)this.expandByPoint(Pl.fromArray(e,t));return this}setFromBufferAttribute(e){this.makeEmpty();for(let t=0,n=e.count;t<n;t++)this.expandByPoint(Pl.fromBufferAttribute(e,t));return this}setFromPoints(e){this.makeEmpty();for(let t=0,n=e.length;t<n;t++)this.expandByPoint(e[t]);return this}setFromCenterAndSize(e,t){const n=Pl.copy(t).multiplyScalar(.5);return this.min.copy(e).sub(n),this.max.copy(e).add(n),this}setFromObject(e,t=!1){return this.makeEmpty(),this.expandByObject(e,t)}clone(){return new this.constructor().copy(this)}copy(e){return this.min.copy(e.min),this.max.copy(e.max),this}makeEmpty(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z}getCenter(e){return this.isEmpty()?e.set(0,0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(e){return this.isEmpty()?e.set(0,0,0):e.subVectors(this.max,this.min)}expandByPoint(e){return this.min.min(e),this.max.max(e),this}expandByVector(e){return this.min.sub(e),this.max.add(e),this}expandByScalar(e){return this.min.addScalar(-e),this.max.addScalar(e),this}expandByObject(e,t=!1){e.updateWorldMatrix(!1,!1);const n=e.geometry;if(n!==void 0){const s=n.getAttribute("position");if(t===!0&&s!==void 0&&e.isInstancedMesh!==!0)for(let o=0,u=s.count;o<u;o++)e.isMesh===!0?e.getVertexPosition(o,Pl):Pl.fromBufferAttribute(s,o),Pl.applyMatrix4(e.matrixWorld),this.expandByPoint(Pl);else e.boundingBox!==void 0?(e.boundingBox===null&&e.computeBoundingBox(),sx.copy(e.boundingBox)):(n.boundingBox===null&&n.computeBoundingBox(),sx.copy(n.boundingBox)),sx.applyMatrix4(e.matrixWorld),this.union(sx)}const r=e.children;for(let s=0,o=r.length;s<o;s++)this.expandByObject(r[s],t);return this}containsPoint(e){return e.x>=this.min.x&&e.x<=this.max.x&&e.y>=this.min.y&&e.y<=this.max.y&&e.z>=this.min.z&&e.z<=this.max.z}containsBox(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y&&this.min.z<=e.min.z&&e.max.z<=this.max.z}getParameter(e,t){return t.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y),(e.z-this.min.z)/(this.max.z-this.min.z))}intersectsBox(e){return e.max.x>=this.min.x&&e.min.x<=this.max.x&&e.max.y>=this.min.y&&e.min.y<=this.max.y&&e.max.z>=this.min.z&&e.min.z<=this.max.z}intersectsSphere(e){return this.clampPoint(e.center,Pl),Pl.distanceToSquared(e.center)<=e.radius*e.radius}intersectsPlane(e){let t,n;return e.normal.x>0?(t=e.normal.x*this.min.x,n=e.normal.x*this.max.x):(t=e.normal.x*this.max.x,n=e.normal.x*this.min.x),e.normal.y>0?(t+=e.normal.y*this.min.y,n+=e.normal.y*this.max.y):(t+=e.normal.y*this.max.y,n+=e.normal.y*this.min.y),e.normal.z>0?(t+=e.normal.z*this.min.z,n+=e.normal.z*this.max.z):(t+=e.normal.z*this.max.z,n+=e.normal.z*this.min.z),t<=-e.constant&&n>=-e.constant}intersectsTriangle(e){if(this.isEmpty())return!1;this.getCenter(K0),ax.subVectors(this.max,K0),hm.subVectors(e.a,K0),fm.subVectors(e.b,K0),dm.subVectors(e.c,K0),kh.subVectors(fm,hm),zh.subVectors(dm,fm),ud.subVectors(hm,dm);let t=[0,-kh.z,kh.y,0,-zh.z,zh.y,0,-ud.z,ud.y,kh.z,0,-kh.x,zh.z,0,-zh.x,ud.z,0,-ud.x,-kh.y,kh.x,0,-zh.y,zh.x,0,-ud.y,ud.x,0];return!qE(t,hm,fm,dm,ax)||(t=[1,0,0,0,1,0,0,0,1],!qE(t,hm,fm,dm,ax))?!1:(ox.crossVectors(kh,zh),t=[ox.x,ox.y,ox.z],qE(t,hm,fm,dm,ax))}clampPoint(e,t){return t.copy(e).clamp(this.min,this.max)}distanceToPoint(e){return this.clampPoint(e,Pl).distanceTo(e)}getBoundingSphere(e){return this.isEmpty()?e.makeEmpty():(this.getCenter(e.center),e.radius=this.getSize(Pl).length()*.5),e}intersect(e){return this.min.max(e.min),this.max.min(e.max),this.isEmpty()&&this.makeEmpty(),this}union(e){return this.min.min(e.min),this.max.max(e.max),this}applyMatrix4(e){return this.isEmpty()?this:(Eu[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(e),Eu[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(e),Eu[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(e),Eu[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(e),Eu[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(e),Eu[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(e),Eu[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(e),Eu[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(e),this.setFromPoints(Eu),this)}translate(e){return this.min.add(e),this.max.add(e),this}equals(e){return e.min.equals(this.min)&&e.max.equals(this.max)}toJSON(){return{min:this.min.toArray(),max:this.max.toArray()}}fromJSON(e){return this.min.fromArray(e.min),this.max.fromArray(e.max),this}}const Eu=[new ie,new ie,new ie,new ie,new ie,new ie,new ie,new ie],Pl=new ie,sx=new xs,hm=new ie,fm=new ie,dm=new ie,kh=new ie,zh=new ie,ud=new ie,K0=new ie,ax=new ie,ox=new ie,hd=new ie;function qE(i,e,t,n,r){for(let s=0,o=i.length-3;s<=o;s+=3){hd.fromArray(i,s);const u=r.x*Math.abs(hd.x)+r.y*Math.abs(hd.y)+r.z*Math.abs(hd.z),f=e.dot(hd),p=t.dot(hd),g=n.dot(hd);if(Math.max(-Math.max(f,p,g),Math.min(f,p,g))>u)return!1}return!0}const qH=new xs,Q0=new ie,XE=new ie;class bs{constructor(e=new ie,t=-1){this.isSphere=!0,this.center=e,this.radius=t}set(e,t){return this.center.copy(e),this.radius=t,this}setFromPoints(e,t){const n=this.center;t!==void 0?n.copy(t):qH.setFromPoints(e).getCenter(n);let r=0;for(let s=0,o=e.length;s<o;s++)r=Math.max(r,n.distanceToSquared(e[s]));return this.radius=Math.sqrt(r),this}copy(e){return this.center.copy(e.center),this.radius=e.radius,this}isEmpty(){return this.radius<0}makeEmpty(){return this.center.set(0,0,0),this.radius=-1,this}containsPoint(e){return e.distanceToSquared(this.center)<=this.radius*this.radius}distanceToPoint(e){return e.distanceTo(this.center)-this.radius}intersectsSphere(e){const t=this.radius+e.radius;return e.center.distanceToSquared(this.center)<=t*t}intersectsBox(e){return e.intersectsSphere(this)}intersectsPlane(e){return Math.abs(e.distanceToPoint(this.center))<=this.radius}clampPoint(e,t){const n=this.center.distanceToSquared(e);return t.copy(e),n>this.radius*this.radius&&(t.sub(this.center).normalize(),t.multiplyScalar(this.radius).add(this.center)),t}getBoundingBox(e){return this.isEmpty()?(e.makeEmpty(),e):(e.set(this.center,this.center),e.expandByScalar(this.radius),e)}applyMatrix4(e){return this.center.applyMatrix4(e),this.radius=this.radius*e.getMaxScaleOnAxis(),this}translate(e){return this.center.add(e),this}expandByPoint(e){if(this.isEmpty())return this.center.copy(e),this.radius=0,this;Q0.subVectors(e,this.center);const t=Q0.lengthSq();if(t>this.radius*this.radius){const n=Math.sqrt(t),r=(n-this.radius)*.5;this.center.addScaledVector(Q0,r/n),this.radius+=r}return this}union(e){return e.isEmpty()?this:this.isEmpty()?(this.copy(e),this):(this.center.equals(e.center)===!0?this.radius=Math.max(this.radius,e.radius):(XE.subVectors(e.center,this.center).setLength(e.radius),this.expandByPoint(Q0.copy(e.center).add(XE)),this.expandByPoint(Q0.copy(e.center).sub(XE))),this)}equals(e){return e.center.equals(this.center)&&e.radius===this.radius}clone(){return new this.constructor().copy(this)}toJSON(){return{radius:this.radius,center:this.center.toArray()}}fromJSON(e){return this.radius=e.radius,this.center.fromArray(e.center),this}}const Tu=new ie,YE=new ie,lx=new ie,Vh=new ie,JE=new ie,cx=new ie,KE=new ie;class hp{constructor(e=new ie,t=new ie(0,0,-1)){this.origin=e,this.direction=t}set(e,t){return this.origin.copy(e),this.direction.copy(t),this}copy(e){return this.origin.copy(e.origin),this.direction.copy(e.direction),this}at(e,t){return t.copy(this.origin).addScaledVector(this.direction,e)}lookAt(e){return this.direction.copy(e).sub(this.origin).normalize(),this}recast(e){return this.origin.copy(this.at(e,Tu)),this}closestPointToPoint(e,t){t.subVectors(e,this.origin);const n=t.dot(this.direction);return n<0?t.copy(this.origin):t.copy(this.origin).addScaledVector(this.direction,n)}distanceToPoint(e){return Math.sqrt(this.distanceSqToPoint(e))}distanceSqToPoint(e){const t=Tu.subVectors(e,this.origin).dot(this.direction);return t<0?this.origin.distanceToSquared(e):(Tu.copy(this.origin).addScaledVector(this.direction,t),Tu.distanceToSquared(e))}distanceSqToSegment(e,t,n,r){YE.copy(e).add(t).multiplyScalar(.5),lx.copy(t).sub(e).normalize(),Vh.copy(this.origin).sub(YE);const s=e.distanceTo(t)*.5,o=-this.direction.dot(lx),u=Vh.dot(this.direction),f=-Vh.dot(lx),p=Vh.lengthSq(),g=Math.abs(1-o*o);let v,_,x,E;if(g>0)if(v=o*f-u,_=o*u-f,E=s*g,v>=0)if(_>=-E)if(_<=E){const C=1/g;v*=C,_*=C,x=v*(v+o*_+2*u)+_*(o*v+_+2*f)+p}else _=s,v=Math.max(0,-(o*_+u)),x=-v*v+_*(_+2*f)+p;else _=-s,v=Math.max(0,-(o*_+u)),x=-v*v+_*(_+2*f)+p;else _<=-E?(v=Math.max(0,-(-o*s+u)),_=v>0?-s:Math.min(Math.max(-s,-f),s),x=-v*v+_*(_+2*f)+p):_<=E?(v=0,_=Math.min(Math.max(-s,-f),s),x=_*(_+2*f)+p):(v=Math.max(0,-(o*s+u)),_=v>0?s:Math.min(Math.max(-s,-f),s),x=-v*v+_*(_+2*f)+p);else _=o>0?-s:s,v=Math.max(0,-(o*_+u)),x=-v*v+_*(_+2*f)+p;return n&&n.copy(this.origin).addScaledVector(this.direction,v),r&&r.copy(YE).addScaledVector(lx,_),x}intersectSphere(e,t){Tu.subVectors(e.center,this.origin);const n=Tu.dot(this.direction),r=Tu.dot(Tu)-n*n,s=e.radius*e.radius;if(r>s)return null;const o=Math.sqrt(s-r),u=n-o,f=n+o;return f<0?null:u<0?this.at(f,t):this.at(u,t)}intersectsSphere(e){return e.radius<0?!1:this.distanceSqToPoint(e.center)<=e.radius*e.radius}distanceToPlane(e){const t=e.normal.dot(this.direction);if(t===0)return e.distanceToPoint(this.origin)===0?0:null;const n=-(this.origin.dot(e.normal)+e.constant)/t;return n>=0?n:null}intersectPlane(e,t){const n=this.distanceToPlane(e);return n===null?null:this.at(n,t)}intersectsPlane(e){const t=e.distanceToPoint(this.origin);return t===0||e.normal.dot(this.direction)*t<0}intersectBox(e,t){let n,r,s,o,u,f;const p=1/this.direction.x,g=1/this.direction.y,v=1/this.direction.z,_=this.origin;return p>=0?(n=(e.min.x-_.x)*p,r=(e.max.x-_.x)*p):(n=(e.max.x-_.x)*p,r=(e.min.x-_.x)*p),g>=0?(s=(e.min.y-_.y)*g,o=(e.max.y-_.y)*g):(s=(e.max.y-_.y)*g,o=(e.min.y-_.y)*g),n>o||s>r||((s>n||isNaN(n))&&(n=s),(o<r||isNaN(r))&&(r=o),v>=0?(u=(e.min.z-_.z)*v,f=(e.max.z-_.z)*v):(u=(e.max.z-_.z)*v,f=(e.min.z-_.z)*v),n>f||u>r)||((u>n||n!==n)&&(n=u),(f<r||r!==r)&&(r=f),r<0)?null:this.at(n>=0?n:r,t)}intersectsBox(e){return this.intersectBox(e,Tu)!==null}intersectTriangle(e,t,n,r,s){JE.subVectors(t,e),cx.subVectors(n,e),KE.crossVectors(JE,cx);let o=this.direction.dot(KE),u;if(o>0){if(r)return null;u=1}else if(o<0)u=-1,o=-o;else return null;Vh.subVectors(this.origin,e);const f=u*this.direction.dot(cx.crossVectors(Vh,cx));if(f<0)return null;const p=u*this.direction.dot(JE.cross(Vh));if(p<0||f+p>o)return null;const g=-u*Vh.dot(KE);return g<0?null:this.at(g/o,s)}applyMatrix4(e){return this.origin.applyMatrix4(e),this.direction.transformDirection(e),this}equals(e){return e.origin.equals(this.origin)&&e.direction.equals(this.direction)}clone(){return new this.constructor().copy(this)}}class vn{constructor(e,t,n,r,s,o,u,f,p,g,v,_,x,E,C,w){vn.prototype.isMatrix4=!0,this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],e!==void 0&&this.set(e,t,n,r,s,o,u,f,p,g,v,_,x,E,C,w)}set(e,t,n,r,s,o,u,f,p,g,v,_,x,E,C,w){const T=this.elements;return T[0]=e,T[4]=t,T[8]=n,T[12]=r,T[1]=s,T[5]=o,T[9]=u,T[13]=f,T[2]=p,T[6]=g,T[10]=v,T[14]=_,T[3]=x,T[7]=E,T[11]=C,T[15]=w,this}identity(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this}clone(){return new vn().fromArray(this.elements)}copy(e){const t=this.elements,n=e.elements;return t[0]=n[0],t[1]=n[1],t[2]=n[2],t[3]=n[3],t[4]=n[4],t[5]=n[5],t[6]=n[6],t[7]=n[7],t[8]=n[8],t[9]=n[9],t[10]=n[10],t[11]=n[11],t[12]=n[12],t[13]=n[13],t[14]=n[14],t[15]=n[15],this}copyPosition(e){const t=this.elements,n=e.elements;return t[12]=n[12],t[13]=n[13],t[14]=n[14],this}setFromMatrix3(e){const t=e.elements;return this.set(t[0],t[3],t[6],0,t[1],t[4],t[7],0,t[2],t[5],t[8],0,0,0,0,1),this}extractBasis(e,t,n){return this.determinant()===0?(e.set(1,0,0),t.set(0,1,0),n.set(0,0,1),this):(e.setFromMatrixColumn(this,0),t.setFromMatrixColumn(this,1),n.setFromMatrixColumn(this,2),this)}makeBasis(e,t,n){return this.set(e.x,t.x,n.x,0,e.y,t.y,n.y,0,e.z,t.z,n.z,0,0,0,0,1),this}extractRotation(e){if(e.determinant()===0)return this.identity();const t=this.elements,n=e.elements,r=1/pm.setFromMatrixColumn(e,0).length(),s=1/pm.setFromMatrixColumn(e,1).length(),o=1/pm.setFromMatrixColumn(e,2).length();return t[0]=n[0]*r,t[1]=n[1]*r,t[2]=n[2]*r,t[3]=0,t[4]=n[4]*s,t[5]=n[5]*s,t[6]=n[6]*s,t[7]=0,t[8]=n[8]*o,t[9]=n[9]*o,t[10]=n[10]*o,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}makeRotationFromEuler(e){const t=this.elements,n=e.x,r=e.y,s=e.z,o=Math.cos(n),u=Math.sin(n),f=Math.cos(r),p=Math.sin(r),g=Math.cos(s),v=Math.sin(s);if(e.order==="XYZ"){const _=o*g,x=o*v,E=u*g,C=u*v;t[0]=f*g,t[4]=-f*v,t[8]=p,t[1]=x+E*p,t[5]=_-C*p,t[9]=-u*f,t[2]=C-_*p,t[6]=E+x*p,t[10]=o*f}else if(e.order==="YXZ"){const _=f*g,x=f*v,E=p*g,C=p*v;t[0]=_+C*u,t[4]=E*u-x,t[8]=o*p,t[1]=o*v,t[5]=o*g,t[9]=-u,t[2]=x*u-E,t[6]=C+_*u,t[10]=o*f}else if(e.order==="ZXY"){const _=f*g,x=f*v,E=p*g,C=p*v;t[0]=_-C*u,t[4]=-o*v,t[8]=E+x*u,t[1]=x+E*u,t[5]=o*g,t[9]=C-_*u,t[2]=-o*p,t[6]=u,t[10]=o*f}else if(e.order==="ZYX"){const _=o*g,x=o*v,E=u*g,C=u*v;t[0]=f*g,t[4]=E*p-x,t[8]=_*p+C,t[1]=f*v,t[5]=C*p+_,t[9]=x*p-E,t[2]=-p,t[6]=u*f,t[10]=o*f}else if(e.order==="YZX"){const _=o*f,x=o*p,E=u*f,C=u*p;t[0]=f*g,t[4]=C-_*v,t[8]=E*v+x,t[1]=v,t[5]=o*g,t[9]=-u*g,t[2]=-p*g,t[6]=x*v+E,t[10]=_-C*v}else if(e.order==="XZY"){const _=o*f,x=o*p,E=u*f,C=u*p;t[0]=f*g,t[4]=-v,t[8]=p*g,t[1]=_*v+C,t[5]=o*g,t[9]=x*v-E,t[2]=E*v-x,t[6]=u*g,t[10]=C*v+_}return t[3]=0,t[7]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}makeRotationFromQuaternion(e){return this.compose(XH,e,YH)}lookAt(e,t,n){const r=this.elements;return mo.subVectors(e,t),mo.lengthSq()===0&&(mo.z=1),mo.normalize(),Hh.crossVectors(n,mo),Hh.lengthSq()===0&&(Math.abs(n.z)===1?mo.x+=1e-4:mo.z+=1e-4,mo.normalize(),Hh.crossVectors(n,mo)),Hh.normalize(),ux.crossVectors(mo,Hh),r[0]=Hh.x,r[4]=ux.x,r[8]=mo.x,r[1]=Hh.y,r[5]=ux.y,r[9]=mo.y,r[2]=Hh.z,r[6]=ux.z,r[10]=mo.z,this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,t){const n=e.elements,r=t.elements,s=this.elements,o=n[0],u=n[4],f=n[8],p=n[12],g=n[1],v=n[5],_=n[9],x=n[13],E=n[2],C=n[6],w=n[10],T=n[14],N=n[3],L=n[7],F=n[11],G=n[15],k=r[0],O=r[4],D=r[8],R=r[12],P=r[1],z=r[5],Y=r[9],j=r[13],ce=r[2],fe=r[6],te=r[10],se=r[14],Ae=r[3],Pe=r[7],Re=r[11],$=r[15];return s[0]=o*k+u*P+f*ce+p*Ae,s[4]=o*O+u*z+f*fe+p*Pe,s[8]=o*D+u*Y+f*te+p*Re,s[12]=o*R+u*j+f*se+p*$,s[1]=g*k+v*P+_*ce+x*Ae,s[5]=g*O+v*z+_*fe+x*Pe,s[9]=g*D+v*Y+_*te+x*Re,s[13]=g*R+v*j+_*se+x*$,s[2]=E*k+C*P+w*ce+T*Ae,s[6]=E*O+C*z+w*fe+T*Pe,s[10]=E*D+C*Y+w*te+T*Re,s[14]=E*R+C*j+w*se+T*$,s[3]=N*k+L*P+F*ce+G*Ae,s[7]=N*O+L*z+F*fe+G*Pe,s[11]=N*D+L*Y+F*te+G*Re,s[15]=N*R+L*j+F*se+G*$,this}multiplyScalar(e){const t=this.elements;return t[0]*=e,t[4]*=e,t[8]*=e,t[12]*=e,t[1]*=e,t[5]*=e,t[9]*=e,t[13]*=e,t[2]*=e,t[6]*=e,t[10]*=e,t[14]*=e,t[3]*=e,t[7]*=e,t[11]*=e,t[15]*=e,this}determinant(){const e=this.elements,t=e[0],n=e[4],r=e[8],s=e[12],o=e[1],u=e[5],f=e[9],p=e[13],g=e[2],v=e[6],_=e[10],x=e[14],E=e[3],C=e[7],w=e[11],T=e[15],N=f*x-p*_,L=u*x-p*v,F=u*_-f*v,G=o*x-p*g,k=o*_-f*g,O=o*v-u*g;return t*(C*N-w*L+T*F)-n*(E*N-w*G+T*k)+r*(E*L-C*G+T*O)-s*(E*F-C*k+w*O)}transpose(){const e=this.elements;let t;return t=e[1],e[1]=e[4],e[4]=t,t=e[2],e[2]=e[8],e[8]=t,t=e[6],e[6]=e[9],e[9]=t,t=e[3],e[3]=e[12],e[12]=t,t=e[7],e[7]=e[13],e[13]=t,t=e[11],e[11]=e[14],e[14]=t,this}setPosition(e,t,n){const r=this.elements;return e.isVector3?(r[12]=e.x,r[13]=e.y,r[14]=e.z):(r[12]=e,r[13]=t,r[14]=n),this}invert(){const e=this.elements,t=e[0],n=e[1],r=e[2],s=e[3],o=e[4],u=e[5],f=e[6],p=e[7],g=e[8],v=e[9],_=e[10],x=e[11],E=e[12],C=e[13],w=e[14],T=e[15],N=v*w*p-C*_*p+C*f*x-u*w*x-v*f*T+u*_*T,L=E*_*p-g*w*p-E*f*x+o*w*x+g*f*T-o*_*T,F=g*C*p-E*v*p+E*u*x-o*C*x-g*u*T+o*v*T,G=E*v*f-g*C*f-E*u*_+o*C*_+g*u*w-o*v*w,k=t*N+n*L+r*F+s*G;if(k===0)return this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);const O=1/k;return e[0]=N*O,e[1]=(C*_*s-v*w*s-C*r*x+n*w*x+v*r*T-n*_*T)*O,e[2]=(u*w*s-C*f*s+C*r*p-n*w*p-u*r*T+n*f*T)*O,e[3]=(v*f*s-u*_*s-v*r*p+n*_*p+u*r*x-n*f*x)*O,e[4]=L*O,e[5]=(g*w*s-E*_*s+E*r*x-t*w*x-g*r*T+t*_*T)*O,e[6]=(E*f*s-o*w*s-E*r*p+t*w*p+o*r*T-t*f*T)*O,e[7]=(o*_*s-g*f*s+g*r*p-t*_*p-o*r*x+t*f*x)*O,e[8]=F*O,e[9]=(E*v*s-g*C*s-E*n*x+t*C*x+g*n*T-t*v*T)*O,e[10]=(o*C*s-E*u*s+E*n*p-t*C*p-o*n*T+t*u*T)*O,e[11]=(g*u*s-o*v*s-g*n*p+t*v*p+o*n*x-t*u*x)*O,e[12]=G*O,e[13]=(g*C*r-E*v*r+E*n*_-t*C*_-g*n*w+t*v*w)*O,e[14]=(E*u*r-o*C*r-E*n*f+t*C*f+o*n*w-t*u*w)*O,e[15]=(o*v*r-g*u*r+g*n*f-t*v*f-o*n*_+t*u*_)*O,this}scale(e){const t=this.elements,n=e.x,r=e.y,s=e.z;return t[0]*=n,t[4]*=r,t[8]*=s,t[1]*=n,t[5]*=r,t[9]*=s,t[2]*=n,t[6]*=r,t[10]*=s,t[3]*=n,t[7]*=r,t[11]*=s,this}getMaxScaleOnAxis(){const e=this.elements,t=e[0]*e[0]+e[1]*e[1]+e[2]*e[2],n=e[4]*e[4]+e[5]*e[5]+e[6]*e[6],r=e[8]*e[8]+e[9]*e[9]+e[10]*e[10];return Math.sqrt(Math.max(t,n,r))}makeTranslation(e,t,n){return e.isVector3?this.set(1,0,0,e.x,0,1,0,e.y,0,0,1,e.z,0,0,0,1):this.set(1,0,0,e,0,1,0,t,0,0,1,n,0,0,0,1),this}makeRotationX(e){const t=Math.cos(e),n=Math.sin(e);return this.set(1,0,0,0,0,t,-n,0,0,n,t,0,0,0,0,1),this}makeRotationY(e){const t=Math.cos(e),n=Math.sin(e);return this.set(t,0,n,0,0,1,0,0,-n,0,t,0,0,0,0,1),this}makeRotationZ(e){const t=Math.cos(e),n=Math.sin(e);return this.set(t,-n,0,0,n,t,0,0,0,0,1,0,0,0,0,1),this}makeRotationAxis(e,t){const n=Math.cos(t),r=Math.sin(t),s=1-n,o=e.x,u=e.y,f=e.z,p=s*o,g=s*u;return this.set(p*o+n,p*u-r*f,p*f+r*u,0,p*u+r*f,g*u+n,g*f-r*o,0,p*f-r*u,g*f+r*o,s*f*f+n,0,0,0,0,1),this}makeScale(e,t,n){return this.set(e,0,0,0,0,t,0,0,0,0,n,0,0,0,0,1),this}makeShear(e,t,n,r,s,o){return this.set(1,n,s,0,e,1,o,0,t,r,1,0,0,0,0,1),this}compose(e,t,n){const r=this.elements,s=t._x,o=t._y,u=t._z,f=t._w,p=s+s,g=o+o,v=u+u,_=s*p,x=s*g,E=s*v,C=o*g,w=o*v,T=u*v,N=f*p,L=f*g,F=f*v,G=n.x,k=n.y,O=n.z;return r[0]=(1-(C+T))*G,r[1]=(x+F)*G,r[2]=(E-L)*G,r[3]=0,r[4]=(x-F)*k,r[5]=(1-(_+T))*k,r[6]=(w+N)*k,r[7]=0,r[8]=(E+L)*O,r[9]=(w-N)*O,r[10]=(1-(_+C))*O,r[11]=0,r[12]=e.x,r[13]=e.y,r[14]=e.z,r[15]=1,this}decompose(e,t,n){const r=this.elements;if(e.x=r[12],e.y=r[13],e.z=r[14],this.determinant()===0)return n.set(1,1,1),t.identity(),this;let s=pm.set(r[0],r[1],r[2]).length();const o=pm.set(r[4],r[5],r[6]).length(),u=pm.set(r[8],r[9],r[10]).length();this.determinant()<0&&(s=-s),Bl.copy(this);const p=1/s,g=1/o,v=1/u;return Bl.elements[0]*=p,Bl.elements[1]*=p,Bl.elements[2]*=p,Bl.elements[4]*=g,Bl.elements[5]*=g,Bl.elements[6]*=g,Bl.elements[8]*=v,Bl.elements[9]*=v,Bl.elements[10]*=v,t.setFromRotationMatrix(Bl),n.x=s,n.y=o,n.z=u,this}makePerspective(e,t,n,r,s,o,u=xo,f=!1){const p=this.elements,g=2*s/(t-e),v=2*s/(n-r),_=(t+e)/(t-e),x=(n+r)/(n-r);let E,C;if(f)E=s/(o-s),C=o*s/(o-s);else if(u===xo)E=-(o+s)/(o-s),C=-2*o*s/(o-s);else if(u===ug)E=-o/(o-s),C=-o*s/(o-s);else throw new Error("THREE.Matrix4.makePerspective(): Invalid coordinate system: "+u);return p[0]=g,p[4]=0,p[8]=_,p[12]=0,p[1]=0,p[5]=v,p[9]=x,p[13]=0,p[2]=0,p[6]=0,p[10]=E,p[14]=C,p[3]=0,p[7]=0,p[11]=-1,p[15]=0,this}makeOrthographic(e,t,n,r,s,o,u=xo,f=!1){const p=this.elements,g=2/(t-e),v=2/(n-r),_=-(t+e)/(t-e),x=-(n+r)/(n-r);let E,C;if(f)E=1/(o-s),C=o/(o-s);else if(u===xo)E=-2/(o-s),C=-(o+s)/(o-s);else if(u===ug)E=-1/(o-s),C=-s/(o-s);else throw new Error("THREE.Matrix4.makeOrthographic(): Invalid coordinate system: "+u);return p[0]=g,p[4]=0,p[8]=0,p[12]=_,p[1]=0,p[5]=v,p[9]=0,p[13]=x,p[2]=0,p[6]=0,p[10]=E,p[14]=C,p[3]=0,p[7]=0,p[11]=0,p[15]=1,this}equals(e){const t=this.elements,n=e.elements;for(let r=0;r<16;r++)if(t[r]!==n[r])return!1;return!0}fromArray(e,t=0){for(let n=0;n<16;n++)this.elements[n]=e[n+t];return this}toArray(e=[],t=0){const n=this.elements;return e[t]=n[0],e[t+1]=n[1],e[t+2]=n[2],e[t+3]=n[3],e[t+4]=n[4],e[t+5]=n[5],e[t+6]=n[6],e[t+7]=n[7],e[t+8]=n[8],e[t+9]=n[9],e[t+10]=n[10],e[t+11]=n[11],e[t+12]=n[12],e[t+13]=n[13],e[t+14]=n[14],e[t+15]=n[15],e}}const pm=new ie,Bl=new vn,XH=new ie(0,0,0),YH=new ie(1,1,1),Hh=new ie,ux=new ie,mo=new ie,PI=new vn,BI=new ys;class Eo{constructor(e=0,t=0,n=0,r=Eo.DEFAULT_ORDER){this.isEuler=!0,this._x=e,this._y=t,this._z=n,this._order=r}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get order(){return this._order}set order(e){this._order=e,this._onChangeCallback()}set(e,t,n,r=this._order){return this._x=e,this._y=t,this._z=n,this._order=r,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._order)}copy(e){return this._x=e._x,this._y=e._y,this._z=e._z,this._order=e._order,this._onChangeCallback(),this}setFromRotationMatrix(e,t=this._order,n=!0){const r=e.elements,s=r[0],o=r[4],u=r[8],f=r[1],p=r[5],g=r[9],v=r[2],_=r[6],x=r[10];switch(t){case"XYZ":this._y=Math.asin(An(u,-1,1)),Math.abs(u)<.9999999?(this._x=Math.atan2(-g,x),this._z=Math.atan2(-o,s)):(this._x=Math.atan2(_,p),this._z=0);break;case"YXZ":this._x=Math.asin(-An(g,-1,1)),Math.abs(g)<.9999999?(this._y=Math.atan2(u,x),this._z=Math.atan2(f,p)):(this._y=Math.atan2(-v,s),this._z=0);break;case"ZXY":this._x=Math.asin(An(_,-1,1)),Math.abs(_)<.9999999?(this._y=Math.atan2(-v,x),this._z=Math.atan2(-o,p)):(this._y=0,this._z=Math.atan2(f,s));break;case"ZYX":this._y=Math.asin(-An(v,-1,1)),Math.abs(v)<.9999999?(this._x=Math.atan2(_,x),this._z=Math.atan2(f,s)):(this._x=0,this._z=Math.atan2(-o,p));break;case"YZX":this._z=Math.asin(An(f,-1,1)),Math.abs(f)<.9999999?(this._x=Math.atan2(-g,p),this._y=Math.atan2(-v,s)):(this._x=0,this._y=Math.atan2(u,x));break;case"XZY":this._z=Math.asin(-An(o,-1,1)),Math.abs(o)<.9999999?(this._x=Math.atan2(_,p),this._y=Math.atan2(u,s)):(this._x=Math.atan2(-g,x),this._y=0);break;default:Ht("Euler: .setFromRotationMatrix() encountered an unknown order: "+t)}return this._order=t,n===!0&&this._onChangeCallback(),this}setFromQuaternion(e,t,n){return PI.makeRotationFromQuaternion(e),this.setFromRotationMatrix(PI,t,n)}setFromVector3(e,t=this._order){return this.set(e.x,e.y,e.z,t)}reorder(e){return BI.setFromEuler(this),this.setFromQuaternion(BI,e)}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._order===this._order}fromArray(e){return this._x=e[0],this._y=e[1],this._z=e[2],e[3]!==void 0&&(this._order=e[3]),this._onChangeCallback(),this}toArray(e=[],t=0){return e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._order,e}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._order}}Eo.DEFAULT_ORDER="XYZ";class dg{constructor(){this.mask=1}set(e){this.mask=(1<<e|0)>>>0}enable(e){this.mask|=1<<e|0}enableAll(){this.mask=-1}toggle(e){this.mask^=1<<e|0}disable(e){this.mask&=~(1<<e|0)}disableAll(){this.mask=0}test(e){return(this.mask&e.mask)!==0}isEnabled(e){return(this.mask&(1<<e|0))!==0}}let JH=0;const LI=new ie,mm=new ys,Mu=new vn,hx=new ie,Z0=new ie,KH=new ie,QH=new ys,OI=new ie(1,0,0),UI=new ie(0,1,0),FI=new ie(0,0,1),kI={type:"added"},ZH={type:"removed"},gm={type:"childadded",child:null},QE={type:"childremoved",child:null};class fi extends Wc{constructor(){super(),this.isObject3D=!0,Object.defineProperty(this,"id",{value:JH++}),this.uuid=bo(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=fi.DEFAULT_UP.clone();const e=new ie,t=new Eo,n=new ys,r=new ie(1,1,1);function s(){n.setFromEuler(t,!1)}function o(){t.setFromQuaternion(n,void 0,!1)}t._onChange(s),n._onChange(o),Object.defineProperties(this,{position:{configurable:!0,enumerable:!0,value:e},rotation:{configurable:!0,enumerable:!0,value:t},quaternion:{configurable:!0,enumerable:!0,value:n},scale:{configurable:!0,enumerable:!0,value:r},modelViewMatrix:{value:new vn},normalMatrix:{value:new Un}}),this.matrix=new vn,this.matrixWorld=new vn,this.matrixAutoUpdate=fi.DEFAULT_MATRIX_AUTO_UPDATE,this.matrixWorldAutoUpdate=fi.DEFAULT_MATRIX_WORLD_AUTO_UPDATE,this.matrixWorldNeedsUpdate=!1,this.layers=new dg,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.animations=[],this.customDepthMaterial=void 0,this.customDistanceMaterial=void 0,this.userData={}}onBeforeShadow(){}onAfterShadow(){}onBeforeRender(){}onAfterRender(){}applyMatrix4(e){this.matrixAutoUpdate&&this.updateMatrix(),this.matrix.premultiply(e),this.matrix.decompose(this.position,this.quaternion,this.scale)}applyQuaternion(e){return this.quaternion.premultiply(e),this}setRotationFromAxisAngle(e,t){this.quaternion.setFromAxisAngle(e,t)}setRotationFromEuler(e){this.quaternion.setFromEuler(e,!0)}setRotationFromMatrix(e){this.quaternion.setFromRotationMatrix(e)}setRotationFromQuaternion(e){this.quaternion.copy(e)}rotateOnAxis(e,t){return mm.setFromAxisAngle(e,t),this.quaternion.multiply(mm),this}rotateOnWorldAxis(e,t){return mm.setFromAxisAngle(e,t),this.quaternion.premultiply(mm),this}rotateX(e){return this.rotateOnAxis(OI,e)}rotateY(e){return this.rotateOnAxis(UI,e)}rotateZ(e){return this.rotateOnAxis(FI,e)}translateOnAxis(e,t){return LI.copy(e).applyQuaternion(this.quaternion),this.position.add(LI.multiplyScalar(t)),this}translateX(e){return this.translateOnAxis(OI,e)}translateY(e){return this.translateOnAxis(UI,e)}translateZ(e){return this.translateOnAxis(FI,e)}localToWorld(e){return this.updateWorldMatrix(!0,!1),e.applyMatrix4(this.matrixWorld)}worldToLocal(e){return this.updateWorldMatrix(!0,!1),e.applyMatrix4(Mu.copy(this.matrixWorld).invert())}lookAt(e,t,n){e.isVector3?hx.copy(e):hx.set(e,t,n);const r=this.parent;this.updateWorldMatrix(!0,!1),Z0.setFromMatrixPosition(this.matrixWorld),this.isCamera||this.isLight?Mu.lookAt(Z0,hx,this.up):Mu.lookAt(hx,Z0,this.up),this.quaternion.setFromRotationMatrix(Mu),r&&(Mu.extractRotation(r.matrixWorld),mm.setFromRotationMatrix(Mu),this.quaternion.premultiply(mm.invert()))}add(e){if(arguments.length>1){for(let t=0;t<arguments.length;t++)this.add(arguments[t]);return this}return e===this?(cn("Object3D.add: object can't be added as a child of itself.",e),this):(e&&e.isObject3D?(e.removeFromParent(),e.parent=this,this.children.push(e),e.dispatchEvent(kI),gm.child=e,this.dispatchEvent(gm),gm.child=null):cn("Object3D.add: object not an instance of THREE.Object3D.",e),this)}remove(e){if(arguments.length>1){for(let n=0;n<arguments.length;n++)this.remove(arguments[n]);return this}const t=this.children.indexOf(e);return t!==-1&&(e.parent=null,this.children.splice(t,1),e.dispatchEvent(ZH),QE.child=e,this.dispatchEvent(QE),QE.child=null),this}removeFromParent(){const e=this.parent;return e!==null&&e.remove(this),this}clear(){return this.remove(...this.children)}attach(e){return this.updateWorldMatrix(!0,!1),Mu.copy(this.matrixWorld).invert(),e.parent!==null&&(e.parent.updateWorldMatrix(!0,!1),Mu.multiply(e.parent.matrixWorld)),e.applyMatrix4(Mu),e.removeFromParent(),e.parent=this,this.children.push(e),e.updateWorldMatrix(!1,!0),e.dispatchEvent(kI),gm.child=e,this.dispatchEvent(gm),gm.child=null,this}getObjectById(e){return this.getObjectByProperty("id",e)}getObjectByName(e){return this.getObjectByProperty("name",e)}getObjectByProperty(e,t){if(this[e]===t)return this;for(let n=0,r=this.children.length;n<r;n++){const o=this.children[n].getObjectByProperty(e,t);if(o!==void 0)return o}}getObjectsByProperty(e,t,n=[]){this[e]===t&&n.push(this);const r=this.children;for(let s=0,o=r.length;s<o;s++)r[s].getObjectsByProperty(e,t,n);return n}getWorldPosition(e){return this.updateWorldMatrix(!0,!1),e.setFromMatrixPosition(this.matrixWorld)}getWorldQuaternion(e){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(Z0,e,KH),e}getWorldScale(e){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(Z0,QH,e),e}getWorldDirection(e){this.updateWorldMatrix(!0,!1);const t=this.matrixWorld.elements;return e.set(t[8],t[9],t[10]).normalize()}raycast(){}traverse(e){e(this);const t=this.children;for(let n=0,r=t.length;n<r;n++)t[n].traverse(e)}traverseVisible(e){if(this.visible===!1)return;e(this);const t=this.children;for(let n=0,r=t.length;n<r;n++)t[n].traverseVisible(e)}traverseAncestors(e){const t=this.parent;t!==null&&(e(t),t.traverseAncestors(e))}updateMatrix(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0}updateMatrixWorld(e){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||e)&&(this.matrixWorldAutoUpdate===!0&&(this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix)),this.matrixWorldNeedsUpdate=!1,e=!0);const t=this.children;for(let n=0,r=t.length;n<r;n++)t[n].updateMatrixWorld(e)}updateWorldMatrix(e,t){const n=this.parent;if(e===!0&&n!==null&&n.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),this.matrixWorldAutoUpdate===!0&&(this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix)),t===!0){const r=this.children;for(let s=0,o=r.length;s<o;s++)r[s].updateWorldMatrix(!1,!0)}}toJSON(e){const t=e===void 0||typeof e=="string",n={};t&&(e={geometries:{},materials:{},textures:{},images:{},shapes:{},skeletons:{},animations:{},nodes:{}},n.metadata={version:4.7,type:"Object",generator:"Object3D.toJSON"});const r={};r.uuid=this.uuid,r.type=this.type,this.name!==""&&(r.name=this.name),this.castShadow===!0&&(r.castShadow=!0),this.receiveShadow===!0&&(r.receiveShadow=!0),this.visible===!1&&(r.visible=!1),this.frustumCulled===!1&&(r.frustumCulled=!1),this.renderOrder!==0&&(r.renderOrder=this.renderOrder),Object.keys(this.userData).length>0&&(r.userData=this.userData),r.layers=this.layers.mask,r.matrix=this.matrix.toArray(),r.up=this.up.toArray(),this.matrixAutoUpdate===!1&&(r.matrixAutoUpdate=!1),this.isInstancedMesh&&(r.type="InstancedMesh",r.count=this.count,r.instanceMatrix=this.instanceMatrix.toJSON(),this.instanceColor!==null&&(r.instanceColor=this.instanceColor.toJSON())),this.isBatchedMesh&&(r.type="BatchedMesh",r.perObjectFrustumCulled=this.perObjectFrustumCulled,r.sortObjects=this.sortObjects,r.drawRanges=this._drawRanges,r.reservedRanges=this._reservedRanges,r.geometryInfo=this._geometryInfo.map(u=>({...u,boundingBox:u.boundingBox?u.boundingBox.toJSON():void 0,boundingSphere:u.boundingSphere?u.boundingSphere.toJSON():void 0})),r.instanceInfo=this._instanceInfo.map(u=>({...u})),r.availableInstanceIds=this._availableInstanceIds.slice(),r.availableGeometryIds=this._availableGeometryIds.slice(),r.nextIndexStart=this._nextIndexStart,r.nextVertexStart=this._nextVertexStart,r.geometryCount=this._geometryCount,r.maxInstanceCount=this._maxInstanceCount,r.maxVertexCount=this._maxVertexCount,r.maxIndexCount=this._maxIndexCount,r.geometryInitialized=this._geometryInitialized,r.matricesTexture=this._matricesTexture.toJSON(e),r.indirectTexture=this._indirectTexture.toJSON(e),this._colorsTexture!==null&&(r.colorsTexture=this._colorsTexture.toJSON(e)),this.boundingSphere!==null&&(r.boundingSphere=this.boundingSphere.toJSON()),this.boundingBox!==null&&(r.boundingBox=this.boundingBox.toJSON()));function s(u,f){return u[f.uuid]===void 0&&(u[f.uuid]=f.toJSON(e)),f.uuid}if(this.isScene)this.background&&(this.background.isColor?r.background=this.background.toJSON():this.background.isTexture&&(r.background=this.background.toJSON(e).uuid)),this.environment&&this.environment.isTexture&&this.environment.isRenderTargetTexture!==!0&&(r.environment=this.environment.toJSON(e).uuid);else if(this.isMesh||this.isLine||this.isPoints){r.geometry=s(e.geometries,this.geometry);const u=this.geometry.parameters;if(u!==void 0&&u.shapes!==void 0){const f=u.shapes;if(Array.isArray(f))for(let p=0,g=f.length;p<g;p++){const v=f[p];s(e.shapes,v)}else s(e.shapes,f)}}if(this.isSkinnedMesh&&(r.bindMode=this.bindMode,r.bindMatrix=this.bindMatrix.toArray(),this.skeleton!==void 0&&(s(e.skeletons,this.skeleton),r.skeleton=this.skeleton.uuid)),this.material!==void 0)if(Array.isArray(this.material)){const u=[];for(let f=0,p=this.material.length;f<p;f++)u.push(s(e.materials,this.material[f]));r.material=u}else r.material=s(e.materials,this.material);if(this.children.length>0){r.children=[];for(let u=0;u<this.children.length;u++)r.children.push(this.children[u].toJSON(e).object)}if(this.animations.length>0){r.animations=[];for(let u=0;u<this.animations.length;u++){const f=this.animations[u];r.animations.push(s(e.animations,f))}}if(t){const u=o(e.geometries),f=o(e.materials),p=o(e.textures),g=o(e.images),v=o(e.shapes),_=o(e.skeletons),x=o(e.animations),E=o(e.nodes);u.length>0&&(n.geometries=u),f.length>0&&(n.materials=f),p.length>0&&(n.textures=p),g.length>0&&(n.images=g),v.length>0&&(n.shapes=v),_.length>0&&(n.skeletons=_),x.length>0&&(n.animations=x),E.length>0&&(n.nodes=E)}return n.object=r,n;function o(u){const f=[];for(const p in u){const g=u[p];delete g.metadata,f.push(g)}return f}}clone(e){return new this.constructor().copy(this,e)}copy(e,t=!0){if(this.name=e.name,this.up.copy(e.up),this.position.copy(e.position),this.rotation.order=e.rotation.order,this.quaternion.copy(e.quaternion),this.scale.copy(e.scale),this.matrix.copy(e.matrix),this.matrixWorld.copy(e.matrixWorld),this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrixWorldAutoUpdate=e.matrixWorldAutoUpdate,this.matrixWorldNeedsUpdate=e.matrixWorldNeedsUpdate,this.layers.mask=e.layers.mask,this.visible=e.visible,this.castShadow=e.castShadow,this.receiveShadow=e.receiveShadow,this.frustumCulled=e.frustumCulled,this.renderOrder=e.renderOrder,this.animations=e.animations.slice(),this.userData=JSON.parse(JSON.stringify(e.userData)),t===!0)for(let n=0;n<e.children.length;n++){const r=e.children[n];this.add(r.clone())}return this}}fi.DEFAULT_UP=new ie(0,1,0);fi.DEFAULT_MATRIX_AUTO_UPDATE=!0;fi.DEFAULT_MATRIX_WORLD_AUTO_UPDATE=!0;const Ll=new ie,wu=new ie,ZE=new ie,Cu=new ie,vm=new ie,ym=new ie,zI=new ie,$E=new ie,e1=new ie,t1=new ie,n1=new zi,i1=new zi,r1=new zi;class eo{constructor(e=new ie,t=new ie,n=new ie){this.a=e,this.b=t,this.c=n}static getNormal(e,t,n,r){r.subVectors(n,t),Ll.subVectors(e,t),r.cross(Ll);const s=r.lengthSq();return s>0?r.multiplyScalar(1/Math.sqrt(s)):r.set(0,0,0)}static getBarycoord(e,t,n,r,s){Ll.subVectors(r,t),wu.subVectors(n,t),ZE.subVectors(e,t);const o=Ll.dot(Ll),u=Ll.dot(wu),f=Ll.dot(ZE),p=wu.dot(wu),g=wu.dot(ZE),v=o*p-u*u;if(v===0)return s.set(0,0,0),null;const _=1/v,x=(p*f-u*g)*_,E=(o*g-u*f)*_;return s.set(1-x-E,E,x)}static containsPoint(e,t,n,r){return this.getBarycoord(e,t,n,r,Cu)===null?!1:Cu.x>=0&&Cu.y>=0&&Cu.x+Cu.y<=1}static getInterpolation(e,t,n,r,s,o,u,f){return this.getBarycoord(e,t,n,r,Cu)===null?(f.x=0,f.y=0,"z"in f&&(f.z=0),"w"in f&&(f.w=0),null):(f.setScalar(0),f.addScaledVector(s,Cu.x),f.addScaledVector(o,Cu.y),f.addScaledVector(u,Cu.z),f)}static getInterpolatedAttribute(e,t,n,r,s,o){return n1.setScalar(0),i1.setScalar(0),r1.setScalar(0),n1.fromBufferAttribute(e,t),i1.fromBufferAttribute(e,n),r1.fromBufferAttribute(e,r),o.setScalar(0),o.addScaledVector(n1,s.x),o.addScaledVector(i1,s.y),o.addScaledVector(r1,s.z),o}static isFrontFacing(e,t,n,r){return Ll.subVectors(n,t),wu.subVectors(e,t),Ll.cross(wu).dot(r)<0}set(e,t,n){return this.a.copy(e),this.b.copy(t),this.c.copy(n),this}setFromPointsAndIndices(e,t,n,r){return this.a.copy(e[t]),this.b.copy(e[n]),this.c.copy(e[r]),this}setFromAttributeAndIndices(e,t,n,r){return this.a.fromBufferAttribute(e,t),this.b.fromBufferAttribute(e,n),this.c.fromBufferAttribute(e,r),this}clone(){return new this.constructor().copy(this)}copy(e){return this.a.copy(e.a),this.b.copy(e.b),this.c.copy(e.c),this}getArea(){return Ll.subVectors(this.c,this.b),wu.subVectors(this.a,this.b),Ll.cross(wu).length()*.5}getMidpoint(e){return e.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)}getNormal(e){return eo.getNormal(this.a,this.b,this.c,e)}getPlane(e){return e.setFromCoplanarPoints(this.a,this.b,this.c)}getBarycoord(e,t){return eo.getBarycoord(e,this.a,this.b,this.c,t)}getInterpolation(e,t,n,r,s){return eo.getInterpolation(e,this.a,this.b,this.c,t,n,r,s)}containsPoint(e){return eo.containsPoint(e,this.a,this.b,this.c)}isFrontFacing(e){return eo.isFrontFacing(this.a,this.b,this.c,e)}intersectsBox(e){return e.intersectsTriangle(this)}closestPointToPoint(e,t){const n=this.a,r=this.b,s=this.c;let o,u;vm.subVectors(r,n),ym.subVectors(s,n),$E.subVectors(e,n);const f=vm.dot($E),p=ym.dot($E);if(f<=0&&p<=0)return t.copy(n);e1.subVectors(e,r);const g=vm.dot(e1),v=ym.dot(e1);if(g>=0&&v<=g)return t.copy(r);const _=f*v-g*p;if(_<=0&&f>=0&&g<=0)return o=f/(f-g),t.copy(n).addScaledVector(vm,o);t1.subVectors(e,s);const x=vm.dot(t1),E=ym.dot(t1);if(E>=0&&x<=E)return t.copy(s);const C=x*p-f*E;if(C<=0&&p>=0&&E<=0)return u=p/(p-E),t.copy(n).addScaledVector(ym,u);const w=g*E-x*v;if(w<=0&&v-g>=0&&x-E>=0)return zI.subVectors(s,r),u=(v-g)/(v-g+(x-E)),t.copy(r).addScaledVector(zI,u);const T=1/(w+C+_);return o=C*T,u=_*T,t.copy(n).addScaledVector(vm,o).addScaledVector(ym,u)}equals(e){return e.a.equals(this.a)&&e.b.equals(this.b)&&e.c.equals(this.c)}}const tL={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},Gh={h:0,s:0,l:0},fx={h:0,s:0,l:0};function s1(i,e,t){return t<0&&(t+=1),t>1&&(t-=1),t<1/6?i+(e-i)*6*t:t<1/2?e:t<2/3?i+(e-i)*6*(2/3-t):i}class Gt{constructor(e,t,n){return this.isColor=!0,this.r=1,this.g=1,this.b=1,this.set(e,t,n)}set(e,t,n){if(t===void 0&&n===void 0){const r=e;r&&r.isColor?this.copy(r):typeof r=="number"?this.setHex(r):typeof r=="string"&&this.setStyle(r)}else this.setRGB(e,t,n);return this}setScalar(e){return this.r=e,this.g=e,this.b=e,this}setHex(e,t=Fs){return e=Math.floor(e),this.r=(e>>16&255)/255,this.g=(e>>8&255)/255,this.b=(e&255)/255,oi.colorSpaceToWorking(this,t),this}setRGB(e,t,n,r=oi.workingColorSpace){return this.r=e,this.g=t,this.b=n,oi.colorSpaceToWorking(this,r),this}setHSL(e,t,n,r=oi.workingColorSpace){if(e=lw(e,1),t=An(t,0,1),n=An(n,0,1),t===0)this.r=this.g=this.b=n;else{const s=n<=.5?n*(1+t):n+t-n*t,o=2*n-s;this.r=s1(o,s,e+1/3),this.g=s1(o,s,e),this.b=s1(o,s,e-1/3)}return oi.colorSpaceToWorking(this,r),this}setStyle(e,t=Fs){function n(s){s!==void 0&&parseFloat(s)<1&&Ht("Color: Alpha component of "+e+" will be ignored.")}let r;if(r=/^(\w+)\(([^\)]*)\)/.exec(e)){let s;const o=r[1],u=r[2];switch(o){case"rgb":case"rgba":if(s=/^\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(u))return n(s[4]),this.setRGB(Math.min(255,parseInt(s[1],10))/255,Math.min(255,parseInt(s[2],10))/255,Math.min(255,parseInt(s[3],10))/255,t);if(s=/^\s*(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(u))return n(s[4]),this.setRGB(Math.min(100,parseInt(s[1],10))/100,Math.min(100,parseInt(s[2],10))/100,Math.min(100,parseInt(s[3],10))/100,t);break;case"hsl":case"hsla":if(s=/^\s*(\d*\.?\d+)\s*,\s*(\d*\.?\d+)\%\s*,\s*(\d*\.?\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(u))return n(s[4]),this.setHSL(parseFloat(s[1])/360,parseFloat(s[2])/100,parseFloat(s[3])/100,t);break;default:Ht("Color: Unknown color model "+e)}}else if(r=/^\#([A-Fa-f\d]+)$/.exec(e)){const s=r[1],o=s.length;if(o===3)return this.setRGB(parseInt(s.charAt(0),16)/15,parseInt(s.charAt(1),16)/15,parseInt(s.charAt(2),16)/15,t);if(o===6)return this.setHex(parseInt(s,16),t);Ht("Color: Invalid hex color "+e)}else if(e&&e.length>0)return this.setColorName(e,t);return this}setColorName(e,t=Fs){const n=tL[e.toLowerCase()];return n!==void 0?this.setHex(n,t):Ht("Color: Unknown color "+e),this}clone(){return new this.constructor(this.r,this.g,this.b)}copy(e){return this.r=e.r,this.g=e.g,this.b=e.b,this}copySRGBToLinear(e){return this.r=Fu(e.r),this.g=Fu(e.g),this.b=Fu(e.b),this}copyLinearToSRGB(e){return this.r=Xm(e.r),this.g=Xm(e.g),this.b=Xm(e.b),this}convertSRGBToLinear(){return this.copySRGBToLinear(this),this}convertLinearToSRGB(){return this.copyLinearToSRGB(this),this}getHex(e=Fs){return oi.workingToColorSpace(aa.copy(this),e),Math.round(An(aa.r*255,0,255))*65536+Math.round(An(aa.g*255,0,255))*256+Math.round(An(aa.b*255,0,255))}getHexString(e=Fs){return("000000"+this.getHex(e).toString(16)).slice(-6)}getHSL(e,t=oi.workingColorSpace){oi.workingToColorSpace(aa.copy(this),t);const n=aa.r,r=aa.g,s=aa.b,o=Math.max(n,r,s),u=Math.min(n,r,s);let f,p;const g=(u+o)/2;if(u===o)f=0,p=0;else{const v=o-u;switch(p=g<=.5?v/(o+u):v/(2-o-u),o){case n:f=(r-s)/v+(r<s?6:0);break;case r:f=(s-n)/v+2;break;case s:f=(n-r)/v+4;break}f/=6}return e.h=f,e.s=p,e.l=g,e}getRGB(e,t=oi.workingColorSpace){return oi.workingToColorSpace(aa.copy(this),t),e.r=aa.r,e.g=aa.g,e.b=aa.b,e}getStyle(e=Fs){oi.workingToColorSpace(aa.copy(this),e);const t=aa.r,n=aa.g,r=aa.b;return e!==Fs?`color(${e} ${t.toFixed(3)} ${n.toFixed(3)} ${r.toFixed(3)})`:`rgb(${Math.round(t*255)},${Math.round(n*255)},${Math.round(r*255)})`}offsetHSL(e,t,n){return this.getHSL(Gh),this.setHSL(Gh.h+e,Gh.s+t,Gh.l+n)}add(e){return this.r+=e.r,this.g+=e.g,this.b+=e.b,this}addColors(e,t){return this.r=e.r+t.r,this.g=e.g+t.g,this.b=e.b+t.b,this}addScalar(e){return this.r+=e,this.g+=e,this.b+=e,this}sub(e){return this.r=Math.max(0,this.r-e.r),this.g=Math.max(0,this.g-e.g),this.b=Math.max(0,this.b-e.b),this}multiply(e){return this.r*=e.r,this.g*=e.g,this.b*=e.b,this}multiplyScalar(e){return this.r*=e,this.g*=e,this.b*=e,this}lerp(e,t){return this.r+=(e.r-this.r)*t,this.g+=(e.g-this.g)*t,this.b+=(e.b-this.b)*t,this}lerpColors(e,t,n){return this.r=e.r+(t.r-e.r)*n,this.g=e.g+(t.g-e.g)*n,this.b=e.b+(t.b-e.b)*n,this}lerpHSL(e,t){this.getHSL(Gh),e.getHSL(fx);const n=Iv(Gh.h,fx.h,t),r=Iv(Gh.s,fx.s,t),s=Iv(Gh.l,fx.l,t);return this.setHSL(n,r,s),this}setFromVector3(e){return this.r=e.x,this.g=e.y,this.b=e.z,this}applyMatrix3(e){const t=this.r,n=this.g,r=this.b,s=e.elements;return this.r=s[0]*t+s[3]*n+s[6]*r,this.g=s[1]*t+s[4]*n+s[7]*r,this.b=s[2]*t+s[5]*n+s[8]*r,this}equals(e){return e.r===this.r&&e.g===this.g&&e.b===this.b}fromArray(e,t=0){return this.r=e[t],this.g=e[t+1],this.b=e[t+2],this}toArray(e=[],t=0){return e[t]=this.r,e[t+1]=this.g,e[t+2]=this.b,e}fromBufferAttribute(e,t){return this.r=e.getX(t),this.g=e.getY(t),this.b=e.getZ(t),this}toJSON(){return this.getHex()}*[Symbol.iterator](){yield this.r,yield this.g,yield this.b}}const aa=new Gt;Gt.NAMES=tL;let $H=0;class os extends Wc{constructor(){super(),this.isMaterial=!0,Object.defineProperty(this,"id",{value:$H++}),this.uuid=bo(),this.name="",this.type="Material",this.blending=Hd,this.side=Gc,this.vertexColors=!1,this.opacity=1,this.transparent=!1,this.alphaHash=!1,this.blendSrc=Ub,this.blendDst=Fb,this.blendEquation=Qh,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.blendColor=new Gt(0,0,0),this.blendAlpha=0,this.depthFunc=Qd,this.depthTest=!0,this.depthWrite=!0,this.stencilWriteMask=255,this.stencilFunc=CT,this.stencilRef=0,this.stencilFuncMask=255,this.stencilFail=Cd,this.stencilZFail=Cd,this.stencilZPass=Cd,this.stencilWrite=!1,this.clippingPlanes=null,this.clipIntersection=!1,this.clipShadows=!1,this.shadowSide=null,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.dithering=!1,this.alphaToCoverage=!1,this.premultipliedAlpha=!1,this.forceSinglePass=!1,this.allowOverride=!0,this.visible=!0,this.toneMapped=!0,this.userData={},this.version=0,this._alphaTest=0}get alphaTest(){return this._alphaTest}set alphaTest(e){this._alphaTest>0!=e>0&&this.version++,this._alphaTest=e}onBeforeRender(){}onBeforeCompile(){}customProgramCacheKey(){return this.onBeforeCompile.toString()}setValues(e){if(e!==void 0)for(const t in e){const n=e[t];if(n===void 0){Ht(`Material: parameter '${t}' has value of undefined.`);continue}const r=this[t];if(r===void 0){Ht(`Material: '${t}' is not a property of THREE.${this.type}.`);continue}r&&r.isColor?r.set(n):r&&r.isVector3&&n&&n.isVector3?r.copy(n):this[t]=n}}toJSON(e){const t=e===void 0||typeof e=="string";t&&(e={textures:{},images:{}});const n={metadata:{version:4.7,type:"Material",generator:"Material.toJSON"}};n.uuid=this.uuid,n.type=this.type,this.name!==""&&(n.name=this.name),this.color&&this.color.isColor&&(n.color=this.color.getHex()),this.roughness!==void 0&&(n.roughness=this.roughness),this.metalness!==void 0&&(n.metalness=this.metalness),this.sheen!==void 0&&(n.sheen=this.sheen),this.sheenColor&&this.sheenColor.isColor&&(n.sheenColor=this.sheenColor.getHex()),this.sheenRoughness!==void 0&&(n.sheenRoughness=this.sheenRoughness),this.emissive&&this.emissive.isColor&&(n.emissive=this.emissive.getHex()),this.emissiveIntensity!==void 0&&this.emissiveIntensity!==1&&(n.emissiveIntensity=this.emissiveIntensity),this.specular&&this.specular.isColor&&(n.specular=this.specular.getHex()),this.specularIntensity!==void 0&&(n.specularIntensity=this.specularIntensity),this.specularColor&&this.specularColor.isColor&&(n.specularColor=this.specularColor.getHex()),this.shininess!==void 0&&(n.shininess=this.shininess),this.clearcoat!==void 0&&(n.clearcoat=this.clearcoat),this.clearcoatRoughness!==void 0&&(n.clearcoatRoughness=this.clearcoatRoughness),this.clearcoatMap&&this.clearcoatMap.isTexture&&(n.clearcoatMap=this.clearcoatMap.toJSON(e).uuid),this.clearcoatRoughnessMap&&this.clearcoatRoughnessMap.isTexture&&(n.clearcoatRoughnessMap=this.clearcoatRoughnessMap.toJSON(e).uuid),this.clearcoatNormalMap&&this.clearcoatNormalMap.isTexture&&(n.clearcoatNormalMap=this.clearcoatNormalMap.toJSON(e).uuid,n.clearcoatNormalScale=this.clearcoatNormalScale.toArray()),this.sheenColorMap&&this.sheenColorMap.isTexture&&(n.sheenColorMap=this.sheenColorMap.toJSON(e).uuid),this.sheenRoughnessMap&&this.sheenRoughnessMap.isTexture&&(n.sheenRoughnessMap=this.sheenRoughnessMap.toJSON(e).uuid),this.dispersion!==void 0&&(n.dispersion=this.dispersion),this.iridescence!==void 0&&(n.iridescence=this.iridescence),this.iridescenceIOR!==void 0&&(n.iridescenceIOR=this.iridescenceIOR),this.iridescenceThicknessRange!==void 0&&(n.iridescenceThicknessRange=this.iridescenceThicknessRange),this.iridescenceMap&&this.iridescenceMap.isTexture&&(n.iridescenceMap=this.iridescenceMap.toJSON(e).uuid),this.iridescenceThicknessMap&&this.iridescenceThicknessMap.isTexture&&(n.iridescenceThicknessMap=this.iridescenceThicknessMap.toJSON(e).uuid),this.anisotropy!==void 0&&(n.anisotropy=this.anisotropy),this.anisotropyRotation!==void 0&&(n.anisotropyRotation=this.anisotropyRotation),this.anisotropyMap&&this.anisotropyMap.isTexture&&(n.anisotropyMap=this.anisotropyMap.toJSON(e).uuid),this.map&&this.map.isTexture&&(n.map=this.map.toJSON(e).uuid),this.matcap&&this.matcap.isTexture&&(n.matcap=this.matcap.toJSON(e).uuid),this.alphaMap&&this.alphaMap.isTexture&&(n.alphaMap=this.alphaMap.toJSON(e).uuid),this.lightMap&&this.lightMap.isTexture&&(n.lightMap=this.lightMap.toJSON(e).uuid,n.lightMapIntensity=this.lightMapIntensity),this.aoMap&&this.aoMap.isTexture&&(n.aoMap=this.aoMap.toJSON(e).uuid,n.aoMapIntensity=this.aoMapIntensity),this.bumpMap&&this.bumpMap.isTexture&&(n.bumpMap=this.bumpMap.toJSON(e).uuid,n.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(n.normalMap=this.normalMap.toJSON(e).uuid,n.normalMapType=this.normalMapType,n.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(n.displacementMap=this.displacementMap.toJSON(e).uuid,n.displacementScale=this.displacementScale,n.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(n.roughnessMap=this.roughnessMap.toJSON(e).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(n.metalnessMap=this.metalnessMap.toJSON(e).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(n.emissiveMap=this.emissiveMap.toJSON(e).uuid),this.specularMap&&this.specularMap.isTexture&&(n.specularMap=this.specularMap.toJSON(e).uuid),this.specularIntensityMap&&this.specularIntensityMap.isTexture&&(n.specularIntensityMap=this.specularIntensityMap.toJSON(e).uuid),this.specularColorMap&&this.specularColorMap.isTexture&&(n.specularColorMap=this.specularColorMap.toJSON(e).uuid),this.envMap&&this.envMap.isTexture&&(n.envMap=this.envMap.toJSON(e).uuid,this.combine!==void 0&&(n.combine=this.combine)),this.envMapRotation!==void 0&&(n.envMapRotation=this.envMapRotation.toArray()),this.envMapIntensity!==void 0&&(n.envMapIntensity=this.envMapIntensity),this.reflectivity!==void 0&&(n.reflectivity=this.reflectivity),this.refractionRatio!==void 0&&(n.refractionRatio=this.refractionRatio),this.gradientMap&&this.gradientMap.isTexture&&(n.gradientMap=this.gradientMap.toJSON(e).uuid),this.transmission!==void 0&&(n.transmission=this.transmission),this.transmissionMap&&this.transmissionMap.isTexture&&(n.transmissionMap=this.transmissionMap.toJSON(e).uuid),this.thickness!==void 0&&(n.thickness=this.thickness),this.thicknessMap&&this.thicknessMap.isTexture&&(n.thicknessMap=this.thicknessMap.toJSON(e).uuid),this.attenuationDistance!==void 0&&this.attenuationDistance!==1/0&&(n.attenuationDistance=this.attenuationDistance),this.attenuationColor!==void 0&&(n.attenuationColor=this.attenuationColor.getHex()),this.size!==void 0&&(n.size=this.size),this.shadowSide!==null&&(n.shadowSide=this.shadowSide),this.sizeAttenuation!==void 0&&(n.sizeAttenuation=this.sizeAttenuation),this.blending!==Hd&&(n.blending=this.blending),this.side!==Gc&&(n.side=this.side),this.vertexColors===!0&&(n.vertexColors=!0),this.opacity<1&&(n.opacity=this.opacity),this.transparent===!0&&(n.transparent=!0),this.blendSrc!==Ub&&(n.blendSrc=this.blendSrc),this.blendDst!==Fb&&(n.blendDst=this.blendDst),this.blendEquation!==Qh&&(n.blendEquation=this.blendEquation),this.blendSrcAlpha!==null&&(n.blendSrcAlpha=this.blendSrcAlpha),this.blendDstAlpha!==null&&(n.blendDstAlpha=this.blendDstAlpha),this.blendEquationAlpha!==null&&(n.blendEquationAlpha=this.blendEquationAlpha),this.blendColor&&this.blendColor.isColor&&(n.blendColor=this.blendColor.getHex()),this.blendAlpha!==0&&(n.blendAlpha=this.blendAlpha),this.depthFunc!==Qd&&(n.depthFunc=this.depthFunc),this.depthTest===!1&&(n.depthTest=this.depthTest),this.depthWrite===!1&&(n.depthWrite=this.depthWrite),this.colorWrite===!1&&(n.colorWrite=this.colorWrite),this.stencilWriteMask!==255&&(n.stencilWriteMask=this.stencilWriteMask),this.stencilFunc!==CT&&(n.stencilFunc=this.stencilFunc),this.stencilRef!==0&&(n.stencilRef=this.stencilRef),this.stencilFuncMask!==255&&(n.stencilFuncMask=this.stencilFuncMask),this.stencilFail!==Cd&&(n.stencilFail=this.stencilFail),this.stencilZFail!==Cd&&(n.stencilZFail=this.stencilZFail),this.stencilZPass!==Cd&&(n.stencilZPass=this.stencilZPass),this.stencilWrite===!0&&(n.stencilWrite=this.stencilWrite),this.rotation!==void 0&&this.rotation!==0&&(n.rotation=this.rotation),this.polygonOffset===!0&&(n.polygonOffset=!0),this.polygonOffsetFactor!==0&&(n.polygonOffsetFactor=this.polygonOffsetFactor),this.polygonOffsetUnits!==0&&(n.polygonOffsetUnits=this.polygonOffsetUnits),this.linewidth!==void 0&&this.linewidth!==1&&(n.linewidth=this.linewidth),this.dashSize!==void 0&&(n.dashSize=this.dashSize),this.gapSize!==void 0&&(n.gapSize=this.gapSize),this.scale!==void 0&&(n.scale=this.scale),this.dithering===!0&&(n.dithering=!0),this.alphaTest>0&&(n.alphaTest=this.alphaTest),this.alphaHash===!0&&(n.alphaHash=!0),this.alphaToCoverage===!0&&(n.alphaToCoverage=!0),this.premultipliedAlpha===!0&&(n.premultipliedAlpha=!0),this.forceSinglePass===!0&&(n.forceSinglePass=!0),this.allowOverride===!1&&(n.allowOverride=!1),this.wireframe===!0&&(n.wireframe=!0),this.wireframeLinewidth>1&&(n.wireframeLinewidth=this.wireframeLinewidth),this.wireframeLinecap!=="round"&&(n.wireframeLinecap=this.wireframeLinecap),this.wireframeLinejoin!=="round"&&(n.wireframeLinejoin=this.wireframeLinejoin),this.flatShading===!0&&(n.flatShading=!0),this.visible===!1&&(n.visible=!1),this.toneMapped===!1&&(n.toneMapped=!1),this.fog===!1&&(n.fog=!1),Object.keys(this.userData).length>0&&(n.userData=this.userData);function r(s){const o=[];for(const u in s){const f=s[u];delete f.metadata,o.push(f)}return o}if(t){const s=r(e.textures),o=r(e.images);s.length>0&&(n.textures=s),o.length>0&&(n.images=o)}return n}clone(){return new this.constructor().copy(this)}copy(e){this.name=e.name,this.blending=e.blending,this.side=e.side,this.vertexColors=e.vertexColors,this.opacity=e.opacity,this.transparent=e.transparent,this.blendSrc=e.blendSrc,this.blendDst=e.blendDst,this.blendEquation=e.blendEquation,this.blendSrcAlpha=e.blendSrcAlpha,this.blendDstAlpha=e.blendDstAlpha,this.blendEquationAlpha=e.blendEquationAlpha,this.blendColor.copy(e.blendColor),this.blendAlpha=e.blendAlpha,this.depthFunc=e.depthFunc,this.depthTest=e.depthTest,this.depthWrite=e.depthWrite,this.stencilWriteMask=e.stencilWriteMask,this.stencilFunc=e.stencilFunc,this.stencilRef=e.stencilRef,this.stencilFuncMask=e.stencilFuncMask,this.stencilFail=e.stencilFail,this.stencilZFail=e.stencilZFail,this.stencilZPass=e.stencilZPass,this.stencilWrite=e.stencilWrite;const t=e.clippingPlanes;let n=null;if(t!==null){const r=t.length;n=new Array(r);for(let s=0;s!==r;++s)n[s]=t[s].clone()}return this.clippingPlanes=n,this.clipIntersection=e.clipIntersection,this.clipShadows=e.clipShadows,this.shadowSide=e.shadowSide,this.colorWrite=e.colorWrite,this.precision=e.precision,this.polygonOffset=e.polygonOffset,this.polygonOffsetFactor=e.polygonOffsetFactor,this.polygonOffsetUnits=e.polygonOffsetUnits,this.dithering=e.dithering,this.alphaTest=e.alphaTest,this.alphaHash=e.alphaHash,this.alphaToCoverage=e.alphaToCoverage,this.premultipliedAlpha=e.premultipliedAlpha,this.forceSinglePass=e.forceSinglePass,this.allowOverride=e.allowOverride,this.visible=e.visible,this.toneMapped=e.toneMapped,this.userData=JSON.parse(JSON.stringify(e.userData)),this}dispose(){this.dispatchEvent({type:"dispose"})}set needsUpdate(e){e===!0&&this.version++}}class to extends os{constructor(e){super(),this.isMeshBasicMaterial=!0,this.type="MeshBasicMaterial",this.color=new Gt(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new Eo,this.combine=vy,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapRotation.copy(e.envMapRotation),this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.fog=e.fog,this}}const Pu=eG();function eG(){const i=new ArrayBuffer(4),e=new Float32Array(i),t=new Uint32Array(i),n=new Uint32Array(512),r=new Uint32Array(512);for(let f=0;f<256;++f){const p=f-127;p<-27?(n[f]=0,n[f|256]=32768,r[f]=24,r[f|256]=24):p<-14?(n[f]=1024>>-p-14,n[f|256]=1024>>-p-14|32768,r[f]=-p-1,r[f|256]=-p-1):p<=15?(n[f]=p+15<<10,n[f|256]=p+15<<10|32768,r[f]=13,r[f|256]=13):p<128?(n[f]=31744,n[f|256]=64512,r[f]=24,r[f|256]=24):(n[f]=31744,n[f|256]=64512,r[f]=13,r[f|256]=13)}const s=new Uint32Array(2048),o=new Uint32Array(64),u=new Uint32Array(64);for(let f=1;f<1024;++f){let p=f<<13,g=0;for(;(p&8388608)===0;)p<<=1,g-=8388608;p&=-8388609,g+=947912704,s[f]=p|g}for(let f=1024;f<2048;++f)s[f]=939524096+(f-1024<<13);for(let f=1;f<31;++f)o[f]=f<<23;o[31]=1199570944,o[32]=2147483648;for(let f=33;f<63;++f)o[f]=2147483648+(f-32<<23);o[63]=3347054592;for(let f=1;f<64;++f)f!==32&&(u[f]=1024);return{floatView:e,uint32View:t,baseTable:n,shiftTable:r,mantissaTable:s,exponentTable:o,offsetTable:u}}function Qa(i){Math.abs(i)>65504&&Ht("DataUtils.toHalfFloat(): Value out of range."),i=An(i,-65504,65504),Pu.floatView[0]=i;const e=Pu.uint32View[0],t=e>>23&511;return Pu.baseTable[t]+((e&8388607)>>Pu.shiftTable[t])}function gv(i){const e=i>>10;return Pu.uint32View[0]=Pu.mantissaTable[Pu.offsetTable[e]+(i&1023)]+Pu.exponentTable[e],Pu.floatView[0]}class Od{static toHalfFloat(e){return Qa(e)}static fromHalfFloat(e){return gv(e)}}const Zr=new ie,dx=new $e;let tG=0;class gi{constructor(e,t,n=!1){if(Array.isArray(e))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.isBufferAttribute=!0,Object.defineProperty(this,"id",{value:tG++}),this.name="",this.array=e,this.itemSize=t,this.count=e!==void 0?e.length/t:0,this.normalized=n,this.usage=Yv,this.updateRanges=[],this.gpuType=ir,this.version=0}onUploadCallback(){}set needsUpdate(e){e===!0&&this.version++}setUsage(e){return this.usage=e,this}addUpdateRange(e,t){this.updateRanges.push({start:e,count:t})}clearUpdateRanges(){this.updateRanges.length=0}copy(e){return this.name=e.name,this.array=new e.array.constructor(e.array),this.itemSize=e.itemSize,this.count=e.count,this.normalized=e.normalized,this.usage=e.usage,this.gpuType=e.gpuType,this}copyAt(e,t,n){e*=this.itemSize,n*=t.itemSize;for(let r=0,s=this.itemSize;r<s;r++)this.array[e+r]=t.array[n+r];return this}copyArray(e){return this.array.set(e),this}applyMatrix3(e){if(this.itemSize===2)for(let t=0,n=this.count;t<n;t++)dx.fromBufferAttribute(this,t),dx.applyMatrix3(e),this.setXY(t,dx.x,dx.y);else if(this.itemSize===3)for(let t=0,n=this.count;t<n;t++)Zr.fromBufferAttribute(this,t),Zr.applyMatrix3(e),this.setXYZ(t,Zr.x,Zr.y,Zr.z);return this}applyMatrix4(e){for(let t=0,n=this.count;t<n;t++)Zr.fromBufferAttribute(this,t),Zr.applyMatrix4(e),this.setXYZ(t,Zr.x,Zr.y,Zr.z);return this}applyNormalMatrix(e){for(let t=0,n=this.count;t<n;t++)Zr.fromBufferAttribute(this,t),Zr.applyNormalMatrix(e),this.setXYZ(t,Zr.x,Zr.y,Zr.z);return this}transformDirection(e){for(let t=0,n=this.count;t<n;t++)Zr.fromBufferAttribute(this,t),Zr.transformDirection(e),this.setXYZ(t,Zr.x,Zr.y,Zr.z);return this}set(e,t=0){return this.array.set(e,t),this}getComponent(e,t){let n=this.array[e*this.itemSize+t];return this.normalized&&(n=wa(n,this.array)),n}setComponent(e,t,n){return this.normalized&&(n=Vn(n,this.array)),this.array[e*this.itemSize+t]=n,this}getX(e){let t=this.array[e*this.itemSize];return this.normalized&&(t=wa(t,this.array)),t}setX(e,t){return this.normalized&&(t=Vn(t,this.array)),this.array[e*this.itemSize]=t,this}getY(e){let t=this.array[e*this.itemSize+1];return this.normalized&&(t=wa(t,this.array)),t}setY(e,t){return this.normalized&&(t=Vn(t,this.array)),this.array[e*this.itemSize+1]=t,this}getZ(e){let t=this.array[e*this.itemSize+2];return this.normalized&&(t=wa(t,this.array)),t}setZ(e,t){return this.normalized&&(t=Vn(t,this.array)),this.array[e*this.itemSize+2]=t,this}getW(e){let t=this.array[e*this.itemSize+3];return this.normalized&&(t=wa(t,this.array)),t}setW(e,t){return this.normalized&&(t=Vn(t,this.array)),this.array[e*this.itemSize+3]=t,this}setXY(e,t,n){return e*=this.itemSize,this.normalized&&(t=Vn(t,this.array),n=Vn(n,this.array)),this.array[e+0]=t,this.array[e+1]=n,this}setXYZ(e,t,n,r){return e*=this.itemSize,this.normalized&&(t=Vn(t,this.array),n=Vn(n,this.array),r=Vn(r,this.array)),this.array[e+0]=t,this.array[e+1]=n,this.array[e+2]=r,this}setXYZW(e,t,n,r,s){return e*=this.itemSize,this.normalized&&(t=Vn(t,this.array),n=Vn(n,this.array),r=Vn(r,this.array),s=Vn(s,this.array)),this.array[e+0]=t,this.array[e+1]=n,this.array[e+2]=r,this.array[e+3]=s,this}onUpload(e){return this.onUploadCallback=e,this}clone(){return new this.constructor(this.array,this.itemSize).copy(this)}toJSON(){const e={itemSize:this.itemSize,type:this.array.constructor.name,array:Array.from(this.array),normalized:this.normalized};return this.name!==""&&(e.name=this.name),this.usage!==Yv&&(e.usage=this.usage),e}}class nG extends gi{constructor(e,t,n){super(new Int8Array(e),t,n)}}class iG extends gi{constructor(e,t,n){super(new Uint8Array(e),t,n)}}class rG extends gi{constructor(e,t,n){super(new Uint8ClampedArray(e),t,n)}}class sG extends gi{constructor(e,t,n){super(new Int16Array(e),t,n)}}class uw extends gi{constructor(e,t,n){super(new Uint16Array(e),t,n)}}class aG extends gi{constructor(e,t,n){super(new Int32Array(e),t,n)}}class hw extends gi{constructor(e,t,n){super(new Uint32Array(e),t,n)}}class oG extends gi{constructor(e,t,n){super(new Uint16Array(e),t,n),this.isFloat16BufferAttribute=!0}getX(e){let t=gv(this.array[e*this.itemSize]);return this.normalized&&(t=wa(t,this.array)),t}setX(e,t){return this.normalized&&(t=Vn(t,this.array)),this.array[e*this.itemSize]=Qa(t),this}getY(e){let t=gv(this.array[e*this.itemSize+1]);return this.normalized&&(t=wa(t,this.array)),t}setY(e,t){return this.normalized&&(t=Vn(t,this.array)),this.array[e*this.itemSize+1]=Qa(t),this}getZ(e){let t=gv(this.array[e*this.itemSize+2]);return this.normalized&&(t=wa(t,this.array)),t}setZ(e,t){return this.normalized&&(t=Vn(t,this.array)),this.array[e*this.itemSize+2]=Qa(t),this}getW(e){let t=gv(this.array[e*this.itemSize+3]);return this.normalized&&(t=wa(t,this.array)),t}setW(e,t){return this.normalized&&(t=Vn(t,this.array)),this.array[e*this.itemSize+3]=Qa(t),this}setXY(e,t,n){return e*=this.itemSize,this.normalized&&(t=Vn(t,this.array),n=Vn(n,this.array)),this.array[e+0]=Qa(t),this.array[e+1]=Qa(n),this}setXYZ(e,t,n,r){return e*=this.itemSize,this.normalized&&(t=Vn(t,this.array),n=Vn(n,this.array),r=Vn(r,this.array)),this.array[e+0]=Qa(t),this.array[e+1]=Qa(n),this.array[e+2]=Qa(r),this}setXYZW(e,t,n,r,s){return e*=this.itemSize,this.normalized&&(t=Vn(t,this.array),n=Vn(n,this.array),r=Vn(r,this.array),s=Vn(s,this.array)),this.array[e+0]=Qa(t),this.array[e+1]=Qa(n),this.array[e+2]=Qa(r),this.array[e+3]=Qa(s),this}}class tn extends gi{constructor(e,t,n){super(new Float32Array(e),t,n)}}let lG=0;const tl=new vn,a1=new fi,_m=new ie,go=new xs,$0=new xs,ms=new ie;class wn extends Wc{constructor(){super(),this.isBufferGeometry=!0,Object.defineProperty(this,"id",{value:lG++}),this.uuid=bo(),this.name="",this.type="BufferGeometry",this.index=null,this.indirect=null,this.indirectOffset=0,this.attributes={},this.morphAttributes={},this.morphTargetsRelative=!1,this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.drawRange={start:0,count:1/0},this.userData={}}getIndex(){return this.index}setIndex(e){return Array.isArray(e)?this.index=new(KB(e)?hw:uw)(e,1):this.index=e,this}setIndirect(e,t=0){return this.indirect=e,this.indirectOffset=t,this}getIndirect(){return this.indirect}getAttribute(e){return this.attributes[e]}setAttribute(e,t){return this.attributes[e]=t,this}deleteAttribute(e){return delete this.attributes[e],this}hasAttribute(e){return this.attributes[e]!==void 0}addGroup(e,t,n=0){this.groups.push({start:e,count:t,materialIndex:n})}clearGroups(){this.groups=[]}setDrawRange(e,t){this.drawRange.start=e,this.drawRange.count=t}applyMatrix4(e){const t=this.attributes.position;t!==void 0&&(t.applyMatrix4(e),t.needsUpdate=!0);const n=this.attributes.normal;if(n!==void 0){const s=new Un().getNormalMatrix(e);n.applyNormalMatrix(s),n.needsUpdate=!0}const r=this.attributes.tangent;return r!==void 0&&(r.transformDirection(e),r.needsUpdate=!0),this.boundingBox!==null&&this.computeBoundingBox(),this.boundingSphere!==null&&this.computeBoundingSphere(),this}applyQuaternion(e){return tl.makeRotationFromQuaternion(e),this.applyMatrix4(tl),this}rotateX(e){return tl.makeRotationX(e),this.applyMatrix4(tl),this}rotateY(e){return tl.makeRotationY(e),this.applyMatrix4(tl),this}rotateZ(e){return tl.makeRotationZ(e),this.applyMatrix4(tl),this}translate(e,t,n){return tl.makeTranslation(e,t,n),this.applyMatrix4(tl),this}scale(e,t,n){return tl.makeScale(e,t,n),this.applyMatrix4(tl),this}lookAt(e){return a1.lookAt(e),a1.updateMatrix(),this.applyMatrix4(a1.matrix),this}center(){return this.computeBoundingBox(),this.boundingBox.getCenter(_m).negate(),this.translate(_m.x,_m.y,_m.z),this}setFromPoints(e){const t=this.getAttribute("position");if(t===void 0){const n=[];for(let r=0,s=e.length;r<s;r++){const o=e[r];n.push(o.x,o.y,o.z||0)}this.setAttribute("position",new tn(n,3))}else{const n=Math.min(e.length,t.count);for(let r=0;r<n;r++){const s=e[r];t.setXYZ(r,s.x,s.y,s.z||0)}e.length>t.count&&Ht("BufferGeometry: Buffer size too small for points data. Use .dispose() and create a new geometry."),t.needsUpdate=!0}return this}computeBoundingBox(){this.boundingBox===null&&(this.boundingBox=new xs);const e=this.attributes.position,t=this.morphAttributes.position;if(e&&e.isGLBufferAttribute){cn("BufferGeometry.computeBoundingBox(): GLBufferAttribute requires a manual bounding box.",this),this.boundingBox.set(new ie(-1/0,-1/0,-1/0),new ie(1/0,1/0,1/0));return}if(e!==void 0){if(this.boundingBox.setFromBufferAttribute(e),t)for(let n=0,r=t.length;n<r;n++){const s=t[n];go.setFromBufferAttribute(s),this.morphTargetsRelative?(ms.addVectors(this.boundingBox.min,go.min),this.boundingBox.expandByPoint(ms),ms.addVectors(this.boundingBox.max,go.max),this.boundingBox.expandByPoint(ms)):(this.boundingBox.expandByPoint(go.min),this.boundingBox.expandByPoint(go.max))}}else this.boundingBox.makeEmpty();(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&cn('BufferGeometry.computeBoundingBox(): Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)}computeBoundingSphere(){this.boundingSphere===null&&(this.boundingSphere=new bs);const e=this.attributes.position,t=this.morphAttributes.position;if(e&&e.isGLBufferAttribute){cn("BufferGeometry.computeBoundingSphere(): GLBufferAttribute requires a manual bounding sphere.",this),this.boundingSphere.set(new ie,1/0);return}if(e){const n=this.boundingSphere.center;if(go.setFromBufferAttribute(e),t)for(let s=0,o=t.length;s<o;s++){const u=t[s];$0.setFromBufferAttribute(u),this.morphTargetsRelative?(ms.addVectors(go.min,$0.min),go.expandByPoint(ms),ms.addVectors(go.max,$0.max),go.expandByPoint(ms)):(go.expandByPoint($0.min),go.expandByPoint($0.max))}go.getCenter(n);let r=0;for(let s=0,o=e.count;s<o;s++)ms.fromBufferAttribute(e,s),r=Math.max(r,n.distanceToSquared(ms));if(t)for(let s=0,o=t.length;s<o;s++){const u=t[s],f=this.morphTargetsRelative;for(let p=0,g=u.count;p<g;p++)ms.fromBufferAttribute(u,p),f&&(_m.fromBufferAttribute(e,p),ms.add(_m)),r=Math.max(r,n.distanceToSquared(ms))}this.boundingSphere.radius=Math.sqrt(r),isNaN(this.boundingSphere.radius)&&cn('BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}}computeTangents(){const e=this.index,t=this.attributes;if(e===null||t.position===void 0||t.normal===void 0||t.uv===void 0){cn("BufferGeometry: .computeTangents() failed. Missing required attributes (index, position, normal or uv)");return}const n=t.position,r=t.normal,s=t.uv;this.hasAttribute("tangent")===!1&&this.setAttribute("tangent",new gi(new Float32Array(4*n.count),4));const o=this.getAttribute("tangent"),u=[],f=[];for(let D=0;D<n.count;D++)u[D]=new ie,f[D]=new ie;const p=new ie,g=new ie,v=new ie,_=new $e,x=new $e,E=new $e,C=new ie,w=new ie;function T(D,R,P){p.fromBufferAttribute(n,D),g.fromBufferAttribute(n,R),v.fromBufferAttribute(n,P),_.fromBufferAttribute(s,D),x.fromBufferAttribute(s,R),E.fromBufferAttribute(s,P),g.sub(p),v.sub(p),x.sub(_),E.sub(_);const z=1/(x.x*E.y-E.x*x.y);isFinite(z)&&(C.copy(g).multiplyScalar(E.y).addScaledVector(v,-x.y).multiplyScalar(z),w.copy(v).multiplyScalar(x.x).addScaledVector(g,-E.x).multiplyScalar(z),u[D].add(C),u[R].add(C),u[P].add(C),f[D].add(w),f[R].add(w),f[P].add(w))}let N=this.groups;N.length===0&&(N=[{start:0,count:e.count}]);for(let D=0,R=N.length;D<R;++D){const P=N[D],z=P.start,Y=P.count;for(let j=z,ce=z+Y;j<ce;j+=3)T(e.getX(j+0),e.getX(j+1),e.getX(j+2))}const L=new ie,F=new ie,G=new ie,k=new ie;function O(D){G.fromBufferAttribute(r,D),k.copy(G);const R=u[D];L.copy(R),L.sub(G.multiplyScalar(G.dot(R))).normalize(),F.crossVectors(k,R);const z=F.dot(f[D])<0?-1:1;o.setXYZW(D,L.x,L.y,L.z,z)}for(let D=0,R=N.length;D<R;++D){const P=N[D],z=P.start,Y=P.count;for(let j=z,ce=z+Y;j<ce;j+=3)O(e.getX(j+0)),O(e.getX(j+1)),O(e.getX(j+2))}}computeVertexNormals(){const e=this.index,t=this.getAttribute("position");if(t!==void 0){let n=this.getAttribute("normal");if(n===void 0)n=new gi(new Float32Array(t.count*3),3),this.setAttribute("normal",n);else for(let _=0,x=n.count;_<x;_++)n.setXYZ(_,0,0,0);const r=new ie,s=new ie,o=new ie,u=new ie,f=new ie,p=new ie,g=new ie,v=new ie;if(e)for(let _=0,x=e.count;_<x;_+=3){const E=e.getX(_+0),C=e.getX(_+1),w=e.getX(_+2);r.fromBufferAttribute(t,E),s.fromBufferAttribute(t,C),o.fromBufferAttribute(t,w),g.subVectors(o,s),v.subVectors(r,s),g.cross(v),u.fromBufferAttribute(n,E),f.fromBufferAttribute(n,C),p.fromBufferAttribute(n,w),u.add(g),f.add(g),p.add(g),n.setXYZ(E,u.x,u.y,u.z),n.setXYZ(C,f.x,f.y,f.z),n.setXYZ(w,p.x,p.y,p.z)}else for(let _=0,x=t.count;_<x;_+=3)r.fromBufferAttribute(t,_+0),s.fromBufferAttribute(t,_+1),o.fromBufferAttribute(t,_+2),g.subVectors(o,s),v.subVectors(r,s),g.cross(v),n.setXYZ(_+0,g.x,g.y,g.z),n.setXYZ(_+1,g.x,g.y,g.z),n.setXYZ(_+2,g.x,g.y,g.z);this.normalizeNormals(),n.needsUpdate=!0}}normalizeNormals(){const e=this.attributes.normal;for(let t=0,n=e.count;t<n;t++)ms.fromBufferAttribute(e,t),ms.normalize(),e.setXYZ(t,ms.x,ms.y,ms.z)}toNonIndexed(){function e(u,f){const p=u.array,g=u.itemSize,v=u.normalized,_=new p.constructor(f.length*g);let x=0,E=0;for(let C=0,w=f.length;C<w;C++){u.isInterleavedBufferAttribute?x=f[C]*u.data.stride+u.offset:x=f[C]*g;for(let T=0;T<g;T++)_[E++]=p[x++]}return new gi(_,g,v)}if(this.index===null)return Ht("BufferGeometry.toNonIndexed(): BufferGeometry is already non-indexed."),this;const t=new wn,n=this.index.array,r=this.attributes;for(const u in r){const f=r[u],p=e(f,n);t.setAttribute(u,p)}const s=this.morphAttributes;for(const u in s){const f=[],p=s[u];for(let g=0,v=p.length;g<v;g++){const _=p[g],x=e(_,n);f.push(x)}t.morphAttributes[u]=f}t.morphTargetsRelative=this.morphTargetsRelative;const o=this.groups;for(let u=0,f=o.length;u<f;u++){const p=o[u];t.addGroup(p.start,p.count,p.materialIndex)}return t}toJSON(){const e={metadata:{version:4.7,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(e.uuid=this.uuid,e.type=this.type,this.name!==""&&(e.name=this.name),Object.keys(this.userData).length>0&&(e.userData=this.userData),this.parameters!==void 0){const f=this.parameters;for(const p in f)f[p]!==void 0&&(e[p]=f[p]);return e}e.data={attributes:{}};const t=this.index;t!==null&&(e.data.index={type:t.array.constructor.name,array:Array.prototype.slice.call(t.array)});const n=this.attributes;for(const f in n){const p=n[f];e.data.attributes[f]=p.toJSON(e.data)}const r={};let s=!1;for(const f in this.morphAttributes){const p=this.morphAttributes[f],g=[];for(let v=0,_=p.length;v<_;v++){const x=p[v];g.push(x.toJSON(e.data))}g.length>0&&(r[f]=g,s=!0)}s&&(e.data.morphAttributes=r,e.data.morphTargetsRelative=this.morphTargetsRelative);const o=this.groups;o.length>0&&(e.data.groups=JSON.parse(JSON.stringify(o)));const u=this.boundingSphere;return u!==null&&(e.data.boundingSphere=u.toJSON()),e}clone(){return new this.constructor().copy(this)}copy(e){this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null;const t={};this.name=e.name;const n=e.index;n!==null&&this.setIndex(n.clone());const r=e.attributes;for(const p in r){const g=r[p];this.setAttribute(p,g.clone(t))}const s=e.morphAttributes;for(const p in s){const g=[],v=s[p];for(let _=0,x=v.length;_<x;_++)g.push(v[_].clone(t));this.morphAttributes[p]=g}this.morphTargetsRelative=e.morphTargetsRelative;const o=e.groups;for(let p=0,g=o.length;p<g;p++){const v=o[p];this.addGroup(v.start,v.count,v.materialIndex)}const u=e.boundingBox;u!==null&&(this.boundingBox=u.clone());const f=e.boundingSphere;return f!==null&&(this.boundingSphere=f.clone()),this.drawRange.start=e.drawRange.start,this.drawRange.count=e.drawRange.count,this.userData=e.userData,this}dispose(){this.dispatchEvent({type:"dispose"})}}const VI=new vn,fd=new hp,px=new bs,HI=new ie,mx=new ie,gx=new ie,vx=new ie,o1=new ie,yx=new ie,GI=new ie,_x=new ie;class rr extends fi{constructor(e=new wn,t=new to){super(),this.isMesh=!0,this.type="Mesh",this.geometry=e,this.material=t,this.morphTargetDictionary=void 0,this.morphTargetInfluences=void 0,this.count=1,this.updateMorphTargets()}copy(e,t){return super.copy(e,t),e.morphTargetInfluences!==void 0&&(this.morphTargetInfluences=e.morphTargetInfluences.slice()),e.morphTargetDictionary!==void 0&&(this.morphTargetDictionary=Object.assign({},e.morphTargetDictionary)),this.material=Array.isArray(e.material)?e.material.slice():e.material,this.geometry=e.geometry,this}updateMorphTargets(){const t=this.geometry.morphAttributes,n=Object.keys(t);if(n.length>0){const r=t[n[0]];if(r!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let s=0,o=r.length;s<o;s++){const u=r[s].name||String(s);this.morphTargetInfluences.push(0),this.morphTargetDictionary[u]=s}}}}getVertexPosition(e,t){const n=this.geometry,r=n.attributes.position,s=n.morphAttributes.position,o=n.morphTargetsRelative;t.fromBufferAttribute(r,e);const u=this.morphTargetInfluences;if(s&&u){yx.set(0,0,0);for(let f=0,p=s.length;f<p;f++){const g=u[f],v=s[f];g!==0&&(o1.fromBufferAttribute(v,e),o?yx.addScaledVector(o1,g):yx.addScaledVector(o1.sub(t),g))}t.add(yx)}return t}raycast(e,t){const n=this.geometry,r=this.material,s=this.matrixWorld;r!==void 0&&(n.boundingSphere===null&&n.computeBoundingSphere(),px.copy(n.boundingSphere),px.applyMatrix4(s),fd.copy(e.ray).recast(e.near),!(px.containsPoint(fd.origin)===!1&&(fd.intersectSphere(px,HI)===null||fd.origin.distanceToSquared(HI)>(e.far-e.near)**2))&&(VI.copy(s).invert(),fd.copy(e.ray).applyMatrix4(VI),!(n.boundingBox!==null&&fd.intersectsBox(n.boundingBox)===!1)&&this._computeIntersections(e,t,fd)))}_computeIntersections(e,t,n){let r;const s=this.geometry,o=this.material,u=s.index,f=s.attributes.position,p=s.attributes.uv,g=s.attributes.uv1,v=s.attributes.normal,_=s.groups,x=s.drawRange;if(u!==null)if(Array.isArray(o))for(let E=0,C=_.length;E<C;E++){const w=_[E],T=o[w.materialIndex],N=Math.max(w.start,x.start),L=Math.min(u.count,Math.min(w.start+w.count,x.start+x.count));for(let F=N,G=L;F<G;F+=3){const k=u.getX(F),O=u.getX(F+1),D=u.getX(F+2);r=xx(this,T,e,n,p,g,v,k,O,D),r&&(r.faceIndex=Math.floor(F/3),r.face.materialIndex=w.materialIndex,t.push(r))}}else{const E=Math.max(0,x.start),C=Math.min(u.count,x.start+x.count);for(let w=E,T=C;w<T;w+=3){const N=u.getX(w),L=u.getX(w+1),F=u.getX(w+2);r=xx(this,o,e,n,p,g,v,N,L,F),r&&(r.faceIndex=Math.floor(w/3),t.push(r))}}else if(f!==void 0)if(Array.isArray(o))for(let E=0,C=_.length;E<C;E++){const w=_[E],T=o[w.materialIndex],N=Math.max(w.start,x.start),L=Math.min(f.count,Math.min(w.start+w.count,x.start+x.count));for(let F=N,G=L;F<G;F+=3){const k=F,O=F+1,D=F+2;r=xx(this,T,e,n,p,g,v,k,O,D),r&&(r.faceIndex=Math.floor(F/3),r.face.materialIndex=w.materialIndex,t.push(r))}}else{const E=Math.max(0,x.start),C=Math.min(f.count,x.start+x.count);for(let w=E,T=C;w<T;w+=3){const N=w,L=w+1,F=w+2;r=xx(this,o,e,n,p,g,v,N,L,F),r&&(r.faceIndex=Math.floor(w/3),t.push(r))}}}}function cG(i,e,t,n,r,s,o,u){let f;if(e.side===Ca?f=n.intersectTriangle(o,s,r,!0,u):f=n.intersectTriangle(r,s,o,e.side===Gc,u),f===null)return null;_x.copy(u),_x.applyMatrix4(i.matrixWorld);const p=t.ray.origin.distanceTo(_x);return p<t.near||p>t.far?null:{distance:p,point:_x.clone(),object:i}}function xx(i,e,t,n,r,s,o,u,f,p){i.getVertexPosition(u,mx),i.getVertexPosition(f,gx),i.getVertexPosition(p,vx);const g=cG(i,e,t,n,mx,gx,vx,GI);if(g){const v=new ie;eo.getBarycoord(GI,mx,gx,vx,v),r&&(g.uv=eo.getInterpolatedAttribute(r,u,f,p,v,new $e)),s&&(g.uv1=eo.getInterpolatedAttribute(s,u,f,p,v,new $e)),o&&(g.normal=eo.getInterpolatedAttribute(o,u,f,p,v,new ie),g.normal.dot(n.direction)>0&&g.normal.multiplyScalar(-1));const _={a:u,b:f,c:p,normal:new ie,materialIndex:0};eo.getNormal(mx,gx,vx,_.normal),g.face=_,g.barycoord=v}return g}class fp extends wn{constructor(e=1,t=1,n=1,r=1,s=1,o=1){super(),this.type="BoxGeometry",this.parameters={width:e,height:t,depth:n,widthSegments:r,heightSegments:s,depthSegments:o};const u=this;r=Math.floor(r),s=Math.floor(s),o=Math.floor(o);const f=[],p=[],g=[],v=[];let _=0,x=0;E("z","y","x",-1,-1,n,t,e,o,s,0),E("z","y","x",1,-1,n,t,-e,o,s,1),E("x","z","y",1,1,e,n,t,r,o,2),E("x","z","y",1,-1,e,n,-t,r,o,3),E("x","y","z",1,-1,e,t,n,r,s,4),E("x","y","z",-1,-1,e,t,-n,r,s,5),this.setIndex(f),this.setAttribute("position",new tn(p,3)),this.setAttribute("normal",new tn(g,3)),this.setAttribute("uv",new tn(v,2));function E(C,w,T,N,L,F,G,k,O,D,R){const P=F/O,z=G/D,Y=F/2,j=G/2,ce=k/2,fe=O+1,te=D+1;let se=0,Ae=0;const Pe=new ie;for(let Re=0;Re<te;Re++){const $=Re*z-j;for(let ae=0;ae<fe;ae++){const Se=ae*P-Y;Pe[C]=Se*N,Pe[w]=$*L,Pe[T]=ce,p.push(Pe.x,Pe.y,Pe.z),Pe[C]=0,Pe[w]=0,Pe[T]=k>0?1:-1,g.push(Pe.x,Pe.y,Pe.z),v.push(ae/O),v.push(1-Re/D),se+=1}}for(let Re=0;Re<D;Re++)for(let $=0;$<O;$++){const ae=_+$+fe*Re,Se=_+$+fe*(Re+1),ke=_+($+1)+fe*(Re+1),dt=_+($+1)+fe*Re;f.push(ae,Se,dt),f.push(Se,ke,dt),Ae+=6}u.addGroup(x,Ae,R),x+=Ae,_+=se}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new fp(e.width,e.height,e.depth,e.widthSegments,e.heightSegments,e.depthSegments)}}function pg(i){const e={};for(const t in i){e[t]={};for(const n in i[t]){const r=i[t][n];r&&(r.isColor||r.isMatrix3||r.isMatrix4||r.isVector2||r.isVector3||r.isVector4||r.isTexture||r.isQuaternion)?r.isRenderTargetTexture?(Ht("UniformsUtils: Textures of render targets cannot be cloned via cloneUniforms() or mergeUniforms()."),e[t][n]=null):e[t][n]=r.clone():Array.isArray(r)?e[t][n]=r.slice():e[t][n]=r}}return e}function Ta(i){const e={};for(let t=0;t<i.length;t++){const n=pg(i[t]);for(const r in n)e[r]=n[r]}return e}function uG(i){const e=[];for(let t=0;t<i.length;t++)e.push(i[t].clone());return e}function nL(i){const e=i.getRenderTarget();return e===null?i.outputColorSpace:e.isXRRenderTarget===!0?e.texture.colorSpace:oi.workingColorSpace}const iL={clone:pg,merge:Ta};var hG=`void main() {
	gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
}`,fG=`void main() {
	gl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );
}`;class Gs extends os{constructor(e){super(),this.isShaderMaterial=!0,this.type="ShaderMaterial",this.defines={},this.uniforms={},this.uniformsGroups=[],this.vertexShader=hG,this.fragmentShader=fG,this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.clipping=!1,this.forceSinglePass=!0,this.extensions={clipCullDistance:!1,multiDraw:!1},this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv1:[0,0]},this.index0AttributeName=void 0,this.uniformsNeedUpdate=!1,this.glslVersion=null,e!==void 0&&this.setValues(e)}copy(e){return super.copy(e),this.fragmentShader=e.fragmentShader,this.vertexShader=e.vertexShader,this.uniforms=pg(e.uniforms),this.uniformsGroups=uG(e.uniformsGroups),this.defines=Object.assign({},e.defines),this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.fog=e.fog,this.lights=e.lights,this.clipping=e.clipping,this.extensions=Object.assign({},e.extensions),this.glslVersion=e.glslVersion,this.defaultAttributeValues=Object.assign({},e.defaultAttributeValues),this.index0AttributeName=e.index0AttributeName,this.uniformsNeedUpdate=e.uniformsNeedUpdate,this}toJSON(e){const t=super.toJSON(e);t.glslVersion=this.glslVersion,t.uniforms={};for(const r in this.uniforms){const o=this.uniforms[r].value;o&&o.isTexture?t.uniforms[r]={type:"t",value:o.toJSON(e).uuid}:o&&o.isColor?t.uniforms[r]={type:"c",value:o.getHex()}:o&&o.isVector2?t.uniforms[r]={type:"v2",value:o.toArray()}:o&&o.isVector3?t.uniforms[r]={type:"v3",value:o.toArray()}:o&&o.isVector4?t.uniforms[r]={type:"v4",value:o.toArray()}:o&&o.isMatrix3?t.uniforms[r]={type:"m3",value:o.toArray()}:o&&o.isMatrix4?t.uniforms[r]={type:"m4",value:o.toArray()}:t.uniforms[r]={value:o}}Object.keys(this.defines).length>0&&(t.defines=this.defines),t.vertexShader=this.vertexShader,t.fragmentShader=this.fragmentShader,t.lights=this.lights,t.clipping=this.clipping;const n={};for(const r in this.extensions)this.extensions[r]===!0&&(n[r]=!0);return Object.keys(n).length>0&&(t.extensions=n),t}}class yS extends fi{constructor(){super(),this.isCamera=!0,this.type="Camera",this.matrixWorldInverse=new vn,this.projectionMatrix=new vn,this.projectionMatrixInverse=new vn,this.coordinateSystem=xo,this._reversedDepth=!1}get reversedDepth(){return this._reversedDepth}copy(e,t){return super.copy(e,t),this.matrixWorldInverse.copy(e.matrixWorldInverse),this.projectionMatrix.copy(e.projectionMatrix),this.projectionMatrixInverse.copy(e.projectionMatrixInverse),this.coordinateSystem=e.coordinateSystem,this}getWorldDirection(e){return super.getWorldDirection(e).negate()}updateMatrixWorld(e){super.updateMatrixWorld(e),this.matrixWorldInverse.copy(this.matrixWorld).invert()}updateWorldMatrix(e,t){super.updateWorldMatrix(e,t),this.matrixWorldInverse.copy(this.matrixWorld).invert()}clone(){return new this.constructor().copy(this)}}const jh=new ie,jI=new $e,WI=new $e;let hr=class extends yS{constructor(e=50,t=1,n=.1,r=2e3){super(),this.isPerspectiveCamera=!0,this.type="PerspectiveCamera",this.fov=e,this.zoom=1,this.near=n,this.far=r,this.focus=10,this.aspect=t,this.view=null,this.filmGauge=35,this.filmOffset=0,this.updateProjectionMatrix()}copy(e,t){return super.copy(e,t),this.fov=e.fov,this.zoom=e.zoom,this.near=e.near,this.far=e.far,this.focus=e.focus,this.aspect=e.aspect,this.view=e.view===null?null:Object.assign({},e.view),this.filmGauge=e.filmGauge,this.filmOffset=e.filmOffset,this}setFocalLength(e){const t=.5*this.getFilmHeight()/e;this.fov=fg*2*Math.atan(t),this.updateProjectionMatrix()}getFocalLength(){const e=Math.tan(Gd*.5*this.fov);return .5*this.getFilmHeight()/e}getEffectiveFOV(){return fg*2*Math.atan(Math.tan(Gd*.5*this.fov)/this.zoom)}getFilmWidth(){return this.filmGauge*Math.min(this.aspect,1)}getFilmHeight(){return this.filmGauge/Math.max(this.aspect,1)}getViewBounds(e,t,n){jh.set(-1,-1,.5).applyMatrix4(this.projectionMatrixInverse),t.set(jh.x,jh.y).multiplyScalar(-e/jh.z),jh.set(1,1,.5).applyMatrix4(this.projectionMatrixInverse),n.set(jh.x,jh.y).multiplyScalar(-e/jh.z)}getViewSize(e,t){return this.getViewBounds(e,jI,WI),t.subVectors(WI,jI)}setViewOffset(e,t,n,r,s,o){this.aspect=e/t,this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=n,this.view.offsetY=r,this.view.width=s,this.view.height=o,this.updateProjectionMatrix()}clearViewOffset(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const e=this.near;let t=e*Math.tan(Gd*.5*this.fov)/this.zoom,n=2*t,r=this.aspect*n,s=-.5*r;const o=this.view;if(this.view!==null&&this.view.enabled){const f=o.fullWidth,p=o.fullHeight;s+=o.offsetX*r/f,t-=o.offsetY*n/p,r*=o.width/f,n*=o.height/p}const u=this.filmOffset;u!==0&&(s+=e*u/this.getFilmWidth()),this.projectionMatrix.makePerspective(s,s+r,t,t-n,e,this.far,this.coordinateSystem,this.reversedDepth),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){const t=super.toJSON(e);return t.object.fov=this.fov,t.object.zoom=this.zoom,t.object.near=this.near,t.object.far=this.far,t.object.focus=this.focus,t.object.aspect=this.aspect,this.view!==null&&(t.object.view=Object.assign({},this.view)),t.object.filmGauge=this.filmGauge,t.object.filmOffset=this.filmOffset,t}};const xm=-90,bm=1;class rL extends fi{constructor(e,t,n){super(),this.type="CubeCamera",this.renderTarget=n,this.coordinateSystem=null,this.activeMipmapLevel=0;const r=new hr(xm,bm,e,t);r.layers=this.layers,this.add(r);const s=new hr(xm,bm,e,t);s.layers=this.layers,this.add(s);const o=new hr(xm,bm,e,t);o.layers=this.layers,this.add(o);const u=new hr(xm,bm,e,t);u.layers=this.layers,this.add(u);const f=new hr(xm,bm,e,t);f.layers=this.layers,this.add(f);const p=new hr(xm,bm,e,t);p.layers=this.layers,this.add(p)}updateCoordinateSystem(){const e=this.coordinateSystem,t=this.children.concat(),[n,r,s,o,u,f]=t;for(const p of t)this.remove(p);if(e===xo)n.up.set(0,1,0),n.lookAt(1,0,0),r.up.set(0,1,0),r.lookAt(-1,0,0),s.up.set(0,0,-1),s.lookAt(0,1,0),o.up.set(0,0,1),o.lookAt(0,-1,0),u.up.set(0,1,0),u.lookAt(0,0,1),f.up.set(0,1,0),f.lookAt(0,0,-1);else if(e===ug)n.up.set(0,-1,0),n.lookAt(-1,0,0),r.up.set(0,-1,0),r.lookAt(1,0,0),s.up.set(0,0,1),s.lookAt(0,1,0),o.up.set(0,0,-1),o.lookAt(0,-1,0),u.up.set(0,-1,0),u.lookAt(0,0,1),f.up.set(0,-1,0),f.lookAt(0,0,-1);else throw new Error("THREE.CubeCamera.updateCoordinateSystem(): Invalid coordinate system: "+e);for(const p of t)this.add(p),p.updateMatrixWorld()}update(e,t){this.parent===null&&this.updateMatrixWorld();const{renderTarget:n,activeMipmapLevel:r}=this;this.coordinateSystem!==e.coordinateSystem&&(this.coordinateSystem=e.coordinateSystem,this.updateCoordinateSystem());const[s,o,u,f,p,g]=this.children,v=e.getRenderTarget(),_=e.getActiveCubeFace(),x=e.getActiveMipmapLevel(),E=e.xr.enabled;e.xr.enabled=!1;const C=n.texture.generateMipmaps;n.texture.generateMipmaps=!1,e.setRenderTarget(n,0,r),e.render(t,s),e.setRenderTarget(n,1,r),e.render(t,o),e.setRenderTarget(n,2,r),e.render(t,u),e.setRenderTarget(n,3,r),e.render(t,f),e.setRenderTarget(n,4,r),e.render(t,p),n.texture.generateMipmaps=C,e.setRenderTarget(n,5,r),e.render(t,g),e.setRenderTarget(v,_,x),e.xr.enabled=E,n.texture.needsPMREMUpdate=!0}}class by extends Ci{constructor(e=[],t=ql,n,r,s,o,u,f,p,g){super(e,t,n,r,s,o,u,f,p,g),this.isCubeTexture=!0,this.flipY=!1}get images(){return this.image}set images(e){this.image=e}}class _S extends _s{constructor(e=1,t={}){super(e,e,t),this.isWebGLCubeRenderTarget=!0;const n={width:e,height:e,depth:1},r=[n,n,n,n,n,n];this.texture=new by(r),this._setTextureOptions(t),this.texture.isRenderTargetTexture=!0}fromEquirectangularTexture(e,t){this.texture.type=t.type,this.texture.colorSpace=t.colorSpace,this.texture.generateMipmaps=t.generateMipmaps,this.texture.minFilter=t.minFilter,this.texture.magFilter=t.magFilter;const n={uniforms:{tEquirect:{value:null}},vertexShader:`

				varying vec3 vWorldDirection;

				vec3 transformDirection( in vec3 dir, in mat4 matrix ) {

					return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );

				}

				void main() {

					vWorldDirection = transformDirection( position, modelMatrix );

					#include <begin_vertex>
					#include <project_vertex>

				}
			`,fragmentShader:`

				uniform sampler2D tEquirect;

				varying vec3 vWorldDirection;

				#include <common>

				void main() {

					vec3 direction = normalize( vWorldDirection );

					vec2 sampleUV = equirectUv( direction );

					gl_FragColor = texture2D( tEquirect, sampleUV );

				}
			`},r=new fp(5,5,5),s=new Gs({name:"CubemapFromEquirect",uniforms:pg(n.uniforms),vertexShader:n.vertexShader,fragmentShader:n.fragmentShader,side:Ca,blending:Gl});s.uniforms.tEquirect.value=t;const o=new rr(r,s),u=t.minFilter;return t.minFilter===sl&&(t.minFilter=Jn),new rL(1,10,this).update(e,o),t.minFilter=u,o.geometry.dispose(),o.material.dispose(),this}clear(e,t=!0,n=!0,r=!0){const s=e.getRenderTarget();for(let o=0;o<6;o++)e.setRenderTarget(this,o),e.clear(t,n,r);e.setRenderTarget(s)}}class Ou extends fi{constructor(){super(),this.isGroup=!0,this.type="Group"}}const dG={type:"move"};class mb{constructor(){this._targetRay=null,this._grip=null,this._hand=null}getHandSpace(){return this._hand===null&&(this._hand=new Ou,this._hand.matrixAutoUpdate=!1,this._hand.visible=!1,this._hand.joints={},this._hand.inputState={pinching:!1}),this._hand}getTargetRaySpace(){return this._targetRay===null&&(this._targetRay=new Ou,this._targetRay.matrixAutoUpdate=!1,this._targetRay.visible=!1,this._targetRay.hasLinearVelocity=!1,this._targetRay.linearVelocity=new ie,this._targetRay.hasAngularVelocity=!1,this._targetRay.angularVelocity=new ie),this._targetRay}getGripSpace(){return this._grip===null&&(this._grip=new Ou,this._grip.matrixAutoUpdate=!1,this._grip.visible=!1,this._grip.hasLinearVelocity=!1,this._grip.linearVelocity=new ie,this._grip.hasAngularVelocity=!1,this._grip.angularVelocity=new ie),this._grip}dispatchEvent(e){return this._targetRay!==null&&this._targetRay.dispatchEvent(e),this._grip!==null&&this._grip.dispatchEvent(e),this._hand!==null&&this._hand.dispatchEvent(e),this}connect(e){if(e&&e.hand){const t=this._hand;if(t)for(const n of e.hand.values())this._getHandJoint(t,n)}return this.dispatchEvent({type:"connected",data:e}),this}disconnect(e){return this.dispatchEvent({type:"disconnected",data:e}),this._targetRay!==null&&(this._targetRay.visible=!1),this._grip!==null&&(this._grip.visible=!1),this._hand!==null&&(this._hand.visible=!1),this}update(e,t,n){let r=null,s=null,o=null;const u=this._targetRay,f=this._grip,p=this._hand;if(e&&t.session.visibilityState!=="visible-blurred"){if(p&&e.hand){o=!0;for(const C of e.hand.values()){const w=t.getJointPose(C,n),T=this._getHandJoint(p,C);w!==null&&(T.matrix.fromArray(w.transform.matrix),T.matrix.decompose(T.position,T.rotation,T.scale),T.matrixWorldNeedsUpdate=!0,T.jointRadius=w.radius),T.visible=w!==null}const g=p.joints["index-finger-tip"],v=p.joints["thumb-tip"],_=g.position.distanceTo(v.position),x=.02,E=.005;p.inputState.pinching&&_>x+E?(p.inputState.pinching=!1,this.dispatchEvent({type:"pinchend",handedness:e.handedness,target:this})):!p.inputState.pinching&&_<=x-E&&(p.inputState.pinching=!0,this.dispatchEvent({type:"pinchstart",handedness:e.handedness,target:this}))}else f!==null&&e.gripSpace&&(s=t.getPose(e.gripSpace,n),s!==null&&(f.matrix.fromArray(s.transform.matrix),f.matrix.decompose(f.position,f.rotation,f.scale),f.matrixWorldNeedsUpdate=!0,s.linearVelocity?(f.hasLinearVelocity=!0,f.linearVelocity.copy(s.linearVelocity)):f.hasLinearVelocity=!1,s.angularVelocity?(f.hasAngularVelocity=!0,f.angularVelocity.copy(s.angularVelocity)):f.hasAngularVelocity=!1));u!==null&&(r=t.getPose(e.targetRaySpace,n),r===null&&s!==null&&(r=s),r!==null&&(u.matrix.fromArray(r.transform.matrix),u.matrix.decompose(u.position,u.rotation,u.scale),u.matrixWorldNeedsUpdate=!0,r.linearVelocity?(u.hasLinearVelocity=!0,u.linearVelocity.copy(r.linearVelocity)):u.hasLinearVelocity=!1,r.angularVelocity?(u.hasAngularVelocity=!0,u.angularVelocity.copy(r.angularVelocity)):u.hasAngularVelocity=!1,this.dispatchEvent(dG)))}return u!==null&&(u.visible=r!==null),f!==null&&(f.visible=s!==null),p!==null&&(p.visible=o!==null),this}_getHandJoint(e,t){if(e.joints[t.jointName]===void 0){const n=new Ou;n.matrixAutoUpdate=!1,n.visible=!1,e.joints[t.jointName]=n,e.add(n)}return e.joints[t.jointName]}}class xS{constructor(e,t=25e-5){this.isFogExp2=!0,this.name="",this.color=new Gt(e),this.density=t}clone(){return new xS(this.color,this.density)}toJSON(){return{type:"FogExp2",name:this.name,color:this.color.getHex(),density:this.density}}}class bS{constructor(e,t=1,n=1e3){this.isFog=!0,this.name="",this.color=new Gt(e),this.near=t,this.far=n}clone(){return new bS(this.color,this.near,this.far)}toJSON(){return{type:"Fog",name:this.name,color:this.color.getHex(),near:this.near,far:this.far}}}class Ay extends fi{constructor(){super(),this.isScene=!0,this.type="Scene",this.background=null,this.environment=null,this.fog=null,this.backgroundBlurriness=0,this.backgroundIntensity=1,this.backgroundRotation=new Eo,this.environmentIntensity=1,this.environmentRotation=new Eo,this.overrideMaterial=null,typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}copy(e,t){return super.copy(e,t),e.background!==null&&(this.background=e.background.clone()),e.environment!==null&&(this.environment=e.environment.clone()),e.fog!==null&&(this.fog=e.fog.clone()),this.backgroundBlurriness=e.backgroundBlurriness,this.backgroundIntensity=e.backgroundIntensity,this.backgroundRotation.copy(e.backgroundRotation),this.environmentIntensity=e.environmentIntensity,this.environmentRotation.copy(e.environmentRotation),e.overrideMaterial!==null&&(this.overrideMaterial=e.overrideMaterial.clone()),this.matrixAutoUpdate=e.matrixAutoUpdate,this}toJSON(e){const t=super.toJSON(e);return this.fog!==null&&(t.object.fog=this.fog.toJSON()),this.backgroundBlurriness>0&&(t.object.backgroundBlurriness=this.backgroundBlurriness),this.backgroundIntensity!==1&&(t.object.backgroundIntensity=this.backgroundIntensity),t.object.backgroundRotation=this.backgroundRotation.toArray(),this.environmentIntensity!==1&&(t.object.environmentIntensity=this.environmentIntensity),t.object.environmentRotation=this.environmentRotation.toArray(),t}}class Sy{constructor(e,t){this.isInterleavedBuffer=!0,this.array=e,this.stride=t,this.count=e!==void 0?e.length/t:0,this.usage=Yv,this.updateRanges=[],this.version=0,this.uuid=bo()}onUploadCallback(){}set needsUpdate(e){e===!0&&this.version++}setUsage(e){return this.usage=e,this}addUpdateRange(e,t){this.updateRanges.push({start:e,count:t})}clearUpdateRanges(){this.updateRanges.length=0}copy(e){return this.array=new e.array.constructor(e.array),this.count=e.count,this.stride=e.stride,this.usage=e.usage,this}copyAt(e,t,n){e*=this.stride,n*=t.stride;for(let r=0,s=this.stride;r<s;r++)this.array[e+r]=t.array[n+r];return this}set(e,t=0){return this.array.set(e,t),this}clone(e){e.arrayBuffers===void 0&&(e.arrayBuffers={}),this.array.buffer._uuid===void 0&&(this.array.buffer._uuid=bo()),e.arrayBuffers[this.array.buffer._uuid]===void 0&&(e.arrayBuffers[this.array.buffer._uuid]=this.array.slice(0).buffer);const t=new this.array.constructor(e.arrayBuffers[this.array.buffer._uuid]),n=new this.constructor(t,this.stride);return n.setUsage(this.usage),n}onUpload(e){return this.onUploadCallback=e,this}toJSON(e){return e.arrayBuffers===void 0&&(e.arrayBuffers={}),this.array.buffer._uuid===void 0&&(this.array.buffer._uuid=bo()),e.arrayBuffers[this.array.buffer._uuid]===void 0&&(e.arrayBuffers[this.array.buffer._uuid]=Array.from(new Uint32Array(this.array.buffer))),{uuid:this.uuid,buffer:this.array.buffer._uuid,type:this.array.constructor.name,stride:this.stride}}}const Ea=new ie;class bf{constructor(e,t,n,r=!1){this.isInterleavedBufferAttribute=!0,this.name="",this.data=e,this.itemSize=t,this.offset=n,this.normalized=r}get count(){return this.data.count}get array(){return this.data.array}set needsUpdate(e){this.data.needsUpdate=e}applyMatrix4(e){for(let t=0,n=this.data.count;t<n;t++)Ea.fromBufferAttribute(this,t),Ea.applyMatrix4(e),this.setXYZ(t,Ea.x,Ea.y,Ea.z);return this}applyNormalMatrix(e){for(let t=0,n=this.count;t<n;t++)Ea.fromBufferAttribute(this,t),Ea.applyNormalMatrix(e),this.setXYZ(t,Ea.x,Ea.y,Ea.z);return this}transformDirection(e){for(let t=0,n=this.count;t<n;t++)Ea.fromBufferAttribute(this,t),Ea.transformDirection(e),this.setXYZ(t,Ea.x,Ea.y,Ea.z);return this}getComponent(e,t){let n=this.array[e*this.data.stride+this.offset+t];return this.normalized&&(n=wa(n,this.array)),n}setComponent(e,t,n){return this.normalized&&(n=Vn(n,this.array)),this.data.array[e*this.data.stride+this.offset+t]=n,this}setX(e,t){return this.normalized&&(t=Vn(t,this.array)),this.data.array[e*this.data.stride+this.offset]=t,this}setY(e,t){return this.normalized&&(t=Vn(t,this.array)),this.data.array[e*this.data.stride+this.offset+1]=t,this}setZ(e,t){return this.normalized&&(t=Vn(t,this.array)),this.data.array[e*this.data.stride+this.offset+2]=t,this}setW(e,t){return this.normalized&&(t=Vn(t,this.array)),this.data.array[e*this.data.stride+this.offset+3]=t,this}getX(e){let t=this.data.array[e*this.data.stride+this.offset];return this.normalized&&(t=wa(t,this.array)),t}getY(e){let t=this.data.array[e*this.data.stride+this.offset+1];return this.normalized&&(t=wa(t,this.array)),t}getZ(e){let t=this.data.array[e*this.data.stride+this.offset+2];return this.normalized&&(t=wa(t,this.array)),t}getW(e){let t=this.data.array[e*this.data.stride+this.offset+3];return this.normalized&&(t=wa(t,this.array)),t}setXY(e,t,n){return e=e*this.data.stride+this.offset,this.normalized&&(t=Vn(t,this.array),n=Vn(n,this.array)),this.data.array[e+0]=t,this.data.array[e+1]=n,this}setXYZ(e,t,n,r){return e=e*this.data.stride+this.offset,this.normalized&&(t=Vn(t,this.array),n=Vn(n,this.array),r=Vn(r,this.array)),this.data.array[e+0]=t,this.data.array[e+1]=n,this.data.array[e+2]=r,this}setXYZW(e,t,n,r,s){return e=e*this.data.stride+this.offset,this.normalized&&(t=Vn(t,this.array),n=Vn(n,this.array),r=Vn(r,this.array),s=Vn(s,this.array)),this.data.array[e+0]=t,this.data.array[e+1]=n,this.data.array[e+2]=r,this.data.array[e+3]=s,this}clone(e){if(e===void 0){Kv("InterleavedBufferAttribute.clone(): Cloning an interleaved buffer attribute will de-interleave buffer data.");const t=[];for(let n=0;n<this.count;n++){const r=n*this.data.stride+this.offset;for(let s=0;s<this.itemSize;s++)t.push(this.data.array[r+s])}return new gi(new this.array.constructor(t),this.itemSize,this.normalized)}else return e.interleavedBuffers===void 0&&(e.interleavedBuffers={}),e.interleavedBuffers[this.data.uuid]===void 0&&(e.interleavedBuffers[this.data.uuid]=this.data.clone(e)),new bf(e.interleavedBuffers[this.data.uuid],this.itemSize,this.offset,this.normalized)}toJSON(e){if(e===void 0){Kv("InterleavedBufferAttribute.toJSON(): Serializing an interleaved buffer attribute will de-interleave buffer data.");const t=[];for(let n=0;n<this.count;n++){const r=n*this.data.stride+this.offset;for(let s=0;s<this.itemSize;s++)t.push(this.data.array[r+s])}return{itemSize:this.itemSize,type:this.array.constructor.name,array:t,normalized:this.normalized}}else return e.interleavedBuffers===void 0&&(e.interleavedBuffers={}),e.interleavedBuffers[this.data.uuid]===void 0&&(e.interleavedBuffers[this.data.uuid]=this.data.toJSON(e)),{isInterleavedBufferAttribute:!0,itemSize:this.itemSize,data:this.data.uuid,offset:this.offset,normalized:this.normalized}}}class fw extends os{constructor(e){super(),this.isSpriteMaterial=!0,this.type="SpriteMaterial",this.color=new Gt(16777215),this.map=null,this.alphaMap=null,this.rotation=0,this.sizeAttenuation=!0,this.transparent=!0,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.alphaMap=e.alphaMap,this.rotation=e.rotation,this.sizeAttenuation=e.sizeAttenuation,this.fog=e.fog,this}}let Am;const ev=new ie,Sm=new ie,Em=new ie,Tm=new $e,tv=new $e,sL=new vn,bx=new ie,nv=new ie,Ax=new ie,qI=new $e,l1=new $e,XI=new $e;class aL extends fi{constructor(e=new fw){if(super(),this.isSprite=!0,this.type="Sprite",Am===void 0){Am=new wn;const t=new Float32Array([-.5,-.5,0,0,0,.5,-.5,0,1,0,.5,.5,0,1,1,-.5,.5,0,0,1]),n=new Sy(t,5);Am.setIndex([0,1,2,0,2,3]),Am.setAttribute("position",new bf(n,3,0,!1)),Am.setAttribute("uv",new bf(n,2,3,!1))}this.geometry=Am,this.material=e,this.center=new $e(.5,.5),this.count=1}raycast(e,t){e.camera===null&&cn('Sprite: "Raycaster.camera" needs to be set in order to raycast against sprites.'),Sm.setFromMatrixScale(this.matrixWorld),sL.copy(e.camera.matrixWorld),this.modelViewMatrix.multiplyMatrices(e.camera.matrixWorldInverse,this.matrixWorld),Em.setFromMatrixPosition(this.modelViewMatrix),e.camera.isPerspectiveCamera&&this.material.sizeAttenuation===!1&&Sm.multiplyScalar(-Em.z);const n=this.material.rotation;let r,s;n!==0&&(s=Math.cos(n),r=Math.sin(n));const o=this.center;Sx(bx.set(-.5,-.5,0),Em,o,Sm,r,s),Sx(nv.set(.5,-.5,0),Em,o,Sm,r,s),Sx(Ax.set(.5,.5,0),Em,o,Sm,r,s),qI.set(0,0),l1.set(1,0),XI.set(1,1);let u=e.ray.intersectTriangle(bx,nv,Ax,!1,ev);if(u===null&&(Sx(nv.set(-.5,.5,0),Em,o,Sm,r,s),l1.set(0,1),u=e.ray.intersectTriangle(bx,Ax,nv,!1,ev),u===null))return;const f=e.ray.origin.distanceTo(ev);f<e.near||f>e.far||t.push({distance:f,point:ev.clone(),uv:eo.getInterpolation(ev,bx,nv,Ax,qI,l1,XI,new $e),face:null,object:this})}copy(e,t){return super.copy(e,t),e.center!==void 0&&this.center.copy(e.center),this.material=e.material,this}}function Sx(i,e,t,n,r,s){Tm.subVectors(i,t).addScalar(.5).multiply(n),r!==void 0?(tv.x=s*Tm.x-r*Tm.y,tv.y=r*Tm.x+s*Tm.y):tv.copy(Tm),i.copy(e),i.x+=tv.x,i.y+=tv.y,i.applyMatrix4(sL)}const Ex=new ie,YI=new ie;class oL extends fi{constructor(){super(),this.isLOD=!0,this._currentLevel=0,this.type="LOD",Object.defineProperties(this,{levels:{enumerable:!0,value:[]}}),this.autoUpdate=!0}copy(e){super.copy(e,!1);const t=e.levels;for(let n=0,r=t.length;n<r;n++){const s=t[n];this.addLevel(s.object.clone(),s.distance,s.hysteresis)}return this.autoUpdate=e.autoUpdate,this}addLevel(e,t=0,n=0){t=Math.abs(t);const r=this.levels;let s;for(s=0;s<r.length&&!(t<r[s].distance);s++);return r.splice(s,0,{distance:t,hysteresis:n,object:e}),this.add(e),this}removeLevel(e){const t=this.levels;for(let n=0;n<t.length;n++)if(t[n].distance===e){const r=t.splice(n,1);return this.remove(r[0].object),!0}return!1}getCurrentLevel(){return this._currentLevel}getObjectForDistance(e){const t=this.levels;if(t.length>0){let n,r;for(n=1,r=t.length;n<r;n++){let s=t[n].distance;if(t[n].object.visible&&(s-=s*t[n].hysteresis),e<s)break}return t[n-1].object}return null}raycast(e,t){if(this.levels.length>0){Ex.setFromMatrixPosition(this.matrixWorld);const r=e.ray.origin.distanceTo(Ex);this.getObjectForDistance(r).raycast(e,t)}}update(e){const t=this.levels;if(t.length>1){Ex.setFromMatrixPosition(e.matrixWorld),YI.setFromMatrixPosition(this.matrixWorld);const n=Ex.distanceTo(YI)/e.zoom;t[0].object.visible=!0;let r,s;for(r=1,s=t.length;r<s;r++){let o=t[r].distance;if(t[r].object.visible&&(o-=o*t[r].hysteresis),n>=o)t[r-1].object.visible=!1,t[r].object.visible=!0;else break}for(this._currentLevel=r-1;r<s;r++)t[r].object.visible=!1}}toJSON(e){const t=super.toJSON(e);this.autoUpdate===!1&&(t.object.autoUpdate=!1),t.object.levels=[];const n=this.levels;for(let r=0,s=n.length;r<s;r++){const o=n[r];t.object.levels.push({object:o.object.uuid,distance:o.distance,hysteresis:o.hysteresis})}return t}}const JI=new ie,KI=new zi,QI=new zi,pG=new ie,ZI=new vn,Tx=new ie,c1=new bs,$I=new vn,u1=new hp;class dw extends rr{constructor(e,t){super(e,t),this.isSkinnedMesh=!0,this.type="SkinnedMesh",this.bindMode=MT,this.bindMatrix=new vn,this.bindMatrixInverse=new vn,this.boundingBox=null,this.boundingSphere=null}computeBoundingBox(){const e=this.geometry;this.boundingBox===null&&(this.boundingBox=new xs),this.boundingBox.makeEmpty();const t=e.getAttribute("position");for(let n=0;n<t.count;n++)this.getVertexPosition(n,Tx),this.boundingBox.expandByPoint(Tx)}computeBoundingSphere(){const e=this.geometry;this.boundingSphere===null&&(this.boundingSphere=new bs),this.boundingSphere.makeEmpty();const t=e.getAttribute("position");for(let n=0;n<t.count;n++)this.getVertexPosition(n,Tx),this.boundingSphere.expandByPoint(Tx)}copy(e,t){return super.copy(e,t),this.bindMode=e.bindMode,this.bindMatrix.copy(e.bindMatrix),this.bindMatrixInverse.copy(e.bindMatrixInverse),this.skeleton=e.skeleton,e.boundingBox!==null&&(this.boundingBox=e.boundingBox.clone()),e.boundingSphere!==null&&(this.boundingSphere=e.boundingSphere.clone()),this}raycast(e,t){const n=this.material,r=this.matrixWorld;n!==void 0&&(this.boundingSphere===null&&this.computeBoundingSphere(),c1.copy(this.boundingSphere),c1.applyMatrix4(r),e.ray.intersectsSphere(c1)!==!1&&($I.copy(r).invert(),u1.copy(e.ray).applyMatrix4($I),!(this.boundingBox!==null&&u1.intersectsBox(this.boundingBox)===!1)&&this._computeIntersections(e,t,u1)))}getVertexPosition(e,t){return super.getVertexPosition(e,t),this.applyBoneTransform(e,t),t}bind(e,t){this.skeleton=e,t===void 0&&(this.updateMatrixWorld(!0),this.skeleton.calculateInverses(),t=this.matrixWorld),this.bindMatrix.copy(t),this.bindMatrixInverse.copy(t).invert()}pose(){this.skeleton.pose()}normalizeSkinWeights(){const e=new zi,t=this.geometry.attributes.skinWeight;for(let n=0,r=t.count;n<r;n++){e.fromBufferAttribute(t,n);const s=1/e.manhattanLength();s!==1/0?e.multiplyScalar(s):e.set(1,0,0,0),t.setXYZW(n,e.x,e.y,e.z,e.w)}}updateMatrixWorld(e){super.updateMatrixWorld(e),this.bindMode===MT?this.bindMatrixInverse.copy(this.matrixWorld).invert():this.bindMode===UB?this.bindMatrixInverse.copy(this.bindMatrix).invert():Ht("SkinnedMesh: Unrecognized bindMode: "+this.bindMode)}applyBoneTransform(e,t){const n=this.skeleton,r=this.geometry;KI.fromBufferAttribute(r.attributes.skinIndex,e),QI.fromBufferAttribute(r.attributes.skinWeight,e),JI.copy(t).applyMatrix4(this.bindMatrix),t.set(0,0,0);for(let s=0;s<4;s++){const o=QI.getComponent(s);if(o!==0){const u=KI.getComponent(s);ZI.multiplyMatrices(n.bones[u].matrixWorld,n.boneInverses[u]),t.addScaledVector(pG.copy(JI).applyMatrix4(ZI),o)}}return t.applyMatrix4(this.bindMatrixInverse)}}class AS extends fi{constructor(){super(),this.isBone=!0,this.type="Bone"}}class ll extends Ci{constructor(e=null,t=1,n=1,r,s,o,u,f,p=Pr,g=Pr,v,_){super(null,o,u,f,p,g,r,s,v,_),this.isDataTexture=!0,this.image={data:e,width:t,height:n},this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}const eD=new vn,mG=new vn;class Ey{constructor(e=[],t=[]){this.uuid=bo(),this.bones=e.slice(0),this.boneInverses=t,this.boneMatrices=null,this.previousBoneMatrices=null,this.boneTexture=null,this.init()}init(){const e=this.bones,t=this.boneInverses;if(this.boneMatrices=new Float32Array(e.length*16),t.length===0)this.calculateInverses();else if(e.length!==t.length){Ht("Skeleton: Number of inverse bone matrices does not match amount of bones."),this.boneInverses=[];for(let n=0,r=this.bones.length;n<r;n++)this.boneInverses.push(new vn)}}calculateInverses(){this.boneInverses.length=0;for(let e=0,t=this.bones.length;e<t;e++){const n=new vn;this.bones[e]&&n.copy(this.bones[e].matrixWorld).invert(),this.boneInverses.push(n)}}pose(){for(let e=0,t=this.bones.length;e<t;e++){const n=this.bones[e];n&&n.matrixWorld.copy(this.boneInverses[e]).invert()}for(let e=0,t=this.bones.length;e<t;e++){const n=this.bones[e];n&&(n.parent&&n.parent.isBone?(n.matrix.copy(n.parent.matrixWorld).invert(),n.matrix.multiply(n.matrixWorld)):n.matrix.copy(n.matrixWorld),n.matrix.decompose(n.position,n.quaternion,n.scale))}}update(){const e=this.bones,t=this.boneInverses,n=this.boneMatrices,r=this.boneTexture;for(let s=0,o=e.length;s<o;s++){const u=e[s]?e[s].matrixWorld:mG;eD.multiplyMatrices(u,t[s]),eD.toArray(n,s*16)}r!==null&&(r.needsUpdate=!0)}clone(){return new Ey(this.bones,this.boneInverses)}computeBoneTexture(){let e=Math.sqrt(this.bones.length*4);e=Math.ceil(e/4)*4,e=Math.max(e,4);const t=new Float32Array(e*e*4);t.set(this.boneMatrices);const n=new ll(t,e,e,jr,ir);return n.needsUpdate=!0,this.boneMatrices=t,this.boneTexture=n,this}getBoneByName(e){for(let t=0,n=this.bones.length;t<n;t++){const r=this.bones[t];if(r.name===e)return r}}dispose(){this.boneTexture!==null&&(this.boneTexture.dispose(),this.boneTexture=null)}fromJSON(e,t){this.uuid=e.uuid;for(let n=0,r=e.bones.length;n<r;n++){const s=e.bones[n];let o=t[s];o===void 0&&(Ht("Skeleton: No bone found with UUID:",s),o=new AS),this.bones.push(o),this.boneInverses.push(new vn().fromArray(e.boneInverses[n]))}return this.init(),this}toJSON(){const e={metadata:{version:4.7,type:"Skeleton",generator:"Skeleton.toJSON"},bones:[],boneInverses:[]};e.uuid=this.uuid;const t=this.bones,n=this.boneInverses;for(let r=0,s=t.length;r<s;r++){const o=t[r];e.bones.push(o.uuid);const u=n[r];e.boneInverses.push(u.toArray())}return e}}class $d extends gi{constructor(e,t,n,r=1){super(e,t,n),this.isInstancedBufferAttribute=!0,this.meshPerAttribute=r}copy(e){return super.copy(e),this.meshPerAttribute=e.meshPerAttribute,this}toJSON(){const e=super.toJSON();return e.meshPerAttribute=this.meshPerAttribute,e.isInstancedBufferAttribute=!0,e}}const Mm=new vn,tD=new vn,Mx=[],nD=new xs,gG=new vn,iv=new rr,rv=new bs;class pw extends rr{constructor(e,t,n){super(e,t),this.isInstancedMesh=!0,this.instanceMatrix=new $d(new Float32Array(n*16),16),this.instanceColor=null,this.morphTexture=null,this.count=n,this.boundingBox=null,this.boundingSphere=null;for(let r=0;r<n;r++)this.setMatrixAt(r,gG)}computeBoundingBox(){const e=this.geometry,t=this.count;this.boundingBox===null&&(this.boundingBox=new xs),e.boundingBox===null&&e.computeBoundingBox(),this.boundingBox.makeEmpty();for(let n=0;n<t;n++)this.getMatrixAt(n,Mm),nD.copy(e.boundingBox).applyMatrix4(Mm),this.boundingBox.union(nD)}computeBoundingSphere(){const e=this.geometry,t=this.count;this.boundingSphere===null&&(this.boundingSphere=new bs),e.boundingSphere===null&&e.computeBoundingSphere(),this.boundingSphere.makeEmpty();for(let n=0;n<t;n++)this.getMatrixAt(n,Mm),rv.copy(e.boundingSphere).applyMatrix4(Mm),this.boundingSphere.union(rv)}copy(e,t){return super.copy(e,t),this.instanceMatrix.copy(e.instanceMatrix),e.morphTexture!==null&&(this.morphTexture=e.morphTexture.clone()),e.instanceColor!==null&&(this.instanceColor=e.instanceColor.clone()),this.count=e.count,e.boundingBox!==null&&(this.boundingBox=e.boundingBox.clone()),e.boundingSphere!==null&&(this.boundingSphere=e.boundingSphere.clone()),this}getColorAt(e,t){t.fromArray(this.instanceColor.array,e*3)}getMatrixAt(e,t){t.fromArray(this.instanceMatrix.array,e*16)}getMorphAt(e,t){const n=t.morphTargetInfluences,r=this.morphTexture.source.data.data,s=n.length+1,o=e*s+1;for(let u=0;u<n.length;u++)n[u]=r[o+u]}raycast(e,t){const n=this.matrixWorld,r=this.count;if(iv.geometry=this.geometry,iv.material=this.material,iv.material!==void 0&&(this.boundingSphere===null&&this.computeBoundingSphere(),rv.copy(this.boundingSphere),rv.applyMatrix4(n),e.ray.intersectsSphere(rv)!==!1))for(let s=0;s<r;s++){this.getMatrixAt(s,Mm),tD.multiplyMatrices(n,Mm),iv.matrixWorld=tD,iv.raycast(e,Mx);for(let o=0,u=Mx.length;o<u;o++){const f=Mx[o];f.instanceId=s,f.object=this,t.push(f)}Mx.length=0}}setColorAt(e,t){this.instanceColor===null&&(this.instanceColor=new $d(new Float32Array(this.instanceMatrix.count*3).fill(1),3)),t.toArray(this.instanceColor.array,e*3)}setMatrixAt(e,t){t.toArray(this.instanceMatrix.array,e*16)}setMorphAt(e,t){const n=t.morphTargetInfluences,r=n.length+1;this.morphTexture===null&&(this.morphTexture=new ll(new Float32Array(r*this.count),r,this.count,_y,ir));const s=this.morphTexture.source.data.data;let o=0;for(let p=0;p<n.length;p++)o+=n[p];const u=this.geometry.morphTargetsRelative?1:1-o,f=r*e;s[f]=u,s.set(n,f+1)}updateMorphTargets(){}dispose(){this.dispatchEvent({type:"dispose"}),this.morphTexture!==null&&(this.morphTexture.dispose(),this.morphTexture=null)}}const h1=new ie,vG=new ie,yG=new Un;class Du{constructor(e=new ie(1,0,0),t=0){this.isPlane=!0,this.normal=e,this.constant=t}set(e,t){return this.normal.copy(e),this.constant=t,this}setComponents(e,t,n,r){return this.normal.set(e,t,n),this.constant=r,this}setFromNormalAndCoplanarPoint(e,t){return this.normal.copy(e),this.constant=-t.dot(this.normal),this}setFromCoplanarPoints(e,t,n){const r=h1.subVectors(n,t).cross(vG.subVectors(e,t)).normalize();return this.setFromNormalAndCoplanarPoint(r,e),this}copy(e){return this.normal.copy(e.normal),this.constant=e.constant,this}normalize(){const e=1/this.normal.length();return this.normal.multiplyScalar(e),this.constant*=e,this}negate(){return this.constant*=-1,this.normal.negate(),this}distanceToPoint(e){return this.normal.dot(e)+this.constant}distanceToSphere(e){return this.distanceToPoint(e.center)-e.radius}projectPoint(e,t){return t.copy(e).addScaledVector(this.normal,-this.distanceToPoint(e))}intersectLine(e,t){const n=e.delta(h1),r=this.normal.dot(n);if(r===0)return this.distanceToPoint(e.start)===0?t.copy(e.start):null;const s=-(e.start.dot(this.normal)+this.constant)/r;return s<0||s>1?null:t.copy(e.start).addScaledVector(n,s)}intersectsLine(e){const t=this.distanceToPoint(e.start),n=this.distanceToPoint(e.end);return t<0&&n>0||n<0&&t>0}intersectsBox(e){return e.intersectsPlane(this)}intersectsSphere(e){return e.intersectsPlane(this)}coplanarPoint(e){return e.copy(this.normal).multiplyScalar(-this.constant)}applyMatrix4(e,t){const n=t||yG.getNormalMatrix(e),r=this.coplanarPoint(h1).applyMatrix4(e),s=this.normal.applyMatrix3(n).normalize();return this.constant=-r.dot(s),this}translate(e){return this.constant-=e.dot(this.normal),this}equals(e){return e.normal.equals(this.normal)&&e.constant===this.constant}clone(){return new this.constructor().copy(this)}}const dd=new bs,_G=new $e(.5,.5),wx=new ie;class wg{constructor(e=new Du,t=new Du,n=new Du,r=new Du,s=new Du,o=new Du){this.planes=[e,t,n,r,s,o]}set(e,t,n,r,s,o){const u=this.planes;return u[0].copy(e),u[1].copy(t),u[2].copy(n),u[3].copy(r),u[4].copy(s),u[5].copy(o),this}copy(e){const t=this.planes;for(let n=0;n<6;n++)t[n].copy(e.planes[n]);return this}setFromProjectionMatrix(e,t=xo,n=!1){const r=this.planes,s=e.elements,o=s[0],u=s[1],f=s[2],p=s[3],g=s[4],v=s[5],_=s[6],x=s[7],E=s[8],C=s[9],w=s[10],T=s[11],N=s[12],L=s[13],F=s[14],G=s[15];if(r[0].setComponents(p-o,x-g,T-E,G-N).normalize(),r[1].setComponents(p+o,x+g,T+E,G+N).normalize(),r[2].setComponents(p+u,x+v,T+C,G+L).normalize(),r[3].setComponents(p-u,x-v,T-C,G-L).normalize(),n)r[4].setComponents(f,_,w,F).normalize(),r[5].setComponents(p-f,x-_,T-w,G-F).normalize();else if(r[4].setComponents(p-f,x-_,T-w,G-F).normalize(),t===xo)r[5].setComponents(p+f,x+_,T+w,G+F).normalize();else if(t===ug)r[5].setComponents(f,_,w,F).normalize();else throw new Error("THREE.Frustum.setFromProjectionMatrix(): Invalid coordinate system: "+t);return this}intersectsObject(e){if(e.boundingSphere!==void 0)e.boundingSphere===null&&e.computeBoundingSphere(),dd.copy(e.boundingSphere).applyMatrix4(e.matrixWorld);else{const t=e.geometry;t.boundingSphere===null&&t.computeBoundingSphere(),dd.copy(t.boundingSphere).applyMatrix4(e.matrixWorld)}return this.intersectsSphere(dd)}intersectsSprite(e){dd.center.set(0,0,0);const t=_G.distanceTo(e.center);return dd.radius=.7071067811865476+t,dd.applyMatrix4(e.matrixWorld),this.intersectsSphere(dd)}intersectsSphere(e){const t=this.planes,n=e.center,r=-e.radius;for(let s=0;s<6;s++)if(t[s].distanceToPoint(n)<r)return!1;return!0}intersectsBox(e){const t=this.planes;for(let n=0;n<6;n++){const r=t[n];if(wx.x=r.normal.x>0?e.max.x:e.min.x,wx.y=r.normal.y>0?e.max.y:e.min.y,wx.z=r.normal.z>0?e.max.z:e.min.z,r.distanceToPoint(wx)<0)return!1}return!0}containsPoint(e){const t=this.planes;for(let n=0;n<6;n++)if(t[n].distanceToPoint(e)<0)return!1;return!0}clone(){return new this.constructor().copy(this)}}const Rc=new vn,Ic=new wg;class SS{constructor(){this.coordinateSystem=xo}intersectsObject(e,t){if(!t.isArrayCamera||t.cameras.length===0)return!1;for(let n=0;n<t.cameras.length;n++){const r=t.cameras[n];if(Rc.multiplyMatrices(r.projectionMatrix,r.matrixWorldInverse),Ic.setFromProjectionMatrix(Rc,r.coordinateSystem,r.reversedDepth),Ic.intersectsObject(e))return!0}return!1}intersectsSprite(e,t){if(!t||!t.cameras||t.cameras.length===0)return!1;for(let n=0;n<t.cameras.length;n++){const r=t.cameras[n];if(Rc.multiplyMatrices(r.projectionMatrix,r.matrixWorldInverse),Ic.setFromProjectionMatrix(Rc,r.coordinateSystem,r.reversedDepth),Ic.intersectsSprite(e))return!0}return!1}intersectsSphere(e,t){if(!t||!t.cameras||t.cameras.length===0)return!1;for(let n=0;n<t.cameras.length;n++){const r=t.cameras[n];if(Rc.multiplyMatrices(r.projectionMatrix,r.matrixWorldInverse),Ic.setFromProjectionMatrix(Rc,r.coordinateSystem,r.reversedDepth),Ic.intersectsSphere(e))return!0}return!1}intersectsBox(e,t){if(!t||!t.cameras||t.cameras.length===0)return!1;for(let n=0;n<t.cameras.length;n++){const r=t.cameras[n];if(Rc.multiplyMatrices(r.projectionMatrix,r.matrixWorldInverse),Ic.setFromProjectionMatrix(Rc,r.coordinateSystem,r.reversedDepth),Ic.intersectsBox(e))return!0}return!1}containsPoint(e,t){if(!t||!t.cameras||t.cameras.length===0)return!1;for(let n=0;n<t.cameras.length;n++){const r=t.cameras[n];if(Rc.multiplyMatrices(r.projectionMatrix,r.matrixWorldInverse),Ic.setFromProjectionMatrix(Rc,r.coordinateSystem,r.reversedDepth),Ic.containsPoint(e))return!0}return!1}clone(){return new SS}}function f1(i,e){return i-e}function xG(i,e){return i.z-e.z}function bG(i,e){return e.z-i.z}class AG{constructor(){this.index=0,this.pool=[],this.list=[]}push(e,t,n,r){const s=this.pool,o=this.list;this.index>=s.length&&s.push({start:-1,count:-1,z:-1,index:-1});const u=s[this.index];o.push(u),this.index++,u.start=e,u.count=t,u.z=n,u.index=r}reset(){this.list.length=0,this.index=0}}const Ka=new vn,SG=new Gt(1,1,1),iD=new wg,EG=new SS,Cx=new xs,pd=new bs,sv=new ie,rD=new ie,TG=new ie,d1=new AG,oa=new rr,Rx=[];function MG(i,e,t=0){const n=e.itemSize;if(i.isInterleavedBufferAttribute||i.array.constructor!==e.array.constructor){const r=i.count;for(let s=0;s<r;s++)for(let o=0;o<n;o++)e.setComponent(s+t,o,i.getComponent(s,o))}else e.array.set(i.array,t*n);e.needsUpdate=!0}function md(i,e){if(i.constructor!==e.constructor){const t=Math.min(i.length,e.length);for(let n=0;n<t;n++)e[n]=i[n]}else{const t=Math.min(i.length,e.length);e.set(new i.constructor(i.buffer,0,t))}}class lL extends rr{constructor(e,t,n=t*2,r){super(new wn,r),this.isBatchedMesh=!0,this.perObjectFrustumCulled=!0,this.sortObjects=!0,this.boundingBox=null,this.boundingSphere=null,this.customSort=null,this._instanceInfo=[],this._geometryInfo=[],this._availableInstanceIds=[],this._availableGeometryIds=[],this._nextIndexStart=0,this._nextVertexStart=0,this._geometryCount=0,this._visibilityChanged=!0,this._geometryInitialized=!1,this._maxInstanceCount=e,this._maxVertexCount=t,this._maxIndexCount=n,this._multiDrawCounts=new Int32Array(e),this._multiDrawStarts=new Int32Array(e),this._multiDrawCount=0,this._multiDrawInstances=null,this._matricesTexture=null,this._indirectTexture=null,this._colorsTexture=null,this._initMatricesTexture(),this._initIndirectTexture()}get maxInstanceCount(){return this._maxInstanceCount}get instanceCount(){return this._instanceInfo.length-this._availableInstanceIds.length}get unusedVertexCount(){return this._maxVertexCount-this._nextVertexStart}get unusedIndexCount(){return this._maxIndexCount-this._nextIndexStart}_initMatricesTexture(){let e=Math.sqrt(this._maxInstanceCount*4);e=Math.ceil(e/4)*4,e=Math.max(e,4);const t=new Float32Array(e*e*4),n=new ll(t,e,e,jr,ir);this._matricesTexture=n}_initIndirectTexture(){let e=Math.sqrt(this._maxInstanceCount);e=Math.ceil(e);const t=new Uint32Array(e*e),n=new ll(t,e,e,xy,So);this._indirectTexture=n}_initColorsTexture(){let e=Math.sqrt(this._maxInstanceCount);e=Math.ceil(e);const t=new Float32Array(e*e*4).fill(1),n=new ll(t,e,e,jr,ir);n.colorSpace=oi.workingColorSpace,this._colorsTexture=n}_initializeGeometry(e){const t=this.geometry,n=this._maxVertexCount,r=this._maxIndexCount;if(this._geometryInitialized===!1){for(const s in e.attributes){const o=e.getAttribute(s),{array:u,itemSize:f,normalized:p}=o,g=new u.constructor(n*f),v=new gi(g,f,p);t.setAttribute(s,v)}if(e.getIndex()!==null){const s=n>65535?new Uint32Array(r):new Uint16Array(r);t.setIndex(new gi(s,1))}this._geometryInitialized=!0}}_validateGeometry(e){const t=this.geometry;if(!!e.getIndex()!=!!t.getIndex())throw new Error('THREE.BatchedMesh: All geometries must consistently have "index".');for(const n in t.attributes){if(!e.hasAttribute(n))throw new Error(`THREE.BatchedMesh: Added geometry missing "${n}". All geometries must have consistent attributes.`);const r=e.getAttribute(n),s=t.getAttribute(n);if(r.itemSize!==s.itemSize||r.normalized!==s.normalized)throw new Error("THREE.BatchedMesh: All attributes must have a consistent itemSize and normalized value.")}}validateInstanceId(e){const t=this._instanceInfo;if(e<0||e>=t.length||t[e].active===!1)throw new Error(`THREE.BatchedMesh: Invalid instanceId ${e}. Instance is either out of range or has been deleted.`)}validateGeometryId(e){const t=this._geometryInfo;if(e<0||e>=t.length||t[e].active===!1)throw new Error(`THREE.BatchedMesh: Invalid geometryId ${e}. Geometry is either out of range or has been deleted.`)}setCustomSort(e){return this.customSort=e,this}computeBoundingBox(){this.boundingBox===null&&(this.boundingBox=new xs);const e=this.boundingBox,t=this._instanceInfo;e.makeEmpty();for(let n=0,r=t.length;n<r;n++){if(t[n].active===!1)continue;const s=t[n].geometryIndex;this.getMatrixAt(n,Ka),this.getBoundingBoxAt(s,Cx).applyMatrix4(Ka),e.union(Cx)}}computeBoundingSphere(){this.boundingSphere===null&&(this.boundingSphere=new bs);const e=this.boundingSphere,t=this._instanceInfo;e.makeEmpty();for(let n=0,r=t.length;n<r;n++){if(t[n].active===!1)continue;const s=t[n].geometryIndex;this.getMatrixAt(n,Ka),this.getBoundingSphereAt(s,pd).applyMatrix4(Ka),e.union(pd)}}addInstance(e){if(this._instanceInfo.length>=this.maxInstanceCount&&this._availableInstanceIds.length===0)throw new Error("THREE.BatchedMesh: Maximum item count reached.");const n={visible:!0,active:!0,geometryIndex:e};let r=null;this._availableInstanceIds.length>0?(this._availableInstanceIds.sort(f1),r=this._availableInstanceIds.shift(),this._instanceInfo[r]=n):(r=this._instanceInfo.length,this._instanceInfo.push(n));const s=this._matricesTexture;Ka.identity().toArray(s.image.data,r*16),s.needsUpdate=!0;const o=this._colorsTexture;return o&&(SG.toArray(o.image.data,r*4),o.needsUpdate=!0),this._visibilityChanged=!0,r}addGeometry(e,t=-1,n=-1){this._initializeGeometry(e),this._validateGeometry(e);const r={vertexStart:-1,vertexCount:-1,reservedVertexCount:-1,indexStart:-1,indexCount:-1,reservedIndexCount:-1,start:-1,count:-1,boundingBox:null,boundingSphere:null,active:!0},s=this._geometryInfo;r.vertexStart=this._nextVertexStart,r.reservedVertexCount=t===-1?e.getAttribute("position").count:t;const o=e.getIndex();if(o!==null&&(r.indexStart=this._nextIndexStart,r.reservedIndexCount=n===-1?o.count:n),r.indexStart!==-1&&r.indexStart+r.reservedIndexCount>this._maxIndexCount||r.vertexStart+r.reservedVertexCount>this._maxVertexCount)throw new Error("THREE.BatchedMesh: Reserved space request exceeds the maximum buffer size.");let f;return this._availableGeometryIds.length>0?(this._availableGeometryIds.sort(f1),f=this._availableGeometryIds.shift(),s[f]=r):(f=this._geometryCount,this._geometryCount++,s.push(r)),this.setGeometryAt(f,e),this._nextIndexStart=r.indexStart+r.reservedIndexCount,this._nextVertexStart=r.vertexStart+r.reservedVertexCount,f}setGeometryAt(e,t){if(e>=this._geometryCount)throw new Error("THREE.BatchedMesh: Maximum geometry count reached.");this._validateGeometry(t);const n=this.geometry,r=n.getIndex()!==null,s=n.getIndex(),o=t.getIndex(),u=this._geometryInfo[e];if(r&&o.count>u.reservedIndexCount||t.attributes.position.count>u.reservedVertexCount)throw new Error("THREE.BatchedMesh: Reserved space not large enough for provided geometry.");const f=u.vertexStart,p=u.reservedVertexCount;u.vertexCount=t.getAttribute("position").count;for(const g in n.attributes){const v=t.getAttribute(g),_=n.getAttribute(g);MG(v,_,f);const x=v.itemSize;for(let E=v.count,C=p;E<C;E++){const w=f+E;for(let T=0;T<x;T++)_.setComponent(w,T,0)}_.needsUpdate=!0,_.addUpdateRange(f*x,p*x)}if(r){const g=u.indexStart,v=u.reservedIndexCount;u.indexCount=t.getIndex().count;for(let _=0;_<o.count;_++)s.setX(g+_,f+o.getX(_));for(let _=o.count,x=v;_<x;_++)s.setX(g+_,f);s.needsUpdate=!0,s.addUpdateRange(g,u.reservedIndexCount)}return u.start=r?u.indexStart:u.vertexStart,u.count=r?u.indexCount:u.vertexCount,u.boundingBox=null,t.boundingBox!==null&&(u.boundingBox=t.boundingBox.clone()),u.boundingSphere=null,t.boundingSphere!==null&&(u.boundingSphere=t.boundingSphere.clone()),this._visibilityChanged=!0,e}deleteGeometry(e){const t=this._geometryInfo;if(e>=t.length||t[e].active===!1)return this;const n=this._instanceInfo;for(let r=0,s=n.length;r<s;r++)n[r].active&&n[r].geometryIndex===e&&this.deleteInstance(r);return t[e].active=!1,this._availableGeometryIds.push(e),this._visibilityChanged=!0,this}deleteInstance(e){return this.validateInstanceId(e),this._instanceInfo[e].active=!1,this._availableInstanceIds.push(e),this._visibilityChanged=!0,this}optimize(){let e=0,t=0;const n=this._geometryInfo,r=n.map((o,u)=>u).sort((o,u)=>n[o].vertexStart-n[u].vertexStart),s=this.geometry;for(let o=0,u=n.length;o<u;o++){const f=r[o],p=n[f];if(p.active!==!1){if(s.index!==null){if(p.indexStart!==t){const{indexStart:g,vertexStart:v,reservedIndexCount:_}=p,x=s.index,E=x.array,C=e-v;for(let w=g;w<g+_;w++)E[w]=E[w]+C;x.array.copyWithin(t,g,g+_),x.addUpdateRange(t,_),x.needsUpdate=!0,p.indexStart=t}t+=p.reservedIndexCount}if(p.vertexStart!==e){const{vertexStart:g,reservedVertexCount:v}=p,_=s.attributes;for(const x in _){const E=_[x],{array:C,itemSize:w}=E;C.copyWithin(e*w,g*w,(g+v)*w),E.addUpdateRange(e*w,v*w),E.needsUpdate=!0}p.vertexStart=e}e+=p.reservedVertexCount,p.start=s.index?p.indexStart:p.vertexStart,this._nextIndexStart=s.index?p.indexStart+p.reservedIndexCount:0,this._nextVertexStart=p.vertexStart+p.reservedVertexCount}}return this._visibilityChanged=!0,this}getBoundingBoxAt(e,t){if(e>=this._geometryCount)return null;const n=this.geometry,r=this._geometryInfo[e];if(r.boundingBox===null){const s=new xs,o=n.index,u=n.attributes.position;for(let f=r.start,p=r.start+r.count;f<p;f++){let g=f;o&&(g=o.getX(g)),s.expandByPoint(sv.fromBufferAttribute(u,g))}r.boundingBox=s}return t.copy(r.boundingBox),t}getBoundingSphereAt(e,t){if(e>=this._geometryCount)return null;const n=this.geometry,r=this._geometryInfo[e];if(r.boundingSphere===null){const s=new bs;this.getBoundingBoxAt(e,Cx),Cx.getCenter(s.center);const o=n.index,u=n.attributes.position;let f=0;for(let p=r.start,g=r.start+r.count;p<g;p++){let v=p;o&&(v=o.getX(v)),sv.fromBufferAttribute(u,v),f=Math.max(f,s.center.distanceToSquared(sv))}s.radius=Math.sqrt(f),r.boundingSphere=s}return t.copy(r.boundingSphere),t}setMatrixAt(e,t){this.validateInstanceId(e);const n=this._matricesTexture,r=this._matricesTexture.image.data;return t.toArray(r,e*16),n.needsUpdate=!0,this}getMatrixAt(e,t){return this.validateInstanceId(e),t.fromArray(this._matricesTexture.image.data,e*16)}setColorAt(e,t){return this.validateInstanceId(e),this._colorsTexture===null&&this._initColorsTexture(),t.toArray(this._colorsTexture.image.data,e*4),this._colorsTexture.needsUpdate=!0,this}getColorAt(e,t){return this.validateInstanceId(e),t.fromArray(this._colorsTexture.image.data,e*4)}setVisibleAt(e,t){return this.validateInstanceId(e),this._instanceInfo[e].visible===t?this:(this._instanceInfo[e].visible=t,this._visibilityChanged=!0,this)}getVisibleAt(e){return this.validateInstanceId(e),this._instanceInfo[e].visible}setGeometryIdAt(e,t){return this.validateInstanceId(e),this.validateGeometryId(t),this._instanceInfo[e].geometryIndex=t,this}getGeometryIdAt(e){return this.validateInstanceId(e),this._instanceInfo[e].geometryIndex}getGeometryRangeAt(e,t={}){this.validateGeometryId(e);const n=this._geometryInfo[e];return t.vertexStart=n.vertexStart,t.vertexCount=n.vertexCount,t.reservedVertexCount=n.reservedVertexCount,t.indexStart=n.indexStart,t.indexCount=n.indexCount,t.reservedIndexCount=n.reservedIndexCount,t.start=n.start,t.count=n.count,t}setInstanceCount(e){const t=this._availableInstanceIds,n=this._instanceInfo;for(t.sort(f1);t[t.length-1]===n.length-1;)n.pop(),t.pop();if(e<n.length)throw new Error(`BatchedMesh: Instance ids outside the range ${e} are being used. Cannot shrink instance count.`);const r=new Int32Array(e),s=new Int32Array(e);md(this._multiDrawCounts,r),md(this._multiDrawStarts,s),this._multiDrawCounts=r,this._multiDrawStarts=s,this._maxInstanceCount=e;const o=this._indirectTexture,u=this._matricesTexture,f=this._colorsTexture;o.dispose(),this._initIndirectTexture(),md(o.image.data,this._indirectTexture.image.data),u.dispose(),this._initMatricesTexture(),md(u.image.data,this._matricesTexture.image.data),f&&(f.dispose(),this._initColorsTexture(),md(f.image.data,this._colorsTexture.image.data))}setGeometrySize(e,t){const n=[...this._geometryInfo].filter(u=>u.active);if(Math.max(...n.map(u=>u.vertexStart+u.reservedVertexCount))>e)throw new Error(`BatchedMesh: Geometry vertex values are being used outside the range ${t}. Cannot shrink further.`);if(this.geometry.index&&Math.max(...n.map(f=>f.indexStart+f.reservedIndexCount))>t)throw new Error(`BatchedMesh: Geometry index values are being used outside the range ${t}. Cannot shrink further.`);const s=this.geometry;s.dispose(),this._maxVertexCount=e,this._maxIndexCount=t,this._geometryInitialized&&(this._geometryInitialized=!1,this.geometry=new wn,this._initializeGeometry(s));const o=this.geometry;s.index&&md(s.index.array,o.index.array);for(const u in s.attributes)md(s.attributes[u].array,o.attributes[u].array)}raycast(e,t){const n=this._instanceInfo,r=this._geometryInfo,s=this.matrixWorld,o=this.geometry;oa.material=this.material,oa.geometry.index=o.index,oa.geometry.attributes=o.attributes,oa.geometry.boundingBox===null&&(oa.geometry.boundingBox=new xs),oa.geometry.boundingSphere===null&&(oa.geometry.boundingSphere=new bs);for(let u=0,f=n.length;u<f;u++){if(!n[u].visible||!n[u].active)continue;const p=n[u].geometryIndex,g=r[p];oa.geometry.setDrawRange(g.start,g.count),this.getMatrixAt(u,oa.matrixWorld).premultiply(s),this.getBoundingBoxAt(p,oa.geometry.boundingBox),this.getBoundingSphereAt(p,oa.geometry.boundingSphere),oa.raycast(e,Rx);for(let v=0,_=Rx.length;v<_;v++){const x=Rx[v];x.object=this,x.batchId=u,t.push(x)}Rx.length=0}oa.material=null,oa.geometry.index=null,oa.geometry.attributes={},oa.geometry.setDrawRange(0,1/0)}copy(e){return super.copy(e),this.geometry=e.geometry.clone(),this.perObjectFrustumCulled=e.perObjectFrustumCulled,this.sortObjects=e.sortObjects,this.boundingBox=e.boundingBox!==null?e.boundingBox.clone():null,this.boundingSphere=e.boundingSphere!==null?e.boundingSphere.clone():null,this._geometryInfo=e._geometryInfo.map(t=>({...t,boundingBox:t.boundingBox!==null?t.boundingBox.clone():null,boundingSphere:t.boundingSphere!==null?t.boundingSphere.clone():null})),this._instanceInfo=e._instanceInfo.map(t=>({...t})),this._availableInstanceIds=e._availableInstanceIds.slice(),this._availableGeometryIds=e._availableGeometryIds.slice(),this._nextIndexStart=e._nextIndexStart,this._nextVertexStart=e._nextVertexStart,this._geometryCount=e._geometryCount,this._maxInstanceCount=e._maxInstanceCount,this._maxVertexCount=e._maxVertexCount,this._maxIndexCount=e._maxIndexCount,this._geometryInitialized=e._geometryInitialized,this._multiDrawCounts=e._multiDrawCounts.slice(),this._multiDrawStarts=e._multiDrawStarts.slice(),this._indirectTexture=e._indirectTexture.clone(),this._indirectTexture.image.data=this._indirectTexture.image.data.slice(),this._matricesTexture=e._matricesTexture.clone(),this._matricesTexture.image.data=this._matricesTexture.image.data.slice(),this._colorsTexture!==null&&(this._colorsTexture=e._colorsTexture.clone(),this._colorsTexture.image.data=this._colorsTexture.image.data.slice()),this}dispose(){this.geometry.dispose(),this._matricesTexture.dispose(),this._matricesTexture=null,this._indirectTexture.dispose(),this._indirectTexture=null,this._colorsTexture!==null&&(this._colorsTexture.dispose(),this._colorsTexture=null)}onBeforeRender(e,t,n,r,s){if(!this._visibilityChanged&&!this.perObjectFrustumCulled&&!this.sortObjects)return;const o=r.getIndex(),u=o===null?1:o.array.BYTES_PER_ELEMENT,f=this._instanceInfo,p=this._multiDrawStarts,g=this._multiDrawCounts,v=this._geometryInfo,_=this.perObjectFrustumCulled,x=this._indirectTexture,E=x.image.data,C=n.isArrayCamera?EG:iD;_&&!n.isArrayCamera&&(Ka.multiplyMatrices(n.projectionMatrix,n.matrixWorldInverse).multiply(this.matrixWorld),iD.setFromProjectionMatrix(Ka,n.coordinateSystem,n.reversedDepth));let w=0;if(this.sortObjects){Ka.copy(this.matrixWorld).invert(),sv.setFromMatrixPosition(n.matrixWorld).applyMatrix4(Ka),rD.set(0,0,-1).transformDirection(n.matrixWorld).transformDirection(Ka);for(let L=0,F=f.length;L<F;L++)if(f[L].visible&&f[L].active){const G=f[L].geometryIndex;this.getMatrixAt(L,Ka),this.getBoundingSphereAt(G,pd).applyMatrix4(Ka);let k=!1;if(_&&(k=!C.intersectsSphere(pd,n)),!k){const O=v[G],D=TG.subVectors(pd.center,sv).dot(rD);d1.push(O.start,O.count,D,L)}}const T=d1.list,N=this.customSort;N===null?T.sort(s.transparent?bG:xG):N.call(this,T,n);for(let L=0,F=T.length;L<F;L++){const G=T[L];p[w]=G.start*u,g[w]=G.count,E[w]=G.index,w++}d1.reset()}else for(let T=0,N=f.length;T<N;T++)if(f[T].visible&&f[T].active){const L=f[T].geometryIndex;let F=!1;if(_&&(this.getMatrixAt(T,Ka),this.getBoundingSphereAt(L,pd).applyMatrix4(Ka),F=!C.intersectsSphere(pd,n)),!F){const G=v[L];p[w]=G.start*u,g[w]=G.count,E[w]=T,w++}}x.needsUpdate=!0,this._multiDrawCount=w,this._visibilityChanged=!1}onBeforeShadow(e,t,n,r,s,o){this.onBeforeRender(e,null,r,s,o)}}class ha extends os{constructor(e){super(),this.isLineBasicMaterial=!0,this.type="LineBasicMaterial",this.color=new Gt(16777215),this.map=null,this.linewidth=1,this.linecap="round",this.linejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.linewidth=e.linewidth,this.linecap=e.linecap,this.linejoin=e.linejoin,this.fog=e.fog,this}}const TA=new ie,MA=new ie,sD=new vn,av=new hp,Ix=new bs,p1=new ie,aD=new ie;class ju extends fi{constructor(e=new wn,t=new ha){super(),this.isLine=!0,this.type="Line",this.geometry=e,this.material=t,this.morphTargetDictionary=void 0,this.morphTargetInfluences=void 0,this.updateMorphTargets()}copy(e,t){return super.copy(e,t),this.material=Array.isArray(e.material)?e.material.slice():e.material,this.geometry=e.geometry,this}computeLineDistances(){const e=this.geometry;if(e.index===null){const t=e.attributes.position,n=[0];for(let r=1,s=t.count;r<s;r++)TA.fromBufferAttribute(t,r-1),MA.fromBufferAttribute(t,r),n[r]=n[r-1],n[r]+=TA.distanceTo(MA);e.setAttribute("lineDistance",new tn(n,1))}else Ht("Line.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}raycast(e,t){const n=this.geometry,r=this.matrixWorld,s=e.params.Line.threshold,o=n.drawRange;if(n.boundingSphere===null&&n.computeBoundingSphere(),Ix.copy(n.boundingSphere),Ix.applyMatrix4(r),Ix.radius+=s,e.ray.intersectsSphere(Ix)===!1)return;sD.copy(r).invert(),av.copy(e.ray).applyMatrix4(sD);const u=s/((this.scale.x+this.scale.y+this.scale.z)/3),f=u*u,p=this.isLineSegments?2:1,g=n.index,_=n.attributes.position;if(g!==null){const x=Math.max(0,o.start),E=Math.min(g.count,o.start+o.count);for(let C=x,w=E-1;C<w;C+=p){const T=g.getX(C),N=g.getX(C+1),L=Dx(this,e,av,f,T,N,C);L&&t.push(L)}if(this.isLineLoop){const C=g.getX(E-1),w=g.getX(x),T=Dx(this,e,av,f,C,w,E-1);T&&t.push(T)}}else{const x=Math.max(0,o.start),E=Math.min(_.count,o.start+o.count);for(let C=x,w=E-1;C<w;C+=p){const T=Dx(this,e,av,f,C,C+1,C);T&&t.push(T)}if(this.isLineLoop){const C=Dx(this,e,av,f,E-1,x,E-1);C&&t.push(C)}}}updateMorphTargets(){const t=this.geometry.morphAttributes,n=Object.keys(t);if(n.length>0){const r=t[n[0]];if(r!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let s=0,o=r.length;s<o;s++){const u=r[s].name||String(s);this.morphTargetInfluences.push(0),this.morphTargetDictionary[u]=s}}}}}function Dx(i,e,t,n,r,s,o){const u=i.geometry.attributes.position;if(TA.fromBufferAttribute(u,r),MA.fromBufferAttribute(u,s),t.distanceSqToSegment(TA,MA,p1,aD)>n)return;p1.applyMatrix4(i.matrixWorld);const p=e.ray.origin.distanceTo(p1);if(!(p<e.near||p>e.far))return{distance:p,point:aD.clone().applyMatrix4(i.matrixWorld),index:o,face:null,faceIndex:null,barycoord:null,object:i}}const oD=new ie,lD=new ie;class Yl extends ju{constructor(e,t){super(e,t),this.isLineSegments=!0,this.type="LineSegments"}computeLineDistances(){const e=this.geometry;if(e.index===null){const t=e.attributes.position,n=[];for(let r=0,s=t.count;r<s;r+=2)oD.fromBufferAttribute(t,r),lD.fromBufferAttribute(t,r+1),n[r]=r===0?0:n[r-1],n[r+1]=n[r]+oD.distanceTo(lD);e.setAttribute("lineDistance",new tn(n,1))}else Ht("LineSegments.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}}class mw extends ju{constructor(e,t){super(e,t),this.isLineLoop=!0,this.type="LineLoop"}}class ES extends os{constructor(e){super(),this.isPointsMaterial=!0,this.type="PointsMaterial",this.color=new Gt(16777215),this.map=null,this.alphaMap=null,this.size=1,this.sizeAttenuation=!0,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.alphaMap=e.alphaMap,this.size=e.size,this.sizeAttenuation=e.sizeAttenuation,this.fog=e.fog,this}}const cD=new vn,IT=new hp,Nx=new bs,Px=new ie;class gw extends fi{constructor(e=new wn,t=new ES){super(),this.isPoints=!0,this.type="Points",this.geometry=e,this.material=t,this.morphTargetDictionary=void 0,this.morphTargetInfluences=void 0,this.updateMorphTargets()}copy(e,t){return super.copy(e,t),this.material=Array.isArray(e.material)?e.material.slice():e.material,this.geometry=e.geometry,this}raycast(e,t){const n=this.geometry,r=this.matrixWorld,s=e.params.Points.threshold,o=n.drawRange;if(n.boundingSphere===null&&n.computeBoundingSphere(),Nx.copy(n.boundingSphere),Nx.applyMatrix4(r),Nx.radius+=s,e.ray.intersectsSphere(Nx)===!1)return;cD.copy(r).invert(),IT.copy(e.ray).applyMatrix4(cD);const u=s/((this.scale.x+this.scale.y+this.scale.z)/3),f=u*u,p=n.index,v=n.attributes.position;if(p!==null){const _=Math.max(0,o.start),x=Math.min(p.count,o.start+o.count);for(let E=_,C=x;E<C;E++){const w=p.getX(E);Px.fromBufferAttribute(v,w),uD(Px,w,f,r,e,t,this)}}else{const _=Math.max(0,o.start),x=Math.min(v.count,o.start+o.count);for(let E=_,C=x;E<C;E++)Px.fromBufferAttribute(v,E),uD(Px,E,f,r,e,t,this)}}updateMorphTargets(){const t=this.geometry.morphAttributes,n=Object.keys(t);if(n.length>0){const r=t[n[0]];if(r!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let s=0,o=r.length;s<o;s++){const u=r[s].name||String(s);this.morphTargetInfluences.push(0),this.morphTargetDictionary[u]=s}}}}}function uD(i,e,t,n,r,s,o){const u=IT.distanceSqToPoint(i);if(u<t){const f=new ie;IT.closestPointToPoint(i,f),f.applyMatrix4(n);const p=r.ray.origin.distanceTo(f);if(p<r.near||p>r.far)return;s.push({distance:p,distanceToRay:Math.sqrt(u),point:f,index:e,face:null,faceIndex:null,barycoord:null,object:o})}}class cL extends Ci{constructor(e,t,n,r,s=Jn,o=Jn,u,f,p){super(e,t,n,r,s,o,u,f,p),this.isVideoTexture=!0,this.generateMipmaps=!1,this._requestVideoFrameCallbackId=0;const g=this;function v(){g.needsUpdate=!0,g._requestVideoFrameCallbackId=e.requestVideoFrameCallback(v)}"requestVideoFrameCallback"in e&&(this._requestVideoFrameCallbackId=e.requestVideoFrameCallback(v))}clone(){return new this.constructor(this.image).copy(this)}update(){const e=this.image;"requestVideoFrameCallback"in e===!1&&e.readyState>=e.HAVE_CURRENT_DATA&&(this.needsUpdate=!0)}dispose(){this._requestVideoFrameCallbackId!==0&&(this.source.data.cancelVideoFrameCallback(this._requestVideoFrameCallbackId),this._requestVideoFrameCallbackId=0),super.dispose()}}class wG extends cL{constructor(e,t,n,r,s,o,u,f){super({},e,t,n,r,s,o,u,f),this.isVideoFrameTexture=!0}update(){}clone(){return new this.constructor().copy(this)}setFrame(e){this.image=e,this.needsUpdate=!0}}class CG extends Ci{constructor(e,t){super({width:e,height:t}),this.isFramebufferTexture=!0,this.magFilter=Pr,this.minFilter=Pr,this.generateMipmaps=!1,this.needsUpdate=!0}}class TS extends Ci{constructor(e,t,n,r,s,o,u,f,p,g,v,_){super(null,o,u,f,p,g,r,s,v,_),this.isCompressedTexture=!0,this.image={width:t,height:n},this.mipmaps=e,this.flipY=!1,this.generateMipmaps=!1}}class RG extends TS{constructor(e,t,n,r,s,o){super(e,t,n,s,o),this.isCompressedArrayTexture=!0,this.image.depth=r,this.wrapR=Sr,this.layerUpdates=new Set}addLayerUpdate(e){this.layerUpdates.add(e)}clearLayerUpdates(){this.layerUpdates.clear()}}class IG extends TS{constructor(e,t,n){super(void 0,e[0].width,e[0].height,t,n,ql),this.isCompressedCubeTexture=!0,this.isCubeTexture=!0,this.image=e}}class DG extends Ci{constructor(e,t,n,r,s,o,u,f,p){super(e,t,n,r,s,o,u,f,p),this.isCanvasTexture=!0,this.needsUpdate=!0}}class ep extends Ci{constructor(e,t,n=So,r,s,o,u=Pr,f=Pr,p,g=jc,v=1){if(g!==jc&&g!==$h)throw new Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");const _={width:e,height:t,depth:v};super(_,r,s,o,u,f,g,n,p),this.isDepthTexture=!0,this.flipY=!1,this.generateMipmaps=!1,this.compareFunction=null}copy(e){return super.copy(e),this.source=new ef(Object.assign({},e.image)),this.compareFunction=e.compareFunction,this}toJSON(e){const t=super.toJSON(e);return this.compareFunction!==null&&(t.compareFunction=this.compareFunction),t}}class uL extends ep{constructor(e,t=So,n=ql,r,s,o=Pr,u=Pr,f,p=jc){const g={width:e,height:e,depth:1},v=[g,g,g,g,g,g];super(e,e,t,n,r,s,o,u,f,p),this.image=v,this.isCubeDepthTexture=!0,this.isCubeTexture=!0}get images(){return this.image}set images(e){this.image=e}}class vw extends Ci{constructor(e=null){super(),this.sourceTexture=e,this.isExternalTexture=!0}copy(e){return super.copy(e),this.sourceTexture=e.sourceTexture,this}}class MS extends wn{constructor(e=1,t=1,n=4,r=8,s=1){super(),this.type="CapsuleGeometry",this.parameters={radius:e,height:t,capSegments:n,radialSegments:r,heightSegments:s},t=Math.max(0,t),n=Math.max(1,Math.floor(n)),r=Math.max(3,Math.floor(r)),s=Math.max(1,Math.floor(s));const o=[],u=[],f=[],p=[],g=t/2,v=Math.PI/2*e,_=t,x=2*v+_,E=n*2+s,C=r+1,w=new ie,T=new ie;for(let N=0;N<=E;N++){let L=0,F=0,G=0,k=0;if(N<=n){const R=N/n,P=R*Math.PI/2;F=-g-e*Math.cos(P),G=e*Math.sin(P),k=-e*Math.cos(P),L=R*v}else if(N<=n+s){const R=(N-n)/s;F=-g+R*t,G=e,k=0,L=v+R*_}else{const R=(N-n-s)/n,P=R*Math.PI/2;F=g+e*Math.sin(P),G=e*Math.cos(P),k=e*Math.sin(P),L=v+_+R*v}const O=Math.max(0,Math.min(1,L/x));let D=0;N===0?D=.5/r:N===E&&(D=-.5/r);for(let R=0;R<=r;R++){const P=R/r,z=P*Math.PI*2,Y=Math.sin(z),j=Math.cos(z);T.x=-G*j,T.y=F,T.z=G*Y,u.push(T.x,T.y,T.z),w.set(-G*j,k,G*Y),w.normalize(),f.push(w.x,w.y,w.z),p.push(P+D,O)}if(N>0){const R=(N-1)*C;for(let P=0;P<r;P++){const z=R+P,Y=R+P+1,j=N*C+P,ce=N*C+P+1;o.push(z,Y,j),o.push(Y,ce,j)}}}this.setIndex(o),this.setAttribute("position",new tn(u,3)),this.setAttribute("normal",new tn(f,3)),this.setAttribute("uv",new tn(p,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new MS(e.radius,e.height,e.capSegments,e.radialSegments,e.heightSegments)}}class wS extends wn{constructor(e=1,t=32,n=0,r=Math.PI*2){super(),this.type="CircleGeometry",this.parameters={radius:e,segments:t,thetaStart:n,thetaLength:r},t=Math.max(3,t);const s=[],o=[],u=[],f=[],p=new ie,g=new $e;o.push(0,0,0),u.push(0,0,1),f.push(.5,.5);for(let v=0,_=3;v<=t;v++,_+=3){const x=n+v/t*r;p.x=e*Math.cos(x),p.y=e*Math.sin(x),o.push(p.x,p.y,p.z),u.push(0,0,1),g.x=(o[_]/e+1)/2,g.y=(o[_+1]/e+1)/2,f.push(g.x,g.y)}for(let v=1;v<=t;v++)s.push(v,v+1,0);this.setIndex(s),this.setAttribute("position",new tn(o,3)),this.setAttribute("normal",new tn(u,3)),this.setAttribute("uv",new tn(f,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new wS(e.radius,e.segments,e.thetaStart,e.thetaLength)}}class Ty extends wn{constructor(e=1,t=1,n=1,r=32,s=1,o=!1,u=0,f=Math.PI*2){super(),this.type="CylinderGeometry",this.parameters={radiusTop:e,radiusBottom:t,height:n,radialSegments:r,heightSegments:s,openEnded:o,thetaStart:u,thetaLength:f};const p=this;r=Math.floor(r),s=Math.floor(s);const g=[],v=[],_=[],x=[];let E=0;const C=[],w=n/2;let T=0;N(),o===!1&&(e>0&&L(!0),t>0&&L(!1)),this.setIndex(g),this.setAttribute("position",new tn(v,3)),this.setAttribute("normal",new tn(_,3)),this.setAttribute("uv",new tn(x,2));function N(){const F=new ie,G=new ie;let k=0;const O=(t-e)/n;for(let D=0;D<=s;D++){const R=[],P=D/s,z=P*(t-e)+e;for(let Y=0;Y<=r;Y++){const j=Y/r,ce=j*f+u,fe=Math.sin(ce),te=Math.cos(ce);G.x=z*fe,G.y=-P*n+w,G.z=z*te,v.push(G.x,G.y,G.z),F.set(fe,O,te).normalize(),_.push(F.x,F.y,F.z),x.push(j,1-P),R.push(E++)}C.push(R)}for(let D=0;D<r;D++)for(let R=0;R<s;R++){const P=C[R][D],z=C[R+1][D],Y=C[R+1][D+1],j=C[R][D+1];(e>0||R!==0)&&(g.push(P,z,j),k+=3),(t>0||R!==s-1)&&(g.push(z,Y,j),k+=3)}p.addGroup(T,k,0),T+=k}function L(F){const G=E,k=new $e,O=new ie;let D=0;const R=F===!0?e:t,P=F===!0?1:-1;for(let Y=1;Y<=r;Y++)v.push(0,w*P,0),_.push(0,P,0),x.push(.5,.5),E++;const z=E;for(let Y=0;Y<=r;Y++){const ce=Y/r*f+u,fe=Math.cos(ce),te=Math.sin(ce);O.x=R*te,O.y=w*P,O.z=R*fe,v.push(O.x,O.y,O.z),_.push(0,P,0),k.x=fe*.5+.5,k.y=te*.5*P+.5,x.push(k.x,k.y),E++}for(let Y=0;Y<r;Y++){const j=G+Y,ce=z+Y;F===!0?g.push(ce,ce+1,j):g.push(ce+1,ce,j),D+=3}p.addGroup(T,D,F===!0?1:2),T+=D}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new Ty(e.radiusTop,e.radiusBottom,e.height,e.radialSegments,e.heightSegments,e.openEnded,e.thetaStart,e.thetaLength)}}class My extends Ty{constructor(e=1,t=1,n=32,r=1,s=!1,o=0,u=Math.PI*2){super(0,e,t,n,r,s,o,u),this.type="ConeGeometry",this.parameters={radius:e,height:t,radialSegments:n,heightSegments:r,openEnded:s,thetaStart:o,thetaLength:u}}static fromJSON(e){return new My(e.radius,e.height,e.radialSegments,e.heightSegments,e.openEnded,e.thetaStart,e.thetaLength)}}class Tf extends wn{constructor(e=[],t=[],n=1,r=0){super(),this.type="PolyhedronGeometry",this.parameters={vertices:e,indices:t,radius:n,detail:r};const s=[],o=[];u(r),p(n),g(),this.setAttribute("position",new tn(s,3)),this.setAttribute("normal",new tn(s.slice(),3)),this.setAttribute("uv",new tn(o,2)),r===0?this.computeVertexNormals():this.normalizeNormals();function u(N){const L=new ie,F=new ie,G=new ie;for(let k=0;k<t.length;k+=3)x(t[k+0],L),x(t[k+1],F),x(t[k+2],G),f(L,F,G,N)}function f(N,L,F,G){const k=G+1,O=[];for(let D=0;D<=k;D++){O[D]=[];const R=N.clone().lerp(F,D/k),P=L.clone().lerp(F,D/k),z=k-D;for(let Y=0;Y<=z;Y++)Y===0&&D===k?O[D][Y]=R:O[D][Y]=R.clone().lerp(P,Y/z)}for(let D=0;D<k;D++)for(let R=0;R<2*(k-D)-1;R++){const P=Math.floor(R/2);R%2===0?(_(O[D][P+1]),_(O[D+1][P]),_(O[D][P])):(_(O[D][P+1]),_(O[D+1][P+1]),_(O[D+1][P]))}}function p(N){const L=new ie;for(let F=0;F<s.length;F+=3)L.x=s[F+0],L.y=s[F+1],L.z=s[F+2],L.normalize().multiplyScalar(N),s[F+0]=L.x,s[F+1]=L.y,s[F+2]=L.z}function g(){const N=new ie;for(let L=0;L<s.length;L+=3){N.x=s[L+0],N.y=s[L+1],N.z=s[L+2];const F=w(N)/2/Math.PI+.5,G=T(N)/Math.PI+.5;o.push(F,1-G)}E(),v()}function v(){for(let N=0;N<o.length;N+=6){const L=o[N+0],F=o[N+2],G=o[N+4],k=Math.max(L,F,G),O=Math.min(L,F,G);k>.9&&O<.1&&(L<.2&&(o[N+0]+=1),F<.2&&(o[N+2]+=1),G<.2&&(o[N+4]+=1))}}function _(N){s.push(N.x,N.y,N.z)}function x(N,L){const F=N*3;L.x=e[F+0],L.y=e[F+1],L.z=e[F+2]}function E(){const N=new ie,L=new ie,F=new ie,G=new ie,k=new $e,O=new $e,D=new $e;for(let R=0,P=0;R<s.length;R+=9,P+=6){N.set(s[R+0],s[R+1],s[R+2]),L.set(s[R+3],s[R+4],s[R+5]),F.set(s[R+6],s[R+7],s[R+8]),k.set(o[P+0],o[P+1]),O.set(o[P+2],o[P+3]),D.set(o[P+4],o[P+5]),G.copy(N).add(L).add(F).divideScalar(3);const z=w(G);C(k,P+0,N,z),C(O,P+2,L,z),C(D,P+4,F,z)}}function C(N,L,F,G){G<0&&N.x===1&&(o[L]=N.x-1),F.x===0&&F.z===0&&(o[L]=G/2/Math.PI+.5)}function w(N){return Math.atan2(N.z,-N.x)}function T(N){return Math.atan2(-N.y,Math.sqrt(N.x*N.x+N.z*N.z))}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new Tf(e.vertices,e.indices,e.radius,e.detail)}}class CS extends Tf{constructor(e=1,t=0){const n=(1+Math.sqrt(5))/2,r=1/n,s=[-1,-1,-1,-1,-1,1,-1,1,-1,-1,1,1,1,-1,-1,1,-1,1,1,1,-1,1,1,1,0,-r,-n,0,-r,n,0,r,-n,0,r,n,-r,-n,0,-r,n,0,r,-n,0,r,n,0,-n,0,-r,n,0,-r,-n,0,r,n,0,r],o=[3,11,7,3,7,15,3,15,13,7,19,17,7,17,6,7,6,15,17,4,8,17,8,10,17,10,6,8,0,16,8,16,2,8,2,10,0,12,1,0,1,18,0,18,16,6,10,2,6,2,13,6,13,15,2,16,18,2,18,3,2,3,13,18,1,9,18,9,11,18,11,3,4,14,12,4,12,0,4,0,8,11,9,5,11,5,19,11,19,7,19,5,14,19,14,4,19,4,17,1,12,14,1,14,5,1,5,9];super(s,o,e,t),this.type="DodecahedronGeometry",this.parameters={radius:e,detail:t}}static fromJSON(e){return new CS(e.radius,e.detail)}}const Bx=new ie,Lx=new ie,m1=new ie,Ox=new eo;class hL extends wn{constructor(e=null,t=1){if(super(),this.type="EdgesGeometry",this.parameters={geometry:e,thresholdAngle:t},e!==null){const r=Math.pow(10,4),s=Math.cos(Gd*t),o=e.getIndex(),u=e.getAttribute("position"),f=o?o.count:u.count,p=[0,0,0],g=["a","b","c"],v=new Array(3),_={},x=[];for(let E=0;E<f;E+=3){o?(p[0]=o.getX(E),p[1]=o.getX(E+1),p[2]=o.getX(E+2)):(p[0]=E,p[1]=E+1,p[2]=E+2);const{a:C,b:w,c:T}=Ox;if(C.fromBufferAttribute(u,p[0]),w.fromBufferAttribute(u,p[1]),T.fromBufferAttribute(u,p[2]),Ox.getNormal(m1),v[0]=`${Math.round(C.x*r)},${Math.round(C.y*r)},${Math.round(C.z*r)}`,v[1]=`${Math.round(w.x*r)},${Math.round(w.y*r)},${Math.round(w.z*r)}`,v[2]=`${Math.round(T.x*r)},${Math.round(T.y*r)},${Math.round(T.z*r)}`,!(v[0]===v[1]||v[1]===v[2]||v[2]===v[0]))for(let N=0;N<3;N++){const L=(N+1)%3,F=v[N],G=v[L],k=Ox[g[N]],O=Ox[g[L]],D=`${F}_${G}`,R=`${G}_${F}`;R in _&&_[R]?(m1.dot(_[R].normal)<=s&&(x.push(k.x,k.y,k.z),x.push(O.x,O.y,O.z)),_[R]=null):D in _||(_[D]={index0:p[N],index1:p[L],normal:m1.clone()})}}for(const E in _)if(_[E]){const{index0:C,index1:w}=_[E];Bx.fromBufferAttribute(u,C),Lx.fromBufferAttribute(u,w),x.push(Bx.x,Bx.y,Bx.z),x.push(Lx.x,Lx.y,Lx.z)}this.setAttribute("position",new tn(x,3))}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}}class Jl{constructor(){this.type="Curve",this.arcLengthDivisions=200,this.needsUpdate=!1,this.cacheArcLengths=null}getPoint(){Ht("Curve: .getPoint() not implemented.")}getPointAt(e,t){const n=this.getUtoTmapping(e);return this.getPoint(n,t)}getPoints(e=5){const t=[];for(let n=0;n<=e;n++)t.push(this.getPoint(n/e));return t}getSpacedPoints(e=5){const t=[];for(let n=0;n<=e;n++)t.push(this.getPointAt(n/e));return t}getLength(){const e=this.getLengths();return e[e.length-1]}getLengths(e=this.arcLengthDivisions){if(this.cacheArcLengths&&this.cacheArcLengths.length===e+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;const t=[];let n,r=this.getPoint(0),s=0;t.push(0);for(let o=1;o<=e;o++)n=this.getPoint(o/e),s+=n.distanceTo(r),t.push(s),r=n;return this.cacheArcLengths=t,t}updateArcLengths(){this.needsUpdate=!0,this.getLengths()}getUtoTmapping(e,t=null){const n=this.getLengths();let r=0;const s=n.length;let o;t?o=t:o=e*n[s-1];let u=0,f=s-1,p;for(;u<=f;)if(r=Math.floor(u+(f-u)/2),p=n[r]-o,p<0)u=r+1;else if(p>0)f=r-1;else{f=r;break}if(r=f,n[r]===o)return r/(s-1);const g=n[r],_=n[r+1]-g,x=(o-g)/_;return(r+x)/(s-1)}getTangent(e,t){let r=e-1e-4,s=e+1e-4;r<0&&(r=0),s>1&&(s=1);const o=this.getPoint(r),u=this.getPoint(s),f=t||(o.isVector2?new $e:new ie);return f.copy(u).sub(o).normalize(),f}getTangentAt(e,t){const n=this.getUtoTmapping(e);return this.getTangent(n,t)}computeFrenetFrames(e,t=!1){const n=new ie,r=[],s=[],o=[],u=new ie,f=new vn;for(let x=0;x<=e;x++){const E=x/e;r[x]=this.getTangentAt(E,new ie)}s[0]=new ie,o[0]=new ie;let p=Number.MAX_VALUE;const g=Math.abs(r[0].x),v=Math.abs(r[0].y),_=Math.abs(r[0].z);g<=p&&(p=g,n.set(1,0,0)),v<=p&&(p=v,n.set(0,1,0)),_<=p&&n.set(0,0,1),u.crossVectors(r[0],n).normalize(),s[0].crossVectors(r[0],u),o[0].crossVectors(r[0],s[0]);for(let x=1;x<=e;x++){if(s[x]=s[x-1].clone(),o[x]=o[x-1].clone(),u.crossVectors(r[x-1],r[x]),u.length()>Number.EPSILON){u.normalize();const E=Math.acos(An(r[x-1].dot(r[x]),-1,1));s[x].applyMatrix4(f.makeRotationAxis(u,E))}o[x].crossVectors(r[x],s[x])}if(t===!0){let x=Math.acos(An(s[0].dot(s[e]),-1,1));x/=e,r[0].dot(u.crossVectors(s[0],s[e]))>0&&(x=-x);for(let E=1;E<=e;E++)s[E].applyMatrix4(f.makeRotationAxis(r[E],x*E)),o[E].crossVectors(r[E],s[E])}return{tangents:r,normals:s,binormals:o}}clone(){return new this.constructor().copy(this)}copy(e){return this.arcLengthDivisions=e.arcLengthDivisions,this}toJSON(){const e={metadata:{version:4.7,type:"Curve",generator:"Curve.toJSON"}};return e.arcLengthDivisions=this.arcLengthDivisions,e.type=this.type,e}fromJSON(e){return this.arcLengthDivisions=e.arcLengthDivisions,this}}class RS extends Jl{constructor(e=0,t=0,n=1,r=1,s=0,o=Math.PI*2,u=!1,f=0){super(),this.isEllipseCurve=!0,this.type="EllipseCurve",this.aX=e,this.aY=t,this.xRadius=n,this.yRadius=r,this.aStartAngle=s,this.aEndAngle=o,this.aClockwise=u,this.aRotation=f}getPoint(e,t=new $e){const n=t,r=Math.PI*2;let s=this.aEndAngle-this.aStartAngle;const o=Math.abs(s)<Number.EPSILON;for(;s<0;)s+=r;for(;s>r;)s-=r;s<Number.EPSILON&&(o?s=0:s=r),this.aClockwise===!0&&!o&&(s===r?s=-r:s=s-r);const u=this.aStartAngle+e*s;let f=this.aX+this.xRadius*Math.cos(u),p=this.aY+this.yRadius*Math.sin(u);if(this.aRotation!==0){const g=Math.cos(this.aRotation),v=Math.sin(this.aRotation),_=f-this.aX,x=p-this.aY;f=_*g-x*v+this.aX,p=_*v+x*g+this.aY}return n.set(f,p)}copy(e){return super.copy(e),this.aX=e.aX,this.aY=e.aY,this.xRadius=e.xRadius,this.yRadius=e.yRadius,this.aStartAngle=e.aStartAngle,this.aEndAngle=e.aEndAngle,this.aClockwise=e.aClockwise,this.aRotation=e.aRotation,this}toJSON(){const e=super.toJSON();return e.aX=this.aX,e.aY=this.aY,e.xRadius=this.xRadius,e.yRadius=this.yRadius,e.aStartAngle=this.aStartAngle,e.aEndAngle=this.aEndAngle,e.aClockwise=this.aClockwise,e.aRotation=this.aRotation,e}fromJSON(e){return super.fromJSON(e),this.aX=e.aX,this.aY=e.aY,this.xRadius=e.xRadius,this.yRadius=e.yRadius,this.aStartAngle=e.aStartAngle,this.aEndAngle=e.aEndAngle,this.aClockwise=e.aClockwise,this.aRotation=e.aRotation,this}}class fL extends RS{constructor(e,t,n,r,s,o){super(e,t,n,n,r,s,o),this.isArcCurve=!0,this.type="ArcCurve"}}function yw(){let i=0,e=0,t=0,n=0;function r(s,o,u,f){i=s,e=u,t=-3*s+3*o-2*u-f,n=2*s-2*o+u+f}return{initCatmullRom:function(s,o,u,f,p){r(o,u,p*(u-s),p*(f-o))},initNonuniformCatmullRom:function(s,o,u,f,p,g,v){let _=(o-s)/p-(u-s)/(p+g)+(u-o)/g,x=(u-o)/g-(f-o)/(g+v)+(f-u)/v;_*=g,x*=g,r(o,u,_,x)},calc:function(s){const o=s*s,u=o*s;return i+e*s+t*o+n*u}}}const Ux=new ie,g1=new yw,v1=new yw,y1=new yw;class dL extends Jl{constructor(e=[],t=!1,n="centripetal",r=.5){super(),this.isCatmullRomCurve3=!0,this.type="CatmullRomCurve3",this.points=e,this.closed=t,this.curveType=n,this.tension=r}getPoint(e,t=new ie){const n=t,r=this.points,s=r.length,o=(s-(this.closed?0:1))*e;let u=Math.floor(o),f=o-u;this.closed?u+=u>0?0:(Math.floor(Math.abs(u)/s)+1)*s:f===0&&u===s-1&&(u=s-2,f=1);let p,g;this.closed||u>0?p=r[(u-1)%s]:(Ux.subVectors(r[0],r[1]).add(r[0]),p=Ux);const v=r[u%s],_=r[(u+1)%s];if(this.closed||u+2<s?g=r[(u+2)%s]:(Ux.subVectors(r[s-1],r[s-2]).add(r[s-1]),g=Ux),this.curveType==="centripetal"||this.curveType==="chordal"){const x=this.curveType==="chordal"?.5:.25;let E=Math.pow(p.distanceToSquared(v),x),C=Math.pow(v.distanceToSquared(_),x),w=Math.pow(_.distanceToSquared(g),x);C<1e-4&&(C=1),E<1e-4&&(E=C),w<1e-4&&(w=C),g1.initNonuniformCatmullRom(p.x,v.x,_.x,g.x,E,C,w),v1.initNonuniformCatmullRom(p.y,v.y,_.y,g.y,E,C,w),y1.initNonuniformCatmullRom(p.z,v.z,_.z,g.z,E,C,w)}else this.curveType==="catmullrom"&&(g1.initCatmullRom(p.x,v.x,_.x,g.x,this.tension),v1.initCatmullRom(p.y,v.y,_.y,g.y,this.tension),y1.initCatmullRom(p.z,v.z,_.z,g.z,this.tension));return n.set(g1.calc(f),v1.calc(f),y1.calc(f)),n}copy(e){super.copy(e),this.points=[];for(let t=0,n=e.points.length;t<n;t++){const r=e.points[t];this.points.push(r.clone())}return this.closed=e.closed,this.curveType=e.curveType,this.tension=e.tension,this}toJSON(){const e=super.toJSON();e.points=[];for(let t=0,n=this.points.length;t<n;t++){const r=this.points[t];e.points.push(r.toArray())}return e.closed=this.closed,e.curveType=this.curveType,e.tension=this.tension,e}fromJSON(e){super.fromJSON(e),this.points=[];for(let t=0,n=e.points.length;t<n;t++){const r=e.points[t];this.points.push(new ie().fromArray(r))}return this.closed=e.closed,this.curveType=e.curveType,this.tension=e.tension,this}}function hD(i,e,t,n,r){const s=(n-e)*.5,o=(r-t)*.5,u=i*i,f=i*u;return(2*t-2*n+s+o)*f+(-3*t+3*n-2*s-o)*u+s*i+t}function NG(i,e){const t=1-i;return t*t*e}function PG(i,e){return 2*(1-i)*i*e}function BG(i,e){return i*i*e}function Dv(i,e,t,n){return NG(i,e)+PG(i,t)+BG(i,n)}function LG(i,e){const t=1-i;return t*t*t*e}function OG(i,e){const t=1-i;return 3*t*t*i*e}function UG(i,e){return 3*(1-i)*i*i*e}function FG(i,e){return i*i*i*e}function Nv(i,e,t,n,r){return LG(i,e)+OG(i,t)+UG(i,n)+FG(i,r)}class _w extends Jl{constructor(e=new $e,t=new $e,n=new $e,r=new $e){super(),this.isCubicBezierCurve=!0,this.type="CubicBezierCurve",this.v0=e,this.v1=t,this.v2=n,this.v3=r}getPoint(e,t=new $e){const n=t,r=this.v0,s=this.v1,o=this.v2,u=this.v3;return n.set(Nv(e,r.x,s.x,o.x,u.x),Nv(e,r.y,s.y,o.y,u.y)),n}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this.v3.copy(e.v3),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e.v3=this.v3.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this.v3.fromArray(e.v3),this}}class pL extends Jl{constructor(e=new ie,t=new ie,n=new ie,r=new ie){super(),this.isCubicBezierCurve3=!0,this.type="CubicBezierCurve3",this.v0=e,this.v1=t,this.v2=n,this.v3=r}getPoint(e,t=new ie){const n=t,r=this.v0,s=this.v1,o=this.v2,u=this.v3;return n.set(Nv(e,r.x,s.x,o.x,u.x),Nv(e,r.y,s.y,o.y,u.y),Nv(e,r.z,s.z,o.z,u.z)),n}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this.v3.copy(e.v3),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e.v3=this.v3.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this.v3.fromArray(e.v3),this}}class xw extends Jl{constructor(e=new $e,t=new $e){super(),this.isLineCurve=!0,this.type="LineCurve",this.v1=e,this.v2=t}getPoint(e,t=new $e){const n=t;return e===1?n.copy(this.v2):(n.copy(this.v2).sub(this.v1),n.multiplyScalar(e).add(this.v1)),n}getPointAt(e,t){return this.getPoint(e,t)}getTangent(e,t=new $e){return t.subVectors(this.v2,this.v1).normalize()}getTangentAt(e,t){return this.getTangent(e,t)}copy(e){return super.copy(e),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}class mL extends Jl{constructor(e=new ie,t=new ie){super(),this.isLineCurve3=!0,this.type="LineCurve3",this.v1=e,this.v2=t}getPoint(e,t=new ie){const n=t;return e===1?n.copy(this.v2):(n.copy(this.v2).sub(this.v1),n.multiplyScalar(e).add(this.v1)),n}getPointAt(e,t){return this.getPoint(e,t)}getTangent(e,t=new ie){return t.subVectors(this.v2,this.v1).normalize()}getTangentAt(e,t){return this.getTangent(e,t)}copy(e){return super.copy(e),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}class bw extends Jl{constructor(e=new $e,t=new $e,n=new $e){super(),this.isQuadraticBezierCurve=!0,this.type="QuadraticBezierCurve",this.v0=e,this.v1=t,this.v2=n}getPoint(e,t=new $e){const n=t,r=this.v0,s=this.v1,o=this.v2;return n.set(Dv(e,r.x,s.x,o.x),Dv(e,r.y,s.y,o.y)),n}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}class Aw extends Jl{constructor(e=new ie,t=new ie,n=new ie){super(),this.isQuadraticBezierCurve3=!0,this.type="QuadraticBezierCurve3",this.v0=e,this.v1=t,this.v2=n}getPoint(e,t=new ie){const n=t,r=this.v0,s=this.v1,o=this.v2;return n.set(Dv(e,r.x,s.x,o.x),Dv(e,r.y,s.y,o.y),Dv(e,r.z,s.z,o.z)),n}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}class Sw extends Jl{constructor(e=[]){super(),this.isSplineCurve=!0,this.type="SplineCurve",this.points=e}getPoint(e,t=new $e){const n=t,r=this.points,s=(r.length-1)*e,o=Math.floor(s),u=s-o,f=r[o===0?o:o-1],p=r[o],g=r[o>r.length-2?r.length-1:o+1],v=r[o>r.length-3?r.length-1:o+2];return n.set(hD(u,f.x,p.x,g.x,v.x),hD(u,f.y,p.y,g.y,v.y)),n}copy(e){super.copy(e),this.points=[];for(let t=0,n=e.points.length;t<n;t++){const r=e.points[t];this.points.push(r.clone())}return this}toJSON(){const e=super.toJSON();e.points=[];for(let t=0,n=this.points.length;t<n;t++){const r=this.points[t];e.points.push(r.toArray())}return e}fromJSON(e){super.fromJSON(e),this.points=[];for(let t=0,n=e.points.length;t<n;t++){const r=e.points[t];this.points.push(new $e().fromArray(r))}return this}}var wA=Object.freeze({__proto__:null,ArcCurve:fL,CatmullRomCurve3:dL,CubicBezierCurve:_w,CubicBezierCurve3:pL,EllipseCurve:RS,LineCurve:xw,LineCurve3:mL,QuadraticBezierCurve:bw,QuadraticBezierCurve3:Aw,SplineCurve:Sw});class gL extends Jl{constructor(){super(),this.type="CurvePath",this.curves=[],this.autoClose=!1}add(e){this.curves.push(e)}closePath(){const e=this.curves[0].getPoint(0),t=this.curves[this.curves.length-1].getPoint(1);if(!e.equals(t)){const n=e.isVector2===!0?"LineCurve":"LineCurve3";this.curves.push(new wA[n](t,e))}return this}getPoint(e,t){const n=e*this.getLength(),r=this.getCurveLengths();let s=0;for(;s<r.length;){if(r[s]>=n){const o=r[s]-n,u=this.curves[s],f=u.getLength(),p=f===0?0:1-o/f;return u.getPointAt(p,t)}s++}return null}getLength(){const e=this.getCurveLengths();return e[e.length-1]}updateArcLengths(){this.needsUpdate=!0,this.cacheLengths=null,this.getCurveLengths()}getCurveLengths(){if(this.cacheLengths&&this.cacheLengths.length===this.curves.length)return this.cacheLengths;const e=[];let t=0;for(let n=0,r=this.curves.length;n<r;n++)t+=this.curves[n].getLength(),e.push(t);return this.cacheLengths=e,e}getSpacedPoints(e=40){const t=[];for(let n=0;n<=e;n++)t.push(this.getPoint(n/e));return this.autoClose&&t.push(t[0]),t}getPoints(e=12){const t=[];let n;for(let r=0,s=this.curves;r<s.length;r++){const o=s[r],u=o.isEllipseCurve?e*2:o.isLineCurve||o.isLineCurve3?1:o.isSplineCurve?e*o.points.length:e,f=o.getPoints(u);for(let p=0;p<f.length;p++){const g=f[p];n&&n.equals(g)||(t.push(g),n=g)}}return this.autoClose&&t.length>1&&!t[t.length-1].equals(t[0])&&t.push(t[0]),t}copy(e){super.copy(e),this.curves=[];for(let t=0,n=e.curves.length;t<n;t++){const r=e.curves[t];this.curves.push(r.clone())}return this.autoClose=e.autoClose,this}toJSON(){const e=super.toJSON();e.autoClose=this.autoClose,e.curves=[];for(let t=0,n=this.curves.length;t<n;t++){const r=this.curves[t];e.curves.push(r.toJSON())}return e}fromJSON(e){super.fromJSON(e),this.autoClose=e.autoClose,this.curves=[];for(let t=0,n=e.curves.length;t<n;t++){const r=e.curves[t];this.curves.push(new wA[r.type]().fromJSON(r))}return this}}class CA extends gL{constructor(e){super(),this.type="Path",this.currentPoint=new $e,e&&this.setFromPoints(e)}setFromPoints(e){this.moveTo(e[0].x,e[0].y);for(let t=1,n=e.length;t<n;t++)this.lineTo(e[t].x,e[t].y);return this}moveTo(e,t){return this.currentPoint.set(e,t),this}lineTo(e,t){const n=new xw(this.currentPoint.clone(),new $e(e,t));return this.curves.push(n),this.currentPoint.set(e,t),this}quadraticCurveTo(e,t,n,r){const s=new bw(this.currentPoint.clone(),new $e(e,t),new $e(n,r));return this.curves.push(s),this.currentPoint.set(n,r),this}bezierCurveTo(e,t,n,r,s,o){const u=new _w(this.currentPoint.clone(),new $e(e,t),new $e(n,r),new $e(s,o));return this.curves.push(u),this.currentPoint.set(s,o),this}splineThru(e){const t=[this.currentPoint.clone()].concat(e),n=new Sw(t);return this.curves.push(n),this.currentPoint.copy(e[e.length-1]),this}arc(e,t,n,r,s,o){const u=this.currentPoint.x,f=this.currentPoint.y;return this.absarc(e+u,t+f,n,r,s,o),this}absarc(e,t,n,r,s,o){return this.absellipse(e,t,n,n,r,s,o),this}ellipse(e,t,n,r,s,o,u,f){const p=this.currentPoint.x,g=this.currentPoint.y;return this.absellipse(e+p,t+g,n,r,s,o,u,f),this}absellipse(e,t,n,r,s,o,u,f){const p=new RS(e,t,n,r,s,o,u,f);if(this.curves.length>0){const v=p.getPoint(0);v.equals(this.currentPoint)||this.lineTo(v.x,v.y)}this.curves.push(p);const g=p.getPoint(1);return this.currentPoint.copy(g),this}copy(e){return super.copy(e),this.currentPoint.copy(e.currentPoint),this}toJSON(){const e=super.toJSON();return e.currentPoint=this.currentPoint.toArray(),e}fromJSON(e){return super.fromJSON(e),this.currentPoint.fromArray(e.currentPoint),this}}class jd extends CA{constructor(e){super(e),this.uuid=bo(),this.type="Shape",this.holes=[]}getPointsHoles(e){const t=[];for(let n=0,r=this.holes.length;n<r;n++)t[n]=this.holes[n].getPoints(e);return t}extractPoints(e){return{shape:this.getPoints(e),holes:this.getPointsHoles(e)}}copy(e){super.copy(e),this.holes=[];for(let t=0,n=e.holes.length;t<n;t++){const r=e.holes[t];this.holes.push(r.clone())}return this}toJSON(){const e=super.toJSON();e.uuid=this.uuid,e.holes=[];for(let t=0,n=this.holes.length;t<n;t++){const r=this.holes[t];e.holes.push(r.toJSON())}return e}fromJSON(e){super.fromJSON(e),this.uuid=e.uuid,this.holes=[];for(let t=0,n=e.holes.length;t<n;t++){const r=e.holes[t];this.holes.push(new CA().fromJSON(r))}return this}}function kG(i,e,t=2){const n=e&&e.length,r=n?e[0]*t:i.length;let s=vL(i,0,r,t,!0);const o=[];if(!s||s.next===s.prev)return o;let u,f,p;if(n&&(s=jG(i,e,s,t)),i.length>80*t){u=i[0],f=i[1];let g=u,v=f;for(let _=t;_<r;_+=t){const x=i[_],E=i[_+1];x<u&&(u=x),E<f&&(f=E),x>g&&(g=x),E>v&&(v=E)}p=Math.max(g-u,v-f),p=p!==0?32767/p:0}return Qv(s,o,t,u,f,p,0),o}function vL(i,e,t,n,r){let s;if(r===t8(i,e,t,n)>0)for(let o=e;o<t;o+=n)s=fD(o/n|0,i[o],i[o+1],s);else for(let o=t-n;o>=e;o-=n)s=fD(o/n|0,i[o],i[o+1],s);return s&&mg(s,s.next)&&($v(s),s=s.next),s}function tp(i,e){if(!i)return i;e||(e=i);let t=i,n;do if(n=!1,!t.steiner&&(mg(t,t.next)||Ar(t.prev,t,t.next)===0)){if($v(t),t=e=t.prev,t===t.next)break;n=!0}else t=t.next;while(n||t!==e);return e}function Qv(i,e,t,n,r,s,o){if(!i)return;!o&&s&&JG(i,n,r,s);let u=i;for(;i.prev!==i.next;){const f=i.prev,p=i.next;if(s?VG(i,n,r,s):zG(i)){e.push(f.i,i.i,p.i),$v(i),i=p.next,u=p.next;continue}if(i=p,i===u){o?o===1?(i=HG(tp(i),e),Qv(i,e,t,n,r,s,2)):o===2&&GG(i,e,t,n,r,s):Qv(tp(i),e,t,n,r,s,1);break}}}function zG(i){const e=i.prev,t=i,n=i.next;if(Ar(e,t,n)>=0)return!1;const r=e.x,s=t.x,o=n.x,u=e.y,f=t.y,p=n.y,g=Math.min(r,s,o),v=Math.min(u,f,p),_=Math.max(r,s,o),x=Math.max(u,f,p);let E=n.next;for(;E!==e;){if(E.x>=g&&E.x<=_&&E.y>=v&&E.y<=x&&vv(r,u,s,f,o,p,E.x,E.y)&&Ar(E.prev,E,E.next)>=0)return!1;E=E.next}return!0}function VG(i,e,t,n){const r=i.prev,s=i,o=i.next;if(Ar(r,s,o)>=0)return!1;const u=r.x,f=s.x,p=o.x,g=r.y,v=s.y,_=o.y,x=Math.min(u,f,p),E=Math.min(g,v,_),C=Math.max(u,f,p),w=Math.max(g,v,_),T=DT(x,E,e,t,n),N=DT(C,w,e,t,n);let L=i.prevZ,F=i.nextZ;for(;L&&L.z>=T&&F&&F.z<=N;){if(L.x>=x&&L.x<=C&&L.y>=E&&L.y<=w&&L!==r&&L!==o&&vv(u,g,f,v,p,_,L.x,L.y)&&Ar(L.prev,L,L.next)>=0||(L=L.prevZ,F.x>=x&&F.x<=C&&F.y>=E&&F.y<=w&&F!==r&&F!==o&&vv(u,g,f,v,p,_,F.x,F.y)&&Ar(F.prev,F,F.next)>=0))return!1;F=F.nextZ}for(;L&&L.z>=T;){if(L.x>=x&&L.x<=C&&L.y>=E&&L.y<=w&&L!==r&&L!==o&&vv(u,g,f,v,p,_,L.x,L.y)&&Ar(L.prev,L,L.next)>=0)return!1;L=L.prevZ}for(;F&&F.z<=N;){if(F.x>=x&&F.x<=C&&F.y>=E&&F.y<=w&&F!==r&&F!==o&&vv(u,g,f,v,p,_,F.x,F.y)&&Ar(F.prev,F,F.next)>=0)return!1;F=F.nextZ}return!0}function HG(i,e){let t=i;do{const n=t.prev,r=t.next.next;!mg(n,r)&&_L(n,t,t.next,r)&&Zv(n,r)&&Zv(r,n)&&(e.push(n.i,t.i,r.i),$v(t),$v(t.next),t=i=r),t=t.next}while(t!==i);return tp(t)}function GG(i,e,t,n,r,s){let o=i;do{let u=o.next.next;for(;u!==o.prev;){if(o.i!==u.i&&ZG(o,u)){let f=xL(o,u);o=tp(o,o.next),f=tp(f,f.next),Qv(o,e,t,n,r,s,0),Qv(f,e,t,n,r,s,0);return}u=u.next}o=o.next}while(o!==i)}function jG(i,e,t,n){const r=[];for(let s=0,o=e.length;s<o;s++){const u=e[s]*n,f=s<o-1?e[s+1]*n:i.length,p=vL(i,u,f,n,!1);p===p.next&&(p.steiner=!0),r.push(QG(p))}r.sort(WG);for(let s=0;s<r.length;s++)t=qG(r[s],t);return t}function WG(i,e){let t=i.x-e.x;if(t===0&&(t=i.y-e.y,t===0)){const n=(i.next.y-i.y)/(i.next.x-i.x),r=(e.next.y-e.y)/(e.next.x-e.x);t=n-r}return t}function qG(i,e){const t=XG(i,e);if(!t)return e;const n=xL(t,i);return tp(n,n.next),tp(t,t.next)}function XG(i,e){let t=e;const n=i.x,r=i.y;let s=-1/0,o;if(mg(i,t))return t;do{if(mg(i,t.next))return t.next;if(r<=t.y&&r>=t.next.y&&t.next.y!==t.y){const v=t.x+(r-t.y)*(t.next.x-t.x)/(t.next.y-t.y);if(v<=n&&v>s&&(s=v,o=t.x<t.next.x?t:t.next,v===n))return o}t=t.next}while(t!==e);if(!o)return null;const u=o,f=o.x,p=o.y;let g=1/0;t=o;do{if(n>=t.x&&t.x>=f&&n!==t.x&&yL(r<p?n:s,r,f,p,r<p?s:n,r,t.x,t.y)){const v=Math.abs(r-t.y)/(n-t.x);Zv(t,i)&&(v<g||v===g&&(t.x>o.x||t.x===o.x&&YG(o,t)))&&(o=t,g=v)}t=t.next}while(t!==u);return o}function YG(i,e){return Ar(i.prev,i,e.prev)<0&&Ar(e.next,i,i.next)<0}function JG(i,e,t,n){let r=i;do r.z===0&&(r.z=DT(r.x,r.y,e,t,n)),r.prevZ=r.prev,r.nextZ=r.next,r=r.next;while(r!==i);r.prevZ.nextZ=null,r.prevZ=null,KG(r)}function KG(i){let e,t=1;do{let n=i,r;i=null;let s=null;for(e=0;n;){e++;let o=n,u=0;for(let p=0;p<t&&(u++,o=o.nextZ,!!o);p++);let f=t;for(;u>0||f>0&&o;)u!==0&&(f===0||!o||n.z<=o.z)?(r=n,n=n.nextZ,u--):(r=o,o=o.nextZ,f--),s?s.nextZ=r:i=r,r.prevZ=s,s=r;n=o}s.nextZ=null,t*=2}while(e>1);return i}function DT(i,e,t,n,r){return i=(i-t)*r|0,e=(e-n)*r|0,i=(i|i<<8)&16711935,i=(i|i<<4)&252645135,i=(i|i<<2)&858993459,i=(i|i<<1)&1431655765,e=(e|e<<8)&16711935,e=(e|e<<4)&252645135,e=(e|e<<2)&858993459,e=(e|e<<1)&1431655765,i|e<<1}function QG(i){let e=i,t=i;do(e.x<t.x||e.x===t.x&&e.y<t.y)&&(t=e),e=e.next;while(e!==i);return t}function yL(i,e,t,n,r,s,o,u){return(r-o)*(e-u)>=(i-o)*(s-u)&&(i-o)*(n-u)>=(t-o)*(e-u)&&(t-o)*(s-u)>=(r-o)*(n-u)}function vv(i,e,t,n,r,s,o,u){return!(i===o&&e===u)&&yL(i,e,t,n,r,s,o,u)}function ZG(i,e){return i.next.i!==e.i&&i.prev.i!==e.i&&!$G(i,e)&&(Zv(i,e)&&Zv(e,i)&&e8(i,e)&&(Ar(i.prev,i,e.prev)||Ar(i,e.prev,e))||mg(i,e)&&Ar(i.prev,i,i.next)>0&&Ar(e.prev,e,e.next)>0)}function Ar(i,e,t){return(e.y-i.y)*(t.x-e.x)-(e.x-i.x)*(t.y-e.y)}function mg(i,e){return i.x===e.x&&i.y===e.y}function _L(i,e,t,n){const r=kx(Ar(i,e,t)),s=kx(Ar(i,e,n)),o=kx(Ar(t,n,i)),u=kx(Ar(t,n,e));return!!(r!==s&&o!==u||r===0&&Fx(i,t,e)||s===0&&Fx(i,n,e)||o===0&&Fx(t,i,n)||u===0&&Fx(t,e,n))}function Fx(i,e,t){return e.x<=Math.max(i.x,t.x)&&e.x>=Math.min(i.x,t.x)&&e.y<=Math.max(i.y,t.y)&&e.y>=Math.min(i.y,t.y)}function kx(i){return i>0?1:i<0?-1:0}function $G(i,e){let t=i;do{if(t.i!==i.i&&t.next.i!==i.i&&t.i!==e.i&&t.next.i!==e.i&&_L(t,t.next,i,e))return!0;t=t.next}while(t!==i);return!1}function Zv(i,e){return Ar(i.prev,i,i.next)<0?Ar(i,e,i.next)>=0&&Ar(i,i.prev,e)>=0:Ar(i,e,i.prev)<0||Ar(i,i.next,e)<0}function e8(i,e){let t=i,n=!1;const r=(i.x+e.x)/2,s=(i.y+e.y)/2;do t.y>s!=t.next.y>s&&t.next.y!==t.y&&r<(t.next.x-t.x)*(s-t.y)/(t.next.y-t.y)+t.x&&(n=!n),t=t.next;while(t!==i);return n}function xL(i,e){const t=NT(i.i,i.x,i.y),n=NT(e.i,e.x,e.y),r=i.next,s=e.prev;return i.next=e,e.prev=i,t.next=r,r.prev=t,n.next=t,t.prev=n,s.next=n,n.prev=s,n}function fD(i,e,t,n){const r=NT(i,e,t);return n?(r.next=n.next,r.prev=n,n.next.prev=r,n.next=r):(r.prev=r,r.next=r),r}function $v(i){i.next.prev=i.prev,i.prev.next=i.next,i.prevZ&&(i.prevZ.nextZ=i.nextZ),i.nextZ&&(i.nextZ.prevZ=i.prevZ)}function NT(i,e,t){return{i,x:e,y:t,prev:null,next:null,z:0,prevZ:null,nextZ:null,steiner:!1}}function t8(i,e,t,n){let r=0;for(let s=e,o=t-n;s<t;s+=n)r+=(i[o]-i[s])*(i[s+1]+i[o+1]),o=s;return r}class n8{static triangulate(e,t,n=2){return kG(e,t,n)}}class zl{static area(e){const t=e.length;let n=0;for(let r=t-1,s=0;s<t;r=s++)n+=e[r].x*e[s].y-e[s].x*e[r].y;return n*.5}static isClockWise(e){return zl.area(e)<0}static triangulateShape(e,t){const n=[],r=[],s=[];dD(e),pD(n,e);let o=e.length;t.forEach(dD);for(let f=0;f<t.length;f++)r.push(o),o+=t[f].length,pD(n,t[f]);const u=n8.triangulate(n,r);for(let f=0;f<u.length;f+=3)s.push(u.slice(f,f+3));return s}}function dD(i){const e=i.length;e>2&&i[e-1].equals(i[0])&&i.pop()}function pD(i,e){for(let t=0;t<e.length;t++)i.push(e[t].x),i.push(e[t].y)}class IS extends wn{constructor(e=new jd([new $e(.5,.5),new $e(-.5,.5),new $e(-.5,-.5),new $e(.5,-.5)]),t={}){super(),this.type="ExtrudeGeometry",this.parameters={shapes:e,options:t},e=Array.isArray(e)?e:[e];const n=this,r=[],s=[];for(let u=0,f=e.length;u<f;u++){const p=e[u];o(p)}this.setAttribute("position",new tn(r,3)),this.setAttribute("uv",new tn(s,2)),this.computeVertexNormals();function o(u){const f=[],p=t.curveSegments!==void 0?t.curveSegments:12,g=t.steps!==void 0?t.steps:1,v=t.depth!==void 0?t.depth:1;let _=t.bevelEnabled!==void 0?t.bevelEnabled:!0,x=t.bevelThickness!==void 0?t.bevelThickness:.2,E=t.bevelSize!==void 0?t.bevelSize:x-.1,C=t.bevelOffset!==void 0?t.bevelOffset:0,w=t.bevelSegments!==void 0?t.bevelSegments:3;const T=t.extrudePath,N=t.UVGenerator!==void 0?t.UVGenerator:i8;let L,F=!1,G,k,O,D;if(T){L=T.getSpacedPoints(g),F=!0,_=!1;const qe=T.isCatmullRomCurve3?T.closed:!1;G=T.computeFrenetFrames(g,qe),k=new ie,O=new ie,D=new ie}_||(w=0,x=0,E=0,C=0);const R=u.extractPoints(p);let P=R.shape;const z=R.holes;if(!zl.isClockWise(P)){P=P.reverse();for(let qe=0,rt=z.length;qe<rt;qe++){const Je=z[qe];zl.isClockWise(Je)&&(z[qe]=Je.reverse())}}function j(qe){const Je=10000000000000001e-36;let xt=qe[0];for(let re=1;re<=qe.length;re++){const Lt=re%qe.length,vt=qe[Lt],Qt=vt.x-xt.x,bt=vt.y-xt.y,ee=Qt*Qt+bt*bt,q=Math.max(Math.abs(vt.x),Math.abs(vt.y),Math.abs(xt.x),Math.abs(xt.y)),ge=Je*q*q;if(ee<=ge){qe.splice(Lt,1),re--;continue}xt=vt}}j(P),z.forEach(j);const ce=z.length,fe=P;for(let qe=0;qe<ce;qe++){const rt=z[qe];P=P.concat(rt)}function te(qe,rt,Je){return rt||cn("ExtrudeGeometry: vec does not exist"),qe.clone().addScaledVector(rt,Je)}const se=P.length;function Ae(qe,rt,Je){let xt,re,Lt;const vt=qe.x-rt.x,Qt=qe.y-rt.y,bt=Je.x-qe.x,ee=Je.y-qe.y,q=vt*vt+Qt*Qt,ge=vt*ee-Qt*bt;if(Math.abs(ge)>Number.EPSILON){const Fe=Math.sqrt(q),Xe=Math.sqrt(bt*bt+ee*ee),Ue=rt.x-Qt/Fe,Ft=rt.y+vt/Fe,Ct=Je.x-ee/Xe,Xt=Je.y+bt/Xe,an=((Ct-Ue)*ee-(Xt-Ft)*bt)/(vt*ee-Qt*bt);xt=Ue+vt*an-qe.x,re=Ft+Qt*an-qe.y;const tt=xt*xt+re*re;if(tt<=2)return new $e(xt,re);Lt=Math.sqrt(tt/2)}else{let Fe=!1;vt>Number.EPSILON?bt>Number.EPSILON&&(Fe=!0):vt<-Number.EPSILON?bt<-Number.EPSILON&&(Fe=!0):Math.sign(Qt)===Math.sign(ee)&&(Fe=!0),Fe?(xt=-Qt,re=vt,Lt=Math.sqrt(q)):(xt=vt,re=Qt,Lt=Math.sqrt(q/2))}return new $e(xt/Lt,re/Lt)}const Pe=[];for(let qe=0,rt=fe.length,Je=rt-1,xt=qe+1;qe<rt;qe++,Je++,xt++)Je===rt&&(Je=0),xt===rt&&(xt=0),Pe[qe]=Ae(fe[qe],fe[Je],fe[xt]);const Re=[];let $,ae=Pe.concat();for(let qe=0,rt=ce;qe<rt;qe++){const Je=z[qe];$=[];for(let xt=0,re=Je.length,Lt=re-1,vt=xt+1;xt<re;xt++,Lt++,vt++)Lt===re&&(Lt=0),vt===re&&(vt=0),$[xt]=Ae(Je[xt],Je[Lt],Je[vt]);Re.push($),ae=ae.concat($)}let Se;if(w===0)Se=zl.triangulateShape(fe,z);else{const qe=[],rt=[];for(let Je=0;Je<w;Je++){const xt=Je/w,re=x*Math.cos(xt*Math.PI/2),Lt=E*Math.sin(xt*Math.PI/2)+C;for(let vt=0,Qt=fe.length;vt<Qt;vt++){const bt=te(fe[vt],Pe[vt],Lt);_t(bt.x,bt.y,-re),xt===0&&qe.push(bt)}for(let vt=0,Qt=ce;vt<Qt;vt++){const bt=z[vt];$=Re[vt];const ee=[];for(let q=0,ge=bt.length;q<ge;q++){const Fe=te(bt[q],$[q],Lt);_t(Fe.x,Fe.y,-re),xt===0&&ee.push(Fe)}xt===0&&rt.push(ee)}}Se=zl.triangulateShape(qe,rt)}const ke=Se.length,dt=E+C;for(let qe=0;qe<se;qe++){const rt=_?te(P[qe],ae[qe],dt):P[qe];F?(O.copy(G.normals[0]).multiplyScalar(rt.x),k.copy(G.binormals[0]).multiplyScalar(rt.y),D.copy(L[0]).add(O).add(k),_t(D.x,D.y,D.z)):_t(rt.x,rt.y,0)}for(let qe=1;qe<=g;qe++)for(let rt=0;rt<se;rt++){const Je=_?te(P[rt],ae[rt],dt):P[rt];F?(O.copy(G.normals[qe]).multiplyScalar(Je.x),k.copy(G.binormals[qe]).multiplyScalar(Je.y),D.copy(L[qe]).add(O).add(k),_t(D.x,D.y,D.z)):_t(Je.x,Je.y,v/g*qe)}for(let qe=w-1;qe>=0;qe--){const rt=qe/w,Je=x*Math.cos(rt*Math.PI/2),xt=E*Math.sin(rt*Math.PI/2)+C;for(let re=0,Lt=fe.length;re<Lt;re++){const vt=te(fe[re],Pe[re],xt);_t(vt.x,vt.y,v+Je)}for(let re=0,Lt=z.length;re<Lt;re++){const vt=z[re];$=Re[re];for(let Qt=0,bt=vt.length;Qt<bt;Qt++){const ee=te(vt[Qt],$[Qt],xt);F?_t(ee.x,ee.y+L[g-1].y,L[g-1].x+Je):_t(ee.x,ee.y,v+Je)}}}ve(),Le();function ve(){const qe=r.length/3;if(_){let rt=0,Je=se*rt;for(let xt=0;xt<ke;xt++){const re=Se[xt];Dt(re[2]+Je,re[1]+Je,re[0]+Je)}rt=g+w*2,Je=se*rt;for(let xt=0;xt<ke;xt++){const re=Se[xt];Dt(re[0]+Je,re[1]+Je,re[2]+Je)}}else{for(let rt=0;rt<ke;rt++){const Je=Se[rt];Dt(Je[2],Je[1],Je[0])}for(let rt=0;rt<ke;rt++){const Je=Se[rt];Dt(Je[0]+se*g,Je[1]+se*g,Je[2]+se*g)}}n.addGroup(qe,r.length/3-qe,0)}function Le(){const qe=r.length/3;let rt=0;lt(fe,rt),rt+=fe.length;for(let Je=0,xt=z.length;Je<xt;Je++){const re=z[Je];lt(re,rt),rt+=re.length}n.addGroup(qe,r.length/3-qe,1)}function lt(qe,rt){let Je=qe.length;for(;--Je>=0;){const xt=Je;let re=Je-1;re<0&&(re=qe.length-1);for(let Lt=0,vt=g+w*2;Lt<vt;Lt++){const Qt=se*Lt,bt=se*(Lt+1),ee=rt+xt+Qt,q=rt+re+Qt,ge=rt+re+bt,Fe=rt+xt+bt;qt(ee,q,ge,Fe)}}}function _t(qe,rt,Je){f.push(qe),f.push(rt),f.push(Je)}function Dt(qe,rt,Je){un(qe),un(rt),un(Je);const xt=r.length/3,re=N.generateTopUV(n,r,xt-3,xt-2,xt-1);Yt(re[0]),Yt(re[1]),Yt(re[2])}function qt(qe,rt,Je,xt){un(qe),un(rt),un(xt),un(rt),un(Je),un(xt);const re=r.length/3,Lt=N.generateSideWallUV(n,r,re-6,re-3,re-2,re-1);Yt(Lt[0]),Yt(Lt[1]),Yt(Lt[3]),Yt(Lt[1]),Yt(Lt[2]),Yt(Lt[3])}function un(qe){r.push(f[qe*3+0]),r.push(f[qe*3+1]),r.push(f[qe*3+2])}function Yt(qe){s.push(qe.x),s.push(qe.y)}}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}toJSON(){const e=super.toJSON(),t=this.parameters.shapes,n=this.parameters.options;return r8(t,n,e)}static fromJSON(e,t){const n=[];for(let s=0,o=e.shapes.length;s<o;s++){const u=t[e.shapes[s]];n.push(u)}const r=e.options.extrudePath;return r!==void 0&&(e.options.extrudePath=new wA[r.type]().fromJSON(r)),new IS(n,e.options)}}const i8={generateTopUV:function(i,e,t,n,r){const s=e[t*3],o=e[t*3+1],u=e[n*3],f=e[n*3+1],p=e[r*3],g=e[r*3+1];return[new $e(s,o),new $e(u,f),new $e(p,g)]},generateSideWallUV:function(i,e,t,n,r,s){const o=e[t*3],u=e[t*3+1],f=e[t*3+2],p=e[n*3],g=e[n*3+1],v=e[n*3+2],_=e[r*3],x=e[r*3+1],E=e[r*3+2],C=e[s*3],w=e[s*3+1],T=e[s*3+2];return Math.abs(u-g)<Math.abs(o-p)?[new $e(o,1-f),new $e(p,1-v),new $e(_,1-E),new $e(C,1-T)]:[new $e(u,1-f),new $e(g,1-v),new $e(x,1-E),new $e(w,1-T)]}};function r8(i,e,t){if(t.shapes=[],Array.isArray(i))for(let n=0,r=i.length;n<r;n++){const s=i[n];t.shapes.push(s.uuid)}else t.shapes.push(i.uuid);return t.options=Object.assign({},e),e.extrudePath!==void 0&&(t.options.extrudePath=e.extrudePath.toJSON()),t}class wy extends Tf{constructor(e=1,t=0){const n=(1+Math.sqrt(5))/2,r=[-1,n,0,1,n,0,-1,-n,0,1,-n,0,0,-1,n,0,1,n,0,-1,-n,0,1,-n,n,0,-1,n,0,1,-n,0,-1,-n,0,1],s=[0,11,5,0,5,1,0,1,7,0,7,10,0,10,11,1,5,9,5,11,4,11,10,2,10,7,6,7,1,8,3,9,4,3,4,2,3,2,6,3,6,8,3,8,9,4,9,5,2,4,11,6,2,10,8,6,7,9,8,1];super(r,s,e,t),this.type="IcosahedronGeometry",this.parameters={radius:e,detail:t}}static fromJSON(e){return new wy(e.radius,e.detail)}}class DS extends wn{constructor(e=[new $e(0,-.5),new $e(.5,0),new $e(0,.5)],t=12,n=0,r=Math.PI*2){super(),this.type="LatheGeometry",this.parameters={points:e,segments:t,phiStart:n,phiLength:r},t=Math.floor(t),r=An(r,0,Math.PI*2);const s=[],o=[],u=[],f=[],p=[],g=1/t,v=new ie,_=new $e,x=new ie,E=new ie,C=new ie;let w=0,T=0;for(let N=0;N<=e.length-1;N++)switch(N){case 0:w=e[N+1].x-e[N].x,T=e[N+1].y-e[N].y,x.x=T*1,x.y=-w,x.z=T*0,C.copy(x),x.normalize(),f.push(x.x,x.y,x.z);break;case e.length-1:f.push(C.x,C.y,C.z);break;default:w=e[N+1].x-e[N].x,T=e[N+1].y-e[N].y,x.x=T*1,x.y=-w,x.z=T*0,E.copy(x),x.x+=C.x,x.y+=C.y,x.z+=C.z,x.normalize(),f.push(x.x,x.y,x.z),C.copy(E)}for(let N=0;N<=t;N++){const L=n+N*g*r,F=Math.sin(L),G=Math.cos(L);for(let k=0;k<=e.length-1;k++){v.x=e[k].x*F,v.y=e[k].y,v.z=e[k].x*G,o.push(v.x,v.y,v.z),_.x=N/t,_.y=k/(e.length-1),u.push(_.x,_.y);const O=f[3*k+0]*F,D=f[3*k+1],R=f[3*k+0]*G;p.push(O,D,R)}}for(let N=0;N<t;N++)for(let L=0;L<e.length-1;L++){const F=L+N*e.length,G=F,k=F+e.length,O=F+e.length+1,D=F+1;s.push(G,k,D),s.push(O,D,k)}this.setIndex(s),this.setAttribute("position",new tn(o,3)),this.setAttribute("uv",new tn(u,2)),this.setAttribute("normal",new tn(p,3))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new DS(e.points,e.segments,e.phiStart,e.phiLength)}}class Cy extends Tf{constructor(e=1,t=0){const n=[1,0,0,-1,0,0,0,1,0,0,-1,0,0,0,1,0,0,-1],r=[0,2,4,0,4,3,0,3,5,0,5,2,1,2,5,1,5,3,1,3,4,1,4,2];super(n,r,e,t),this.type="OctahedronGeometry",this.parameters={radius:e,detail:t}}static fromJSON(e){return new Cy(e.radius,e.detail)}}class Xu extends wn{constructor(e=1,t=1,n=1,r=1){super(),this.type="PlaneGeometry",this.parameters={width:e,height:t,widthSegments:n,heightSegments:r};const s=e/2,o=t/2,u=Math.floor(n),f=Math.floor(r),p=u+1,g=f+1,v=e/u,_=t/f,x=[],E=[],C=[],w=[];for(let T=0;T<g;T++){const N=T*_-o;for(let L=0;L<p;L++){const F=L*v-s;E.push(F,-N,0),C.push(0,0,1),w.push(L/u),w.push(1-T/f)}}for(let T=0;T<f;T++)for(let N=0;N<u;N++){const L=N+p*T,F=N+p*(T+1),G=N+1+p*(T+1),k=N+1+p*T;x.push(L,F,k),x.push(F,G,k)}this.setIndex(x),this.setAttribute("position",new tn(E,3)),this.setAttribute("normal",new tn(C,3)),this.setAttribute("uv",new tn(w,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new Xu(e.width,e.height,e.widthSegments,e.heightSegments)}}class NS extends wn{constructor(e=.5,t=1,n=32,r=1,s=0,o=Math.PI*2){super(),this.type="RingGeometry",this.parameters={innerRadius:e,outerRadius:t,thetaSegments:n,phiSegments:r,thetaStart:s,thetaLength:o},n=Math.max(3,n),r=Math.max(1,r);const u=[],f=[],p=[],g=[];let v=e;const _=(t-e)/r,x=new ie,E=new $e;for(let C=0;C<=r;C++){for(let w=0;w<=n;w++){const T=s+w/n*o;x.x=v*Math.cos(T),x.y=v*Math.sin(T),f.push(x.x,x.y,x.z),p.push(0,0,1),E.x=(x.x/t+1)/2,E.y=(x.y/t+1)/2,g.push(E.x,E.y)}v+=_}for(let C=0;C<r;C++){const w=C*(n+1);for(let T=0;T<n;T++){const N=T+w,L=N,F=N+n+1,G=N+n+2,k=N+1;u.push(L,F,k),u.push(F,G,k)}}this.setIndex(u),this.setAttribute("position",new tn(f,3)),this.setAttribute("normal",new tn(p,3)),this.setAttribute("uv",new tn(g,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new NS(e.innerRadius,e.outerRadius,e.thetaSegments,e.phiSegments,e.thetaStart,e.thetaLength)}}class PS extends wn{constructor(e=new jd([new $e(0,.5),new $e(-.5,-.5),new $e(.5,-.5)]),t=12){super(),this.type="ShapeGeometry",this.parameters={shapes:e,curveSegments:t};const n=[],r=[],s=[],o=[];let u=0,f=0;if(Array.isArray(e)===!1)p(e);else for(let g=0;g<e.length;g++)p(e[g]),this.addGroup(u,f,g),u+=f,f=0;this.setIndex(n),this.setAttribute("position",new tn(r,3)),this.setAttribute("normal",new tn(s,3)),this.setAttribute("uv",new tn(o,2));function p(g){const v=r.length/3,_=g.extractPoints(t);let x=_.shape;const E=_.holes;zl.isClockWise(x)===!1&&(x=x.reverse());for(let w=0,T=E.length;w<T;w++){const N=E[w];zl.isClockWise(N)===!0&&(E[w]=N.reverse())}const C=zl.triangulateShape(x,E);for(let w=0,T=E.length;w<T;w++){const N=E[w];x=x.concat(N)}for(let w=0,T=x.length;w<T;w++){const N=x[w];r.push(N.x,N.y,0),s.push(0,0,1),o.push(N.x,N.y)}for(let w=0,T=C.length;w<T;w++){const N=C[w],L=N[0]+v,F=N[1]+v,G=N[2]+v;n.push(L,F,G),f+=3}}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}toJSON(){const e=super.toJSON(),t=this.parameters.shapes;return s8(t,e)}static fromJSON(e,t){const n=[];for(let r=0,s=e.shapes.length;r<s;r++){const o=t[e.shapes[r]];n.push(o)}return new PS(n,e.curveSegments)}}function s8(i,e){if(e.shapes=[],Array.isArray(i))for(let t=0,n=i.length;t<n;t++){const r=i[t];e.shapes.push(r.uuid)}else e.shapes.push(i.uuid);return e}class Ry extends wn{constructor(e=1,t=32,n=16,r=0,s=Math.PI*2,o=0,u=Math.PI){super(),this.type="SphereGeometry",this.parameters={radius:e,widthSegments:t,heightSegments:n,phiStart:r,phiLength:s,thetaStart:o,thetaLength:u},t=Math.max(3,Math.floor(t)),n=Math.max(2,Math.floor(n));const f=Math.min(o+u,Math.PI);let p=0;const g=[],v=new ie,_=new ie,x=[],E=[],C=[],w=[];for(let T=0;T<=n;T++){const N=[],L=T/n;let F=0;T===0&&o===0?F=.5/t:T===n&&f===Math.PI&&(F=-.5/t);for(let G=0;G<=t;G++){const k=G/t;v.x=-e*Math.cos(r+k*s)*Math.sin(o+L*u),v.y=e*Math.cos(o+L*u),v.z=e*Math.sin(r+k*s)*Math.sin(o+L*u),E.push(v.x,v.y,v.z),_.copy(v).normalize(),C.push(_.x,_.y,_.z),w.push(k+F,1-L),N.push(p++)}g.push(N)}for(let T=0;T<n;T++)for(let N=0;N<t;N++){const L=g[T][N+1],F=g[T][N],G=g[T+1][N],k=g[T+1][N+1];(T!==0||o>0)&&x.push(L,F,k),(T!==n-1||f<Math.PI)&&x.push(F,G,k)}this.setIndex(x),this.setAttribute("position",new tn(E,3)),this.setAttribute("normal",new tn(C,3)),this.setAttribute("uv",new tn(w,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new Ry(e.radius,e.widthSegments,e.heightSegments,e.phiStart,e.phiLength,e.thetaStart,e.thetaLength)}}class BS extends Tf{constructor(e=1,t=0){const n=[1,1,1,-1,-1,1,-1,1,-1,1,-1,-1],r=[2,1,0,0,3,2,1,3,0,2,3,1];super(n,r,e,t),this.type="TetrahedronGeometry",this.parameters={radius:e,detail:t}}static fromJSON(e){return new BS(e.radius,e.detail)}}class LS extends wn{constructor(e=1,t=.4,n=12,r=48,s=Math.PI*2){super(),this.type="TorusGeometry",this.parameters={radius:e,tube:t,radialSegments:n,tubularSegments:r,arc:s},n=Math.floor(n),r=Math.floor(r);const o=[],u=[],f=[],p=[],g=new ie,v=new ie,_=new ie;for(let x=0;x<=n;x++)for(let E=0;E<=r;E++){const C=E/r*s,w=x/n*Math.PI*2;v.x=(e+t*Math.cos(w))*Math.cos(C),v.y=(e+t*Math.cos(w))*Math.sin(C),v.z=t*Math.sin(w),u.push(v.x,v.y,v.z),g.x=e*Math.cos(C),g.y=e*Math.sin(C),_.subVectors(v,g).normalize(),f.push(_.x,_.y,_.z),p.push(E/r),p.push(x/n)}for(let x=1;x<=n;x++)for(let E=1;E<=r;E++){const C=(r+1)*x+E-1,w=(r+1)*(x-1)+E-1,T=(r+1)*(x-1)+E,N=(r+1)*x+E;o.push(C,w,N),o.push(w,T,N)}this.setIndex(o),this.setAttribute("position",new tn(u,3)),this.setAttribute("normal",new tn(f,3)),this.setAttribute("uv",new tn(p,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new LS(e.radius,e.tube,e.radialSegments,e.tubularSegments,e.arc)}}class OS extends wn{constructor(e=1,t=.4,n=64,r=8,s=2,o=3){super(),this.type="TorusKnotGeometry",this.parameters={radius:e,tube:t,tubularSegments:n,radialSegments:r,p:s,q:o},n=Math.floor(n),r=Math.floor(r);const u=[],f=[],p=[],g=[],v=new ie,_=new ie,x=new ie,E=new ie,C=new ie,w=new ie,T=new ie;for(let L=0;L<=n;++L){const F=L/n*s*Math.PI*2;N(F,s,o,e,x),N(F+.01,s,o,e,E),w.subVectors(E,x),T.addVectors(E,x),C.crossVectors(w,T),T.crossVectors(C,w),C.normalize(),T.normalize();for(let G=0;G<=r;++G){const k=G/r*Math.PI*2,O=-t*Math.cos(k),D=t*Math.sin(k);v.x=x.x+(O*T.x+D*C.x),v.y=x.y+(O*T.y+D*C.y),v.z=x.z+(O*T.z+D*C.z),f.push(v.x,v.y,v.z),_.subVectors(v,x).normalize(),p.push(_.x,_.y,_.z),g.push(L/n),g.push(G/r)}}for(let L=1;L<=n;L++)for(let F=1;F<=r;F++){const G=(r+1)*(L-1)+(F-1),k=(r+1)*L+(F-1),O=(r+1)*L+F,D=(r+1)*(L-1)+F;u.push(G,k,D),u.push(k,O,D)}this.setIndex(u),this.setAttribute("position",new tn(f,3)),this.setAttribute("normal",new tn(p,3)),this.setAttribute("uv",new tn(g,2));function N(L,F,G,k,O){const D=Math.cos(L),R=Math.sin(L),P=G/F*L,z=Math.cos(P);O.x=k*(2+z)*.5*D,O.y=k*(2+z)*R*.5,O.z=k*Math.sin(P)*.5}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new OS(e.radius,e.tube,e.tubularSegments,e.radialSegments,e.p,e.q)}}class US extends wn{constructor(e=new Aw(new ie(-1,-1,0),new ie(-1,1,0),new ie(1,1,0)),t=64,n=1,r=8,s=!1){super(),this.type="TubeGeometry",this.parameters={path:e,tubularSegments:t,radius:n,radialSegments:r,closed:s};const o=e.computeFrenetFrames(t,s);this.tangents=o.tangents,this.normals=o.normals,this.binormals=o.binormals;const u=new ie,f=new ie,p=new $e;let g=new ie;const v=[],_=[],x=[],E=[];C(),this.setIndex(E),this.setAttribute("position",new tn(v,3)),this.setAttribute("normal",new tn(_,3)),this.setAttribute("uv",new tn(x,2));function C(){for(let L=0;L<t;L++)w(L);w(s===!1?t:0),N(),T()}function w(L){g=e.getPointAt(L/t,g);const F=o.normals[L],G=o.binormals[L];for(let k=0;k<=r;k++){const O=k/r*Math.PI*2,D=Math.sin(O),R=-Math.cos(O);f.x=R*F.x+D*G.x,f.y=R*F.y+D*G.y,f.z=R*F.z+D*G.z,f.normalize(),_.push(f.x,f.y,f.z),u.x=g.x+n*f.x,u.y=g.y+n*f.y,u.z=g.z+n*f.z,v.push(u.x,u.y,u.z)}}function T(){for(let L=1;L<=t;L++)for(let F=1;F<=r;F++){const G=(r+1)*(L-1)+(F-1),k=(r+1)*L+(F-1),O=(r+1)*L+F,D=(r+1)*(L-1)+F;E.push(G,k,D),E.push(k,O,D)}}function N(){for(let L=0;L<=t;L++)for(let F=0;F<=r;F++)p.x=L/t,p.y=F/r,x.push(p.x,p.y)}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}toJSON(){const e=super.toJSON();return e.path=this.parameters.path.toJSON(),e}static fromJSON(e){return new US(new wA[e.path.type]().fromJSON(e.path),e.tubularSegments,e.radius,e.radialSegments,e.closed)}}class bL extends wn{constructor(e=null){if(super(),this.type="WireframeGeometry",this.parameters={geometry:e},e!==null){const t=[],n=new Set,r=new ie,s=new ie;if(e.index!==null){const o=e.attributes.position,u=e.index;let f=e.groups;f.length===0&&(f=[{start:0,count:u.count,materialIndex:0}]);for(let p=0,g=f.length;p<g;++p){const v=f[p],_=v.start,x=v.count;for(let E=_,C=_+x;E<C;E+=3)for(let w=0;w<3;w++){const T=u.getX(E+w),N=u.getX(E+(w+1)%3);r.fromBufferAttribute(o,T),s.fromBufferAttribute(o,N),mD(r,s,n)===!0&&(t.push(r.x,r.y,r.z),t.push(s.x,s.y,s.z))}}}else{const o=e.attributes.position;for(let u=0,f=o.count/3;u<f;u++)for(let p=0;p<3;p++){const g=3*u+p,v=3*u+(p+1)%3;r.fromBufferAttribute(o,g),s.fromBufferAttribute(o,v),mD(r,s,n)===!0&&(t.push(r.x,r.y,r.z),t.push(s.x,s.y,s.z))}}this.setAttribute("position",new tn(t,3))}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}}function mD(i,e,t){const n=`${i.x},${i.y},${i.z}-${e.x},${e.y},${e.z}`,r=`${e.x},${e.y},${e.z}-${i.x},${i.y},${i.z}`;return t.has(n)===!0||t.has(r)===!0?!1:(t.add(n),t.add(r),!0)}var gD=Object.freeze({__proto__:null,BoxGeometry:fp,CapsuleGeometry:MS,CircleGeometry:wS,ConeGeometry:My,CylinderGeometry:Ty,DodecahedronGeometry:CS,EdgesGeometry:hL,ExtrudeGeometry:IS,IcosahedronGeometry:wy,LatheGeometry:DS,OctahedronGeometry:Cy,PlaneGeometry:Xu,PolyhedronGeometry:Tf,RingGeometry:NS,ShapeGeometry:PS,SphereGeometry:Ry,TetrahedronGeometry:BS,TorusGeometry:LS,TorusKnotGeometry:OS,TubeGeometry:US,WireframeGeometry:bL});class AL extends os{constructor(e){super(),this.isShadowMaterial=!0,this.type="ShadowMaterial",this.color=new Gt(0),this.transparent=!0,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.fog=e.fog,this}}class Ew extends Gs{constructor(e){super(e),this.isRawShaderMaterial=!0,this.type="RawShaderMaterial"}}class Cg extends os{constructor(e){super(),this.isMeshStandardMaterial=!0,this.type="MeshStandardMaterial",this.defines={STANDARD:""},this.color=new Gt(16777215),this.roughness=1,this.metalness=0,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Gt(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=Ef,this.normalScale=new $e(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.roughnessMap=null,this.metalnessMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new Eo,this.envMapIntensity=1,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.defines={STANDARD:""},this.color.copy(e.color),this.roughness=e.roughness,this.metalness=e.metalness,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.roughnessMap=e.roughnessMap,this.metalnessMap=e.metalnessMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapRotation.copy(e.envMapRotation),this.envMapIntensity=e.envMapIntensity,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}}class cl extends Cg{constructor(e){super(),this.isMeshPhysicalMaterial=!0,this.defines={STANDARD:"",PHYSICAL:""},this.type="MeshPhysicalMaterial",this.anisotropyRotation=0,this.anisotropyMap=null,this.clearcoatMap=null,this.clearcoatRoughness=0,this.clearcoatRoughnessMap=null,this.clearcoatNormalScale=new $e(1,1),this.clearcoatNormalMap=null,this.ior=1.5,Object.defineProperty(this,"reflectivity",{get:function(){return An(2.5*(this.ior-1)/(this.ior+1),0,1)},set:function(t){this.ior=(1+.4*t)/(1-.4*t)}}),this.iridescenceMap=null,this.iridescenceIOR=1.3,this.iridescenceThicknessRange=[100,400],this.iridescenceThicknessMap=null,this.sheenColor=new Gt(0),this.sheenColorMap=null,this.sheenRoughness=1,this.sheenRoughnessMap=null,this.transmissionMap=null,this.thickness=0,this.thicknessMap=null,this.attenuationDistance=1/0,this.attenuationColor=new Gt(1,1,1),this.specularIntensity=1,this.specularIntensityMap=null,this.specularColor=new Gt(1,1,1),this.specularColorMap=null,this._anisotropy=0,this._clearcoat=0,this._dispersion=0,this._iridescence=0,this._sheen=0,this._transmission=0,this.setValues(e)}get anisotropy(){return this._anisotropy}set anisotropy(e){this._anisotropy>0!=e>0&&this.version++,this._anisotropy=e}get clearcoat(){return this._clearcoat}set clearcoat(e){this._clearcoat>0!=e>0&&this.version++,this._clearcoat=e}get iridescence(){return this._iridescence}set iridescence(e){this._iridescence>0!=e>0&&this.version++,this._iridescence=e}get dispersion(){return this._dispersion}set dispersion(e){this._dispersion>0!=e>0&&this.version++,this._dispersion=e}get sheen(){return this._sheen}set sheen(e){this._sheen>0!=e>0&&this.version++,this._sheen=e}get transmission(){return this._transmission}set transmission(e){this._transmission>0!=e>0&&this.version++,this._transmission=e}copy(e){return super.copy(e),this.defines={STANDARD:"",PHYSICAL:""},this.anisotropy=e.anisotropy,this.anisotropyRotation=e.anisotropyRotation,this.anisotropyMap=e.anisotropyMap,this.clearcoat=e.clearcoat,this.clearcoatMap=e.clearcoatMap,this.clearcoatRoughness=e.clearcoatRoughness,this.clearcoatRoughnessMap=e.clearcoatRoughnessMap,this.clearcoatNormalMap=e.clearcoatNormalMap,this.clearcoatNormalScale.copy(e.clearcoatNormalScale),this.dispersion=e.dispersion,this.ior=e.ior,this.iridescence=e.iridescence,this.iridescenceMap=e.iridescenceMap,this.iridescenceIOR=e.iridescenceIOR,this.iridescenceThicknessRange=[...e.iridescenceThicknessRange],this.iridescenceThicknessMap=e.iridescenceThicknessMap,this.sheen=e.sheen,this.sheenColor.copy(e.sheenColor),this.sheenColorMap=e.sheenColorMap,this.sheenRoughness=e.sheenRoughness,this.sheenRoughnessMap=e.sheenRoughnessMap,this.transmission=e.transmission,this.transmissionMap=e.transmissionMap,this.thickness=e.thickness,this.thicknessMap=e.thicknessMap,this.attenuationDistance=e.attenuationDistance,this.attenuationColor.copy(e.attenuationColor),this.specularIntensity=e.specularIntensity,this.specularIntensityMap=e.specularIntensityMap,this.specularColor.copy(e.specularColor),this.specularColorMap=e.specularColorMap,this}}class SL extends os{constructor(e){super(),this.isMeshPhongMaterial=!0,this.type="MeshPhongMaterial",this.color=new Gt(16777215),this.specular=new Gt(1118481),this.shininess=30,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Gt(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=Ef,this.normalScale=new $e(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new Eo,this.combine=vy,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.specular.copy(e.specular),this.shininess=e.shininess,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapRotation.copy(e.envMapRotation),this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}}class EL extends os{constructor(e){super(),this.isMeshToonMaterial=!0,this.defines={TOON:""},this.type="MeshToonMaterial",this.color=new Gt(16777215),this.map=null,this.gradientMap=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Gt(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=Ef,this.normalScale=new $e(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.gradientMap=e.gradientMap,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.alphaMap=e.alphaMap,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.fog=e.fog,this}}class TL extends os{constructor(e){super(),this.isMeshNormalMaterial=!0,this.type="MeshNormalMaterial",this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=Ef,this.normalScale=new $e(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.flatShading=!1,this.setValues(e)}copy(e){return super.copy(e),this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.flatShading=e.flatShading,this}}class ML extends os{constructor(e){super(),this.isMeshLambertMaterial=!0,this.type="MeshLambertMaterial",this.color=new Gt(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Gt(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=Ef,this.normalScale=new $e(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new Eo,this.combine=vy,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapRotation.copy(e.envMapRotation),this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}}class FS extends os{constructor(e){super(),this.isMeshDepthMaterial=!0,this.type="MeshDepthMaterial",this.depthPacking=HB,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.setValues(e)}copy(e){return super.copy(e),this.depthPacking=e.depthPacking,this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this}}class Tw extends os{constructor(e){super(),this.isMeshDistanceMaterial=!0,this.type="MeshDistanceMaterial",this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.setValues(e)}copy(e){return super.copy(e),this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this}}class wL extends os{constructor(e){super(),this.isMeshMatcapMaterial=!0,this.defines={MATCAP:""},this.type="MeshMatcapMaterial",this.color=new Gt(16777215),this.matcap=null,this.map=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=Ef,this.normalScale=new $e(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.wireframe=!1,this.wireframeLinewidth=1,this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.defines={MATCAP:""},this.color.copy(e.color),this.matcap=e.matcap,this.map=e.map,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.alphaMap=e.alphaMap,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.flatShading=e.flatShading,this.fog=e.fog,this}}class CL extends ha{constructor(e){super(),this.isLineDashedMaterial=!0,this.type="LineDashedMaterial",this.scale=1,this.dashSize=3,this.gapSize=1,this.setValues(e)}copy(e){return super.copy(e),this.scale=e.scale,this.dashSize=e.dashSize,this.gapSize=e.gapSize,this}}function Ud(i,e){return!i||i.constructor===e?i:typeof e.BYTES_PER_ELEMENT=="number"?new e(i):Array.prototype.slice.call(i)}function RL(i){function e(r,s){return i[r]-i[s]}const t=i.length,n=new Array(t);for(let r=0;r!==t;++r)n[r]=r;return n.sort(e),n}function PT(i,e,t){const n=i.length,r=new i.constructor(n);for(let s=0,o=0;o!==n;++s){const u=t[s]*e;for(let f=0;f!==e;++f)r[o++]=i[u+f]}return r}function Mw(i,e,t,n){let r=1,s=i[0];for(;s!==void 0&&s[n]===void 0;)s=i[r++];if(s===void 0)return;let o=s[n];if(o!==void 0)if(Array.isArray(o))do o=s[n],o!==void 0&&(e.push(s.time),t.push(...o)),s=i[r++];while(s!==void 0);else if(o.toArray!==void 0)do o=s[n],o!==void 0&&(e.push(s.time),o.toArray(t,t.length)),s=i[r++];while(s!==void 0);else do o=s[n],o!==void 0&&(e.push(s.time),t.push(o)),s=i[r++];while(s!==void 0)}function a8(i,e,t,n,r=30){const s=i.clone();s.name=e;const o=[];for(let f=0;f<s.tracks.length;++f){const p=s.tracks[f],g=p.getValueSize(),v=[],_=[];for(let x=0;x<p.times.length;++x){const E=p.times[x]*r;if(!(E<t||E>=n)){v.push(p.times[x]);for(let C=0;C<g;++C)_.push(p.values[x*g+C])}}v.length!==0&&(p.times=Ud(v,p.times.constructor),p.values=Ud(_,p.values.constructor),o.push(p))}s.tracks=o;let u=1/0;for(let f=0;f<s.tracks.length;++f)u>s.tracks[f].times[0]&&(u=s.tracks[f].times[0]);for(let f=0;f<s.tracks.length;++f)s.tracks[f].shift(-1*u);return s.resetDuration(),s}function o8(i,e=0,t=i,n=30){n<=0&&(n=30);const r=t.tracks.length,s=e/n;for(let o=0;o<r;++o){const u=t.tracks[o],f=u.ValueTypeName;if(f==="bool"||f==="string")continue;const p=i.tracks.find(function(T){return T.name===u.name&&T.ValueTypeName===f});if(p===void 0)continue;let g=0;const v=u.getValueSize();u.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline&&(g=v/3);let _=0;const x=p.getValueSize();p.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline&&(_=x/3);const E=u.times.length-1;let C;if(s<=u.times[0]){const T=g,N=v-g;C=u.values.slice(T,N)}else if(s>=u.times[E]){const T=E*v+g,N=T+v-g;C=u.values.slice(T,N)}else{const T=u.createInterpolant(),N=g,L=v-g;T.evaluate(s),C=T.resultBuffer.slice(N,L)}f==="quaternion"&&new ys().fromArray(C).normalize().conjugate().toArray(C);const w=p.times.length;for(let T=0;T<w;++T){const N=T*x+_;if(f==="quaternion")ys.multiplyQuaternionsFlat(p.values,N,C,0,p.values,N);else{const L=x-_*2;for(let F=0;F<L;++F)p.values[N+F]-=C[F]}}}return i.blendMode=aw,i}class l8{static convertArray(e,t){return Ud(e,t)}static isTypedArray(e){return QB(e)}static getKeyframeOrder(e){return RL(e)}static sortedArray(e,t,n){return PT(e,t,n)}static flattenJSON(e,t,n,r){Mw(e,t,n,r)}static subclip(e,t,n,r,s=30){return a8(e,t,n,r,s)}static makeClipAdditive(e,t=0,n=e,r=30){return o8(e,t,n,r)}}class Rg{constructor(e,t,n,r){this.parameterPositions=e,this._cachedIndex=0,this.resultBuffer=r!==void 0?r:new t.constructor(n),this.sampleValues=t,this.valueSize=n,this.settings=null,this.DefaultSettings_={}}evaluate(e){const t=this.parameterPositions;let n=this._cachedIndex,r=t[n],s=t[n-1];e:{t:{let o;n:{i:if(!(e<r)){for(let u=n+2;;){if(r===void 0){if(e<s)break i;return n=t.length,this._cachedIndex=n,this.copySampleValue_(n-1)}if(n===u)break;if(s=r,r=t[++n],e<r)break t}o=t.length;break n}if(!(e>=s)){const u=t[1];e<u&&(n=2,s=u);for(let f=n-2;;){if(s===void 0)return this._cachedIndex=0,this.copySampleValue_(0);if(n===f)break;if(r=s,s=t[--n-1],e>=s)break t}o=n,n=0;break n}break e}for(;n<o;){const u=n+o>>>1;e<t[u]?o=u:n=u+1}if(r=t[n],s=t[n-1],s===void 0)return this._cachedIndex=0,this.copySampleValue_(0);if(r===void 0)return n=t.length,this._cachedIndex=n,this.copySampleValue_(n-1)}this._cachedIndex=n,this.intervalChanged_(n,s,r)}return this.interpolate_(n,s,e,r)}getSettings_(){return this.settings||this.DefaultSettings_}copySampleValue_(e){const t=this.resultBuffer,n=this.sampleValues,r=this.valueSize,s=e*r;for(let o=0;o!==r;++o)t[o]=n[s+o];return t}interpolate_(){throw new Error("call to abstract method")}intervalChanged_(){}}class IL extends Rg{constructor(e,t,n,r){super(e,t,n,r),this._weightPrev=-0,this._offsetPrev=-0,this._weightNext=-0,this._offsetNext=-0,this.DefaultSettings_={endingStart:Bd,endingEnd:Bd}}intervalChanged_(e,t,n){const r=this.parameterPositions;let s=e-2,o=e+1,u=r[s],f=r[o];if(u===void 0)switch(this.getSettings_().endingStart){case Ld:s=e,u=2*t-n;break;case qv:s=r.length-2,u=t+r[s]-r[s+1];break;default:s=e,u=n}if(f===void 0)switch(this.getSettings_().endingEnd){case Ld:o=e,f=2*n-t;break;case qv:o=1,f=n+r[1]-r[0];break;default:o=e-1,f=t}const p=(n-t)*.5,g=this.valueSize;this._weightPrev=p/(t-u),this._weightNext=p/(f-n),this._offsetPrev=s*g,this._offsetNext=o*g}interpolate_(e,t,n,r){const s=this.resultBuffer,o=this.sampleValues,u=this.valueSize,f=e*u,p=f-u,g=this._offsetPrev,v=this._offsetNext,_=this._weightPrev,x=this._weightNext,E=(n-t)/(r-t),C=E*E,w=C*E,T=-_*w+2*_*C-_*E,N=(1+_)*w+(-1.5-2*_)*C+(-.5+_)*E+1,L=(-1-x)*w+(1.5+x)*C+.5*E,F=x*w-x*C;for(let G=0;G!==u;++G)s[G]=T*o[g+G]+N*o[p+G]+L*o[f+G]+F*o[v+G];return s}}class ww extends Rg{constructor(e,t,n,r){super(e,t,n,r)}interpolate_(e,t,n,r){const s=this.resultBuffer,o=this.sampleValues,u=this.valueSize,f=e*u,p=f-u,g=(n-t)/(r-t),v=1-g;for(let _=0;_!==u;++_)s[_]=o[p+_]*v+o[f+_]*g;return s}}class DL extends Rg{constructor(e,t,n,r){super(e,t,n,r)}interpolate_(e){return this.copySampleValue_(e-1)}}class ul{constructor(e,t,n,r){if(e===void 0)throw new Error("THREE.KeyframeTrack: track name is undefined");if(t===void 0||t.length===0)throw new Error("THREE.KeyframeTrack: no keyframes in track named "+e);this.name=e,this.times=Ud(t,this.TimeBufferType),this.values=Ud(n,this.ValueBufferType),this.setInterpolation(r||this.DefaultInterpolation)}static toJSON(e){const t=e.constructor;let n;if(t.toJSON!==this.toJSON)n=t.toJSON(e);else{n={name:e.name,times:Ud(e.times,Array),values:Ud(e.values,Array)};const r=e.getInterpolation();r!==e.DefaultInterpolation&&(n.interpolation=r)}return n.type=e.ValueTypeName,n}InterpolantFactoryMethodDiscrete(e){return new DL(this.times,this.values,this.getValueSize(),e)}InterpolantFactoryMethodLinear(e){return new ww(this.times,this.values,this.getValueSize(),e)}InterpolantFactoryMethodSmooth(e){return new IL(this.times,this.values,this.getValueSize(),e)}setInterpolation(e){let t;switch(e){case lg:t=this.InterpolantFactoryMethodDiscrete;break;case cg:t=this.InterpolantFactoryMethodLinear;break;case pb:t=this.InterpolantFactoryMethodSmooth;break}if(t===void 0){const n="unsupported interpolation for "+this.ValueTypeName+" keyframe track named "+this.name;if(this.createInterpolant===void 0)if(e!==this.DefaultInterpolation)this.setInterpolation(this.DefaultInterpolation);else throw new Error(n);return Ht("KeyframeTrack:",n),this}return this.createInterpolant=t,this}getInterpolation(){switch(this.createInterpolant){case this.InterpolantFactoryMethodDiscrete:return lg;case this.InterpolantFactoryMethodLinear:return cg;case this.InterpolantFactoryMethodSmooth:return pb}}getValueSize(){return this.values.length/this.times.length}shift(e){if(e!==0){const t=this.times;for(let n=0,r=t.length;n!==r;++n)t[n]+=e}return this}scale(e){if(e!==1){const t=this.times;for(let n=0,r=t.length;n!==r;++n)t[n]*=e}return this}trim(e,t){const n=this.times,r=n.length;let s=0,o=r-1;for(;s!==r&&n[s]<e;)++s;for(;o!==-1&&n[o]>t;)--o;if(++o,s!==0||o!==r){s>=o&&(o=Math.max(o,1),s=o-1);const u=this.getValueSize();this.times=n.slice(s,o),this.values=this.values.slice(s*u,o*u)}return this}validate(){let e=!0;const t=this.getValueSize();t-Math.floor(t)!==0&&(cn("KeyframeTrack: Invalid value size in track.",this),e=!1);const n=this.times,r=this.values,s=n.length;s===0&&(cn("KeyframeTrack: Track is empty.",this),e=!1);let o=null;for(let u=0;u!==s;u++){const f=n[u];if(typeof f=="number"&&isNaN(f)){cn("KeyframeTrack: Time is not a valid number.",this,u,f),e=!1;break}if(o!==null&&o>f){cn("KeyframeTrack: Out of order keys.",this,u,f,o),e=!1;break}o=f}if(r!==void 0&&QB(r))for(let u=0,f=r.length;u!==f;++u){const p=r[u];if(isNaN(p)){cn("KeyframeTrack: Value is not a valid number.",this,u,p),e=!1;break}}return e}optimize(){const e=this.times.slice(),t=this.values.slice(),n=this.getValueSize(),r=this.getInterpolation()===pb,s=e.length-1;let o=1;for(let u=1;u<s;++u){let f=!1;const p=e[u],g=e[u+1];if(p!==g&&(u!==1||p!==e[0]))if(r)f=!0;else{const v=u*n,_=v-n,x=v+n;for(let E=0;E!==n;++E){const C=t[v+E];if(C!==t[_+E]||C!==t[x+E]){f=!0;break}}}if(f){if(u!==o){e[o]=e[u];const v=u*n,_=o*n;for(let x=0;x!==n;++x)t[_+x]=t[v+x]}++o}}if(s>0){e[o]=e[s];for(let u=s*n,f=o*n,p=0;p!==n;++p)t[f+p]=t[u+p];++o}return o!==e.length?(this.times=e.slice(0,o),this.values=t.slice(0,o*n)):(this.times=e,this.values=t),this}clone(){const e=this.times.slice(),t=this.values.slice(),n=this.constructor,r=new n(this.name,e,t);return r.createInterpolant=this.createInterpolant,r}}ul.prototype.ValueTypeName="";ul.prototype.TimeBufferType=Float32Array;ul.prototype.ValueBufferType=Float32Array;ul.prototype.DefaultInterpolation=cg;class dp extends ul{constructor(e,t,n){super(e,t,n)}}dp.prototype.ValueTypeName="bool";dp.prototype.ValueBufferType=Array;dp.prototype.DefaultInterpolation=lg;dp.prototype.InterpolantFactoryMethodLinear=void 0;dp.prototype.InterpolantFactoryMethodSmooth=void 0;class Cw extends ul{constructor(e,t,n,r){super(e,t,n,r)}}Cw.prototype.ValueTypeName="color";class np extends ul{constructor(e,t,n,r){super(e,t,n,r)}}np.prototype.ValueTypeName="number";class NL extends Rg{constructor(e,t,n,r){super(e,t,n,r)}interpolate_(e,t,n,r){const s=this.resultBuffer,o=this.sampleValues,u=this.valueSize,f=(n-t)/(r-t);let p=e*u;for(let g=p+u;p!==g;p+=4)ys.slerpFlat(s,0,o,p-u,o,p,f);return s}}class ip extends ul{constructor(e,t,n,r){super(e,t,n,r)}InterpolantFactoryMethodLinear(e){return new NL(this.times,this.values,this.getValueSize(),e)}}ip.prototype.ValueTypeName="quaternion";ip.prototype.InterpolantFactoryMethodSmooth=void 0;class pp extends ul{constructor(e,t,n){super(e,t,n)}}pp.prototype.ValueTypeName="string";pp.prototype.ValueBufferType=Array;pp.prototype.DefaultInterpolation=lg;pp.prototype.InterpolantFactoryMethodLinear=void 0;pp.prototype.InterpolantFactoryMethodSmooth=void 0;class rp extends ul{constructor(e,t,n,r){super(e,t,n,r)}}rp.prototype.ValueTypeName="vector";class gg{constructor(e="",t=-1,n=[],r=dS){this.name=e,this.tracks=n,this.duration=t,this.blendMode=r,this.uuid=bo(),this.userData={},this.duration<0&&this.resetDuration()}static parse(e){const t=[],n=e.tracks,r=1/(e.fps||1);for(let o=0,u=n.length;o!==u;++o)t.push(u8(n[o]).scale(r));const s=new this(e.name,e.duration,t,e.blendMode);return s.uuid=e.uuid,s.userData=JSON.parse(e.userData||"{}"),s}static toJSON(e){const t=[],n=e.tracks,r={name:e.name,duration:e.duration,tracks:t,uuid:e.uuid,blendMode:e.blendMode,userData:JSON.stringify(e.userData)};for(let s=0,o=n.length;s!==o;++s)t.push(ul.toJSON(n[s]));return r}static CreateFromMorphTargetSequence(e,t,n,r){const s=t.length,o=[];for(let u=0;u<s;u++){let f=[],p=[];f.push((u+s-1)%s,u,(u+1)%s),p.push(0,1,0);const g=RL(f);f=PT(f,1,g),p=PT(p,1,g),!r&&f[0]===0&&(f.push(s),p.push(p[0])),o.push(new np(".morphTargetInfluences["+t[u].name+"]",f,p).scale(1/n))}return new this(e,-1,o)}static findByName(e,t){let n=e;if(!Array.isArray(e)){const r=e;n=r.geometry&&r.geometry.animations||r.animations}for(let r=0;r<n.length;r++)if(n[r].name===t)return n[r];return null}static CreateClipsFromMorphTargetSequences(e,t,n){const r={},s=/^([\w-]*?)([\d]+)$/;for(let u=0,f=e.length;u<f;u++){const p=e[u],g=p.name.match(s);if(g&&g.length>1){const v=g[1];let _=r[v];_||(r[v]=_=[]),_.push(p)}}const o=[];for(const u in r)o.push(this.CreateFromMorphTargetSequence(u,r[u],t,n));return o}static parseAnimation(e,t){if(Ht("AnimationClip: parseAnimation() is deprecated and will be removed with r185"),!e)return cn("AnimationClip: No animation in JSONLoader data."),null;const n=function(v,_,x,E,C){if(x.length!==0){const w=[],T=[];Mw(x,w,T,E),w.length!==0&&C.push(new v(_,w,T))}},r=[],s=e.name||"default",o=e.fps||30,u=e.blendMode;let f=e.length||-1;const p=e.hierarchy||[];for(let v=0;v<p.length;v++){const _=p[v].keys;if(!(!_||_.length===0))if(_[0].morphTargets){const x={};let E;for(E=0;E<_.length;E++)if(_[E].morphTargets)for(let C=0;C<_[E].morphTargets.length;C++)x[_[E].morphTargets[C]]=-1;for(const C in x){const w=[],T=[];for(let N=0;N!==_[E].morphTargets.length;++N){const L=_[E];w.push(L.time),T.push(L.morphTarget===C?1:0)}r.push(new np(".morphTargetInfluence["+C+"]",w,T))}f=x.length*o}else{const x=".bones["+t[v].name+"]";n(rp,x+".position",_,"pos",r),n(ip,x+".quaternion",_,"rot",r),n(rp,x+".scale",_,"scl",r)}}return r.length===0?null:new this(s,f,r,u)}resetDuration(){const e=this.tracks;let t=0;for(let n=0,r=e.length;n!==r;++n){const s=this.tracks[n];t=Math.max(t,s.times[s.times.length-1])}return this.duration=t,this}trim(){for(let e=0;e<this.tracks.length;e++)this.tracks[e].trim(0,this.duration);return this}validate(){let e=!0;for(let t=0;t<this.tracks.length;t++)e=e&&this.tracks[t].validate();return e}optimize(){for(let e=0;e<this.tracks.length;e++)this.tracks[e].optimize();return this}clone(){const e=[];for(let n=0;n<this.tracks.length;n++)e.push(this.tracks[n].clone());const t=new this.constructor(this.name,this.duration,e,this.blendMode);return t.userData=JSON.parse(JSON.stringify(this.userData)),t}toJSON(){return this.constructor.toJSON(this)}}function c8(i){switch(i.toLowerCase()){case"scalar":case"double":case"float":case"number":case"integer":return np;case"vector":case"vector2":case"vector3":case"vector4":return rp;case"color":return Cw;case"quaternion":return ip;case"bool":case"boolean":return dp;case"string":return pp}throw new Error("THREE.KeyframeTrack: Unsupported typeName: "+i)}function u8(i){if(i.type===void 0)throw new Error("THREE.KeyframeTrack: track type undefined, can not parse");const e=c8(i.type);if(i.times===void 0){const t=[],n=[];Mw(i.keys,t,n,"value"),i.times=t,i.values=n}return e.parse!==void 0?e.parse(i):new e(i.name,i.times,i.values,i.interpolation)}const Oc={enabled:!1,files:{},add:function(i,e){this.enabled!==!1&&(this.files[i]=e)},get:function(i){if(this.enabled!==!1)return this.files[i]},remove:function(i){delete this.files[i]},clear:function(){this.files={}}};class kS{constructor(e,t,n){const r=this;let s=!1,o=0,u=0,f;const p=[];this.onStart=void 0,this.onLoad=e,this.onProgress=t,this.onError=n,this._abortController=null,this.itemStart=function(g){u++,s===!1&&r.onStart!==void 0&&r.onStart(g,o,u),s=!0},this.itemEnd=function(g){o++,r.onProgress!==void 0&&r.onProgress(g,o,u),o===u&&(s=!1,r.onLoad!==void 0&&r.onLoad())},this.itemError=function(g){r.onError!==void 0&&r.onError(g)},this.resolveURL=function(g){return f?f(g):g},this.setURLModifier=function(g){return f=g,this},this.addHandler=function(g,v){return p.push(g,v),this},this.removeHandler=function(g){const v=p.indexOf(g);return v!==-1&&p.splice(v,2),this},this.getHandler=function(g){for(let v=0,_=p.length;v<_;v+=2){const x=p[v],E=p[v+1];if(x.global&&(x.lastIndex=0),x.test(g))return E}return null},this.abort=function(){return this.abortController.abort(),this._abortController=null,this}}get abortController(){return this._abortController||(this._abortController=new AbortController),this._abortController}}const PL=new kS;class js{constructor(e){this.manager=e!==void 0?e:PL,this.crossOrigin="anonymous",this.withCredentials=!1,this.path="",this.resourcePath="",this.requestHeader={}}load(){}loadAsync(e,t){const n=this;return new Promise(function(r,s){n.load(e,r,t,s)})}parse(){}setCrossOrigin(e){return this.crossOrigin=e,this}setWithCredentials(e){return this.withCredentials=e,this}setPath(e){return this.path=e,this}setResourcePath(e){return this.resourcePath=e,this}setRequestHeader(e){return this.requestHeader=e,this}abort(){return this}}js.DEFAULT_MATERIAL_NAME="__DEFAULT";const Ru={};class h8 extends Error{constructor(e,t){super(e),this.response=t}}class zs extends js{constructor(e){super(e),this.mimeType="",this.responseType="",this._abortController=new AbortController}load(e,t,n,r){e===void 0&&(e=""),this.path!==void 0&&(e=this.path+e),e=this.manager.resolveURL(e);const s=Oc.get(`file:${e}`);if(s!==void 0)return this.manager.itemStart(e),setTimeout(()=>{t&&t(s),this.manager.itemEnd(e)},0),s;if(Ru[e]!==void 0){Ru[e].push({onLoad:t,onProgress:n,onError:r});return}Ru[e]=[],Ru[e].push({onLoad:t,onProgress:n,onError:r});const o=new Request(e,{headers:new Headers(this.requestHeader),credentials:this.withCredentials?"include":"same-origin",signal:typeof AbortSignal.any=="function"?AbortSignal.any([this._abortController.signal,this.manager.abortController.signal]):this._abortController.signal}),u=this.mimeType,f=this.responseType;fetch(o).then(p=>{if(p.status===200||p.status===0){if(p.status===0&&Ht("FileLoader: HTTP Status 0 received."),typeof ReadableStream>"u"||p.body===void 0||p.body.getReader===void 0)return p;const g=Ru[e],v=p.body.getReader(),_=p.headers.get("X-File-Size")||p.headers.get("Content-Length"),x=_?parseInt(_):0,E=x!==0;let C=0;const w=new ReadableStream({start(T){N();function N(){v.read().then(({done:L,value:F})=>{if(L)T.close();else{C+=F.byteLength;const G=new ProgressEvent("progress",{lengthComputable:E,loaded:C,total:x});for(let k=0,O=g.length;k<O;k++){const D=g[k];D.onProgress&&D.onProgress(G)}T.enqueue(F),N()}},L=>{T.error(L)})}}});return new Response(w)}else throw new h8(`fetch for "${p.url}" responded with ${p.status}: ${p.statusText}`,p)}).then(p=>{switch(f){case"arraybuffer":return p.arrayBuffer();case"blob":return p.blob();case"document":return p.text().then(g=>new DOMParser().parseFromString(g,u));case"json":return p.json();default:if(u==="")return p.text();{const v=/charset="?([^;"\s]*)"?/i.exec(u),_=v&&v[1]?v[1].toLowerCase():void 0,x=new TextDecoder(_);return p.arrayBuffer().then(E=>x.decode(E))}}}).then(p=>{Oc.add(`file:${e}`,p);const g=Ru[e];delete Ru[e];for(let v=0,_=g.length;v<_;v++){const x=g[v];x.onLoad&&x.onLoad(p)}}).catch(p=>{const g=Ru[e];if(g===void 0)throw this.manager.itemError(e),p;delete Ru[e];for(let v=0,_=g.length;v<_;v++){const x=g[v];x.onError&&x.onError(p)}this.manager.itemError(e)}).finally(()=>{this.manager.itemEnd(e)}),this.manager.itemStart(e)}setResponseType(e){return this.responseType=e,this}setMimeType(e){return this.mimeType=e,this}abort(){return this._abortController.abort(),this._abortController=new AbortController,this}}class f8 extends js{constructor(e){super(e)}load(e,t,n,r){const s=this,o=new zs(this.manager);o.setPath(this.path),o.setRequestHeader(this.requestHeader),o.setWithCredentials(this.withCredentials),o.load(e,function(u){try{t(s.parse(JSON.parse(u)))}catch(f){r?r(f):cn(f),s.manager.itemError(e)}},n,r)}parse(e){const t=[];for(let n=0;n<e.length;n++){const r=gg.parse(e[n]);t.push(r)}return t}}class d8 extends js{constructor(e){super(e)}load(e,t,n,r){const s=this,o=[],u=new TS,f=new zs(this.manager);f.setPath(this.path),f.setResponseType("arraybuffer"),f.setRequestHeader(this.requestHeader),f.setWithCredentials(s.withCredentials);let p=0;function g(v){f.load(e[v],function(_){const x=s.parse(_,!0);o[v]={width:x.width,height:x.height,format:x.format,mipmaps:x.mipmaps},p+=1,p===6&&(x.mipmapCount===1&&(u.minFilter=Jn),u.image=o,u.format=x.format,u.needsUpdate=!0,t&&t(u))},n,r)}if(Array.isArray(e))for(let v=0,_=e.length;v<_;++v)g(v);else f.load(e,function(v){const _=s.parse(v,!0);if(_.isCubemap){const x=_.mipmaps.length/_.mipmapCount;for(let E=0;E<x;E++){o[E]={mipmaps:[]};for(let C=0;C<_.mipmapCount;C++)o[E].mipmaps.push(_.mipmaps[E*_.mipmapCount+C]),o[E].format=_.format,o[E].width=_.width,o[E].height=_.height}u.image=o}else u.image.width=_.width,u.image.height=_.height,u.mipmaps=_.mipmaps;_.mipmapCount===1&&(u.minFilter=Jn),u.format=_.format,u.needsUpdate=!0,t&&t(u)},n,r);return u}}const wm=new WeakMap;class ey extends js{constructor(e){super(e)}load(e,t,n,r){this.path!==void 0&&(e=this.path+e),e=this.manager.resolveURL(e);const s=this,o=Oc.get(`image:${e}`);if(o!==void 0){if(o.complete===!0)s.manager.itemStart(e),setTimeout(function(){t&&t(o),s.manager.itemEnd(e)},0);else{let v=wm.get(o);v===void 0&&(v=[],wm.set(o,v)),v.push({onLoad:t,onError:r})}return o}const u=Jv("img");function f(){g(),t&&t(this);const v=wm.get(this)||[];for(let _=0;_<v.length;_++){const x=v[_];x.onLoad&&x.onLoad(this)}wm.delete(this),s.manager.itemEnd(e)}function p(v){g(),r&&r(v),Oc.remove(`image:${e}`);const _=wm.get(this)||[];for(let x=0;x<_.length;x++){const E=_[x];E.onError&&E.onError(v)}wm.delete(this),s.manager.itemError(e),s.manager.itemEnd(e)}function g(){u.removeEventListener("load",f,!1),u.removeEventListener("error",p,!1)}return u.addEventListener("load",f,!1),u.addEventListener("error",p,!1),e.slice(0,5)!=="data:"&&this.crossOrigin!==void 0&&(u.crossOrigin=this.crossOrigin),Oc.add(`image:${e}`,u),s.manager.itemStart(e),u.src=e,u}}class BL extends js{constructor(e){super(e)}load(e,t,n,r){const s=new by;s.colorSpace=Fs;const o=new ey(this.manager);o.setCrossOrigin(this.crossOrigin),o.setPath(this.path);let u=0;function f(p){o.load(e[p],function(g){s.images[p]=g,u++,u===6&&(s.needsUpdate=!0,t&&t(s))},void 0,r)}for(let p=0;p<e.length;++p)f(p);return s}}class Rw extends js{constructor(e){super(e)}load(e,t,n,r){const s=this,o=new ll,u=new zs(this.manager);return u.setResponseType("arraybuffer"),u.setRequestHeader(this.requestHeader),u.setPath(this.path),u.setWithCredentials(s.withCredentials),u.load(e,function(f){let p;try{p=s.parse(f)}catch(g){if(r!==void 0)r(g);else{g(g);return}}p.image!==void 0?o.image=p.image:p.data!==void 0&&(o.image.width=p.width,o.image.height=p.height,o.image.data=p.data),o.wrapS=p.wrapS!==void 0?p.wrapS:Sr,o.wrapT=p.wrapT!==void 0?p.wrapT:Sr,o.magFilter=p.magFilter!==void 0?p.magFilter:Jn,o.minFilter=p.minFilter!==void 0?p.minFilter:Jn,o.anisotropy=p.anisotropy!==void 0?p.anisotropy:1,p.colorSpace!==void 0&&(o.colorSpace=p.colorSpace),p.flipY!==void 0&&(o.flipY=p.flipY),p.format!==void 0&&(o.format=p.format),p.type!==void 0&&(o.type=p.type),p.mipmaps!==void 0&&(o.mipmaps=p.mipmaps,o.minFilter=sl),p.mipmapCount===1&&(o.minFilter=Jn),p.generateMipmaps!==void 0&&(o.generateMipmaps=p.generateMipmaps),o.needsUpdate=!0,t&&t(o,p)},n,r),o}}class LL extends js{constructor(e){super(e)}load(e,t,n,r){const s=new Ci,o=new ey(this.manager);return o.setCrossOrigin(this.crossOrigin),o.setPath(this.path),o.load(e,function(u){s.image=u,s.needsUpdate=!0,t!==void 0&&t(s)},n,r),s}}class Mf extends fi{constructor(e,t=1){super(),this.isLight=!0,this.type="Light",this.color=new Gt(e),this.intensity=t}dispose(){this.dispatchEvent({type:"dispose"})}copy(e,t){return super.copy(e,t),this.color.copy(e.color),this.intensity=e.intensity,this}toJSON(e){const t=super.toJSON(e);return t.object.color=this.color.getHex(),t.object.intensity=this.intensity,t}}class OL extends Mf{constructor(e,t,n){super(e,n),this.isHemisphereLight=!0,this.type="HemisphereLight",this.position.copy(fi.DEFAULT_UP),this.updateMatrix(),this.groundColor=new Gt(t)}copy(e,t){return super.copy(e,t),this.groundColor.copy(e.groundColor),this}toJSON(e){const t=super.toJSON(e);return t.object.groundColor=this.groundColor.getHex(),t}}const _1=new vn,vD=new ie,yD=new ie;class Iw{constructor(e){this.camera=e,this.intensity=1,this.bias=0,this.normalBias=0,this.radius=1,this.blurSamples=8,this.mapSize=new $e(512,512),this.mapType=vs,this.map=null,this.mapPass=null,this.matrix=new vn,this.autoUpdate=!0,this.needsUpdate=!1,this._frustum=new wg,this._frameExtents=new $e(1,1),this._viewportCount=1,this._viewports=[new zi(0,0,1,1)]}getViewportCount(){return this._viewportCount}getFrustum(){return this._frustum}updateMatrices(e){const t=this.camera,n=this.matrix;vD.setFromMatrixPosition(e.matrixWorld),t.position.copy(vD),yD.setFromMatrixPosition(e.target.matrixWorld),t.lookAt(yD),t.updateMatrixWorld(),_1.multiplyMatrices(t.projectionMatrix,t.matrixWorldInverse),this._frustum.setFromProjectionMatrix(_1,t.coordinateSystem,t.reversedDepth),t.reversedDepth?n.set(.5,0,0,.5,0,.5,0,.5,0,0,1,0,0,0,0,1):n.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),n.multiply(_1)}getViewport(e){return this._viewports[e]}getFrameExtents(){return this._frameExtents}dispose(){this.map&&this.map.dispose(),this.mapPass&&this.mapPass.dispose()}copy(e){return this.camera=e.camera.clone(),this.intensity=e.intensity,this.bias=e.bias,this.radius=e.radius,this.autoUpdate=e.autoUpdate,this.needsUpdate=e.needsUpdate,this.normalBias=e.normalBias,this.blurSamples=e.blurSamples,this.mapSize.copy(e.mapSize),this}clone(){return new this.constructor().copy(this)}toJSON(){const e={};return this.intensity!==1&&(e.intensity=this.intensity),this.bias!==0&&(e.bias=this.bias),this.normalBias!==0&&(e.normalBias=this.normalBias),this.radius!==1&&(e.radius=this.radius),(this.mapSize.x!==512||this.mapSize.y!==512)&&(e.mapSize=this.mapSize.toArray()),e.camera=this.camera.toJSON(!1).object,delete e.camera.matrix,e}}class p8 extends Iw{constructor(){super(new hr(50,1,.5,500)),this.isSpotLightShadow=!0,this.focus=1,this.aspect=1}updateMatrices(e){const t=this.camera,n=fg*2*e.angle*this.focus,r=this.mapSize.width/this.mapSize.height*this.aspect,s=e.distance||t.far;(n!==t.fov||r!==t.aspect||s!==t.far)&&(t.fov=n,t.aspect=r,t.far=s,t.updateProjectionMatrix()),super.updateMatrices(e)}copy(e){return super.copy(e),this.focus=e.focus,this}}class Dw extends Mf{constructor(e,t,n=0,r=Math.PI/3,s=0,o=2){super(e,t),this.isSpotLight=!0,this.type="SpotLight",this.position.copy(fi.DEFAULT_UP),this.updateMatrix(),this.target=new fi,this.distance=n,this.angle=r,this.penumbra=s,this.decay=o,this.map=null,this.shadow=new p8}get power(){return this.intensity*Math.PI}set power(e){this.intensity=e/Math.PI}dispose(){super.dispose(),this.shadow.dispose()}copy(e,t){return super.copy(e,t),this.distance=e.distance,this.angle=e.angle,this.penumbra=e.penumbra,this.decay=e.decay,this.target=e.target.clone(),this.map=e.map,this.shadow=e.shadow.clone(),this}toJSON(e){const t=super.toJSON(e);return t.object.distance=this.distance,t.object.angle=this.angle,t.object.decay=this.decay,t.object.penumbra=this.penumbra,t.object.target=this.target.uuid,this.map&&this.map.isTexture&&(t.object.map=this.map.toJSON(e).uuid),t.object.shadow=this.shadow.toJSON(),t}}class m8 extends Iw{constructor(){super(new hr(90,1,.5,500)),this.isPointLightShadow=!0}}class Nw extends Mf{constructor(e,t,n=0,r=2){super(e,t),this.isPointLight=!0,this.type="PointLight",this.distance=n,this.decay=r,this.shadow=new m8}get power(){return this.intensity*4*Math.PI}set power(e){this.intensity=e/(4*Math.PI)}dispose(){super.dispose(),this.shadow.dispose()}copy(e,t){return super.copy(e,t),this.distance=e.distance,this.decay=e.decay,this.shadow=e.shadow.clone(),this}toJSON(e){const t=super.toJSON(e);return t.object.distance=this.distance,t.object.decay=this.decay,t.object.shadow=this.shadow.toJSON(),t}}class Ao extends yS{constructor(e=-1,t=1,n=1,r=-1,s=.1,o=2e3){super(),this.isOrthographicCamera=!0,this.type="OrthographicCamera",this.zoom=1,this.view=null,this.left=e,this.right=t,this.top=n,this.bottom=r,this.near=s,this.far=o,this.updateProjectionMatrix()}copy(e,t){return super.copy(e,t),this.left=e.left,this.right=e.right,this.top=e.top,this.bottom=e.bottom,this.near=e.near,this.far=e.far,this.zoom=e.zoom,this.view=e.view===null?null:Object.assign({},e.view),this}setViewOffset(e,t,n,r,s,o){this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=n,this.view.offsetY=r,this.view.width=s,this.view.height=o,this.updateProjectionMatrix()}clearViewOffset(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const e=(this.right-this.left)/(2*this.zoom),t=(this.top-this.bottom)/(2*this.zoom),n=(this.right+this.left)/2,r=(this.top+this.bottom)/2;let s=n-e,o=n+e,u=r+t,f=r-t;if(this.view!==null&&this.view.enabled){const p=(this.right-this.left)/this.view.fullWidth/this.zoom,g=(this.top-this.bottom)/this.view.fullHeight/this.zoom;s+=p*this.view.offsetX,o=s+p*this.view.width,u-=g*this.view.offsetY,f=u-g*this.view.height}this.projectionMatrix.makeOrthographic(s,o,u,f,this.near,this.far,this.coordinateSystem,this.reversedDepth),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){const t=super.toJSON(e);return t.object.zoom=this.zoom,t.object.left=this.left,t.object.right=this.right,t.object.top=this.top,t.object.bottom=this.bottom,t.object.near=this.near,t.object.far=this.far,this.view!==null&&(t.object.view=Object.assign({},this.view)),t}}class g8 extends Iw{constructor(){super(new Ao(-5,5,5,-5,.5,500)),this.isDirectionalLightShadow=!0}}class Pw extends Mf{constructor(e,t){super(e,t),this.isDirectionalLight=!0,this.type="DirectionalLight",this.position.copy(fi.DEFAULT_UP),this.updateMatrix(),this.target=new fi,this.shadow=new g8}dispose(){super.dispose(),this.shadow.dispose()}copy(e){return super.copy(e),this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}toJSON(e){const t=super.toJSON(e);return t.object.shadow=this.shadow.toJSON(),t.object.target=this.target.uuid,t}}class UL extends Mf{constructor(e,t){super(e,t),this.isAmbientLight=!0,this.type="AmbientLight"}}class FL extends Mf{constructor(e,t,n=10,r=10){super(e,t),this.isRectAreaLight=!0,this.type="RectAreaLight",this.width=n,this.height=r}get power(){return this.intensity*this.width*this.height*Math.PI}set power(e){this.intensity=e/(this.width*this.height*Math.PI)}copy(e){return super.copy(e),this.width=e.width,this.height=e.height,this}toJSON(e){const t=super.toJSON(e);return t.object.width=this.width,t.object.height=this.height,t}}class Bw{constructor(){this.isSphericalHarmonics3=!0,this.coefficients=[];for(let e=0;e<9;e++)this.coefficients.push(new ie)}set(e){for(let t=0;t<9;t++)this.coefficients[t].copy(e[t]);return this}zero(){for(let e=0;e<9;e++)this.coefficients[e].set(0,0,0);return this}getAt(e,t){const n=e.x,r=e.y,s=e.z,o=this.coefficients;return t.copy(o[0]).multiplyScalar(.282095),t.addScaledVector(o[1],.488603*r),t.addScaledVector(o[2],.488603*s),t.addScaledVector(o[3],.488603*n),t.addScaledVector(o[4],1.092548*(n*r)),t.addScaledVector(o[5],1.092548*(r*s)),t.addScaledVector(o[6],.315392*(3*s*s-1)),t.addScaledVector(o[7],1.092548*(n*s)),t.addScaledVector(o[8],.546274*(n*n-r*r)),t}getIrradianceAt(e,t){const n=e.x,r=e.y,s=e.z,o=this.coefficients;return t.copy(o[0]).multiplyScalar(.886227),t.addScaledVector(o[1],2*.511664*r),t.addScaledVector(o[2],2*.511664*s),t.addScaledVector(o[3],2*.511664*n),t.addScaledVector(o[4],2*.429043*n*r),t.addScaledVector(o[5],2*.429043*r*s),t.addScaledVector(o[6],.743125*s*s-.247708),t.addScaledVector(o[7],2*.429043*n*s),t.addScaledVector(o[8],.429043*(n*n-r*r)),t}add(e){for(let t=0;t<9;t++)this.coefficients[t].add(e.coefficients[t]);return this}addScaledSH(e,t){for(let n=0;n<9;n++)this.coefficients[n].addScaledVector(e.coefficients[n],t);return this}scale(e){for(let t=0;t<9;t++)this.coefficients[t].multiplyScalar(e);return this}lerp(e,t){for(let n=0;n<9;n++)this.coefficients[n].lerp(e.coefficients[n],t);return this}equals(e){for(let t=0;t<9;t++)if(!this.coefficients[t].equals(e.coefficients[t]))return!1;return!0}copy(e){return this.set(e.coefficients)}clone(){return new this.constructor().copy(this)}fromArray(e,t=0){const n=this.coefficients;for(let r=0;r<9;r++)n[r].fromArray(e,t+r*3);return this}toArray(e=[],t=0){const n=this.coefficients;for(let r=0;r<9;r++)n[r].toArray(e,t+r*3);return e}static getBasisAt(e,t){const n=e.x,r=e.y,s=e.z;t[0]=.282095,t[1]=.488603*r,t[2]=.488603*s,t[3]=.488603*n,t[4]=1.092548*n*r,t[5]=1.092548*r*s,t[6]=.315392*(3*s*s-1),t[7]=1.092548*n*s,t[8]=.546274*(n*n-r*r)}}class kL extends Mf{constructor(e=new Bw,t=1){super(void 0,t),this.isLightProbe=!0,this.sh=e}copy(e){return super.copy(e),this.sh.copy(e.sh),this}toJSON(e){const t=super.toJSON(e);return t.object.sh=this.sh.toArray(),t}}class zS extends js{constructor(e){super(e),this.textures={}}load(e,t,n,r){const s=this,o=new zs(s.manager);o.setPath(s.path),o.setRequestHeader(s.requestHeader),o.setWithCredentials(s.withCredentials),o.load(e,function(u){try{t(s.parse(JSON.parse(u)))}catch(f){r?r(f):cn(f),s.manager.itemError(e)}},n,r)}parse(e){const t=this.textures;function n(s){return t[s]===void 0&&Ht("MaterialLoader: Undefined texture",s),t[s]}const r=this.createMaterialFromType(e.type);if(e.uuid!==void 0&&(r.uuid=e.uuid),e.name!==void 0&&(r.name=e.name),e.color!==void 0&&r.color!==void 0&&r.color.setHex(e.color),e.roughness!==void 0&&(r.roughness=e.roughness),e.metalness!==void 0&&(r.metalness=e.metalness),e.sheen!==void 0&&(r.sheen=e.sheen),e.sheenColor!==void 0&&(r.sheenColor=new Gt().setHex(e.sheenColor)),e.sheenRoughness!==void 0&&(r.sheenRoughness=e.sheenRoughness),e.emissive!==void 0&&r.emissive!==void 0&&r.emissive.setHex(e.emissive),e.specular!==void 0&&r.specular!==void 0&&r.specular.setHex(e.specular),e.specularIntensity!==void 0&&(r.specularIntensity=e.specularIntensity),e.specularColor!==void 0&&r.specularColor!==void 0&&r.specularColor.setHex(e.specularColor),e.shininess!==void 0&&(r.shininess=e.shininess),e.clearcoat!==void 0&&(r.clearcoat=e.clearcoat),e.clearcoatRoughness!==void 0&&(r.clearcoatRoughness=e.clearcoatRoughness),e.dispersion!==void 0&&(r.dispersion=e.dispersion),e.iridescence!==void 0&&(r.iridescence=e.iridescence),e.iridescenceIOR!==void 0&&(r.iridescenceIOR=e.iridescenceIOR),e.iridescenceThicknessRange!==void 0&&(r.iridescenceThicknessRange=e.iridescenceThicknessRange),e.transmission!==void 0&&(r.transmission=e.transmission),e.thickness!==void 0&&(r.thickness=e.thickness),e.attenuationDistance!==void 0&&(r.attenuationDistance=e.attenuationDistance),e.attenuationColor!==void 0&&r.attenuationColor!==void 0&&r.attenuationColor.setHex(e.attenuationColor),e.anisotropy!==void 0&&(r.anisotropy=e.anisotropy),e.anisotropyRotation!==void 0&&(r.anisotropyRotation=e.anisotropyRotation),e.fog!==void 0&&(r.fog=e.fog),e.flatShading!==void 0&&(r.flatShading=e.flatShading),e.blending!==void 0&&(r.blending=e.blending),e.combine!==void 0&&(r.combine=e.combine),e.side!==void 0&&(r.side=e.side),e.shadowSide!==void 0&&(r.shadowSide=e.shadowSide),e.opacity!==void 0&&(r.opacity=e.opacity),e.transparent!==void 0&&(r.transparent=e.transparent),e.alphaTest!==void 0&&(r.alphaTest=e.alphaTest),e.alphaHash!==void 0&&(r.alphaHash=e.alphaHash),e.depthFunc!==void 0&&(r.depthFunc=e.depthFunc),e.depthTest!==void 0&&(r.depthTest=e.depthTest),e.depthWrite!==void 0&&(r.depthWrite=e.depthWrite),e.colorWrite!==void 0&&(r.colorWrite=e.colorWrite),e.blendSrc!==void 0&&(r.blendSrc=e.blendSrc),e.blendDst!==void 0&&(r.blendDst=e.blendDst),e.blendEquation!==void 0&&(r.blendEquation=e.blendEquation),e.blendSrcAlpha!==void 0&&(r.blendSrcAlpha=e.blendSrcAlpha),e.blendDstAlpha!==void 0&&(r.blendDstAlpha=e.blendDstAlpha),e.blendEquationAlpha!==void 0&&(r.blendEquationAlpha=e.blendEquationAlpha),e.blendColor!==void 0&&r.blendColor!==void 0&&r.blendColor.setHex(e.blendColor),e.blendAlpha!==void 0&&(r.blendAlpha=e.blendAlpha),e.stencilWriteMask!==void 0&&(r.stencilWriteMask=e.stencilWriteMask),e.stencilFunc!==void 0&&(r.stencilFunc=e.stencilFunc),e.stencilRef!==void 0&&(r.stencilRef=e.stencilRef),e.stencilFuncMask!==void 0&&(r.stencilFuncMask=e.stencilFuncMask),e.stencilFail!==void 0&&(r.stencilFail=e.stencilFail),e.stencilZFail!==void 0&&(r.stencilZFail=e.stencilZFail),e.stencilZPass!==void 0&&(r.stencilZPass=e.stencilZPass),e.stencilWrite!==void 0&&(r.stencilWrite=e.stencilWrite),e.wireframe!==void 0&&(r.wireframe=e.wireframe),e.wireframeLinewidth!==void 0&&(r.wireframeLinewidth=e.wireframeLinewidth),e.wireframeLinecap!==void 0&&(r.wireframeLinecap=e.wireframeLinecap),e.wireframeLinejoin!==void 0&&(r.wireframeLinejoin=e.wireframeLinejoin),e.rotation!==void 0&&(r.rotation=e.rotation),e.linewidth!==void 0&&(r.linewidth=e.linewidth),e.dashSize!==void 0&&(r.dashSize=e.dashSize),e.gapSize!==void 0&&(r.gapSize=e.gapSize),e.scale!==void 0&&(r.scale=e.scale),e.polygonOffset!==void 0&&(r.polygonOffset=e.polygonOffset),e.polygonOffsetFactor!==void 0&&(r.polygonOffsetFactor=e.polygonOffsetFactor),e.polygonOffsetUnits!==void 0&&(r.polygonOffsetUnits=e.polygonOffsetUnits),e.dithering!==void 0&&(r.dithering=e.dithering),e.alphaToCoverage!==void 0&&(r.alphaToCoverage=e.alphaToCoverage),e.premultipliedAlpha!==void 0&&(r.premultipliedAlpha=e.premultipliedAlpha),e.forceSinglePass!==void 0&&(r.forceSinglePass=e.forceSinglePass),e.allowOverride!==void 0&&(r.allowOverride=e.allowOverride),e.visible!==void 0&&(r.visible=e.visible),e.toneMapped!==void 0&&(r.toneMapped=e.toneMapped),e.userData!==void 0&&(r.userData=e.userData),e.vertexColors!==void 0&&(typeof e.vertexColors=="number"?r.vertexColors=e.vertexColors>0:r.vertexColors=e.vertexColors),e.uniforms!==void 0)for(const s in e.uniforms){const o=e.uniforms[s];switch(r.uniforms[s]={},o.type){case"t":r.uniforms[s].value=n(o.value);break;case"c":r.uniforms[s].value=new Gt().setHex(o.value);break;case"v2":r.uniforms[s].value=new $e().fromArray(o.value);break;case"v3":r.uniforms[s].value=new ie().fromArray(o.value);break;case"v4":r.uniforms[s].value=new zi().fromArray(o.value);break;case"m3":r.uniforms[s].value=new Un().fromArray(o.value);break;case"m4":r.uniforms[s].value=new vn().fromArray(o.value);break;default:r.uniforms[s].value=o.value}}if(e.defines!==void 0&&(r.defines=e.defines),e.vertexShader!==void 0&&(r.vertexShader=e.vertexShader),e.fragmentShader!==void 0&&(r.fragmentShader=e.fragmentShader),e.glslVersion!==void 0&&(r.glslVersion=e.glslVersion),e.extensions!==void 0)for(const s in e.extensions)r.extensions[s]=e.extensions[s];if(e.lights!==void 0&&(r.lights=e.lights),e.clipping!==void 0&&(r.clipping=e.clipping),e.size!==void 0&&(r.size=e.size),e.sizeAttenuation!==void 0&&(r.sizeAttenuation=e.sizeAttenuation),e.map!==void 0&&(r.map=n(e.map)),e.matcap!==void 0&&(r.matcap=n(e.matcap)),e.alphaMap!==void 0&&(r.alphaMap=n(e.alphaMap)),e.bumpMap!==void 0&&(r.bumpMap=n(e.bumpMap)),e.bumpScale!==void 0&&(r.bumpScale=e.bumpScale),e.normalMap!==void 0&&(r.normalMap=n(e.normalMap)),e.normalMapType!==void 0&&(r.normalMapType=e.normalMapType),e.normalScale!==void 0){let s=e.normalScale;Array.isArray(s)===!1&&(s=[s,s]),r.normalScale=new $e().fromArray(s)}return e.displacementMap!==void 0&&(r.displacementMap=n(e.displacementMap)),e.displacementScale!==void 0&&(r.displacementScale=e.displacementScale),e.displacementBias!==void 0&&(r.displacementBias=e.displacementBias),e.roughnessMap!==void 0&&(r.roughnessMap=n(e.roughnessMap)),e.metalnessMap!==void 0&&(r.metalnessMap=n(e.metalnessMap)),e.emissiveMap!==void 0&&(r.emissiveMap=n(e.emissiveMap)),e.emissiveIntensity!==void 0&&(r.emissiveIntensity=e.emissiveIntensity),e.specularMap!==void 0&&(r.specularMap=n(e.specularMap)),e.specularIntensityMap!==void 0&&(r.specularIntensityMap=n(e.specularIntensityMap)),e.specularColorMap!==void 0&&(r.specularColorMap=n(e.specularColorMap)),e.envMap!==void 0&&(r.envMap=n(e.envMap)),e.envMapRotation!==void 0&&r.envMapRotation.fromArray(e.envMapRotation),e.envMapIntensity!==void 0&&(r.envMapIntensity=e.envMapIntensity),e.reflectivity!==void 0&&(r.reflectivity=e.reflectivity),e.refractionRatio!==void 0&&(r.refractionRatio=e.refractionRatio),e.lightMap!==void 0&&(r.lightMap=n(e.lightMap)),e.lightMapIntensity!==void 0&&(r.lightMapIntensity=e.lightMapIntensity),e.aoMap!==void 0&&(r.aoMap=n(e.aoMap)),e.aoMapIntensity!==void 0&&(r.aoMapIntensity=e.aoMapIntensity),e.gradientMap!==void 0&&(r.gradientMap=n(e.gradientMap)),e.clearcoatMap!==void 0&&(r.clearcoatMap=n(e.clearcoatMap)),e.clearcoatRoughnessMap!==void 0&&(r.clearcoatRoughnessMap=n(e.clearcoatRoughnessMap)),e.clearcoatNormalMap!==void 0&&(r.clearcoatNormalMap=n(e.clearcoatNormalMap)),e.clearcoatNormalScale!==void 0&&(r.clearcoatNormalScale=new $e().fromArray(e.clearcoatNormalScale)),e.iridescenceMap!==void 0&&(r.iridescenceMap=n(e.iridescenceMap)),e.iridescenceThicknessMap!==void 0&&(r.iridescenceThicknessMap=n(e.iridescenceThicknessMap)),e.transmissionMap!==void 0&&(r.transmissionMap=n(e.transmissionMap)),e.thicknessMap!==void 0&&(r.thicknessMap=n(e.thicknessMap)),e.anisotropyMap!==void 0&&(r.anisotropyMap=n(e.anisotropyMap)),e.sheenColorMap!==void 0&&(r.sheenColorMap=n(e.sheenColorMap)),e.sheenRoughnessMap!==void 0&&(r.sheenRoughnessMap=n(e.sheenRoughnessMap)),r}setTextures(e){return this.textures=e,this}createMaterialFromType(e){return zS.createMaterialFromType(e)}static createMaterialFromType(e){const t={ShadowMaterial:AL,SpriteMaterial:fw,RawShaderMaterial:Ew,ShaderMaterial:Gs,PointsMaterial:ES,MeshPhysicalMaterial:cl,MeshStandardMaterial:Cg,MeshPhongMaterial:SL,MeshToonMaterial:EL,MeshNormalMaterial:TL,MeshLambertMaterial:ML,MeshDepthMaterial:FS,MeshDistanceMaterial:Tw,MeshBasicMaterial:to,MeshMatcapMaterial:wL,LineDashedMaterial:CL,LineBasicMaterial:ha,Material:os};return new t[e]}}class uf{static extractUrlBase(e){const t=e.lastIndexOf("/");return t===-1?"./":e.slice(0,t+1)}static resolveURL(e,t){return typeof e!="string"||e===""?"":(/^https?:\/\//i.test(t)&&/^\//.test(e)&&(t=t.replace(/(^https?:\/\/[^\/]+).*/i,"$1")),/^(https?:)?\/\//i.test(e)||/^data:.*,.*$/i.test(e)||/^blob:.*$/i.test(e)?e:t+e)}}class zL extends wn{constructor(){super(),this.isInstancedBufferGeometry=!0,this.type="InstancedBufferGeometry",this.instanceCount=1/0}copy(e){return super.copy(e),this.instanceCount=e.instanceCount,this}toJSON(){const e=super.toJSON();return e.instanceCount=this.instanceCount,e.isInstancedBufferGeometry=!0,e}}class VL extends js{constructor(e){super(e)}load(e,t,n,r){const s=this,o=new zs(s.manager);o.setPath(s.path),o.setRequestHeader(s.requestHeader),o.setWithCredentials(s.withCredentials),o.load(e,function(u){try{t(s.parse(JSON.parse(u)))}catch(f){r?r(f):cn(f),s.manager.itemError(e)}},n,r)}parse(e){const t={},n={};function r(x,E){if(t[E]!==void 0)return t[E];const w=x.interleavedBuffers[E],T=s(x,w.buffer),N=Fm(w.type,T),L=new Sy(N,w.stride);return L.uuid=w.uuid,t[E]=L,L}function s(x,E){if(n[E]!==void 0)return n[E];const w=x.arrayBuffers[E],T=new Uint32Array(w).buffer;return n[E]=T,T}const o=e.isInstancedBufferGeometry?new zL:new wn,u=e.data.index;if(u!==void 0){const x=Fm(u.type,u.array);o.setIndex(new gi(x,1))}const f=e.data.attributes;for(const x in f){const E=f[x];let C;if(E.isInterleavedBufferAttribute){const w=r(e.data,E.data);C=new bf(w,E.itemSize,E.offset,E.normalized)}else{const w=Fm(E.type,E.array),T=E.isInstancedBufferAttribute?$d:gi;C=new T(w,E.itemSize,E.normalized)}E.name!==void 0&&(C.name=E.name),E.usage!==void 0&&C.setUsage(E.usage),o.setAttribute(x,C)}const p=e.data.morphAttributes;if(p)for(const x in p){const E=p[x],C=[];for(let w=0,T=E.length;w<T;w++){const N=E[w];let L;if(N.isInterleavedBufferAttribute){const F=r(e.data,N.data);L=new bf(F,N.itemSize,N.offset,N.normalized)}else{const F=Fm(N.type,N.array);L=new gi(F,N.itemSize,N.normalized)}N.name!==void 0&&(L.name=N.name),C.push(L)}o.morphAttributes[x]=C}e.data.morphTargetsRelative&&(o.morphTargetsRelative=!0);const v=e.data.groups||e.data.drawcalls||e.data.offsets;if(v!==void 0)for(let x=0,E=v.length;x!==E;++x){const C=v[x];o.addGroup(C.start,C.count,C.materialIndex)}const _=e.data.boundingSphere;return _!==void 0&&(o.boundingSphere=new bs().fromJSON(_)),e.name&&(o.name=e.name),e.userData&&(o.userData=e.userData),o}}class v8 extends js{constructor(e){super(e)}load(e,t,n,r){const s=this,o=this.path===""?uf.extractUrlBase(e):this.path;this.resourcePath=this.resourcePath||o;const u=new zs(this.manager);u.setPath(this.path),u.setRequestHeader(this.requestHeader),u.setWithCredentials(this.withCredentials),u.load(e,function(f){let p=null;try{p=JSON.parse(f)}catch(v){r!==void 0&&r(v),v("ObjectLoader: Can't parse "+e+".",v.message);return}const g=p.metadata;if(g===void 0||g.type===void 0||g.type.toLowerCase()==="geometry"){r!==void 0&&r(new Error("THREE.ObjectLoader: Can't load "+e)),cn("ObjectLoader: Can't load "+e);return}s.parse(p,t)},n,r)}async loadAsync(e,t){const n=this,r=this.path===""?uf.extractUrlBase(e):this.path;this.resourcePath=this.resourcePath||r;const s=new zs(this.manager);s.setPath(this.path),s.setRequestHeader(this.requestHeader),s.setWithCredentials(this.withCredentials);const o=await s.loadAsync(e,t),u=JSON.parse(o),f=u.metadata;if(f===void 0||f.type===void 0||f.type.toLowerCase()==="geometry")throw new Error("THREE.ObjectLoader: Can't load "+e);return await n.parseAsync(u)}parse(e,t){const n=this.parseAnimations(e.animations),r=this.parseShapes(e.shapes),s=this.parseGeometries(e.geometries,r),o=this.parseImages(e.images,function(){t!==void 0&&t(p)}),u=this.parseTextures(e.textures,o),f=this.parseMaterials(e.materials,u),p=this.parseObject(e.object,s,f,u,n),g=this.parseSkeletons(e.skeletons,p);if(this.bindSkeletons(p,g),this.bindLightTargets(p),t!==void 0){let v=!1;for(const _ in o)if(o[_].data instanceof HTMLImageElement){v=!0;break}v===!1&&t(p)}return p}async parseAsync(e){const t=this.parseAnimations(e.animations),n=this.parseShapes(e.shapes),r=this.parseGeometries(e.geometries,n),s=await this.parseImagesAsync(e.images),o=this.parseTextures(e.textures,s),u=this.parseMaterials(e.materials,o),f=this.parseObject(e.object,r,u,o,t),p=this.parseSkeletons(e.skeletons,f);return this.bindSkeletons(f,p),this.bindLightTargets(f),f}parseShapes(e){const t={};if(e!==void 0)for(let n=0,r=e.length;n<r;n++){const s=new jd().fromJSON(e[n]);t[s.uuid]=s}return t}parseSkeletons(e,t){const n={},r={};if(t.traverse(function(s){s.isBone&&(r[s.uuid]=s)}),e!==void 0)for(let s=0,o=e.length;s<o;s++){const u=new Ey().fromJSON(e[s],r);n[u.uuid]=u}return n}parseGeometries(e,t){const n={};if(e!==void 0){const r=new VL;for(let s=0,o=e.length;s<o;s++){let u;const f=e[s];switch(f.type){case"BufferGeometry":case"InstancedBufferGeometry":u=r.parse(f);break;default:f.type in gD?u=gD[f.type].fromJSON(f,t):Ht(`ObjectLoader: Unsupported geometry type "${f.type}"`)}u.uuid=f.uuid,f.name!==void 0&&(u.name=f.name),f.userData!==void 0&&(u.userData=f.userData),n[f.uuid]=u}}return n}parseMaterials(e,t){const n={},r={};if(e!==void 0){const s=new zS;s.setTextures(t);for(let o=0,u=e.length;o<u;o++){const f=e[o];n[f.uuid]===void 0&&(n[f.uuid]=s.parse(f)),r[f.uuid]=n[f.uuid]}}return r}parseAnimations(e){const t={};if(e!==void 0)for(let n=0;n<e.length;n++){const r=e[n],s=gg.parse(r);t[s.uuid]=s}return t}parseImages(e,t){const n=this,r={};let s;function o(f){return n.manager.itemStart(f),s.load(f,function(){n.manager.itemEnd(f)},void 0,function(){n.manager.itemError(f),n.manager.itemEnd(f)})}function u(f){if(typeof f=="string"){const p=f,g=/^(\/\/)|([a-z]+:(\/\/)?)/i.test(p)?p:n.resourcePath+p;return o(g)}else return f.data?{data:Fm(f.type,f.data),width:f.width,height:f.height}:null}if(e!==void 0&&e.length>0){const f=new kS(t);s=new ey(f),s.setCrossOrigin(this.crossOrigin);for(let p=0,g=e.length;p<g;p++){const v=e[p],_=v.url;if(Array.isArray(_)){const x=[];for(let E=0,C=_.length;E<C;E++){const w=_[E],T=u(w);T!==null&&(T instanceof HTMLImageElement?x.push(T):x.push(new ll(T.data,T.width,T.height)))}r[v.uuid]=new ef(x)}else{const x=u(v.url);r[v.uuid]=new ef(x)}}}return r}async parseImagesAsync(e){const t=this,n={};let r;async function s(o){if(typeof o=="string"){const u=o,f=/^(\/\/)|([a-z]+:(\/\/)?)/i.test(u)?u:t.resourcePath+u;return await r.loadAsync(f)}else return o.data?{data:Fm(o.type,o.data),width:o.width,height:o.height}:null}if(e!==void 0&&e.length>0){r=new ey(this.manager),r.setCrossOrigin(this.crossOrigin);for(let o=0,u=e.length;o<u;o++){const f=e[o],p=f.url;if(Array.isArray(p)){const g=[];for(let v=0,_=p.length;v<_;v++){const x=p[v],E=await s(x);E!==null&&(E instanceof HTMLImageElement?g.push(E):g.push(new ll(E.data,E.width,E.height)))}n[f.uuid]=new ef(g)}else{const g=await s(f.url);n[f.uuid]=new ef(g)}}}return n}parseTextures(e,t){function n(s,o){return typeof s=="number"?s:(Ht("ObjectLoader.parseTexture: Constant should be in numeric form.",s),o[s])}const r={};if(e!==void 0)for(let s=0,o=e.length;s<o;s++){const u=e[s];u.image===void 0&&Ht('ObjectLoader: No "image" specified for',u.uuid),t[u.image]===void 0&&Ht("ObjectLoader: Undefined image",u.image);const f=t[u.image],p=f.data;let g;Array.isArray(p)?(g=new by,p.length===6&&(g.needsUpdate=!0)):(p&&p.data?g=new ll:g=new Ci,p&&(g.needsUpdate=!0)),g.source=f,g.uuid=u.uuid,u.name!==void 0&&(g.name=u.name),u.mapping!==void 0&&(g.mapping=n(u.mapping,y8)),u.channel!==void 0&&(g.channel=u.channel),u.offset!==void 0&&g.offset.fromArray(u.offset),u.repeat!==void 0&&g.repeat.fromArray(u.repeat),u.center!==void 0&&g.center.fromArray(u.center),u.rotation!==void 0&&(g.rotation=u.rotation),u.wrap!==void 0&&(g.wrapS=n(u.wrap[0],_D),g.wrapT=n(u.wrap[1],_D)),u.format!==void 0&&(g.format=u.format),u.internalFormat!==void 0&&(g.internalFormat=u.internalFormat),u.type!==void 0&&(g.type=u.type),u.colorSpace!==void 0&&(g.colorSpace=u.colorSpace),u.minFilter!==void 0&&(g.minFilter=n(u.minFilter,xD)),u.magFilter!==void 0&&(g.magFilter=n(u.magFilter,xD)),u.anisotropy!==void 0&&(g.anisotropy=u.anisotropy),u.flipY!==void 0&&(g.flipY=u.flipY),u.generateMipmaps!==void 0&&(g.generateMipmaps=u.generateMipmaps),u.premultiplyAlpha!==void 0&&(g.premultiplyAlpha=u.premultiplyAlpha),u.unpackAlignment!==void 0&&(g.unpackAlignment=u.unpackAlignment),u.compareFunction!==void 0&&(g.compareFunction=u.compareFunction),u.userData!==void 0&&(g.userData=u.userData),r[u.uuid]=g}return r}parseObject(e,t,n,r,s){let o;function u(_){return t[_]===void 0&&Ht("ObjectLoader: Undefined geometry",_),t[_]}function f(_){if(_!==void 0){if(Array.isArray(_)){const x=[];for(let E=0,C=_.length;E<C;E++){const w=_[E];n[w]===void 0&&Ht("ObjectLoader: Undefined material",w),x.push(n[w])}return x}return n[_]===void 0&&Ht("ObjectLoader: Undefined material",_),n[_]}}function p(_){return r[_]===void 0&&Ht("ObjectLoader: Undefined texture",_),r[_]}let g,v;switch(e.type){case"Scene":o=new Ay,e.background!==void 0&&(Number.isInteger(e.background)?o.background=new Gt(e.background):o.background=p(e.background)),e.environment!==void 0&&(o.environment=p(e.environment)),e.fog!==void 0&&(e.fog.type==="Fog"?o.fog=new bS(e.fog.color,e.fog.near,e.fog.far):e.fog.type==="FogExp2"&&(o.fog=new xS(e.fog.color,e.fog.density)),e.fog.name!==""&&(o.fog.name=e.fog.name)),e.backgroundBlurriness!==void 0&&(o.backgroundBlurriness=e.backgroundBlurriness),e.backgroundIntensity!==void 0&&(o.backgroundIntensity=e.backgroundIntensity),e.backgroundRotation!==void 0&&o.backgroundRotation.fromArray(e.backgroundRotation),e.environmentIntensity!==void 0&&(o.environmentIntensity=e.environmentIntensity),e.environmentRotation!==void 0&&o.environmentRotation.fromArray(e.environmentRotation);break;case"PerspectiveCamera":o=new hr(e.fov,e.aspect,e.near,e.far),e.focus!==void 0&&(o.focus=e.focus),e.zoom!==void 0&&(o.zoom=e.zoom),e.filmGauge!==void 0&&(o.filmGauge=e.filmGauge),e.filmOffset!==void 0&&(o.filmOffset=e.filmOffset),e.view!==void 0&&(o.view=Object.assign({},e.view));break;case"OrthographicCamera":o=new Ao(e.left,e.right,e.top,e.bottom,e.near,e.far),e.zoom!==void 0&&(o.zoom=e.zoom),e.view!==void 0&&(o.view=Object.assign({},e.view));break;case"AmbientLight":o=new UL(e.color,e.intensity);break;case"DirectionalLight":o=new Pw(e.color,e.intensity),o.target=e.target||"";break;case"PointLight":o=new Nw(e.color,e.intensity,e.distance,e.decay);break;case"RectAreaLight":o=new FL(e.color,e.intensity,e.width,e.height);break;case"SpotLight":o=new Dw(e.color,e.intensity,e.distance,e.angle,e.penumbra,e.decay),o.target=e.target||"";break;case"HemisphereLight":o=new OL(e.color,e.groundColor,e.intensity);break;case"LightProbe":const _=new Bw().fromArray(e.sh);o=new kL(_,e.intensity);break;case"SkinnedMesh":g=u(e.geometry),v=f(e.material),o=new dw(g,v),e.bindMode!==void 0&&(o.bindMode=e.bindMode),e.bindMatrix!==void 0&&o.bindMatrix.fromArray(e.bindMatrix),e.skeleton!==void 0&&(o.skeleton=e.skeleton);break;case"Mesh":g=u(e.geometry),v=f(e.material),o=new rr(g,v);break;case"InstancedMesh":g=u(e.geometry),v=f(e.material);const x=e.count,E=e.instanceMatrix,C=e.instanceColor;o=new pw(g,v,x),o.instanceMatrix=new $d(new Float32Array(E.array),16),C!==void 0&&(o.instanceColor=new $d(new Float32Array(C.array),C.itemSize));break;case"BatchedMesh":g=u(e.geometry),v=f(e.material),o=new lL(e.maxInstanceCount,e.maxVertexCount,e.maxIndexCount,v),o.geometry=g,o.perObjectFrustumCulled=e.perObjectFrustumCulled,o.sortObjects=e.sortObjects,o._drawRanges=e.drawRanges,o._reservedRanges=e.reservedRanges,o._geometryInfo=e.geometryInfo.map(w=>{let T=null,N=null;return w.boundingBox!==void 0&&(T=new xs().fromJSON(w.boundingBox)),w.boundingSphere!==void 0&&(N=new bs().fromJSON(w.boundingSphere)),{...w,boundingBox:T,boundingSphere:N}}),o._instanceInfo=e.instanceInfo,o._availableInstanceIds=e._availableInstanceIds,o._availableGeometryIds=e._availableGeometryIds,o._nextIndexStart=e.nextIndexStart,o._nextVertexStart=e.nextVertexStart,o._geometryCount=e.geometryCount,o._maxInstanceCount=e.maxInstanceCount,o._maxVertexCount=e.maxVertexCount,o._maxIndexCount=e.maxIndexCount,o._geometryInitialized=e.geometryInitialized,o._matricesTexture=p(e.matricesTexture.uuid),o._indirectTexture=p(e.indirectTexture.uuid),e.colorsTexture!==void 0&&(o._colorsTexture=p(e.colorsTexture.uuid)),e.boundingSphere!==void 0&&(o.boundingSphere=new bs().fromJSON(e.boundingSphere)),e.boundingBox!==void 0&&(o.boundingBox=new xs().fromJSON(e.boundingBox));break;case"LOD":o=new oL;break;case"Line":o=new ju(u(e.geometry),f(e.material));break;case"LineLoop":o=new mw(u(e.geometry),f(e.material));break;case"LineSegments":o=new Yl(u(e.geometry),f(e.material));break;case"PointCloud":case"Points":o=new gw(u(e.geometry),f(e.material));break;case"Sprite":o=new aL(f(e.material));break;case"Group":o=new Ou;break;case"Bone":o=new AS;break;default:o=new fi}if(o.uuid=e.uuid,e.name!==void 0&&(o.name=e.name),e.matrix!==void 0?(o.matrix.fromArray(e.matrix),e.matrixAutoUpdate!==void 0&&(o.matrixAutoUpdate=e.matrixAutoUpdate),o.matrixAutoUpdate&&o.matrix.decompose(o.position,o.quaternion,o.scale)):(e.position!==void 0&&o.position.fromArray(e.position),e.rotation!==void 0&&o.rotation.fromArray(e.rotation),e.quaternion!==void 0&&o.quaternion.fromArray(e.quaternion),e.scale!==void 0&&o.scale.fromArray(e.scale)),e.up!==void 0&&o.up.fromArray(e.up),e.castShadow!==void 0&&(o.castShadow=e.castShadow),e.receiveShadow!==void 0&&(o.receiveShadow=e.receiveShadow),e.shadow&&(e.shadow.intensity!==void 0&&(o.shadow.intensity=e.shadow.intensity),e.shadow.bias!==void 0&&(o.shadow.bias=e.shadow.bias),e.shadow.normalBias!==void 0&&(o.shadow.normalBias=e.shadow.normalBias),e.shadow.radius!==void 0&&(o.shadow.radius=e.shadow.radius),e.shadow.mapSize!==void 0&&o.shadow.mapSize.fromArray(e.shadow.mapSize),e.shadow.camera!==void 0&&(o.shadow.camera=this.parseObject(e.shadow.camera))),e.visible!==void 0&&(o.visible=e.visible),e.frustumCulled!==void 0&&(o.frustumCulled=e.frustumCulled),e.renderOrder!==void 0&&(o.renderOrder=e.renderOrder),e.userData!==void 0&&(o.userData=e.userData),e.layers!==void 0&&(o.layers.mask=e.layers),e.children!==void 0){const _=e.children;for(let x=0;x<_.length;x++)o.add(this.parseObject(_[x],t,n,r,s))}if(e.animations!==void 0){const _=e.animations;for(let x=0;x<_.length;x++){const E=_[x];o.animations.push(s[E])}}if(e.type==="LOD"){e.autoUpdate!==void 0&&(o.autoUpdate=e.autoUpdate);const _=e.levels;for(let x=0;x<_.length;x++){const E=_[x],C=o.getObjectByProperty("uuid",E.object);C!==void 0&&o.addLevel(C,E.distance,E.hysteresis)}}return o}bindSkeletons(e,t){Object.keys(t).length!==0&&e.traverse(function(n){if(n.isSkinnedMesh===!0&&n.skeleton!==void 0){const r=t[n.skeleton];r===void 0?Ht("ObjectLoader: No skeleton found with UUID:",n.skeleton):n.bind(r,n.bindMatrix)}})}bindLightTargets(e){e.traverse(function(t){if(t.isDirectionalLight||t.isSpotLight){const n=t.target,r=e.getObjectByProperty("uuid",n);r!==void 0?t.target=r:t.target=new fi}})}}const y8={UVMapping:vf,CubeReflectionMapping:ql,CubeRefractionMapping:yf,EquirectangularReflectionMapping:rg,EquirectangularRefractionMapping:Wv,CubeUVReflectionMapping:Mg},_D={RepeatWrapping:_f,ClampToEdgeWrapping:Sr,MirroredRepeatWrapping:sg},xD={NearestFilter:Pr,NearestMipmapNearestFilter:aS,NearestMipmapLinearFilter:Pd,LinearFilter:Jn,LinearMipmapNearestFilter:qm,LinearMipmapLinearFilter:sl},x1=new WeakMap;class HL extends js{constructor(e){super(e),this.isImageBitmapLoader=!0,typeof createImageBitmap>"u"&&Ht("ImageBitmapLoader: createImageBitmap() not supported."),typeof fetch>"u"&&Ht("ImageBitmapLoader: fetch() not supported."),this.options={premultiplyAlpha:"none"},this._abortController=new AbortController}setOptions(e){return this.options=e,this}load(e,t,n,r){e===void 0&&(e=""),this.path!==void 0&&(e=this.path+e),e=this.manager.resolveURL(e);const s=this,o=Oc.get(`image-bitmap:${e}`);if(o!==void 0){if(s.manager.itemStart(e),o.then){o.then(p=>{if(x1.has(o)===!0)r&&r(x1.get(o)),s.manager.itemError(e),s.manager.itemEnd(e);else return t&&t(p),s.manager.itemEnd(e),p});return}return setTimeout(function(){t&&t(o),s.manager.itemEnd(e)},0),o}const u={};u.credentials=this.crossOrigin==="anonymous"?"same-origin":"include",u.headers=this.requestHeader,u.signal=typeof AbortSignal.any=="function"?AbortSignal.any([this._abortController.signal,this.manager.abortController.signal]):this._abortController.signal;const f=fetch(e,u).then(function(p){return p.blob()}).then(function(p){return createImageBitmap(p,Object.assign(s.options,{colorSpaceConversion:"none"}))}).then(function(p){return Oc.add(`image-bitmap:${e}`,p),t&&t(p),s.manager.itemEnd(e),p}).catch(function(p){r&&r(p),x1.set(f,p),Oc.remove(`image-bitmap:${e}`),s.manager.itemError(e),s.manager.itemEnd(e)});Oc.add(`image-bitmap:${e}`,f),s.manager.itemStart(e)}abort(){return this._abortController.abort(),this._abortController=new AbortController,this}}let zx;class Lw{static getContext(){return zx===void 0&&(zx=new(window.AudioContext||window.webkitAudioContext)),zx}static setContext(e){zx=e}}class _8 extends js{constructor(e){super(e)}load(e,t,n,r){const s=this,o=new zs(this.manager);o.setResponseType("arraybuffer"),o.setPath(this.path),o.setRequestHeader(this.requestHeader),o.setWithCredentials(this.withCredentials),o.load(e,function(f){try{const p=f.slice(0);Lw.getContext().decodeAudioData(p,function(v){t(v)}).catch(u)}catch(p){u(p)}},n,r);function u(f){r?r(f):cn(f),s.manager.itemError(e)}}}const bD=new vn,AD=new vn,gd=new vn;class x8{constructor(){this.type="StereoCamera",this.aspect=1,this.eyeSep=.064,this.cameraL=new hr,this.cameraL.layers.enable(1),this.cameraL.matrixAutoUpdate=!1,this.cameraR=new hr,this.cameraR.layers.enable(2),this.cameraR.matrixAutoUpdate=!1,this._cache={focus:null,fov:null,aspect:null,near:null,far:null,zoom:null,eyeSep:null}}update(e){const t=this._cache;if(t.focus!==e.focus||t.fov!==e.fov||t.aspect!==e.aspect*this.aspect||t.near!==e.near||t.far!==e.far||t.zoom!==e.zoom||t.eyeSep!==this.eyeSep){t.focus=e.focus,t.fov=e.fov,t.aspect=e.aspect*this.aspect,t.near=e.near,t.far=e.far,t.zoom=e.zoom,t.eyeSep=this.eyeSep,gd.copy(e.projectionMatrix);const r=t.eyeSep/2,s=r*t.near/t.focus,o=t.near*Math.tan(Gd*t.fov*.5)/t.zoom;let u,f;AD.elements[12]=-r,bD.elements[12]=r,u=-o*t.aspect+s,f=o*t.aspect+s,gd.elements[0]=2*t.near/(f-u),gd.elements[8]=(f+u)/(f-u),this.cameraL.projectionMatrix.copy(gd),u=-o*t.aspect-s,f=o*t.aspect-s,gd.elements[0]=2*t.near/(f-u),gd.elements[8]=(f+u)/(f-u),this.cameraR.projectionMatrix.copy(gd)}this.cameraL.matrixWorld.copy(e.matrixWorld).multiply(AD),this.cameraR.matrixWorld.copy(e.matrixWorld).multiply(bD)}}class GL extends hr{constructor(e=[]){super(),this.isArrayCamera=!0,this.isMultiViewCamera=!1,this.cameras=e}}class Ow{constructor(e=!0){this.autoStart=e,this.startTime=0,this.oldTime=0,this.elapsedTime=0,this.running=!1}start(){this.startTime=performance.now(),this.oldTime=this.startTime,this.elapsedTime=0,this.running=!0}stop(){this.getElapsedTime(),this.running=!1,this.autoStart=!1}getElapsedTime(){return this.getDelta(),this.elapsedTime}getDelta(){let e=0;if(this.autoStart&&!this.running)return this.start(),0;if(this.running){const t=performance.now();e=(t-this.oldTime)/1e3,this.oldTime=t,this.elapsedTime+=e}return e}}const vd=new ie,b1=new ys,b8=new ie,yd=new ie,_d=new ie;class A8 extends fi{constructor(){super(),this.type="AudioListener",this.context=Lw.getContext(),this.gain=this.context.createGain(),this.gain.connect(this.context.destination),this.filter=null,this.timeDelta=0,this._clock=new Ow}getInput(){return this.gain}removeFilter(){return this.filter!==null&&(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination),this.gain.connect(this.context.destination),this.filter=null),this}getFilter(){return this.filter}setFilter(e){return this.filter!==null?(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination)):this.gain.disconnect(this.context.destination),this.filter=e,this.gain.connect(this.filter),this.filter.connect(this.context.destination),this}getMasterVolume(){return this.gain.gain.value}setMasterVolume(e){return this.gain.gain.setTargetAtTime(e,this.context.currentTime,.01),this}updateMatrixWorld(e){super.updateMatrixWorld(e);const t=this.context.listener;if(this.timeDelta=this._clock.getDelta(),this.matrixWorld.decompose(vd,b1,b8),yd.set(0,0,-1).applyQuaternion(b1),_d.set(0,1,0).applyQuaternion(b1),t.positionX){const n=this.context.currentTime+this.timeDelta;t.positionX.linearRampToValueAtTime(vd.x,n),t.positionY.linearRampToValueAtTime(vd.y,n),t.positionZ.linearRampToValueAtTime(vd.z,n),t.forwardX.linearRampToValueAtTime(yd.x,n),t.forwardY.linearRampToValueAtTime(yd.y,n),t.forwardZ.linearRampToValueAtTime(yd.z,n),t.upX.linearRampToValueAtTime(_d.x,n),t.upY.linearRampToValueAtTime(_d.y,n),t.upZ.linearRampToValueAtTime(_d.z,n)}else t.setPosition(vd.x,vd.y,vd.z),t.setOrientation(yd.x,yd.y,yd.z,_d.x,_d.y,_d.z)}}class jL extends fi{constructor(e){super(),this.type="Audio",this.listener=e,this.context=e.context,this.gain=this.context.createGain(),this.gain.connect(e.getInput()),this.autoplay=!1,this.buffer=null,this.detune=0,this.loop=!1,this.loopStart=0,this.loopEnd=0,this.offset=0,this.duration=void 0,this.playbackRate=1,this.isPlaying=!1,this.hasPlaybackControl=!0,this.source=null,this.sourceType="empty",this._startedAt=0,this._progress=0,this._connected=!1,this.filters=[]}getOutput(){return this.gain}setNodeSource(e){return this.hasPlaybackControl=!1,this.sourceType="audioNode",this.source=e,this.connect(),this}setMediaElementSource(e){return this.hasPlaybackControl=!1,this.sourceType="mediaNode",this.source=this.context.createMediaElementSource(e),this.connect(),this}setMediaStreamSource(e){return this.hasPlaybackControl=!1,this.sourceType="mediaStreamNode",this.source=this.context.createMediaStreamSource(e),this.connect(),this}setBuffer(e){return this.buffer=e,this.sourceType="buffer",this.autoplay&&this.play(),this}play(e=0){if(this.isPlaying===!0){Ht("Audio: Audio is already playing.");return}if(this.hasPlaybackControl===!1){Ht("Audio: this Audio has no playback control.");return}this._startedAt=this.context.currentTime+e;const t=this.context.createBufferSource();return t.buffer=this.buffer,t.loop=this.loop,t.loopStart=this.loopStart,t.loopEnd=this.loopEnd,t.onended=this.onEnded.bind(this),t.start(this._startedAt,this._progress+this.offset,this.duration),this.isPlaying=!0,this.source=t,this.setDetune(this.detune),this.setPlaybackRate(this.playbackRate),this.connect()}pause(){if(this.hasPlaybackControl===!1){Ht("Audio: this Audio has no playback control.");return}return this.isPlaying===!0&&(this._progress+=Math.max(this.context.currentTime-this._startedAt,0)*this.playbackRate,this.loop===!0&&(this._progress=this._progress%(this.duration||this.buffer.duration)),this.source.stop(),this.source.onended=null,this.isPlaying=!1),this}stop(e=0){if(this.hasPlaybackControl===!1){Ht("Audio: this Audio has no playback control.");return}return this._progress=0,this.source!==null&&(this.source.stop(this.context.currentTime+e),this.source.onended=null),this.isPlaying=!1,this}connect(){if(this.filters.length>0){this.source.connect(this.filters[0]);for(let e=1,t=this.filters.length;e<t;e++)this.filters[e-1].connect(this.filters[e]);this.filters[this.filters.length-1].connect(this.getOutput())}else this.source.connect(this.getOutput());return this._connected=!0,this}disconnect(){if(this._connected!==!1){if(this.filters.length>0){this.source.disconnect(this.filters[0]);for(let e=1,t=this.filters.length;e<t;e++)this.filters[e-1].disconnect(this.filters[e]);this.filters[this.filters.length-1].disconnect(this.getOutput())}else this.source.disconnect(this.getOutput());return this._connected=!1,this}}getFilters(){return this.filters}setFilters(e){return e||(e=[]),this._connected===!0?(this.disconnect(),this.filters=e.slice(),this.connect()):this.filters=e.slice(),this}setDetune(e){return this.detune=e,this.isPlaying===!0&&this.source.detune!==void 0&&this.source.detune.setTargetAtTime(this.detune,this.context.currentTime,.01),this}getDetune(){return this.detune}getFilter(){return this.getFilters()[0]}setFilter(e){return this.setFilters(e?[e]:[])}setPlaybackRate(e){if(this.hasPlaybackControl===!1){Ht("Audio: this Audio has no playback control.");return}return this.playbackRate=e,this.isPlaying===!0&&this.source.playbackRate.setTargetAtTime(this.playbackRate,this.context.currentTime,.01),this}getPlaybackRate(){return this.playbackRate}onEnded(){this.isPlaying=!1,this._progress=0}getLoop(){return this.hasPlaybackControl===!1?(Ht("Audio: this Audio has no playback control."),!1):this.loop}setLoop(e){if(this.hasPlaybackControl===!1){Ht("Audio: this Audio has no playback control.");return}return this.loop=e,this.isPlaying===!0&&(this.source.loop=this.loop),this}setLoopStart(e){return this.loopStart=e,this}setLoopEnd(e){return this.loopEnd=e,this}getVolume(){return this.gain.gain.value}setVolume(e){return this.gain.gain.setTargetAtTime(e,this.context.currentTime,.01),this}copy(e,t){return super.copy(e,t),e.sourceType!=="buffer"?(Ht("Audio: Audio source type cannot be copied."),this):(this.autoplay=e.autoplay,this.buffer=e.buffer,this.detune=e.detune,this.loop=e.loop,this.loopStart=e.loopStart,this.loopEnd=e.loopEnd,this.offset=e.offset,this.duration=e.duration,this.playbackRate=e.playbackRate,this.hasPlaybackControl=e.hasPlaybackControl,this.sourceType=e.sourceType,this.filters=e.filters.slice(),this)}clone(e){return new this.constructor(this.listener).copy(this,e)}}const xd=new ie,SD=new ys,S8=new ie,bd=new ie;class E8 extends jL{constructor(e){super(e),this.panner=this.context.createPanner(),this.panner.panningModel="HRTF",this.panner.connect(this.gain)}connect(){return super.connect(),this.panner.connect(this.gain),this}disconnect(){return super.disconnect(),this.panner.disconnect(this.gain),this}getOutput(){return this.panner}getRefDistance(){return this.panner.refDistance}setRefDistance(e){return this.panner.refDistance=e,this}getRolloffFactor(){return this.panner.rolloffFactor}setRolloffFactor(e){return this.panner.rolloffFactor=e,this}getDistanceModel(){return this.panner.distanceModel}setDistanceModel(e){return this.panner.distanceModel=e,this}getMaxDistance(){return this.panner.maxDistance}setMaxDistance(e){return this.panner.maxDistance=e,this}setDirectionalCone(e,t,n){return this.panner.coneInnerAngle=e,this.panner.coneOuterAngle=t,this.panner.coneOuterGain=n,this}updateMatrixWorld(e){if(super.updateMatrixWorld(e),this.hasPlaybackControl===!0&&this.isPlaying===!1)return;this.matrixWorld.decompose(xd,SD,S8),bd.set(0,0,1).applyQuaternion(SD);const t=this.panner;if(t.positionX){const n=this.context.currentTime+this.listener.timeDelta;t.positionX.linearRampToValueAtTime(xd.x,n),t.positionY.linearRampToValueAtTime(xd.y,n),t.positionZ.linearRampToValueAtTime(xd.z,n),t.orientationX.linearRampToValueAtTime(bd.x,n),t.orientationY.linearRampToValueAtTime(bd.y,n),t.orientationZ.linearRampToValueAtTime(bd.z,n)}else t.setPosition(xd.x,xd.y,xd.z),t.setOrientation(bd.x,bd.y,bd.z)}}class T8{constructor(e,t=2048){this.analyser=e.context.createAnalyser(),this.analyser.fftSize=t,this.data=new Uint8Array(this.analyser.frequencyBinCount),e.getOutput().connect(this.analyser)}getFrequencyData(){return this.analyser.getByteFrequencyData(this.data),this.data}getAverageFrequency(){let e=0;const t=this.getFrequencyData();for(let n=0;n<t.length;n++)e+=t[n];return e/t.length}}class WL{constructor(e,t,n){this.binding=e,this.valueSize=n;let r,s,o;switch(t){case"quaternion":r=this._slerp,s=this._slerpAdditive,o=this._setAdditiveIdentityQuaternion,this.buffer=new Float64Array(n*6),this._workIndex=5;break;case"string":case"bool":r=this._select,s=this._select,o=this._setAdditiveIdentityOther,this.buffer=new Array(n*5);break;default:r=this._lerp,s=this._lerpAdditive,o=this._setAdditiveIdentityNumeric,this.buffer=new Float64Array(n*5)}this._mixBufferRegion=r,this._mixBufferRegionAdditive=s,this._setIdentity=o,this._origIndex=3,this._addIndex=4,this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,this.useCount=0,this.referenceCount=0}accumulate(e,t){const n=this.buffer,r=this.valueSize,s=e*r+r;let o=this.cumulativeWeight;if(o===0){for(let u=0;u!==r;++u)n[s+u]=n[u];o=t}else{o+=t;const u=t/o;this._mixBufferRegion(n,s,0,u,r)}this.cumulativeWeight=o}accumulateAdditive(e){const t=this.buffer,n=this.valueSize,r=n*this._addIndex;this.cumulativeWeightAdditive===0&&this._setIdentity(),this._mixBufferRegionAdditive(t,r,0,e,n),this.cumulativeWeightAdditive+=e}apply(e){const t=this.valueSize,n=this.buffer,r=e*t+t,s=this.cumulativeWeight,o=this.cumulativeWeightAdditive,u=this.binding;if(this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,s<1){const f=t*this._origIndex;this._mixBufferRegion(n,r,f,1-s,t)}o>0&&this._mixBufferRegionAdditive(n,r,this._addIndex*t,1,t);for(let f=t,p=t+t;f!==p;++f)if(n[f]!==n[f+t]){u.setValue(n,r);break}}saveOriginalState(){const e=this.binding,t=this.buffer,n=this.valueSize,r=n*this._origIndex;e.getValue(t,r);for(let s=n,o=r;s!==o;++s)t[s]=t[r+s%n];this._setIdentity(),this.cumulativeWeight=0,this.cumulativeWeightAdditive=0}restoreOriginalState(){const e=this.valueSize*3;this.binding.setValue(this.buffer,e)}_setAdditiveIdentityNumeric(){const e=this._addIndex*this.valueSize,t=e+this.valueSize;for(let n=e;n<t;n++)this.buffer[n]=0}_setAdditiveIdentityQuaternion(){this._setAdditiveIdentityNumeric(),this.buffer[this._addIndex*this.valueSize+3]=1}_setAdditiveIdentityOther(){const e=this._origIndex*this.valueSize,t=this._addIndex*this.valueSize;for(let n=0;n<this.valueSize;n++)this.buffer[t+n]=this.buffer[e+n]}_select(e,t,n,r,s){if(r>=.5)for(let o=0;o!==s;++o)e[t+o]=e[n+o]}_slerp(e,t,n,r){ys.slerpFlat(e,t,e,t,e,n,r)}_slerpAdditive(e,t,n,r,s){const o=this._workIndex*s;ys.multiplyQuaternionsFlat(e,o,e,t,e,n),ys.slerpFlat(e,t,e,t,e,o,r)}_lerp(e,t,n,r,s){const o=1-r;for(let u=0;u!==s;++u){const f=t+u;e[f]=e[f]*o+e[n+u]*r}}_lerpAdditive(e,t,n,r,s){for(let o=0;o!==s;++o){const u=t+o;e[u]=e[u]+e[n+o]*r}}}const Uw="\\[\\]\\.:\\/",M8=new RegExp("["+Uw+"]","g"),Fw="[^"+Uw+"]",w8="[^"+Uw.replace("\\.","")+"]",C8=/((?:WC+[\/:])*)/.source.replace("WC",Fw),R8=/(WCOD+)?/.source.replace("WCOD",w8),I8=/(?:\.(WC+)(?:\[(.+)\])?)?/.source.replace("WC",Fw),D8=/\.(WC+)(?:\[(.+)\])?/.source.replace("WC",Fw),N8=new RegExp("^"+C8+R8+I8+D8+"$"),P8=["material","materials","bones","map"];class B8{constructor(e,t,n){const r=n||mi.parseTrackName(t);this._targetGroup=e,this._bindings=e.subscribe_(t,r)}getValue(e,t){this.bind();const n=this._targetGroup.nCachedObjects_,r=this._bindings[n];r!==void 0&&r.getValue(e,t)}setValue(e,t){const n=this._bindings;for(let r=this._targetGroup.nCachedObjects_,s=n.length;r!==s;++r)n[r].setValue(e,t)}bind(){const e=this._bindings;for(let t=this._targetGroup.nCachedObjects_,n=e.length;t!==n;++t)e[t].bind()}unbind(){const e=this._bindings;for(let t=this._targetGroup.nCachedObjects_,n=e.length;t!==n;++t)e[t].unbind()}}class mi{constructor(e,t,n){this.path=t,this.parsedPath=n||mi.parseTrackName(t),this.node=mi.findNode(e,this.parsedPath.nodeName),this.rootNode=e,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}static create(e,t,n){return e&&e.isAnimationObjectGroup?new mi.Composite(e,t,n):new mi(e,t,n)}static sanitizeNodeName(e){return e.replace(/\s/g,"_").replace(M8,"")}static parseTrackName(e){const t=N8.exec(e);if(t===null)throw new Error("PropertyBinding: Cannot parse trackName: "+e);const n={nodeName:t[2],objectName:t[3],objectIndex:t[4],propertyName:t[5],propertyIndex:t[6]},r=n.nodeName&&n.nodeName.lastIndexOf(".");if(r!==void 0&&r!==-1){const s=n.nodeName.substring(r+1);P8.indexOf(s)!==-1&&(n.nodeName=n.nodeName.substring(0,r),n.objectName=s)}if(n.propertyName===null||n.propertyName.length===0)throw new Error("PropertyBinding: can not parse propertyName from trackName: "+e);return n}static findNode(e,t){if(t===void 0||t===""||t==="."||t===-1||t===e.name||t===e.uuid)return e;if(e.skeleton){const n=e.skeleton.getBoneByName(t);if(n!==void 0)return n}if(e.children){const n=function(s){for(let o=0;o<s.length;o++){const u=s[o];if(u.name===t||u.uuid===t)return u;const f=n(u.children);if(f)return f}return null},r=n(e.children);if(r)return r}return null}_getValue_unavailable(){}_setValue_unavailable(){}_getValue_direct(e,t){e[t]=this.targetObject[this.propertyName]}_getValue_array(e,t){const n=this.resolvedProperty;for(let r=0,s=n.length;r!==s;++r)e[t++]=n[r]}_getValue_arrayElement(e,t){e[t]=this.resolvedProperty[this.propertyIndex]}_getValue_toArray(e,t){this.resolvedProperty.toArray(e,t)}_setValue_direct(e,t){this.targetObject[this.propertyName]=e[t]}_setValue_direct_setNeedsUpdate(e,t){this.targetObject[this.propertyName]=e[t],this.targetObject.needsUpdate=!0}_setValue_direct_setMatrixWorldNeedsUpdate(e,t){this.targetObject[this.propertyName]=e[t],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_array(e,t){const n=this.resolvedProperty;for(let r=0,s=n.length;r!==s;++r)n[r]=e[t++]}_setValue_array_setNeedsUpdate(e,t){const n=this.resolvedProperty;for(let r=0,s=n.length;r!==s;++r)n[r]=e[t++];this.targetObject.needsUpdate=!0}_setValue_array_setMatrixWorldNeedsUpdate(e,t){const n=this.resolvedProperty;for(let r=0,s=n.length;r!==s;++r)n[r]=e[t++];this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_arrayElement(e,t){this.resolvedProperty[this.propertyIndex]=e[t]}_setValue_arrayElement_setNeedsUpdate(e,t){this.resolvedProperty[this.propertyIndex]=e[t],this.targetObject.needsUpdate=!0}_setValue_arrayElement_setMatrixWorldNeedsUpdate(e,t){this.resolvedProperty[this.propertyIndex]=e[t],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_fromArray(e,t){this.resolvedProperty.fromArray(e,t)}_setValue_fromArray_setNeedsUpdate(e,t){this.resolvedProperty.fromArray(e,t),this.targetObject.needsUpdate=!0}_setValue_fromArray_setMatrixWorldNeedsUpdate(e,t){this.resolvedProperty.fromArray(e,t),this.targetObject.matrixWorldNeedsUpdate=!0}_getValue_unbound(e,t){this.bind(),this.getValue(e,t)}_setValue_unbound(e,t){this.bind(),this.setValue(e,t)}bind(){let e=this.node;const t=this.parsedPath,n=t.objectName,r=t.propertyName;let s=t.propertyIndex;if(e||(e=mi.findNode(this.rootNode,t.nodeName),this.node=e),this.getValue=this._getValue_unavailable,this.setValue=this._setValue_unavailable,!e){Ht("PropertyBinding: No target node found for track: "+this.path+".");return}if(n){let p=t.objectIndex;switch(n){case"materials":if(!e.material){cn("PropertyBinding: Can not bind to material as node does not have a material.",this);return}if(!e.material.materials){cn("PropertyBinding: Can not bind to material.materials as node.material does not have a materials array.",this);return}e=e.material.materials;break;case"bones":if(!e.skeleton){cn("PropertyBinding: Can not bind to bones as node does not have a skeleton.",this);return}e=e.skeleton.bones;for(let g=0;g<e.length;g++)if(e[g].name===p){p=g;break}break;case"map":if("map"in e){e=e.map;break}if(!e.material){cn("PropertyBinding: Can not bind to material as node does not have a material.",this);return}if(!e.material.map){cn("PropertyBinding: Can not bind to material.map as node.material does not have a map.",this);return}e=e.material.map;break;default:if(e[n]===void 0){cn("PropertyBinding: Can not bind to objectName of node undefined.",this);return}e=e[n]}if(p!==void 0){if(e[p]===void 0){cn("PropertyBinding: Trying to bind to objectIndex of objectName, but is undefined.",this,e);return}e=e[p]}}const o=e[r];if(o===void 0){const p=t.nodeName;cn("PropertyBinding: Trying to update property for track: "+p+"."+r+" but it wasn't found.",e);return}let u=this.Versioning.None;this.targetObject=e,e.isMaterial===!0?u=this.Versioning.NeedsUpdate:e.isObject3D===!0&&(u=this.Versioning.MatrixWorldNeedsUpdate);let f=this.BindingType.Direct;if(s!==void 0){if(r==="morphTargetInfluences"){if(!e.geometry){cn("PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.",this);return}if(!e.geometry.morphAttributes){cn("PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphAttributes.",this);return}e.morphTargetDictionary[s]!==void 0&&(s=e.morphTargetDictionary[s])}f=this.BindingType.ArrayElement,this.resolvedProperty=o,this.propertyIndex=s}else o.fromArray!==void 0&&o.toArray!==void 0?(f=this.BindingType.HasFromToArray,this.resolvedProperty=o):Array.isArray(o)?(f=this.BindingType.EntireArray,this.resolvedProperty=o):this.propertyName=r;this.getValue=this.GetterByBindingType[f],this.setValue=this.SetterByBindingTypeAndVersioning[f][u]}unbind(){this.node=null,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}}mi.Composite=B8;mi.prototype.BindingType={Direct:0,EntireArray:1,ArrayElement:2,HasFromToArray:3};mi.prototype.Versioning={None:0,NeedsUpdate:1,MatrixWorldNeedsUpdate:2};mi.prototype.GetterByBindingType=[mi.prototype._getValue_direct,mi.prototype._getValue_array,mi.prototype._getValue_arrayElement,mi.prototype._getValue_toArray];mi.prototype.SetterByBindingTypeAndVersioning=[[mi.prototype._setValue_direct,mi.prototype._setValue_direct_setNeedsUpdate,mi.prototype._setValue_direct_setMatrixWorldNeedsUpdate],[mi.prototype._setValue_array,mi.prototype._setValue_array_setNeedsUpdate,mi.prototype._setValue_array_setMatrixWorldNeedsUpdate],[mi.prototype._setValue_arrayElement,mi.prototype._setValue_arrayElement_setNeedsUpdate,mi.prototype._setValue_arrayElement_setMatrixWorldNeedsUpdate],[mi.prototype._setValue_fromArray,mi.prototype._setValue_fromArray_setNeedsUpdate,mi.prototype._setValue_fromArray_setMatrixWorldNeedsUpdate]];class L8{constructor(){this.isAnimationObjectGroup=!0,this.uuid=bo(),this._objects=Array.prototype.slice.call(arguments),this.nCachedObjects_=0;const e={};this._indicesByUUID=e;for(let n=0,r=arguments.length;n!==r;++n)e[arguments[n].uuid]=n;this._paths=[],this._parsedPaths=[],this._bindings=[],this._bindingsIndicesByPath={};const t=this;this.stats={objects:{get total(){return t._objects.length},get inUse(){return this.total-t.nCachedObjects_}},get bindingsPerObject(){return t._bindings.length}}}add(){const e=this._objects,t=this._indicesByUUID,n=this._paths,r=this._parsedPaths,s=this._bindings,o=s.length;let u,f=e.length,p=this.nCachedObjects_;for(let g=0,v=arguments.length;g!==v;++g){const _=arguments[g],x=_.uuid;let E=t[x];if(E===void 0){E=f++,t[x]=E,e.push(_);for(let C=0,w=o;C!==w;++C)s[C].push(new mi(_,n[C],r[C]))}else if(E<p){u=e[E];const C=--p,w=e[C];t[w.uuid]=E,e[E]=w,t[x]=C,e[C]=_;for(let T=0,N=o;T!==N;++T){const L=s[T],F=L[C];let G=L[E];L[E]=F,G===void 0&&(G=new mi(_,n[T],r[T])),L[C]=G}}else e[E]!==u&&cn("AnimationObjectGroup: Different objects with the same UUID detected. Clean the caches or recreate your infrastructure when reloading scenes.")}this.nCachedObjects_=p}remove(){const e=this._objects,t=this._indicesByUUID,n=this._bindings,r=n.length;let s=this.nCachedObjects_;for(let o=0,u=arguments.length;o!==u;++o){const f=arguments[o],p=f.uuid,g=t[p];if(g!==void 0&&g>=s){const v=s++,_=e[v];t[_.uuid]=g,e[g]=_,t[p]=v,e[v]=f;for(let x=0,E=r;x!==E;++x){const C=n[x],w=C[v],T=C[g];C[g]=w,C[v]=T}}}this.nCachedObjects_=s}uncache(){const e=this._objects,t=this._indicesByUUID,n=this._bindings,r=n.length;let s=this.nCachedObjects_,o=e.length;for(let u=0,f=arguments.length;u!==f;++u){const p=arguments[u],g=p.uuid,v=t[g];if(v!==void 0)if(delete t[g],v<s){const _=--s,x=e[_],E=--o,C=e[E];t[x.uuid]=v,e[v]=x,t[C.uuid]=_,e[_]=C,e.pop();for(let w=0,T=r;w!==T;++w){const N=n[w],L=N[_],F=N[E];N[v]=L,N[_]=F,N.pop()}}else{const _=--o,x=e[_];_>0&&(t[x.uuid]=v),e[v]=x,e.pop();for(let E=0,C=r;E!==C;++E){const w=n[E];w[v]=w[_],w.pop()}}}this.nCachedObjects_=s}subscribe_(e,t){const n=this._bindingsIndicesByPath;let r=n[e];const s=this._bindings;if(r!==void 0)return s[r];const o=this._paths,u=this._parsedPaths,f=this._objects,p=f.length,g=this.nCachedObjects_,v=new Array(p);r=s.length,n[e]=r,o.push(e),u.push(t),s.push(v);for(let _=g,x=f.length;_!==x;++_){const E=f[_];v[_]=new mi(E,e,t)}return v}unsubscribe_(e){const t=this._bindingsIndicesByPath,n=t[e];if(n!==void 0){const r=this._paths,s=this._parsedPaths,o=this._bindings,u=o.length-1,f=o[u],p=e[u];t[p]=n,o[n]=f,o.pop(),s[n]=s[u],s.pop(),r[n]=r[u],r.pop()}}}class qL{constructor(e,t,n=null,r=t.blendMode){this._mixer=e,this._clip=t,this._localRoot=n,this.blendMode=r;const s=t.tracks,o=s.length,u=new Array(o),f={endingStart:Bd,endingEnd:Bd};for(let p=0;p!==o;++p){const g=s[p].createInterpolant(null);u[p]=g,g.settings=f}this._interpolantSettings=f,this._interpolants=u,this._propertyBindings=new Array(o),this._cacheIndex=null,this._byClipCacheIndex=null,this._timeScaleInterpolant=null,this._weightInterpolant=null,this.loop=kB,this._loopCount=-1,this._startTime=null,this.time=0,this.timeScale=1,this._effectiveTimeScale=1,this.weight=1,this._effectiveWeight=1,this.repetitions=1/0,this.paused=!1,this.enabled=!0,this.clampWhenFinished=!1,this.zeroSlopeAtStart=!0,this.zeroSlopeAtEnd=!0}play(){return this._mixer._activateAction(this),this}stop(){return this._mixer._deactivateAction(this),this.reset()}reset(){return this.paused=!1,this.enabled=!0,this.time=0,this._loopCount=-1,this._startTime=null,this.stopFading().stopWarping()}isRunning(){return this.enabled&&!this.paused&&this.timeScale!==0&&this._startTime===null&&this._mixer._isActiveAction(this)}isScheduled(){return this._mixer._isActiveAction(this)}startAt(e){return this._startTime=e,this}setLoop(e,t){return this.loop=e,this.repetitions=t,this}setEffectiveWeight(e){return this.weight=e,this._effectiveWeight=this.enabled?e:0,this.stopFading()}getEffectiveWeight(){return this._effectiveWeight}fadeIn(e){return this._scheduleFading(e,0,1)}fadeOut(e){return this._scheduleFading(e,1,0)}crossFadeFrom(e,t,n=!1){if(e.fadeOut(t),this.fadeIn(t),n===!0){const r=this._clip.duration,s=e._clip.duration,o=s/r,u=r/s;e.warp(1,o,t),this.warp(u,1,t)}return this}crossFadeTo(e,t,n=!1){return e.crossFadeFrom(this,t,n)}stopFading(){const e=this._weightInterpolant;return e!==null&&(this._weightInterpolant=null,this._mixer._takeBackControlInterpolant(e)),this}setEffectiveTimeScale(e){return this.timeScale=e,this._effectiveTimeScale=this.paused?0:e,this.stopWarping()}getEffectiveTimeScale(){return this._effectiveTimeScale}setDuration(e){return this.timeScale=this._clip.duration/e,this.stopWarping()}syncWith(e){return this.time=e.time,this.timeScale=e.timeScale,this.stopWarping()}halt(e){return this.warp(this._effectiveTimeScale,0,e)}warp(e,t,n){const r=this._mixer,s=r.time,o=this.timeScale;let u=this._timeScaleInterpolant;u===null&&(u=r._lendControlInterpolant(),this._timeScaleInterpolant=u);const f=u.parameterPositions,p=u.sampleValues;return f[0]=s,f[1]=s+n,p[0]=e/o,p[1]=t/o,this}stopWarping(){const e=this._timeScaleInterpolant;return e!==null&&(this._timeScaleInterpolant=null,this._mixer._takeBackControlInterpolant(e)),this}getMixer(){return this._mixer}getClip(){return this._clip}getRoot(){return this._localRoot||this._mixer._root}_update(e,t,n,r){if(!this.enabled){this._updateWeight(e);return}const s=this._startTime;if(s!==null){const f=(e-s)*n;f<0||n===0?t=0:(this._startTime=null,t=n*f)}t*=this._updateTimeScale(e);const o=this._updateTime(t),u=this._updateWeight(e);if(u>0){const f=this._interpolants,p=this._propertyBindings;switch(this.blendMode){case aw:for(let g=0,v=f.length;g!==v;++g)f[g].evaluate(o),p[g].accumulateAdditive(u);break;case dS:default:for(let g=0,v=f.length;g!==v;++g)f[g].evaluate(o),p[g].accumulate(r,u)}}}_updateWeight(e){let t=0;if(this.enabled){t=this.weight;const n=this._weightInterpolant;if(n!==null){const r=n.evaluate(e)[0];t*=r,e>n.parameterPositions[1]&&(this.stopFading(),r===0&&(this.enabled=!1))}}return this._effectiveWeight=t,t}_updateTimeScale(e){let t=0;if(!this.paused){t=this.timeScale;const n=this._timeScaleInterpolant;if(n!==null){const r=n.evaluate(e)[0];t*=r,e>n.parameterPositions[1]&&(this.stopWarping(),t===0?this.paused=!0:this.timeScale=t)}}return this._effectiveTimeScale=t,t}_updateTime(e){const t=this._clip.duration,n=this.loop;let r=this.time+e,s=this._loopCount;const o=n===zB;if(e===0)return s===-1?r:o&&(s&1)===1?t-r:r;if(n===FB){s===-1&&(this._loopCount=0,this._setEndings(!0,!0,!1));e:{if(r>=t)r=t;else if(r<0)r=0;else{this.time=r;break e}this.clampWhenFinished?this.paused=!0:this.enabled=!1,this.time=r,this._mixer.dispatchEvent({type:"finished",action:this,direction:e<0?-1:1})}}else{if(s===-1&&(e>=0?(s=0,this._setEndings(!0,this.repetitions===0,o)):this._setEndings(this.repetitions===0,!0,o)),r>=t||r<0){const u=Math.floor(r/t);r-=t*u,s+=Math.abs(u);const f=this.repetitions-s;if(f<=0)this.clampWhenFinished?this.paused=!0:this.enabled=!1,r=e>0?t:0,this.time=r,this._mixer.dispatchEvent({type:"finished",action:this,direction:e>0?1:-1});else{if(f===1){const p=e<0;this._setEndings(p,!p,o)}else this._setEndings(!1,!1,o);this._loopCount=s,this.time=r,this._mixer.dispatchEvent({type:"loop",action:this,loopDelta:u})}}else this.time=r;if(o&&(s&1)===1)return t-r}return r}_setEndings(e,t,n){const r=this._interpolantSettings;n?(r.endingStart=Ld,r.endingEnd=Ld):(e?r.endingStart=this.zeroSlopeAtStart?Ld:Bd:r.endingStart=qv,t?r.endingEnd=this.zeroSlopeAtEnd?Ld:Bd:r.endingEnd=qv)}_scheduleFading(e,t,n){const r=this._mixer,s=r.time;let o=this._weightInterpolant;o===null&&(o=r._lendControlInterpolant(),this._weightInterpolant=o);const u=o.parameterPositions,f=o.sampleValues;return u[0]=s,f[0]=t,u[1]=s+e,f[1]=n,this}}const O8=new Float32Array(1);class U8 extends Wc{constructor(e){super(),this._root=e,this._initMemoryManager(),this._accuIndex=0,this.time=0,this.timeScale=1}_bindAction(e,t){const n=e._localRoot||this._root,r=e._clip.tracks,s=r.length,o=e._propertyBindings,u=e._interpolants,f=n.uuid,p=this._bindingsByRootAndName;let g=p[f];g===void 0&&(g={},p[f]=g);for(let v=0;v!==s;++v){const _=r[v],x=_.name;let E=g[x];if(E!==void 0)++E.referenceCount,o[v]=E;else{if(E=o[v],E!==void 0){E._cacheIndex===null&&(++E.referenceCount,this._addInactiveBinding(E,f,x));continue}const C=t&&t._propertyBindings[v].binding.parsedPath;E=new WL(mi.create(n,x,C),_.ValueTypeName,_.getValueSize()),++E.referenceCount,this._addInactiveBinding(E,f,x),o[v]=E}u[v].resultBuffer=E.buffer}}_activateAction(e){if(!this._isActiveAction(e)){if(e._cacheIndex===null){const n=(e._localRoot||this._root).uuid,r=e._clip.uuid,s=this._actionsByClip[r];this._bindAction(e,s&&s.knownActions[0]),this._addInactiveAction(e,r,n)}const t=e._propertyBindings;for(let n=0,r=t.length;n!==r;++n){const s=t[n];s.useCount++===0&&(this._lendBinding(s),s.saveOriginalState())}this._lendAction(e)}}_deactivateAction(e){if(this._isActiveAction(e)){const t=e._propertyBindings;for(let n=0,r=t.length;n!==r;++n){const s=t[n];--s.useCount===0&&(s.restoreOriginalState(),this._takeBackBinding(s))}this._takeBackAction(e)}}_initMemoryManager(){this._actions=[],this._nActiveActions=0,this._actionsByClip={},this._bindings=[],this._nActiveBindings=0,this._bindingsByRootAndName={},this._controlInterpolants=[],this._nActiveControlInterpolants=0;const e=this;this.stats={actions:{get total(){return e._actions.length},get inUse(){return e._nActiveActions}},bindings:{get total(){return e._bindings.length},get inUse(){return e._nActiveBindings}},controlInterpolants:{get total(){return e._controlInterpolants.length},get inUse(){return e._nActiveControlInterpolants}}}}_isActiveAction(e){const t=e._cacheIndex;return t!==null&&t<this._nActiveActions}_addInactiveAction(e,t,n){const r=this._actions,s=this._actionsByClip;let o=s[t];if(o===void 0)o={knownActions:[e],actionByRoot:{}},e._byClipCacheIndex=0,s[t]=o;else{const u=o.knownActions;e._byClipCacheIndex=u.length,u.push(e)}e._cacheIndex=r.length,r.push(e),o.actionByRoot[n]=e}_removeInactiveAction(e){const t=this._actions,n=t[t.length-1],r=e._cacheIndex;n._cacheIndex=r,t[r]=n,t.pop(),e._cacheIndex=null;const s=e._clip.uuid,o=this._actionsByClip,u=o[s],f=u.knownActions,p=f[f.length-1],g=e._byClipCacheIndex;p._byClipCacheIndex=g,f[g]=p,f.pop(),e._byClipCacheIndex=null;const v=u.actionByRoot,_=(e._localRoot||this._root).uuid;delete v[_],f.length===0&&delete o[s],this._removeInactiveBindingsForAction(e)}_removeInactiveBindingsForAction(e){const t=e._propertyBindings;for(let n=0,r=t.length;n!==r;++n){const s=t[n];--s.referenceCount===0&&this._removeInactiveBinding(s)}}_lendAction(e){const t=this._actions,n=e._cacheIndex,r=this._nActiveActions++,s=t[r];e._cacheIndex=r,t[r]=e,s._cacheIndex=n,t[n]=s}_takeBackAction(e){const t=this._actions,n=e._cacheIndex,r=--this._nActiveActions,s=t[r];e._cacheIndex=r,t[r]=e,s._cacheIndex=n,t[n]=s}_addInactiveBinding(e,t,n){const r=this._bindingsByRootAndName,s=this._bindings;let o=r[t];o===void 0&&(o={},r[t]=o),o[n]=e,e._cacheIndex=s.length,s.push(e)}_removeInactiveBinding(e){const t=this._bindings,n=e.binding,r=n.rootNode.uuid,s=n.path,o=this._bindingsByRootAndName,u=o[r],f=t[t.length-1],p=e._cacheIndex;f._cacheIndex=p,t[p]=f,t.pop(),delete u[s],Object.keys(u).length===0&&delete o[r]}_lendBinding(e){const t=this._bindings,n=e._cacheIndex,r=this._nActiveBindings++,s=t[r];e._cacheIndex=r,t[r]=e,s._cacheIndex=n,t[n]=s}_takeBackBinding(e){const t=this._bindings,n=e._cacheIndex,r=--this._nActiveBindings,s=t[r];e._cacheIndex=r,t[r]=e,s._cacheIndex=n,t[n]=s}_lendControlInterpolant(){const e=this._controlInterpolants,t=this._nActiveControlInterpolants++;let n=e[t];return n===void 0&&(n=new ww(new Float32Array(2),new Float32Array(2),1,O8),n.__cacheIndex=t,e[t]=n),n}_takeBackControlInterpolant(e){const t=this._controlInterpolants,n=e.__cacheIndex,r=--this._nActiveControlInterpolants,s=t[r];e.__cacheIndex=r,t[r]=e,s.__cacheIndex=n,t[n]=s}clipAction(e,t,n){const r=t||this._root,s=r.uuid;let o=typeof e=="string"?gg.findByName(r,e):e;const u=o!==null?o.uuid:e,f=this._actionsByClip[u];let p=null;if(n===void 0&&(o!==null?n=o.blendMode:n=dS),f!==void 0){const v=f.actionByRoot[s];if(v!==void 0&&v.blendMode===n)return v;p=f.knownActions[0],o===null&&(o=p._clip)}if(o===null)return null;const g=new qL(this,o,t,n);return this._bindAction(g,p),this._addInactiveAction(g,u,s),g}existingAction(e,t){const n=t||this._root,r=n.uuid,s=typeof e=="string"?gg.findByName(n,e):e,o=s?s.uuid:e,u=this._actionsByClip[o];return u!==void 0&&u.actionByRoot[r]||null}stopAllAction(){const e=this._actions,t=this._nActiveActions;for(let n=t-1;n>=0;--n)e[n].stop();return this}update(e){e*=this.timeScale;const t=this._actions,n=this._nActiveActions,r=this.time+=e,s=Math.sign(e),o=this._accuIndex^=1;for(let p=0;p!==n;++p)t[p]._update(r,e,s,o);const u=this._bindings,f=this._nActiveBindings;for(let p=0;p!==f;++p)u[p].apply(o);return this}setTime(e){this.time=0;for(let t=0;t<this._actions.length;t++)this._actions[t].time=0;return this.update(e)}getRoot(){return this._root}uncacheClip(e){const t=this._actions,n=e.uuid,r=this._actionsByClip,s=r[n];if(s!==void 0){const o=s.knownActions;for(let u=0,f=o.length;u!==f;++u){const p=o[u];this._deactivateAction(p);const g=p._cacheIndex,v=t[t.length-1];p._cacheIndex=null,p._byClipCacheIndex=null,v._cacheIndex=g,t[g]=v,t.pop(),this._removeInactiveBindingsForAction(p)}delete r[n]}}uncacheRoot(e){const t=e.uuid,n=this._actionsByClip;for(const o in n){const u=n[o].actionByRoot,f=u[t];f!==void 0&&(this._deactivateAction(f),this._removeInactiveAction(f))}const r=this._bindingsByRootAndName,s=r[t];if(s!==void 0)for(const o in s){const u=s[o];u.restoreOriginalState(),this._removeInactiveBinding(u)}}uncacheAction(e,t){const n=this.existingAction(e,t);n!==null&&(this._deactivateAction(n),this._removeInactiveAction(n))}}class F8 extends cw{constructor(e=1,t=1,n=1,r={}){super(e,t,r),this.isRenderTarget3D=!0,this.depth=n,this.texture=new vS(null,e,t,n),this._setTextureOptions(r),this.texture.isRenderTargetTexture=!0}}class kw{constructor(e){this.value=e}clone(){return new kw(this.value.clone===void 0?this.value:this.value.clone())}}let k8=0;class z8 extends Wc{constructor(){super(),this.isUniformsGroup=!0,Object.defineProperty(this,"id",{value:k8++}),this.name="",this.usage=Yv,this.uniforms=[]}add(e){return this.uniforms.push(e),this}remove(e){const t=this.uniforms.indexOf(e);return t!==-1&&this.uniforms.splice(t,1),this}setName(e){return this.name=e,this}setUsage(e){return this.usage=e,this}dispose(){this.dispatchEvent({type:"dispose"})}copy(e){this.name=e.name,this.usage=e.usage;const t=e.uniforms;this.uniforms.length=0;for(let n=0,r=t.length;n<r;n++){const s=Array.isArray(t[n])?t[n]:[t[n]];for(let o=0;o<s.length;o++)this.uniforms.push(s[o].clone())}return this}clone(){return new this.constructor().copy(this)}}class V8 extends Sy{constructor(e,t,n=1){super(e,t),this.isInstancedInterleavedBuffer=!0,this.meshPerAttribute=n}copy(e){return super.copy(e),this.meshPerAttribute=e.meshPerAttribute,this}clone(e){const t=super.clone(e);return t.meshPerAttribute=this.meshPerAttribute,t}toJSON(e){const t=super.toJSON(e);return t.isInstancedInterleavedBuffer=!0,t.meshPerAttribute=this.meshPerAttribute,t}}class H8{constructor(e,t,n,r,s,o=!1){this.isGLBufferAttribute=!0,this.name="",this.buffer=e,this.type=t,this.itemSize=n,this.elementSize=r,this.count=s,this.normalized=o,this.version=0}set needsUpdate(e){e===!0&&this.version++}setBuffer(e){return this.buffer=e,this}setType(e,t){return this.type=e,this.elementSize=t,this}setItemSize(e){return this.itemSize=e,this}setCount(e){return this.count=e,this}}const ED=new vn;class zw{constructor(e,t,n=0,r=1/0){this.ray=new hp(e,t),this.near=n,this.far=r,this.camera=null,this.layers=new dg,this.params={Mesh:{},Line:{threshold:1},LOD:{},Points:{threshold:1},Sprite:{}}}set(e,t){this.ray.set(e,t)}setFromCamera(e,t){t.isPerspectiveCamera?(this.ray.origin.setFromMatrixPosition(t.matrixWorld),this.ray.direction.set(e.x,e.y,.5).unproject(t).sub(this.ray.origin).normalize(),this.camera=t):t.isOrthographicCamera?(this.ray.origin.set(e.x,e.y,(t.near+t.far)/(t.near-t.far)).unproject(t),this.ray.direction.set(0,0,-1).transformDirection(t.matrixWorld),this.camera=t):cn("Raycaster: Unsupported camera type: "+t.type)}setFromXRController(e){return ED.identity().extractRotation(e.matrixWorld),this.ray.origin.setFromMatrixPosition(e.matrixWorld),this.ray.direction.set(0,0,-1).applyMatrix4(ED),this}intersectObject(e,t=!0,n=[]){return BT(e,this,n,t),n.sort(TD),n}intersectObjects(e,t=!0,n=[]){for(let r=0,s=e.length;r<s;r++)BT(e[r],this,n,t);return n.sort(TD),n}}function TD(i,e){return i.distance-e.distance}function BT(i,e,t,n){let r=!0;if(i.layers.test(e.layers)&&i.raycast(e,t)===!1&&(r=!1),r===!0&&n===!0){const s=i.children;for(let o=0,u=s.length;o<u;o++)BT(s[o],e,t,!0)}}class G8{constructor(){this._previousTime=0,this._currentTime=0,this._startTime=performance.now(),this._delta=0,this._elapsed=0,this._timescale=1,this._document=null,this._pageVisibilityHandler=null}connect(e){this._document=e,e.hidden!==void 0&&(this._pageVisibilityHandler=j8.bind(this),e.addEventListener("visibilitychange",this._pageVisibilityHandler,!1))}disconnect(){this._pageVisibilityHandler!==null&&(this._document.removeEventListener("visibilitychange",this._pageVisibilityHandler),this._pageVisibilityHandler=null),this._document=null}getDelta(){return this._delta/1e3}getElapsed(){return this._elapsed/1e3}getTimescale(){return this._timescale}setTimescale(e){return this._timescale=e,this}reset(){return this._currentTime=performance.now()-this._startTime,this}dispose(){this.disconnect()}update(e){return this._pageVisibilityHandler!==null&&this._document.hidden===!0?this._delta=0:(this._previousTime=this._currentTime,this._currentTime=(e!==void 0?e:performance.now())-this._startTime,this._delta=(this._currentTime-this._previousTime)*this._timescale,this._elapsed+=this._delta),this}}function j8(){this._document.hidden===!1&&this.reset()}class LT{constructor(e=1,t=0,n=0){this.radius=e,this.phi=t,this.theta=n}set(e,t,n){return this.radius=e,this.phi=t,this.theta=n,this}copy(e){return this.radius=e.radius,this.phi=e.phi,this.theta=e.theta,this}makeSafe(){return this.phi=An(this.phi,1e-6,Math.PI-1e-6),this}setFromVector3(e){return this.setFromCartesianCoords(e.x,e.y,e.z)}setFromCartesianCoords(e,t,n){return this.radius=Math.sqrt(e*e+t*t+n*n),this.radius===0?(this.theta=0,this.phi=0):(this.theta=Math.atan2(e,n),this.phi=Math.acos(An(t/this.radius,-1,1))),this}clone(){return new this.constructor().copy(this)}}class W8{constructor(e=1,t=0,n=0){this.radius=e,this.theta=t,this.y=n}set(e,t,n){return this.radius=e,this.theta=t,this.y=n,this}copy(e){return this.radius=e.radius,this.theta=e.theta,this.y=e.y,this}setFromVector3(e){return this.setFromCartesianCoords(e.x,e.y,e.z)}setFromCartesianCoords(e,t,n){return this.radius=Math.sqrt(e*e+n*n),this.theta=Math.atan2(e,n),this.y=t,this}clone(){return new this.constructor().copy(this)}}class Vw{constructor(e,t,n,r){Vw.prototype.isMatrix2=!0,this.elements=[1,0,0,1],e!==void 0&&this.set(e,t,n,r)}identity(){return this.set(1,0,0,1),this}fromArray(e,t=0){for(let n=0;n<4;n++)this.elements[n]=e[n+t];return this}set(e,t,n,r){const s=this.elements;return s[0]=e,s[2]=t,s[1]=n,s[3]=r,this}}const MD=new $e;class q8{constructor(e=new $e(1/0,1/0),t=new $e(-1/0,-1/0)){this.isBox2=!0,this.min=e,this.max=t}set(e,t){return this.min.copy(e),this.max.copy(t),this}setFromPoints(e){this.makeEmpty();for(let t=0,n=e.length;t<n;t++)this.expandByPoint(e[t]);return this}setFromCenterAndSize(e,t){const n=MD.copy(t).multiplyScalar(.5);return this.min.copy(e).sub(n),this.max.copy(e).add(n),this}clone(){return new this.constructor().copy(this)}copy(e){return this.min.copy(e.min),this.max.copy(e.max),this}makeEmpty(){return this.min.x=this.min.y=1/0,this.max.x=this.max.y=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y}getCenter(e){return this.isEmpty()?e.set(0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(e){return this.isEmpty()?e.set(0,0):e.subVectors(this.max,this.min)}expandByPoint(e){return this.min.min(e),this.max.max(e),this}expandByVector(e){return this.min.sub(e),this.max.add(e),this}expandByScalar(e){return this.min.addScalar(-e),this.max.addScalar(e),this}containsPoint(e){return e.x>=this.min.x&&e.x<=this.max.x&&e.y>=this.min.y&&e.y<=this.max.y}containsBox(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y}getParameter(e,t){return t.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y))}intersectsBox(e){return e.max.x>=this.min.x&&e.min.x<=this.max.x&&e.max.y>=this.min.y&&e.min.y<=this.max.y}clampPoint(e,t){return t.copy(e).clamp(this.min,this.max)}distanceToPoint(e){return this.clampPoint(e,MD).distanceTo(e)}intersect(e){return this.min.max(e.min),this.max.min(e.max),this.isEmpty()&&this.makeEmpty(),this}union(e){return this.min.min(e.min),this.max.max(e.max),this}translate(e){return this.min.add(e),this.max.add(e),this}equals(e){return e.min.equals(this.min)&&e.max.equals(this.max)}}const wD=new ie,Vx=new ie,Cm=new ie,Rm=new ie,A1=new ie,X8=new ie,Y8=new ie;class J8{constructor(e=new ie,t=new ie){this.start=e,this.end=t}set(e,t){return this.start.copy(e),this.end.copy(t),this}copy(e){return this.start.copy(e.start),this.end.copy(e.end),this}getCenter(e){return e.addVectors(this.start,this.end).multiplyScalar(.5)}delta(e){return e.subVectors(this.end,this.start)}distanceSq(){return this.start.distanceToSquared(this.end)}distance(){return this.start.distanceTo(this.end)}at(e,t){return this.delta(t).multiplyScalar(e).add(this.start)}closestPointToPointParameter(e,t){wD.subVectors(e,this.start),Vx.subVectors(this.end,this.start);const n=Vx.dot(Vx);let s=Vx.dot(wD)/n;return t&&(s=An(s,0,1)),s}closestPointToPoint(e,t,n){const r=this.closestPointToPointParameter(e,t);return this.delta(n).multiplyScalar(r).add(this.start)}distanceSqToLine3(e,t=X8,n=Y8){const r=10000000000000001e-32;let s,o;const u=this.start,f=e.start,p=this.end,g=e.end;Cm.subVectors(p,u),Rm.subVectors(g,f),A1.subVectors(u,f);const v=Cm.dot(Cm),_=Rm.dot(Rm),x=Rm.dot(A1);if(v<=r&&_<=r)return t.copy(u),n.copy(f),t.sub(n),t.dot(t);if(v<=r)s=0,o=x/_,o=An(o,0,1);else{const E=Cm.dot(A1);if(_<=r)o=0,s=An(-E/v,0,1);else{const C=Cm.dot(Rm),w=v*_-C*C;w!==0?s=An((C*x-E*_)/w,0,1):s=0,o=(C*s+x)/_,o<0?(o=0,s=An(-E/v,0,1)):o>1&&(o=1,s=An((C-E)/v,0,1))}}return t.copy(u).add(Cm.multiplyScalar(s)),n.copy(f).add(Rm.multiplyScalar(o)),t.sub(n),t.dot(t)}applyMatrix4(e){return this.start.applyMatrix4(e),this.end.applyMatrix4(e),this}equals(e){return e.start.equals(this.start)&&e.end.equals(this.end)}clone(){return new this.constructor().copy(this)}}const CD=new ie;class K8 extends fi{constructor(e,t){super(),this.light=e,this.matrixAutoUpdate=!1,this.color=t,this.type="SpotLightHelper";const n=new wn,r=[0,0,0,0,0,1,0,0,0,1,0,1,0,0,0,-1,0,1,0,0,0,0,1,1,0,0,0,0,-1,1];for(let o=0,u=1,f=32;o<f;o++,u++){const p=o/f*Math.PI*2,g=u/f*Math.PI*2;r.push(Math.cos(p),Math.sin(p),1,Math.cos(g),Math.sin(g),1)}n.setAttribute("position",new tn(r,3));const s=new ha({fog:!1,toneMapped:!1});this.cone=new Yl(n,s),this.add(this.cone),this.update()}dispose(){this.cone.geometry.dispose(),this.cone.material.dispose()}update(){this.light.updateWorldMatrix(!0,!1),this.light.target.updateWorldMatrix(!0,!1),this.parent?(this.parent.updateWorldMatrix(!0),this.matrix.copy(this.parent.matrixWorld).invert().multiply(this.light.matrixWorld)):this.matrix.copy(this.light.matrixWorld),this.matrixWorld.copy(this.light.matrixWorld);const e=this.light.distance?this.light.distance:1e3,t=e*Math.tan(this.light.angle);this.cone.scale.set(t,t,e),CD.setFromMatrixPosition(this.light.target.matrixWorld),this.cone.lookAt(CD),this.color!==void 0?this.cone.material.color.set(this.color):this.cone.material.color.copy(this.light.color)}}const Wh=new ie,Hx=new vn,S1=new vn;class Q8 extends Yl{constructor(e){const t=XL(e),n=new wn,r=[],s=[];for(let p=0;p<t.length;p++){const g=t[p];g.parent&&g.parent.isBone&&(r.push(0,0,0),r.push(0,0,0),s.push(0,0,0),s.push(0,0,0))}n.setAttribute("position",new tn(r,3)),n.setAttribute("color",new tn(s,3));const o=new ha({vertexColors:!0,depthTest:!1,depthWrite:!1,toneMapped:!1,transparent:!0});super(n,o),this.isSkeletonHelper=!0,this.type="SkeletonHelper",this.root=e,this.bones=t,this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1;const u=new Gt(255),f=new Gt(65280);this.setColors(u,f)}updateMatrixWorld(e){const t=this.bones,n=this.geometry,r=n.getAttribute("position");S1.copy(this.root.matrixWorld).invert();for(let s=0,o=0;s<t.length;s++){const u=t[s];u.parent&&u.parent.isBone&&(Hx.multiplyMatrices(S1,u.matrixWorld),Wh.setFromMatrixPosition(Hx),r.setXYZ(o,Wh.x,Wh.y,Wh.z),Hx.multiplyMatrices(S1,u.parent.matrixWorld),Wh.setFromMatrixPosition(Hx),r.setXYZ(o+1,Wh.x,Wh.y,Wh.z),o+=2)}n.getAttribute("position").needsUpdate=!0,super.updateMatrixWorld(e)}setColors(e,t){const r=this.geometry.getAttribute("color");for(let s=0;s<r.count;s+=2)r.setXYZ(s,e.r,e.g,e.b),r.setXYZ(s+1,t.r,t.g,t.b);return r.needsUpdate=!0,this}dispose(){this.geometry.dispose(),this.material.dispose()}}function XL(i){const e=[];i.isBone===!0&&e.push(i);for(let t=0;t<i.children.length;t++)e.push(...XL(i.children[t]));return e}class Z8 extends rr{constructor(e,t,n){const r=new Ry(t,4,2),s=new to({wireframe:!0,fog:!1,toneMapped:!1});super(r,s),this.light=e,this.color=n,this.type="PointLightHelper",this.matrix=this.light.matrixWorld,this.matrixAutoUpdate=!1,this.update()}dispose(){this.geometry.dispose(),this.material.dispose()}update(){this.light.updateWorldMatrix(!0,!1),this.color!==void 0?this.material.color.set(this.color):this.material.color.copy(this.light.color)}}const $8=new ie,RD=new Gt,ID=new Gt;class e2 extends fi{constructor(e,t,n){super(),this.light=e,this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.color=n,this.type="HemisphereLightHelper";const r=new Cy(t);r.rotateY(Math.PI*.5),this.material=new to({wireframe:!0,fog:!1,toneMapped:!1}),this.color===void 0&&(this.material.vertexColors=!0);const s=r.getAttribute("position"),o=new Float32Array(s.count*3);r.setAttribute("color",new gi(o,3)),this.add(new rr(r,this.material)),this.update()}dispose(){this.children[0].geometry.dispose(),this.children[0].material.dispose()}update(){const e=this.children[0];if(this.color!==void 0)this.material.color.set(this.color);else{const t=e.geometry.getAttribute("color");RD.copy(this.light.color),ID.copy(this.light.groundColor);for(let n=0,r=t.count;n<r;n++){const s=n<r/2?RD:ID;t.setXYZ(n,s.r,s.g,s.b)}t.needsUpdate=!0}this.light.updateWorldMatrix(!0,!1),e.lookAt($8.setFromMatrixPosition(this.light.matrixWorld).negate())}}class t2 extends Yl{constructor(e=10,t=10,n=4473924,r=8947848){n=new Gt(n),r=new Gt(r);const s=t/2,o=e/t,u=e/2,f=[],p=[];for(let _=0,x=0,E=-u;_<=t;_++,E+=o){f.push(-u,0,E,u,0,E),f.push(E,0,-u,E,0,u);const C=_===s?n:r;C.toArray(p,x),x+=3,C.toArray(p,x),x+=3,C.toArray(p,x),x+=3,C.toArray(p,x),x+=3}const g=new wn;g.setAttribute("position",new tn(f,3)),g.setAttribute("color",new tn(p,3));const v=new ha({vertexColors:!0,toneMapped:!1});super(g,v),this.type="GridHelper"}dispose(){this.geometry.dispose(),this.material.dispose()}}class n2 extends Yl{constructor(e=10,t=16,n=8,r=64,s=4473924,o=8947848){s=new Gt(s),o=new Gt(o);const u=[],f=[];if(t>1)for(let v=0;v<t;v++){const _=v/t*(Math.PI*2),x=Math.sin(_)*e,E=Math.cos(_)*e;u.push(0,0,0),u.push(x,0,E);const C=v&1?s:o;f.push(C.r,C.g,C.b),f.push(C.r,C.g,C.b)}for(let v=0;v<n;v++){const _=v&1?s:o,x=e-e/n*v;for(let E=0;E<r;E++){let C=E/r*(Math.PI*2),w=Math.sin(C)*x,T=Math.cos(C)*x;u.push(w,0,T),f.push(_.r,_.g,_.b),C=(E+1)/r*(Math.PI*2),w=Math.sin(C)*x,T=Math.cos(C)*x,u.push(w,0,T),f.push(_.r,_.g,_.b)}}const p=new wn;p.setAttribute("position",new tn(u,3)),p.setAttribute("color",new tn(f,3));const g=new ha({vertexColors:!0,toneMapped:!1});super(p,g),this.type="PolarGridHelper"}dispose(){this.geometry.dispose(),this.material.dispose()}}const DD=new ie,Gx=new ie,ND=new ie;class i2 extends fi{constructor(e,t,n){super(),this.light=e,this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.color=n,this.type="DirectionalLightHelper",t===void 0&&(t=1);let r=new wn;r.setAttribute("position",new tn([-t,t,0,t,t,0,t,-t,0,-t,-t,0,-t,t,0],3));const s=new ha({fog:!1,toneMapped:!1});this.lightPlane=new ju(r,s),this.add(this.lightPlane),r=new wn,r.setAttribute("position",new tn([0,0,0,0,0,1],3)),this.targetLine=new ju(r,s),this.add(this.targetLine),this.update()}dispose(){this.lightPlane.geometry.dispose(),this.lightPlane.material.dispose(),this.targetLine.geometry.dispose(),this.targetLine.material.dispose()}update(){this.light.updateWorldMatrix(!0,!1),this.light.target.updateWorldMatrix(!0,!1),DD.setFromMatrixPosition(this.light.matrixWorld),Gx.setFromMatrixPosition(this.light.target.matrixWorld),ND.subVectors(Gx,DD),this.lightPlane.lookAt(Gx),this.color!==void 0?(this.lightPlane.material.color.set(this.color),this.targetLine.material.color.set(this.color)):(this.lightPlane.material.color.copy(this.light.color),this.targetLine.material.color.copy(this.light.color)),this.targetLine.lookAt(Gx),this.targetLine.scale.z=ND.length()}}const jx=new ie,Dr=new yS;class r2 extends Yl{constructor(e){const t=new wn,n=new ha({color:16777215,vertexColors:!0,toneMapped:!1}),r=[],s=[],o={};u("n1","n2"),u("n2","n4"),u("n4","n3"),u("n3","n1"),u("f1","f2"),u("f2","f4"),u("f4","f3"),u("f3","f1"),u("n1","f1"),u("n2","f2"),u("n3","f3"),u("n4","f4"),u("p","n1"),u("p","n2"),u("p","n3"),u("p","n4"),u("u1","u2"),u("u2","u3"),u("u3","u1"),u("c","t"),u("p","c"),u("cn1","cn2"),u("cn3","cn4"),u("cf1","cf2"),u("cf3","cf4");function u(E,C){f(E),f(C)}function f(E){r.push(0,0,0),s.push(0,0,0),o[E]===void 0&&(o[E]=[]),o[E].push(r.length/3-1)}t.setAttribute("position",new tn(r,3)),t.setAttribute("color",new tn(s,3)),super(t,n),this.type="CameraHelper",this.camera=e,this.camera.updateProjectionMatrix&&this.camera.updateProjectionMatrix(),this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.pointMap=o,this.update();const p=new Gt(16755200),g=new Gt(16711680),v=new Gt(43775),_=new Gt(16777215),x=new Gt(3355443);this.setColors(p,g,v,_,x)}setColors(e,t,n,r,s){const u=this.geometry.getAttribute("color");return u.setXYZ(0,e.r,e.g,e.b),u.setXYZ(1,e.r,e.g,e.b),u.setXYZ(2,e.r,e.g,e.b),u.setXYZ(3,e.r,e.g,e.b),u.setXYZ(4,e.r,e.g,e.b),u.setXYZ(5,e.r,e.g,e.b),u.setXYZ(6,e.r,e.g,e.b),u.setXYZ(7,e.r,e.g,e.b),u.setXYZ(8,e.r,e.g,e.b),u.setXYZ(9,e.r,e.g,e.b),u.setXYZ(10,e.r,e.g,e.b),u.setXYZ(11,e.r,e.g,e.b),u.setXYZ(12,e.r,e.g,e.b),u.setXYZ(13,e.r,e.g,e.b),u.setXYZ(14,e.r,e.g,e.b),u.setXYZ(15,e.r,e.g,e.b),u.setXYZ(16,e.r,e.g,e.b),u.setXYZ(17,e.r,e.g,e.b),u.setXYZ(18,e.r,e.g,e.b),u.setXYZ(19,e.r,e.g,e.b),u.setXYZ(20,e.r,e.g,e.b),u.setXYZ(21,e.r,e.g,e.b),u.setXYZ(22,e.r,e.g,e.b),u.setXYZ(23,e.r,e.g,e.b),u.setXYZ(24,t.r,t.g,t.b),u.setXYZ(25,t.r,t.g,t.b),u.setXYZ(26,t.r,t.g,t.b),u.setXYZ(27,t.r,t.g,t.b),u.setXYZ(28,t.r,t.g,t.b),u.setXYZ(29,t.r,t.g,t.b),u.setXYZ(30,t.r,t.g,t.b),u.setXYZ(31,t.r,t.g,t.b),u.setXYZ(32,n.r,n.g,n.b),u.setXYZ(33,n.r,n.g,n.b),u.setXYZ(34,n.r,n.g,n.b),u.setXYZ(35,n.r,n.g,n.b),u.setXYZ(36,n.r,n.g,n.b),u.setXYZ(37,n.r,n.g,n.b),u.setXYZ(38,r.r,r.g,r.b),u.setXYZ(39,r.r,r.g,r.b),u.setXYZ(40,s.r,s.g,s.b),u.setXYZ(41,s.r,s.g,s.b),u.setXYZ(42,s.r,s.g,s.b),u.setXYZ(43,s.r,s.g,s.b),u.setXYZ(44,s.r,s.g,s.b),u.setXYZ(45,s.r,s.g,s.b),u.setXYZ(46,s.r,s.g,s.b),u.setXYZ(47,s.r,s.g,s.b),u.setXYZ(48,s.r,s.g,s.b),u.setXYZ(49,s.r,s.g,s.b),u.needsUpdate=!0,this}update(){const e=this.geometry,t=this.pointMap,n=1,r=1;let s,o;if(Dr.projectionMatrixInverse.copy(this.camera.projectionMatrixInverse),this.camera.reversedDepth===!0)s=1,o=0;else if(this.camera.coordinateSystem===xo)s=-1,o=1;else if(this.camera.coordinateSystem===ug)s=0,o=1;else throw new Error("THREE.CameraHelper.update(): Invalid coordinate system: "+this.camera.coordinateSystem);zr("c",t,e,Dr,0,0,s),zr("t",t,e,Dr,0,0,o),zr("n1",t,e,Dr,-n,-r,s),zr("n2",t,e,Dr,n,-r,s),zr("n3",t,e,Dr,-n,r,s),zr("n4",t,e,Dr,n,r,s),zr("f1",t,e,Dr,-n,-r,o),zr("f2",t,e,Dr,n,-r,o),zr("f3",t,e,Dr,-n,r,o),zr("f4",t,e,Dr,n,r,o),zr("u1",t,e,Dr,n*.7,r*1.1,s),zr("u2",t,e,Dr,-n*.7,r*1.1,s),zr("u3",t,e,Dr,0,r*2,s),zr("cf1",t,e,Dr,-n,0,o),zr("cf2",t,e,Dr,n,0,o),zr("cf3",t,e,Dr,0,-r,o),zr("cf4",t,e,Dr,0,r,o),zr("cn1",t,e,Dr,-n,0,s),zr("cn2",t,e,Dr,n,0,s),zr("cn3",t,e,Dr,0,-r,s),zr("cn4",t,e,Dr,0,r,s),e.getAttribute("position").needsUpdate=!0}dispose(){this.geometry.dispose(),this.material.dispose()}}function zr(i,e,t,n,r,s,o){jx.set(r,s,o).unproject(n);const u=e[i];if(u!==void 0){const f=t.getAttribute("position");for(let p=0,g=u.length;p<g;p++)f.setXYZ(u[p],jx.x,jx.y,jx.z)}}const Wx=new xs;class s2 extends Yl{constructor(e,t=16776960){const n=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),r=new Float32Array(24),s=new wn;s.setIndex(new gi(n,1)),s.setAttribute("position",new gi(r,3)),super(s,new ha({color:t,toneMapped:!1})),this.object=e,this.type="BoxHelper",this.matrixAutoUpdate=!1,this.update()}update(){if(this.object!==void 0&&Wx.setFromObject(this.object),Wx.isEmpty())return;const e=Wx.min,t=Wx.max,n=this.geometry.attributes.position,r=n.array;r[0]=t.x,r[1]=t.y,r[2]=t.z,r[3]=e.x,r[4]=t.y,r[5]=t.z,r[6]=e.x,r[7]=e.y,r[8]=t.z,r[9]=t.x,r[10]=e.y,r[11]=t.z,r[12]=t.x,r[13]=t.y,r[14]=e.z,r[15]=e.x,r[16]=t.y,r[17]=e.z,r[18]=e.x,r[19]=e.y,r[20]=e.z,r[21]=t.x,r[22]=e.y,r[23]=e.z,n.needsUpdate=!0,this.geometry.computeBoundingSphere()}setFromObject(e){return this.object=e,this.update(),this}copy(e,t){return super.copy(e,t),this.object=e.object,this}dispose(){this.geometry.dispose(),this.material.dispose()}}class a2 extends Yl{constructor(e,t=16776960){const n=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),r=[1,1,1,-1,1,1,-1,-1,1,1,-1,1,1,1,-1,-1,1,-1,-1,-1,-1,1,-1,-1],s=new wn;s.setIndex(new gi(n,1)),s.setAttribute("position",new tn(r,3)),super(s,new ha({color:t,toneMapped:!1})),this.box=e,this.type="Box3Helper",this.geometry.computeBoundingSphere()}updateMatrixWorld(e){const t=this.box;t.isEmpty()||(t.getCenter(this.position),t.getSize(this.scale),this.scale.multiplyScalar(.5),super.updateMatrixWorld(e))}dispose(){this.geometry.dispose(),this.material.dispose()}}class o2 extends ju{constructor(e,t=1,n=16776960){const r=n,s=[1,-1,0,-1,1,0,-1,-1,0,1,1,0,-1,1,0,-1,-1,0,1,-1,0,1,1,0],o=new wn;o.setAttribute("position",new tn(s,3)),o.computeBoundingSphere(),super(o,new ha({color:r,toneMapped:!1})),this.type="PlaneHelper",this.plane=e,this.size=t;const u=[1,1,0,-1,1,0,-1,-1,0,1,1,0,-1,-1,0,1,-1,0],f=new wn;f.setAttribute("position",new tn(u,3)),f.computeBoundingSphere(),this.add(new rr(f,new to({color:r,opacity:.2,transparent:!0,depthWrite:!1,toneMapped:!1})))}updateMatrixWorld(e){this.position.set(0,0,0),this.scale.set(.5*this.size,.5*this.size,1),this.lookAt(this.plane.normal),this.translateZ(-this.plane.constant),super.updateMatrixWorld(e)}dispose(){this.geometry.dispose(),this.material.dispose(),this.children[0].geometry.dispose(),this.children[0].material.dispose()}}const PD=new ie;let qx,E1;class l2 extends fi{constructor(e=new ie(0,0,1),t=new ie(0,0,0),n=1,r=16776960,s=n*.2,o=s*.2){super(),this.type="ArrowHelper",qx===void 0&&(qx=new wn,qx.setAttribute("position",new tn([0,0,0,0,1,0],3)),E1=new My(.5,1,5,1),E1.translate(0,-.5,0)),this.position.copy(t),this.line=new ju(qx,new ha({color:r,toneMapped:!1})),this.line.matrixAutoUpdate=!1,this.add(this.line),this.cone=new rr(E1,new to({color:r,toneMapped:!1})),this.cone.matrixAutoUpdate=!1,this.add(this.cone),this.setDirection(e),this.setLength(n,s,o)}setDirection(e){if(e.y>.99999)this.quaternion.set(0,0,0,1);else if(e.y<-.99999)this.quaternion.set(1,0,0,0);else{PD.set(e.z,0,-e.x).normalize();const t=Math.acos(e.y);this.quaternion.setFromAxisAngle(PD,t)}}setLength(e,t=e*.2,n=t*.2){this.line.scale.set(1,Math.max(1e-4,e-t),1),this.line.updateMatrix(),this.cone.scale.set(n,t,n),this.cone.position.y=e,this.cone.updateMatrix()}setColor(e){this.line.material.color.set(e),this.cone.material.color.set(e)}copy(e){return super.copy(e,!1),this.line.copy(e.line),this.cone.copy(e.cone),this}dispose(){this.line.geometry.dispose(),this.line.material.dispose(),this.cone.geometry.dispose(),this.cone.material.dispose()}}class c2 extends Yl{constructor(e=1){const t=[0,0,0,e,0,0,0,0,0,0,e,0,0,0,0,0,0,e],n=[1,0,0,1,.6,0,0,1,0,.6,1,0,0,0,1,0,.6,1],r=new wn;r.setAttribute("position",new tn(t,3)),r.setAttribute("color",new tn(n,3));const s=new ha({vertexColors:!0,toneMapped:!1});super(r,s),this.type="AxesHelper"}setColors(e,t,n){const r=new Gt,s=this.geometry.attributes.color.array;return r.set(e),r.toArray(s,0),r.toArray(s,3),r.set(t),r.toArray(s,6),r.toArray(s,9),r.set(n),r.toArray(s,12),r.toArray(s,15),this.geometry.attributes.color.needsUpdate=!0,this}dispose(){this.geometry.dispose(),this.material.dispose()}}class u2{constructor(){this.type="ShapePath",this.color=new Gt,this.subPaths=[],this.currentPath=null}moveTo(e,t){return this.currentPath=new CA,this.subPaths.push(this.currentPath),this.currentPath.moveTo(e,t),this}lineTo(e,t){return this.currentPath.lineTo(e,t),this}quadraticCurveTo(e,t,n,r){return this.currentPath.quadraticCurveTo(e,t,n,r),this}bezierCurveTo(e,t,n,r,s,o){return this.currentPath.bezierCurveTo(e,t,n,r,s,o),this}splineThru(e){return this.currentPath.splineThru(e),this}toShapes(e){function t(T){const N=[];for(let L=0,F=T.length;L<F;L++){const G=T[L],k=new jd;k.curves=G.curves,N.push(k)}return N}function n(T,N){const L=N.length;let F=!1;for(let G=L-1,k=0;k<L;G=k++){let O=N[G],D=N[k],R=D.x-O.x,P=D.y-O.y;if(Math.abs(P)>Number.EPSILON){if(P<0&&(O=N[k],R=-R,D=N[G],P=-P),T.y<O.y||T.y>D.y)continue;if(T.y===O.y){if(T.x===O.x)return!0}else{const z=P*(T.x-O.x)-R*(T.y-O.y);if(z===0)return!0;if(z<0)continue;F=!F}}else{if(T.y!==O.y)continue;if(D.x<=T.x&&T.x<=O.x||O.x<=T.x&&T.x<=D.x)return!0}}return F}const r=zl.isClockWise,s=this.subPaths;if(s.length===0)return[];let o,u,f;const p=[];if(s.length===1)return u=s[0],f=new jd,f.curves=u.curves,p.push(f),p;let g=!r(s[0].getPoints());g=e?!g:g;const v=[],_=[];let x=[],E=0,C;_[E]=void 0,x[E]=[];for(let T=0,N=s.length;T<N;T++)u=s[T],C=u.getPoints(),o=r(C),o=e?!o:o,o?(!g&&_[E]&&E++,_[E]={s:new jd,p:C},_[E].s.curves=u.curves,g&&E++,x[E]=[]):x[E].push({h:u,p:C[0]});if(!_[0])return t(s);if(_.length>1){let T=!1,N=0;for(let L=0,F=_.length;L<F;L++)v[L]=[];for(let L=0,F=_.length;L<F;L++){const G=x[L];for(let k=0;k<G.length;k++){const O=G[k];let D=!0;for(let R=0;R<_.length;R++)n(O.p,_[R].p)&&(L!==R&&N++,D?(D=!1,v[R].push(O)):T=!0);D&&v[L].push(O)}}N>0&&T===!1&&(x=v)}let w;for(let T=0,N=_.length;T<N;T++){f=_[T].s,p.push(f),w=x[T];for(let L=0,F=w.length;L<F;L++)f.holes.push(w[L].h)}return p}}class h2 extends Wc{constructor(e,t=null){super(),this.object=e,this.domElement=t,this.enabled=!0,this.state=-1,this.keys={},this.mouseButtons={LEFT:null,MIDDLE:null,RIGHT:null},this.touches={ONE:null,TWO:null}}connect(e){if(e===void 0){Ht("Controls: connect() now requires an element.");return}this.domElement!==null&&this.disconnect(),this.domElement=e}disconnect(){}dispose(){}update(){}}function f2(i,e){const t=i.image&&i.image.width?i.image.width/i.image.height:1;return t>e?(i.repeat.x=1,i.repeat.y=t/e,i.offset.x=0,i.offset.y=(1-i.repeat.y)/2):(i.repeat.x=e/t,i.repeat.y=1,i.offset.x=(1-i.repeat.x)/2,i.offset.y=0),i}function d2(i,e){const t=i.image&&i.image.width?i.image.width/i.image.height:1;return t>e?(i.repeat.x=e/t,i.repeat.y=1,i.offset.x=(1-i.repeat.x)/2,i.offset.y=0):(i.repeat.x=1,i.repeat.y=t/e,i.offset.x=0,i.offset.y=(1-i.repeat.y)/2),i}function p2(i){return i.repeat.x=1,i.repeat.y=1,i.offset.x=0,i.offset.y=0,i}function OT(i,e,t,n){const r=m2(n);switch(t){case rw:return i*e;case _y:return i*e/r.components*r.byteLength;case xy:return i*e/r.components*r.byteLength;case Zd:return i*e*2/r.components*r.byteLength;case hS:return i*e*2/r.components*r.byteLength;case sw:return i*e*3/r.components*r.byteLength;case jr:return i*e*4/r.components*r.byteLength;case fS:return i*e*4/r.components*r.byteLength;case Mv:case wv:return Math.floor((i+3)/4)*Math.floor((e+3)/4)*8;case Cv:case Rv:return Math.floor((i+3)/4)*Math.floor((e+3)/4)*16;case Xb:case Jb:return Math.max(i,16)*Math.max(e,8)/4;case qb:case Yb:return Math.max(i,8)*Math.max(e,8)/2;case Kb:case Qb:case $b:case eA:return Math.floor((i+3)/4)*Math.floor((e+3)/4)*8;case Zb:case tA:case nA:return Math.floor((i+3)/4)*Math.floor((e+3)/4)*16;case iA:return Math.floor((i+3)/4)*Math.floor((e+3)/4)*16;case rA:return Math.floor((i+4)/5)*Math.floor((e+3)/4)*16;case sA:return Math.floor((i+4)/5)*Math.floor((e+4)/5)*16;case aA:return Math.floor((i+5)/6)*Math.floor((e+4)/5)*16;case oA:return Math.floor((i+5)/6)*Math.floor((e+5)/6)*16;case lA:return Math.floor((i+7)/8)*Math.floor((e+4)/5)*16;case cA:return Math.floor((i+7)/8)*Math.floor((e+5)/6)*16;case uA:return Math.floor((i+7)/8)*Math.floor((e+7)/8)*16;case hA:return Math.floor((i+9)/10)*Math.floor((e+4)/5)*16;case fA:return Math.floor((i+9)/10)*Math.floor((e+5)/6)*16;case dA:return Math.floor((i+9)/10)*Math.floor((e+7)/8)*16;case pA:return Math.floor((i+9)/10)*Math.floor((e+9)/10)*16;case mA:return Math.floor((i+11)/12)*Math.floor((e+9)/10)*16;case gA:return Math.floor((i+11)/12)*Math.floor((e+11)/12)*16;case vA:case yA:case _A:return Math.ceil(i/4)*Math.ceil(e/4)*16;case xA:case bA:return Math.ceil(i/4)*Math.ceil(e/4)*8;case AA:case SA:return Math.ceil(i/4)*Math.ceil(e/4)*16}throw new Error(`Unable to determine texture byte length for ${t} format.`)}function m2(i){switch(i){case vs:case oS:return{byteLength:1,components:1};case ag:case lS:case Er:return{byteLength:2,components:1};case cS:case uS:return{byteLength:2,components:4};case So:case yy:case ir:return{byteLength:4,components:1};case nw:case iw:return{byteLength:4,components:3}}throw new Error(`Unknown texture type ${i}.`)}class g2{static contain(e,t){return f2(e,t)}static cover(e,t){return d2(e,t)}static fill(e){return p2(e)}static getByteLength(e,t,n,r){return OT(e,t,n,r)}}typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("register",{detail:{revision:gy}}));typeof window<"u"&&(window.__THREE__?Ht("WARNING: Multiple instances of Three.js being imported."):window.__THREE__=gy);/**
 * @license
 * Copyright 2010-2025 Three.js Authors
 * SPDX-License-Identifier: MIT
 */function YL(){let i=null,e=!1,t=null,n=null;function r(s,o){t(s,o),n=i.requestAnimationFrame(r)}return{start:function(){e!==!0&&t!==null&&(n=i.requestAnimationFrame(r),e=!0)},stop:function(){i.cancelAnimationFrame(n),e=!1},setAnimationLoop:function(s){t=s},setContext:function(s){i=s}}}function v2(i){const e=new WeakMap;function t(u,f){const p=u.array,g=u.usage,v=p.byteLength,_=i.createBuffer();i.bindBuffer(f,_),i.bufferData(f,p,g),u.onUploadCallback();let x;if(p instanceof Float32Array)x=i.FLOAT;else if(typeof Float16Array<"u"&&p instanceof Float16Array)x=i.HALF_FLOAT;else if(p instanceof Uint16Array)u.isFloat16BufferAttribute?x=i.HALF_FLOAT:x=i.UNSIGNED_SHORT;else if(p instanceof Int16Array)x=i.SHORT;else if(p instanceof Uint32Array)x=i.UNSIGNED_INT;else if(p instanceof Int32Array)x=i.INT;else if(p instanceof Int8Array)x=i.BYTE;else if(p instanceof Uint8Array)x=i.UNSIGNED_BYTE;else if(p instanceof Uint8ClampedArray)x=i.UNSIGNED_BYTE;else throw new Error("THREE.WebGLAttributes: Unsupported buffer data format: "+p);return{buffer:_,type:x,bytesPerElement:p.BYTES_PER_ELEMENT,version:u.version,size:v}}function n(u,f,p){const g=f.array,v=f.updateRanges;if(i.bindBuffer(p,u),v.length===0)i.bufferSubData(p,0,g);else{v.sort((x,E)=>x.start-E.start);let _=0;for(let x=1;x<v.length;x++){const E=v[_],C=v[x];C.start<=E.start+E.count+1?E.count=Math.max(E.count,C.start+C.count-E.start):(++_,v[_]=C)}v.length=_+1;for(let x=0,E=v.length;x<E;x++){const C=v[x];i.bufferSubData(p,C.start*g.BYTES_PER_ELEMENT,g,C.start,C.count)}f.clearUpdateRanges()}f.onUploadCallback()}function r(u){return u.isInterleavedBufferAttribute&&(u=u.data),e.get(u)}function s(u){u.isInterleavedBufferAttribute&&(u=u.data);const f=e.get(u);f&&(i.deleteBuffer(f.buffer),e.delete(u))}function o(u,f){if(u.isInterleavedBufferAttribute&&(u=u.data),u.isGLBufferAttribute){const g=e.get(u);(!g||g.version<u.version)&&e.set(u,{buffer:u.buffer,type:u.type,bytesPerElement:u.elementSize,version:u.version});return}const p=e.get(u);if(p===void 0)e.set(u,t(u,f));else if(p.version<u.version){if(p.size!==u.array.byteLength)throw new Error("THREE.WebGLAttributes: The size of the buffer attribute's array buffer does not match the original size. Resizing buffer attributes is not supported.");n(p.buffer,u,f),p.version=u.version}}return{get:r,remove:s,update:o}}var y2=`#ifdef USE_ALPHAHASH
	if ( diffuseColor.a < getAlphaHashThreshold( vPosition ) ) discard;
#endif`,_2=`#ifdef USE_ALPHAHASH
	const float ALPHA_HASH_SCALE = 0.05;
	float hash2D( vec2 value ) {
		return fract( 1.0e4 * sin( 17.0 * value.x + 0.1 * value.y ) * ( 0.1 + abs( sin( 13.0 * value.y + value.x ) ) ) );
	}
	float hash3D( vec3 value ) {
		return hash2D( vec2( hash2D( value.xy ), value.z ) );
	}
	float getAlphaHashThreshold( vec3 position ) {
		float maxDeriv = max(
			length( dFdx( position.xyz ) ),
			length( dFdy( position.xyz ) )
		);
		float pixScale = 1.0 / ( ALPHA_HASH_SCALE * maxDeriv );
		vec2 pixScales = vec2(
			exp2( floor( log2( pixScale ) ) ),
			exp2( ceil( log2( pixScale ) ) )
		);
		vec2 alpha = vec2(
			hash3D( floor( pixScales.x * position.xyz ) ),
			hash3D( floor( pixScales.y * position.xyz ) )
		);
		float lerpFactor = fract( log2( pixScale ) );
		float x = ( 1.0 - lerpFactor ) * alpha.x + lerpFactor * alpha.y;
		float a = min( lerpFactor, 1.0 - lerpFactor );
		vec3 cases = vec3(
			x * x / ( 2.0 * a * ( 1.0 - a ) ),
			( x - 0.5 * a ) / ( 1.0 - a ),
			1.0 - ( ( 1.0 - x ) * ( 1.0 - x ) / ( 2.0 * a * ( 1.0 - a ) ) )
		);
		float threshold = ( x < ( 1.0 - a ) )
			? ( ( x < a ) ? cases.x : cases.y )
			: cases.z;
		return clamp( threshold , 1.0e-6, 1.0 );
	}
#endif`,x2=`#ifdef USE_ALPHAMAP
	diffuseColor.a *= texture2D( alphaMap, vAlphaMapUv ).g;
#endif`,b2=`#ifdef USE_ALPHAMAP
	uniform sampler2D alphaMap;
#endif`,A2=`#ifdef USE_ALPHATEST
	#ifdef ALPHA_TO_COVERAGE
	diffuseColor.a = smoothstep( alphaTest, alphaTest + fwidth( diffuseColor.a ), diffuseColor.a );
	if ( diffuseColor.a == 0.0 ) discard;
	#else
	if ( diffuseColor.a < alphaTest ) discard;
	#endif
#endif`,S2=`#ifdef USE_ALPHATEST
	uniform float alphaTest;
#endif`,E2=`#ifdef USE_AOMAP
	float ambientOcclusion = ( texture2D( aoMap, vAoMapUv ).r - 1.0 ) * aoMapIntensity + 1.0;
	reflectedLight.indirectDiffuse *= ambientOcclusion;
	#if defined( USE_CLEARCOAT ) 
		clearcoatSpecularIndirect *= ambientOcclusion;
	#endif
	#if defined( USE_SHEEN ) 
		sheenSpecularIndirect *= ambientOcclusion;
	#endif
	#if defined( USE_ENVMAP ) && defined( STANDARD )
		float dotNV = saturate( dot( geometryNormal, geometryViewDir ) );
		reflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.roughness );
	#endif
#endif`,T2=`#ifdef USE_AOMAP
	uniform sampler2D aoMap;
	uniform float aoMapIntensity;
#endif`,M2=`#ifdef USE_BATCHING
	#if ! defined( GL_ANGLE_multi_draw )
	#define gl_DrawID _gl_DrawID
	uniform int _gl_DrawID;
	#endif
	uniform highp sampler2D batchingTexture;
	uniform highp usampler2D batchingIdTexture;
	mat4 getBatchingMatrix( const in float i ) {
		int size = textureSize( batchingTexture, 0 ).x;
		int j = int( i ) * 4;
		int x = j % size;
		int y = j / size;
		vec4 v1 = texelFetch( batchingTexture, ivec2( x, y ), 0 );
		vec4 v2 = texelFetch( batchingTexture, ivec2( x + 1, y ), 0 );
		vec4 v3 = texelFetch( batchingTexture, ivec2( x + 2, y ), 0 );
		vec4 v4 = texelFetch( batchingTexture, ivec2( x + 3, y ), 0 );
		return mat4( v1, v2, v3, v4 );
	}
	float getIndirectIndex( const in int i ) {
		int size = textureSize( batchingIdTexture, 0 ).x;
		int x = i % size;
		int y = i / size;
		return float( texelFetch( batchingIdTexture, ivec2( x, y ), 0 ).r );
	}
#endif
#ifdef USE_BATCHING_COLOR
	uniform sampler2D batchingColorTexture;
	vec3 getBatchingColor( const in float i ) {
		int size = textureSize( batchingColorTexture, 0 ).x;
		int j = int( i );
		int x = j % size;
		int y = j / size;
		return texelFetch( batchingColorTexture, ivec2( x, y ), 0 ).rgb;
	}
#endif`,w2=`#ifdef USE_BATCHING
	mat4 batchingMatrix = getBatchingMatrix( getIndirectIndex( gl_DrawID ) );
#endif`,C2=`vec3 transformed = vec3( position );
#ifdef USE_ALPHAHASH
	vPosition = vec3( position );
#endif`,R2=`vec3 objectNormal = vec3( normal );
#ifdef USE_TANGENT
	vec3 objectTangent = vec3( tangent.xyz );
#endif`,I2=`float G_BlinnPhong_Implicit( ) {
	return 0.25;
}
float D_BlinnPhong( const in float shininess, const in float dotNH ) {
	return RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );
}
vec3 BRDF_BlinnPhong( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float shininess ) {
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNH = saturate( dot( normal, halfDir ) );
	float dotVH = saturate( dot( viewDir, halfDir ) );
	vec3 F = F_Schlick( specularColor, 1.0, dotVH );
	float G = G_BlinnPhong_Implicit( );
	float D = D_BlinnPhong( shininess, dotNH );
	return F * ( G * D );
} // validated`,D2=`#ifdef USE_IRIDESCENCE
	const mat3 XYZ_TO_REC709 = mat3(
		 3.2404542, -0.9692660,  0.0556434,
		-1.5371385,  1.8760108, -0.2040259,
		-0.4985314,  0.0415560,  1.0572252
	);
	vec3 Fresnel0ToIor( vec3 fresnel0 ) {
		vec3 sqrtF0 = sqrt( fresnel0 );
		return ( vec3( 1.0 ) + sqrtF0 ) / ( vec3( 1.0 ) - sqrtF0 );
	}
	vec3 IorToFresnel0( vec3 transmittedIor, float incidentIor ) {
		return pow2( ( transmittedIor - vec3( incidentIor ) ) / ( transmittedIor + vec3( incidentIor ) ) );
	}
	float IorToFresnel0( float transmittedIor, float incidentIor ) {
		return pow2( ( transmittedIor - incidentIor ) / ( transmittedIor + incidentIor ));
	}
	vec3 evalSensitivity( float OPD, vec3 shift ) {
		float phase = 2.0 * PI * OPD * 1.0e-9;
		vec3 val = vec3( 5.4856e-13, 4.4201e-13, 5.2481e-13 );
		vec3 pos = vec3( 1.6810e+06, 1.7953e+06, 2.2084e+06 );
		vec3 var = vec3( 4.3278e+09, 9.3046e+09, 6.6121e+09 );
		vec3 xyz = val * sqrt( 2.0 * PI * var ) * cos( pos * phase + shift ) * exp( - pow2( phase ) * var );
		xyz.x += 9.7470e-14 * sqrt( 2.0 * PI * 4.5282e+09 ) * cos( 2.2399e+06 * phase + shift[ 0 ] ) * exp( - 4.5282e+09 * pow2( phase ) );
		xyz /= 1.0685e-7;
		vec3 rgb = XYZ_TO_REC709 * xyz;
		return rgb;
	}
	vec3 evalIridescence( float outsideIOR, float eta2, float cosTheta1, float thinFilmThickness, vec3 baseF0 ) {
		vec3 I;
		float iridescenceIOR = mix( outsideIOR, eta2, smoothstep( 0.0, 0.03, thinFilmThickness ) );
		float sinTheta2Sq = pow2( outsideIOR / iridescenceIOR ) * ( 1.0 - pow2( cosTheta1 ) );
		float cosTheta2Sq = 1.0 - sinTheta2Sq;
		if ( cosTheta2Sq < 0.0 ) {
			return vec3( 1.0 );
		}
		float cosTheta2 = sqrt( cosTheta2Sq );
		float R0 = IorToFresnel0( iridescenceIOR, outsideIOR );
		float R12 = F_Schlick( R0, 1.0, cosTheta1 );
		float T121 = 1.0 - R12;
		float phi12 = 0.0;
		if ( iridescenceIOR < outsideIOR ) phi12 = PI;
		float phi21 = PI - phi12;
		vec3 baseIOR = Fresnel0ToIor( clamp( baseF0, 0.0, 0.9999 ) );		vec3 R1 = IorToFresnel0( baseIOR, iridescenceIOR );
		vec3 R23 = F_Schlick( R1, 1.0, cosTheta2 );
		vec3 phi23 = vec3( 0.0 );
		if ( baseIOR[ 0 ] < iridescenceIOR ) phi23[ 0 ] = PI;
		if ( baseIOR[ 1 ] < iridescenceIOR ) phi23[ 1 ] = PI;
		if ( baseIOR[ 2 ] < iridescenceIOR ) phi23[ 2 ] = PI;
		float OPD = 2.0 * iridescenceIOR * thinFilmThickness * cosTheta2;
		vec3 phi = vec3( phi21 ) + phi23;
		vec3 R123 = clamp( R12 * R23, 1e-5, 0.9999 );
		vec3 r123 = sqrt( R123 );
		vec3 Rs = pow2( T121 ) * R23 / ( vec3( 1.0 ) - R123 );
		vec3 C0 = R12 + Rs;
		I = C0;
		vec3 Cm = Rs - T121;
		for ( int m = 1; m <= 2; ++ m ) {
			Cm *= r123;
			vec3 Sm = 2.0 * evalSensitivity( float( m ) * OPD, float( m ) * phi );
			I += Cm * Sm;
		}
		return max( I, vec3( 0.0 ) );
	}
#endif`,N2=`#ifdef USE_BUMPMAP
	uniform sampler2D bumpMap;
	uniform float bumpScale;
	vec2 dHdxy_fwd() {
		vec2 dSTdx = dFdx( vBumpMapUv );
		vec2 dSTdy = dFdy( vBumpMapUv );
		float Hll = bumpScale * texture2D( bumpMap, vBumpMapUv ).x;
		float dBx = bumpScale * texture2D( bumpMap, vBumpMapUv + dSTdx ).x - Hll;
		float dBy = bumpScale * texture2D( bumpMap, vBumpMapUv + dSTdy ).x - Hll;
		return vec2( dBx, dBy );
	}
	vec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy, float faceDirection ) {
		vec3 vSigmaX = normalize( dFdx( surf_pos.xyz ) );
		vec3 vSigmaY = normalize( dFdy( surf_pos.xyz ) );
		vec3 vN = surf_norm;
		vec3 R1 = cross( vSigmaY, vN );
		vec3 R2 = cross( vN, vSigmaX );
		float fDet = dot( vSigmaX, R1 ) * faceDirection;
		vec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );
		return normalize( abs( fDet ) * surf_norm - vGrad );
	}
#endif`,P2=`#if NUM_CLIPPING_PLANES > 0
	vec4 plane;
	#ifdef ALPHA_TO_COVERAGE
		float distanceToPlane, distanceGradient;
		float clipOpacity = 1.0;
		#pragma unroll_loop_start
		for ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {
			plane = clippingPlanes[ i ];
			distanceToPlane = - dot( vClipPosition, plane.xyz ) + plane.w;
			distanceGradient = fwidth( distanceToPlane ) / 2.0;
			clipOpacity *= smoothstep( - distanceGradient, distanceGradient, distanceToPlane );
			if ( clipOpacity == 0.0 ) discard;
		}
		#pragma unroll_loop_end
		#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES
			float unionClipOpacity = 1.0;
			#pragma unroll_loop_start
			for ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {
				plane = clippingPlanes[ i ];
				distanceToPlane = - dot( vClipPosition, plane.xyz ) + plane.w;
				distanceGradient = fwidth( distanceToPlane ) / 2.0;
				unionClipOpacity *= 1.0 - smoothstep( - distanceGradient, distanceGradient, distanceToPlane );
			}
			#pragma unroll_loop_end
			clipOpacity *= 1.0 - unionClipOpacity;
		#endif
		diffuseColor.a *= clipOpacity;
		if ( diffuseColor.a == 0.0 ) discard;
	#else
		#pragma unroll_loop_start
		for ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {
			plane = clippingPlanes[ i ];
			if ( dot( vClipPosition, plane.xyz ) > plane.w ) discard;
		}
		#pragma unroll_loop_end
		#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES
			bool clipped = true;
			#pragma unroll_loop_start
			for ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {
				plane = clippingPlanes[ i ];
				clipped = ( dot( vClipPosition, plane.xyz ) > plane.w ) && clipped;
			}
			#pragma unroll_loop_end
			if ( clipped ) discard;
		#endif
	#endif
#endif`,B2=`#if NUM_CLIPPING_PLANES > 0
	varying vec3 vClipPosition;
	uniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];
#endif`,L2=`#if NUM_CLIPPING_PLANES > 0
	varying vec3 vClipPosition;
#endif`,O2=`#if NUM_CLIPPING_PLANES > 0
	vClipPosition = - mvPosition.xyz;
#endif`,U2=`#if defined( USE_COLOR_ALPHA )
	diffuseColor *= vColor;
#elif defined( USE_COLOR )
	diffuseColor.rgb *= vColor;
#endif`,F2=`#if defined( USE_COLOR_ALPHA )
	varying vec4 vColor;
#elif defined( USE_COLOR )
	varying vec3 vColor;
#endif`,k2=`#if defined( USE_COLOR_ALPHA )
	varying vec4 vColor;
#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR ) || defined( USE_BATCHING_COLOR )
	varying vec3 vColor;
#endif`,z2=`#if defined( USE_COLOR_ALPHA )
	vColor = vec4( 1.0 );
#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR ) || defined( USE_BATCHING_COLOR )
	vColor = vec3( 1.0 );
#endif
#ifdef USE_COLOR
	vColor *= color;
#endif
#ifdef USE_INSTANCING_COLOR
	vColor.xyz *= instanceColor.xyz;
#endif
#ifdef USE_BATCHING_COLOR
	vec3 batchingColor = getBatchingColor( getIndirectIndex( gl_DrawID ) );
	vColor.xyz *= batchingColor.xyz;
#endif`,V2=`#define PI 3.141592653589793
#define PI2 6.283185307179586
#define PI_HALF 1.5707963267948966
#define RECIPROCAL_PI 0.3183098861837907
#define RECIPROCAL_PI2 0.15915494309189535
#define EPSILON 1e-6
#ifndef saturate
#define saturate( a ) clamp( a, 0.0, 1.0 )
#endif
#define whiteComplement( a ) ( 1.0 - saturate( a ) )
float pow2( const in float x ) { return x*x; }
vec3 pow2( const in vec3 x ) { return x*x; }
float pow3( const in float x ) { return x*x*x; }
float pow4( const in float x ) { float x2 = x*x; return x2*x2; }
float max3( const in vec3 v ) { return max( max( v.x, v.y ), v.z ); }
float average( const in vec3 v ) { return dot( v, vec3( 0.3333333 ) ); }
highp float rand( const in vec2 uv ) {
	const highp float a = 12.9898, b = 78.233, c = 43758.5453;
	highp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );
	return fract( sin( sn ) * c );
}
#ifdef HIGH_PRECISION
	float precisionSafeLength( vec3 v ) { return length( v ); }
#else
	float precisionSafeLength( vec3 v ) {
		float maxComponent = max3( abs( v ) );
		return length( v / maxComponent ) * maxComponent;
	}
#endif
struct IncidentLight {
	vec3 color;
	vec3 direction;
	bool visible;
};
struct ReflectedLight {
	vec3 directDiffuse;
	vec3 directSpecular;
	vec3 indirectDiffuse;
	vec3 indirectSpecular;
};
#ifdef USE_ALPHAHASH
	varying vec3 vPosition;
#endif
vec3 transformDirection( in vec3 dir, in mat4 matrix ) {
	return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );
}
vec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {
	return normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );
}
bool isPerspectiveMatrix( mat4 m ) {
	return m[ 2 ][ 3 ] == - 1.0;
}
vec2 equirectUv( in vec3 dir ) {
	float u = atan( dir.z, dir.x ) * RECIPROCAL_PI2 + 0.5;
	float v = asin( clamp( dir.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;
	return vec2( u, v );
}
vec3 BRDF_Lambert( const in vec3 diffuseColor ) {
	return RECIPROCAL_PI * diffuseColor;
}
vec3 F_Schlick( const in vec3 f0, const in float f90, const in float dotVH ) {
	float fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );
	return f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );
}
float F_Schlick( const in float f0, const in float f90, const in float dotVH ) {
	float fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );
	return f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );
} // validated`,H2=`#ifdef ENVMAP_TYPE_CUBE_UV
	#define cubeUV_minMipLevel 4.0
	#define cubeUV_minTileSize 16.0
	float getFace( vec3 direction ) {
		vec3 absDirection = abs( direction );
		float face = - 1.0;
		if ( absDirection.x > absDirection.z ) {
			if ( absDirection.x > absDirection.y )
				face = direction.x > 0.0 ? 0.0 : 3.0;
			else
				face = direction.y > 0.0 ? 1.0 : 4.0;
		} else {
			if ( absDirection.z > absDirection.y )
				face = direction.z > 0.0 ? 2.0 : 5.0;
			else
				face = direction.y > 0.0 ? 1.0 : 4.0;
		}
		return face;
	}
	vec2 getUV( vec3 direction, float face ) {
		vec2 uv;
		if ( face == 0.0 ) {
			uv = vec2( direction.z, direction.y ) / abs( direction.x );
		} else if ( face == 1.0 ) {
			uv = vec2( - direction.x, - direction.z ) / abs( direction.y );
		} else if ( face == 2.0 ) {
			uv = vec2( - direction.x, direction.y ) / abs( direction.z );
		} else if ( face == 3.0 ) {
			uv = vec2( - direction.z, direction.y ) / abs( direction.x );
		} else if ( face == 4.0 ) {
			uv = vec2( - direction.x, direction.z ) / abs( direction.y );
		} else {
			uv = vec2( direction.x, direction.y ) / abs( direction.z );
		}
		return 0.5 * ( uv + 1.0 );
	}
	vec3 bilinearCubeUV( sampler2D envMap, vec3 direction, float mipInt ) {
		float face = getFace( direction );
		float filterInt = max( cubeUV_minMipLevel - mipInt, 0.0 );
		mipInt = max( mipInt, cubeUV_minMipLevel );
		float faceSize = exp2( mipInt );
		highp vec2 uv = getUV( direction, face ) * ( faceSize - 2.0 ) + 1.0;
		if ( face > 2.0 ) {
			uv.y += faceSize;
			face -= 3.0;
		}
		uv.x += face * faceSize;
		uv.x += filterInt * 3.0 * cubeUV_minTileSize;
		uv.y += 4.0 * ( exp2( CUBEUV_MAX_MIP ) - faceSize );
		uv.x *= CUBEUV_TEXEL_WIDTH;
		uv.y *= CUBEUV_TEXEL_HEIGHT;
		#ifdef texture2DGradEXT
			return texture2DGradEXT( envMap, uv, vec2( 0.0 ), vec2( 0.0 ) ).rgb;
		#else
			return texture2D( envMap, uv ).rgb;
		#endif
	}
	#define cubeUV_r0 1.0
	#define cubeUV_m0 - 2.0
	#define cubeUV_r1 0.8
	#define cubeUV_m1 - 1.0
	#define cubeUV_r4 0.4
	#define cubeUV_m4 2.0
	#define cubeUV_r5 0.305
	#define cubeUV_m5 3.0
	#define cubeUV_r6 0.21
	#define cubeUV_m6 4.0
	float roughnessToMip( float roughness ) {
		float mip = 0.0;
		if ( roughness >= cubeUV_r1 ) {
			mip = ( cubeUV_r0 - roughness ) * ( cubeUV_m1 - cubeUV_m0 ) / ( cubeUV_r0 - cubeUV_r1 ) + cubeUV_m0;
		} else if ( roughness >= cubeUV_r4 ) {
			mip = ( cubeUV_r1 - roughness ) * ( cubeUV_m4 - cubeUV_m1 ) / ( cubeUV_r1 - cubeUV_r4 ) + cubeUV_m1;
		} else if ( roughness >= cubeUV_r5 ) {
			mip = ( cubeUV_r4 - roughness ) * ( cubeUV_m5 - cubeUV_m4 ) / ( cubeUV_r4 - cubeUV_r5 ) + cubeUV_m4;
		} else if ( roughness >= cubeUV_r6 ) {
			mip = ( cubeUV_r5 - roughness ) * ( cubeUV_m6 - cubeUV_m5 ) / ( cubeUV_r5 - cubeUV_r6 ) + cubeUV_m5;
		} else {
			mip = - 2.0 * log2( 1.16 * roughness );		}
		return mip;
	}
	vec4 textureCubeUV( sampler2D envMap, vec3 sampleDir, float roughness ) {
		float mip = clamp( roughnessToMip( roughness ), cubeUV_m0, CUBEUV_MAX_MIP );
		float mipF = fract( mip );
		float mipInt = floor( mip );
		vec3 color0 = bilinearCubeUV( envMap, sampleDir, mipInt );
		if ( mipF == 0.0 ) {
			return vec4( color0, 1.0 );
		} else {
			vec3 color1 = bilinearCubeUV( envMap, sampleDir, mipInt + 1.0 );
			return vec4( mix( color0, color1, mipF ), 1.0 );
		}
	}
#endif`,G2=`vec3 transformedNormal = objectNormal;
#ifdef USE_TANGENT
	vec3 transformedTangent = objectTangent;
#endif
#ifdef USE_BATCHING
	mat3 bm = mat3( batchingMatrix );
	transformedNormal /= vec3( dot( bm[ 0 ], bm[ 0 ] ), dot( bm[ 1 ], bm[ 1 ] ), dot( bm[ 2 ], bm[ 2 ] ) );
	transformedNormal = bm * transformedNormal;
	#ifdef USE_TANGENT
		transformedTangent = bm * transformedTangent;
	#endif
#endif
#ifdef USE_INSTANCING
	mat3 im = mat3( instanceMatrix );
	transformedNormal /= vec3( dot( im[ 0 ], im[ 0 ] ), dot( im[ 1 ], im[ 1 ] ), dot( im[ 2 ], im[ 2 ] ) );
	transformedNormal = im * transformedNormal;
	#ifdef USE_TANGENT
		transformedTangent = im * transformedTangent;
	#endif
#endif
transformedNormal = normalMatrix * transformedNormal;
#ifdef FLIP_SIDED
	transformedNormal = - transformedNormal;
#endif
#ifdef USE_TANGENT
	transformedTangent = ( modelViewMatrix * vec4( transformedTangent, 0.0 ) ).xyz;
	#ifdef FLIP_SIDED
		transformedTangent = - transformedTangent;
	#endif
#endif`,j2=`#ifdef USE_DISPLACEMENTMAP
	uniform sampler2D displacementMap;
	uniform float displacementScale;
	uniform float displacementBias;
#endif`,W2=`#ifdef USE_DISPLACEMENTMAP
	transformed += normalize( objectNormal ) * ( texture2D( displacementMap, vDisplacementMapUv ).x * displacementScale + displacementBias );
#endif`,q2=`#ifdef USE_EMISSIVEMAP
	vec4 emissiveColor = texture2D( emissiveMap, vEmissiveMapUv );
	#ifdef DECODE_VIDEO_TEXTURE_EMISSIVE
		emissiveColor = sRGBTransferEOTF( emissiveColor );
	#endif
	totalEmissiveRadiance *= emissiveColor.rgb;
#endif`,X2=`#ifdef USE_EMISSIVEMAP
	uniform sampler2D emissiveMap;
#endif`,Y2="gl_FragColor = linearToOutputTexel( gl_FragColor );",J2=`vec4 LinearTransferOETF( in vec4 value ) {
	return value;
}
vec4 sRGBTransferEOTF( in vec4 value ) {
	return vec4( mix( pow( value.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), value.rgb * 0.0773993808, vec3( lessThanEqual( value.rgb, vec3( 0.04045 ) ) ) ), value.a );
}
vec4 sRGBTransferOETF( in vec4 value ) {
	return vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.a );
}`,K2=`#ifdef USE_ENVMAP
	#ifdef ENV_WORLDPOS
		vec3 cameraToFrag;
		if ( isOrthographic ) {
			cameraToFrag = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );
		} else {
			cameraToFrag = normalize( vWorldPosition - cameraPosition );
		}
		vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
		#ifdef ENVMAP_MODE_REFLECTION
			vec3 reflectVec = reflect( cameraToFrag, worldNormal );
		#else
			vec3 reflectVec = refract( cameraToFrag, worldNormal, refractionRatio );
		#endif
	#else
		vec3 reflectVec = vReflect;
	#endif
	#ifdef ENVMAP_TYPE_CUBE
		vec4 envColor = textureCube( envMap, envMapRotation * vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );
	#else
		vec4 envColor = vec4( 0.0 );
	#endif
	#ifdef ENVMAP_BLENDING_MULTIPLY
		outgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );
	#elif defined( ENVMAP_BLENDING_MIX )
		outgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );
	#elif defined( ENVMAP_BLENDING_ADD )
		outgoingLight += envColor.xyz * specularStrength * reflectivity;
	#endif
#endif`,Q2=`#ifdef USE_ENVMAP
	uniform float envMapIntensity;
	uniform float flipEnvMap;
	uniform mat3 envMapRotation;
	#ifdef ENVMAP_TYPE_CUBE
		uniform samplerCube envMap;
	#else
		uniform sampler2D envMap;
	#endif
#endif`,Z2=`#ifdef USE_ENVMAP
	uniform float reflectivity;
	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )
		#define ENV_WORLDPOS
	#endif
	#ifdef ENV_WORLDPOS
		varying vec3 vWorldPosition;
		uniform float refractionRatio;
	#else
		varying vec3 vReflect;
	#endif
#endif`,$2=`#ifdef USE_ENVMAP
	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )
		#define ENV_WORLDPOS
	#endif
	#ifdef ENV_WORLDPOS
		
		varying vec3 vWorldPosition;
	#else
		varying vec3 vReflect;
		uniform float refractionRatio;
	#endif
#endif`,e7=`#ifdef USE_ENVMAP
	#ifdef ENV_WORLDPOS
		vWorldPosition = worldPosition.xyz;
	#else
		vec3 cameraToVertex;
		if ( isOrthographic ) {
			cameraToVertex = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );
		} else {
			cameraToVertex = normalize( worldPosition.xyz - cameraPosition );
		}
		vec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );
		#ifdef ENVMAP_MODE_REFLECTION
			vReflect = reflect( cameraToVertex, worldNormal );
		#else
			vReflect = refract( cameraToVertex, worldNormal, refractionRatio );
		#endif
	#endif
#endif`,t7=`#ifdef USE_FOG
	vFogDepth = - mvPosition.z;
#endif`,n7=`#ifdef USE_FOG
	varying float vFogDepth;
#endif`,i7=`#ifdef USE_FOG
	#ifdef FOG_EXP2
		float fogFactor = 1.0 - exp( - fogDensity * fogDensity * vFogDepth * vFogDepth );
	#else
		float fogFactor = smoothstep( fogNear, fogFar, vFogDepth );
	#endif
	gl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );
#endif`,r7=`#ifdef USE_FOG
	uniform vec3 fogColor;
	varying float vFogDepth;
	#ifdef FOG_EXP2
		uniform float fogDensity;
	#else
		uniform float fogNear;
		uniform float fogFar;
	#endif
#endif`,s7=`#ifdef USE_GRADIENTMAP
	uniform sampler2D gradientMap;
#endif
vec3 getGradientIrradiance( vec3 normal, vec3 lightDirection ) {
	float dotNL = dot( normal, lightDirection );
	vec2 coord = vec2( dotNL * 0.5 + 0.5, 0.0 );
	#ifdef USE_GRADIENTMAP
		return vec3( texture2D( gradientMap, coord ).r );
	#else
		vec2 fw = fwidth( coord ) * 0.5;
		return mix( vec3( 0.7 ), vec3( 1.0 ), smoothstep( 0.7 - fw.x, 0.7 + fw.x, coord.x ) );
	#endif
}`,a7=`#ifdef USE_LIGHTMAP
	uniform sampler2D lightMap;
	uniform float lightMapIntensity;
#endif`,o7=`LambertMaterial material;
material.diffuseColor = diffuseColor.rgb;
material.specularStrength = specularStrength;`,l7=`varying vec3 vViewPosition;
struct LambertMaterial {
	vec3 diffuseColor;
	float specularStrength;
};
void RE_Direct_Lambert( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometryNormal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Lambert( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_Lambert
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Lambert`,c7=`uniform bool receiveShadow;
uniform vec3 ambientLightColor;
#if defined( USE_LIGHT_PROBES )
	uniform vec3 lightProbe[ 9 ];
#endif
vec3 shGetIrradianceAt( in vec3 normal, in vec3 shCoefficients[ 9 ] ) {
	float x = normal.x, y = normal.y, z = normal.z;
	vec3 result = shCoefficients[ 0 ] * 0.886227;
	result += shCoefficients[ 1 ] * 2.0 * 0.511664 * y;
	result += shCoefficients[ 2 ] * 2.0 * 0.511664 * z;
	result += shCoefficients[ 3 ] * 2.0 * 0.511664 * x;
	result += shCoefficients[ 4 ] * 2.0 * 0.429043 * x * y;
	result += shCoefficients[ 5 ] * 2.0 * 0.429043 * y * z;
	result += shCoefficients[ 6 ] * ( 0.743125 * z * z - 0.247708 );
	result += shCoefficients[ 7 ] * 2.0 * 0.429043 * x * z;
	result += shCoefficients[ 8 ] * 0.429043 * ( x * x - y * y );
	return result;
}
vec3 getLightProbeIrradiance( const in vec3 lightProbe[ 9 ], const in vec3 normal ) {
	vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
	vec3 irradiance = shGetIrradianceAt( worldNormal, lightProbe );
	return irradiance;
}
vec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {
	vec3 irradiance = ambientLightColor;
	return irradiance;
}
float getDistanceAttenuation( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {
	float distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );
	if ( cutoffDistance > 0.0 ) {
		distanceFalloff *= pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );
	}
	return distanceFalloff;
}
float getSpotAttenuation( const in float coneCosine, const in float penumbraCosine, const in float angleCosine ) {
	return smoothstep( coneCosine, penumbraCosine, angleCosine );
}
#if NUM_DIR_LIGHTS > 0
	struct DirectionalLight {
		vec3 direction;
		vec3 color;
	};
	uniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];
	void getDirectionalLightInfo( const in DirectionalLight directionalLight, out IncidentLight light ) {
		light.color = directionalLight.color;
		light.direction = directionalLight.direction;
		light.visible = true;
	}
#endif
#if NUM_POINT_LIGHTS > 0
	struct PointLight {
		vec3 position;
		vec3 color;
		float distance;
		float decay;
	};
	uniform PointLight pointLights[ NUM_POINT_LIGHTS ];
	void getPointLightInfo( const in PointLight pointLight, const in vec3 geometryPosition, out IncidentLight light ) {
		vec3 lVector = pointLight.position - geometryPosition;
		light.direction = normalize( lVector );
		float lightDistance = length( lVector );
		light.color = pointLight.color;
		light.color *= getDistanceAttenuation( lightDistance, pointLight.distance, pointLight.decay );
		light.visible = ( light.color != vec3( 0.0 ) );
	}
#endif
#if NUM_SPOT_LIGHTS > 0
	struct SpotLight {
		vec3 position;
		vec3 direction;
		vec3 color;
		float distance;
		float decay;
		float coneCos;
		float penumbraCos;
	};
	uniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];
	void getSpotLightInfo( const in SpotLight spotLight, const in vec3 geometryPosition, out IncidentLight light ) {
		vec3 lVector = spotLight.position - geometryPosition;
		light.direction = normalize( lVector );
		float angleCos = dot( light.direction, spotLight.direction );
		float spotAttenuation = getSpotAttenuation( spotLight.coneCos, spotLight.penumbraCos, angleCos );
		if ( spotAttenuation > 0.0 ) {
			float lightDistance = length( lVector );
			light.color = spotLight.color * spotAttenuation;
			light.color *= getDistanceAttenuation( lightDistance, spotLight.distance, spotLight.decay );
			light.visible = ( light.color != vec3( 0.0 ) );
		} else {
			light.color = vec3( 0.0 );
			light.visible = false;
		}
	}
#endif
#if NUM_RECT_AREA_LIGHTS > 0
	struct RectAreaLight {
		vec3 color;
		vec3 position;
		vec3 halfWidth;
		vec3 halfHeight;
	};
	uniform sampler2D ltc_1;	uniform sampler2D ltc_2;
	uniform RectAreaLight rectAreaLights[ NUM_RECT_AREA_LIGHTS ];
#endif
#if NUM_HEMI_LIGHTS > 0
	struct HemisphereLight {
		vec3 direction;
		vec3 skyColor;
		vec3 groundColor;
	};
	uniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];
	vec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in vec3 normal ) {
		float dotNL = dot( normal, hemiLight.direction );
		float hemiDiffuseWeight = 0.5 * dotNL + 0.5;
		vec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );
		return irradiance;
	}
#endif`,u7=`#ifdef USE_ENVMAP
	vec3 getIBLIrradiance( const in vec3 normal ) {
		#ifdef ENVMAP_TYPE_CUBE_UV
			vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
			vec4 envMapColor = textureCubeUV( envMap, envMapRotation * worldNormal, 1.0 );
			return PI * envMapColor.rgb * envMapIntensity;
		#else
			return vec3( 0.0 );
		#endif
	}
	vec3 getIBLRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness ) {
		#ifdef ENVMAP_TYPE_CUBE_UV
			vec3 reflectVec = reflect( - viewDir, normal );
			reflectVec = normalize( mix( reflectVec, normal, pow4( roughness ) ) );
			reflectVec = inverseTransformDirection( reflectVec, viewMatrix );
			vec4 envMapColor = textureCubeUV( envMap, envMapRotation * reflectVec, roughness );
			return envMapColor.rgb * envMapIntensity;
		#else
			return vec3( 0.0 );
		#endif
	}
	#ifdef USE_ANISOTROPY
		vec3 getIBLAnisotropyRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness, const in vec3 bitangent, const in float anisotropy ) {
			#ifdef ENVMAP_TYPE_CUBE_UV
				vec3 bentNormal = cross( bitangent, viewDir );
				bentNormal = normalize( cross( bentNormal, bitangent ) );
				bentNormal = normalize( mix( bentNormal, normal, pow2( pow2( 1.0 - anisotropy * ( 1.0 - roughness ) ) ) ) );
				return getIBLRadiance( viewDir, bentNormal, roughness );
			#else
				return vec3( 0.0 );
			#endif
		}
	#endif
#endif`,h7=`ToonMaterial material;
material.diffuseColor = diffuseColor.rgb;`,f7=`varying vec3 vViewPosition;
struct ToonMaterial {
	vec3 diffuseColor;
};
void RE_Direct_Toon( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {
	vec3 irradiance = getGradientIrradiance( geometryNormal, directLight.direction ) * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Toon( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_Toon
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Toon`,d7=`BlinnPhongMaterial material;
material.diffuseColor = diffuseColor.rgb;
material.specularColor = specular;
material.specularShininess = shininess;
material.specularStrength = specularStrength;`,p7=`varying vec3 vViewPosition;
struct BlinnPhongMaterial {
	vec3 diffuseColor;
	vec3 specularColor;
	float specularShininess;
	float specularStrength;
};
void RE_Direct_BlinnPhong( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometryNormal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
	reflectedLight.directSpecular += irradiance * BRDF_BlinnPhong( directLight.direction, geometryViewDir, geometryNormal, material.specularColor, material.specularShininess ) * material.specularStrength;
}
void RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_BlinnPhong
#define RE_IndirectDiffuse		RE_IndirectDiffuse_BlinnPhong`,m7=`PhysicalMaterial material;
material.diffuseColor = diffuseColor.rgb;
material.diffuseContribution = diffuseColor.rgb * ( 1.0 - metalnessFactor );
material.metalness = metalnessFactor;
vec3 dxy = max( abs( dFdx( nonPerturbedNormal ) ), abs( dFdy( nonPerturbedNormal ) ) );
float geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );
material.roughness = max( roughnessFactor, 0.0525 );material.roughness += geometryRoughness;
material.roughness = min( material.roughness, 1.0 );
#ifdef IOR
	material.ior = ior;
	#ifdef USE_SPECULAR
		float specularIntensityFactor = specularIntensity;
		vec3 specularColorFactor = specularColor;
		#ifdef USE_SPECULAR_COLORMAP
			specularColorFactor *= texture2D( specularColorMap, vSpecularColorMapUv ).rgb;
		#endif
		#ifdef USE_SPECULAR_INTENSITYMAP
			specularIntensityFactor *= texture2D( specularIntensityMap, vSpecularIntensityMapUv ).a;
		#endif
		material.specularF90 = mix( specularIntensityFactor, 1.0, metalnessFactor );
	#else
		float specularIntensityFactor = 1.0;
		vec3 specularColorFactor = vec3( 1.0 );
		material.specularF90 = 1.0;
	#endif
	material.specularColor = min( pow2( ( material.ior - 1.0 ) / ( material.ior + 1.0 ) ) * specularColorFactor, vec3( 1.0 ) ) * specularIntensityFactor;
	material.specularColorBlended = mix( material.specularColor, diffuseColor.rgb, metalnessFactor );
#else
	material.specularColor = vec3( 0.04 );
	material.specularColorBlended = mix( material.specularColor, diffuseColor.rgb, metalnessFactor );
	material.specularF90 = 1.0;
#endif
#ifdef USE_CLEARCOAT
	material.clearcoat = clearcoat;
	material.clearcoatRoughness = clearcoatRoughness;
	material.clearcoatF0 = vec3( 0.04 );
	material.clearcoatF90 = 1.0;
	#ifdef USE_CLEARCOATMAP
		material.clearcoat *= texture2D( clearcoatMap, vClearcoatMapUv ).x;
	#endif
	#ifdef USE_CLEARCOAT_ROUGHNESSMAP
		material.clearcoatRoughness *= texture2D( clearcoatRoughnessMap, vClearcoatRoughnessMapUv ).y;
	#endif
	material.clearcoat = saturate( material.clearcoat );	material.clearcoatRoughness = max( material.clearcoatRoughness, 0.0525 );
	material.clearcoatRoughness += geometryRoughness;
	material.clearcoatRoughness = min( material.clearcoatRoughness, 1.0 );
#endif
#ifdef USE_DISPERSION
	material.dispersion = dispersion;
#endif
#ifdef USE_IRIDESCENCE
	material.iridescence = iridescence;
	material.iridescenceIOR = iridescenceIOR;
	#ifdef USE_IRIDESCENCEMAP
		material.iridescence *= texture2D( iridescenceMap, vIridescenceMapUv ).r;
	#endif
	#ifdef USE_IRIDESCENCE_THICKNESSMAP
		material.iridescenceThickness = (iridescenceThicknessMaximum - iridescenceThicknessMinimum) * texture2D( iridescenceThicknessMap, vIridescenceThicknessMapUv ).g + iridescenceThicknessMinimum;
	#else
		material.iridescenceThickness = iridescenceThicknessMaximum;
	#endif
#endif
#ifdef USE_SHEEN
	material.sheenColor = sheenColor;
	#ifdef USE_SHEEN_COLORMAP
		material.sheenColor *= texture2D( sheenColorMap, vSheenColorMapUv ).rgb;
	#endif
	material.sheenRoughness = clamp( sheenRoughness, 0.0001, 1.0 );
	#ifdef USE_SHEEN_ROUGHNESSMAP
		material.sheenRoughness *= texture2D( sheenRoughnessMap, vSheenRoughnessMapUv ).a;
	#endif
#endif
#ifdef USE_ANISOTROPY
	#ifdef USE_ANISOTROPYMAP
		mat2 anisotropyMat = mat2( anisotropyVector.x, anisotropyVector.y, - anisotropyVector.y, anisotropyVector.x );
		vec3 anisotropyPolar = texture2D( anisotropyMap, vAnisotropyMapUv ).rgb;
		vec2 anisotropyV = anisotropyMat * normalize( 2.0 * anisotropyPolar.rg - vec2( 1.0 ) ) * anisotropyPolar.b;
	#else
		vec2 anisotropyV = anisotropyVector;
	#endif
	material.anisotropy = length( anisotropyV );
	if( material.anisotropy == 0.0 ) {
		anisotropyV = vec2( 1.0, 0.0 );
	} else {
		anisotropyV /= material.anisotropy;
		material.anisotropy = saturate( material.anisotropy );
	}
	material.alphaT = mix( pow2( material.roughness ), 1.0, pow2( material.anisotropy ) );
	material.anisotropyT = tbn[ 0 ] * anisotropyV.x + tbn[ 1 ] * anisotropyV.y;
	material.anisotropyB = tbn[ 1 ] * anisotropyV.x - tbn[ 0 ] * anisotropyV.y;
#endif`,g7=`uniform sampler2D dfgLUT;
struct PhysicalMaterial {
	vec3 diffuseColor;
	vec3 diffuseContribution;
	vec3 specularColor;
	vec3 specularColorBlended;
	float roughness;
	float metalness;
	float specularF90;
	float dispersion;
	#ifdef USE_CLEARCOAT
		float clearcoat;
		float clearcoatRoughness;
		vec3 clearcoatF0;
		float clearcoatF90;
	#endif
	#ifdef USE_IRIDESCENCE
		float iridescence;
		float iridescenceIOR;
		float iridescenceThickness;
		vec3 iridescenceFresnel;
		vec3 iridescenceF0;
		vec3 iridescenceFresnelDielectric;
		vec3 iridescenceFresnelMetallic;
	#endif
	#ifdef USE_SHEEN
		vec3 sheenColor;
		float sheenRoughness;
	#endif
	#ifdef IOR
		float ior;
	#endif
	#ifdef USE_TRANSMISSION
		float transmission;
		float transmissionAlpha;
		float thickness;
		float attenuationDistance;
		vec3 attenuationColor;
	#endif
	#ifdef USE_ANISOTROPY
		float anisotropy;
		float alphaT;
		vec3 anisotropyT;
		vec3 anisotropyB;
	#endif
};
vec3 clearcoatSpecularDirect = vec3( 0.0 );
vec3 clearcoatSpecularIndirect = vec3( 0.0 );
vec3 sheenSpecularDirect = vec3( 0.0 );
vec3 sheenSpecularIndirect = vec3(0.0 );
vec3 Schlick_to_F0( const in vec3 f, const in float f90, const in float dotVH ) {
    float x = clamp( 1.0 - dotVH, 0.0, 1.0 );
    float x2 = x * x;
    float x5 = clamp( x * x2 * x2, 0.0, 0.9999 );
    return ( f - vec3( f90 ) * x5 ) / ( 1.0 - x5 );
}
float V_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {
	float a2 = pow2( alpha );
	float gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );
	float gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );
	return 0.5 / max( gv + gl, EPSILON );
}
float D_GGX( const in float alpha, const in float dotNH ) {
	float a2 = pow2( alpha );
	float denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0;
	return RECIPROCAL_PI * a2 / pow2( denom );
}
#ifdef USE_ANISOTROPY
	float V_GGX_SmithCorrelated_Anisotropic( const in float alphaT, const in float alphaB, const in float dotTV, const in float dotBV, const in float dotTL, const in float dotBL, const in float dotNV, const in float dotNL ) {
		float gv = dotNL * length( vec3( alphaT * dotTV, alphaB * dotBV, dotNV ) );
		float gl = dotNV * length( vec3( alphaT * dotTL, alphaB * dotBL, dotNL ) );
		float v = 0.5 / ( gv + gl );
		return v;
	}
	float D_GGX_Anisotropic( const in float alphaT, const in float alphaB, const in float dotNH, const in float dotTH, const in float dotBH ) {
		float a2 = alphaT * alphaB;
		highp vec3 v = vec3( alphaB * dotTH, alphaT * dotBH, a2 * dotNH );
		highp float v2 = dot( v, v );
		float w2 = a2 / v2;
		return RECIPROCAL_PI * a2 * pow2 ( w2 );
	}
#endif
#ifdef USE_CLEARCOAT
	vec3 BRDF_GGX_Clearcoat( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in PhysicalMaterial material) {
		vec3 f0 = material.clearcoatF0;
		float f90 = material.clearcoatF90;
		float roughness = material.clearcoatRoughness;
		float alpha = pow2( roughness );
		vec3 halfDir = normalize( lightDir + viewDir );
		float dotNL = saturate( dot( normal, lightDir ) );
		float dotNV = saturate( dot( normal, viewDir ) );
		float dotNH = saturate( dot( normal, halfDir ) );
		float dotVH = saturate( dot( viewDir, halfDir ) );
		vec3 F = F_Schlick( f0, f90, dotVH );
		float V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );
		float D = D_GGX( alpha, dotNH );
		return F * ( V * D );
	}
#endif
vec3 BRDF_GGX( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in PhysicalMaterial material ) {
	vec3 f0 = material.specularColorBlended;
	float f90 = material.specularF90;
	float roughness = material.roughness;
	float alpha = pow2( roughness );
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNL = saturate( dot( normal, lightDir ) );
	float dotNV = saturate( dot( normal, viewDir ) );
	float dotNH = saturate( dot( normal, halfDir ) );
	float dotVH = saturate( dot( viewDir, halfDir ) );
	vec3 F = F_Schlick( f0, f90, dotVH );
	#ifdef USE_IRIDESCENCE
		F = mix( F, material.iridescenceFresnel, material.iridescence );
	#endif
	#ifdef USE_ANISOTROPY
		float dotTL = dot( material.anisotropyT, lightDir );
		float dotTV = dot( material.anisotropyT, viewDir );
		float dotTH = dot( material.anisotropyT, halfDir );
		float dotBL = dot( material.anisotropyB, lightDir );
		float dotBV = dot( material.anisotropyB, viewDir );
		float dotBH = dot( material.anisotropyB, halfDir );
		float V = V_GGX_SmithCorrelated_Anisotropic( material.alphaT, alpha, dotTV, dotBV, dotTL, dotBL, dotNV, dotNL );
		float D = D_GGX_Anisotropic( material.alphaT, alpha, dotNH, dotTH, dotBH );
	#else
		float V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );
		float D = D_GGX( alpha, dotNH );
	#endif
	return F * ( V * D );
}
vec2 LTC_Uv( const in vec3 N, const in vec3 V, const in float roughness ) {
	const float LUT_SIZE = 64.0;
	const float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;
	const float LUT_BIAS = 0.5 / LUT_SIZE;
	float dotNV = saturate( dot( N, V ) );
	vec2 uv = vec2( roughness, sqrt( 1.0 - dotNV ) );
	uv = uv * LUT_SCALE + LUT_BIAS;
	return uv;
}
float LTC_ClippedSphereFormFactor( const in vec3 f ) {
	float l = length( f );
	return max( ( l * l + f.z ) / ( l + 1.0 ), 0.0 );
}
vec3 LTC_EdgeVectorFormFactor( const in vec3 v1, const in vec3 v2 ) {
	float x = dot( v1, v2 );
	float y = abs( x );
	float a = 0.8543985 + ( 0.4965155 + 0.0145206 * y ) * y;
	float b = 3.4175940 + ( 4.1616724 + y ) * y;
	float v = a / b;
	float theta_sintheta = ( x > 0.0 ) ? v : 0.5 * inversesqrt( max( 1.0 - x * x, 1e-7 ) ) - v;
	return cross( v1, v2 ) * theta_sintheta;
}
vec3 LTC_Evaluate( const in vec3 N, const in vec3 V, const in vec3 P, const in mat3 mInv, const in vec3 rectCoords[ 4 ] ) {
	vec3 v1 = rectCoords[ 1 ] - rectCoords[ 0 ];
	vec3 v2 = rectCoords[ 3 ] - rectCoords[ 0 ];
	vec3 lightNormal = cross( v1, v2 );
	if( dot( lightNormal, P - rectCoords[ 0 ] ) < 0.0 ) return vec3( 0.0 );
	vec3 T1, T2;
	T1 = normalize( V - N * dot( V, N ) );
	T2 = - cross( N, T1 );
	mat3 mat = mInv * transpose( mat3( T1, T2, N ) );
	vec3 coords[ 4 ];
	coords[ 0 ] = mat * ( rectCoords[ 0 ] - P );
	coords[ 1 ] = mat * ( rectCoords[ 1 ] - P );
	coords[ 2 ] = mat * ( rectCoords[ 2 ] - P );
	coords[ 3 ] = mat * ( rectCoords[ 3 ] - P );
	coords[ 0 ] = normalize( coords[ 0 ] );
	coords[ 1 ] = normalize( coords[ 1 ] );
	coords[ 2 ] = normalize( coords[ 2 ] );
	coords[ 3 ] = normalize( coords[ 3 ] );
	vec3 vectorFormFactor = vec3( 0.0 );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 0 ], coords[ 1 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 1 ], coords[ 2 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 2 ], coords[ 3 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 3 ], coords[ 0 ] );
	float result = LTC_ClippedSphereFormFactor( vectorFormFactor );
	return vec3( result );
}
#if defined( USE_SHEEN )
float D_Charlie( float roughness, float dotNH ) {
	float alpha = pow2( roughness );
	float invAlpha = 1.0 / alpha;
	float cos2h = dotNH * dotNH;
	float sin2h = max( 1.0 - cos2h, 0.0078125 );
	return ( 2.0 + invAlpha ) * pow( sin2h, invAlpha * 0.5 ) / ( 2.0 * PI );
}
float V_Neubelt( float dotNV, float dotNL ) {
	return saturate( 1.0 / ( 4.0 * ( dotNL + dotNV - dotNL * dotNV ) ) );
}
vec3 BRDF_Sheen( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, vec3 sheenColor, const in float sheenRoughness ) {
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNL = saturate( dot( normal, lightDir ) );
	float dotNV = saturate( dot( normal, viewDir ) );
	float dotNH = saturate( dot( normal, halfDir ) );
	float D = D_Charlie( sheenRoughness, dotNH );
	float V = V_Neubelt( dotNV, dotNL );
	return sheenColor * ( D * V );
}
#endif
float IBLSheenBRDF( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {
	float dotNV = saturate( dot( normal, viewDir ) );
	float r2 = roughness * roughness;
	float rInv = 1.0 / ( roughness + 0.1 );
	float a = -1.9362 + 1.0678 * roughness + 0.4573 * r2 - 0.8469 * rInv;
	float b = -0.6014 + 0.5538 * roughness - 0.4670 * r2 - 0.1255 * rInv;
	float DG = exp( a * dotNV + b );
	return saturate( DG );
}
vec3 EnvironmentBRDF( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness ) {
	float dotNV = saturate( dot( normal, viewDir ) );
	vec2 fab = texture2D( dfgLUT, vec2( roughness, dotNV ) ).rg;
	return specularColor * fab.x + specularF90 * fab.y;
}
#ifdef USE_IRIDESCENCE
void computeMultiscatteringIridescence( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float iridescence, const in vec3 iridescenceF0, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {
#else
void computeMultiscattering( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {
#endif
	float dotNV = saturate( dot( normal, viewDir ) );
	vec2 fab = texture2D( dfgLUT, vec2( roughness, dotNV ) ).rg;
	#ifdef USE_IRIDESCENCE
		vec3 Fr = mix( specularColor, iridescenceF0, iridescence );
	#else
		vec3 Fr = specularColor;
	#endif
	vec3 FssEss = Fr * fab.x + specularF90 * fab.y;
	float Ess = fab.x + fab.y;
	float Ems = 1.0 - Ess;
	vec3 Favg = Fr + ( 1.0 - Fr ) * 0.047619;	vec3 Fms = FssEss * Favg / ( 1.0 - Ems * Favg );
	singleScatter += FssEss;
	multiScatter += Fms * Ems;
}
vec3 BRDF_GGX_Multiscatter( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in PhysicalMaterial material ) {
	vec3 singleScatter = BRDF_GGX( lightDir, viewDir, normal, material );
	float dotNL = saturate( dot( normal, lightDir ) );
	float dotNV = saturate( dot( normal, viewDir ) );
	vec2 dfgV = texture2D( dfgLUT, vec2( material.roughness, dotNV ) ).rg;
	vec2 dfgL = texture2D( dfgLUT, vec2( material.roughness, dotNL ) ).rg;
	vec3 FssEss_V = material.specularColorBlended * dfgV.x + material.specularF90 * dfgV.y;
	vec3 FssEss_L = material.specularColorBlended * dfgL.x + material.specularF90 * dfgL.y;
	float Ess_V = dfgV.x + dfgV.y;
	float Ess_L = dfgL.x + dfgL.y;
	float Ems_V = 1.0 - Ess_V;
	float Ems_L = 1.0 - Ess_L;
	vec3 Favg = material.specularColorBlended + ( 1.0 - material.specularColorBlended ) * 0.047619;
	vec3 Fms = FssEss_V * FssEss_L * Favg / ( 1.0 - Ems_V * Ems_L * Favg + EPSILON );
	float compensationFactor = Ems_V * Ems_L;
	vec3 multiScatter = Fms * compensationFactor;
	return singleScatter + multiScatter;
}
#if NUM_RECT_AREA_LIGHTS > 0
	void RE_Direct_RectArea_Physical( const in RectAreaLight rectAreaLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
		vec3 normal = geometryNormal;
		vec3 viewDir = geometryViewDir;
		vec3 position = geometryPosition;
		vec3 lightPos = rectAreaLight.position;
		vec3 halfWidth = rectAreaLight.halfWidth;
		vec3 halfHeight = rectAreaLight.halfHeight;
		vec3 lightColor = rectAreaLight.color;
		float roughness = material.roughness;
		vec3 rectCoords[ 4 ];
		rectCoords[ 0 ] = lightPos + halfWidth - halfHeight;		rectCoords[ 1 ] = lightPos - halfWidth - halfHeight;
		rectCoords[ 2 ] = lightPos - halfWidth + halfHeight;
		rectCoords[ 3 ] = lightPos + halfWidth + halfHeight;
		vec2 uv = LTC_Uv( normal, viewDir, roughness );
		vec4 t1 = texture2D( ltc_1, uv );
		vec4 t2 = texture2D( ltc_2, uv );
		mat3 mInv = mat3(
			vec3( t1.x, 0, t1.y ),
			vec3(    0, 1,    0 ),
			vec3( t1.z, 0, t1.w )
		);
		vec3 fresnel = ( material.specularColorBlended * t2.x + ( vec3( 1.0 ) - material.specularColorBlended ) * t2.y );
		reflectedLight.directSpecular += lightColor * fresnel * LTC_Evaluate( normal, viewDir, position, mInv, rectCoords );
		reflectedLight.directDiffuse += lightColor * material.diffuseContribution * LTC_Evaluate( normal, viewDir, position, mat3( 1.0 ), rectCoords );
	}
#endif
void RE_Direct_Physical( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometryNormal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	#ifdef USE_CLEARCOAT
		float dotNLcc = saturate( dot( geometryClearcoatNormal, directLight.direction ) );
		vec3 ccIrradiance = dotNLcc * directLight.color;
		clearcoatSpecularDirect += ccIrradiance * BRDF_GGX_Clearcoat( directLight.direction, geometryViewDir, geometryClearcoatNormal, material );
	#endif
	#ifdef USE_SHEEN
 
 		sheenSpecularDirect += irradiance * BRDF_Sheen( directLight.direction, geometryViewDir, geometryNormal, material.sheenColor, material.sheenRoughness );
 
 		float sheenAlbedoV = IBLSheenBRDF( geometryNormal, geometryViewDir, material.sheenRoughness );
 		float sheenAlbedoL = IBLSheenBRDF( geometryNormal, directLight.direction, material.sheenRoughness );
 
 		float sheenEnergyComp = 1.0 - max3( material.sheenColor ) * max( sheenAlbedoV, sheenAlbedoL );
 
 		irradiance *= sheenEnergyComp;
 
 	#endif
	reflectedLight.directSpecular += irradiance * BRDF_GGX_Multiscatter( directLight.direction, geometryViewDir, geometryNormal, material );
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseContribution );
}
void RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
	vec3 diffuse = irradiance * BRDF_Lambert( material.diffuseContribution );
	#ifdef USE_SHEEN
		float sheenAlbedo = IBLSheenBRDF( geometryNormal, geometryViewDir, material.sheenRoughness );
		float sheenEnergyComp = 1.0 - max3( material.sheenColor ) * sheenAlbedo;
		diffuse *= sheenEnergyComp;
	#endif
	reflectedLight.indirectDiffuse += diffuse;
}
void RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 irradiance, const in vec3 clearcoatRadiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight) {
	#ifdef USE_CLEARCOAT
		clearcoatSpecularIndirect += clearcoatRadiance * EnvironmentBRDF( geometryClearcoatNormal, geometryViewDir, material.clearcoatF0, material.clearcoatF90, material.clearcoatRoughness );
	#endif
	#ifdef USE_SHEEN
		sheenSpecularIndirect += irradiance * material.sheenColor * IBLSheenBRDF( geometryNormal, geometryViewDir, material.sheenRoughness ) * RECIPROCAL_PI;
 	#endif
	vec3 singleScatteringDielectric = vec3( 0.0 );
	vec3 multiScatteringDielectric = vec3( 0.0 );
	vec3 singleScatteringMetallic = vec3( 0.0 );
	vec3 multiScatteringMetallic = vec3( 0.0 );
	#ifdef USE_IRIDESCENCE
		computeMultiscatteringIridescence( geometryNormal, geometryViewDir, material.specularColor, material.specularF90, material.iridescence, material.iridescenceFresnelDielectric, material.roughness, singleScatteringDielectric, multiScatteringDielectric );
		computeMultiscatteringIridescence( geometryNormal, geometryViewDir, material.diffuseColor, material.specularF90, material.iridescence, material.iridescenceFresnelMetallic, material.roughness, singleScatteringMetallic, multiScatteringMetallic );
	#else
		computeMultiscattering( geometryNormal, geometryViewDir, material.specularColor, material.specularF90, material.roughness, singleScatteringDielectric, multiScatteringDielectric );
		computeMultiscattering( geometryNormal, geometryViewDir, material.diffuseColor, material.specularF90, material.roughness, singleScatteringMetallic, multiScatteringMetallic );
	#endif
	vec3 singleScattering = mix( singleScatteringDielectric, singleScatteringMetallic, material.metalness );
	vec3 multiScattering = mix( multiScatteringDielectric, multiScatteringMetallic, material.metalness );
	vec3 totalScatteringDielectric = singleScatteringDielectric + multiScatteringDielectric;
	vec3 diffuse = material.diffuseContribution * ( 1.0 - totalScatteringDielectric );
	vec3 cosineWeightedIrradiance = irradiance * RECIPROCAL_PI;
	vec3 indirectSpecular = radiance * singleScattering;
	indirectSpecular += multiScattering * cosineWeightedIrradiance;
	vec3 indirectDiffuse = diffuse * cosineWeightedIrradiance;
	#ifdef USE_SHEEN
		float sheenAlbedo = IBLSheenBRDF( geometryNormal, geometryViewDir, material.sheenRoughness );
		float sheenEnergyComp = 1.0 - max3( material.sheenColor ) * sheenAlbedo;
		indirectSpecular *= sheenEnergyComp;
		indirectDiffuse *= sheenEnergyComp;
	#endif
	reflectedLight.indirectSpecular += indirectSpecular;
	reflectedLight.indirectDiffuse += indirectDiffuse;
}
#define RE_Direct				RE_Direct_Physical
#define RE_Direct_RectArea		RE_Direct_RectArea_Physical
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Physical
#define RE_IndirectSpecular		RE_IndirectSpecular_Physical
float computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {
	return saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );
}`,v7=`
vec3 geometryPosition = - vViewPosition;
vec3 geometryNormal = normal;
vec3 geometryViewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( vViewPosition );
vec3 geometryClearcoatNormal = vec3( 0.0 );
#ifdef USE_CLEARCOAT
	geometryClearcoatNormal = clearcoatNormal;
#endif
#ifdef USE_IRIDESCENCE
	float dotNVi = saturate( dot( normal, geometryViewDir ) );
	if ( material.iridescenceThickness == 0.0 ) {
		material.iridescence = 0.0;
	} else {
		material.iridescence = saturate( material.iridescence );
	}
	if ( material.iridescence > 0.0 ) {
		material.iridescenceFresnelDielectric = evalIridescence( 1.0, material.iridescenceIOR, dotNVi, material.iridescenceThickness, material.specularColor );
		material.iridescenceFresnelMetallic = evalIridescence( 1.0, material.iridescenceIOR, dotNVi, material.iridescenceThickness, material.diffuseColor );
		material.iridescenceFresnel = mix( material.iridescenceFresnelDielectric, material.iridescenceFresnelMetallic, material.metalness );
		material.iridescenceF0 = Schlick_to_F0( material.iridescenceFresnel, 1.0, dotNVi );
	}
#endif
IncidentLight directLight;
#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )
	PointLight pointLight;
	#if defined( USE_SHADOWMAP ) && NUM_POINT_LIGHT_SHADOWS > 0
	PointLightShadow pointLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {
		pointLight = pointLights[ i ];
		getPointLightInfo( pointLight, geometryPosition, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_POINT_LIGHT_SHADOWS ) && ( defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_BASIC ) )
		pointLightShadow = pointLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getPointShadow( pointShadowMap[ i ], pointLightShadow.shadowMapSize, pointLightShadow.shadowIntensity, pointLightShadow.shadowBias, pointLightShadow.shadowRadius, vPointShadowCoord[ i ], pointLightShadow.shadowCameraNear, pointLightShadow.shadowCameraFar ) : 1.0;
		#endif
		RE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )
	SpotLight spotLight;
	vec4 spotColor;
	vec3 spotLightCoord;
	bool inSpotLightMap;
	#if defined( USE_SHADOWMAP ) && NUM_SPOT_LIGHT_SHADOWS > 0
	SpotLightShadow spotLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {
		spotLight = spotLights[ i ];
		getSpotLightInfo( spotLight, geometryPosition, directLight );
		#if ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )
		#define SPOT_LIGHT_MAP_INDEX UNROLLED_LOOP_INDEX
		#elif ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
		#define SPOT_LIGHT_MAP_INDEX NUM_SPOT_LIGHT_MAPS
		#else
		#define SPOT_LIGHT_MAP_INDEX ( UNROLLED_LOOP_INDEX - NUM_SPOT_LIGHT_SHADOWS + NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )
		#endif
		#if ( SPOT_LIGHT_MAP_INDEX < NUM_SPOT_LIGHT_MAPS )
			spotLightCoord = vSpotLightCoord[ i ].xyz / vSpotLightCoord[ i ].w;
			inSpotLightMap = all( lessThan( abs( spotLightCoord * 2. - 1. ), vec3( 1.0 ) ) );
			spotColor = texture2D( spotLightMap[ SPOT_LIGHT_MAP_INDEX ], spotLightCoord.xy );
			directLight.color = inSpotLightMap ? directLight.color * spotColor.rgb : directLight.color;
		#endif
		#undef SPOT_LIGHT_MAP_INDEX
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
		spotLightShadow = spotLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( spotShadowMap[ i ], spotLightShadow.shadowMapSize, spotLightShadow.shadowIntensity, spotLightShadow.shadowBias, spotLightShadow.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;
		#endif
		RE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )
	DirectionalLight directionalLight;
	#if defined( USE_SHADOWMAP ) && NUM_DIR_LIGHT_SHADOWS > 0
	DirectionalLightShadow directionalLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {
		directionalLight = directionalLights[ i ];
		getDirectionalLightInfo( directionalLight, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_DIR_LIGHT_SHADOWS )
		directionalLightShadow = directionalLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( directionalShadowMap[ i ], directionalLightShadow.shadowMapSize, directionalLightShadow.shadowIntensity, directionalLightShadow.shadowBias, directionalLightShadow.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;
		#endif
		RE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )
	RectAreaLight rectAreaLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {
		rectAreaLight = rectAreaLights[ i ];
		RE_Direct_RectArea( rectAreaLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if defined( RE_IndirectDiffuse )
	vec3 iblIrradiance = vec3( 0.0 );
	vec3 irradiance = getAmbientLightIrradiance( ambientLightColor );
	#if defined( USE_LIGHT_PROBES )
		irradiance += getLightProbeIrradiance( lightProbe, geometryNormal );
	#endif
	#if ( NUM_HEMI_LIGHTS > 0 )
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {
			irradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometryNormal );
		}
		#pragma unroll_loop_end
	#endif
#endif
#if defined( RE_IndirectSpecular )
	vec3 radiance = vec3( 0.0 );
	vec3 clearcoatRadiance = vec3( 0.0 );
#endif`,y7=`#if defined( RE_IndirectDiffuse )
	#ifdef USE_LIGHTMAP
		vec4 lightMapTexel = texture2D( lightMap, vLightMapUv );
		vec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;
		irradiance += lightMapIrradiance;
	#endif
	#if defined( USE_ENVMAP ) && defined( STANDARD ) && defined( ENVMAP_TYPE_CUBE_UV )
		iblIrradiance += getIBLIrradiance( geometryNormal );
	#endif
#endif
#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )
	#ifdef USE_ANISOTROPY
		radiance += getIBLAnisotropyRadiance( geometryViewDir, geometryNormal, material.roughness, material.anisotropyB, material.anisotropy );
	#else
		radiance += getIBLRadiance( geometryViewDir, geometryNormal, material.roughness );
	#endif
	#ifdef USE_CLEARCOAT
		clearcoatRadiance += getIBLRadiance( geometryViewDir, geometryClearcoatNormal, material.clearcoatRoughness );
	#endif
#endif`,_7=`#if defined( RE_IndirectDiffuse )
	RE_IndirectDiffuse( irradiance, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
#endif
#if defined( RE_IndirectSpecular )
	RE_IndirectSpecular( radiance, iblIrradiance, clearcoatRadiance, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
#endif`,x7=`#if defined( USE_LOGARITHMIC_DEPTH_BUFFER )
	gl_FragDepth = vIsPerspective == 0.0 ? gl_FragCoord.z : log2( vFragDepth ) * logDepthBufFC * 0.5;
#endif`,b7=`#if defined( USE_LOGARITHMIC_DEPTH_BUFFER )
	uniform float logDepthBufFC;
	varying float vFragDepth;
	varying float vIsPerspective;
#endif`,A7=`#ifdef USE_LOGARITHMIC_DEPTH_BUFFER
	varying float vFragDepth;
	varying float vIsPerspective;
#endif`,S7=`#ifdef USE_LOGARITHMIC_DEPTH_BUFFER
	vFragDepth = 1.0 + gl_Position.w;
	vIsPerspective = float( isPerspectiveMatrix( projectionMatrix ) );
#endif`,E7=`#ifdef USE_MAP
	vec4 sampledDiffuseColor = texture2D( map, vMapUv );
	#ifdef DECODE_VIDEO_TEXTURE
		sampledDiffuseColor = sRGBTransferEOTF( sampledDiffuseColor );
	#endif
	diffuseColor *= sampledDiffuseColor;
#endif`,T7=`#ifdef USE_MAP
	uniform sampler2D map;
#endif`,M7=`#if defined( USE_MAP ) || defined( USE_ALPHAMAP )
	#if defined( USE_POINTS_UV )
		vec2 uv = vUv;
	#else
		vec2 uv = ( uvTransform * vec3( gl_PointCoord.x, 1.0 - gl_PointCoord.y, 1 ) ).xy;
	#endif
#endif
#ifdef USE_MAP
	diffuseColor *= texture2D( map, uv );
#endif
#ifdef USE_ALPHAMAP
	diffuseColor.a *= texture2D( alphaMap, uv ).g;
#endif`,w7=`#if defined( USE_POINTS_UV )
	varying vec2 vUv;
#else
	#if defined( USE_MAP ) || defined( USE_ALPHAMAP )
		uniform mat3 uvTransform;
	#endif
#endif
#ifdef USE_MAP
	uniform sampler2D map;
#endif
#ifdef USE_ALPHAMAP
	uniform sampler2D alphaMap;
#endif`,C7=`float metalnessFactor = metalness;
#ifdef USE_METALNESSMAP
	vec4 texelMetalness = texture2D( metalnessMap, vMetalnessMapUv );
	metalnessFactor *= texelMetalness.b;
#endif`,R7=`#ifdef USE_METALNESSMAP
	uniform sampler2D metalnessMap;
#endif`,I7=`#ifdef USE_INSTANCING_MORPH
	float morphTargetInfluences[ MORPHTARGETS_COUNT ];
	float morphTargetBaseInfluence = texelFetch( morphTexture, ivec2( 0, gl_InstanceID ), 0 ).r;
	for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
		morphTargetInfluences[i] =  texelFetch( morphTexture, ivec2( i + 1, gl_InstanceID ), 0 ).r;
	}
#endif`,D7=`#if defined( USE_MORPHCOLORS )
	vColor *= morphTargetBaseInfluence;
	for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
		#if defined( USE_COLOR_ALPHA )
			if ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ) * morphTargetInfluences[ i ];
		#elif defined( USE_COLOR )
			if ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ).rgb * morphTargetInfluences[ i ];
		#endif
	}
#endif`,N7=`#ifdef USE_MORPHNORMALS
	objectNormal *= morphTargetBaseInfluence;
	for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
		if ( morphTargetInfluences[ i ] != 0.0 ) objectNormal += getMorph( gl_VertexID, i, 1 ).xyz * morphTargetInfluences[ i ];
	}
#endif`,P7=`#ifdef USE_MORPHTARGETS
	#ifndef USE_INSTANCING_MORPH
		uniform float morphTargetBaseInfluence;
		uniform float morphTargetInfluences[ MORPHTARGETS_COUNT ];
	#endif
	uniform sampler2DArray morphTargetsTexture;
	uniform ivec2 morphTargetsTextureSize;
	vec4 getMorph( const in int vertexIndex, const in int morphTargetIndex, const in int offset ) {
		int texelIndex = vertexIndex * MORPHTARGETS_TEXTURE_STRIDE + offset;
		int y = texelIndex / morphTargetsTextureSize.x;
		int x = texelIndex - y * morphTargetsTextureSize.x;
		ivec3 morphUV = ivec3( x, y, morphTargetIndex );
		return texelFetch( morphTargetsTexture, morphUV, 0 );
	}
#endif`,B7=`#ifdef USE_MORPHTARGETS
	transformed *= morphTargetBaseInfluence;
	for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
		if ( morphTargetInfluences[ i ] != 0.0 ) transformed += getMorph( gl_VertexID, i, 0 ).xyz * morphTargetInfluences[ i ];
	}
#endif`,L7=`float faceDirection = gl_FrontFacing ? 1.0 : - 1.0;
#ifdef FLAT_SHADED
	vec3 fdx = dFdx( vViewPosition );
	vec3 fdy = dFdy( vViewPosition );
	vec3 normal = normalize( cross( fdx, fdy ) );
#else
	vec3 normal = normalize( vNormal );
	#ifdef DOUBLE_SIDED
		normal *= faceDirection;
	#endif
#endif
#if defined( USE_NORMALMAP_TANGENTSPACE ) || defined( USE_CLEARCOAT_NORMALMAP ) || defined( USE_ANISOTROPY )
	#ifdef USE_TANGENT
		mat3 tbn = mat3( normalize( vTangent ), normalize( vBitangent ), normal );
	#else
		mat3 tbn = getTangentFrame( - vViewPosition, normal,
		#if defined( USE_NORMALMAP )
			vNormalMapUv
		#elif defined( USE_CLEARCOAT_NORMALMAP )
			vClearcoatNormalMapUv
		#else
			vUv
		#endif
		);
	#endif
	#if defined( DOUBLE_SIDED ) && ! defined( FLAT_SHADED )
		tbn[0] *= faceDirection;
		tbn[1] *= faceDirection;
	#endif
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	#ifdef USE_TANGENT
		mat3 tbn2 = mat3( normalize( vTangent ), normalize( vBitangent ), normal );
	#else
		mat3 tbn2 = getTangentFrame( - vViewPosition, normal, vClearcoatNormalMapUv );
	#endif
	#if defined( DOUBLE_SIDED ) && ! defined( FLAT_SHADED )
		tbn2[0] *= faceDirection;
		tbn2[1] *= faceDirection;
	#endif
#endif
vec3 nonPerturbedNormal = normal;`,O7=`#ifdef USE_NORMALMAP_OBJECTSPACE
	normal = texture2D( normalMap, vNormalMapUv ).xyz * 2.0 - 1.0;
	#ifdef FLIP_SIDED
		normal = - normal;
	#endif
	#ifdef DOUBLE_SIDED
		normal = normal * faceDirection;
	#endif
	normal = normalize( normalMatrix * normal );
#elif defined( USE_NORMALMAP_TANGENTSPACE )
	vec3 mapN = texture2D( normalMap, vNormalMapUv ).xyz * 2.0 - 1.0;
	mapN.xy *= normalScale;
	normal = normalize( tbn * mapN );
#elif defined( USE_BUMPMAP )
	normal = perturbNormalArb( - vViewPosition, normal, dHdxy_fwd(), faceDirection );
#endif`,U7=`#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif`,F7=`#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif`,k7=`#ifndef FLAT_SHADED
	vNormal = normalize( transformedNormal );
	#ifdef USE_TANGENT
		vTangent = normalize( transformedTangent );
		vBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );
	#endif
#endif`,z7=`#ifdef USE_NORMALMAP
	uniform sampler2D normalMap;
	uniform vec2 normalScale;
#endif
#ifdef USE_NORMALMAP_OBJECTSPACE
	uniform mat3 normalMatrix;
#endif
#if ! defined ( USE_TANGENT ) && ( defined ( USE_NORMALMAP_TANGENTSPACE ) || defined ( USE_CLEARCOAT_NORMALMAP ) || defined( USE_ANISOTROPY ) )
	mat3 getTangentFrame( vec3 eye_pos, vec3 surf_norm, vec2 uv ) {
		vec3 q0 = dFdx( eye_pos.xyz );
		vec3 q1 = dFdy( eye_pos.xyz );
		vec2 st0 = dFdx( uv.st );
		vec2 st1 = dFdy( uv.st );
		vec3 N = surf_norm;
		vec3 q1perp = cross( q1, N );
		vec3 q0perp = cross( N, q0 );
		vec3 T = q1perp * st0.x + q0perp * st1.x;
		vec3 B = q1perp * st0.y + q0perp * st1.y;
		float det = max( dot( T, T ), dot( B, B ) );
		float scale = ( det == 0.0 ) ? 0.0 : inversesqrt( det );
		return mat3( T * scale, B * scale, N );
	}
#endif`,V7=`#ifdef USE_CLEARCOAT
	vec3 clearcoatNormal = nonPerturbedNormal;
#endif`,H7=`#ifdef USE_CLEARCOAT_NORMALMAP
	vec3 clearcoatMapN = texture2D( clearcoatNormalMap, vClearcoatNormalMapUv ).xyz * 2.0 - 1.0;
	clearcoatMapN.xy *= clearcoatNormalScale;
	clearcoatNormal = normalize( tbn2 * clearcoatMapN );
#endif`,G7=`#ifdef USE_CLEARCOATMAP
	uniform sampler2D clearcoatMap;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	uniform sampler2D clearcoatNormalMap;
	uniform vec2 clearcoatNormalScale;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	uniform sampler2D clearcoatRoughnessMap;
#endif`,j7=`#ifdef USE_IRIDESCENCEMAP
	uniform sampler2D iridescenceMap;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	uniform sampler2D iridescenceThicknessMap;
#endif`,W7=`#ifdef OPAQUE
diffuseColor.a = 1.0;
#endif
#ifdef USE_TRANSMISSION
diffuseColor.a *= material.transmissionAlpha;
#endif
gl_FragColor = vec4( outgoingLight, diffuseColor.a );`,q7=`vec3 packNormalToRGB( const in vec3 normal ) {
	return normalize( normal ) * 0.5 + 0.5;
}
vec3 unpackRGBToNormal( const in vec3 rgb ) {
	return 2.0 * rgb.xyz - 1.0;
}
const float PackUpscale = 256. / 255.;const float UnpackDownscale = 255. / 256.;const float ShiftRight8 = 1. / 256.;
const float Inv255 = 1. / 255.;
const vec4 PackFactors = vec4( 1.0, 256.0, 256.0 * 256.0, 256.0 * 256.0 * 256.0 );
const vec2 UnpackFactors2 = vec2( UnpackDownscale, 1.0 / PackFactors.g );
const vec3 UnpackFactors3 = vec3( UnpackDownscale / PackFactors.rg, 1.0 / PackFactors.b );
const vec4 UnpackFactors4 = vec4( UnpackDownscale / PackFactors.rgb, 1.0 / PackFactors.a );
vec4 packDepthToRGBA( const in float v ) {
	if( v <= 0.0 )
		return vec4( 0., 0., 0., 0. );
	if( v >= 1.0 )
		return vec4( 1., 1., 1., 1. );
	float vuf;
	float af = modf( v * PackFactors.a, vuf );
	float bf = modf( vuf * ShiftRight8, vuf );
	float gf = modf( vuf * ShiftRight8, vuf );
	return vec4( vuf * Inv255, gf * PackUpscale, bf * PackUpscale, af );
}
vec3 packDepthToRGB( const in float v ) {
	if( v <= 0.0 )
		return vec3( 0., 0., 0. );
	if( v >= 1.0 )
		return vec3( 1., 1., 1. );
	float vuf;
	float bf = modf( v * PackFactors.b, vuf );
	float gf = modf( vuf * ShiftRight8, vuf );
	return vec3( vuf * Inv255, gf * PackUpscale, bf );
}
vec2 packDepthToRG( const in float v ) {
	if( v <= 0.0 )
		return vec2( 0., 0. );
	if( v >= 1.0 )
		return vec2( 1., 1. );
	float vuf;
	float gf = modf( v * 256., vuf );
	return vec2( vuf * Inv255, gf );
}
float unpackRGBAToDepth( const in vec4 v ) {
	return dot( v, UnpackFactors4 );
}
float unpackRGBToDepth( const in vec3 v ) {
	return dot( v, UnpackFactors3 );
}
float unpackRGToDepth( const in vec2 v ) {
	return v.r * UnpackFactors2.r + v.g * UnpackFactors2.g;
}
vec4 pack2HalfToRGBA( const in vec2 v ) {
	vec4 r = vec4( v.x, fract( v.x * 255.0 ), v.y, fract( v.y * 255.0 ) );
	return vec4( r.x - r.y / 255.0, r.y, r.z - r.w / 255.0, r.w );
}
vec2 unpackRGBATo2Half( const in vec4 v ) {
	return vec2( v.x + ( v.y / 255.0 ), v.z + ( v.w / 255.0 ) );
}
float viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {
	return ( viewZ + near ) / ( near - far );
}
float orthographicDepthToViewZ( const in float depth, const in float near, const in float far ) {
	return depth * ( near - far ) - near;
}
float viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {
	return ( ( near + viewZ ) * far ) / ( ( far - near ) * viewZ );
}
float perspectiveDepthToViewZ( const in float depth, const in float near, const in float far ) {
	return ( near * far ) / ( ( far - near ) * depth - far );
}`,X7=`#ifdef PREMULTIPLIED_ALPHA
	gl_FragColor.rgb *= gl_FragColor.a;
#endif`,Y7=`vec4 mvPosition = vec4( transformed, 1.0 );
#ifdef USE_BATCHING
	mvPosition = batchingMatrix * mvPosition;
#endif
#ifdef USE_INSTANCING
	mvPosition = instanceMatrix * mvPosition;
#endif
mvPosition = modelViewMatrix * mvPosition;
gl_Position = projectionMatrix * mvPosition;`,J7=`#ifdef DITHERING
	gl_FragColor.rgb = dithering( gl_FragColor.rgb );
#endif`,K7=`#ifdef DITHERING
	vec3 dithering( vec3 color ) {
		float grid_position = rand( gl_FragCoord.xy );
		vec3 dither_shift_RGB = vec3( 0.25 / 255.0, -0.25 / 255.0, 0.25 / 255.0 );
		dither_shift_RGB = mix( 2.0 * dither_shift_RGB, -2.0 * dither_shift_RGB, grid_position );
		return color + dither_shift_RGB;
	}
#endif`,Q7=`float roughnessFactor = roughness;
#ifdef USE_ROUGHNESSMAP
	vec4 texelRoughness = texture2D( roughnessMap, vRoughnessMapUv );
	roughnessFactor *= texelRoughness.g;
#endif`,Z7=`#ifdef USE_ROUGHNESSMAP
	uniform sampler2D roughnessMap;
#endif`,$7=`#if NUM_SPOT_LIGHT_COORDS > 0
	varying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];
#endif
#if NUM_SPOT_LIGHT_MAPS > 0
	uniform sampler2D spotLightMap[ NUM_SPOT_LIGHT_MAPS ];
#endif
#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
		#if defined( SHADOWMAP_TYPE_PCF )
			uniform sampler2DShadow directionalShadowMap[ NUM_DIR_LIGHT_SHADOWS ];
		#else
			uniform sampler2D directionalShadowMap[ NUM_DIR_LIGHT_SHADOWS ];
		#endif
		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];
		struct DirectionalLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
		#if defined( SHADOWMAP_TYPE_PCF )
			uniform sampler2DShadow spotShadowMap[ NUM_SPOT_LIGHT_SHADOWS ];
		#else
			uniform sampler2D spotShadowMap[ NUM_SPOT_LIGHT_SHADOWS ];
		#endif
		struct SpotLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		#if defined( SHADOWMAP_TYPE_PCF )
			uniform samplerCubeShadow pointShadowMap[ NUM_POINT_LIGHT_SHADOWS ];
		#elif defined( SHADOWMAP_TYPE_BASIC )
			uniform samplerCube pointShadowMap[ NUM_POINT_LIGHT_SHADOWS ];
		#endif
		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];
		struct PointLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
			float shadowCameraNear;
			float shadowCameraFar;
		};
		uniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];
	#endif
	#if defined( SHADOWMAP_TYPE_PCF )
		float interleavedGradientNoise( vec2 position ) {
			return fract( 52.9829189 * fract( dot( position, vec2( 0.06711056, 0.00583715 ) ) ) );
		}
		vec2 vogelDiskSample( int sampleIndex, int samplesCount, float phi ) {
			const float goldenAngle = 2.399963229728653;
			float r = sqrt( ( float( sampleIndex ) + 0.5 ) / float( samplesCount ) );
			float theta = float( sampleIndex ) * goldenAngle + phi;
			return vec2( cos( theta ), sin( theta ) ) * r;
		}
	#endif
	#if defined( SHADOWMAP_TYPE_PCF )
		float getShadow( sampler2DShadow shadowMap, vec2 shadowMapSize, float shadowIntensity, float shadowBias, float shadowRadius, vec4 shadowCoord ) {
			float shadow = 1.0;
			shadowCoord.xyz /= shadowCoord.w;
			shadowCoord.z += shadowBias;
			bool inFrustum = shadowCoord.x >= 0.0 && shadowCoord.x <= 1.0 && shadowCoord.y >= 0.0 && shadowCoord.y <= 1.0;
			bool frustumTest = inFrustum && shadowCoord.z <= 1.0;
			if ( frustumTest ) {
				vec2 texelSize = vec2( 1.0 ) / shadowMapSize;
				float radius = shadowRadius * texelSize.x;
				float phi = interleavedGradientNoise( gl_FragCoord.xy ) * 6.28318530718;
				shadow = (
					texture( shadowMap, vec3( shadowCoord.xy + vogelDiskSample( 0, 5, phi ) * radius, shadowCoord.z ) ) +
					texture( shadowMap, vec3( shadowCoord.xy + vogelDiskSample( 1, 5, phi ) * radius, shadowCoord.z ) ) +
					texture( shadowMap, vec3( shadowCoord.xy + vogelDiskSample( 2, 5, phi ) * radius, shadowCoord.z ) ) +
					texture( shadowMap, vec3( shadowCoord.xy + vogelDiskSample( 3, 5, phi ) * radius, shadowCoord.z ) ) +
					texture( shadowMap, vec3( shadowCoord.xy + vogelDiskSample( 4, 5, phi ) * radius, shadowCoord.z ) )
				) * 0.2;
			}
			return mix( 1.0, shadow, shadowIntensity );
		}
	#elif defined( SHADOWMAP_TYPE_VSM )
		float getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowIntensity, float shadowBias, float shadowRadius, vec4 shadowCoord ) {
			float shadow = 1.0;
			shadowCoord.xyz /= shadowCoord.w;
			shadowCoord.z += shadowBias;
			bool inFrustum = shadowCoord.x >= 0.0 && shadowCoord.x <= 1.0 && shadowCoord.y >= 0.0 && shadowCoord.y <= 1.0;
			bool frustumTest = inFrustum && shadowCoord.z <= 1.0;
			if ( frustumTest ) {
				vec2 distribution = texture2D( shadowMap, shadowCoord.xy ).rg;
				float mean = distribution.x;
				float variance = distribution.y * distribution.y;
				#ifdef USE_REVERSED_DEPTH_BUFFER
					float hard_shadow = step( mean, shadowCoord.z );
				#else
					float hard_shadow = step( shadowCoord.z, mean );
				#endif
				if ( hard_shadow == 1.0 ) {
					shadow = 1.0;
				} else {
					variance = max( variance, 0.0000001 );
					float d = shadowCoord.z - mean;
					float p_max = variance / ( variance + d * d );
					p_max = clamp( ( p_max - 0.3 ) / 0.65, 0.0, 1.0 );
					shadow = max( hard_shadow, p_max );
				}
			}
			return mix( 1.0, shadow, shadowIntensity );
		}
	#else
		float getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowIntensity, float shadowBias, float shadowRadius, vec4 shadowCoord ) {
			float shadow = 1.0;
			shadowCoord.xyz /= shadowCoord.w;
			shadowCoord.z += shadowBias;
			bool inFrustum = shadowCoord.x >= 0.0 && shadowCoord.x <= 1.0 && shadowCoord.y >= 0.0 && shadowCoord.y <= 1.0;
			bool frustumTest = inFrustum && shadowCoord.z <= 1.0;
			if ( frustumTest ) {
				float depth = texture2D( shadowMap, shadowCoord.xy ).r;
				#ifdef USE_REVERSED_DEPTH_BUFFER
					shadow = step( depth, shadowCoord.z );
				#else
					shadow = step( shadowCoord.z, depth );
				#endif
			}
			return mix( 1.0, shadow, shadowIntensity );
		}
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
	#if defined( SHADOWMAP_TYPE_PCF )
	float getPointShadow( samplerCubeShadow shadowMap, vec2 shadowMapSize, float shadowIntensity, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {
		float shadow = 1.0;
		vec3 lightToPosition = shadowCoord.xyz;
		vec3 bd3D = normalize( lightToPosition );
		vec3 absVec = abs( lightToPosition );
		float viewSpaceZ = max( max( absVec.x, absVec.y ), absVec.z );
		if ( viewSpaceZ - shadowCameraFar <= 0.0 && viewSpaceZ - shadowCameraNear >= 0.0 ) {
			float dp = ( shadowCameraFar * ( viewSpaceZ - shadowCameraNear ) ) / ( viewSpaceZ * ( shadowCameraFar - shadowCameraNear ) );
			dp += shadowBias;
			float texelSize = shadowRadius / shadowMapSize.x;
			vec3 absDir = abs( bd3D );
			vec3 tangent = absDir.x > absDir.z ? vec3( 0.0, 1.0, 0.0 ) : vec3( 1.0, 0.0, 0.0 );
			tangent = normalize( cross( bd3D, tangent ) );
			vec3 bitangent = cross( bd3D, tangent );
			float phi = interleavedGradientNoise( gl_FragCoord.xy ) * 6.28318530718;
			shadow = (
				texture( shadowMap, vec4( bd3D + ( tangent * vogelDiskSample( 0, 5, phi ).x + bitangent * vogelDiskSample( 0, 5, phi ).y ) * texelSize, dp ) ) +
				texture( shadowMap, vec4( bd3D + ( tangent * vogelDiskSample( 1, 5, phi ).x + bitangent * vogelDiskSample( 1, 5, phi ).y ) * texelSize, dp ) ) +
				texture( shadowMap, vec4( bd3D + ( tangent * vogelDiskSample( 2, 5, phi ).x + bitangent * vogelDiskSample( 2, 5, phi ).y ) * texelSize, dp ) ) +
				texture( shadowMap, vec4( bd3D + ( tangent * vogelDiskSample( 3, 5, phi ).x + bitangent * vogelDiskSample( 3, 5, phi ).y ) * texelSize, dp ) ) +
				texture( shadowMap, vec4( bd3D + ( tangent * vogelDiskSample( 4, 5, phi ).x + bitangent * vogelDiskSample( 4, 5, phi ).y ) * texelSize, dp ) )
			) * 0.2;
		}
		return mix( 1.0, shadow, shadowIntensity );
	}
	#elif defined( SHADOWMAP_TYPE_BASIC )
	float getPointShadow( samplerCube shadowMap, vec2 shadowMapSize, float shadowIntensity, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {
		float shadow = 1.0;
		vec3 lightToPosition = shadowCoord.xyz;
		vec3 bd3D = normalize( lightToPosition );
		vec3 absVec = abs( lightToPosition );
		float viewSpaceZ = max( max( absVec.x, absVec.y ), absVec.z );
		if ( viewSpaceZ - shadowCameraFar <= 0.0 && viewSpaceZ - shadowCameraNear >= 0.0 ) {
			float dp = ( shadowCameraFar * ( viewSpaceZ - shadowCameraNear ) ) / ( viewSpaceZ * ( shadowCameraFar - shadowCameraNear ) );
			dp += shadowBias;
			float depth = textureCube( shadowMap, bd3D ).r;
			#ifdef USE_REVERSED_DEPTH_BUFFER
				shadow = step( depth, dp );
			#else
				shadow = step( dp, depth );
			#endif
		}
		return mix( 1.0, shadow, shadowIntensity );
	}
	#endif
	#endif
#endif`,ej=`#if NUM_SPOT_LIGHT_COORDS > 0
	uniform mat4 spotLightMatrix[ NUM_SPOT_LIGHT_COORDS ];
	varying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];
#endif
#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
		uniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHT_SHADOWS ];
		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];
		struct DirectionalLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
		struct SpotLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		uniform mat4 pointShadowMatrix[ NUM_POINT_LIGHT_SHADOWS ];
		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];
		struct PointLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
			float shadowCameraNear;
			float shadowCameraFar;
		};
		uniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];
	#endif
#endif`,tj=`#if ( defined( USE_SHADOWMAP ) && ( NUM_DIR_LIGHT_SHADOWS > 0 || NUM_POINT_LIGHT_SHADOWS > 0 ) ) || ( NUM_SPOT_LIGHT_COORDS > 0 )
	vec3 shadowWorldNormal = inverseTransformDirection( transformedNormal, viewMatrix );
	vec4 shadowWorldPosition;
#endif
#if defined( USE_SHADOWMAP )
	#if NUM_DIR_LIGHT_SHADOWS > 0
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {
			shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * directionalLightShadows[ i ].shadowNormalBias, 0 );
			vDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * shadowWorldPosition;
		}
		#pragma unroll_loop_end
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {
			shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * pointLightShadows[ i ].shadowNormalBias, 0 );
			vPointShadowCoord[ i ] = pointShadowMatrix[ i ] * shadowWorldPosition;
		}
		#pragma unroll_loop_end
	#endif
#endif
#if NUM_SPOT_LIGHT_COORDS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHT_COORDS; i ++ ) {
		shadowWorldPosition = worldPosition;
		#if ( defined( USE_SHADOWMAP ) && UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
			shadowWorldPosition.xyz += shadowWorldNormal * spotLightShadows[ i ].shadowNormalBias;
		#endif
		vSpotLightCoord[ i ] = spotLightMatrix[ i ] * shadowWorldPosition;
	}
	#pragma unroll_loop_end
#endif`,nj=`float getShadowMask() {
	float shadow = 1.0;
	#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
	DirectionalLightShadow directionalLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {
		directionalLight = directionalLightShadows[ i ];
		shadow *= receiveShadow ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowIntensity, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
	SpotLightShadow spotLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {
		spotLight = spotLightShadows[ i ];
		shadow *= receiveShadow ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowIntensity, spotLight.shadowBias, spotLight.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0 && ( defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_BASIC ) )
	PointLightShadow pointLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {
		pointLight = pointLightShadows[ i ];
		shadow *= receiveShadow ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowIntensity, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#endif
	return shadow;
}`,ij=`#ifdef USE_SKINNING
	mat4 boneMatX = getBoneMatrix( skinIndex.x );
	mat4 boneMatY = getBoneMatrix( skinIndex.y );
	mat4 boneMatZ = getBoneMatrix( skinIndex.z );
	mat4 boneMatW = getBoneMatrix( skinIndex.w );
#endif`,rj=`#ifdef USE_SKINNING
	uniform mat4 bindMatrix;
	uniform mat4 bindMatrixInverse;
	uniform highp sampler2D boneTexture;
	mat4 getBoneMatrix( const in float i ) {
		int size = textureSize( boneTexture, 0 ).x;
		int j = int( i ) * 4;
		int x = j % size;
		int y = j / size;
		vec4 v1 = texelFetch( boneTexture, ivec2( x, y ), 0 );
		vec4 v2 = texelFetch( boneTexture, ivec2( x + 1, y ), 0 );
		vec4 v3 = texelFetch( boneTexture, ivec2( x + 2, y ), 0 );
		vec4 v4 = texelFetch( boneTexture, ivec2( x + 3, y ), 0 );
		return mat4( v1, v2, v3, v4 );
	}
#endif`,sj=`#ifdef USE_SKINNING
	vec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );
	vec4 skinned = vec4( 0.0 );
	skinned += boneMatX * skinVertex * skinWeight.x;
	skinned += boneMatY * skinVertex * skinWeight.y;
	skinned += boneMatZ * skinVertex * skinWeight.z;
	skinned += boneMatW * skinVertex * skinWeight.w;
	transformed = ( bindMatrixInverse * skinned ).xyz;
#endif`,aj=`#ifdef USE_SKINNING
	mat4 skinMatrix = mat4( 0.0 );
	skinMatrix += skinWeight.x * boneMatX;
	skinMatrix += skinWeight.y * boneMatY;
	skinMatrix += skinWeight.z * boneMatZ;
	skinMatrix += skinWeight.w * boneMatW;
	skinMatrix = bindMatrixInverse * skinMatrix * bindMatrix;
	objectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;
	#ifdef USE_TANGENT
		objectTangent = vec4( skinMatrix * vec4( objectTangent, 0.0 ) ).xyz;
	#endif
#endif`,oj=`float specularStrength;
#ifdef USE_SPECULARMAP
	vec4 texelSpecular = texture2D( specularMap, vSpecularMapUv );
	specularStrength = texelSpecular.r;
#else
	specularStrength = 1.0;
#endif`,lj=`#ifdef USE_SPECULARMAP
	uniform sampler2D specularMap;
#endif`,cj=`#if defined( TONE_MAPPING )
	gl_FragColor.rgb = toneMapping( gl_FragColor.rgb );
#endif`,uj=`#ifndef saturate
#define saturate( a ) clamp( a, 0.0, 1.0 )
#endif
uniform float toneMappingExposure;
vec3 LinearToneMapping( vec3 color ) {
	return saturate( toneMappingExposure * color );
}
vec3 ReinhardToneMapping( vec3 color ) {
	color *= toneMappingExposure;
	return saturate( color / ( vec3( 1.0 ) + color ) );
}
vec3 CineonToneMapping( vec3 color ) {
	color *= toneMappingExposure;
	color = max( vec3( 0.0 ), color - 0.004 );
	return pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );
}
vec3 RRTAndODTFit( vec3 v ) {
	vec3 a = v * ( v + 0.0245786 ) - 0.000090537;
	vec3 b = v * ( 0.983729 * v + 0.4329510 ) + 0.238081;
	return a / b;
}
vec3 ACESFilmicToneMapping( vec3 color ) {
	const mat3 ACESInputMat = mat3(
		vec3( 0.59719, 0.07600, 0.02840 ),		vec3( 0.35458, 0.90834, 0.13383 ),
		vec3( 0.04823, 0.01566, 0.83777 )
	);
	const mat3 ACESOutputMat = mat3(
		vec3(  1.60475, -0.10208, -0.00327 ),		vec3( -0.53108,  1.10813, -0.07276 ),
		vec3( -0.07367, -0.00605,  1.07602 )
	);
	color *= toneMappingExposure / 0.6;
	color = ACESInputMat * color;
	color = RRTAndODTFit( color );
	color = ACESOutputMat * color;
	return saturate( color );
}
const mat3 LINEAR_REC2020_TO_LINEAR_SRGB = mat3(
	vec3( 1.6605, - 0.1246, - 0.0182 ),
	vec3( - 0.5876, 1.1329, - 0.1006 ),
	vec3( - 0.0728, - 0.0083, 1.1187 )
);
const mat3 LINEAR_SRGB_TO_LINEAR_REC2020 = mat3(
	vec3( 0.6274, 0.0691, 0.0164 ),
	vec3( 0.3293, 0.9195, 0.0880 ),
	vec3( 0.0433, 0.0113, 0.8956 )
);
vec3 agxDefaultContrastApprox( vec3 x ) {
	vec3 x2 = x * x;
	vec3 x4 = x2 * x2;
	return + 15.5 * x4 * x2
		- 40.14 * x4 * x
		+ 31.96 * x4
		- 6.868 * x2 * x
		+ 0.4298 * x2
		+ 0.1191 * x
		- 0.00232;
}
vec3 AgXToneMapping( vec3 color ) {
	const mat3 AgXInsetMatrix = mat3(
		vec3( 0.856627153315983, 0.137318972929847, 0.11189821299995 ),
		vec3( 0.0951212405381588, 0.761241990602591, 0.0767994186031903 ),
		vec3( 0.0482516061458583, 0.101439036467562, 0.811302368396859 )
	);
	const mat3 AgXOutsetMatrix = mat3(
		vec3( 1.1271005818144368, - 0.1413297634984383, - 0.14132976349843826 ),
		vec3( - 0.11060664309660323, 1.157823702216272, - 0.11060664309660294 ),
		vec3( - 0.016493938717834573, - 0.016493938717834257, 1.2519364065950405 )
	);
	const float AgxMinEv = - 12.47393;	const float AgxMaxEv = 4.026069;
	color *= toneMappingExposure;
	color = LINEAR_SRGB_TO_LINEAR_REC2020 * color;
	color = AgXInsetMatrix * color;
	color = max( color, 1e-10 );	color = log2( color );
	color = ( color - AgxMinEv ) / ( AgxMaxEv - AgxMinEv );
	color = clamp( color, 0.0, 1.0 );
	color = agxDefaultContrastApprox( color );
	color = AgXOutsetMatrix * color;
	color = pow( max( vec3( 0.0 ), color ), vec3( 2.2 ) );
	color = LINEAR_REC2020_TO_LINEAR_SRGB * color;
	color = clamp( color, 0.0, 1.0 );
	return color;
}
vec3 NeutralToneMapping( vec3 color ) {
	const float StartCompression = 0.8 - 0.04;
	const float Desaturation = 0.15;
	color *= toneMappingExposure;
	float x = min( color.r, min( color.g, color.b ) );
	float offset = x < 0.08 ? x - 6.25 * x * x : 0.04;
	color -= offset;
	float peak = max( color.r, max( color.g, color.b ) );
	if ( peak < StartCompression ) return color;
	float d = 1. - StartCompression;
	float newPeak = 1. - d * d / ( peak + d - StartCompression );
	color *= newPeak / peak;
	float g = 1. - 1. / ( Desaturation * ( peak - newPeak ) + 1. );
	return mix( color, vec3( newPeak ), g );
}
vec3 CustomToneMapping( vec3 color ) { return color; }`,hj=`#ifdef USE_TRANSMISSION
	material.transmission = transmission;
	material.transmissionAlpha = 1.0;
	material.thickness = thickness;
	material.attenuationDistance = attenuationDistance;
	material.attenuationColor = attenuationColor;
	#ifdef USE_TRANSMISSIONMAP
		material.transmission *= texture2D( transmissionMap, vTransmissionMapUv ).r;
	#endif
	#ifdef USE_THICKNESSMAP
		material.thickness *= texture2D( thicknessMap, vThicknessMapUv ).g;
	#endif
	vec3 pos = vWorldPosition;
	vec3 v = normalize( cameraPosition - pos );
	vec3 n = inverseTransformDirection( normal, viewMatrix );
	vec4 transmitted = getIBLVolumeRefraction(
		n, v, material.roughness, material.diffuseContribution, material.specularColorBlended, material.specularF90,
		pos, modelMatrix, viewMatrix, projectionMatrix, material.dispersion, material.ior, material.thickness,
		material.attenuationColor, material.attenuationDistance );
	material.transmissionAlpha = mix( material.transmissionAlpha, transmitted.a, material.transmission );
	totalDiffuse = mix( totalDiffuse, transmitted.rgb, material.transmission );
#endif`,fj=`#ifdef USE_TRANSMISSION
	uniform float transmission;
	uniform float thickness;
	uniform float attenuationDistance;
	uniform vec3 attenuationColor;
	#ifdef USE_TRANSMISSIONMAP
		uniform sampler2D transmissionMap;
	#endif
	#ifdef USE_THICKNESSMAP
		uniform sampler2D thicknessMap;
	#endif
	uniform vec2 transmissionSamplerSize;
	uniform sampler2D transmissionSamplerMap;
	uniform mat4 modelMatrix;
	uniform mat4 projectionMatrix;
	varying vec3 vWorldPosition;
	float w0( float a ) {
		return ( 1.0 / 6.0 ) * ( a * ( a * ( - a + 3.0 ) - 3.0 ) + 1.0 );
	}
	float w1( float a ) {
		return ( 1.0 / 6.0 ) * ( a *  a * ( 3.0 * a - 6.0 ) + 4.0 );
	}
	float w2( float a ){
		return ( 1.0 / 6.0 ) * ( a * ( a * ( - 3.0 * a + 3.0 ) + 3.0 ) + 1.0 );
	}
	float w3( float a ) {
		return ( 1.0 / 6.0 ) * ( a * a * a );
	}
	float g0( float a ) {
		return w0( a ) + w1( a );
	}
	float g1( float a ) {
		return w2( a ) + w3( a );
	}
	float h0( float a ) {
		return - 1.0 + w1( a ) / ( w0( a ) + w1( a ) );
	}
	float h1( float a ) {
		return 1.0 + w3( a ) / ( w2( a ) + w3( a ) );
	}
	vec4 bicubic( sampler2D tex, vec2 uv, vec4 texelSize, float lod ) {
		uv = uv * texelSize.zw + 0.5;
		vec2 iuv = floor( uv );
		vec2 fuv = fract( uv );
		float g0x = g0( fuv.x );
		float g1x = g1( fuv.x );
		float h0x = h0( fuv.x );
		float h1x = h1( fuv.x );
		float h0y = h0( fuv.y );
		float h1y = h1( fuv.y );
		vec2 p0 = ( vec2( iuv.x + h0x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;
		vec2 p1 = ( vec2( iuv.x + h1x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;
		vec2 p2 = ( vec2( iuv.x + h0x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;
		vec2 p3 = ( vec2( iuv.x + h1x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;
		return g0( fuv.y ) * ( g0x * textureLod( tex, p0, lod ) + g1x * textureLod( tex, p1, lod ) ) +
			g1( fuv.y ) * ( g0x * textureLod( tex, p2, lod ) + g1x * textureLod( tex, p3, lod ) );
	}
	vec4 textureBicubic( sampler2D sampler, vec2 uv, float lod ) {
		vec2 fLodSize = vec2( textureSize( sampler, int( lod ) ) );
		vec2 cLodSize = vec2( textureSize( sampler, int( lod + 1.0 ) ) );
		vec2 fLodSizeInv = 1.0 / fLodSize;
		vec2 cLodSizeInv = 1.0 / cLodSize;
		vec4 fSample = bicubic( sampler, uv, vec4( fLodSizeInv, fLodSize ), floor( lod ) );
		vec4 cSample = bicubic( sampler, uv, vec4( cLodSizeInv, cLodSize ), ceil( lod ) );
		return mix( fSample, cSample, fract( lod ) );
	}
	vec3 getVolumeTransmissionRay( const in vec3 n, const in vec3 v, const in float thickness, const in float ior, const in mat4 modelMatrix ) {
		vec3 refractionVector = refract( - v, normalize( n ), 1.0 / ior );
		vec3 modelScale;
		modelScale.x = length( vec3( modelMatrix[ 0 ].xyz ) );
		modelScale.y = length( vec3( modelMatrix[ 1 ].xyz ) );
		modelScale.z = length( vec3( modelMatrix[ 2 ].xyz ) );
		return normalize( refractionVector ) * thickness * modelScale;
	}
	float applyIorToRoughness( const in float roughness, const in float ior ) {
		return roughness * clamp( ior * 2.0 - 2.0, 0.0, 1.0 );
	}
	vec4 getTransmissionSample( const in vec2 fragCoord, const in float roughness, const in float ior ) {
		float lod = log2( transmissionSamplerSize.x ) * applyIorToRoughness( roughness, ior );
		return textureBicubic( transmissionSamplerMap, fragCoord.xy, lod );
	}
	vec3 volumeAttenuation( const in float transmissionDistance, const in vec3 attenuationColor, const in float attenuationDistance ) {
		if ( isinf( attenuationDistance ) ) {
			return vec3( 1.0 );
		} else {
			vec3 attenuationCoefficient = -log( attenuationColor ) / attenuationDistance;
			vec3 transmittance = exp( - attenuationCoefficient * transmissionDistance );			return transmittance;
		}
	}
	vec4 getIBLVolumeRefraction( const in vec3 n, const in vec3 v, const in float roughness, const in vec3 diffuseColor,
		const in vec3 specularColor, const in float specularF90, const in vec3 position, const in mat4 modelMatrix,
		const in mat4 viewMatrix, const in mat4 projMatrix, const in float dispersion, const in float ior, const in float thickness,
		const in vec3 attenuationColor, const in float attenuationDistance ) {
		vec4 transmittedLight;
		vec3 transmittance;
		#ifdef USE_DISPERSION
			float halfSpread = ( ior - 1.0 ) * 0.025 * dispersion;
			vec3 iors = vec3( ior - halfSpread, ior, ior + halfSpread );
			for ( int i = 0; i < 3; i ++ ) {
				vec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, iors[ i ], modelMatrix );
				vec3 refractedRayExit = position + transmissionRay;
				vec4 ndcPos = projMatrix * viewMatrix * vec4( refractedRayExit, 1.0 );
				vec2 refractionCoords = ndcPos.xy / ndcPos.w;
				refractionCoords += 1.0;
				refractionCoords /= 2.0;
				vec4 transmissionSample = getTransmissionSample( refractionCoords, roughness, iors[ i ] );
				transmittedLight[ i ] = transmissionSample[ i ];
				transmittedLight.a += transmissionSample.a;
				transmittance[ i ] = diffuseColor[ i ] * volumeAttenuation( length( transmissionRay ), attenuationColor, attenuationDistance )[ i ];
			}
			transmittedLight.a /= 3.0;
		#else
			vec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, ior, modelMatrix );
			vec3 refractedRayExit = position + transmissionRay;
			vec4 ndcPos = projMatrix * viewMatrix * vec4( refractedRayExit, 1.0 );
			vec2 refractionCoords = ndcPos.xy / ndcPos.w;
			refractionCoords += 1.0;
			refractionCoords /= 2.0;
			transmittedLight = getTransmissionSample( refractionCoords, roughness, ior );
			transmittance = diffuseColor * volumeAttenuation( length( transmissionRay ), attenuationColor, attenuationDistance );
		#endif
		vec3 attenuatedColor = transmittance * transmittedLight.rgb;
		vec3 F = EnvironmentBRDF( n, v, specularColor, specularF90, roughness );
		float transmittanceFactor = ( transmittance.r + transmittance.g + transmittance.b ) / 3.0;
		return vec4( ( 1.0 - F ) * attenuatedColor, 1.0 - ( 1.0 - transmittedLight.a ) * transmittanceFactor );
	}
#endif`,dj=`#if defined( USE_UV ) || defined( USE_ANISOTROPY )
	varying vec2 vUv;
#endif
#ifdef USE_MAP
	varying vec2 vMapUv;
#endif
#ifdef USE_ALPHAMAP
	varying vec2 vAlphaMapUv;
#endif
#ifdef USE_LIGHTMAP
	varying vec2 vLightMapUv;
#endif
#ifdef USE_AOMAP
	varying vec2 vAoMapUv;
#endif
#ifdef USE_BUMPMAP
	varying vec2 vBumpMapUv;
#endif
#ifdef USE_NORMALMAP
	varying vec2 vNormalMapUv;
#endif
#ifdef USE_EMISSIVEMAP
	varying vec2 vEmissiveMapUv;
#endif
#ifdef USE_METALNESSMAP
	varying vec2 vMetalnessMapUv;
#endif
#ifdef USE_ROUGHNESSMAP
	varying vec2 vRoughnessMapUv;
#endif
#ifdef USE_ANISOTROPYMAP
	varying vec2 vAnisotropyMapUv;
#endif
#ifdef USE_CLEARCOATMAP
	varying vec2 vClearcoatMapUv;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	varying vec2 vClearcoatNormalMapUv;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	varying vec2 vClearcoatRoughnessMapUv;
#endif
#ifdef USE_IRIDESCENCEMAP
	varying vec2 vIridescenceMapUv;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	varying vec2 vIridescenceThicknessMapUv;
#endif
#ifdef USE_SHEEN_COLORMAP
	varying vec2 vSheenColorMapUv;
#endif
#ifdef USE_SHEEN_ROUGHNESSMAP
	varying vec2 vSheenRoughnessMapUv;
#endif
#ifdef USE_SPECULARMAP
	varying vec2 vSpecularMapUv;
#endif
#ifdef USE_SPECULAR_COLORMAP
	varying vec2 vSpecularColorMapUv;
#endif
#ifdef USE_SPECULAR_INTENSITYMAP
	varying vec2 vSpecularIntensityMapUv;
#endif
#ifdef USE_TRANSMISSIONMAP
	uniform mat3 transmissionMapTransform;
	varying vec2 vTransmissionMapUv;
#endif
#ifdef USE_THICKNESSMAP
	uniform mat3 thicknessMapTransform;
	varying vec2 vThicknessMapUv;
#endif`,pj=`#if defined( USE_UV ) || defined( USE_ANISOTROPY )
	varying vec2 vUv;
#endif
#ifdef USE_MAP
	uniform mat3 mapTransform;
	varying vec2 vMapUv;
#endif
#ifdef USE_ALPHAMAP
	uniform mat3 alphaMapTransform;
	varying vec2 vAlphaMapUv;
#endif
#ifdef USE_LIGHTMAP
	uniform mat3 lightMapTransform;
	varying vec2 vLightMapUv;
#endif
#ifdef USE_AOMAP
	uniform mat3 aoMapTransform;
	varying vec2 vAoMapUv;
#endif
#ifdef USE_BUMPMAP
	uniform mat3 bumpMapTransform;
	varying vec2 vBumpMapUv;
#endif
#ifdef USE_NORMALMAP
	uniform mat3 normalMapTransform;
	varying vec2 vNormalMapUv;
#endif
#ifdef USE_DISPLACEMENTMAP
	uniform mat3 displacementMapTransform;
	varying vec2 vDisplacementMapUv;
#endif
#ifdef USE_EMISSIVEMAP
	uniform mat3 emissiveMapTransform;
	varying vec2 vEmissiveMapUv;
#endif
#ifdef USE_METALNESSMAP
	uniform mat3 metalnessMapTransform;
	varying vec2 vMetalnessMapUv;
#endif
#ifdef USE_ROUGHNESSMAP
	uniform mat3 roughnessMapTransform;
	varying vec2 vRoughnessMapUv;
#endif
#ifdef USE_ANISOTROPYMAP
	uniform mat3 anisotropyMapTransform;
	varying vec2 vAnisotropyMapUv;
#endif
#ifdef USE_CLEARCOATMAP
	uniform mat3 clearcoatMapTransform;
	varying vec2 vClearcoatMapUv;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	uniform mat3 clearcoatNormalMapTransform;
	varying vec2 vClearcoatNormalMapUv;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	uniform mat3 clearcoatRoughnessMapTransform;
	varying vec2 vClearcoatRoughnessMapUv;
#endif
#ifdef USE_SHEEN_COLORMAP
	uniform mat3 sheenColorMapTransform;
	varying vec2 vSheenColorMapUv;
#endif
#ifdef USE_SHEEN_ROUGHNESSMAP
	uniform mat3 sheenRoughnessMapTransform;
	varying vec2 vSheenRoughnessMapUv;
#endif
#ifdef USE_IRIDESCENCEMAP
	uniform mat3 iridescenceMapTransform;
	varying vec2 vIridescenceMapUv;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	uniform mat3 iridescenceThicknessMapTransform;
	varying vec2 vIridescenceThicknessMapUv;
#endif
#ifdef USE_SPECULARMAP
	uniform mat3 specularMapTransform;
	varying vec2 vSpecularMapUv;
#endif
#ifdef USE_SPECULAR_COLORMAP
	uniform mat3 specularColorMapTransform;
	varying vec2 vSpecularColorMapUv;
#endif
#ifdef USE_SPECULAR_INTENSITYMAP
	uniform mat3 specularIntensityMapTransform;
	varying vec2 vSpecularIntensityMapUv;
#endif
#ifdef USE_TRANSMISSIONMAP
	uniform mat3 transmissionMapTransform;
	varying vec2 vTransmissionMapUv;
#endif
#ifdef USE_THICKNESSMAP
	uniform mat3 thicknessMapTransform;
	varying vec2 vThicknessMapUv;
#endif`,mj=`#if defined( USE_UV ) || defined( USE_ANISOTROPY )
	vUv = vec3( uv, 1 ).xy;
#endif
#ifdef USE_MAP
	vMapUv = ( mapTransform * vec3( MAP_UV, 1 ) ).xy;
#endif
#ifdef USE_ALPHAMAP
	vAlphaMapUv = ( alphaMapTransform * vec3( ALPHAMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_LIGHTMAP
	vLightMapUv = ( lightMapTransform * vec3( LIGHTMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_AOMAP
	vAoMapUv = ( aoMapTransform * vec3( AOMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_BUMPMAP
	vBumpMapUv = ( bumpMapTransform * vec3( BUMPMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_NORMALMAP
	vNormalMapUv = ( normalMapTransform * vec3( NORMALMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_DISPLACEMENTMAP
	vDisplacementMapUv = ( displacementMapTransform * vec3( DISPLACEMENTMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_EMISSIVEMAP
	vEmissiveMapUv = ( emissiveMapTransform * vec3( EMISSIVEMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_METALNESSMAP
	vMetalnessMapUv = ( metalnessMapTransform * vec3( METALNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_ROUGHNESSMAP
	vRoughnessMapUv = ( roughnessMapTransform * vec3( ROUGHNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_ANISOTROPYMAP
	vAnisotropyMapUv = ( anisotropyMapTransform * vec3( ANISOTROPYMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_CLEARCOATMAP
	vClearcoatMapUv = ( clearcoatMapTransform * vec3( CLEARCOATMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	vClearcoatNormalMapUv = ( clearcoatNormalMapTransform * vec3( CLEARCOAT_NORMALMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	vClearcoatRoughnessMapUv = ( clearcoatRoughnessMapTransform * vec3( CLEARCOAT_ROUGHNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_IRIDESCENCEMAP
	vIridescenceMapUv = ( iridescenceMapTransform * vec3( IRIDESCENCEMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	vIridescenceThicknessMapUv = ( iridescenceThicknessMapTransform * vec3( IRIDESCENCE_THICKNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SHEEN_COLORMAP
	vSheenColorMapUv = ( sheenColorMapTransform * vec3( SHEEN_COLORMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SHEEN_ROUGHNESSMAP
	vSheenRoughnessMapUv = ( sheenRoughnessMapTransform * vec3( SHEEN_ROUGHNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SPECULARMAP
	vSpecularMapUv = ( specularMapTransform * vec3( SPECULARMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SPECULAR_COLORMAP
	vSpecularColorMapUv = ( specularColorMapTransform * vec3( SPECULAR_COLORMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SPECULAR_INTENSITYMAP
	vSpecularIntensityMapUv = ( specularIntensityMapTransform * vec3( SPECULAR_INTENSITYMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_TRANSMISSIONMAP
	vTransmissionMapUv = ( transmissionMapTransform * vec3( TRANSMISSIONMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_THICKNESSMAP
	vThicknessMapUv = ( thicknessMapTransform * vec3( THICKNESSMAP_UV, 1 ) ).xy;
#endif`,gj=`#if defined( USE_ENVMAP ) || defined( DISTANCE ) || defined ( USE_SHADOWMAP ) || defined ( USE_TRANSMISSION ) || NUM_SPOT_LIGHT_COORDS > 0
	vec4 worldPosition = vec4( transformed, 1.0 );
	#ifdef USE_BATCHING
		worldPosition = batchingMatrix * worldPosition;
	#endif
	#ifdef USE_INSTANCING
		worldPosition = instanceMatrix * worldPosition;
	#endif
	worldPosition = modelMatrix * worldPosition;
#endif`;const vj=`varying vec2 vUv;
uniform mat3 uvTransform;
void main() {
	vUv = ( uvTransform * vec3( uv, 1 ) ).xy;
	gl_Position = vec4( position.xy, 1.0, 1.0 );
}`,yj=`uniform sampler2D t2D;
uniform float backgroundIntensity;
varying vec2 vUv;
void main() {
	vec4 texColor = texture2D( t2D, vUv );
	#ifdef DECODE_VIDEO_TEXTURE
		texColor = vec4( mix( pow( texColor.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), texColor.rgb * 0.0773993808, vec3( lessThanEqual( texColor.rgb, vec3( 0.04045 ) ) ) ), texColor.w );
	#endif
	texColor.rgb *= backgroundIntensity;
	gl_FragColor = texColor;
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,_j=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
	gl_Position.z = gl_Position.w;
}`,xj=`#ifdef ENVMAP_TYPE_CUBE
	uniform samplerCube envMap;
#elif defined( ENVMAP_TYPE_CUBE_UV )
	uniform sampler2D envMap;
#endif
uniform float flipEnvMap;
uniform float backgroundBlurriness;
uniform float backgroundIntensity;
uniform mat3 backgroundRotation;
varying vec3 vWorldDirection;
#include <cube_uv_reflection_fragment>
void main() {
	#ifdef ENVMAP_TYPE_CUBE
		vec4 texColor = textureCube( envMap, backgroundRotation * vec3( flipEnvMap * vWorldDirection.x, vWorldDirection.yz ) );
	#elif defined( ENVMAP_TYPE_CUBE_UV )
		vec4 texColor = textureCubeUV( envMap, backgroundRotation * vWorldDirection, backgroundBlurriness );
	#else
		vec4 texColor = vec4( 0.0, 0.0, 0.0, 1.0 );
	#endif
	texColor.rgb *= backgroundIntensity;
	gl_FragColor = texColor;
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,bj=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
	gl_Position.z = gl_Position.w;
}`,Aj=`uniform samplerCube tCube;
uniform float tFlip;
uniform float opacity;
varying vec3 vWorldDirection;
void main() {
	vec4 texColor = textureCube( tCube, vec3( tFlip * vWorldDirection.x, vWorldDirection.yz ) );
	gl_FragColor = texColor;
	gl_FragColor.a *= opacity;
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,Sj=`#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
varying vec2 vHighPrecisionZW;
void main() {
	#include <uv_vertex>
	#include <batching_vertex>
	#include <skinbase_vertex>
	#include <morphinstance_vertex>
	#ifdef USE_DISPLACEMENTMAP
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vHighPrecisionZW = gl_Position.zw;
}`,Ej=`#if DEPTH_PACKING == 3200
	uniform float opacity;
#endif
#include <common>
#include <packing>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
varying vec2 vHighPrecisionZW;
void main() {
	vec4 diffuseColor = vec4( 1.0 );
	#include <clipping_planes_fragment>
	#if DEPTH_PACKING == 3200
		diffuseColor.a = opacity;
	#endif
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <logdepthbuf_fragment>
	#ifdef USE_REVERSED_DEPTH_BUFFER
		float fragCoordZ = vHighPrecisionZW[ 0 ] / vHighPrecisionZW[ 1 ];
	#else
		float fragCoordZ = 0.5 * vHighPrecisionZW[ 0 ] / vHighPrecisionZW[ 1 ] + 0.5;
	#endif
	#if DEPTH_PACKING == 3200
		gl_FragColor = vec4( vec3( 1.0 - fragCoordZ ), opacity );
	#elif DEPTH_PACKING == 3201
		gl_FragColor = packDepthToRGBA( fragCoordZ );
	#elif DEPTH_PACKING == 3202
		gl_FragColor = vec4( packDepthToRGB( fragCoordZ ), 1.0 );
	#elif DEPTH_PACKING == 3203
		gl_FragColor = vec4( packDepthToRG( fragCoordZ ), 0.0, 1.0 );
	#endif
}`,Tj=`#define DISTANCE
varying vec3 vWorldPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <batching_vertex>
	#include <skinbase_vertex>
	#include <morphinstance_vertex>
	#ifdef USE_DISPLACEMENTMAP
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <worldpos_vertex>
	#include <clipping_planes_vertex>
	vWorldPosition = worldPosition.xyz;
}`,Mj=`#define DISTANCE
uniform vec3 referencePosition;
uniform float nearDistance;
uniform float farDistance;
varying vec3 vWorldPosition;
#include <common>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <clipping_planes_pars_fragment>
void main () {
	vec4 diffuseColor = vec4( 1.0 );
	#include <clipping_planes_fragment>
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	float dist = length( vWorldPosition - referencePosition );
	dist = ( dist - nearDistance ) / ( farDistance - nearDistance );
	dist = saturate( dist );
	gl_FragColor = vec4( dist, 0.0, 0.0, 1.0 );
}`,wj=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
}`,Cj=`uniform sampler2D tEquirect;
varying vec3 vWorldDirection;
#include <common>
void main() {
	vec3 direction = normalize( vWorldDirection );
	vec2 sampleUV = equirectUv( direction );
	gl_FragColor = texture2D( tEquirect, sampleUV );
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,Rj=`uniform float scale;
attribute float lineDistance;
varying float vLineDistance;
#include <common>
#include <uv_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	vLineDistance = scale * lineDistance;
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
}`,Ij=`uniform vec3 diffuse;
uniform float opacity;
uniform float dashSize;
uniform float totalSize;
varying float vLineDistance;
#include <common>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	if ( mod( vLineDistance, totalSize ) > dashSize ) {
		discard;
	}
	vec3 outgoingLight = vec3( 0.0 );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
}`,Dj=`#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#if defined ( USE_ENVMAP ) || defined ( USE_SKINNING )
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinbase_vertex>
		#include <skinnormal_vertex>
		#include <defaultnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <fog_vertex>
}`,Nj=`uniform vec3 diffuse;
uniform float opacity;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
#endif
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <specularmap_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	#ifdef USE_LIGHTMAP
		vec4 lightMapTexel = texture2D( lightMap, vLightMapUv );
		reflectedLight.indirectDiffuse += lightMapTexel.rgb * lightMapIntensity * RECIPROCAL_PI;
	#else
		reflectedLight.indirectDiffuse += vec3( 1.0 );
	#endif
	#include <aomap_fragment>
	reflectedLight.indirectDiffuse *= diffuseColor.rgb;
	vec3 outgoingLight = reflectedLight.indirectDiffuse;
	#include <envmap_fragment>
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,Pj=`#define LAMBERT
varying vec3 vViewPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,Bj=`#define LAMBERT
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float opacity;
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_lambert_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <specularmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_lambert_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;
	#include <envmap_fragment>
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,Lj=`#define MATCAP
varying vec3 vViewPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <color_pars_vertex>
#include <displacementmap_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
	vViewPosition = - mvPosition.xyz;
}`,Oj=`#define MATCAP
uniform vec3 diffuse;
uniform float opacity;
uniform sampler2D matcap;
varying vec3 vViewPosition;
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <fog_pars_fragment>
#include <normal_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	vec3 viewDir = normalize( vViewPosition );
	vec3 x = normalize( vec3( viewDir.z, 0.0, - viewDir.x ) );
	vec3 y = cross( viewDir, x );
	vec2 uv = vec2( dot( x, normal ), dot( y, normal ) ) * 0.495 + 0.5;
	#ifdef USE_MATCAP
		vec4 matcapColor = texture2D( matcap, uv );
	#else
		vec4 matcapColor = vec4( vec3( mix( 0.2, 0.8, uv.y ) ), 1.0 );
	#endif
	vec3 outgoingLight = diffuseColor.rgb * matcapColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,Uj=`#define NORMAL
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )
	varying vec3 vViewPosition;
#endif
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphinstance_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )
	vViewPosition = - mvPosition.xyz;
#endif
}`,Fj=`#define NORMAL
uniform float opacity;
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )
	varying vec3 vViewPosition;
#endif
#include <uv_pars_fragment>
#include <normal_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( 0.0, 0.0, 0.0, opacity );
	#include <clipping_planes_fragment>
	#include <logdepthbuf_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	gl_FragColor = vec4( normalize( normal ) * 0.5 + 0.5, diffuseColor.a );
	#ifdef OPAQUE
		gl_FragColor.a = 1.0;
	#endif
}`,kj=`#define PHONG
varying vec3 vViewPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphinstance_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,zj=`#define PHONG
uniform vec3 diffuse;
uniform vec3 emissive;
uniform vec3 specular;
uniform float shininess;
uniform float opacity;
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_phong_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <specularmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_phong_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;
	#include <envmap_fragment>
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,Vj=`#define STANDARD
varying vec3 vViewPosition;
#ifdef USE_TRANSMISSION
	varying vec3 vWorldPosition;
#endif
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
#ifdef USE_TRANSMISSION
	vWorldPosition = worldPosition.xyz;
#endif
}`,Hj=`#define STANDARD
#ifdef PHYSICAL
	#define IOR
	#define USE_SPECULAR
#endif
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float roughness;
uniform float metalness;
uniform float opacity;
#ifdef IOR
	uniform float ior;
#endif
#ifdef USE_SPECULAR
	uniform float specularIntensity;
	uniform vec3 specularColor;
	#ifdef USE_SPECULAR_COLORMAP
		uniform sampler2D specularColorMap;
	#endif
	#ifdef USE_SPECULAR_INTENSITYMAP
		uniform sampler2D specularIntensityMap;
	#endif
#endif
#ifdef USE_CLEARCOAT
	uniform float clearcoat;
	uniform float clearcoatRoughness;
#endif
#ifdef USE_DISPERSION
	uniform float dispersion;
#endif
#ifdef USE_IRIDESCENCE
	uniform float iridescence;
	uniform float iridescenceIOR;
	uniform float iridescenceThicknessMinimum;
	uniform float iridescenceThicknessMaximum;
#endif
#ifdef USE_SHEEN
	uniform vec3 sheenColor;
	uniform float sheenRoughness;
	#ifdef USE_SHEEN_COLORMAP
		uniform sampler2D sheenColorMap;
	#endif
	#ifdef USE_SHEEN_ROUGHNESSMAP
		uniform sampler2D sheenRoughnessMap;
	#endif
#endif
#ifdef USE_ANISOTROPY
	uniform vec2 anisotropyVector;
	#ifdef USE_ANISOTROPYMAP
		uniform sampler2D anisotropyMap;
	#endif
#endif
varying vec3 vViewPosition;
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <iridescence_fragment>
#include <cube_uv_reflection_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_physical_pars_fragment>
#include <fog_pars_fragment>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_physical_pars_fragment>
#include <transmission_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <clearcoat_pars_fragment>
#include <iridescence_pars_fragment>
#include <roughnessmap_pars_fragment>
#include <metalnessmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <roughnessmap_fragment>
	#include <metalnessmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <clearcoat_normal_fragment_begin>
	#include <clearcoat_normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_physical_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 totalDiffuse = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse;
	vec3 totalSpecular = reflectedLight.directSpecular + reflectedLight.indirectSpecular;
	#include <transmission_fragment>
	vec3 outgoingLight = totalDiffuse + totalSpecular + totalEmissiveRadiance;
	#ifdef USE_SHEEN
 
		outgoingLight = outgoingLight + sheenSpecularDirect + sheenSpecularIndirect;
 
 	#endif
	#ifdef USE_CLEARCOAT
		float dotNVcc = saturate( dot( geometryClearcoatNormal, geometryViewDir ) );
		vec3 Fcc = F_Schlick( material.clearcoatF0, material.clearcoatF90, dotNVcc );
		outgoingLight = outgoingLight * ( 1.0 - material.clearcoat * Fcc ) + ( clearcoatSpecularDirect + clearcoatSpecularIndirect ) * material.clearcoat;
	#endif
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,Gj=`#define TOON
varying vec3 vViewPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,jj=`#define TOON
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float opacity;
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <gradientmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_toon_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_toon_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,Wj=`uniform float size;
uniform float scale;
#include <common>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
#ifdef USE_POINTS_UV
	varying vec2 vUv;
	uniform mat3 uvTransform;
#endif
void main() {
	#ifdef USE_POINTS_UV
		vUv = ( uvTransform * vec3( uv, 1 ) ).xy;
	#endif
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <project_vertex>
	gl_PointSize = size;
	#ifdef USE_SIZEATTENUATION
		bool isPerspective = isPerspectiveMatrix( projectionMatrix );
		if ( isPerspective ) gl_PointSize *= ( scale / - mvPosition.z );
	#endif
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <worldpos_vertex>
	#include <fog_vertex>
}`,qj=`uniform vec3 diffuse;
uniform float opacity;
#include <common>
#include <color_pars_fragment>
#include <map_particle_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	vec3 outgoingLight = vec3( 0.0 );
	#include <logdepthbuf_fragment>
	#include <map_particle_fragment>
	#include <color_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
}`,Xj=`#include <common>
#include <batching_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <shadowmap_pars_vertex>
void main() {
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphinstance_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,Yj=`uniform vec3 color;
uniform float opacity;
#include <common>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <logdepthbuf_pars_fragment>
#include <shadowmap_pars_fragment>
#include <shadowmask_pars_fragment>
void main() {
	#include <logdepthbuf_fragment>
	gl_FragColor = vec4( color, opacity * ( 1.0 - getShadowMask() ) );
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
}`,Jj=`uniform float rotation;
uniform vec2 center;
#include <common>
#include <uv_pars_vertex>
#include <fog_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	vec4 mvPosition = modelViewMatrix[ 3 ];
	vec2 scale = vec2( length( modelMatrix[ 0 ].xyz ), length( modelMatrix[ 1 ].xyz ) );
	#ifndef USE_SIZEATTENUATION
		bool isPerspective = isPerspectiveMatrix( projectionMatrix );
		if ( isPerspective ) scale *= - mvPosition.z;
	#endif
	vec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale;
	vec2 rotatedPosition;
	rotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;
	rotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;
	mvPosition.xy += rotatedPosition;
	gl_Position = projectionMatrix * mvPosition;
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
}`,Kj=`uniform vec3 diffuse;
uniform float opacity;
#include <common>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	vec3 outgoingLight = vec3( 0.0 );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
}`,Gn={alphahash_fragment:y2,alphahash_pars_fragment:_2,alphamap_fragment:x2,alphamap_pars_fragment:b2,alphatest_fragment:A2,alphatest_pars_fragment:S2,aomap_fragment:E2,aomap_pars_fragment:T2,batching_pars_vertex:M2,batching_vertex:w2,begin_vertex:C2,beginnormal_vertex:R2,bsdfs:I2,iridescence_fragment:D2,bumpmap_pars_fragment:N2,clipping_planes_fragment:P2,clipping_planes_pars_fragment:B2,clipping_planes_pars_vertex:L2,clipping_planes_vertex:O2,color_fragment:U2,color_pars_fragment:F2,color_pars_vertex:k2,color_vertex:z2,common:V2,cube_uv_reflection_fragment:H2,defaultnormal_vertex:G2,displacementmap_pars_vertex:j2,displacementmap_vertex:W2,emissivemap_fragment:q2,emissivemap_pars_fragment:X2,colorspace_fragment:Y2,colorspace_pars_fragment:J2,envmap_fragment:K2,envmap_common_pars_fragment:Q2,envmap_pars_fragment:Z2,envmap_pars_vertex:$2,envmap_physical_pars_fragment:u7,envmap_vertex:e7,fog_vertex:t7,fog_pars_vertex:n7,fog_fragment:i7,fog_pars_fragment:r7,gradientmap_pars_fragment:s7,lightmap_pars_fragment:a7,lights_lambert_fragment:o7,lights_lambert_pars_fragment:l7,lights_pars_begin:c7,lights_toon_fragment:h7,lights_toon_pars_fragment:f7,lights_phong_fragment:d7,lights_phong_pars_fragment:p7,lights_physical_fragment:m7,lights_physical_pars_fragment:g7,lights_fragment_begin:v7,lights_fragment_maps:y7,lights_fragment_end:_7,logdepthbuf_fragment:x7,logdepthbuf_pars_fragment:b7,logdepthbuf_pars_vertex:A7,logdepthbuf_vertex:S7,map_fragment:E7,map_pars_fragment:T7,map_particle_fragment:M7,map_particle_pars_fragment:w7,metalnessmap_fragment:C7,metalnessmap_pars_fragment:R7,morphinstance_vertex:I7,morphcolor_vertex:D7,morphnormal_vertex:N7,morphtarget_pars_vertex:P7,morphtarget_vertex:B7,normal_fragment_begin:L7,normal_fragment_maps:O7,normal_pars_fragment:U7,normal_pars_vertex:F7,normal_vertex:k7,normalmap_pars_fragment:z7,clearcoat_normal_fragment_begin:V7,clearcoat_normal_fragment_maps:H7,clearcoat_pars_fragment:G7,iridescence_pars_fragment:j7,opaque_fragment:W7,packing:q7,premultiplied_alpha_fragment:X7,project_vertex:Y7,dithering_fragment:J7,dithering_pars_fragment:K7,roughnessmap_fragment:Q7,roughnessmap_pars_fragment:Z7,shadowmap_pars_fragment:$7,shadowmap_pars_vertex:ej,shadowmap_vertex:tj,shadowmask_pars_fragment:nj,skinbase_vertex:ij,skinning_pars_vertex:rj,skinning_vertex:sj,skinnormal_vertex:aj,specularmap_fragment:oj,specularmap_pars_fragment:lj,tonemapping_fragment:cj,tonemapping_pars_fragment:uj,transmission_fragment:hj,transmission_pars_fragment:fj,uv_pars_fragment:dj,uv_pars_vertex:pj,uv_vertex:mj,worldpos_vertex:gj,background_vert:vj,background_frag:yj,backgroundCube_vert:_j,backgroundCube_frag:xj,cube_vert:bj,cube_frag:Aj,depth_vert:Sj,depth_frag:Ej,distance_vert:Tj,distance_frag:Mj,equirect_vert:wj,equirect_frag:Cj,linedashed_vert:Rj,linedashed_frag:Ij,meshbasic_vert:Dj,meshbasic_frag:Nj,meshlambert_vert:Pj,meshlambert_frag:Bj,meshmatcap_vert:Lj,meshmatcap_frag:Oj,meshnormal_vert:Uj,meshnormal_frag:Fj,meshphong_vert:kj,meshphong_frag:zj,meshphysical_vert:Vj,meshphysical_frag:Hj,meshtoon_vert:Gj,meshtoon_frag:jj,points_vert:Wj,points_frag:qj,shadow_vert:Xj,shadow_frag:Yj,sprite_vert:Jj,sprite_frag:Kj},Wt={common:{diffuse:{value:new Gt(16777215)},opacity:{value:1},map:{value:null},mapTransform:{value:new Un},alphaMap:{value:null},alphaMapTransform:{value:new Un},alphaTest:{value:0}},specularmap:{specularMap:{value:null},specularMapTransform:{value:new Un}},envmap:{envMap:{value:null},envMapRotation:{value:new Un},flipEnvMap:{value:-1},reflectivity:{value:1},ior:{value:1.5},refractionRatio:{value:.98},dfgLUT:{value:null}},aomap:{aoMap:{value:null},aoMapIntensity:{value:1},aoMapTransform:{value:new Un}},lightmap:{lightMap:{value:null},lightMapIntensity:{value:1},lightMapTransform:{value:new Un}},bumpmap:{bumpMap:{value:null},bumpMapTransform:{value:new Un},bumpScale:{value:1}},normalmap:{normalMap:{value:null},normalMapTransform:{value:new Un},normalScale:{value:new $e(1,1)}},displacementmap:{displacementMap:{value:null},displacementMapTransform:{value:new Un},displacementScale:{value:1},displacementBias:{value:0}},emissivemap:{emissiveMap:{value:null},emissiveMapTransform:{value:new Un}},metalnessmap:{metalnessMap:{value:null},metalnessMapTransform:{value:new Un}},roughnessmap:{roughnessMap:{value:null},roughnessMapTransform:{value:new Un}},gradientmap:{gradientMap:{value:null}},fog:{fogDensity:{value:25e-5},fogNear:{value:1},fogFar:{value:2e3},fogColor:{value:new Gt(16777215)}},lights:{ambientLightColor:{value:[]},lightProbe:{value:[]},directionalLights:{value:[],properties:{direction:{},color:{}}},directionalLightShadows:{value:[],properties:{shadowIntensity:1,shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},directionalShadowMap:{value:[]},directionalShadowMatrix:{value:[]},spotLights:{value:[],properties:{color:{},position:{},direction:{},distance:{},coneCos:{},penumbraCos:{},decay:{}}},spotLightShadows:{value:[],properties:{shadowIntensity:1,shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},spotLightMap:{value:[]},spotShadowMap:{value:[]},spotLightMatrix:{value:[]},pointLights:{value:[],properties:{color:{},position:{},decay:{},distance:{}}},pointLightShadows:{value:[],properties:{shadowIntensity:1,shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{},shadowCameraNear:{},shadowCameraFar:{}}},pointShadowMap:{value:[]},pointShadowMatrix:{value:[]},hemisphereLights:{value:[],properties:{direction:{},skyColor:{},groundColor:{}}},rectAreaLights:{value:[],properties:{color:{},position:{},width:{},height:{}}},ltc_1:{value:null},ltc_2:{value:null}},points:{diffuse:{value:new Gt(16777215)},opacity:{value:1},size:{value:1},scale:{value:1},map:{value:null},alphaMap:{value:null},alphaMapTransform:{value:new Un},alphaTest:{value:0},uvTransform:{value:new Un}},sprite:{diffuse:{value:new Gt(16777215)},opacity:{value:1},center:{value:new $e(.5,.5)},rotation:{value:0},map:{value:null},mapTransform:{value:new Un},alphaMap:{value:null},alphaMapTransform:{value:new Un},alphaTest:{value:0}}},Ul={basic:{uniforms:Ta([Wt.common,Wt.specularmap,Wt.envmap,Wt.aomap,Wt.lightmap,Wt.fog]),vertexShader:Gn.meshbasic_vert,fragmentShader:Gn.meshbasic_frag},lambert:{uniforms:Ta([Wt.common,Wt.specularmap,Wt.envmap,Wt.aomap,Wt.lightmap,Wt.emissivemap,Wt.bumpmap,Wt.normalmap,Wt.displacementmap,Wt.fog,Wt.lights,{emissive:{value:new Gt(0)}}]),vertexShader:Gn.meshlambert_vert,fragmentShader:Gn.meshlambert_frag},phong:{uniforms:Ta([Wt.common,Wt.specularmap,Wt.envmap,Wt.aomap,Wt.lightmap,Wt.emissivemap,Wt.bumpmap,Wt.normalmap,Wt.displacementmap,Wt.fog,Wt.lights,{emissive:{value:new Gt(0)},specular:{value:new Gt(1118481)},shininess:{value:30}}]),vertexShader:Gn.meshphong_vert,fragmentShader:Gn.meshphong_frag},standard:{uniforms:Ta([Wt.common,Wt.envmap,Wt.aomap,Wt.lightmap,Wt.emissivemap,Wt.bumpmap,Wt.normalmap,Wt.displacementmap,Wt.roughnessmap,Wt.metalnessmap,Wt.fog,Wt.lights,{emissive:{value:new Gt(0)},roughness:{value:1},metalness:{value:0},envMapIntensity:{value:1}}]),vertexShader:Gn.meshphysical_vert,fragmentShader:Gn.meshphysical_frag},toon:{uniforms:Ta([Wt.common,Wt.aomap,Wt.lightmap,Wt.emissivemap,Wt.bumpmap,Wt.normalmap,Wt.displacementmap,Wt.gradientmap,Wt.fog,Wt.lights,{emissive:{value:new Gt(0)}}]),vertexShader:Gn.meshtoon_vert,fragmentShader:Gn.meshtoon_frag},matcap:{uniforms:Ta([Wt.common,Wt.bumpmap,Wt.normalmap,Wt.displacementmap,Wt.fog,{matcap:{value:null}}]),vertexShader:Gn.meshmatcap_vert,fragmentShader:Gn.meshmatcap_frag},points:{uniforms:Ta([Wt.points,Wt.fog]),vertexShader:Gn.points_vert,fragmentShader:Gn.points_frag},dashed:{uniforms:Ta([Wt.common,Wt.fog,{scale:{value:1},dashSize:{value:1},totalSize:{value:2}}]),vertexShader:Gn.linedashed_vert,fragmentShader:Gn.linedashed_frag},depth:{uniforms:Ta([Wt.common,Wt.displacementmap]),vertexShader:Gn.depth_vert,fragmentShader:Gn.depth_frag},normal:{uniforms:Ta([Wt.common,Wt.bumpmap,Wt.normalmap,Wt.displacementmap,{opacity:{value:1}}]),vertexShader:Gn.meshnormal_vert,fragmentShader:Gn.meshnormal_frag},sprite:{uniforms:Ta([Wt.sprite,Wt.fog]),vertexShader:Gn.sprite_vert,fragmentShader:Gn.sprite_frag},background:{uniforms:{uvTransform:{value:new Un},t2D:{value:null},backgroundIntensity:{value:1}},vertexShader:Gn.background_vert,fragmentShader:Gn.background_frag},backgroundCube:{uniforms:{envMap:{value:null},flipEnvMap:{value:-1},backgroundBlurriness:{value:0},backgroundIntensity:{value:1},backgroundRotation:{value:new Un}},vertexShader:Gn.backgroundCube_vert,fragmentShader:Gn.backgroundCube_frag},cube:{uniforms:{tCube:{value:null},tFlip:{value:-1},opacity:{value:1}},vertexShader:Gn.cube_vert,fragmentShader:Gn.cube_frag},equirect:{uniforms:{tEquirect:{value:null}},vertexShader:Gn.equirect_vert,fragmentShader:Gn.equirect_frag},distance:{uniforms:Ta([Wt.common,Wt.displacementmap,{referencePosition:{value:new ie},nearDistance:{value:1},farDistance:{value:1e3}}]),vertexShader:Gn.distance_vert,fragmentShader:Gn.distance_frag},shadow:{uniforms:Ta([Wt.lights,Wt.fog,{color:{value:new Gt(0)},opacity:{value:1}}]),vertexShader:Gn.shadow_vert,fragmentShader:Gn.shadow_frag}};Ul.physical={uniforms:Ta([Ul.standard.uniforms,{clearcoat:{value:0},clearcoatMap:{value:null},clearcoatMapTransform:{value:new Un},clearcoatNormalMap:{value:null},clearcoatNormalMapTransform:{value:new Un},clearcoatNormalScale:{value:new $e(1,1)},clearcoatRoughness:{value:0},clearcoatRoughnessMap:{value:null},clearcoatRoughnessMapTransform:{value:new Un},dispersion:{value:0},iridescence:{value:0},iridescenceMap:{value:null},iridescenceMapTransform:{value:new Un},iridescenceIOR:{value:1.3},iridescenceThicknessMinimum:{value:100},iridescenceThicknessMaximum:{value:400},iridescenceThicknessMap:{value:null},iridescenceThicknessMapTransform:{value:new Un},sheen:{value:0},sheenColor:{value:new Gt(0)},sheenColorMap:{value:null},sheenColorMapTransform:{value:new Un},sheenRoughness:{value:1},sheenRoughnessMap:{value:null},sheenRoughnessMapTransform:{value:new Un},transmission:{value:0},transmissionMap:{value:null},transmissionMapTransform:{value:new Un},transmissionSamplerSize:{value:new $e},transmissionSamplerMap:{value:null},thickness:{value:0},thicknessMap:{value:null},thicknessMapTransform:{value:new Un},attenuationDistance:{value:0},attenuationColor:{value:new Gt(0)},specularColor:{value:new Gt(1,1,1)},specularColorMap:{value:null},specularColorMapTransform:{value:new Un},specularIntensity:{value:1},specularIntensityMap:{value:null},specularIntensityMapTransform:{value:new Un},anisotropyVector:{value:new $e},anisotropyMap:{value:null},anisotropyMapTransform:{value:new Un}}]),vertexShader:Gn.meshphysical_vert,fragmentShader:Gn.meshphysical_frag};const Xx={r:0,b:0,g:0},Ad=new Eo,Qj=new vn;function Zj(i,e,t,n,r,s,o){const u=new Gt(0);let f=s===!0?0:1,p,g,v=null,_=0,x=null;function E(L){let F=L.isScene===!0?L.background:null;return F&&F.isTexture&&(F=(L.backgroundBlurriness>0?t:e).get(F)),F}function C(L){let F=!1;const G=E(L);G===null?T(u,f):G&&G.isColor&&(T(G,1),F=!0);const k=i.xr.getEnvironmentBlendMode();k==="additive"?n.buffers.color.setClear(0,0,0,1,o):k==="alpha-blend"&&n.buffers.color.setClear(0,0,0,0,o),(i.autoClear||F)&&(n.buffers.depth.setTest(!0),n.buffers.depth.setMask(!0),n.buffers.color.setMask(!0),i.clear(i.autoClearColor,i.autoClearDepth,i.autoClearStencil))}function w(L,F){const G=E(F);G&&(G.isCubeTexture||G.mapping===Mg)?(g===void 0&&(g=new rr(new fp(1,1,1),new Gs({name:"BackgroundCubeMaterial",uniforms:pg(Ul.backgroundCube.uniforms),vertexShader:Ul.backgroundCube.vertexShader,fragmentShader:Ul.backgroundCube.fragmentShader,side:Ca,depthTest:!1,depthWrite:!1,fog:!1,allowOverride:!1})),g.geometry.deleteAttribute("normal"),g.geometry.deleteAttribute("uv"),g.onBeforeRender=function(k,O,D){this.matrixWorld.copyPosition(D.matrixWorld)},Object.defineProperty(g.material,"envMap",{get:function(){return this.uniforms.envMap.value}}),r.update(g)),Ad.copy(F.backgroundRotation),Ad.x*=-1,Ad.y*=-1,Ad.z*=-1,G.isCubeTexture&&G.isRenderTargetTexture===!1&&(Ad.y*=-1,Ad.z*=-1),g.material.uniforms.envMap.value=G,g.material.uniforms.flipEnvMap.value=G.isCubeTexture&&G.isRenderTargetTexture===!1?-1:1,g.material.uniforms.backgroundBlurriness.value=F.backgroundBlurriness,g.material.uniforms.backgroundIntensity.value=F.backgroundIntensity,g.material.uniforms.backgroundRotation.value.setFromMatrix4(Qj.makeRotationFromEuler(Ad)),g.material.toneMapped=oi.getTransfer(G.colorSpace)!==wi,(v!==G||_!==G.version||x!==i.toneMapping)&&(g.material.needsUpdate=!0,v=G,_=G.version,x=i.toneMapping),g.layers.enableAll(),L.unshift(g,g.geometry,g.material,0,0,null)):G&&G.isTexture&&(p===void 0&&(p=new rr(new Xu(2,2),new Gs({name:"BackgroundMaterial",uniforms:pg(Ul.background.uniforms),vertexShader:Ul.background.vertexShader,fragmentShader:Ul.background.fragmentShader,side:Gc,depthTest:!1,depthWrite:!1,fog:!1,allowOverride:!1})),p.geometry.deleteAttribute("normal"),Object.defineProperty(p.material,"map",{get:function(){return this.uniforms.t2D.value}}),r.update(p)),p.material.uniforms.t2D.value=G,p.material.uniforms.backgroundIntensity.value=F.backgroundIntensity,p.material.toneMapped=oi.getTransfer(G.colorSpace)!==wi,G.matrixAutoUpdate===!0&&G.updateMatrix(),p.material.uniforms.uvTransform.value.copy(G.matrix),(v!==G||_!==G.version||x!==i.toneMapping)&&(p.material.needsUpdate=!0,v=G,_=G.version,x=i.toneMapping),p.layers.enableAll(),L.unshift(p,p.geometry,p.material,0,0,null))}function T(L,F){L.getRGB(Xx,nL(i)),n.buffers.color.setClear(Xx.r,Xx.g,Xx.b,F,o)}function N(){g!==void 0&&(g.geometry.dispose(),g.material.dispose(),g=void 0),p!==void 0&&(p.geometry.dispose(),p.material.dispose(),p=void 0)}return{getClearColor:function(){return u},setClearColor:function(L,F=1){u.set(L),f=F,T(u,f)},getClearAlpha:function(){return f},setClearAlpha:function(L){f=L,T(u,f)},render:C,addToRenderList:w,dispose:N}}function $j(i,e){const t=i.getParameter(i.MAX_VERTEX_ATTRIBS),n={},r=_(null);let s=r,o=!1;function u(P,z,Y,j,ce){let fe=!1;const te=v(j,Y,z);s!==te&&(s=te,p(s.object)),fe=x(P,j,Y,ce),fe&&E(P,j,Y,ce),ce!==null&&e.update(ce,i.ELEMENT_ARRAY_BUFFER),(fe||o)&&(o=!1,F(P,z,Y,j),ce!==null&&i.bindBuffer(i.ELEMENT_ARRAY_BUFFER,e.get(ce).buffer))}function f(){return i.createVertexArray()}function p(P){return i.bindVertexArray(P)}function g(P){return i.deleteVertexArray(P)}function v(P,z,Y){const j=Y.wireframe===!0;let ce=n[P.id];ce===void 0&&(ce={},n[P.id]=ce);let fe=ce[z.id];fe===void 0&&(fe={},ce[z.id]=fe);let te=fe[j];return te===void 0&&(te=_(f()),fe[j]=te),te}function _(P){const z=[],Y=[],j=[];for(let ce=0;ce<t;ce++)z[ce]=0,Y[ce]=0,j[ce]=0;return{geometry:null,program:null,wireframe:!1,newAttributes:z,enabledAttributes:Y,attributeDivisors:j,object:P,attributes:{},index:null}}function x(P,z,Y,j){const ce=s.attributes,fe=z.attributes;let te=0;const se=Y.getAttributes();for(const Ae in se)if(se[Ae].location>=0){const Re=ce[Ae];let $=fe[Ae];if($===void 0&&(Ae==="instanceMatrix"&&P.instanceMatrix&&($=P.instanceMatrix),Ae==="instanceColor"&&P.instanceColor&&($=P.instanceColor)),Re===void 0||Re.attribute!==$||$&&Re.data!==$.data)return!0;te++}return s.attributesNum!==te||s.index!==j}function E(P,z,Y,j){const ce={},fe=z.attributes;let te=0;const se=Y.getAttributes();for(const Ae in se)if(se[Ae].location>=0){let Re=fe[Ae];Re===void 0&&(Ae==="instanceMatrix"&&P.instanceMatrix&&(Re=P.instanceMatrix),Ae==="instanceColor"&&P.instanceColor&&(Re=P.instanceColor));const $={};$.attribute=Re,Re&&Re.data&&($.data=Re.data),ce[Ae]=$,te++}s.attributes=ce,s.attributesNum=te,s.index=j}function C(){const P=s.newAttributes;for(let z=0,Y=P.length;z<Y;z++)P[z]=0}function w(P){T(P,0)}function T(P,z){const Y=s.newAttributes,j=s.enabledAttributes,ce=s.attributeDivisors;Y[P]=1,j[P]===0&&(i.enableVertexAttribArray(P),j[P]=1),ce[P]!==z&&(i.vertexAttribDivisor(P,z),ce[P]=z)}function N(){const P=s.newAttributes,z=s.enabledAttributes;for(let Y=0,j=z.length;Y<j;Y++)z[Y]!==P[Y]&&(i.disableVertexAttribArray(Y),z[Y]=0)}function L(P,z,Y,j,ce,fe,te){te===!0?i.vertexAttribIPointer(P,z,Y,ce,fe):i.vertexAttribPointer(P,z,Y,j,ce,fe)}function F(P,z,Y,j){C();const ce=j.attributes,fe=Y.getAttributes(),te=z.defaultAttributeValues;for(const se in fe){const Ae=fe[se];if(Ae.location>=0){let Pe=ce[se];if(Pe===void 0&&(se==="instanceMatrix"&&P.instanceMatrix&&(Pe=P.instanceMatrix),se==="instanceColor"&&P.instanceColor&&(Pe=P.instanceColor)),Pe!==void 0){const Re=Pe.normalized,$=Pe.itemSize,ae=e.get(Pe);if(ae===void 0)continue;const Se=ae.buffer,ke=ae.type,dt=ae.bytesPerElement,ve=ke===i.INT||ke===i.UNSIGNED_INT||Pe.gpuType===yy;if(Pe.isInterleavedBufferAttribute){const Le=Pe.data,lt=Le.stride,_t=Pe.offset;if(Le.isInstancedInterleavedBuffer){for(let Dt=0;Dt<Ae.locationSize;Dt++)T(Ae.location+Dt,Le.meshPerAttribute);P.isInstancedMesh!==!0&&j._maxInstanceCount===void 0&&(j._maxInstanceCount=Le.meshPerAttribute*Le.count)}else for(let Dt=0;Dt<Ae.locationSize;Dt++)w(Ae.location+Dt);i.bindBuffer(i.ARRAY_BUFFER,Se);for(let Dt=0;Dt<Ae.locationSize;Dt++)L(Ae.location+Dt,$/Ae.locationSize,ke,Re,lt*dt,(_t+$/Ae.locationSize*Dt)*dt,ve)}else{if(Pe.isInstancedBufferAttribute){for(let Le=0;Le<Ae.locationSize;Le++)T(Ae.location+Le,Pe.meshPerAttribute);P.isInstancedMesh!==!0&&j._maxInstanceCount===void 0&&(j._maxInstanceCount=Pe.meshPerAttribute*Pe.count)}else for(let Le=0;Le<Ae.locationSize;Le++)w(Ae.location+Le);i.bindBuffer(i.ARRAY_BUFFER,Se);for(let Le=0;Le<Ae.locationSize;Le++)L(Ae.location+Le,$/Ae.locationSize,ke,Re,$*dt,$/Ae.locationSize*Le*dt,ve)}}else if(te!==void 0){const Re=te[se];if(Re!==void 0)switch(Re.length){case 2:i.vertexAttrib2fv(Ae.location,Re);break;case 3:i.vertexAttrib3fv(Ae.location,Re);break;case 4:i.vertexAttrib4fv(Ae.location,Re);break;default:i.vertexAttrib1fv(Ae.location,Re)}}}}N()}function G(){D();for(const P in n){const z=n[P];for(const Y in z){const j=z[Y];for(const ce in j)g(j[ce].object),delete j[ce];delete z[Y]}delete n[P]}}function k(P){if(n[P.id]===void 0)return;const z=n[P.id];for(const Y in z){const j=z[Y];for(const ce in j)g(j[ce].object),delete j[ce];delete z[Y]}delete n[P.id]}function O(P){for(const z in n){const Y=n[z];if(Y[P.id]===void 0)continue;const j=Y[P.id];for(const ce in j)g(j[ce].object),delete j[ce];delete Y[P.id]}}function D(){R(),o=!0,s!==r&&(s=r,p(s.object))}function R(){r.geometry=null,r.program=null,r.wireframe=!1}return{setup:u,reset:D,resetDefaultState:R,dispose:G,releaseStatesOfGeometry:k,releaseStatesOfProgram:O,initAttributes:C,enableAttribute:w,disableUnusedAttributes:N}}function eW(i,e,t){let n;function r(p){n=p}function s(p,g){i.drawArrays(n,p,g),t.update(g,n,1)}function o(p,g,v){v!==0&&(i.drawArraysInstanced(n,p,g,v),t.update(g,n,v))}function u(p,g,v){if(v===0)return;e.get("WEBGL_multi_draw").multiDrawArraysWEBGL(n,p,0,g,0,v);let x=0;for(let E=0;E<v;E++)x+=g[E];t.update(x,n,1)}function f(p,g,v,_){if(v===0)return;const x=e.get("WEBGL_multi_draw");if(x===null)for(let E=0;E<p.length;E++)o(p[E],g[E],_[E]);else{x.multiDrawArraysInstancedWEBGL(n,p,0,g,0,_,0,v);let E=0;for(let C=0;C<v;C++)E+=g[C]*_[C];t.update(E,n,1)}}this.setMode=r,this.render=s,this.renderInstances=o,this.renderMultiDraw=u,this.renderMultiDrawInstances=f}function tW(i,e,t,n){let r;function s(){if(r!==void 0)return r;if(e.has("EXT_texture_filter_anisotropic")===!0){const O=e.get("EXT_texture_filter_anisotropic");r=i.getParameter(O.MAX_TEXTURE_MAX_ANISOTROPY_EXT)}else r=0;return r}function o(O){return!(O!==jr&&n.convert(O)!==i.getParameter(i.IMPLEMENTATION_COLOR_READ_FORMAT))}function u(O){const D=O===Er&&(e.has("EXT_color_buffer_half_float")||e.has("EXT_color_buffer_float"));return!(O!==vs&&n.convert(O)!==i.getParameter(i.IMPLEMENTATION_COLOR_READ_TYPE)&&O!==ir&&!D)}function f(O){if(O==="highp"){if(i.getShaderPrecisionFormat(i.VERTEX_SHADER,i.HIGH_FLOAT).precision>0&&i.getShaderPrecisionFormat(i.FRAGMENT_SHADER,i.HIGH_FLOAT).precision>0)return"highp";O="mediump"}return O==="mediump"&&i.getShaderPrecisionFormat(i.VERTEX_SHADER,i.MEDIUM_FLOAT).precision>0&&i.getShaderPrecisionFormat(i.FRAGMENT_SHADER,i.MEDIUM_FLOAT).precision>0?"mediump":"lowp"}let p=t.precision!==void 0?t.precision:"highp";const g=f(p);g!==p&&(Ht("WebGLRenderer:",p,"not supported, using",g,"instead."),p=g);const v=t.logarithmicDepthBuffer===!0,_=t.reversedDepthBuffer===!0&&e.has("EXT_clip_control"),x=i.getParameter(i.MAX_TEXTURE_IMAGE_UNITS),E=i.getParameter(i.MAX_VERTEX_TEXTURE_IMAGE_UNITS),C=i.getParameter(i.MAX_TEXTURE_SIZE),w=i.getParameter(i.MAX_CUBE_MAP_TEXTURE_SIZE),T=i.getParameter(i.MAX_VERTEX_ATTRIBS),N=i.getParameter(i.MAX_VERTEX_UNIFORM_VECTORS),L=i.getParameter(i.MAX_VARYING_VECTORS),F=i.getParameter(i.MAX_FRAGMENT_UNIFORM_VECTORS),G=i.getParameter(i.MAX_SAMPLES),k=i.getParameter(i.SAMPLES);return{isWebGL2:!0,getMaxAnisotropy:s,getMaxPrecision:f,textureFormatReadable:o,textureTypeReadable:u,precision:p,logarithmicDepthBuffer:v,reversedDepthBuffer:_,maxTextures:x,maxVertexTextures:E,maxTextureSize:C,maxCubemapSize:w,maxAttributes:T,maxVertexUniforms:N,maxVaryings:L,maxFragmentUniforms:F,maxSamples:G,samples:k}}function nW(i){const e=this;let t=null,n=0,r=!1,s=!1;const o=new Du,u=new Un,f={value:null,needsUpdate:!1};this.uniform=f,this.numPlanes=0,this.numIntersection=0,this.init=function(v,_){const x=v.length!==0||_||n!==0||r;return r=_,n=v.length,x},this.beginShadows=function(){s=!0,g(null)},this.endShadows=function(){s=!1},this.setGlobalState=function(v,_){t=g(v,_,0)},this.setState=function(v,_,x){const E=v.clippingPlanes,C=v.clipIntersection,w=v.clipShadows,T=i.get(v);if(!r||E===null||E.length===0||s&&!w)s?g(null):p();else{const N=s?0:n,L=N*4;let F=T.clippingState||null;f.value=F,F=g(E,_,L,x);for(let G=0;G!==L;++G)F[G]=t[G];T.clippingState=F,this.numIntersection=C?this.numPlanes:0,this.numPlanes+=N}};function p(){f.value!==t&&(f.value=t,f.needsUpdate=n>0),e.numPlanes=n,e.numIntersection=0}function g(v,_,x,E){const C=v!==null?v.length:0;let w=null;if(C!==0){if(w=f.value,E!==!0||w===null){const T=x+C*4,N=_.matrixWorldInverse;u.getNormalMatrix(N),(w===null||w.length<T)&&(w=new Float32Array(T));for(let L=0,F=x;L!==C;++L,F+=4)o.copy(v[L]).applyMatrix4(N,u),o.normal.toArray(w,F),w[F+3]=o.constant}f.value=w,f.needsUpdate=!0}return e.numPlanes=C,e.numIntersection=0,w}}function iW(i){let e=new WeakMap;function t(o,u){return u===rg?o.mapping=ql:u===Wv&&(o.mapping=yf),o}function n(o){if(o&&o.isTexture){const u=o.mapping;if(u===rg||u===Wv)if(e.has(o)){const f=e.get(o).texture;return t(f,o.mapping)}else{const f=o.image;if(f&&f.height>0){const p=new _S(f.height);return p.fromEquirectangularTexture(i,o),e.set(o,p),o.addEventListener("dispose",r),t(p.texture,o.mapping)}else return null}}return o}function r(o){const u=o.target;u.removeEventListener("dispose",r);const f=e.get(u);f!==void 0&&(e.delete(u),f.dispose())}function s(){e=new WeakMap}return{get:n,dispose:s}}const tf=4,BD=[.125,.215,.35,.446,.526,.582],Rd=20,rW=256,ov=new Ao,LD=new Gt;let T1=null,M1=0,w1=0,C1=!1;const sW=new ie;class UT{constructor(e){this._renderer=e,this._pingPongRenderTarget=null,this._lodMax=0,this._cubeSize=0,this._sizeLods=[],this._sigmas=[],this._lodMeshes=[],this._backgroundBox=null,this._cubemapMaterial=null,this._equirectMaterial=null,this._blurMaterial=null,this._ggxMaterial=null}fromScene(e,t=0,n=.1,r=100,s={}){const{size:o=256,position:u=sW}=s;T1=this._renderer.getRenderTarget(),M1=this._renderer.getActiveCubeFace(),w1=this._renderer.getActiveMipmapLevel(),C1=this._renderer.xr.enabled,this._renderer.xr.enabled=!1,this._setSize(o);const f=this._allocateTargets();return f.depthBuffer=!0,this._sceneToCubeUV(e,n,r,f,u),t>0&&this._blur(f,0,0,t),this._applyPMREM(f),this._cleanup(f),f}fromEquirectangular(e,t=null){return this._fromTexture(e,t)}fromCubemap(e,t=null){return this._fromTexture(e,t)}compileCubemapShader(){this._cubemapMaterial===null&&(this._cubemapMaterial=FD(),this._compileMaterial(this._cubemapMaterial))}compileEquirectangularShader(){this._equirectMaterial===null&&(this._equirectMaterial=UD(),this._compileMaterial(this._equirectMaterial))}dispose(){this._dispose(),this._cubemapMaterial!==null&&this._cubemapMaterial.dispose(),this._equirectMaterial!==null&&this._equirectMaterial.dispose(),this._backgroundBox!==null&&(this._backgroundBox.geometry.dispose(),this._backgroundBox.material.dispose())}_setSize(e){this._lodMax=Math.floor(Math.log2(e)),this._cubeSize=Math.pow(2,this._lodMax)}_dispose(){this._blurMaterial!==null&&this._blurMaterial.dispose(),this._ggxMaterial!==null&&this._ggxMaterial.dispose(),this._pingPongRenderTarget!==null&&this._pingPongRenderTarget.dispose();for(let e=0;e<this._lodMeshes.length;e++)this._lodMeshes[e].geometry.dispose()}_cleanup(e){this._renderer.setRenderTarget(T1,M1,w1),this._renderer.xr.enabled=C1,e.scissorTest=!1,Im(e,0,0,e.width,e.height)}_fromTexture(e,t){e.mapping===ql||e.mapping===yf?this._setSize(e.image.length===0?16:e.image[0].width||e.image[0].image.width):this._setSize(e.image.width/4),T1=this._renderer.getRenderTarget(),M1=this._renderer.getActiveCubeFace(),w1=this._renderer.getActiveMipmapLevel(),C1=this._renderer.xr.enabled,this._renderer.xr.enabled=!1;const n=t||this._allocateTargets();return this._textureToCubeUV(e,n),this._applyPMREM(n),this._cleanup(n),n}_allocateTargets(){const e=3*Math.max(this._cubeSize,112),t=4*this._cubeSize,n={magFilter:Jn,minFilter:Jn,generateMipmaps:!1,type:Er,format:jr,colorSpace:Xl,depthBuffer:!1},r=OD(e,t,n);if(this._pingPongRenderTarget===null||this._pingPongRenderTarget.width!==e||this._pingPongRenderTarget.height!==t){this._pingPongRenderTarget!==null&&this._dispose(),this._pingPongRenderTarget=OD(e,t,n);const{_lodMax:s}=this;({lodMeshes:this._lodMeshes,sizeLods:this._sizeLods,sigmas:this._sigmas}=aW(s)),this._blurMaterial=lW(s,e,t),this._ggxMaterial=oW(s,e,t)}return r}_compileMaterial(e){const t=new rr(new wn,e);this._renderer.compile(t,ov)}_sceneToCubeUV(e,t,n,r,s){const f=new hr(90,1,t,n),p=[1,-1,1,1,1,1],g=[1,1,1,-1,-1,-1],v=this._renderer,_=v.autoClear,x=v.toneMapping;v.getClearColor(LD),v.toneMapping=ol,v.autoClear=!1,v.state.buffers.depth.getReversed()&&(v.setRenderTarget(r),v.clearDepth(),v.setRenderTarget(null)),this._backgroundBox===null&&(this._backgroundBox=new rr(new fp,new to({name:"PMREM.Background",side:Ca,depthWrite:!1,depthTest:!1})));const C=this._backgroundBox,w=C.material;let T=!1;const N=e.background;N?N.isColor&&(w.color.copy(N),e.background=null,T=!0):(w.color.copy(LD),T=!0);for(let L=0;L<6;L++){const F=L%3;F===0?(f.up.set(0,p[L],0),f.position.set(s.x,s.y,s.z),f.lookAt(s.x+g[L],s.y,s.z)):F===1?(f.up.set(0,0,p[L]),f.position.set(s.x,s.y,s.z),f.lookAt(s.x,s.y+g[L],s.z)):(f.up.set(0,p[L],0),f.position.set(s.x,s.y,s.z),f.lookAt(s.x,s.y,s.z+g[L]));const G=this._cubeSize;Im(r,F*G,L>2?G:0,G,G),v.setRenderTarget(r),T&&v.render(C,f),v.render(e,f)}v.toneMapping=x,v.autoClear=_,e.background=N}_textureToCubeUV(e,t){const n=this._renderer,r=e.mapping===ql||e.mapping===yf;r?(this._cubemapMaterial===null&&(this._cubemapMaterial=FD()),this._cubemapMaterial.uniforms.flipEnvMap.value=e.isRenderTargetTexture===!1?-1:1):this._equirectMaterial===null&&(this._equirectMaterial=UD());const s=r?this._cubemapMaterial:this._equirectMaterial,o=this._lodMeshes[0];o.material=s;const u=s.uniforms;u.envMap.value=e;const f=this._cubeSize;Im(t,0,0,3*f,2*f),n.setRenderTarget(t),n.render(o,ov)}_applyPMREM(e){const t=this._renderer,n=t.autoClear;t.autoClear=!1;const r=this._lodMeshes.length;for(let s=1;s<r;s++)this._applyGGXFilter(e,s-1,s);t.autoClear=n}_applyGGXFilter(e,t,n){const r=this._renderer,s=this._pingPongRenderTarget,o=this._ggxMaterial,u=this._lodMeshes[n];u.material=o;const f=o.uniforms,p=n/(this._lodMeshes.length-1),g=t/(this._lodMeshes.length-1),v=Math.sqrt(p*p-g*g),_=0+p*1.25,x=v*_,{_lodMax:E}=this,C=this._sizeLods[n],w=3*C*(n>E-tf?n-E+tf:0),T=4*(this._cubeSize-C);f.envMap.value=e.texture,f.roughness.value=x,f.mipInt.value=E-t,Im(s,w,T,3*C,2*C),r.setRenderTarget(s),r.render(u,ov),f.envMap.value=s.texture,f.roughness.value=0,f.mipInt.value=E-n,Im(e,w,T,3*C,2*C),r.setRenderTarget(e),r.render(u,ov)}_blur(e,t,n,r,s){const o=this._pingPongRenderTarget;this._halfBlur(e,o,t,n,r,"latitudinal",s),this._halfBlur(o,e,n,n,r,"longitudinal",s)}_halfBlur(e,t,n,r,s,o,u){const f=this._renderer,p=this._blurMaterial;o!=="latitudinal"&&o!=="longitudinal"&&cn("blur direction must be either latitudinal or longitudinal!");const g=3,v=this._lodMeshes[r];v.material=p;const _=p.uniforms,x=this._sizeLods[n]-1,E=isFinite(s)?Math.PI/(2*x):2*Math.PI/(2*Rd-1),C=s/E,w=isFinite(s)?1+Math.floor(g*C):Rd;w>Rd&&Ht(`sigmaRadians, ${s}, is too large and will clip, as it requested ${w} samples when the maximum is set to ${Rd}`);const T=[];let N=0;for(let O=0;O<Rd;++O){const D=O/C,R=Math.exp(-D*D/2);T.push(R),O===0?N+=R:O<w&&(N+=2*R)}for(let O=0;O<T.length;O++)T[O]=T[O]/N;_.envMap.value=e.texture,_.samples.value=w,_.weights.value=T,_.latitudinal.value=o==="latitudinal",u&&(_.poleAxis.value=u);const{_lodMax:L}=this;_.dTheta.value=E,_.mipInt.value=L-n;const F=this._sizeLods[r],G=3*F*(r>L-tf?r-L+tf:0),k=4*(this._cubeSize-F);Im(t,G,k,3*F,2*F),f.setRenderTarget(t),f.render(v,ov)}}function aW(i){const e=[],t=[],n=[];let r=i;const s=i-tf+1+BD.length;for(let o=0;o<s;o++){const u=Math.pow(2,r);e.push(u);let f=1/u;o>i-tf?f=BD[o-i+tf-1]:o===0&&(f=0),t.push(f);const p=1/(u-2),g=-p,v=1+p,_=[g,g,v,g,v,v,g,g,v,v,g,v],x=6,E=6,C=3,w=2,T=1,N=new Float32Array(C*E*x),L=new Float32Array(w*E*x),F=new Float32Array(T*E*x);for(let k=0;k<x;k++){const O=k%3*2/3-1,D=k>2?0:-1,R=[O,D,0,O+2/3,D,0,O+2/3,D+1,0,O,D,0,O+2/3,D+1,0,O,D+1,0];N.set(R,C*E*k),L.set(_,w*E*k);const P=[k,k,k,k,k,k];F.set(P,T*E*k)}const G=new wn;G.setAttribute("position",new gi(N,C)),G.setAttribute("uv",new gi(L,w)),G.setAttribute("faceIndex",new gi(F,T)),n.push(new rr(G,null)),r>tf&&r--}return{lodMeshes:n,sizeLods:e,sigmas:t}}function OD(i,e,t){const n=new _s(i,e,t);return n.texture.mapping=Mg,n.texture.name="PMREM.cubeUv",n.scissorTest=!0,n}function Im(i,e,t,n,r){i.viewport.set(e,t,n,r),i.scissor.set(e,t,n,r)}function oW(i,e,t){return new Gs({name:"PMREMGGXConvolution",defines:{GGX_SAMPLES:rW,CUBEUV_TEXEL_WIDTH:1/e,CUBEUV_TEXEL_HEIGHT:1/t,CUBEUV_MAX_MIP:`${i}.0`},uniforms:{envMap:{value:null},roughness:{value:0},mipInt:{value:0}},vertexShader:VS(),fragmentShader:`

			precision highp float;
			precision highp int;

			varying vec3 vOutputDirection;

			uniform sampler2D envMap;
			uniform float roughness;
			uniform float mipInt;

			#define ENVMAP_TYPE_CUBE_UV
			#include <cube_uv_reflection_fragment>

			#define PI 3.14159265359

			// Van der Corput radical inverse
			float radicalInverse_VdC(uint bits) {
				bits = (bits << 16u) | (bits >> 16u);
				bits = ((bits & 0x55555555u) << 1u) | ((bits & 0xAAAAAAAAu) >> 1u);
				bits = ((bits & 0x33333333u) << 2u) | ((bits & 0xCCCCCCCCu) >> 2u);
				bits = ((bits & 0x0F0F0F0Fu) << 4u) | ((bits & 0xF0F0F0F0u) >> 4u);
				bits = ((bits & 0x00FF00FFu) << 8u) | ((bits & 0xFF00FF00u) >> 8u);
				return float(bits) * 2.3283064365386963e-10; // / 0x100000000
			}

			// Hammersley sequence
			vec2 hammersley(uint i, uint N) {
				return vec2(float(i) / float(N), radicalInverse_VdC(i));
			}

			// GGX VNDF importance sampling (Eric Heitz 2018)
			// "Sampling the GGX Distribution of Visible Normals"
			// https://jcgt.org/published/0007/04/01/
			vec3 importanceSampleGGX_VNDF(vec2 Xi, vec3 V, float roughness) {
				float alpha = roughness * roughness;

				// Section 3.2: Transform view direction to hemisphere configuration
				vec3 Vh = normalize(vec3(alpha * V.x, alpha * V.y, V.z));

				// Section 4.1: Orthonormal basis
				float lensq = Vh.x * Vh.x + Vh.y * Vh.y;
				vec3 T1 = lensq > 0.0 ? vec3(-Vh.y, Vh.x, 0.0) / sqrt(lensq) : vec3(1.0, 0.0, 0.0);
				vec3 T2 = cross(Vh, T1);

				// Section 4.2: Parameterization of projected area
				float r = sqrt(Xi.x);
				float phi = 2.0 * PI * Xi.y;
				float t1 = r * cos(phi);
				float t2 = r * sin(phi);
				float s = 0.5 * (1.0 + Vh.z);
				t2 = (1.0 - s) * sqrt(1.0 - t1 * t1) + s * t2;

				// Section 4.3: Reprojection onto hemisphere
				vec3 Nh = t1 * T1 + t2 * T2 + sqrt(max(0.0, 1.0 - t1 * t1 - t2 * t2)) * Vh;

				// Section 3.4: Transform back to ellipsoid configuration
				return normalize(vec3(alpha * Nh.x, alpha * Nh.y, max(0.0, Nh.z)));
			}

			void main() {
				vec3 N = normalize(vOutputDirection);
				vec3 V = N; // Assume view direction equals normal for pre-filtering

				vec3 prefilteredColor = vec3(0.0);
				float totalWeight = 0.0;

				// For very low roughness, just sample the environment directly
				if (roughness < 0.001) {
					gl_FragColor = vec4(bilinearCubeUV(envMap, N, mipInt), 1.0);
					return;
				}

				// Tangent space basis for VNDF sampling
				vec3 up = abs(N.z) < 0.999 ? vec3(0.0, 0.0, 1.0) : vec3(1.0, 0.0, 0.0);
				vec3 tangent = normalize(cross(up, N));
				vec3 bitangent = cross(N, tangent);

				for(uint i = 0u; i < uint(GGX_SAMPLES); i++) {
					vec2 Xi = hammersley(i, uint(GGX_SAMPLES));

					// For PMREM, V = N, so in tangent space V is always (0, 0, 1)
					vec3 H_tangent = importanceSampleGGX_VNDF(Xi, vec3(0.0, 0.0, 1.0), roughness);

					// Transform H back to world space
					vec3 H = normalize(tangent * H_tangent.x + bitangent * H_tangent.y + N * H_tangent.z);
					vec3 L = normalize(2.0 * dot(V, H) * H - V);

					float NdotL = max(dot(N, L), 0.0);

					if(NdotL > 0.0) {
						// Sample environment at fixed mip level
						// VNDF importance sampling handles the distribution filtering
						vec3 sampleColor = bilinearCubeUV(envMap, L, mipInt);

						// Weight by NdotL for the split-sum approximation
						// VNDF PDF naturally accounts for the visible microfacet distribution
						prefilteredColor += sampleColor * NdotL;
						totalWeight += NdotL;
					}
				}

				if (totalWeight > 0.0) {
					prefilteredColor = prefilteredColor / totalWeight;
				}

				gl_FragColor = vec4(prefilteredColor, 1.0);
			}
		`,blending:Gl,depthTest:!1,depthWrite:!1})}function lW(i,e,t){const n=new Float32Array(Rd),r=new ie(0,1,0);return new Gs({name:"SphericalGaussianBlur",defines:{n:Rd,CUBEUV_TEXEL_WIDTH:1/e,CUBEUV_TEXEL_HEIGHT:1/t,CUBEUV_MAX_MIP:`${i}.0`},uniforms:{envMap:{value:null},samples:{value:1},weights:{value:n},latitudinal:{value:!1},dTheta:{value:0},mipInt:{value:0},poleAxis:{value:r}},vertexShader:VS(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			varying vec3 vOutputDirection;

			uniform sampler2D envMap;
			uniform int samples;
			uniform float weights[ n ];
			uniform bool latitudinal;
			uniform float dTheta;
			uniform float mipInt;
			uniform vec3 poleAxis;

			#define ENVMAP_TYPE_CUBE_UV
			#include <cube_uv_reflection_fragment>

			vec3 getSample( float theta, vec3 axis ) {

				float cosTheta = cos( theta );
				// Rodrigues' axis-angle rotation
				vec3 sampleDirection = vOutputDirection * cosTheta
					+ cross( axis, vOutputDirection ) * sin( theta )
					+ axis * dot( axis, vOutputDirection ) * ( 1.0 - cosTheta );

				return bilinearCubeUV( envMap, sampleDirection, mipInt );

			}

			void main() {

				vec3 axis = latitudinal ? poleAxis : cross( poleAxis, vOutputDirection );

				if ( all( equal( axis, vec3( 0.0 ) ) ) ) {

					axis = vec3( vOutputDirection.z, 0.0, - vOutputDirection.x );

				}

				axis = normalize( axis );

				gl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );
				gl_FragColor.rgb += weights[ 0 ] * getSample( 0.0, axis );

				for ( int i = 1; i < n; i++ ) {

					if ( i >= samples ) {

						break;

					}

					float theta = dTheta * float( i );
					gl_FragColor.rgb += weights[ i ] * getSample( -1.0 * theta, axis );
					gl_FragColor.rgb += weights[ i ] * getSample( theta, axis );

				}

			}
		`,blending:Gl,depthTest:!1,depthWrite:!1})}function UD(){return new Gs({name:"EquirectangularToCubeUV",uniforms:{envMap:{value:null}},vertexShader:VS(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			varying vec3 vOutputDirection;

			uniform sampler2D envMap;

			#include <common>

			void main() {

				vec3 outputDirection = normalize( vOutputDirection );
				vec2 uv = equirectUv( outputDirection );

				gl_FragColor = vec4( texture2D ( envMap, uv ).rgb, 1.0 );

			}
		`,blending:Gl,depthTest:!1,depthWrite:!1})}function FD(){return new Gs({name:"CubemapToCubeUV",uniforms:{envMap:{value:null},flipEnvMap:{value:-1}},vertexShader:VS(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			uniform float flipEnvMap;

			varying vec3 vOutputDirection;

			uniform samplerCube envMap;

			void main() {

				gl_FragColor = textureCube( envMap, vec3( flipEnvMap * vOutputDirection.x, vOutputDirection.yz ) );

			}
		`,blending:Gl,depthTest:!1,depthWrite:!1})}function VS(){return`

		precision mediump float;
		precision mediump int;

		attribute float faceIndex;

		varying vec3 vOutputDirection;

		// RH coordinate system; PMREM face-indexing convention
		vec3 getDirection( vec2 uv, float face ) {

			uv = 2.0 * uv - 1.0;

			vec3 direction = vec3( uv, 1.0 );

			if ( face == 0.0 ) {

				direction = direction.zyx; // ( 1, v, u ) pos x

			} else if ( face == 1.0 ) {

				direction = direction.xzy;
				direction.xz *= -1.0; // ( -u, 1, -v ) pos y

			} else if ( face == 2.0 ) {

				direction.x *= -1.0; // ( -u, v, 1 ) pos z

			} else if ( face == 3.0 ) {

				direction = direction.zyx;
				direction.xz *= -1.0; // ( -1, v, -u ) neg x

			} else if ( face == 4.0 ) {

				direction = direction.xzy;
				direction.xy *= -1.0; // ( -u, -1, v ) neg y

			} else if ( face == 5.0 ) {

				direction.z *= -1.0; // ( u, v, -1 ) neg z

			}

			return direction;

		}

		void main() {

			vOutputDirection = getDirection( uv, faceIndex );
			gl_Position = vec4( position, 1.0 );

		}
	`}function cW(i){let e=new WeakMap,t=null;function n(u){if(u&&u.isTexture){const f=u.mapping,p=f===rg||f===Wv,g=f===ql||f===yf;if(p||g){let v=e.get(u);const _=v!==void 0?v.texture.pmremVersion:0;if(u.isRenderTargetTexture&&u.pmremVersion!==_)return t===null&&(t=new UT(i)),v=p?t.fromEquirectangular(u,v):t.fromCubemap(u,v),v.texture.pmremVersion=u.pmremVersion,e.set(u,v),v.texture;if(v!==void 0)return v.texture;{const x=u.image;return p&&x&&x.height>0||g&&x&&r(x)?(t===null&&(t=new UT(i)),v=p?t.fromEquirectangular(u):t.fromCubemap(u),v.texture.pmremVersion=u.pmremVersion,e.set(u,v),u.addEventListener("dispose",s),v.texture):null}}}return u}function r(u){let f=0;const p=6;for(let g=0;g<p;g++)u[g]!==void 0&&f++;return f===p}function s(u){const f=u.target;f.removeEventListener("dispose",s);const p=e.get(f);p!==void 0&&(e.delete(f),p.dispose())}function o(){e=new WeakMap,t!==null&&(t.dispose(),t=null)}return{get:n,dispose:o}}function uW(i){const e={};function t(n){if(e[n]!==void 0)return e[n];const r=i.getExtension(n);return e[n]=r,r}return{has:function(n){return t(n)!==null},init:function(){t("EXT_color_buffer_float"),t("WEBGL_clip_cull_distance"),t("OES_texture_float_linear"),t("EXT_color_buffer_half_float"),t("WEBGL_multisampled_render_to_texture"),t("WEBGL_render_shared_exponent")},get:function(n){const r=t(n);return r===null&&hg("WebGLRenderer: "+n+" extension not supported."),r}}}function hW(i,e,t,n){const r={},s=new WeakMap;function o(v){const _=v.target;_.index!==null&&e.remove(_.index);for(const E in _.attributes)e.remove(_.attributes[E]);_.removeEventListener("dispose",o),delete r[_.id];const x=s.get(_);x&&(e.remove(x),s.delete(_)),n.releaseStatesOfGeometry(_),_.isInstancedBufferGeometry===!0&&delete _._maxInstanceCount,t.memory.geometries--}function u(v,_){return r[_.id]===!0||(_.addEventListener("dispose",o),r[_.id]=!0,t.memory.geometries++),_}function f(v){const _=v.attributes;for(const x in _)e.update(_[x],i.ARRAY_BUFFER)}function p(v){const _=[],x=v.index,E=v.attributes.position;let C=0;if(x!==null){const N=x.array;C=x.version;for(let L=0,F=N.length;L<F;L+=3){const G=N[L+0],k=N[L+1],O=N[L+2];_.push(G,k,k,O,O,G)}}else if(E!==void 0){const N=E.array;C=E.version;for(let L=0,F=N.length/3-1;L<F;L+=3){const G=L+0,k=L+1,O=L+2;_.push(G,k,k,O,O,G)}}else return;const w=new(KB(_)?hw:uw)(_,1);w.version=C;const T=s.get(v);T&&e.remove(T),s.set(v,w)}function g(v){const _=s.get(v);if(_){const x=v.index;x!==null&&_.version<x.version&&p(v)}else p(v);return s.get(v)}return{get:u,update:f,getWireframeAttribute:g}}function fW(i,e,t){let n;function r(_){n=_}let s,o;function u(_){s=_.type,o=_.bytesPerElement}function f(_,x){i.drawElements(n,x,s,_*o),t.update(x,n,1)}function p(_,x,E){E!==0&&(i.drawElementsInstanced(n,x,s,_*o,E),t.update(x,n,E))}function g(_,x,E){if(E===0)return;e.get("WEBGL_multi_draw").multiDrawElementsWEBGL(n,x,0,s,_,0,E);let w=0;for(let T=0;T<E;T++)w+=x[T];t.update(w,n,1)}function v(_,x,E,C){if(E===0)return;const w=e.get("WEBGL_multi_draw");if(w===null)for(let T=0;T<_.length;T++)p(_[T]/o,x[T],C[T]);else{w.multiDrawElementsInstancedWEBGL(n,x,0,s,_,0,C,0,E);let T=0;for(let N=0;N<E;N++)T+=x[N]*C[N];t.update(T,n,1)}}this.setMode=r,this.setIndex=u,this.render=f,this.renderInstances=p,this.renderMultiDraw=g,this.renderMultiDrawInstances=v}function dW(i){const e={geometries:0,textures:0},t={frame:0,calls:0,triangles:0,points:0,lines:0};function n(s,o,u){switch(t.calls++,o){case i.TRIANGLES:t.triangles+=u*(s/3);break;case i.LINES:t.lines+=u*(s/2);break;case i.LINE_STRIP:t.lines+=u*(s-1);break;case i.LINE_LOOP:t.lines+=u*s;break;case i.POINTS:t.points+=u*s;break;default:cn("WebGLInfo: Unknown draw mode:",o);break}}function r(){t.calls=0,t.triangles=0,t.points=0,t.lines=0}return{memory:e,render:t,programs:null,autoReset:!0,reset:r,update:n}}function pW(i,e,t){const n=new WeakMap,r=new zi;function s(o,u,f){const p=o.morphTargetInfluences,g=u.morphAttributes.position||u.morphAttributes.normal||u.morphAttributes.color,v=g!==void 0?g.length:0;let _=n.get(u);if(_===void 0||_.count!==v){let P=function(){D.dispose(),n.delete(u),u.removeEventListener("dispose",P)};var x=P;_!==void 0&&_.texture.dispose();const E=u.morphAttributes.position!==void 0,C=u.morphAttributes.normal!==void 0,w=u.morphAttributes.color!==void 0,T=u.morphAttributes.position||[],N=u.morphAttributes.normal||[],L=u.morphAttributes.color||[];let F=0;E===!0&&(F=1),C===!0&&(F=2),w===!0&&(F=3);let G=u.attributes.position.count*F,k=1;G>e.maxTextureSize&&(k=Math.ceil(G/e.maxTextureSize),G=e.maxTextureSize);const O=new Float32Array(G*k*4*v),D=new gS(O,G,k,v);D.type=ir,D.needsUpdate=!0;const R=F*4;for(let z=0;z<v;z++){const Y=T[z],j=N[z],ce=L[z],fe=G*k*4*z;for(let te=0;te<Y.count;te++){const se=te*R;E===!0&&(r.fromBufferAttribute(Y,te),O[fe+se+0]=r.x,O[fe+se+1]=r.y,O[fe+se+2]=r.z,O[fe+se+3]=0),C===!0&&(r.fromBufferAttribute(j,te),O[fe+se+4]=r.x,O[fe+se+5]=r.y,O[fe+se+6]=r.z,O[fe+se+7]=0),w===!0&&(r.fromBufferAttribute(ce,te),O[fe+se+8]=r.x,O[fe+se+9]=r.y,O[fe+se+10]=r.z,O[fe+se+11]=ce.itemSize===4?r.w:1)}}_={count:v,texture:D,size:new $e(G,k)},n.set(u,_),u.addEventListener("dispose",P)}if(o.isInstancedMesh===!0&&o.morphTexture!==null)f.getUniforms().setValue(i,"morphTexture",o.morphTexture,t);else{let E=0;for(let w=0;w<p.length;w++)E+=p[w];const C=u.morphTargetsRelative?1:1-E;f.getUniforms().setValue(i,"morphTargetBaseInfluence",C),f.getUniforms().setValue(i,"morphTargetInfluences",p)}f.getUniforms().setValue(i,"morphTargetsTexture",_.texture,t),f.getUniforms().setValue(i,"morphTargetsTextureSize",_.size)}return{update:s}}function mW(i,e,t,n){let r=new WeakMap;function s(f){const p=n.render.frame,g=f.geometry,v=e.get(f,g);if(r.get(v)!==p&&(e.update(v),r.set(v,p)),f.isInstancedMesh&&(f.hasEventListener("dispose",u)===!1&&f.addEventListener("dispose",u),r.get(f)!==p&&(t.update(f.instanceMatrix,i.ARRAY_BUFFER),f.instanceColor!==null&&t.update(f.instanceColor,i.ARRAY_BUFFER),r.set(f,p))),f.isSkinnedMesh){const _=f.skeleton;r.get(_)!==p&&(_.update(),r.set(_,p))}return v}function o(){r=new WeakMap}function u(f){const p=f.target;p.removeEventListener("dispose",u),t.remove(p.instanceMatrix),p.instanceColor!==null&&t.remove(p.instanceColor)}return{update:s,dispose:o}}const gW={[KM]:"LINEAR_TONE_MAPPING",[QM]:"REINHARD_TONE_MAPPING",[ZM]:"CINEON_TONE_MAPPING",[sS]:"ACES_FILMIC_TONE_MAPPING",[ew]:"AGX_TONE_MAPPING",[tw]:"NEUTRAL_TONE_MAPPING",[$M]:"CUSTOM_TONE_MAPPING"};function vW(i,e,t,n,r){const s=new _s(e,t,{type:i,depthBuffer:n,stencilBuffer:r}),o=new _s(e,t,{type:Er,depthBuffer:!1,stencilBuffer:!1}),u=new wn;u.setAttribute("position",new tn([-1,3,0,-1,-1,0,3,-1,0],3)),u.setAttribute("uv",new tn([0,2,0,0,2,0],2));const f=new Ew({uniforms:{tDiffuse:{value:null}},vertexShader:`
			precision highp float;

			uniform mat4 modelViewMatrix;
			uniform mat4 projectionMatrix;

			attribute vec3 position;
			attribute vec2 uv;

			varying vec2 vUv;

			void main() {
				vUv = uv;
				gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
			}`,fragmentShader:`
			precision highp float;

			uniform sampler2D tDiffuse;

			varying vec2 vUv;

			#include <tonemapping_pars_fragment>
			#include <colorspace_pars_fragment>

			void main() {
				gl_FragColor = texture2D( tDiffuse, vUv );

				#ifdef LINEAR_TONE_MAPPING
					gl_FragColor.rgb = LinearToneMapping( gl_FragColor.rgb );
				#elif defined( REINHARD_TONE_MAPPING )
					gl_FragColor.rgb = ReinhardToneMapping( gl_FragColor.rgb );
				#elif defined( CINEON_TONE_MAPPING )
					gl_FragColor.rgb = CineonToneMapping( gl_FragColor.rgb );
				#elif defined( ACES_FILMIC_TONE_MAPPING )
					gl_FragColor.rgb = ACESFilmicToneMapping( gl_FragColor.rgb );
				#elif defined( AGX_TONE_MAPPING )
					gl_FragColor.rgb = AgXToneMapping( gl_FragColor.rgb );
				#elif defined( NEUTRAL_TONE_MAPPING )
					gl_FragColor.rgb = NeutralToneMapping( gl_FragColor.rgb );
				#elif defined( CUSTOM_TONE_MAPPING )
					gl_FragColor.rgb = CustomToneMapping( gl_FragColor.rgb );
				#endif

				#ifdef SRGB_TRANSFER
					gl_FragColor = sRGBTransferOETF( gl_FragColor );
				#endif
			}`,depthTest:!1,depthWrite:!1}),p=new rr(u,f),g=new Ao(-1,1,1,-1,0,1);let v=null,_=null,x=!1,E,C=null,w=[],T=!1;this.setSize=function(N,L){s.setSize(N,L),o.setSize(N,L);for(let F=0;F<w.length;F++){const G=w[F];G.setSize&&G.setSize(N,L)}},this.setEffects=function(N){w=N,T=w.length>0&&w[0].isRenderPass===!0;const L=s.width,F=s.height;for(let G=0;G<w.length;G++){const k=w[G];k.setSize&&k.setSize(L,F)}},this.begin=function(N,L){if(x||N.toneMapping===ol&&w.length===0)return!1;if(C=L,L!==null){const F=L.width,G=L.height;(s.width!==F||s.height!==G)&&this.setSize(F,G)}return T===!1&&N.setRenderTarget(s),E=N.toneMapping,N.toneMapping=ol,!0},this.hasRenderPass=function(){return T},this.end=function(N,L){N.toneMapping=E,x=!0;let F=s,G=o;for(let k=0;k<w.length;k++){const O=w[k];if(O.enabled!==!1&&(O.render(N,G,F,L),O.needsSwap!==!1)){const D=F;F=G,G=D}}if(v!==N.outputColorSpace||_!==N.toneMapping){v=N.outputColorSpace,_=N.toneMapping,f.defines={},oi.getTransfer(v)===wi&&(f.defines.SRGB_TRANSFER="");const k=gW[_];k&&(f.defines[k]=""),f.needsUpdate=!0}f.uniforms.tDiffuse.value=F.texture,N.setRenderTarget(C),N.render(p,g),C=null,x=!1},this.isCompositing=function(){return x},this.dispose=function(){s.dispose(),o.dispose(),u.dispose(),f.dispose()}}const JL=new Ci,FT=new ep(1,1),KL=new gS,QL=new vS,ZL=new by,kD=[],zD=[],VD=new Float32Array(16),HD=new Float32Array(9),GD=new Float32Array(4);function Ig(i,e,t){const n=i[0];if(n<=0||n>0)return i;const r=e*t;let s=kD[r];if(s===void 0&&(s=new Float32Array(r),kD[r]=s),e!==0){n.toArray(s,0);for(let o=1,u=0;o!==e;++o)u+=t,i[o].toArray(s,u)}return s}function ls(i,e){if(i.length!==e.length)return!1;for(let t=0,n=i.length;t<n;t++)if(i[t]!==e[t])return!1;return!0}function cs(i,e){for(let t=0,n=e.length;t<n;t++)i[t]=e[t]}function HS(i,e){let t=zD[e];t===void 0&&(t=new Int32Array(e),zD[e]=t);for(let n=0;n!==e;++n)t[n]=i.allocateTextureUnit();return t}function yW(i,e){const t=this.cache;t[0]!==e&&(i.uniform1f(this.addr,e),t[0]=e)}function _W(i,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y)&&(i.uniform2f(this.addr,e.x,e.y),t[0]=e.x,t[1]=e.y);else{if(ls(t,e))return;i.uniform2fv(this.addr,e),cs(t,e)}}function xW(i,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z)&&(i.uniform3f(this.addr,e.x,e.y,e.z),t[0]=e.x,t[1]=e.y,t[2]=e.z);else if(e.r!==void 0)(t[0]!==e.r||t[1]!==e.g||t[2]!==e.b)&&(i.uniform3f(this.addr,e.r,e.g,e.b),t[0]=e.r,t[1]=e.g,t[2]=e.b);else{if(ls(t,e))return;i.uniform3fv(this.addr,e),cs(t,e)}}function bW(i,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z||t[3]!==e.w)&&(i.uniform4f(this.addr,e.x,e.y,e.z,e.w),t[0]=e.x,t[1]=e.y,t[2]=e.z,t[3]=e.w);else{if(ls(t,e))return;i.uniform4fv(this.addr,e),cs(t,e)}}function AW(i,e){const t=this.cache,n=e.elements;if(n===void 0){if(ls(t,e))return;i.uniformMatrix2fv(this.addr,!1,e),cs(t,e)}else{if(ls(t,n))return;GD.set(n),i.uniformMatrix2fv(this.addr,!1,GD),cs(t,n)}}function SW(i,e){const t=this.cache,n=e.elements;if(n===void 0){if(ls(t,e))return;i.uniformMatrix3fv(this.addr,!1,e),cs(t,e)}else{if(ls(t,n))return;HD.set(n),i.uniformMatrix3fv(this.addr,!1,HD),cs(t,n)}}function EW(i,e){const t=this.cache,n=e.elements;if(n===void 0){if(ls(t,e))return;i.uniformMatrix4fv(this.addr,!1,e),cs(t,e)}else{if(ls(t,n))return;VD.set(n),i.uniformMatrix4fv(this.addr,!1,VD),cs(t,n)}}function TW(i,e){const t=this.cache;t[0]!==e&&(i.uniform1i(this.addr,e),t[0]=e)}function MW(i,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y)&&(i.uniform2i(this.addr,e.x,e.y),t[0]=e.x,t[1]=e.y);else{if(ls(t,e))return;i.uniform2iv(this.addr,e),cs(t,e)}}function wW(i,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z)&&(i.uniform3i(this.addr,e.x,e.y,e.z),t[0]=e.x,t[1]=e.y,t[2]=e.z);else{if(ls(t,e))return;i.uniform3iv(this.addr,e),cs(t,e)}}function CW(i,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z||t[3]!==e.w)&&(i.uniform4i(this.addr,e.x,e.y,e.z,e.w),t[0]=e.x,t[1]=e.y,t[2]=e.z,t[3]=e.w);else{if(ls(t,e))return;i.uniform4iv(this.addr,e),cs(t,e)}}function RW(i,e){const t=this.cache;t[0]!==e&&(i.uniform1ui(this.addr,e),t[0]=e)}function IW(i,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y)&&(i.uniform2ui(this.addr,e.x,e.y),t[0]=e.x,t[1]=e.y);else{if(ls(t,e))return;i.uniform2uiv(this.addr,e),cs(t,e)}}function DW(i,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z)&&(i.uniform3ui(this.addr,e.x,e.y,e.z),t[0]=e.x,t[1]=e.y,t[2]=e.z);else{if(ls(t,e))return;i.uniform3uiv(this.addr,e),cs(t,e)}}function NW(i,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z||t[3]!==e.w)&&(i.uniform4ui(this.addr,e.x,e.y,e.z,e.w),t[0]=e.x,t[1]=e.y,t[2]=e.z,t[3]=e.w);else{if(ls(t,e))return;i.uniform4uiv(this.addr,e),cs(t,e)}}function PW(i,e,t){const n=this.cache,r=t.allocateTextureUnit();n[0]!==r&&(i.uniform1i(this.addr,r),n[0]=r);let s;this.type===i.SAMPLER_2D_SHADOW?(FT.compareFunction=t.isReversedDepthBuffer()?mS:pS,s=FT):s=JL,t.setTexture2D(e||s,r)}function BW(i,e,t){const n=this.cache,r=t.allocateTextureUnit();n[0]!==r&&(i.uniform1i(this.addr,r),n[0]=r),t.setTexture3D(e||QL,r)}function LW(i,e,t){const n=this.cache,r=t.allocateTextureUnit();n[0]!==r&&(i.uniform1i(this.addr,r),n[0]=r),t.setTextureCube(e||ZL,r)}function OW(i,e,t){const n=this.cache,r=t.allocateTextureUnit();n[0]!==r&&(i.uniform1i(this.addr,r),n[0]=r),t.setTexture2DArray(e||KL,r)}function UW(i){switch(i){case 5126:return yW;case 35664:return _W;case 35665:return xW;case 35666:return bW;case 35674:return AW;case 35675:return SW;case 35676:return EW;case 5124:case 35670:return TW;case 35667:case 35671:return MW;case 35668:case 35672:return wW;case 35669:case 35673:return CW;case 5125:return RW;case 36294:return IW;case 36295:return DW;case 36296:return NW;case 35678:case 36198:case 36298:case 36306:case 35682:return PW;case 35679:case 36299:case 36307:return BW;case 35680:case 36300:case 36308:case 36293:return LW;case 36289:case 36303:case 36311:case 36292:return OW}}function FW(i,e){i.uniform1fv(this.addr,e)}function kW(i,e){const t=Ig(e,this.size,2);i.uniform2fv(this.addr,t)}function zW(i,e){const t=Ig(e,this.size,3);i.uniform3fv(this.addr,t)}function VW(i,e){const t=Ig(e,this.size,4);i.uniform4fv(this.addr,t)}function HW(i,e){const t=Ig(e,this.size,4);i.uniformMatrix2fv(this.addr,!1,t)}function GW(i,e){const t=Ig(e,this.size,9);i.uniformMatrix3fv(this.addr,!1,t)}function jW(i,e){const t=Ig(e,this.size,16);i.uniformMatrix4fv(this.addr,!1,t)}function WW(i,e){i.uniform1iv(this.addr,e)}function qW(i,e){i.uniform2iv(this.addr,e)}function XW(i,e){i.uniform3iv(this.addr,e)}function YW(i,e){i.uniform4iv(this.addr,e)}function JW(i,e){i.uniform1uiv(this.addr,e)}function KW(i,e){i.uniform2uiv(this.addr,e)}function QW(i,e){i.uniform3uiv(this.addr,e)}function ZW(i,e){i.uniform4uiv(this.addr,e)}function $W(i,e,t){const n=this.cache,r=e.length,s=HS(t,r);ls(n,s)||(i.uniform1iv(this.addr,s),cs(n,s));let o;this.type===i.SAMPLER_2D_SHADOW?o=FT:o=JL;for(let u=0;u!==r;++u)t.setTexture2D(e[u]||o,s[u])}function eq(i,e,t){const n=this.cache,r=e.length,s=HS(t,r);ls(n,s)||(i.uniform1iv(this.addr,s),cs(n,s));for(let o=0;o!==r;++o)t.setTexture3D(e[o]||QL,s[o])}function tq(i,e,t){const n=this.cache,r=e.length,s=HS(t,r);ls(n,s)||(i.uniform1iv(this.addr,s),cs(n,s));for(let o=0;o!==r;++o)t.setTextureCube(e[o]||ZL,s[o])}function nq(i,e,t){const n=this.cache,r=e.length,s=HS(t,r);ls(n,s)||(i.uniform1iv(this.addr,s),cs(n,s));for(let o=0;o!==r;++o)t.setTexture2DArray(e[o]||KL,s[o])}function iq(i){switch(i){case 5126:return FW;case 35664:return kW;case 35665:return zW;case 35666:return VW;case 35674:return HW;case 35675:return GW;case 35676:return jW;case 5124:case 35670:return WW;case 35667:case 35671:return qW;case 35668:case 35672:return XW;case 35669:case 35673:return YW;case 5125:return JW;case 36294:return KW;case 36295:return QW;case 36296:return ZW;case 35678:case 36198:case 36298:case 36306:case 35682:return $W;case 35679:case 36299:case 36307:return eq;case 35680:case 36300:case 36308:case 36293:return tq;case 36289:case 36303:case 36311:case 36292:return nq}}class rq{constructor(e,t,n){this.id=e,this.addr=n,this.cache=[],this.type=t.type,this.setValue=UW(t.type)}}class sq{constructor(e,t,n){this.id=e,this.addr=n,this.cache=[],this.type=t.type,this.size=t.size,this.setValue=iq(t.type)}}class aq{constructor(e){this.id=e,this.seq=[],this.map={}}setValue(e,t,n){const r=this.seq;for(let s=0,o=r.length;s!==o;++s){const u=r[s];u.setValue(e,t[u.id],n)}}}const R1=/(\w+)(\])?(\[|\.)?/g;function jD(i,e){i.seq.push(e),i.map[e.id]=e}function oq(i,e,t){const n=i.name,r=n.length;for(R1.lastIndex=0;;){const s=R1.exec(n),o=R1.lastIndex;let u=s[1];const f=s[2]==="]",p=s[3];if(f&&(u=u|0),p===void 0||p==="["&&o+2===r){jD(t,p===void 0?new rq(u,i,e):new sq(u,i,e));break}else{let v=t.map[u];v===void 0&&(v=new aq(u),jD(t,v)),t=v}}}class gb{constructor(e,t){this.seq=[],this.map={};const n=e.getProgramParameter(t,e.ACTIVE_UNIFORMS);for(let o=0;o<n;++o){const u=e.getActiveUniform(t,o),f=e.getUniformLocation(t,u.name);oq(u,f,this)}const r=[],s=[];for(const o of this.seq)o.type===e.SAMPLER_2D_SHADOW||o.type===e.SAMPLER_CUBE_SHADOW||o.type===e.SAMPLER_2D_ARRAY_SHADOW?r.push(o):s.push(o);r.length>0&&(this.seq=r.concat(s))}setValue(e,t,n,r){const s=this.map[t];s!==void 0&&s.setValue(e,n,r)}setOptional(e,t,n){const r=t[n];r!==void 0&&this.setValue(e,n,r)}static upload(e,t,n,r){for(let s=0,o=t.length;s!==o;++s){const u=t[s],f=n[u.id];f.needsUpdate!==!1&&u.setValue(e,f.value,r)}}static seqWithValue(e,t){const n=[];for(let r=0,s=e.length;r!==s;++r){const o=e[r];o.id in t&&n.push(o)}return n}}function WD(i,e,t){const n=i.createShader(e);return i.shaderSource(n,t),i.compileShader(n),n}const lq=37297;let cq=0;function uq(i,e){const t=i.split(`
`),n=[],r=Math.max(e-6,0),s=Math.min(e+6,t.length);for(let o=r;o<s;o++){const u=o+1;n.push(`${u===e?">":" "} ${u}: ${t[o]}`)}return n.join(`
`)}const qD=new Un;function hq(i){oi._getMatrix(qD,oi.workingColorSpace,i);const e=`mat3( ${qD.elements.map(t=>t.toFixed(4))} )`;switch(oi.getTransfer(i)){case Xv:return[e,"LinearTransferOETF"];case wi:return[e,"sRGBTransferOETF"];default:return Ht("WebGLProgram: Unsupported color space: ",i),[e,"LinearTransferOETF"]}}function XD(i,e,t){const n=i.getShaderParameter(e,i.COMPILE_STATUS),s=(i.getShaderInfoLog(e)||"").trim();if(n&&s==="")return"";const o=/ERROR: 0:(\d+)/.exec(s);if(o){const u=parseInt(o[1]);return t.toUpperCase()+`

`+s+`

`+uq(i.getShaderSource(e),u)}else return s}function fq(i,e){const t=hq(e);return[`vec4 ${i}( vec4 value ) {`,`	return ${t[1]}( vec4( value.rgb * ${t[0]}, value.a ) );`,"}"].join(`
`)}const dq={[KM]:"Linear",[QM]:"Reinhard",[ZM]:"Cineon",[sS]:"ACESFilmic",[ew]:"AgX",[tw]:"Neutral",[$M]:"Custom"};function pq(i,e){const t=dq[e];return t===void 0?(Ht("WebGLProgram: Unsupported toneMapping:",e),"vec3 "+i+"( vec3 color ) { return LinearToneMapping( color ); }"):"vec3 "+i+"( vec3 color ) { return "+t+"ToneMapping( color ); }"}const Yx=new ie;function mq(){oi.getLuminanceCoefficients(Yx);const i=Yx.x.toFixed(4),e=Yx.y.toFixed(4),t=Yx.z.toFixed(4);return["float luminance( const in vec3 rgb ) {",`	const vec3 weights = vec3( ${i}, ${e}, ${t} );`,"	return dot( weights, rgb );","}"].join(`
`)}function gq(i){return[i.extensionClipCullDistance?"#extension GL_ANGLE_clip_cull_distance : require":"",i.extensionMultiDraw?"#extension GL_ANGLE_multi_draw : require":""].filter(yv).join(`
`)}function vq(i){const e=[];for(const t in i){const n=i[t];n!==!1&&e.push("#define "+t+" "+n)}return e.join(`
`)}function yq(i,e){const t={},n=i.getProgramParameter(e,i.ACTIVE_ATTRIBUTES);for(let r=0;r<n;r++){const s=i.getActiveAttrib(e,r),o=s.name;let u=1;s.type===i.FLOAT_MAT2&&(u=2),s.type===i.FLOAT_MAT3&&(u=3),s.type===i.FLOAT_MAT4&&(u=4),t[o]={type:s.type,location:i.getAttribLocation(e,o),locationSize:u}}return t}function yv(i){return i!==""}function YD(i,e){const t=e.numSpotLightShadows+e.numSpotLightMaps-e.numSpotLightShadowsWithMaps;return i.replace(/NUM_DIR_LIGHTS/g,e.numDirLights).replace(/NUM_SPOT_LIGHTS/g,e.numSpotLights).replace(/NUM_SPOT_LIGHT_MAPS/g,e.numSpotLightMaps).replace(/NUM_SPOT_LIGHT_COORDS/g,t).replace(/NUM_RECT_AREA_LIGHTS/g,e.numRectAreaLights).replace(/NUM_POINT_LIGHTS/g,e.numPointLights).replace(/NUM_HEMI_LIGHTS/g,e.numHemiLights).replace(/NUM_DIR_LIGHT_SHADOWS/g,e.numDirLightShadows).replace(/NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS/g,e.numSpotLightShadowsWithMaps).replace(/NUM_SPOT_LIGHT_SHADOWS/g,e.numSpotLightShadows).replace(/NUM_POINT_LIGHT_SHADOWS/g,e.numPointLightShadows)}function JD(i,e){return i.replace(/NUM_CLIPPING_PLANES/g,e.numClippingPlanes).replace(/UNION_CLIPPING_PLANES/g,e.numClippingPlanes-e.numClipIntersection)}const _q=/^[ \t]*#include +<([\w\d./]+)>/gm;function kT(i){return i.replace(_q,bq)}const xq=new Map;function bq(i,e){let t=Gn[e];if(t===void 0){const n=xq.get(e);if(n!==void 0)t=Gn[n],Ht('WebGLRenderer: Shader chunk "%s" has been deprecated. Use "%s" instead.',e,n);else throw new Error("Can not resolve #include <"+e+">")}return kT(t)}const Aq=/#pragma unroll_loop_start\s+for\s*\(\s*int\s+i\s*=\s*(\d+)\s*;\s*i\s*<\s*(\d+)\s*;\s*i\s*\+\+\s*\)\s*{([\s\S]+?)}\s+#pragma unroll_loop_end/g;function KD(i){return i.replace(Aq,Sq)}function Sq(i,e,t,n){let r="";for(let s=parseInt(e);s<parseInt(t);s++)r+=n.replace(/\[\s*i\s*\]/g,"[ "+s+" ]").replace(/UNROLLED_LOOP_INDEX/g,s);return r}function QD(i){let e=`precision ${i.precision} float;
	precision ${i.precision} int;
	precision ${i.precision} sampler2D;
	precision ${i.precision} samplerCube;
	precision ${i.precision} sampler3D;
	precision ${i.precision} sampler2DArray;
	precision ${i.precision} sampler2DShadow;
	precision ${i.precision} samplerCubeShadow;
	precision ${i.precision} sampler2DArrayShadow;
	precision ${i.precision} isampler2D;
	precision ${i.precision} isampler3D;
	precision ${i.precision} isamplerCube;
	precision ${i.precision} isampler2DArray;
	precision ${i.precision} usampler2D;
	precision ${i.precision} usampler3D;
	precision ${i.precision} usamplerCube;
	precision ${i.precision} usampler2DArray;
	`;return i.precision==="highp"?e+=`
#define HIGH_PRECISION`:i.precision==="mediump"?e+=`
#define MEDIUM_PRECISION`:i.precision==="lowp"&&(e+=`
#define LOW_PRECISION`),e}const Eq={[Wm]:"SHADOWMAP_TYPE_PCF",[Nd]:"SHADOWMAP_TYPE_VSM"};function Tq(i){return Eq[i.shadowMapType]||"SHADOWMAP_TYPE_BASIC"}const Mq={[ql]:"ENVMAP_TYPE_CUBE",[yf]:"ENVMAP_TYPE_CUBE",[Mg]:"ENVMAP_TYPE_CUBE_UV"};function wq(i){return i.envMap===!1?"ENVMAP_TYPE_CUBE":Mq[i.envMapMode]||"ENVMAP_TYPE_CUBE"}const Cq={[yf]:"ENVMAP_MODE_REFRACTION"};function Rq(i){return i.envMap===!1?"ENVMAP_MODE_REFLECTION":Cq[i.envMapMode]||"ENVMAP_MODE_REFLECTION"}const Iq={[vy]:"ENVMAP_BLENDING_MULTIPLY",[LB]:"ENVMAP_BLENDING_MIX",[OB]:"ENVMAP_BLENDING_ADD"};function Dq(i){return i.envMap===!1?"ENVMAP_BLENDING_NONE":Iq[i.combine]||"ENVMAP_BLENDING_NONE"}function Nq(i){const e=i.envMapCubeUVHeight;if(e===null)return null;const t=Math.log2(e)-2,n=1/e;return{texelWidth:1/(3*Math.max(Math.pow(2,t),112)),texelHeight:n,maxMip:t}}function Pq(i,e,t,n){const r=i.getContext(),s=t.defines;let o=t.vertexShader,u=t.fragmentShader;const f=Tq(t),p=wq(t),g=Rq(t),v=Dq(t),_=Nq(t),x=gq(t),E=vq(s),C=r.createProgram();let w,T,N=t.glslVersion?"#version "+t.glslVersion+`
`:"";t.isRawShaderMaterial?(w=["#define SHADER_TYPE "+t.shaderType,"#define SHADER_NAME "+t.shaderName,E].filter(yv).join(`
`),w.length>0&&(w+=`
`),T=["#define SHADER_TYPE "+t.shaderType,"#define SHADER_NAME "+t.shaderName,E].filter(yv).join(`
`),T.length>0&&(T+=`
`)):(w=[QD(t),"#define SHADER_TYPE "+t.shaderType,"#define SHADER_NAME "+t.shaderName,E,t.extensionClipCullDistance?"#define USE_CLIP_DISTANCE":"",t.batching?"#define USE_BATCHING":"",t.batchingColor?"#define USE_BATCHING_COLOR":"",t.instancing?"#define USE_INSTANCING":"",t.instancingColor?"#define USE_INSTANCING_COLOR":"",t.instancingMorph?"#define USE_INSTANCING_MORPH":"",t.useFog&&t.fog?"#define USE_FOG":"",t.useFog&&t.fogExp2?"#define FOG_EXP2":"",t.map?"#define USE_MAP":"",t.envMap?"#define USE_ENVMAP":"",t.envMap?"#define "+g:"",t.lightMap?"#define USE_LIGHTMAP":"",t.aoMap?"#define USE_AOMAP":"",t.bumpMap?"#define USE_BUMPMAP":"",t.normalMap?"#define USE_NORMALMAP":"",t.normalMapObjectSpace?"#define USE_NORMALMAP_OBJECTSPACE":"",t.normalMapTangentSpace?"#define USE_NORMALMAP_TANGENTSPACE":"",t.displacementMap?"#define USE_DISPLACEMENTMAP":"",t.emissiveMap?"#define USE_EMISSIVEMAP":"",t.anisotropy?"#define USE_ANISOTROPY":"",t.anisotropyMap?"#define USE_ANISOTROPYMAP":"",t.clearcoatMap?"#define USE_CLEARCOATMAP":"",t.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",t.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",t.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",t.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",t.specularMap?"#define USE_SPECULARMAP":"",t.specularColorMap?"#define USE_SPECULAR_COLORMAP":"",t.specularIntensityMap?"#define USE_SPECULAR_INTENSITYMAP":"",t.roughnessMap?"#define USE_ROUGHNESSMAP":"",t.metalnessMap?"#define USE_METALNESSMAP":"",t.alphaMap?"#define USE_ALPHAMAP":"",t.alphaHash?"#define USE_ALPHAHASH":"",t.transmission?"#define USE_TRANSMISSION":"",t.transmissionMap?"#define USE_TRANSMISSIONMAP":"",t.thicknessMap?"#define USE_THICKNESSMAP":"",t.sheenColorMap?"#define USE_SHEEN_COLORMAP":"",t.sheenRoughnessMap?"#define USE_SHEEN_ROUGHNESSMAP":"",t.mapUv?"#define MAP_UV "+t.mapUv:"",t.alphaMapUv?"#define ALPHAMAP_UV "+t.alphaMapUv:"",t.lightMapUv?"#define LIGHTMAP_UV "+t.lightMapUv:"",t.aoMapUv?"#define AOMAP_UV "+t.aoMapUv:"",t.emissiveMapUv?"#define EMISSIVEMAP_UV "+t.emissiveMapUv:"",t.bumpMapUv?"#define BUMPMAP_UV "+t.bumpMapUv:"",t.normalMapUv?"#define NORMALMAP_UV "+t.normalMapUv:"",t.displacementMapUv?"#define DISPLACEMENTMAP_UV "+t.displacementMapUv:"",t.metalnessMapUv?"#define METALNESSMAP_UV "+t.metalnessMapUv:"",t.roughnessMapUv?"#define ROUGHNESSMAP_UV "+t.roughnessMapUv:"",t.anisotropyMapUv?"#define ANISOTROPYMAP_UV "+t.anisotropyMapUv:"",t.clearcoatMapUv?"#define CLEARCOATMAP_UV "+t.clearcoatMapUv:"",t.clearcoatNormalMapUv?"#define CLEARCOAT_NORMALMAP_UV "+t.clearcoatNormalMapUv:"",t.clearcoatRoughnessMapUv?"#define CLEARCOAT_ROUGHNESSMAP_UV "+t.clearcoatRoughnessMapUv:"",t.iridescenceMapUv?"#define IRIDESCENCEMAP_UV "+t.iridescenceMapUv:"",t.iridescenceThicknessMapUv?"#define IRIDESCENCE_THICKNESSMAP_UV "+t.iridescenceThicknessMapUv:"",t.sheenColorMapUv?"#define SHEEN_COLORMAP_UV "+t.sheenColorMapUv:"",t.sheenRoughnessMapUv?"#define SHEEN_ROUGHNESSMAP_UV "+t.sheenRoughnessMapUv:"",t.specularMapUv?"#define SPECULARMAP_UV "+t.specularMapUv:"",t.specularColorMapUv?"#define SPECULAR_COLORMAP_UV "+t.specularColorMapUv:"",t.specularIntensityMapUv?"#define SPECULAR_INTENSITYMAP_UV "+t.specularIntensityMapUv:"",t.transmissionMapUv?"#define TRANSMISSIONMAP_UV "+t.transmissionMapUv:"",t.thicknessMapUv?"#define THICKNESSMAP_UV "+t.thicknessMapUv:"",t.vertexTangents&&t.flatShading===!1?"#define USE_TANGENT":"",t.vertexColors?"#define USE_COLOR":"",t.vertexAlphas?"#define USE_COLOR_ALPHA":"",t.vertexUv1s?"#define USE_UV1":"",t.vertexUv2s?"#define USE_UV2":"",t.vertexUv3s?"#define USE_UV3":"",t.pointsUvs?"#define USE_POINTS_UV":"",t.flatShading?"#define FLAT_SHADED":"",t.skinning?"#define USE_SKINNING":"",t.morphTargets?"#define USE_MORPHTARGETS":"",t.morphNormals&&t.flatShading===!1?"#define USE_MORPHNORMALS":"",t.morphColors?"#define USE_MORPHCOLORS":"",t.morphTargetsCount>0?"#define MORPHTARGETS_TEXTURE_STRIDE "+t.morphTextureStride:"",t.morphTargetsCount>0?"#define MORPHTARGETS_COUNT "+t.morphTargetsCount:"",t.doubleSided?"#define DOUBLE_SIDED":"",t.flipSided?"#define FLIP_SIDED":"",t.shadowMapEnabled?"#define USE_SHADOWMAP":"",t.shadowMapEnabled?"#define "+f:"",t.sizeAttenuation?"#define USE_SIZEATTENUATION":"",t.numLightProbes>0?"#define USE_LIGHT_PROBES":"",t.logarithmicDepthBuffer?"#define USE_LOGARITHMIC_DEPTH_BUFFER":"",t.reversedDepthBuffer?"#define USE_REVERSED_DEPTH_BUFFER":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;","#ifdef USE_INSTANCING","	attribute mat4 instanceMatrix;","#endif","#ifdef USE_INSTANCING_COLOR","	attribute vec3 instanceColor;","#endif","#ifdef USE_INSTANCING_MORPH","	uniform sampler2D morphTexture;","#endif","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","#ifdef USE_UV1","	attribute vec2 uv1;","#endif","#ifdef USE_UV2","	attribute vec2 uv2;","#endif","#ifdef USE_UV3","	attribute vec2 uv3;","#endif","#ifdef USE_TANGENT","	attribute vec4 tangent;","#endif","#if defined( USE_COLOR_ALPHA )","	attribute vec4 color;","#elif defined( USE_COLOR )","	attribute vec3 color;","#endif","#ifdef USE_SKINNING","	attribute vec4 skinIndex;","	attribute vec4 skinWeight;","#endif",`
`].filter(yv).join(`
`),T=[QD(t),"#define SHADER_TYPE "+t.shaderType,"#define SHADER_NAME "+t.shaderName,E,t.useFog&&t.fog?"#define USE_FOG":"",t.useFog&&t.fogExp2?"#define FOG_EXP2":"",t.alphaToCoverage?"#define ALPHA_TO_COVERAGE":"",t.map?"#define USE_MAP":"",t.matcap?"#define USE_MATCAP":"",t.envMap?"#define USE_ENVMAP":"",t.envMap?"#define "+p:"",t.envMap?"#define "+g:"",t.envMap?"#define "+v:"",_?"#define CUBEUV_TEXEL_WIDTH "+_.texelWidth:"",_?"#define CUBEUV_TEXEL_HEIGHT "+_.texelHeight:"",_?"#define CUBEUV_MAX_MIP "+_.maxMip+".0":"",t.lightMap?"#define USE_LIGHTMAP":"",t.aoMap?"#define USE_AOMAP":"",t.bumpMap?"#define USE_BUMPMAP":"",t.normalMap?"#define USE_NORMALMAP":"",t.normalMapObjectSpace?"#define USE_NORMALMAP_OBJECTSPACE":"",t.normalMapTangentSpace?"#define USE_NORMALMAP_TANGENTSPACE":"",t.emissiveMap?"#define USE_EMISSIVEMAP":"",t.anisotropy?"#define USE_ANISOTROPY":"",t.anisotropyMap?"#define USE_ANISOTROPYMAP":"",t.clearcoat?"#define USE_CLEARCOAT":"",t.clearcoatMap?"#define USE_CLEARCOATMAP":"",t.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",t.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",t.dispersion?"#define USE_DISPERSION":"",t.iridescence?"#define USE_IRIDESCENCE":"",t.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",t.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",t.specularMap?"#define USE_SPECULARMAP":"",t.specularColorMap?"#define USE_SPECULAR_COLORMAP":"",t.specularIntensityMap?"#define USE_SPECULAR_INTENSITYMAP":"",t.roughnessMap?"#define USE_ROUGHNESSMAP":"",t.metalnessMap?"#define USE_METALNESSMAP":"",t.alphaMap?"#define USE_ALPHAMAP":"",t.alphaTest?"#define USE_ALPHATEST":"",t.alphaHash?"#define USE_ALPHAHASH":"",t.sheen?"#define USE_SHEEN":"",t.sheenColorMap?"#define USE_SHEEN_COLORMAP":"",t.sheenRoughnessMap?"#define USE_SHEEN_ROUGHNESSMAP":"",t.transmission?"#define USE_TRANSMISSION":"",t.transmissionMap?"#define USE_TRANSMISSIONMAP":"",t.thicknessMap?"#define USE_THICKNESSMAP":"",t.vertexTangents&&t.flatShading===!1?"#define USE_TANGENT":"",t.vertexColors||t.instancingColor||t.batchingColor?"#define USE_COLOR":"",t.vertexAlphas?"#define USE_COLOR_ALPHA":"",t.vertexUv1s?"#define USE_UV1":"",t.vertexUv2s?"#define USE_UV2":"",t.vertexUv3s?"#define USE_UV3":"",t.pointsUvs?"#define USE_POINTS_UV":"",t.gradientMap?"#define USE_GRADIENTMAP":"",t.flatShading?"#define FLAT_SHADED":"",t.doubleSided?"#define DOUBLE_SIDED":"",t.flipSided?"#define FLIP_SIDED":"",t.shadowMapEnabled?"#define USE_SHADOWMAP":"",t.shadowMapEnabled?"#define "+f:"",t.premultipliedAlpha?"#define PREMULTIPLIED_ALPHA":"",t.numLightProbes>0?"#define USE_LIGHT_PROBES":"",t.decodeVideoTexture?"#define DECODE_VIDEO_TEXTURE":"",t.decodeVideoTextureEmissive?"#define DECODE_VIDEO_TEXTURE_EMISSIVE":"",t.logarithmicDepthBuffer?"#define USE_LOGARITHMIC_DEPTH_BUFFER":"",t.reversedDepthBuffer?"#define USE_REVERSED_DEPTH_BUFFER":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;",t.toneMapping!==ol?"#define TONE_MAPPING":"",t.toneMapping!==ol?Gn.tonemapping_pars_fragment:"",t.toneMapping!==ol?pq("toneMapping",t.toneMapping):"",t.dithering?"#define DITHERING":"",t.opaque?"#define OPAQUE":"",Gn.colorspace_pars_fragment,fq("linearToOutputTexel",t.outputColorSpace),mq(),t.useDepthPacking?"#define DEPTH_PACKING "+t.depthPacking:"",`
`].filter(yv).join(`
`)),o=kT(o),o=YD(o,t),o=JD(o,t),u=kT(u),u=YD(u,t),u=JD(u,t),o=KD(o),u=KD(u),t.isRawShaderMaterial!==!0&&(N=`#version 300 es
`,w=[x,"#define attribute in","#define varying out","#define texture2D texture"].join(`
`)+`
`+w,T=["#define varying in",t.glslVersion===RT?"":"layout(location = 0) out highp vec4 pc_fragColor;",t.glslVersion===RT?"":"#define gl_FragColor pc_fragColor","#define gl_FragDepthEXT gl_FragDepth","#define texture2D texture","#define textureCube texture","#define texture2DProj textureProj","#define texture2DLodEXT textureLod","#define texture2DProjLodEXT textureProjLod","#define textureCubeLodEXT textureLod","#define texture2DGradEXT textureGrad","#define texture2DProjGradEXT textureProjGrad","#define textureCubeGradEXT textureGrad"].join(`
`)+`
`+T);const L=N+w+o,F=N+T+u,G=WD(r,r.VERTEX_SHADER,L),k=WD(r,r.FRAGMENT_SHADER,F);r.attachShader(C,G),r.attachShader(C,k),t.index0AttributeName!==void 0?r.bindAttribLocation(C,0,t.index0AttributeName):t.morphTargets===!0&&r.bindAttribLocation(C,0,"position"),r.linkProgram(C);function O(z){if(i.debug.checkShaderErrors){const Y=r.getProgramInfoLog(C)||"",j=r.getShaderInfoLog(G)||"",ce=r.getShaderInfoLog(k)||"",fe=Y.trim(),te=j.trim(),se=ce.trim();let Ae=!0,Pe=!0;if(r.getProgramParameter(C,r.LINK_STATUS)===!1)if(Ae=!1,typeof i.debug.onShaderError=="function")i.debug.onShaderError(r,C,G,k);else{const Re=XD(r,G,"vertex"),$=XD(r,k,"fragment");cn("THREE.WebGLProgram: Shader Error "+r.getError()+" - VALIDATE_STATUS "+r.getProgramParameter(C,r.VALIDATE_STATUS)+`

Material Name: `+z.name+`
Material Type: `+z.type+`

Program Info Log: `+fe+`
`+Re+`
`+$)}else fe!==""?Ht("WebGLProgram: Program Info Log:",fe):(te===""||se==="")&&(Pe=!1);Pe&&(z.diagnostics={runnable:Ae,programLog:fe,vertexShader:{log:te,prefix:w},fragmentShader:{log:se,prefix:T}})}r.deleteShader(G),r.deleteShader(k),D=new gb(r,C),R=yq(r,C)}let D;this.getUniforms=function(){return D===void 0&&O(this),D};let R;this.getAttributes=function(){return R===void 0&&O(this),R};let P=t.rendererExtensionParallelShaderCompile===!1;return this.isReady=function(){return P===!1&&(P=r.getProgramParameter(C,lq)),P},this.destroy=function(){n.releaseStatesOfProgram(this),r.deleteProgram(C),this.program=void 0},this.type=t.shaderType,this.name=t.shaderName,this.id=cq++,this.cacheKey=e,this.usedTimes=1,this.program=C,this.vertexShader=G,this.fragmentShader=k,this}let Bq=0;class Lq{constructor(){this.shaderCache=new Map,this.materialCache=new Map}update(e){const t=e.vertexShader,n=e.fragmentShader,r=this._getShaderStage(t),s=this._getShaderStage(n),o=this._getShaderCacheForMaterial(e);return o.has(r)===!1&&(o.add(r),r.usedTimes++),o.has(s)===!1&&(o.add(s),s.usedTimes++),this}remove(e){const t=this.materialCache.get(e);for(const n of t)n.usedTimes--,n.usedTimes===0&&this.shaderCache.delete(n.code);return this.materialCache.delete(e),this}getVertexShaderID(e){return this._getShaderStage(e.vertexShader).id}getFragmentShaderID(e){return this._getShaderStage(e.fragmentShader).id}dispose(){this.shaderCache.clear(),this.materialCache.clear()}_getShaderCacheForMaterial(e){const t=this.materialCache;let n=t.get(e);return n===void 0&&(n=new Set,t.set(e,n)),n}_getShaderStage(e){const t=this.shaderCache;let n=t.get(e);return n===void 0&&(n=new Oq(e),t.set(e,n)),n}}class Oq{constructor(e){this.id=Bq++,this.code=e,this.usedTimes=0}}function Uq(i,e,t,n,r,s,o){const u=new dg,f=new Lq,p=new Set,g=[],v=new Map,_=r.logarithmicDepthBuffer;let x=r.precision;const E={MeshDepthMaterial:"depth",MeshDistanceMaterial:"distance",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",MeshToonMaterial:"toon",MeshStandardMaterial:"physical",MeshPhysicalMaterial:"physical",MeshMatcapMaterial:"matcap",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointsMaterial:"points",ShadowMaterial:"shadow",SpriteMaterial:"sprite"};function C(R){return p.add(R),R===0?"uv":`uv${R}`}function w(R,P,z,Y,j){const ce=Y.fog,fe=j.geometry,te=R.isMeshStandardMaterial?Y.environment:null,se=(R.isMeshStandardMaterial?t:e).get(R.envMap||te),Ae=se&&se.mapping===Mg?se.image.height:null,Pe=E[R.type];R.precision!==null&&(x=r.getMaxPrecision(R.precision),x!==R.precision&&Ht("WebGLProgram.getParameters:",R.precision,"not supported, using",x,"instead."));const Re=fe.morphAttributes.position||fe.morphAttributes.normal||fe.morphAttributes.color,$=Re!==void 0?Re.length:0;let ae=0;fe.morphAttributes.position!==void 0&&(ae=1),fe.morphAttributes.normal!==void 0&&(ae=2),fe.morphAttributes.color!==void 0&&(ae=3);let Se,ke,dt,ve;if(Pe){const yn=Ul[Pe];Se=yn.vertexShader,ke=yn.fragmentShader}else Se=R.vertexShader,ke=R.fragmentShader,f.update(R),dt=f.getVertexShaderID(R),ve=f.getFragmentShaderID(R);const Le=i.getRenderTarget(),lt=i.state.buffers.depth.getReversed(),_t=j.isInstancedMesh===!0,Dt=j.isBatchedMesh===!0,qt=!!R.map,un=!!R.matcap,Yt=!!se,qe=!!R.aoMap,rt=!!R.lightMap,Je=!!R.bumpMap,xt=!!R.normalMap,re=!!R.displacementMap,Lt=!!R.emissiveMap,vt=!!R.metalnessMap,Qt=!!R.roughnessMap,bt=R.anisotropy>0,ee=R.clearcoat>0,q=R.dispersion>0,ge=R.iridescence>0,Fe=R.sheen>0,Xe=R.transmission>0,Ue=bt&&!!R.anisotropyMap,Ft=ee&&!!R.clearcoatMap,Ct=ee&&!!R.clearcoatNormalMap,Xt=ee&&!!R.clearcoatRoughnessMap,an=ge&&!!R.iridescenceMap,tt=ge&&!!R.iridescenceThicknessMap,it=Fe&&!!R.sheenColorMap,Ut=Fe&&!!R.sheenRoughnessMap,oe=!!R.specularMap,Te=!!R.specularColorMap,ot=!!R.specularIntensityMap,ue=Xe&&!!R.transmissionMap,Ce=Xe&&!!R.thicknessMap,at=!!R.gradientMap,gt=!!R.alphaMap,ut=R.alphaTest>0,Ye=!!R.alphaHash,pt=!!R.extensions;let rn=ol;R.toneMapped&&(Le===null||Le.isXRRenderTarget===!0)&&(rn=i.toneMapping);const Tn={shaderID:Pe,shaderType:R.type,shaderName:R.name,vertexShader:Se,fragmentShader:ke,defines:R.defines,customVertexShaderID:dt,customFragmentShaderID:ve,isRawShaderMaterial:R.isRawShaderMaterial===!0,glslVersion:R.glslVersion,precision:x,batching:Dt,batchingColor:Dt&&j._colorsTexture!==null,instancing:_t,instancingColor:_t&&j.instanceColor!==null,instancingMorph:_t&&j.morphTexture!==null,outputColorSpace:Le===null?i.outputColorSpace:Le.isXRRenderTarget===!0?Le.texture.colorSpace:Xl,alphaToCoverage:!!R.alphaToCoverage,map:qt,matcap:un,envMap:Yt,envMapMode:Yt&&se.mapping,envMapCubeUVHeight:Ae,aoMap:qe,lightMap:rt,bumpMap:Je,normalMap:xt,displacementMap:re,emissiveMap:Lt,normalMapObjectSpace:xt&&R.normalMapType===GB,normalMapTangentSpace:xt&&R.normalMapType===Ef,metalnessMap:vt,roughnessMap:Qt,anisotropy:bt,anisotropyMap:Ue,clearcoat:ee,clearcoatMap:Ft,clearcoatNormalMap:Ct,clearcoatRoughnessMap:Xt,dispersion:q,iridescence:ge,iridescenceMap:an,iridescenceThicknessMap:tt,sheen:Fe,sheenColorMap:it,sheenRoughnessMap:Ut,specularMap:oe,specularColorMap:Te,specularIntensityMap:ot,transmission:Xe,transmissionMap:ue,thicknessMap:Ce,gradientMap:at,opaque:R.transparent===!1&&R.blending===Hd&&R.alphaToCoverage===!1,alphaMap:gt,alphaTest:ut,alphaHash:Ye,combine:R.combine,mapUv:qt&&C(R.map.channel),aoMapUv:qe&&C(R.aoMap.channel),lightMapUv:rt&&C(R.lightMap.channel),bumpMapUv:Je&&C(R.bumpMap.channel),normalMapUv:xt&&C(R.normalMap.channel),displacementMapUv:re&&C(R.displacementMap.channel),emissiveMapUv:Lt&&C(R.emissiveMap.channel),metalnessMapUv:vt&&C(R.metalnessMap.channel),roughnessMapUv:Qt&&C(R.roughnessMap.channel),anisotropyMapUv:Ue&&C(R.anisotropyMap.channel),clearcoatMapUv:Ft&&C(R.clearcoatMap.channel),clearcoatNormalMapUv:Ct&&C(R.clearcoatNormalMap.channel),clearcoatRoughnessMapUv:Xt&&C(R.clearcoatRoughnessMap.channel),iridescenceMapUv:an&&C(R.iridescenceMap.channel),iridescenceThicknessMapUv:tt&&C(R.iridescenceThicknessMap.channel),sheenColorMapUv:it&&C(R.sheenColorMap.channel),sheenRoughnessMapUv:Ut&&C(R.sheenRoughnessMap.channel),specularMapUv:oe&&C(R.specularMap.channel),specularColorMapUv:Te&&C(R.specularColorMap.channel),specularIntensityMapUv:ot&&C(R.specularIntensityMap.channel),transmissionMapUv:ue&&C(R.transmissionMap.channel),thicknessMapUv:Ce&&C(R.thicknessMap.channel),alphaMapUv:gt&&C(R.alphaMap.channel),vertexTangents:!!fe.attributes.tangent&&(xt||bt),vertexColors:R.vertexColors,vertexAlphas:R.vertexColors===!0&&!!fe.attributes.color&&fe.attributes.color.itemSize===4,pointsUvs:j.isPoints===!0&&!!fe.attributes.uv&&(qt||gt),fog:!!ce,useFog:R.fog===!0,fogExp2:!!ce&&ce.isFogExp2,flatShading:R.flatShading===!0&&R.wireframe===!1,sizeAttenuation:R.sizeAttenuation===!0,logarithmicDepthBuffer:_,reversedDepthBuffer:lt,skinning:j.isSkinnedMesh===!0,morphTargets:fe.morphAttributes.position!==void 0,morphNormals:fe.morphAttributes.normal!==void 0,morphColors:fe.morphAttributes.color!==void 0,morphTargetsCount:$,morphTextureStride:ae,numDirLights:P.directional.length,numPointLights:P.point.length,numSpotLights:P.spot.length,numSpotLightMaps:P.spotLightMap.length,numRectAreaLights:P.rectArea.length,numHemiLights:P.hemi.length,numDirLightShadows:P.directionalShadowMap.length,numPointLightShadows:P.pointShadowMap.length,numSpotLightShadows:P.spotShadowMap.length,numSpotLightShadowsWithMaps:P.numSpotLightShadowsWithMaps,numLightProbes:P.numLightProbes,numClippingPlanes:o.numPlanes,numClipIntersection:o.numIntersection,dithering:R.dithering,shadowMapEnabled:i.shadowMap.enabled&&z.length>0,shadowMapType:i.shadowMap.type,toneMapping:rn,decodeVideoTexture:qt&&R.map.isVideoTexture===!0&&oi.getTransfer(R.map.colorSpace)===wi,decodeVideoTextureEmissive:Lt&&R.emissiveMap.isVideoTexture===!0&&oi.getTransfer(R.emissiveMap.colorSpace)===wi,premultipliedAlpha:R.premultipliedAlpha,doubleSided:R.side===yo,flipSided:R.side===Ca,useDepthPacking:R.depthPacking>=0,depthPacking:R.depthPacking||0,index0AttributeName:R.index0AttributeName,extensionClipCullDistance:pt&&R.extensions.clipCullDistance===!0&&n.has("WEBGL_clip_cull_distance"),extensionMultiDraw:(pt&&R.extensions.multiDraw===!0||Dt)&&n.has("WEBGL_multi_draw"),rendererExtensionParallelShaderCompile:n.has("KHR_parallel_shader_compile"),customProgramCacheKey:R.customProgramCacheKey()};return Tn.vertexUv1s=p.has(1),Tn.vertexUv2s=p.has(2),Tn.vertexUv3s=p.has(3),p.clear(),Tn}function T(R){const P=[];if(R.shaderID?P.push(R.shaderID):(P.push(R.customVertexShaderID),P.push(R.customFragmentShaderID)),R.defines!==void 0)for(const z in R.defines)P.push(z),P.push(R.defines[z]);return R.isRawShaderMaterial===!1&&(N(P,R),L(P,R),P.push(i.outputColorSpace)),P.push(R.customProgramCacheKey),P.join()}function N(R,P){R.push(P.precision),R.push(P.outputColorSpace),R.push(P.envMapMode),R.push(P.envMapCubeUVHeight),R.push(P.mapUv),R.push(P.alphaMapUv),R.push(P.lightMapUv),R.push(P.aoMapUv),R.push(P.bumpMapUv),R.push(P.normalMapUv),R.push(P.displacementMapUv),R.push(P.emissiveMapUv),R.push(P.metalnessMapUv),R.push(P.roughnessMapUv),R.push(P.anisotropyMapUv),R.push(P.clearcoatMapUv),R.push(P.clearcoatNormalMapUv),R.push(P.clearcoatRoughnessMapUv),R.push(P.iridescenceMapUv),R.push(P.iridescenceThicknessMapUv),R.push(P.sheenColorMapUv),R.push(P.sheenRoughnessMapUv),R.push(P.specularMapUv),R.push(P.specularColorMapUv),R.push(P.specularIntensityMapUv),R.push(P.transmissionMapUv),R.push(P.thicknessMapUv),R.push(P.combine),R.push(P.fogExp2),R.push(P.sizeAttenuation),R.push(P.morphTargetsCount),R.push(P.morphAttributeCount),R.push(P.numDirLights),R.push(P.numPointLights),R.push(P.numSpotLights),R.push(P.numSpotLightMaps),R.push(P.numHemiLights),R.push(P.numRectAreaLights),R.push(P.numDirLightShadows),R.push(P.numPointLightShadows),R.push(P.numSpotLightShadows),R.push(P.numSpotLightShadowsWithMaps),R.push(P.numLightProbes),R.push(P.shadowMapType),R.push(P.toneMapping),R.push(P.numClippingPlanes),R.push(P.numClipIntersection),R.push(P.depthPacking)}function L(R,P){u.disableAll(),P.instancing&&u.enable(0),P.instancingColor&&u.enable(1),P.instancingMorph&&u.enable(2),P.matcap&&u.enable(3),P.envMap&&u.enable(4),P.normalMapObjectSpace&&u.enable(5),P.normalMapTangentSpace&&u.enable(6),P.clearcoat&&u.enable(7),P.iridescence&&u.enable(8),P.alphaTest&&u.enable(9),P.vertexColors&&u.enable(10),P.vertexAlphas&&u.enable(11),P.vertexUv1s&&u.enable(12),P.vertexUv2s&&u.enable(13),P.vertexUv3s&&u.enable(14),P.vertexTangents&&u.enable(15),P.anisotropy&&u.enable(16),P.alphaHash&&u.enable(17),P.batching&&u.enable(18),P.dispersion&&u.enable(19),P.batchingColor&&u.enable(20),P.gradientMap&&u.enable(21),R.push(u.mask),u.disableAll(),P.fog&&u.enable(0),P.useFog&&u.enable(1),P.flatShading&&u.enable(2),P.logarithmicDepthBuffer&&u.enable(3),P.reversedDepthBuffer&&u.enable(4),P.skinning&&u.enable(5),P.morphTargets&&u.enable(6),P.morphNormals&&u.enable(7),P.morphColors&&u.enable(8),P.premultipliedAlpha&&u.enable(9),P.shadowMapEnabled&&u.enable(10),P.doubleSided&&u.enable(11),P.flipSided&&u.enable(12),P.useDepthPacking&&u.enable(13),P.dithering&&u.enable(14),P.transmission&&u.enable(15),P.sheen&&u.enable(16),P.opaque&&u.enable(17),P.pointsUvs&&u.enable(18),P.decodeVideoTexture&&u.enable(19),P.decodeVideoTextureEmissive&&u.enable(20),P.alphaToCoverage&&u.enable(21),R.push(u.mask)}function F(R){const P=E[R.type];let z;if(P){const Y=Ul[P];z=iL.clone(Y.uniforms)}else z=R.uniforms;return z}function G(R,P){let z=v.get(P);return z!==void 0?++z.usedTimes:(z=new Pq(i,P,R,s),g.push(z),v.set(P,z)),z}function k(R){if(--R.usedTimes===0){const P=g.indexOf(R);g[P]=g[g.length-1],g.pop(),v.delete(R.cacheKey),R.destroy()}}function O(R){f.remove(R)}function D(){f.dispose()}return{getParameters:w,getProgramCacheKey:T,getUniforms:F,acquireProgram:G,releaseProgram:k,releaseShaderCache:O,programs:g,dispose:D}}function Fq(){let i=new WeakMap;function e(o){return i.has(o)}function t(o){let u=i.get(o);return u===void 0&&(u={},i.set(o,u)),u}function n(o){i.delete(o)}function r(o,u,f){i.get(o)[u]=f}function s(){i=new WeakMap}return{has:e,get:t,remove:n,update:r,dispose:s}}function kq(i,e){return i.groupOrder!==e.groupOrder?i.groupOrder-e.groupOrder:i.renderOrder!==e.renderOrder?i.renderOrder-e.renderOrder:i.material.id!==e.material.id?i.material.id-e.material.id:i.z!==e.z?i.z-e.z:i.id-e.id}function ZD(i,e){return i.groupOrder!==e.groupOrder?i.groupOrder-e.groupOrder:i.renderOrder!==e.renderOrder?i.renderOrder-e.renderOrder:i.z!==e.z?e.z-i.z:i.id-e.id}function $D(){const i=[];let e=0;const t=[],n=[],r=[];function s(){e=0,t.length=0,n.length=0,r.length=0}function o(v,_,x,E,C,w){let T=i[e];return T===void 0?(T={id:v.id,object:v,geometry:_,material:x,groupOrder:E,renderOrder:v.renderOrder,z:C,group:w},i[e]=T):(T.id=v.id,T.object=v,T.geometry=_,T.material=x,T.groupOrder=E,T.renderOrder=v.renderOrder,T.z=C,T.group=w),e++,T}function u(v,_,x,E,C,w){const T=o(v,_,x,E,C,w);x.transmission>0?n.push(T):x.transparent===!0?r.push(T):t.push(T)}function f(v,_,x,E,C,w){const T=o(v,_,x,E,C,w);x.transmission>0?n.unshift(T):x.transparent===!0?r.unshift(T):t.unshift(T)}function p(v,_){t.length>1&&t.sort(v||kq),n.length>1&&n.sort(_||ZD),r.length>1&&r.sort(_||ZD)}function g(){for(let v=e,_=i.length;v<_;v++){const x=i[v];if(x.id===null)break;x.id=null,x.object=null,x.geometry=null,x.material=null,x.group=null}}return{opaque:t,transmissive:n,transparent:r,init:s,push:u,unshift:f,finish:g,sort:p}}function zq(){let i=new WeakMap;function e(n,r){const s=i.get(n);let o;return s===void 0?(o=new $D,i.set(n,[o])):r>=s.length?(o=new $D,s.push(o)):o=s[r],o}function t(){i=new WeakMap}return{get:e,dispose:t}}function Vq(){const i={};return{get:function(e){if(i[e.id]!==void 0)return i[e.id];let t;switch(e.type){case"DirectionalLight":t={direction:new ie,color:new Gt};break;case"SpotLight":t={position:new ie,direction:new ie,color:new Gt,distance:0,coneCos:0,penumbraCos:0,decay:0};break;case"PointLight":t={position:new ie,color:new Gt,distance:0,decay:0};break;case"HemisphereLight":t={direction:new ie,skyColor:new Gt,groundColor:new Gt};break;case"RectAreaLight":t={color:new Gt,position:new ie,halfWidth:new ie,halfHeight:new ie};break}return i[e.id]=t,t}}}function Hq(){const i={};return{get:function(e){if(i[e.id]!==void 0)return i[e.id];let t;switch(e.type){case"DirectionalLight":t={shadowIntensity:1,shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new $e};break;case"SpotLight":t={shadowIntensity:1,shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new $e};break;case"PointLight":t={shadowIntensity:1,shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new $e,shadowCameraNear:1,shadowCameraFar:1e3};break}return i[e.id]=t,t}}}let Gq=0;function jq(i,e){return(e.castShadow?2:0)-(i.castShadow?2:0)+(e.map?1:0)-(i.map?1:0)}function Wq(i){const e=new Vq,t=Hq(),n={version:0,hash:{directionalLength:-1,pointLength:-1,spotLength:-1,rectAreaLength:-1,hemiLength:-1,numDirectionalShadows:-1,numPointShadows:-1,numSpotShadows:-1,numSpotMaps:-1,numLightProbes:-1},ambient:[0,0,0],probe:[],directional:[],directionalShadow:[],directionalShadowMap:[],directionalShadowMatrix:[],spot:[],spotLightMap:[],spotShadow:[],spotShadowMap:[],spotLightMatrix:[],rectArea:[],rectAreaLTC1:null,rectAreaLTC2:null,point:[],pointShadow:[],pointShadowMap:[],pointShadowMatrix:[],hemi:[],numSpotLightShadowsWithMaps:0,numLightProbes:0};for(let p=0;p<9;p++)n.probe.push(new ie);const r=new ie,s=new vn,o=new vn;function u(p){let g=0,v=0,_=0;for(let R=0;R<9;R++)n.probe[R].set(0,0,0);let x=0,E=0,C=0,w=0,T=0,N=0,L=0,F=0,G=0,k=0,O=0;p.sort(jq);for(let R=0,P=p.length;R<P;R++){const z=p[R],Y=z.color,j=z.intensity,ce=z.distance;let fe=null;if(z.shadow&&z.shadow.map&&(z.shadow.map.texture.format===Zd?fe=z.shadow.map.texture:fe=z.shadow.map.depthTexture||z.shadow.map.texture),z.isAmbientLight)g+=Y.r*j,v+=Y.g*j,_+=Y.b*j;else if(z.isLightProbe){for(let te=0;te<9;te++)n.probe[te].addScaledVector(z.sh.coefficients[te],j);O++}else if(z.isDirectionalLight){const te=e.get(z);if(te.color.copy(z.color).multiplyScalar(z.intensity),z.castShadow){const se=z.shadow,Ae=t.get(z);Ae.shadowIntensity=se.intensity,Ae.shadowBias=se.bias,Ae.shadowNormalBias=se.normalBias,Ae.shadowRadius=se.radius,Ae.shadowMapSize=se.mapSize,n.directionalShadow[x]=Ae,n.directionalShadowMap[x]=fe,n.directionalShadowMatrix[x]=z.shadow.matrix,N++}n.directional[x]=te,x++}else if(z.isSpotLight){const te=e.get(z);te.position.setFromMatrixPosition(z.matrixWorld),te.color.copy(Y).multiplyScalar(j),te.distance=ce,te.coneCos=Math.cos(z.angle),te.penumbraCos=Math.cos(z.angle*(1-z.penumbra)),te.decay=z.decay,n.spot[C]=te;const se=z.shadow;if(z.map&&(n.spotLightMap[G]=z.map,G++,se.updateMatrices(z),z.castShadow&&k++),n.spotLightMatrix[C]=se.matrix,z.castShadow){const Ae=t.get(z);Ae.shadowIntensity=se.intensity,Ae.shadowBias=se.bias,Ae.shadowNormalBias=se.normalBias,Ae.shadowRadius=se.radius,Ae.shadowMapSize=se.mapSize,n.spotShadow[C]=Ae,n.spotShadowMap[C]=fe,F++}C++}else if(z.isRectAreaLight){const te=e.get(z);te.color.copy(Y).multiplyScalar(j),te.halfWidth.set(z.width*.5,0,0),te.halfHeight.set(0,z.height*.5,0),n.rectArea[w]=te,w++}else if(z.isPointLight){const te=e.get(z);if(te.color.copy(z.color).multiplyScalar(z.intensity),te.distance=z.distance,te.decay=z.decay,z.castShadow){const se=z.shadow,Ae=t.get(z);Ae.shadowIntensity=se.intensity,Ae.shadowBias=se.bias,Ae.shadowNormalBias=se.normalBias,Ae.shadowRadius=se.radius,Ae.shadowMapSize=se.mapSize,Ae.shadowCameraNear=se.camera.near,Ae.shadowCameraFar=se.camera.far,n.pointShadow[E]=Ae,n.pointShadowMap[E]=fe,n.pointShadowMatrix[E]=z.shadow.matrix,L++}n.point[E]=te,E++}else if(z.isHemisphereLight){const te=e.get(z);te.skyColor.copy(z.color).multiplyScalar(j),te.groundColor.copy(z.groundColor).multiplyScalar(j),n.hemi[T]=te,T++}}w>0&&(i.has("OES_texture_float_linear")===!0?(n.rectAreaLTC1=Wt.LTC_FLOAT_1,n.rectAreaLTC2=Wt.LTC_FLOAT_2):(n.rectAreaLTC1=Wt.LTC_HALF_1,n.rectAreaLTC2=Wt.LTC_HALF_2)),n.ambient[0]=g,n.ambient[1]=v,n.ambient[2]=_;const D=n.hash;(D.directionalLength!==x||D.pointLength!==E||D.spotLength!==C||D.rectAreaLength!==w||D.hemiLength!==T||D.numDirectionalShadows!==N||D.numPointShadows!==L||D.numSpotShadows!==F||D.numSpotMaps!==G||D.numLightProbes!==O)&&(n.directional.length=x,n.spot.length=C,n.rectArea.length=w,n.point.length=E,n.hemi.length=T,n.directionalShadow.length=N,n.directionalShadowMap.length=N,n.pointShadow.length=L,n.pointShadowMap.length=L,n.spotShadow.length=F,n.spotShadowMap.length=F,n.directionalShadowMatrix.length=N,n.pointShadowMatrix.length=L,n.spotLightMatrix.length=F+G-k,n.spotLightMap.length=G,n.numSpotLightShadowsWithMaps=k,n.numLightProbes=O,D.directionalLength=x,D.pointLength=E,D.spotLength=C,D.rectAreaLength=w,D.hemiLength=T,D.numDirectionalShadows=N,D.numPointShadows=L,D.numSpotShadows=F,D.numSpotMaps=G,D.numLightProbes=O,n.version=Gq++)}function f(p,g){let v=0,_=0,x=0,E=0,C=0;const w=g.matrixWorldInverse;for(let T=0,N=p.length;T<N;T++){const L=p[T];if(L.isDirectionalLight){const F=n.directional[v];F.direction.setFromMatrixPosition(L.matrixWorld),r.setFromMatrixPosition(L.target.matrixWorld),F.direction.sub(r),F.direction.transformDirection(w),v++}else if(L.isSpotLight){const F=n.spot[x];F.position.setFromMatrixPosition(L.matrixWorld),F.position.applyMatrix4(w),F.direction.setFromMatrixPosition(L.matrixWorld),r.setFromMatrixPosition(L.target.matrixWorld),F.direction.sub(r),F.direction.transformDirection(w),x++}else if(L.isRectAreaLight){const F=n.rectArea[E];F.position.setFromMatrixPosition(L.matrixWorld),F.position.applyMatrix4(w),o.identity(),s.copy(L.matrixWorld),s.premultiply(w),o.extractRotation(s),F.halfWidth.set(L.width*.5,0,0),F.halfHeight.set(0,L.height*.5,0),F.halfWidth.applyMatrix4(o),F.halfHeight.applyMatrix4(o),E++}else if(L.isPointLight){const F=n.point[_];F.position.setFromMatrixPosition(L.matrixWorld),F.position.applyMatrix4(w),_++}else if(L.isHemisphereLight){const F=n.hemi[C];F.direction.setFromMatrixPosition(L.matrixWorld),F.direction.transformDirection(w),C++}}}return{setup:u,setupView:f,state:n}}function eN(i){const e=new Wq(i),t=[],n=[];function r(g){p.camera=g,t.length=0,n.length=0}function s(g){t.push(g)}function o(g){n.push(g)}function u(){e.setup(t)}function f(g){e.setupView(t,g)}const p={lightsArray:t,shadowsArray:n,camera:null,lights:e,transmissionRenderTarget:{}};return{init:r,state:p,setupLights:u,setupLightsView:f,pushLight:s,pushShadow:o}}function qq(i){let e=new WeakMap;function t(r,s=0){const o=e.get(r);let u;return o===void 0?(u=new eN(i),e.set(r,[u])):s>=o.length?(u=new eN(i),o.push(u)):u=o[s],u}function n(){e=new WeakMap}return{get:t,dispose:n}}const Xq=`void main() {
	gl_Position = vec4( position, 1.0 );
}`,Yq=`uniform sampler2D shadow_pass;
uniform vec2 resolution;
uniform float radius;
void main() {
	const float samples = float( VSM_SAMPLES );
	float mean = 0.0;
	float squared_mean = 0.0;
	float uvStride = samples <= 1.0 ? 0.0 : 2.0 / ( samples - 1.0 );
	float uvStart = samples <= 1.0 ? 0.0 : - 1.0;
	for ( float i = 0.0; i < samples; i ++ ) {
		float uvOffset = uvStart + i * uvStride;
		#ifdef HORIZONTAL_PASS
			vec2 distribution = texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( uvOffset, 0.0 ) * radius ) / resolution ).rg;
			mean += distribution.x;
			squared_mean += distribution.y * distribution.y + distribution.x * distribution.x;
		#else
			float depth = texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( 0.0, uvOffset ) * radius ) / resolution ).r;
			mean += depth;
			squared_mean += depth * depth;
		#endif
	}
	mean = mean / samples;
	squared_mean = squared_mean / samples;
	float std_dev = sqrt( max( 0.0, squared_mean - mean * mean ) );
	gl_FragColor = vec4( mean, std_dev, 0.0, 1.0 );
}`,Jq=[new ie(1,0,0),new ie(-1,0,0),new ie(0,1,0),new ie(0,-1,0),new ie(0,0,1),new ie(0,0,-1)],Kq=[new ie(0,-1,0),new ie(0,-1,0),new ie(0,0,1),new ie(0,0,-1),new ie(0,-1,0),new ie(0,-1,0)],tN=new vn,lv=new ie,I1=new ie;function Qq(i,e,t){let n=new wg;const r=new $e,s=new $e,o=new zi,u=new FS,f=new Tw,p={},g=t.maxTextureSize,v={[Gc]:Ca,[Ca]:Gc,[yo]:yo},_=new Gs({defines:{VSM_SAMPLES:8},uniforms:{shadow_pass:{value:null},resolution:{value:new $e},radius:{value:4}},vertexShader:Xq,fragmentShader:Yq}),x=_.clone();x.defines.HORIZONTAL_PASS=1;const E=new wn;E.setAttribute("position",new gi(new Float32Array([-1,-1,.5,3,-1,.5,-1,3,.5]),3));const C=new rr(E,_),w=this;this.enabled=!1,this.autoUpdate=!0,this.needsUpdate=!1,this.type=Wm;let T=this.type;this.render=function(k,O,D){if(w.enabled===!1||w.autoUpdate===!1&&w.needsUpdate===!1||k.length===0)return;k.type===Tv&&(Ht("WebGLShadowMap: PCFSoftShadowMap has been deprecated. Using PCFShadowMap instead."),k.type=Wm);const R=i.getRenderTarget(),P=i.getActiveCubeFace(),z=i.getActiveMipmapLevel(),Y=i.state;Y.setBlending(Gl),Y.buffers.depth.getReversed()===!0?Y.buffers.color.setClear(0,0,0,0):Y.buffers.color.setClear(1,1,1,1),Y.buffers.depth.setTest(!0),Y.setScissorTest(!1);const j=T!==this.type;j&&O.traverse(function(ce){ce.material&&(Array.isArray(ce.material)?ce.material.forEach(fe=>fe.needsUpdate=!0):ce.material.needsUpdate=!0)});for(let ce=0,fe=k.length;ce<fe;ce++){const te=k[ce],se=te.shadow;if(se===void 0){Ht("WebGLShadowMap:",te,"has no shadow.");continue}if(se.autoUpdate===!1&&se.needsUpdate===!1)continue;r.copy(se.mapSize);const Ae=se.getFrameExtents();if(r.multiply(Ae),s.copy(se.mapSize),(r.x>g||r.y>g)&&(r.x>g&&(s.x=Math.floor(g/Ae.x),r.x=s.x*Ae.x,se.mapSize.x=s.x),r.y>g&&(s.y=Math.floor(g/Ae.y),r.y=s.y*Ae.y,se.mapSize.y=s.y)),se.map===null||j===!0){if(se.map!==null&&(se.map.depthTexture!==null&&(se.map.depthTexture.dispose(),se.map.depthTexture=null),se.map.dispose()),this.type===Nd){if(te.isPointLight){Ht("WebGLShadowMap: VSM shadow maps are not supported for PointLights. Use PCF or BasicShadowMap instead.");continue}se.map=new _s(r.x,r.y,{format:Zd,type:Er,minFilter:Jn,magFilter:Jn,generateMipmaps:!1}),se.map.texture.name=te.name+".shadowMap",se.map.depthTexture=new ep(r.x,r.y,ir),se.map.depthTexture.name=te.name+".shadowMapDepth",se.map.depthTexture.format=jc,se.map.depthTexture.compareFunction=null,se.map.depthTexture.minFilter=Pr,se.map.depthTexture.magFilter=Pr}else{te.isPointLight?(se.map=new _S(r.x),se.map.depthTexture=new uL(r.x,So)):(se.map=new _s(r.x,r.y),se.map.depthTexture=new ep(r.x,r.y,So)),se.map.depthTexture.name=te.name+".shadowMap",se.map.depthTexture.format=jc;const Re=i.state.buffers.depth.getReversed();this.type===Wm?(se.map.depthTexture.compareFunction=Re?mS:pS,se.map.depthTexture.minFilter=Jn,se.map.depthTexture.magFilter=Jn):(se.map.depthTexture.compareFunction=null,se.map.depthTexture.minFilter=Pr,se.map.depthTexture.magFilter=Pr)}se.camera.updateProjectionMatrix()}const Pe=se.map.isWebGLCubeRenderTarget?6:1;for(let Re=0;Re<Pe;Re++){if(se.map.isWebGLCubeRenderTarget)i.setRenderTarget(se.map,Re),i.clear();else{Re===0&&(i.setRenderTarget(se.map),i.clear());const $=se.getViewport(Re);o.set(s.x*$.x,s.y*$.y,s.x*$.z,s.y*$.w),Y.viewport(o)}if(te.isPointLight){const $=se.camera,ae=se.matrix,Se=te.distance||$.far;Se!==$.far&&($.far=Se,$.updateProjectionMatrix()),lv.setFromMatrixPosition(te.matrixWorld),$.position.copy(lv),I1.copy($.position),I1.add(Jq[Re]),$.up.copy(Kq[Re]),$.lookAt(I1),$.updateMatrixWorld(),ae.makeTranslation(-lv.x,-lv.y,-lv.z),tN.multiplyMatrices($.projectionMatrix,$.matrixWorldInverse),se._frustum.setFromProjectionMatrix(tN,$.coordinateSystem,$.reversedDepth)}else se.updateMatrices(te);n=se.getFrustum(),F(O,D,se.camera,te,this.type)}se.isPointLightShadow!==!0&&this.type===Nd&&N(se,D),se.needsUpdate=!1}T=this.type,w.needsUpdate=!1,i.setRenderTarget(R,P,z)};function N(k,O){const D=e.update(C);_.defines.VSM_SAMPLES!==k.blurSamples&&(_.defines.VSM_SAMPLES=k.blurSamples,x.defines.VSM_SAMPLES=k.blurSamples,_.needsUpdate=!0,x.needsUpdate=!0),k.mapPass===null&&(k.mapPass=new _s(r.x,r.y,{format:Zd,type:Er})),_.uniforms.shadow_pass.value=k.map.depthTexture,_.uniforms.resolution.value=k.mapSize,_.uniforms.radius.value=k.radius,i.setRenderTarget(k.mapPass),i.clear(),i.renderBufferDirect(O,null,D,_,C,null),x.uniforms.shadow_pass.value=k.mapPass.texture,x.uniforms.resolution.value=k.mapSize,x.uniforms.radius.value=k.radius,i.setRenderTarget(k.map),i.clear(),i.renderBufferDirect(O,null,D,x,C,null)}function L(k,O,D,R){let P=null;const z=D.isPointLight===!0?k.customDistanceMaterial:k.customDepthMaterial;if(z!==void 0)P=z;else if(P=D.isPointLight===!0?f:u,i.localClippingEnabled&&O.clipShadows===!0&&Array.isArray(O.clippingPlanes)&&O.clippingPlanes.length!==0||O.displacementMap&&O.displacementScale!==0||O.alphaMap&&O.alphaTest>0||O.map&&O.alphaTest>0||O.alphaToCoverage===!0){const Y=P.uuid,j=O.uuid;let ce=p[Y];ce===void 0&&(ce={},p[Y]=ce);let fe=ce[j];fe===void 0&&(fe=P.clone(),ce[j]=fe,O.addEventListener("dispose",G)),P=fe}if(P.visible=O.visible,P.wireframe=O.wireframe,R===Nd?P.side=O.shadowSide!==null?O.shadowSide:O.side:P.side=O.shadowSide!==null?O.shadowSide:v[O.side],P.alphaMap=O.alphaMap,P.alphaTest=O.alphaToCoverage===!0?.5:O.alphaTest,P.map=O.map,P.clipShadows=O.clipShadows,P.clippingPlanes=O.clippingPlanes,P.clipIntersection=O.clipIntersection,P.displacementMap=O.displacementMap,P.displacementScale=O.displacementScale,P.displacementBias=O.displacementBias,P.wireframeLinewidth=O.wireframeLinewidth,P.linewidth=O.linewidth,D.isPointLight===!0&&P.isMeshDistanceMaterial===!0){const Y=i.properties.get(P);Y.light=D}return P}function F(k,O,D,R,P){if(k.visible===!1)return;if(k.layers.test(O.layers)&&(k.isMesh||k.isLine||k.isPoints)&&(k.castShadow||k.receiveShadow&&P===Nd)&&(!k.frustumCulled||n.intersectsObject(k))){k.modelViewMatrix.multiplyMatrices(D.matrixWorldInverse,k.matrixWorld);const j=e.update(k),ce=k.material;if(Array.isArray(ce)){const fe=j.groups;for(let te=0,se=fe.length;te<se;te++){const Ae=fe[te],Pe=ce[Ae.materialIndex];if(Pe&&Pe.visible){const Re=L(k,Pe,R,P);k.onBeforeShadow(i,k,O,D,j,Re,Ae),i.renderBufferDirect(D,null,j,Re,k,Ae),k.onAfterShadow(i,k,O,D,j,Re,Ae)}}}else if(ce.visible){const fe=L(k,ce,R,P);k.onBeforeShadow(i,k,O,D,j,fe,null),i.renderBufferDirect(D,null,j,fe,k,null),k.onAfterShadow(i,k,O,D,j,fe,null)}}const Y=k.children;for(let j=0,ce=Y.length;j<ce;j++)F(Y[j],O,D,R,P)}function G(k){k.target.removeEventListener("dispose",G);for(const D in p){const R=p[D],P=k.target.uuid;P in R&&(R[P].dispose(),delete R[P])}}}const Zq={[kb]:zb,[Vb]:jb,[Hb]:Wb,[Qd]:Gb,[zb]:kb,[jb]:Vb,[Wb]:Hb,[Gb]:Qd};function $q(i,e){function t(){let ue=!1;const Ce=new zi;let at=null;const gt=new zi(0,0,0,0);return{setMask:function(ut){at!==ut&&!ue&&(i.colorMask(ut,ut,ut,ut),at=ut)},setLocked:function(ut){ue=ut},setClear:function(ut,Ye,pt,rn,Tn){Tn===!0&&(ut*=rn,Ye*=rn,pt*=rn),Ce.set(ut,Ye,pt,rn),gt.equals(Ce)===!1&&(i.clearColor(ut,Ye,pt,rn),gt.copy(Ce))},reset:function(){ue=!1,at=null,gt.set(-1,0,0,0)}}}function n(){let ue=!1,Ce=!1,at=null,gt=null,ut=null;return{setReversed:function(Ye){if(Ce!==Ye){const pt=e.get("EXT_clip_control");Ye?pt.clipControlEXT(pt.LOWER_LEFT_EXT,pt.ZERO_TO_ONE_EXT):pt.clipControlEXT(pt.LOWER_LEFT_EXT,pt.NEGATIVE_ONE_TO_ONE_EXT),Ce=Ye;const rn=ut;ut=null,this.setClear(rn)}},getReversed:function(){return Ce},setTest:function(Ye){Ye?Le(i.DEPTH_TEST):lt(i.DEPTH_TEST)},setMask:function(Ye){at!==Ye&&!ue&&(i.depthMask(Ye),at=Ye)},setFunc:function(Ye){if(Ce&&(Ye=Zq[Ye]),gt!==Ye){switch(Ye){case kb:i.depthFunc(i.NEVER);break;case zb:i.depthFunc(i.ALWAYS);break;case Vb:i.depthFunc(i.LESS);break;case Qd:i.depthFunc(i.LEQUAL);break;case Hb:i.depthFunc(i.EQUAL);break;case Gb:i.depthFunc(i.GEQUAL);break;case jb:i.depthFunc(i.GREATER);break;case Wb:i.depthFunc(i.NOTEQUAL);break;default:i.depthFunc(i.LEQUAL)}gt=Ye}},setLocked:function(Ye){ue=Ye},setClear:function(Ye){ut!==Ye&&(Ce&&(Ye=1-Ye),i.clearDepth(Ye),ut=Ye)},reset:function(){ue=!1,at=null,gt=null,ut=null,Ce=!1}}}function r(){let ue=!1,Ce=null,at=null,gt=null,ut=null,Ye=null,pt=null,rn=null,Tn=null;return{setTest:function(yn){ue||(yn?Le(i.STENCIL_TEST):lt(i.STENCIL_TEST))},setMask:function(yn){Ce!==yn&&!ue&&(i.stencilMask(yn),Ce=yn)},setFunc:function(yn,Ii,Xi){(at!==yn||gt!==Ii||ut!==Xi)&&(i.stencilFunc(yn,Ii,Xi),at=yn,gt=Ii,ut=Xi)},setOp:function(yn,Ii,Xi){(Ye!==yn||pt!==Ii||rn!==Xi)&&(i.stencilOp(yn,Ii,Xi),Ye=yn,pt=Ii,rn=Xi)},setLocked:function(yn){ue=yn},setClear:function(yn){Tn!==yn&&(i.clearStencil(yn),Tn=yn)},reset:function(){ue=!1,Ce=null,at=null,gt=null,ut=null,Ye=null,pt=null,rn=null,Tn=null}}}const s=new t,o=new n,u=new r,f=new WeakMap,p=new WeakMap;let g={},v={},_=new WeakMap,x=[],E=null,C=!1,w=null,T=null,N=null,L=null,F=null,G=null,k=null,O=new Gt(0,0,0),D=0,R=!1,P=null,z=null,Y=null,j=null,ce=null;const fe=i.getParameter(i.MAX_COMBINED_TEXTURE_IMAGE_UNITS);let te=!1,se=0;const Ae=i.getParameter(i.VERSION);Ae.indexOf("WebGL")!==-1?(se=parseFloat(/^WebGL (\d)/.exec(Ae)[1]),te=se>=1):Ae.indexOf("OpenGL ES")!==-1&&(se=parseFloat(/^OpenGL ES (\d)/.exec(Ae)[1]),te=se>=2);let Pe=null,Re={};const $=i.getParameter(i.SCISSOR_BOX),ae=i.getParameter(i.VIEWPORT),Se=new zi().fromArray($),ke=new zi().fromArray(ae);function dt(ue,Ce,at,gt){const ut=new Uint8Array(4),Ye=i.createTexture();i.bindTexture(ue,Ye),i.texParameteri(ue,i.TEXTURE_MIN_FILTER,i.NEAREST),i.texParameteri(ue,i.TEXTURE_MAG_FILTER,i.NEAREST);for(let pt=0;pt<at;pt++)ue===i.TEXTURE_3D||ue===i.TEXTURE_2D_ARRAY?i.texImage3D(Ce,0,i.RGBA,1,1,gt,0,i.RGBA,i.UNSIGNED_BYTE,ut):i.texImage2D(Ce+pt,0,i.RGBA,1,1,0,i.RGBA,i.UNSIGNED_BYTE,ut);return Ye}const ve={};ve[i.TEXTURE_2D]=dt(i.TEXTURE_2D,i.TEXTURE_2D,1),ve[i.TEXTURE_CUBE_MAP]=dt(i.TEXTURE_CUBE_MAP,i.TEXTURE_CUBE_MAP_POSITIVE_X,6),ve[i.TEXTURE_2D_ARRAY]=dt(i.TEXTURE_2D_ARRAY,i.TEXTURE_2D_ARRAY,1,1),ve[i.TEXTURE_3D]=dt(i.TEXTURE_3D,i.TEXTURE_3D,1,1),s.setClear(0,0,0,1),o.setClear(1),u.setClear(0),Le(i.DEPTH_TEST),o.setFunc(Qd),Je(!1),xt(AT),Le(i.CULL_FACE),qe(Gl);function Le(ue){g[ue]!==!0&&(i.enable(ue),g[ue]=!0)}function lt(ue){g[ue]!==!1&&(i.disable(ue),g[ue]=!1)}function _t(ue,Ce){return v[ue]!==Ce?(i.bindFramebuffer(ue,Ce),v[ue]=Ce,ue===i.DRAW_FRAMEBUFFER&&(v[i.FRAMEBUFFER]=Ce),ue===i.FRAMEBUFFER&&(v[i.DRAW_FRAMEBUFFER]=Ce),!0):!1}function Dt(ue,Ce){let at=x,gt=!1;if(ue){at=_.get(Ce),at===void 0&&(at=[],_.set(Ce,at));const ut=ue.textures;if(at.length!==ut.length||at[0]!==i.COLOR_ATTACHMENT0){for(let Ye=0,pt=ut.length;Ye<pt;Ye++)at[Ye]=i.COLOR_ATTACHMENT0+Ye;at.length=ut.length,gt=!0}}else at[0]!==i.BACK&&(at[0]=i.BACK,gt=!0);gt&&i.drawBuffers(at)}function qt(ue){return E!==ue?(i.useProgram(ue),E=ue,!0):!1}const un={[Qh]:i.FUNC_ADD,[yB]:i.FUNC_SUBTRACT,[_B]:i.FUNC_REVERSE_SUBTRACT};un[xB]=i.MIN,un[bB]=i.MAX;const Yt={[AB]:i.ZERO,[SB]:i.ONE,[EB]:i.SRC_COLOR,[Ub]:i.SRC_ALPHA,[IB]:i.SRC_ALPHA_SATURATE,[CB]:i.DST_COLOR,[MB]:i.DST_ALPHA,[TB]:i.ONE_MINUS_SRC_COLOR,[Fb]:i.ONE_MINUS_SRC_ALPHA,[RB]:i.ONE_MINUS_DST_COLOR,[wB]:i.ONE_MINUS_DST_ALPHA,[DB]:i.CONSTANT_COLOR,[NB]:i.ONE_MINUS_CONSTANT_COLOR,[PB]:i.CONSTANT_ALPHA,[BB]:i.ONE_MINUS_CONSTANT_ALPHA};function qe(ue,Ce,at,gt,ut,Ye,pt,rn,Tn,yn){if(ue===Gl){C===!0&&(lt(i.BLEND),C=!1);return}if(C===!1&&(Le(i.BLEND),C=!0),ue!==vB){if(ue!==w||yn!==R){if((T!==Qh||F!==Qh)&&(i.blendEquation(i.FUNC_ADD),T=Qh,F=Qh),yn)switch(ue){case Hd:i.blendFuncSeparate(i.ONE,i.ONE_MINUS_SRC_ALPHA,i.ONE,i.ONE_MINUS_SRC_ALPHA);break;case ST:i.blendFunc(i.ONE,i.ONE);break;case ET:i.blendFuncSeparate(i.ZERO,i.ONE_MINUS_SRC_COLOR,i.ZERO,i.ONE);break;case TT:i.blendFuncSeparate(i.DST_COLOR,i.ONE_MINUS_SRC_ALPHA,i.ZERO,i.ONE);break;default:cn("WebGLState: Invalid blending: ",ue);break}else switch(ue){case Hd:i.blendFuncSeparate(i.SRC_ALPHA,i.ONE_MINUS_SRC_ALPHA,i.ONE,i.ONE_MINUS_SRC_ALPHA);break;case ST:i.blendFuncSeparate(i.SRC_ALPHA,i.ONE,i.ONE,i.ONE);break;case ET:cn("WebGLState: SubtractiveBlending requires material.premultipliedAlpha = true");break;case TT:cn("WebGLState: MultiplyBlending requires material.premultipliedAlpha = true");break;default:cn("WebGLState: Invalid blending: ",ue);break}N=null,L=null,G=null,k=null,O.set(0,0,0),D=0,w=ue,R=yn}return}ut=ut||Ce,Ye=Ye||at,pt=pt||gt,(Ce!==T||ut!==F)&&(i.blendEquationSeparate(un[Ce],un[ut]),T=Ce,F=ut),(at!==N||gt!==L||Ye!==G||pt!==k)&&(i.blendFuncSeparate(Yt[at],Yt[gt],Yt[Ye],Yt[pt]),N=at,L=gt,G=Ye,k=pt),(rn.equals(O)===!1||Tn!==D)&&(i.blendColor(rn.r,rn.g,rn.b,Tn),O.copy(rn),D=Tn),w=ue,R=!1}function rt(ue,Ce){ue.side===yo?lt(i.CULL_FACE):Le(i.CULL_FACE);let at=ue.side===Ca;Ce&&(at=!at),Je(at),ue.blending===Hd&&ue.transparent===!1?qe(Gl):qe(ue.blending,ue.blendEquation,ue.blendSrc,ue.blendDst,ue.blendEquationAlpha,ue.blendSrcAlpha,ue.blendDstAlpha,ue.blendColor,ue.blendAlpha,ue.premultipliedAlpha),o.setFunc(ue.depthFunc),o.setTest(ue.depthTest),o.setMask(ue.depthWrite),s.setMask(ue.colorWrite);const gt=ue.stencilWrite;u.setTest(gt),gt&&(u.setMask(ue.stencilWriteMask),u.setFunc(ue.stencilFunc,ue.stencilRef,ue.stencilFuncMask),u.setOp(ue.stencilFail,ue.stencilZFail,ue.stencilZPass)),Lt(ue.polygonOffset,ue.polygonOffsetFactor,ue.polygonOffsetUnits),ue.alphaToCoverage===!0?Le(i.SAMPLE_ALPHA_TO_COVERAGE):lt(i.SAMPLE_ALPHA_TO_COVERAGE)}function Je(ue){P!==ue&&(ue?i.frontFace(i.CW):i.frontFace(i.CCW),P=ue)}function xt(ue){ue!==pB?(Le(i.CULL_FACE),ue!==z&&(ue===AT?i.cullFace(i.BACK):ue===mB?i.cullFace(i.FRONT):i.cullFace(i.FRONT_AND_BACK))):lt(i.CULL_FACE),z=ue}function re(ue){ue!==Y&&(te&&i.lineWidth(ue),Y=ue)}function Lt(ue,Ce,at){ue?(Le(i.POLYGON_OFFSET_FILL),(j!==Ce||ce!==at)&&(i.polygonOffset(Ce,at),j=Ce,ce=at)):lt(i.POLYGON_OFFSET_FILL)}function vt(ue){ue?Le(i.SCISSOR_TEST):lt(i.SCISSOR_TEST)}function Qt(ue){ue===void 0&&(ue=i.TEXTURE0+fe-1),Pe!==ue&&(i.activeTexture(ue),Pe=ue)}function bt(ue,Ce,at){at===void 0&&(Pe===null?at=i.TEXTURE0+fe-1:at=Pe);let gt=Re[at];gt===void 0&&(gt={type:void 0,texture:void 0},Re[at]=gt),(gt.type!==ue||gt.texture!==Ce)&&(Pe!==at&&(i.activeTexture(at),Pe=at),i.bindTexture(ue,Ce||ve[ue]),gt.type=ue,gt.texture=Ce)}function ee(){const ue=Re[Pe];ue!==void 0&&ue.type!==void 0&&(i.bindTexture(ue.type,null),ue.type=void 0,ue.texture=void 0)}function q(){try{i.compressedTexImage2D(...arguments)}catch(ue){cn("WebGLState:",ue)}}function ge(){try{i.compressedTexImage3D(...arguments)}catch(ue){cn("WebGLState:",ue)}}function Fe(){try{i.texSubImage2D(...arguments)}catch(ue){cn("WebGLState:",ue)}}function Xe(){try{i.texSubImage3D(...arguments)}catch(ue){cn("WebGLState:",ue)}}function Ue(){try{i.compressedTexSubImage2D(...arguments)}catch(ue){cn("WebGLState:",ue)}}function Ft(){try{i.compressedTexSubImage3D(...arguments)}catch(ue){cn("WebGLState:",ue)}}function Ct(){try{i.texStorage2D(...arguments)}catch(ue){cn("WebGLState:",ue)}}function Xt(){try{i.texStorage3D(...arguments)}catch(ue){cn("WebGLState:",ue)}}function an(){try{i.texImage2D(...arguments)}catch(ue){cn("WebGLState:",ue)}}function tt(){try{i.texImage3D(...arguments)}catch(ue){cn("WebGLState:",ue)}}function it(ue){Se.equals(ue)===!1&&(i.scissor(ue.x,ue.y,ue.z,ue.w),Se.copy(ue))}function Ut(ue){ke.equals(ue)===!1&&(i.viewport(ue.x,ue.y,ue.z,ue.w),ke.copy(ue))}function oe(ue,Ce){let at=p.get(Ce);at===void 0&&(at=new WeakMap,p.set(Ce,at));let gt=at.get(ue);gt===void 0&&(gt=i.getUniformBlockIndex(Ce,ue.name),at.set(ue,gt))}function Te(ue,Ce){const gt=p.get(Ce).get(ue);f.get(Ce)!==gt&&(i.uniformBlockBinding(Ce,gt,ue.__bindingPointIndex),f.set(Ce,gt))}function ot(){i.disable(i.BLEND),i.disable(i.CULL_FACE),i.disable(i.DEPTH_TEST),i.disable(i.POLYGON_OFFSET_FILL),i.disable(i.SCISSOR_TEST),i.disable(i.STENCIL_TEST),i.disable(i.SAMPLE_ALPHA_TO_COVERAGE),i.blendEquation(i.FUNC_ADD),i.blendFunc(i.ONE,i.ZERO),i.blendFuncSeparate(i.ONE,i.ZERO,i.ONE,i.ZERO),i.blendColor(0,0,0,0),i.colorMask(!0,!0,!0,!0),i.clearColor(0,0,0,0),i.depthMask(!0),i.depthFunc(i.LESS),o.setReversed(!1),i.clearDepth(1),i.stencilMask(4294967295),i.stencilFunc(i.ALWAYS,0,4294967295),i.stencilOp(i.KEEP,i.KEEP,i.KEEP),i.clearStencil(0),i.cullFace(i.BACK),i.frontFace(i.CCW),i.polygonOffset(0,0),i.activeTexture(i.TEXTURE0),i.bindFramebuffer(i.FRAMEBUFFER,null),i.bindFramebuffer(i.DRAW_FRAMEBUFFER,null),i.bindFramebuffer(i.READ_FRAMEBUFFER,null),i.useProgram(null),i.lineWidth(1),i.scissor(0,0,i.canvas.width,i.canvas.height),i.viewport(0,0,i.canvas.width,i.canvas.height),g={},Pe=null,Re={},v={},_=new WeakMap,x=[],E=null,C=!1,w=null,T=null,N=null,L=null,F=null,G=null,k=null,O=new Gt(0,0,0),D=0,R=!1,P=null,z=null,Y=null,j=null,ce=null,Se.set(0,0,i.canvas.width,i.canvas.height),ke.set(0,0,i.canvas.width,i.canvas.height),s.reset(),o.reset(),u.reset()}return{buffers:{color:s,depth:o,stencil:u},enable:Le,disable:lt,bindFramebuffer:_t,drawBuffers:Dt,useProgram:qt,setBlending:qe,setMaterial:rt,setFlipSided:Je,setCullFace:xt,setLineWidth:re,setPolygonOffset:Lt,setScissorTest:vt,activeTexture:Qt,bindTexture:bt,unbindTexture:ee,compressedTexImage2D:q,compressedTexImage3D:ge,texImage2D:an,texImage3D:tt,updateUBOMapping:oe,uniformBlockBinding:Te,texStorage2D:Ct,texStorage3D:Xt,texSubImage2D:Fe,texSubImage3D:Xe,compressedTexSubImage2D:Ue,compressedTexSubImage3D:Ft,scissor:it,viewport:Ut,reset:ot}}function eX(i,e,t,n,r,s,o){const u=e.has("WEBGL_multisampled_render_to_texture")?e.get("WEBGL_multisampled_render_to_texture"):null,f=typeof navigator>"u"?!1:/OculusBrowser/g.test(navigator.userAgent),p=new $e,g=new WeakMap;let v;const _=new WeakMap;let x=!1;try{x=typeof OffscreenCanvas<"u"&&new OffscreenCanvas(1,1).getContext("2d")!==null}catch{}function E(ee,q){return x?new OffscreenCanvas(ee,q):Jv("canvas")}function C(ee,q,ge){let Fe=1;const Xe=bt(ee);if((Xe.width>ge||Xe.height>ge)&&(Fe=ge/Math.max(Xe.width,Xe.height)),Fe<1)if(typeof HTMLImageElement<"u"&&ee instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&ee instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&ee instanceof ImageBitmap||typeof VideoFrame<"u"&&ee instanceof VideoFrame){const Ue=Math.floor(Fe*Xe.width),Ft=Math.floor(Fe*Xe.height);v===void 0&&(v=E(Ue,Ft));const Ct=q?E(Ue,Ft):v;return Ct.width=Ue,Ct.height=Ft,Ct.getContext("2d").drawImage(ee,0,0,Ue,Ft),Ht("WebGLRenderer: Texture has been resized from ("+Xe.width+"x"+Xe.height+") to ("+Ue+"x"+Ft+")."),Ct}else return"data"in ee&&Ht("WebGLRenderer: Image in DataTexture is too big ("+Xe.width+"x"+Xe.height+")."),ee;return ee}function w(ee){return ee.generateMipmaps}function T(ee){i.generateMipmap(ee)}function N(ee){return ee.isWebGLCubeRenderTarget?i.TEXTURE_CUBE_MAP:ee.isWebGL3DRenderTarget?i.TEXTURE_3D:ee.isWebGLArrayRenderTarget||ee.isCompressedArrayTexture?i.TEXTURE_2D_ARRAY:i.TEXTURE_2D}function L(ee,q,ge,Fe,Xe=!1){if(ee!==null){if(i[ee]!==void 0)return i[ee];Ht("WebGLRenderer: Attempt to use non-existing WebGL internal format '"+ee+"'")}let Ue=q;if(q===i.RED&&(ge===i.FLOAT&&(Ue=i.R32F),ge===i.HALF_FLOAT&&(Ue=i.R16F),ge===i.UNSIGNED_BYTE&&(Ue=i.R8)),q===i.RED_INTEGER&&(ge===i.UNSIGNED_BYTE&&(Ue=i.R8UI),ge===i.UNSIGNED_SHORT&&(Ue=i.R16UI),ge===i.UNSIGNED_INT&&(Ue=i.R32UI),ge===i.BYTE&&(Ue=i.R8I),ge===i.SHORT&&(Ue=i.R16I),ge===i.INT&&(Ue=i.R32I)),q===i.RG&&(ge===i.FLOAT&&(Ue=i.RG32F),ge===i.HALF_FLOAT&&(Ue=i.RG16F),ge===i.UNSIGNED_BYTE&&(Ue=i.RG8)),q===i.RG_INTEGER&&(ge===i.UNSIGNED_BYTE&&(Ue=i.RG8UI),ge===i.UNSIGNED_SHORT&&(Ue=i.RG16UI),ge===i.UNSIGNED_INT&&(Ue=i.RG32UI),ge===i.BYTE&&(Ue=i.RG8I),ge===i.SHORT&&(Ue=i.RG16I),ge===i.INT&&(Ue=i.RG32I)),q===i.RGB_INTEGER&&(ge===i.UNSIGNED_BYTE&&(Ue=i.RGB8UI),ge===i.UNSIGNED_SHORT&&(Ue=i.RGB16UI),ge===i.UNSIGNED_INT&&(Ue=i.RGB32UI),ge===i.BYTE&&(Ue=i.RGB8I),ge===i.SHORT&&(Ue=i.RGB16I),ge===i.INT&&(Ue=i.RGB32I)),q===i.RGBA_INTEGER&&(ge===i.UNSIGNED_BYTE&&(Ue=i.RGBA8UI),ge===i.UNSIGNED_SHORT&&(Ue=i.RGBA16UI),ge===i.UNSIGNED_INT&&(Ue=i.RGBA32UI),ge===i.BYTE&&(Ue=i.RGBA8I),ge===i.SHORT&&(Ue=i.RGBA16I),ge===i.INT&&(Ue=i.RGBA32I)),q===i.RGB&&(ge===i.UNSIGNED_INT_5_9_9_9_REV&&(Ue=i.RGB9_E5),ge===i.UNSIGNED_INT_10F_11F_11F_REV&&(Ue=i.R11F_G11F_B10F)),q===i.RGBA){const Ft=Xe?Xv:oi.getTransfer(Fe);ge===i.FLOAT&&(Ue=i.RGBA32F),ge===i.HALF_FLOAT&&(Ue=i.RGBA16F),ge===i.UNSIGNED_BYTE&&(Ue=Ft===wi?i.SRGB8_ALPHA8:i.RGBA8),ge===i.UNSIGNED_SHORT_4_4_4_4&&(Ue=i.RGBA4),ge===i.UNSIGNED_SHORT_5_5_5_1&&(Ue=i.RGB5_A1)}return(Ue===i.R16F||Ue===i.R32F||Ue===i.RG16F||Ue===i.RG32F||Ue===i.RGBA16F||Ue===i.RGBA32F)&&e.get("EXT_color_buffer_float"),Ue}function F(ee,q){let ge;return ee?q===null||q===So||q===og?ge=i.DEPTH24_STENCIL8:q===ir?ge=i.DEPTH32F_STENCIL8:q===ag&&(ge=i.DEPTH24_STENCIL8,Ht("DepthTexture: 16 bit depth attachment is not supported with stencil. Using 24-bit attachment.")):q===null||q===So||q===og?ge=i.DEPTH_COMPONENT24:q===ir?ge=i.DEPTH_COMPONENT32F:q===ag&&(ge=i.DEPTH_COMPONENT16),ge}function G(ee,q){return w(ee)===!0||ee.isFramebufferTexture&&ee.minFilter!==Pr&&ee.minFilter!==Jn?Math.log2(Math.max(q.width,q.height))+1:ee.mipmaps!==void 0&&ee.mipmaps.length>0?ee.mipmaps.length:ee.isCompressedTexture&&Array.isArray(ee.image)?q.mipmaps.length:1}function k(ee){const q=ee.target;q.removeEventListener("dispose",k),D(q),q.isVideoTexture&&g.delete(q)}function O(ee){const q=ee.target;q.removeEventListener("dispose",O),P(q)}function D(ee){const q=n.get(ee);if(q.__webglInit===void 0)return;const ge=ee.source,Fe=_.get(ge);if(Fe){const Xe=Fe[q.__cacheKey];Xe.usedTimes--,Xe.usedTimes===0&&R(ee),Object.keys(Fe).length===0&&_.delete(ge)}n.remove(ee)}function R(ee){const q=n.get(ee);i.deleteTexture(q.__webglTexture);const ge=ee.source,Fe=_.get(ge);delete Fe[q.__cacheKey],o.memory.textures--}function P(ee){const q=n.get(ee);if(ee.depthTexture&&(ee.depthTexture.dispose(),n.remove(ee.depthTexture)),ee.isWebGLCubeRenderTarget)for(let Fe=0;Fe<6;Fe++){if(Array.isArray(q.__webglFramebuffer[Fe]))for(let Xe=0;Xe<q.__webglFramebuffer[Fe].length;Xe++)i.deleteFramebuffer(q.__webglFramebuffer[Fe][Xe]);else i.deleteFramebuffer(q.__webglFramebuffer[Fe]);q.__webglDepthbuffer&&i.deleteRenderbuffer(q.__webglDepthbuffer[Fe])}else{if(Array.isArray(q.__webglFramebuffer))for(let Fe=0;Fe<q.__webglFramebuffer.length;Fe++)i.deleteFramebuffer(q.__webglFramebuffer[Fe]);else i.deleteFramebuffer(q.__webglFramebuffer);if(q.__webglDepthbuffer&&i.deleteRenderbuffer(q.__webglDepthbuffer),q.__webglMultisampledFramebuffer&&i.deleteFramebuffer(q.__webglMultisampledFramebuffer),q.__webglColorRenderbuffer)for(let Fe=0;Fe<q.__webglColorRenderbuffer.length;Fe++)q.__webglColorRenderbuffer[Fe]&&i.deleteRenderbuffer(q.__webglColorRenderbuffer[Fe]);q.__webglDepthRenderbuffer&&i.deleteRenderbuffer(q.__webglDepthRenderbuffer)}const ge=ee.textures;for(let Fe=0,Xe=ge.length;Fe<Xe;Fe++){const Ue=n.get(ge[Fe]);Ue.__webglTexture&&(i.deleteTexture(Ue.__webglTexture),o.memory.textures--),n.remove(ge[Fe])}n.remove(ee)}let z=0;function Y(){z=0}function j(){const ee=z;return ee>=r.maxTextures&&Ht("WebGLTextures: Trying to use "+ee+" texture units while this GPU supports only "+r.maxTextures),z+=1,ee}function ce(ee){const q=[];return q.push(ee.wrapS),q.push(ee.wrapT),q.push(ee.wrapR||0),q.push(ee.magFilter),q.push(ee.minFilter),q.push(ee.anisotropy),q.push(ee.internalFormat),q.push(ee.format),q.push(ee.type),q.push(ee.generateMipmaps),q.push(ee.premultiplyAlpha),q.push(ee.flipY),q.push(ee.unpackAlignment),q.push(ee.colorSpace),q.join()}function fe(ee,q){const ge=n.get(ee);if(ee.isVideoTexture&&vt(ee),ee.isRenderTargetTexture===!1&&ee.isExternalTexture!==!0&&ee.version>0&&ge.__version!==ee.version){const Fe=ee.image;if(Fe===null)Ht("WebGLRenderer: Texture marked for update but no image data found.");else if(Fe.complete===!1)Ht("WebGLRenderer: Texture marked for update but image is incomplete");else{ve(ge,ee,q);return}}else ee.isExternalTexture&&(ge.__webglTexture=ee.sourceTexture?ee.sourceTexture:null);t.bindTexture(i.TEXTURE_2D,ge.__webglTexture,i.TEXTURE0+q)}function te(ee,q){const ge=n.get(ee);if(ee.isRenderTargetTexture===!1&&ee.version>0&&ge.__version!==ee.version){ve(ge,ee,q);return}else ee.isExternalTexture&&(ge.__webglTexture=ee.sourceTexture?ee.sourceTexture:null);t.bindTexture(i.TEXTURE_2D_ARRAY,ge.__webglTexture,i.TEXTURE0+q)}function se(ee,q){const ge=n.get(ee);if(ee.isRenderTargetTexture===!1&&ee.version>0&&ge.__version!==ee.version){ve(ge,ee,q);return}t.bindTexture(i.TEXTURE_3D,ge.__webglTexture,i.TEXTURE0+q)}function Ae(ee,q){const ge=n.get(ee);if(ee.isCubeDepthTexture!==!0&&ee.version>0&&ge.__version!==ee.version){Le(ge,ee,q);return}t.bindTexture(i.TEXTURE_CUBE_MAP,ge.__webglTexture,i.TEXTURE0+q)}const Pe={[_f]:i.REPEAT,[Sr]:i.CLAMP_TO_EDGE,[sg]:i.MIRRORED_REPEAT},Re={[Pr]:i.NEAREST,[aS]:i.NEAREST_MIPMAP_NEAREST,[Pd]:i.NEAREST_MIPMAP_LINEAR,[Jn]:i.LINEAR,[qm]:i.LINEAR_MIPMAP_NEAREST,[sl]:i.LINEAR_MIPMAP_LINEAR},$={[jB]:i.NEVER,[JB]:i.ALWAYS,[WB]:i.LESS,[pS]:i.LEQUAL,[qB]:i.EQUAL,[mS]:i.GEQUAL,[XB]:i.GREATER,[YB]:i.NOTEQUAL};function ae(ee,q){if(q.type===ir&&e.has("OES_texture_float_linear")===!1&&(q.magFilter===Jn||q.magFilter===qm||q.magFilter===Pd||q.magFilter===sl||q.minFilter===Jn||q.minFilter===qm||q.minFilter===Pd||q.minFilter===sl)&&Ht("WebGLRenderer: Unable to use linear filtering with floating point textures. OES_texture_float_linear not supported on this device."),i.texParameteri(ee,i.TEXTURE_WRAP_S,Pe[q.wrapS]),i.texParameteri(ee,i.TEXTURE_WRAP_T,Pe[q.wrapT]),(ee===i.TEXTURE_3D||ee===i.TEXTURE_2D_ARRAY)&&i.texParameteri(ee,i.TEXTURE_WRAP_R,Pe[q.wrapR]),i.texParameteri(ee,i.TEXTURE_MAG_FILTER,Re[q.magFilter]),i.texParameteri(ee,i.TEXTURE_MIN_FILTER,Re[q.minFilter]),q.compareFunction&&(i.texParameteri(ee,i.TEXTURE_COMPARE_MODE,i.COMPARE_REF_TO_TEXTURE),i.texParameteri(ee,i.TEXTURE_COMPARE_FUNC,$[q.compareFunction])),e.has("EXT_texture_filter_anisotropic")===!0){if(q.magFilter===Pr||q.minFilter!==Pd&&q.minFilter!==sl||q.type===ir&&e.has("OES_texture_float_linear")===!1)return;if(q.anisotropy>1||n.get(q).__currentAnisotropy){const ge=e.get("EXT_texture_filter_anisotropic");i.texParameterf(ee,ge.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(q.anisotropy,r.getMaxAnisotropy())),n.get(q).__currentAnisotropy=q.anisotropy}}}function Se(ee,q){let ge=!1;ee.__webglInit===void 0&&(ee.__webglInit=!0,q.addEventListener("dispose",k));const Fe=q.source;let Xe=_.get(Fe);Xe===void 0&&(Xe={},_.set(Fe,Xe));const Ue=ce(q);if(Ue!==ee.__cacheKey){Xe[Ue]===void 0&&(Xe[Ue]={texture:i.createTexture(),usedTimes:0},o.memory.textures++,ge=!0),Xe[Ue].usedTimes++;const Ft=Xe[ee.__cacheKey];Ft!==void 0&&(Xe[ee.__cacheKey].usedTimes--,Ft.usedTimes===0&&R(q)),ee.__cacheKey=Ue,ee.__webglTexture=Xe[Ue].texture}return ge}function ke(ee,q,ge){return Math.floor(Math.floor(ee/ge)/q)}function dt(ee,q,ge,Fe){const Ue=ee.updateRanges;if(Ue.length===0)t.texSubImage2D(i.TEXTURE_2D,0,0,0,q.width,q.height,ge,Fe,q.data);else{Ue.sort((tt,it)=>tt.start-it.start);let Ft=0;for(let tt=1;tt<Ue.length;tt++){const it=Ue[Ft],Ut=Ue[tt],oe=it.start+it.count,Te=ke(Ut.start,q.width,4),ot=ke(it.start,q.width,4);Ut.start<=oe+1&&Te===ot&&ke(Ut.start+Ut.count-1,q.width,4)===Te?it.count=Math.max(it.count,Ut.start+Ut.count-it.start):(++Ft,Ue[Ft]=Ut)}Ue.length=Ft+1;const Ct=i.getParameter(i.UNPACK_ROW_LENGTH),Xt=i.getParameter(i.UNPACK_SKIP_PIXELS),an=i.getParameter(i.UNPACK_SKIP_ROWS);i.pixelStorei(i.UNPACK_ROW_LENGTH,q.width);for(let tt=0,it=Ue.length;tt<it;tt++){const Ut=Ue[tt],oe=Math.floor(Ut.start/4),Te=Math.ceil(Ut.count/4),ot=oe%q.width,ue=Math.floor(oe/q.width),Ce=Te,at=1;i.pixelStorei(i.UNPACK_SKIP_PIXELS,ot),i.pixelStorei(i.UNPACK_SKIP_ROWS,ue),t.texSubImage2D(i.TEXTURE_2D,0,ot,ue,Ce,at,ge,Fe,q.data)}ee.clearUpdateRanges(),i.pixelStorei(i.UNPACK_ROW_LENGTH,Ct),i.pixelStorei(i.UNPACK_SKIP_PIXELS,Xt),i.pixelStorei(i.UNPACK_SKIP_ROWS,an)}}function ve(ee,q,ge){let Fe=i.TEXTURE_2D;(q.isDataArrayTexture||q.isCompressedArrayTexture)&&(Fe=i.TEXTURE_2D_ARRAY),q.isData3DTexture&&(Fe=i.TEXTURE_3D);const Xe=Se(ee,q),Ue=q.source;t.bindTexture(Fe,ee.__webglTexture,i.TEXTURE0+ge);const Ft=n.get(Ue);if(Ue.version!==Ft.__version||Xe===!0){t.activeTexture(i.TEXTURE0+ge);const Ct=oi.getPrimaries(oi.workingColorSpace),Xt=q.colorSpace===Nu?null:oi.getPrimaries(q.colorSpace),an=q.colorSpace===Nu||Ct===Xt?i.NONE:i.BROWSER_DEFAULT_WEBGL;i.pixelStorei(i.UNPACK_FLIP_Y_WEBGL,q.flipY),i.pixelStorei(i.UNPACK_PREMULTIPLY_ALPHA_WEBGL,q.premultiplyAlpha),i.pixelStorei(i.UNPACK_ALIGNMENT,q.unpackAlignment),i.pixelStorei(i.UNPACK_COLORSPACE_CONVERSION_WEBGL,an);let tt=C(q.image,!1,r.maxTextureSize);tt=Qt(q,tt);const it=s.convert(q.format,q.colorSpace),Ut=s.convert(q.type);let oe=L(q.internalFormat,it,Ut,q.colorSpace,q.isVideoTexture);ae(Fe,q);let Te;const ot=q.mipmaps,ue=q.isVideoTexture!==!0,Ce=Ft.__version===void 0||Xe===!0,at=Ue.dataReady,gt=G(q,tt);if(q.isDepthTexture)oe=F(q.format===$h,q.type),Ce&&(ue?t.texStorage2D(i.TEXTURE_2D,1,oe,tt.width,tt.height):t.texImage2D(i.TEXTURE_2D,0,oe,tt.width,tt.height,0,it,Ut,null));else if(q.isDataTexture)if(ot.length>0){ue&&Ce&&t.texStorage2D(i.TEXTURE_2D,gt,oe,ot[0].width,ot[0].height);for(let ut=0,Ye=ot.length;ut<Ye;ut++)Te=ot[ut],ue?at&&t.texSubImage2D(i.TEXTURE_2D,ut,0,0,Te.width,Te.height,it,Ut,Te.data):t.texImage2D(i.TEXTURE_2D,ut,oe,Te.width,Te.height,0,it,Ut,Te.data);q.generateMipmaps=!1}else ue?(Ce&&t.texStorage2D(i.TEXTURE_2D,gt,oe,tt.width,tt.height),at&&dt(q,tt,it,Ut)):t.texImage2D(i.TEXTURE_2D,0,oe,tt.width,tt.height,0,it,Ut,tt.data);else if(q.isCompressedTexture)if(q.isCompressedArrayTexture){ue&&Ce&&t.texStorage3D(i.TEXTURE_2D_ARRAY,gt,oe,ot[0].width,ot[0].height,tt.depth);for(let ut=0,Ye=ot.length;ut<Ye;ut++)if(Te=ot[ut],q.format!==jr)if(it!==null)if(ue){if(at)if(q.layerUpdates.size>0){const pt=OT(Te.width,Te.height,q.format,q.type);for(const rn of q.layerUpdates){const Tn=Te.data.subarray(rn*pt/Te.data.BYTES_PER_ELEMENT,(rn+1)*pt/Te.data.BYTES_PER_ELEMENT);t.compressedTexSubImage3D(i.TEXTURE_2D_ARRAY,ut,0,0,rn,Te.width,Te.height,1,it,Tn)}q.clearLayerUpdates()}else t.compressedTexSubImage3D(i.TEXTURE_2D_ARRAY,ut,0,0,0,Te.width,Te.height,tt.depth,it,Te.data)}else t.compressedTexImage3D(i.TEXTURE_2D_ARRAY,ut,oe,Te.width,Te.height,tt.depth,0,Te.data,0,0);else Ht("WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()");else ue?at&&t.texSubImage3D(i.TEXTURE_2D_ARRAY,ut,0,0,0,Te.width,Te.height,tt.depth,it,Ut,Te.data):t.texImage3D(i.TEXTURE_2D_ARRAY,ut,oe,Te.width,Te.height,tt.depth,0,it,Ut,Te.data)}else{ue&&Ce&&t.texStorage2D(i.TEXTURE_2D,gt,oe,ot[0].width,ot[0].height);for(let ut=0,Ye=ot.length;ut<Ye;ut++)Te=ot[ut],q.format!==jr?it!==null?ue?at&&t.compressedTexSubImage2D(i.TEXTURE_2D,ut,0,0,Te.width,Te.height,it,Te.data):t.compressedTexImage2D(i.TEXTURE_2D,ut,oe,Te.width,Te.height,0,Te.data):Ht("WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):ue?at&&t.texSubImage2D(i.TEXTURE_2D,ut,0,0,Te.width,Te.height,it,Ut,Te.data):t.texImage2D(i.TEXTURE_2D,ut,oe,Te.width,Te.height,0,it,Ut,Te.data)}else if(q.isDataArrayTexture)if(ue){if(Ce&&t.texStorage3D(i.TEXTURE_2D_ARRAY,gt,oe,tt.width,tt.height,tt.depth),at)if(q.layerUpdates.size>0){const ut=OT(tt.width,tt.height,q.format,q.type);for(const Ye of q.layerUpdates){const pt=tt.data.subarray(Ye*ut/tt.data.BYTES_PER_ELEMENT,(Ye+1)*ut/tt.data.BYTES_PER_ELEMENT);t.texSubImage3D(i.TEXTURE_2D_ARRAY,0,0,0,Ye,tt.width,tt.height,1,it,Ut,pt)}q.clearLayerUpdates()}else t.texSubImage3D(i.TEXTURE_2D_ARRAY,0,0,0,0,tt.width,tt.height,tt.depth,it,Ut,tt.data)}else t.texImage3D(i.TEXTURE_2D_ARRAY,0,oe,tt.width,tt.height,tt.depth,0,it,Ut,tt.data);else if(q.isData3DTexture)ue?(Ce&&t.texStorage3D(i.TEXTURE_3D,gt,oe,tt.width,tt.height,tt.depth),at&&t.texSubImage3D(i.TEXTURE_3D,0,0,0,0,tt.width,tt.height,tt.depth,it,Ut,tt.data)):t.texImage3D(i.TEXTURE_3D,0,oe,tt.width,tt.height,tt.depth,0,it,Ut,tt.data);else if(q.isFramebufferTexture){if(Ce)if(ue)t.texStorage2D(i.TEXTURE_2D,gt,oe,tt.width,tt.height);else{let ut=tt.width,Ye=tt.height;for(let pt=0;pt<gt;pt++)t.texImage2D(i.TEXTURE_2D,pt,oe,ut,Ye,0,it,Ut,null),ut>>=1,Ye>>=1}}else if(ot.length>0){if(ue&&Ce){const ut=bt(ot[0]);t.texStorage2D(i.TEXTURE_2D,gt,oe,ut.width,ut.height)}for(let ut=0,Ye=ot.length;ut<Ye;ut++)Te=ot[ut],ue?at&&t.texSubImage2D(i.TEXTURE_2D,ut,0,0,it,Ut,Te):t.texImage2D(i.TEXTURE_2D,ut,oe,it,Ut,Te);q.generateMipmaps=!1}else if(ue){if(Ce){const ut=bt(tt);t.texStorage2D(i.TEXTURE_2D,gt,oe,ut.width,ut.height)}at&&t.texSubImage2D(i.TEXTURE_2D,0,0,0,it,Ut,tt)}else t.texImage2D(i.TEXTURE_2D,0,oe,it,Ut,tt);w(q)&&T(Fe),Ft.__version=Ue.version,q.onUpdate&&q.onUpdate(q)}ee.__version=q.version}function Le(ee,q,ge){if(q.image.length!==6)return;const Fe=Se(ee,q),Xe=q.source;t.bindTexture(i.TEXTURE_CUBE_MAP,ee.__webglTexture,i.TEXTURE0+ge);const Ue=n.get(Xe);if(Xe.version!==Ue.__version||Fe===!0){t.activeTexture(i.TEXTURE0+ge);const Ft=oi.getPrimaries(oi.workingColorSpace),Ct=q.colorSpace===Nu?null:oi.getPrimaries(q.colorSpace),Xt=q.colorSpace===Nu||Ft===Ct?i.NONE:i.BROWSER_DEFAULT_WEBGL;i.pixelStorei(i.UNPACK_FLIP_Y_WEBGL,q.flipY),i.pixelStorei(i.UNPACK_PREMULTIPLY_ALPHA_WEBGL,q.premultiplyAlpha),i.pixelStorei(i.UNPACK_ALIGNMENT,q.unpackAlignment),i.pixelStorei(i.UNPACK_COLORSPACE_CONVERSION_WEBGL,Xt);const an=q.isCompressedTexture||q.image[0].isCompressedTexture,tt=q.image[0]&&q.image[0].isDataTexture,it=[];for(let Ye=0;Ye<6;Ye++)!an&&!tt?it[Ye]=C(q.image[Ye],!0,r.maxCubemapSize):it[Ye]=tt?q.image[Ye].image:q.image[Ye],it[Ye]=Qt(q,it[Ye]);const Ut=it[0],oe=s.convert(q.format,q.colorSpace),Te=s.convert(q.type),ot=L(q.internalFormat,oe,Te,q.colorSpace),ue=q.isVideoTexture!==!0,Ce=Ue.__version===void 0||Fe===!0,at=Xe.dataReady;let gt=G(q,Ut);ae(i.TEXTURE_CUBE_MAP,q);let ut;if(an){ue&&Ce&&t.texStorage2D(i.TEXTURE_CUBE_MAP,gt,ot,Ut.width,Ut.height);for(let Ye=0;Ye<6;Ye++){ut=it[Ye].mipmaps;for(let pt=0;pt<ut.length;pt++){const rn=ut[pt];q.format!==jr?oe!==null?ue?at&&t.compressedTexSubImage2D(i.TEXTURE_CUBE_MAP_POSITIVE_X+Ye,pt,0,0,rn.width,rn.height,oe,rn.data):t.compressedTexImage2D(i.TEXTURE_CUBE_MAP_POSITIVE_X+Ye,pt,ot,rn.width,rn.height,0,rn.data):Ht("WebGLRenderer: Attempt to load unsupported compressed texture format in .setTextureCube()"):ue?at&&t.texSubImage2D(i.TEXTURE_CUBE_MAP_POSITIVE_X+Ye,pt,0,0,rn.width,rn.height,oe,Te,rn.data):t.texImage2D(i.TEXTURE_CUBE_MAP_POSITIVE_X+Ye,pt,ot,rn.width,rn.height,0,oe,Te,rn.data)}}}else{if(ut=q.mipmaps,ue&&Ce){ut.length>0&&gt++;const Ye=bt(it[0]);t.texStorage2D(i.TEXTURE_CUBE_MAP,gt,ot,Ye.width,Ye.height)}for(let Ye=0;Ye<6;Ye++)if(tt){ue?at&&t.texSubImage2D(i.TEXTURE_CUBE_MAP_POSITIVE_X+Ye,0,0,0,it[Ye].width,it[Ye].height,oe,Te,it[Ye].data):t.texImage2D(i.TEXTURE_CUBE_MAP_POSITIVE_X+Ye,0,ot,it[Ye].width,it[Ye].height,0,oe,Te,it[Ye].data);for(let pt=0;pt<ut.length;pt++){const Tn=ut[pt].image[Ye].image;ue?at&&t.texSubImage2D(i.TEXTURE_CUBE_MAP_POSITIVE_X+Ye,pt+1,0,0,Tn.width,Tn.height,oe,Te,Tn.data):t.texImage2D(i.TEXTURE_CUBE_MAP_POSITIVE_X+Ye,pt+1,ot,Tn.width,Tn.height,0,oe,Te,Tn.data)}}else{ue?at&&t.texSubImage2D(i.TEXTURE_CUBE_MAP_POSITIVE_X+Ye,0,0,0,oe,Te,it[Ye]):t.texImage2D(i.TEXTURE_CUBE_MAP_POSITIVE_X+Ye,0,ot,oe,Te,it[Ye]);for(let pt=0;pt<ut.length;pt++){const rn=ut[pt];ue?at&&t.texSubImage2D(i.TEXTURE_CUBE_MAP_POSITIVE_X+Ye,pt+1,0,0,oe,Te,rn.image[Ye]):t.texImage2D(i.TEXTURE_CUBE_MAP_POSITIVE_X+Ye,pt+1,ot,oe,Te,rn.image[Ye])}}}w(q)&&T(i.TEXTURE_CUBE_MAP),Ue.__version=Xe.version,q.onUpdate&&q.onUpdate(q)}ee.__version=q.version}function lt(ee,q,ge,Fe,Xe,Ue){const Ft=s.convert(ge.format,ge.colorSpace),Ct=s.convert(ge.type),Xt=L(ge.internalFormat,Ft,Ct,ge.colorSpace),an=n.get(q),tt=n.get(ge);if(tt.__renderTarget=q,!an.__hasExternalTextures){const it=Math.max(1,q.width>>Ue),Ut=Math.max(1,q.height>>Ue);Xe===i.TEXTURE_3D||Xe===i.TEXTURE_2D_ARRAY?t.texImage3D(Xe,Ue,Xt,it,Ut,q.depth,0,Ft,Ct,null):t.texImage2D(Xe,Ue,Xt,it,Ut,0,Ft,Ct,null)}t.bindFramebuffer(i.FRAMEBUFFER,ee),Lt(q)?u.framebufferTexture2DMultisampleEXT(i.FRAMEBUFFER,Fe,Xe,tt.__webglTexture,0,re(q)):(Xe===i.TEXTURE_2D||Xe>=i.TEXTURE_CUBE_MAP_POSITIVE_X&&Xe<=i.TEXTURE_CUBE_MAP_NEGATIVE_Z)&&i.framebufferTexture2D(i.FRAMEBUFFER,Fe,Xe,tt.__webglTexture,Ue),t.bindFramebuffer(i.FRAMEBUFFER,null)}function _t(ee,q,ge){if(i.bindRenderbuffer(i.RENDERBUFFER,ee),q.depthBuffer){const Fe=q.depthTexture,Xe=Fe&&Fe.isDepthTexture?Fe.type:null,Ue=F(q.stencilBuffer,Xe),Ft=q.stencilBuffer?i.DEPTH_STENCIL_ATTACHMENT:i.DEPTH_ATTACHMENT;Lt(q)?u.renderbufferStorageMultisampleEXT(i.RENDERBUFFER,re(q),Ue,q.width,q.height):ge?i.renderbufferStorageMultisample(i.RENDERBUFFER,re(q),Ue,q.width,q.height):i.renderbufferStorage(i.RENDERBUFFER,Ue,q.width,q.height),i.framebufferRenderbuffer(i.FRAMEBUFFER,Ft,i.RENDERBUFFER,ee)}else{const Fe=q.textures;for(let Xe=0;Xe<Fe.length;Xe++){const Ue=Fe[Xe],Ft=s.convert(Ue.format,Ue.colorSpace),Ct=s.convert(Ue.type),Xt=L(Ue.internalFormat,Ft,Ct,Ue.colorSpace);Lt(q)?u.renderbufferStorageMultisampleEXT(i.RENDERBUFFER,re(q),Xt,q.width,q.height):ge?i.renderbufferStorageMultisample(i.RENDERBUFFER,re(q),Xt,q.width,q.height):i.renderbufferStorage(i.RENDERBUFFER,Xt,q.width,q.height)}}i.bindRenderbuffer(i.RENDERBUFFER,null)}function Dt(ee,q,ge){const Fe=q.isWebGLCubeRenderTarget===!0;if(t.bindFramebuffer(i.FRAMEBUFFER,ee),!(q.depthTexture&&q.depthTexture.isDepthTexture))throw new Error("renderTarget.depthTexture must be an instance of THREE.DepthTexture");const Xe=n.get(q.depthTexture);if(Xe.__renderTarget=q,(!Xe.__webglTexture||q.depthTexture.image.width!==q.width||q.depthTexture.image.height!==q.height)&&(q.depthTexture.image.width=q.width,q.depthTexture.image.height=q.height,q.depthTexture.needsUpdate=!0),Fe){if(Xe.__webglInit===void 0&&(Xe.__webglInit=!0,q.depthTexture.addEventListener("dispose",k)),Xe.__webglTexture===void 0){Xe.__webglTexture=i.createTexture(),t.bindTexture(i.TEXTURE_CUBE_MAP,Xe.__webglTexture),ae(i.TEXTURE_CUBE_MAP,q.depthTexture);const an=s.convert(q.depthTexture.format),tt=s.convert(q.depthTexture.type);let it;q.depthTexture.format===jc?it=i.DEPTH_COMPONENT24:q.depthTexture.format===$h&&(it=i.DEPTH24_STENCIL8);for(let Ut=0;Ut<6;Ut++)i.texImage2D(i.TEXTURE_CUBE_MAP_POSITIVE_X+Ut,0,it,q.width,q.height,0,an,tt,null)}}else fe(q.depthTexture,0);const Ue=Xe.__webglTexture,Ft=re(q),Ct=Fe?i.TEXTURE_CUBE_MAP_POSITIVE_X+ge:i.TEXTURE_2D,Xt=q.depthTexture.format===$h?i.DEPTH_STENCIL_ATTACHMENT:i.DEPTH_ATTACHMENT;if(q.depthTexture.format===jc)Lt(q)?u.framebufferTexture2DMultisampleEXT(i.FRAMEBUFFER,Xt,Ct,Ue,0,Ft):i.framebufferTexture2D(i.FRAMEBUFFER,Xt,Ct,Ue,0);else if(q.depthTexture.format===$h)Lt(q)?u.framebufferTexture2DMultisampleEXT(i.FRAMEBUFFER,Xt,Ct,Ue,0,Ft):i.framebufferTexture2D(i.FRAMEBUFFER,Xt,Ct,Ue,0);else throw new Error("Unknown depthTexture format")}function qt(ee){const q=n.get(ee),ge=ee.isWebGLCubeRenderTarget===!0;if(q.__boundDepthTexture!==ee.depthTexture){const Fe=ee.depthTexture;if(q.__depthDisposeCallback&&q.__depthDisposeCallback(),Fe){const Xe=()=>{delete q.__boundDepthTexture,delete q.__depthDisposeCallback,Fe.removeEventListener("dispose",Xe)};Fe.addEventListener("dispose",Xe),q.__depthDisposeCallback=Xe}q.__boundDepthTexture=Fe}if(ee.depthTexture&&!q.__autoAllocateDepthBuffer)if(ge)for(let Fe=0;Fe<6;Fe++)Dt(q.__webglFramebuffer[Fe],ee,Fe);else{const Fe=ee.texture.mipmaps;Fe&&Fe.length>0?Dt(q.__webglFramebuffer[0],ee,0):Dt(q.__webglFramebuffer,ee,0)}else if(ge){q.__webglDepthbuffer=[];for(let Fe=0;Fe<6;Fe++)if(t.bindFramebuffer(i.FRAMEBUFFER,q.__webglFramebuffer[Fe]),q.__webglDepthbuffer[Fe]===void 0)q.__webglDepthbuffer[Fe]=i.createRenderbuffer(),_t(q.__webglDepthbuffer[Fe],ee,!1);else{const Xe=ee.stencilBuffer?i.DEPTH_STENCIL_ATTACHMENT:i.DEPTH_ATTACHMENT,Ue=q.__webglDepthbuffer[Fe];i.bindRenderbuffer(i.RENDERBUFFER,Ue),i.framebufferRenderbuffer(i.FRAMEBUFFER,Xe,i.RENDERBUFFER,Ue)}}else{const Fe=ee.texture.mipmaps;if(Fe&&Fe.length>0?t.bindFramebuffer(i.FRAMEBUFFER,q.__webglFramebuffer[0]):t.bindFramebuffer(i.FRAMEBUFFER,q.__webglFramebuffer),q.__webglDepthbuffer===void 0)q.__webglDepthbuffer=i.createRenderbuffer(),_t(q.__webglDepthbuffer,ee,!1);else{const Xe=ee.stencilBuffer?i.DEPTH_STENCIL_ATTACHMENT:i.DEPTH_ATTACHMENT,Ue=q.__webglDepthbuffer;i.bindRenderbuffer(i.RENDERBUFFER,Ue),i.framebufferRenderbuffer(i.FRAMEBUFFER,Xe,i.RENDERBUFFER,Ue)}}t.bindFramebuffer(i.FRAMEBUFFER,null)}function un(ee,q,ge){const Fe=n.get(ee);q!==void 0&&lt(Fe.__webglFramebuffer,ee,ee.texture,i.COLOR_ATTACHMENT0,i.TEXTURE_2D,0),ge!==void 0&&qt(ee)}function Yt(ee){const q=ee.texture,ge=n.get(ee),Fe=n.get(q);ee.addEventListener("dispose",O);const Xe=ee.textures,Ue=ee.isWebGLCubeRenderTarget===!0,Ft=Xe.length>1;if(Ft||(Fe.__webglTexture===void 0&&(Fe.__webglTexture=i.createTexture()),Fe.__version=q.version,o.memory.textures++),Ue){ge.__webglFramebuffer=[];for(let Ct=0;Ct<6;Ct++)if(q.mipmaps&&q.mipmaps.length>0){ge.__webglFramebuffer[Ct]=[];for(let Xt=0;Xt<q.mipmaps.length;Xt++)ge.__webglFramebuffer[Ct][Xt]=i.createFramebuffer()}else ge.__webglFramebuffer[Ct]=i.createFramebuffer()}else{if(q.mipmaps&&q.mipmaps.length>0){ge.__webglFramebuffer=[];for(let Ct=0;Ct<q.mipmaps.length;Ct++)ge.__webglFramebuffer[Ct]=i.createFramebuffer()}else ge.__webglFramebuffer=i.createFramebuffer();if(Ft)for(let Ct=0,Xt=Xe.length;Ct<Xt;Ct++){const an=n.get(Xe[Ct]);an.__webglTexture===void 0&&(an.__webglTexture=i.createTexture(),o.memory.textures++)}if(ee.samples>0&&Lt(ee)===!1){ge.__webglMultisampledFramebuffer=i.createFramebuffer(),ge.__webglColorRenderbuffer=[],t.bindFramebuffer(i.FRAMEBUFFER,ge.__webglMultisampledFramebuffer);for(let Ct=0;Ct<Xe.length;Ct++){const Xt=Xe[Ct];ge.__webglColorRenderbuffer[Ct]=i.createRenderbuffer(),i.bindRenderbuffer(i.RENDERBUFFER,ge.__webglColorRenderbuffer[Ct]);const an=s.convert(Xt.format,Xt.colorSpace),tt=s.convert(Xt.type),it=L(Xt.internalFormat,an,tt,Xt.colorSpace,ee.isXRRenderTarget===!0),Ut=re(ee);i.renderbufferStorageMultisample(i.RENDERBUFFER,Ut,it,ee.width,ee.height),i.framebufferRenderbuffer(i.FRAMEBUFFER,i.COLOR_ATTACHMENT0+Ct,i.RENDERBUFFER,ge.__webglColorRenderbuffer[Ct])}i.bindRenderbuffer(i.RENDERBUFFER,null),ee.depthBuffer&&(ge.__webglDepthRenderbuffer=i.createRenderbuffer(),_t(ge.__webglDepthRenderbuffer,ee,!0)),t.bindFramebuffer(i.FRAMEBUFFER,null)}}if(Ue){t.bindTexture(i.TEXTURE_CUBE_MAP,Fe.__webglTexture),ae(i.TEXTURE_CUBE_MAP,q);for(let Ct=0;Ct<6;Ct++)if(q.mipmaps&&q.mipmaps.length>0)for(let Xt=0;Xt<q.mipmaps.length;Xt++)lt(ge.__webglFramebuffer[Ct][Xt],ee,q,i.COLOR_ATTACHMENT0,i.TEXTURE_CUBE_MAP_POSITIVE_X+Ct,Xt);else lt(ge.__webglFramebuffer[Ct],ee,q,i.COLOR_ATTACHMENT0,i.TEXTURE_CUBE_MAP_POSITIVE_X+Ct,0);w(q)&&T(i.TEXTURE_CUBE_MAP),t.unbindTexture()}else if(Ft){for(let Ct=0,Xt=Xe.length;Ct<Xt;Ct++){const an=Xe[Ct],tt=n.get(an);let it=i.TEXTURE_2D;(ee.isWebGL3DRenderTarget||ee.isWebGLArrayRenderTarget)&&(it=ee.isWebGL3DRenderTarget?i.TEXTURE_3D:i.TEXTURE_2D_ARRAY),t.bindTexture(it,tt.__webglTexture),ae(it,an),lt(ge.__webglFramebuffer,ee,an,i.COLOR_ATTACHMENT0+Ct,it,0),w(an)&&T(it)}t.unbindTexture()}else{let Ct=i.TEXTURE_2D;if((ee.isWebGL3DRenderTarget||ee.isWebGLArrayRenderTarget)&&(Ct=ee.isWebGL3DRenderTarget?i.TEXTURE_3D:i.TEXTURE_2D_ARRAY),t.bindTexture(Ct,Fe.__webglTexture),ae(Ct,q),q.mipmaps&&q.mipmaps.length>0)for(let Xt=0;Xt<q.mipmaps.length;Xt++)lt(ge.__webglFramebuffer[Xt],ee,q,i.COLOR_ATTACHMENT0,Ct,Xt);else lt(ge.__webglFramebuffer,ee,q,i.COLOR_ATTACHMENT0,Ct,0);w(q)&&T(Ct),t.unbindTexture()}ee.depthBuffer&&qt(ee)}function qe(ee){const q=ee.textures;for(let ge=0,Fe=q.length;ge<Fe;ge++){const Xe=q[ge];if(w(Xe)){const Ue=N(ee),Ft=n.get(Xe).__webglTexture;t.bindTexture(Ue,Ft),T(Ue),t.unbindTexture()}}}const rt=[],Je=[];function xt(ee){if(ee.samples>0){if(Lt(ee)===!1){const q=ee.textures,ge=ee.width,Fe=ee.height;let Xe=i.COLOR_BUFFER_BIT;const Ue=ee.stencilBuffer?i.DEPTH_STENCIL_ATTACHMENT:i.DEPTH_ATTACHMENT,Ft=n.get(ee),Ct=q.length>1;if(Ct)for(let an=0;an<q.length;an++)t.bindFramebuffer(i.FRAMEBUFFER,Ft.__webglMultisampledFramebuffer),i.framebufferRenderbuffer(i.FRAMEBUFFER,i.COLOR_ATTACHMENT0+an,i.RENDERBUFFER,null),t.bindFramebuffer(i.FRAMEBUFFER,Ft.__webglFramebuffer),i.framebufferTexture2D(i.DRAW_FRAMEBUFFER,i.COLOR_ATTACHMENT0+an,i.TEXTURE_2D,null,0);t.bindFramebuffer(i.READ_FRAMEBUFFER,Ft.__webglMultisampledFramebuffer);const Xt=ee.texture.mipmaps;Xt&&Xt.length>0?t.bindFramebuffer(i.DRAW_FRAMEBUFFER,Ft.__webglFramebuffer[0]):t.bindFramebuffer(i.DRAW_FRAMEBUFFER,Ft.__webglFramebuffer);for(let an=0;an<q.length;an++){if(ee.resolveDepthBuffer&&(ee.depthBuffer&&(Xe|=i.DEPTH_BUFFER_BIT),ee.stencilBuffer&&ee.resolveStencilBuffer&&(Xe|=i.STENCIL_BUFFER_BIT)),Ct){i.framebufferRenderbuffer(i.READ_FRAMEBUFFER,i.COLOR_ATTACHMENT0,i.RENDERBUFFER,Ft.__webglColorRenderbuffer[an]);const tt=n.get(q[an]).__webglTexture;i.framebufferTexture2D(i.DRAW_FRAMEBUFFER,i.COLOR_ATTACHMENT0,i.TEXTURE_2D,tt,0)}i.blitFramebuffer(0,0,ge,Fe,0,0,ge,Fe,Xe,i.NEAREST),f===!0&&(rt.length=0,Je.length=0,rt.push(i.COLOR_ATTACHMENT0+an),ee.depthBuffer&&ee.resolveDepthBuffer===!1&&(rt.push(Ue),Je.push(Ue),i.invalidateFramebuffer(i.DRAW_FRAMEBUFFER,Je)),i.invalidateFramebuffer(i.READ_FRAMEBUFFER,rt))}if(t.bindFramebuffer(i.READ_FRAMEBUFFER,null),t.bindFramebuffer(i.DRAW_FRAMEBUFFER,null),Ct)for(let an=0;an<q.length;an++){t.bindFramebuffer(i.FRAMEBUFFER,Ft.__webglMultisampledFramebuffer),i.framebufferRenderbuffer(i.FRAMEBUFFER,i.COLOR_ATTACHMENT0+an,i.RENDERBUFFER,Ft.__webglColorRenderbuffer[an]);const tt=n.get(q[an]).__webglTexture;t.bindFramebuffer(i.FRAMEBUFFER,Ft.__webglFramebuffer),i.framebufferTexture2D(i.DRAW_FRAMEBUFFER,i.COLOR_ATTACHMENT0+an,i.TEXTURE_2D,tt,0)}t.bindFramebuffer(i.DRAW_FRAMEBUFFER,Ft.__webglMultisampledFramebuffer)}else if(ee.depthBuffer&&ee.resolveDepthBuffer===!1&&f){const q=ee.stencilBuffer?i.DEPTH_STENCIL_ATTACHMENT:i.DEPTH_ATTACHMENT;i.invalidateFramebuffer(i.DRAW_FRAMEBUFFER,[q])}}}function re(ee){return Math.min(r.maxSamples,ee.samples)}function Lt(ee){const q=n.get(ee);return ee.samples>0&&e.has("WEBGL_multisampled_render_to_texture")===!0&&q.__useRenderToTexture!==!1}function vt(ee){const q=o.render.frame;g.get(ee)!==q&&(g.set(ee,q),ee.update())}function Qt(ee,q){const ge=ee.colorSpace,Fe=ee.format,Xe=ee.type;return ee.isCompressedTexture===!0||ee.isVideoTexture===!0||ge!==Xl&&ge!==Nu&&(oi.getTransfer(ge)===wi?(Fe!==jr||Xe!==vs)&&Ht("WebGLTextures: sRGB encoded textures have to use RGBAFormat and UnsignedByteType."):cn("WebGLTextures: Unsupported texture color space:",ge)),q}function bt(ee){return typeof HTMLImageElement<"u"&&ee instanceof HTMLImageElement?(p.width=ee.naturalWidth||ee.width,p.height=ee.naturalHeight||ee.height):typeof VideoFrame<"u"&&ee instanceof VideoFrame?(p.width=ee.displayWidth,p.height=ee.displayHeight):(p.width=ee.width,p.height=ee.height),p}this.allocateTextureUnit=j,this.resetTextureUnits=Y,this.setTexture2D=fe,this.setTexture2DArray=te,this.setTexture3D=se,this.setTextureCube=Ae,this.rebindTextures=un,this.setupRenderTarget=Yt,this.updateRenderTargetMipmap=qe,this.updateMultisampleRenderTarget=xt,this.setupDepthRenderbuffer=qt,this.setupFrameBufferTexture=lt,this.useMultisampledRTT=Lt,this.isReversedDepthBuffer=function(){return t.buffers.depth.getReversed()}}function $L(i,e){function t(n,r=Nu){let s;const o=oi.getTransfer(r);if(n===vs)return i.UNSIGNED_BYTE;if(n===cS)return i.UNSIGNED_SHORT_4_4_4_4;if(n===uS)return i.UNSIGNED_SHORT_5_5_5_1;if(n===nw)return i.UNSIGNED_INT_5_9_9_9_REV;if(n===iw)return i.UNSIGNED_INT_10F_11F_11F_REV;if(n===oS)return i.BYTE;if(n===lS)return i.SHORT;if(n===ag)return i.UNSIGNED_SHORT;if(n===yy)return i.INT;if(n===So)return i.UNSIGNED_INT;if(n===ir)return i.FLOAT;if(n===Er)return i.HALF_FLOAT;if(n===rw)return i.ALPHA;if(n===sw)return i.RGB;if(n===jr)return i.RGBA;if(n===jc)return i.DEPTH_COMPONENT;if(n===$h)return i.DEPTH_STENCIL;if(n===_y)return i.RED;if(n===xy)return i.RED_INTEGER;if(n===Zd)return i.RG;if(n===hS)return i.RG_INTEGER;if(n===fS)return i.RGBA_INTEGER;if(n===Mv||n===wv||n===Cv||n===Rv)if(o===wi)if(s=e.get("WEBGL_compressed_texture_s3tc_srgb"),s!==null){if(n===Mv)return s.COMPRESSED_SRGB_S3TC_DXT1_EXT;if(n===wv)return s.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT;if(n===Cv)return s.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT;if(n===Rv)return s.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT}else return null;else if(s=e.get("WEBGL_compressed_texture_s3tc"),s!==null){if(n===Mv)return s.COMPRESSED_RGB_S3TC_DXT1_EXT;if(n===wv)return s.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(n===Cv)return s.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(n===Rv)return s.COMPRESSED_RGBA_S3TC_DXT5_EXT}else return null;if(n===qb||n===Xb||n===Yb||n===Jb)if(s=e.get("WEBGL_compressed_texture_pvrtc"),s!==null){if(n===qb)return s.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(n===Xb)return s.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(n===Yb)return s.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(n===Jb)return s.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}else return null;if(n===Kb||n===Qb||n===Zb||n===$b||n===eA||n===tA||n===nA)if(s=e.get("WEBGL_compressed_texture_etc"),s!==null){if(n===Kb||n===Qb)return o===wi?s.COMPRESSED_SRGB8_ETC2:s.COMPRESSED_RGB8_ETC2;if(n===Zb)return o===wi?s.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC:s.COMPRESSED_RGBA8_ETC2_EAC;if(n===$b)return s.COMPRESSED_R11_EAC;if(n===eA)return s.COMPRESSED_SIGNED_R11_EAC;if(n===tA)return s.COMPRESSED_RG11_EAC;if(n===nA)return s.COMPRESSED_SIGNED_RG11_EAC}else return null;if(n===iA||n===rA||n===sA||n===aA||n===oA||n===lA||n===cA||n===uA||n===hA||n===fA||n===dA||n===pA||n===mA||n===gA)if(s=e.get("WEBGL_compressed_texture_astc"),s!==null){if(n===iA)return o===wi?s.COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR:s.COMPRESSED_RGBA_ASTC_4x4_KHR;if(n===rA)return o===wi?s.COMPRESSED_SRGB8_ALPHA8_ASTC_5x4_KHR:s.COMPRESSED_RGBA_ASTC_5x4_KHR;if(n===sA)return o===wi?s.COMPRESSED_SRGB8_ALPHA8_ASTC_5x5_KHR:s.COMPRESSED_RGBA_ASTC_5x5_KHR;if(n===aA)return o===wi?s.COMPRESSED_SRGB8_ALPHA8_ASTC_6x5_KHR:s.COMPRESSED_RGBA_ASTC_6x5_KHR;if(n===oA)return o===wi?s.COMPRESSED_SRGB8_ALPHA8_ASTC_6x6_KHR:s.COMPRESSED_RGBA_ASTC_6x6_KHR;if(n===lA)return o===wi?s.COMPRESSED_SRGB8_ALPHA8_ASTC_8x5_KHR:s.COMPRESSED_RGBA_ASTC_8x5_KHR;if(n===cA)return o===wi?s.COMPRESSED_SRGB8_ALPHA8_ASTC_8x6_KHR:s.COMPRESSED_RGBA_ASTC_8x6_KHR;if(n===uA)return o===wi?s.COMPRESSED_SRGB8_ALPHA8_ASTC_8x8_KHR:s.COMPRESSED_RGBA_ASTC_8x8_KHR;if(n===hA)return o===wi?s.COMPRESSED_SRGB8_ALPHA8_ASTC_10x5_KHR:s.COMPRESSED_RGBA_ASTC_10x5_KHR;if(n===fA)return o===wi?s.COMPRESSED_SRGB8_ALPHA8_ASTC_10x6_KHR:s.COMPRESSED_RGBA_ASTC_10x6_KHR;if(n===dA)return o===wi?s.COMPRESSED_SRGB8_ALPHA8_ASTC_10x8_KHR:s.COMPRESSED_RGBA_ASTC_10x8_KHR;if(n===pA)return o===wi?s.COMPRESSED_SRGB8_ALPHA8_ASTC_10x10_KHR:s.COMPRESSED_RGBA_ASTC_10x10_KHR;if(n===mA)return o===wi?s.COMPRESSED_SRGB8_ALPHA8_ASTC_12x10_KHR:s.COMPRESSED_RGBA_ASTC_12x10_KHR;if(n===gA)return o===wi?s.COMPRESSED_SRGB8_ALPHA8_ASTC_12x12_KHR:s.COMPRESSED_RGBA_ASTC_12x12_KHR}else return null;if(n===vA||n===yA||n===_A)if(s=e.get("EXT_texture_compression_bptc"),s!==null){if(n===vA)return o===wi?s.COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT:s.COMPRESSED_RGBA_BPTC_UNORM_EXT;if(n===yA)return s.COMPRESSED_RGB_BPTC_SIGNED_FLOAT_EXT;if(n===_A)return s.COMPRESSED_RGB_BPTC_UNSIGNED_FLOAT_EXT}else return null;if(n===xA||n===bA||n===AA||n===SA)if(s=e.get("EXT_texture_compression_rgtc"),s!==null){if(n===xA)return s.COMPRESSED_RED_RGTC1_EXT;if(n===bA)return s.COMPRESSED_SIGNED_RED_RGTC1_EXT;if(n===AA)return s.COMPRESSED_RED_GREEN_RGTC2_EXT;if(n===SA)return s.COMPRESSED_SIGNED_RED_GREEN_RGTC2_EXT}else return null;return n===og?i.UNSIGNED_INT_24_8:i[n]!==void 0?i[n]:null}return{convert:t}}const tX=`
void main() {

	gl_Position = vec4( position, 1.0 );

}`,nX=`
uniform sampler2DArray depthColor;
uniform float depthWidth;
uniform float depthHeight;

void main() {

	vec2 coord = vec2( gl_FragCoord.x / depthWidth, gl_FragCoord.y / depthHeight );

	if ( coord.x >= 1.0 ) {

		gl_FragDepth = texture( depthColor, vec3( coord.x - 1.0, coord.y, 1 ) ).r;

	} else {

		gl_FragDepth = texture( depthColor, vec3( coord.x, coord.y, 0 ) ).r;

	}

}`;class iX{constructor(){this.texture=null,this.mesh=null,this.depthNear=0,this.depthFar=0}init(e,t){if(this.texture===null){const n=new vw(e.texture);(e.depthNear!==t.depthNear||e.depthFar!==t.depthFar)&&(this.depthNear=e.depthNear,this.depthFar=e.depthFar),this.texture=n}}getMesh(e){if(this.texture!==null&&this.mesh===null){const t=e.cameras[0].viewport,n=new Gs({vertexShader:tX,fragmentShader:nX,uniforms:{depthColor:{value:this.texture},depthWidth:{value:t.z},depthHeight:{value:t.w}}});this.mesh=new rr(new Xu(20,20),n)}return this.mesh}reset(){this.texture=null,this.mesh=null}getDepthTexture(){return this.texture}}class rX extends Wc{constructor(e,t){super();const n=this;let r=null,s=1,o=null,u="local-floor",f=1,p=null,g=null,v=null,_=null,x=null,E=null;const C=typeof XRWebGLBinding<"u",w=new iX,T={},N=t.getContextAttributes();let L=null,F=null;const G=[],k=[],O=new $e;let D=null;const R=new hr;R.viewport=new zi;const P=new hr;P.viewport=new zi;const z=[R,P],Y=new GL;let j=null,ce=null;this.cameraAutoUpdate=!0,this.enabled=!1,this.isPresenting=!1,this.getController=function(ve){let Le=G[ve];return Le===void 0&&(Le=new mb,G[ve]=Le),Le.getTargetRaySpace()},this.getControllerGrip=function(ve){let Le=G[ve];return Le===void 0&&(Le=new mb,G[ve]=Le),Le.getGripSpace()},this.getHand=function(ve){let Le=G[ve];return Le===void 0&&(Le=new mb,G[ve]=Le),Le.getHandSpace()};function fe(ve){const Le=k.indexOf(ve.inputSource);if(Le===-1)return;const lt=G[Le];lt!==void 0&&(lt.update(ve.inputSource,ve.frame,p||o),lt.dispatchEvent({type:ve.type,data:ve.inputSource}))}function te(){r.removeEventListener("select",fe),r.removeEventListener("selectstart",fe),r.removeEventListener("selectend",fe),r.removeEventListener("squeeze",fe),r.removeEventListener("squeezestart",fe),r.removeEventListener("squeezeend",fe),r.removeEventListener("end",te),r.removeEventListener("inputsourceschange",se);for(let ve=0;ve<G.length;ve++){const Le=k[ve];Le!==null&&(k[ve]=null,G[ve].disconnect(Le))}j=null,ce=null,w.reset();for(const ve in T)delete T[ve];e.setRenderTarget(L),x=null,_=null,v=null,r=null,F=null,dt.stop(),n.isPresenting=!1,e.setPixelRatio(D),e.setSize(O.width,O.height,!1),n.dispatchEvent({type:"sessionend"})}this.setFramebufferScaleFactor=function(ve){s=ve,n.isPresenting===!0&&Ht("WebXRManager: Cannot change framebuffer scale while presenting.")},this.setReferenceSpaceType=function(ve){u=ve,n.isPresenting===!0&&Ht("WebXRManager: Cannot change reference space type while presenting.")},this.getReferenceSpace=function(){return p||o},this.setReferenceSpace=function(ve){p=ve},this.getBaseLayer=function(){return _!==null?_:x},this.getBinding=function(){return v===null&&C&&(v=new XRWebGLBinding(r,t)),v},this.getFrame=function(){return E},this.getSession=function(){return r},this.setSession=async function(ve){if(r=ve,r!==null){if(L=e.getRenderTarget(),r.addEventListener("select",fe),r.addEventListener("selectstart",fe),r.addEventListener("selectend",fe),r.addEventListener("squeeze",fe),r.addEventListener("squeezestart",fe),r.addEventListener("squeezeend",fe),r.addEventListener("end",te),r.addEventListener("inputsourceschange",se),N.xrCompatible!==!0&&await t.makeXRCompatible(),D=e.getPixelRatio(),e.getSize(O),C&&"createProjectionLayer"in XRWebGLBinding.prototype){let lt=null,_t=null,Dt=null;N.depth&&(Dt=N.stencil?t.DEPTH24_STENCIL8:t.DEPTH_COMPONENT24,lt=N.stencil?$h:jc,_t=N.stencil?og:So);const qt={colorFormat:t.RGBA8,depthFormat:Dt,scaleFactor:s};v=this.getBinding(),_=v.createProjectionLayer(qt),r.updateRenderState({layers:[_]}),e.setPixelRatio(1),e.setSize(_.textureWidth,_.textureHeight,!1),F=new _s(_.textureWidth,_.textureHeight,{format:jr,type:vs,depthTexture:new ep(_.textureWidth,_.textureHeight,_t,void 0,void 0,void 0,void 0,void 0,void 0,lt),stencilBuffer:N.stencil,colorSpace:e.outputColorSpace,samples:N.antialias?4:0,resolveDepthBuffer:_.ignoreDepthValues===!1,resolveStencilBuffer:_.ignoreDepthValues===!1})}else{const lt={antialias:N.antialias,alpha:!0,depth:N.depth,stencil:N.stencil,framebufferScaleFactor:s};x=new XRWebGLLayer(r,t,lt),r.updateRenderState({baseLayer:x}),e.setPixelRatio(1),e.setSize(x.framebufferWidth,x.framebufferHeight,!1),F=new _s(x.framebufferWidth,x.framebufferHeight,{format:jr,type:vs,colorSpace:e.outputColorSpace,stencilBuffer:N.stencil,resolveDepthBuffer:x.ignoreDepthValues===!1,resolveStencilBuffer:x.ignoreDepthValues===!1})}F.isXRRenderTarget=!0,this.setFoveation(f),p=null,o=await r.requestReferenceSpace(u),dt.setContext(r),dt.start(),n.isPresenting=!0,n.dispatchEvent({type:"sessionstart"})}},this.getEnvironmentBlendMode=function(){if(r!==null)return r.environmentBlendMode},this.getDepthTexture=function(){return w.getDepthTexture()};function se(ve){for(let Le=0;Le<ve.removed.length;Le++){const lt=ve.removed[Le],_t=k.indexOf(lt);_t>=0&&(k[_t]=null,G[_t].disconnect(lt))}for(let Le=0;Le<ve.added.length;Le++){const lt=ve.added[Le];let _t=k.indexOf(lt);if(_t===-1){for(let qt=0;qt<G.length;qt++)if(qt>=k.length){k.push(lt),_t=qt;break}else if(k[qt]===null){k[qt]=lt,_t=qt;break}if(_t===-1)break}const Dt=G[_t];Dt&&Dt.connect(lt)}}const Ae=new ie,Pe=new ie;function Re(ve,Le,lt){Ae.setFromMatrixPosition(Le.matrixWorld),Pe.setFromMatrixPosition(lt.matrixWorld);const _t=Ae.distanceTo(Pe),Dt=Le.projectionMatrix.elements,qt=lt.projectionMatrix.elements,un=Dt[14]/(Dt[10]-1),Yt=Dt[14]/(Dt[10]+1),qe=(Dt[9]+1)/Dt[5],rt=(Dt[9]-1)/Dt[5],Je=(Dt[8]-1)/Dt[0],xt=(qt[8]+1)/qt[0],re=un*Je,Lt=un*xt,vt=_t/(-Je+xt),Qt=vt*-Je;if(Le.matrixWorld.decompose(ve.position,ve.quaternion,ve.scale),ve.translateX(Qt),ve.translateZ(vt),ve.matrixWorld.compose(ve.position,ve.quaternion,ve.scale),ve.matrixWorldInverse.copy(ve.matrixWorld).invert(),Dt[10]===-1)ve.projectionMatrix.copy(Le.projectionMatrix),ve.projectionMatrixInverse.copy(Le.projectionMatrixInverse);else{const bt=un+vt,ee=Yt+vt,q=re-Qt,ge=Lt+(_t-Qt),Fe=qe*Yt/ee*bt,Xe=rt*Yt/ee*bt;ve.projectionMatrix.makePerspective(q,ge,Fe,Xe,bt,ee),ve.projectionMatrixInverse.copy(ve.projectionMatrix).invert()}}function $(ve,Le){Le===null?ve.matrixWorld.copy(ve.matrix):ve.matrixWorld.multiplyMatrices(Le.matrixWorld,ve.matrix),ve.matrixWorldInverse.copy(ve.matrixWorld).invert()}this.updateCamera=function(ve){if(r===null)return;let Le=ve.near,lt=ve.far;w.texture!==null&&(w.depthNear>0&&(Le=w.depthNear),w.depthFar>0&&(lt=w.depthFar)),Y.near=P.near=R.near=Le,Y.far=P.far=R.far=lt,(j!==Y.near||ce!==Y.far)&&(r.updateRenderState({depthNear:Y.near,depthFar:Y.far}),j=Y.near,ce=Y.far),Y.layers.mask=ve.layers.mask|6,R.layers.mask=Y.layers.mask&3,P.layers.mask=Y.layers.mask&5;const _t=ve.parent,Dt=Y.cameras;$(Y,_t);for(let qt=0;qt<Dt.length;qt++)$(Dt[qt],_t);Dt.length===2?Re(Y,R,P):Y.projectionMatrix.copy(R.projectionMatrix),ae(ve,Y,_t)};function ae(ve,Le,lt){lt===null?ve.matrix.copy(Le.matrixWorld):(ve.matrix.copy(lt.matrixWorld),ve.matrix.invert(),ve.matrix.multiply(Le.matrixWorld)),ve.matrix.decompose(ve.position,ve.quaternion,ve.scale),ve.updateMatrixWorld(!0),ve.projectionMatrix.copy(Le.projectionMatrix),ve.projectionMatrixInverse.copy(Le.projectionMatrixInverse),ve.isPerspectiveCamera&&(ve.fov=fg*2*Math.atan(1/ve.projectionMatrix.elements[5]),ve.zoom=1)}this.getCamera=function(){return Y},this.getFoveation=function(){if(!(_===null&&x===null))return f},this.setFoveation=function(ve){f=ve,_!==null&&(_.fixedFoveation=ve),x!==null&&x.fixedFoveation!==void 0&&(x.fixedFoveation=ve)},this.hasDepthSensing=function(){return w.texture!==null},this.getDepthSensingMesh=function(){return w.getMesh(Y)},this.getCameraTexture=function(ve){return T[ve]};let Se=null;function ke(ve,Le){if(g=Le.getViewerPose(p||o),E=Le,g!==null){const lt=g.views;x!==null&&(e.setRenderTargetFramebuffer(F,x.framebuffer),e.setRenderTarget(F));let _t=!1;lt.length!==Y.cameras.length&&(Y.cameras.length=0,_t=!0);for(let Yt=0;Yt<lt.length;Yt++){const qe=lt[Yt];let rt=null;if(x!==null)rt=x.getViewport(qe);else{const xt=v.getViewSubImage(_,qe);rt=xt.viewport,Yt===0&&(e.setRenderTargetTextures(F,xt.colorTexture,xt.depthStencilTexture),e.setRenderTarget(F))}let Je=z[Yt];Je===void 0&&(Je=new hr,Je.layers.enable(Yt),Je.viewport=new zi,z[Yt]=Je),Je.matrix.fromArray(qe.transform.matrix),Je.matrix.decompose(Je.position,Je.quaternion,Je.scale),Je.projectionMatrix.fromArray(qe.projectionMatrix),Je.projectionMatrixInverse.copy(Je.projectionMatrix).invert(),Je.viewport.set(rt.x,rt.y,rt.width,rt.height),Yt===0&&(Y.matrix.copy(Je.matrix),Y.matrix.decompose(Y.position,Y.quaternion,Y.scale)),_t===!0&&Y.cameras.push(Je)}const Dt=r.enabledFeatures;if(Dt&&Dt.includes("depth-sensing")&&r.depthUsage=="gpu-optimized"&&C){v=n.getBinding();const Yt=v.getDepthInformation(lt[0]);Yt&&Yt.isValid&&Yt.texture&&w.init(Yt,r.renderState)}if(Dt&&Dt.includes("camera-access")&&C){e.state.unbindTexture(),v=n.getBinding();for(let Yt=0;Yt<lt.length;Yt++){const qe=lt[Yt].camera;if(qe){let rt=T[qe];rt||(rt=new vw,T[qe]=rt);const Je=v.getCameraImage(qe);rt.sourceTexture=Je}}}}for(let lt=0;lt<G.length;lt++){const _t=k[lt],Dt=G[lt];_t!==null&&Dt!==void 0&&Dt.update(_t,Le,p||o)}Se&&Se(ve,Le),Le.detectedPlanes&&n.dispatchEvent({type:"planesdetected",data:Le}),E=null}const dt=new YL;dt.setAnimationLoop(ke),this.setAnimationLoop=function(ve){Se=ve},this.dispose=function(){}}}const Sd=new Eo,sX=new vn;function aX(i,e){function t(w,T){w.matrixAutoUpdate===!0&&w.updateMatrix(),T.value.copy(w.matrix)}function n(w,T){T.color.getRGB(w.fogColor.value,nL(i)),T.isFog?(w.fogNear.value=T.near,w.fogFar.value=T.far):T.isFogExp2&&(w.fogDensity.value=T.density)}function r(w,T,N,L,F){T.isMeshBasicMaterial||T.isMeshLambertMaterial?s(w,T):T.isMeshToonMaterial?(s(w,T),v(w,T)):T.isMeshPhongMaterial?(s(w,T),g(w,T)):T.isMeshStandardMaterial?(s(w,T),_(w,T),T.isMeshPhysicalMaterial&&x(w,T,F)):T.isMeshMatcapMaterial?(s(w,T),E(w,T)):T.isMeshDepthMaterial?s(w,T):T.isMeshDistanceMaterial?(s(w,T),C(w,T)):T.isMeshNormalMaterial?s(w,T):T.isLineBasicMaterial?(o(w,T),T.isLineDashedMaterial&&u(w,T)):T.isPointsMaterial?f(w,T,N,L):T.isSpriteMaterial?p(w,T):T.isShadowMaterial?(w.color.value.copy(T.color),w.opacity.value=T.opacity):T.isShaderMaterial&&(T.uniformsNeedUpdate=!1)}function s(w,T){w.opacity.value=T.opacity,T.color&&w.diffuse.value.copy(T.color),T.emissive&&w.emissive.value.copy(T.emissive).multiplyScalar(T.emissiveIntensity),T.map&&(w.map.value=T.map,t(T.map,w.mapTransform)),T.alphaMap&&(w.alphaMap.value=T.alphaMap,t(T.alphaMap,w.alphaMapTransform)),T.bumpMap&&(w.bumpMap.value=T.bumpMap,t(T.bumpMap,w.bumpMapTransform),w.bumpScale.value=T.bumpScale,T.side===Ca&&(w.bumpScale.value*=-1)),T.normalMap&&(w.normalMap.value=T.normalMap,t(T.normalMap,w.normalMapTransform),w.normalScale.value.copy(T.normalScale),T.side===Ca&&w.normalScale.value.negate()),T.displacementMap&&(w.displacementMap.value=T.displacementMap,t(T.displacementMap,w.displacementMapTransform),w.displacementScale.value=T.displacementScale,w.displacementBias.value=T.displacementBias),T.emissiveMap&&(w.emissiveMap.value=T.emissiveMap,t(T.emissiveMap,w.emissiveMapTransform)),T.specularMap&&(w.specularMap.value=T.specularMap,t(T.specularMap,w.specularMapTransform)),T.alphaTest>0&&(w.alphaTest.value=T.alphaTest);const N=e.get(T),L=N.envMap,F=N.envMapRotation;L&&(w.envMap.value=L,Sd.copy(F),Sd.x*=-1,Sd.y*=-1,Sd.z*=-1,L.isCubeTexture&&L.isRenderTargetTexture===!1&&(Sd.y*=-1,Sd.z*=-1),w.envMapRotation.value.setFromMatrix4(sX.makeRotationFromEuler(Sd)),w.flipEnvMap.value=L.isCubeTexture&&L.isRenderTargetTexture===!1?-1:1,w.reflectivity.value=T.reflectivity,w.ior.value=T.ior,w.refractionRatio.value=T.refractionRatio),T.lightMap&&(w.lightMap.value=T.lightMap,w.lightMapIntensity.value=T.lightMapIntensity,t(T.lightMap,w.lightMapTransform)),T.aoMap&&(w.aoMap.value=T.aoMap,w.aoMapIntensity.value=T.aoMapIntensity,t(T.aoMap,w.aoMapTransform))}function o(w,T){w.diffuse.value.copy(T.color),w.opacity.value=T.opacity,T.map&&(w.map.value=T.map,t(T.map,w.mapTransform))}function u(w,T){w.dashSize.value=T.dashSize,w.totalSize.value=T.dashSize+T.gapSize,w.scale.value=T.scale}function f(w,T,N,L){w.diffuse.value.copy(T.color),w.opacity.value=T.opacity,w.size.value=T.size*N,w.scale.value=L*.5,T.map&&(w.map.value=T.map,t(T.map,w.uvTransform)),T.alphaMap&&(w.alphaMap.value=T.alphaMap,t(T.alphaMap,w.alphaMapTransform)),T.alphaTest>0&&(w.alphaTest.value=T.alphaTest)}function p(w,T){w.diffuse.value.copy(T.color),w.opacity.value=T.opacity,w.rotation.value=T.rotation,T.map&&(w.map.value=T.map,t(T.map,w.mapTransform)),T.alphaMap&&(w.alphaMap.value=T.alphaMap,t(T.alphaMap,w.alphaMapTransform)),T.alphaTest>0&&(w.alphaTest.value=T.alphaTest)}function g(w,T){w.specular.value.copy(T.specular),w.shininess.value=Math.max(T.shininess,1e-4)}function v(w,T){T.gradientMap&&(w.gradientMap.value=T.gradientMap)}function _(w,T){w.metalness.value=T.metalness,T.metalnessMap&&(w.metalnessMap.value=T.metalnessMap,t(T.metalnessMap,w.metalnessMapTransform)),w.roughness.value=T.roughness,T.roughnessMap&&(w.roughnessMap.value=T.roughnessMap,t(T.roughnessMap,w.roughnessMapTransform)),T.envMap&&(w.envMapIntensity.value=T.envMapIntensity)}function x(w,T,N){w.ior.value=T.ior,T.sheen>0&&(w.sheenColor.value.copy(T.sheenColor).multiplyScalar(T.sheen),w.sheenRoughness.value=T.sheenRoughness,T.sheenColorMap&&(w.sheenColorMap.value=T.sheenColorMap,t(T.sheenColorMap,w.sheenColorMapTransform)),T.sheenRoughnessMap&&(w.sheenRoughnessMap.value=T.sheenRoughnessMap,t(T.sheenRoughnessMap,w.sheenRoughnessMapTransform))),T.clearcoat>0&&(w.clearcoat.value=T.clearcoat,w.clearcoatRoughness.value=T.clearcoatRoughness,T.clearcoatMap&&(w.clearcoatMap.value=T.clearcoatMap,t(T.clearcoatMap,w.clearcoatMapTransform)),T.clearcoatRoughnessMap&&(w.clearcoatRoughnessMap.value=T.clearcoatRoughnessMap,t(T.clearcoatRoughnessMap,w.clearcoatRoughnessMapTransform)),T.clearcoatNormalMap&&(w.clearcoatNormalMap.value=T.clearcoatNormalMap,t(T.clearcoatNormalMap,w.clearcoatNormalMapTransform),w.clearcoatNormalScale.value.copy(T.clearcoatNormalScale),T.side===Ca&&w.clearcoatNormalScale.value.negate())),T.dispersion>0&&(w.dispersion.value=T.dispersion),T.iridescence>0&&(w.iridescence.value=T.iridescence,w.iridescenceIOR.value=T.iridescenceIOR,w.iridescenceThicknessMinimum.value=T.iridescenceThicknessRange[0],w.iridescenceThicknessMaximum.value=T.iridescenceThicknessRange[1],T.iridescenceMap&&(w.iridescenceMap.value=T.iridescenceMap,t(T.iridescenceMap,w.iridescenceMapTransform)),T.iridescenceThicknessMap&&(w.iridescenceThicknessMap.value=T.iridescenceThicknessMap,t(T.iridescenceThicknessMap,w.iridescenceThicknessMapTransform))),T.transmission>0&&(w.transmission.value=T.transmission,w.transmissionSamplerMap.value=N.texture,w.transmissionSamplerSize.value.set(N.width,N.height),T.transmissionMap&&(w.transmissionMap.value=T.transmissionMap,t(T.transmissionMap,w.transmissionMapTransform)),w.thickness.value=T.thickness,T.thicknessMap&&(w.thicknessMap.value=T.thicknessMap,t(T.thicknessMap,w.thicknessMapTransform)),w.attenuationDistance.value=T.attenuationDistance,w.attenuationColor.value.copy(T.attenuationColor)),T.anisotropy>0&&(w.anisotropyVector.value.set(T.anisotropy*Math.cos(T.anisotropyRotation),T.anisotropy*Math.sin(T.anisotropyRotation)),T.anisotropyMap&&(w.anisotropyMap.value=T.anisotropyMap,t(T.anisotropyMap,w.anisotropyMapTransform))),w.specularIntensity.value=T.specularIntensity,w.specularColor.value.copy(T.specularColor),T.specularColorMap&&(w.specularColorMap.value=T.specularColorMap,t(T.specularColorMap,w.specularColorMapTransform)),T.specularIntensityMap&&(w.specularIntensityMap.value=T.specularIntensityMap,t(T.specularIntensityMap,w.specularIntensityMapTransform))}function E(w,T){T.matcap&&(w.matcap.value=T.matcap)}function C(w,T){const N=e.get(T).light;w.referencePosition.value.setFromMatrixPosition(N.matrixWorld),w.nearDistance.value=N.shadow.camera.near,w.farDistance.value=N.shadow.camera.far}return{refreshFogUniforms:n,refreshMaterialUniforms:r}}function oX(i,e,t,n){let r={},s={},o=[];const u=i.getParameter(i.MAX_UNIFORM_BUFFER_BINDINGS);function f(N,L){const F=L.program;n.uniformBlockBinding(N,F)}function p(N,L){let F=r[N.id];F===void 0&&(E(N),F=g(N),r[N.id]=F,N.addEventListener("dispose",w));const G=L.program;n.updateUBOMapping(N,G);const k=e.render.frame;s[N.id]!==k&&(_(N),s[N.id]=k)}function g(N){const L=v();N.__bindingPointIndex=L;const F=i.createBuffer(),G=N.__size,k=N.usage;return i.bindBuffer(i.UNIFORM_BUFFER,F),i.bufferData(i.UNIFORM_BUFFER,G,k),i.bindBuffer(i.UNIFORM_BUFFER,null),i.bindBufferBase(i.UNIFORM_BUFFER,L,F),F}function v(){for(let N=0;N<u;N++)if(o.indexOf(N)===-1)return o.push(N),N;return cn("WebGLRenderer: Maximum number of simultaneously usable uniforms groups reached."),0}function _(N){const L=r[N.id],F=N.uniforms,G=N.__cache;i.bindBuffer(i.UNIFORM_BUFFER,L);for(let k=0,O=F.length;k<O;k++){const D=Array.isArray(F[k])?F[k]:[F[k]];for(let R=0,P=D.length;R<P;R++){const z=D[R];if(x(z,k,R,G)===!0){const Y=z.__offset,j=Array.isArray(z.value)?z.value:[z.value];let ce=0;for(let fe=0;fe<j.length;fe++){const te=j[fe],se=C(te);typeof te=="number"||typeof te=="boolean"?(z.__data[0]=te,i.bufferSubData(i.UNIFORM_BUFFER,Y+ce,z.__data)):te.isMatrix3?(z.__data[0]=te.elements[0],z.__data[1]=te.elements[1],z.__data[2]=te.elements[2],z.__data[3]=0,z.__data[4]=te.elements[3],z.__data[5]=te.elements[4],z.__data[6]=te.elements[5],z.__data[7]=0,z.__data[8]=te.elements[6],z.__data[9]=te.elements[7],z.__data[10]=te.elements[8],z.__data[11]=0):(te.toArray(z.__data,ce),ce+=se.storage/Float32Array.BYTES_PER_ELEMENT)}i.bufferSubData(i.UNIFORM_BUFFER,Y,z.__data)}}}i.bindBuffer(i.UNIFORM_BUFFER,null)}function x(N,L,F,G){const k=N.value,O=L+"_"+F;if(G[O]===void 0)return typeof k=="number"||typeof k=="boolean"?G[O]=k:G[O]=k.clone(),!0;{const D=G[O];if(typeof k=="number"||typeof k=="boolean"){if(D!==k)return G[O]=k,!0}else if(D.equals(k)===!1)return D.copy(k),!0}return!1}function E(N){const L=N.uniforms;let F=0;const G=16;for(let O=0,D=L.length;O<D;O++){const R=Array.isArray(L[O])?L[O]:[L[O]];for(let P=0,z=R.length;P<z;P++){const Y=R[P],j=Array.isArray(Y.value)?Y.value:[Y.value];for(let ce=0,fe=j.length;ce<fe;ce++){const te=j[ce],se=C(te),Ae=F%G,Pe=Ae%se.boundary,Re=Ae+Pe;F+=Pe,Re!==0&&G-Re<se.storage&&(F+=G-Re),Y.__data=new Float32Array(se.storage/Float32Array.BYTES_PER_ELEMENT),Y.__offset=F,F+=se.storage}}}const k=F%G;return k>0&&(F+=G-k),N.__size=F,N.__cache={},this}function C(N){const L={boundary:0,storage:0};return typeof N=="number"||typeof N=="boolean"?(L.boundary=4,L.storage=4):N.isVector2?(L.boundary=8,L.storage=8):N.isVector3||N.isColor?(L.boundary=16,L.storage=12):N.isVector4?(L.boundary=16,L.storage=16):N.isMatrix3?(L.boundary=48,L.storage=48):N.isMatrix4?(L.boundary=64,L.storage=64):N.isTexture?Ht("WebGLRenderer: Texture samplers can not be part of an uniforms group."):Ht("WebGLRenderer: Unsupported uniform value type.",N),L}function w(N){const L=N.target;L.removeEventListener("dispose",w);const F=o.indexOf(L.__bindingPointIndex);o.splice(F,1),i.deleteBuffer(r[L.id]),delete r[L.id],delete s[L.id]}function T(){for(const N in r)i.deleteBuffer(r[N]);o=[],r={},s={}}return{bind:f,update:p,dispose:T}}const lX=new Uint16Array([12469,15057,12620,14925,13266,14620,13807,14376,14323,13990,14545,13625,14713,13328,14840,12882,14931,12528,14996,12233,15039,11829,15066,11525,15080,11295,15085,10976,15082,10705,15073,10495,13880,14564,13898,14542,13977,14430,14158,14124,14393,13732,14556,13410,14702,12996,14814,12596,14891,12291,14937,11834,14957,11489,14958,11194,14943,10803,14921,10506,14893,10278,14858,9960,14484,14039,14487,14025,14499,13941,14524,13740,14574,13468,14654,13106,14743,12678,14818,12344,14867,11893,14889,11509,14893,11180,14881,10751,14852,10428,14812,10128,14765,9754,14712,9466,14764,13480,14764,13475,14766,13440,14766,13347,14769,13070,14786,12713,14816,12387,14844,11957,14860,11549,14868,11215,14855,10751,14825,10403,14782,10044,14729,9651,14666,9352,14599,9029,14967,12835,14966,12831,14963,12804,14954,12723,14936,12564,14917,12347,14900,11958,14886,11569,14878,11247,14859,10765,14828,10401,14784,10011,14727,9600,14660,9289,14586,8893,14508,8533,15111,12234,15110,12234,15104,12216,15092,12156,15067,12010,15028,11776,14981,11500,14942,11205,14902,10752,14861,10393,14812,9991,14752,9570,14682,9252,14603,8808,14519,8445,14431,8145,15209,11449,15208,11451,15202,11451,15190,11438,15163,11384,15117,11274,15055,10979,14994,10648,14932,10343,14871,9936,14803,9532,14729,9218,14645,8742,14556,8381,14461,8020,14365,7603,15273,10603,15272,10607,15267,10619,15256,10631,15231,10614,15182,10535,15118,10389,15042,10167,14963,9787,14883,9447,14800,9115,14710,8665,14615,8318,14514,7911,14411,7507,14279,7198,15314,9675,15313,9683,15309,9712,15298,9759,15277,9797,15229,9773,15166,9668,15084,9487,14995,9274,14898,8910,14800,8539,14697,8234,14590,7790,14479,7409,14367,7067,14178,6621,15337,8619,15337,8631,15333,8677,15325,8769,15305,8871,15264,8940,15202,8909,15119,8775,15022,8565,14916,8328,14804,8009,14688,7614,14569,7287,14448,6888,14321,6483,14088,6171,15350,7402,15350,7419,15347,7480,15340,7613,15322,7804,15287,7973,15229,8057,15148,8012,15046,7846,14933,7611,14810,7357,14682,7069,14552,6656,14421,6316,14251,5948,14007,5528,15356,5942,15356,5977,15353,6119,15348,6294,15332,6551,15302,6824,15249,7044,15171,7122,15070,7050,14949,6861,14818,6611,14679,6349,14538,6067,14398,5651,14189,5311,13935,4958,15359,4123,15359,4153,15356,4296,15353,4646,15338,5160,15311,5508,15263,5829,15188,6042,15088,6094,14966,6001,14826,5796,14678,5543,14527,5287,14377,4985,14133,4586,13869,4257,15360,1563,15360,1642,15358,2076,15354,2636,15341,3350,15317,4019,15273,4429,15203,4732,15105,4911,14981,4932,14836,4818,14679,4621,14517,4386,14359,4156,14083,3795,13808,3437,15360,122,15360,137,15358,285,15355,636,15344,1274,15322,2177,15281,2765,15215,3223,15120,3451,14995,3569,14846,3567,14681,3466,14511,3305,14344,3121,14037,2800,13753,2467,15360,0,15360,1,15359,21,15355,89,15346,253,15325,479,15287,796,15225,1148,15133,1492,15008,1749,14856,1882,14685,1886,14506,1783,14324,1608,13996,1398,13702,1183]);let Dc=null;function cX(){return Dc===null&&(Dc=new ll(lX,16,16,Zd,Er),Dc.name="DFG_LUT",Dc.minFilter=Jn,Dc.magFilter=Jn,Dc.wrapS=Sr,Dc.wrapT=Sr,Dc.generateMipmaps=!1,Dc.needsUpdate=!0),Dc}class Hw{constructor(e={}){const{canvas:t=ZB(),context:n=null,depth:r=!0,stencil:s=!1,alpha:o=!1,antialias:u=!1,premultipliedAlpha:f=!0,preserveDrawingBuffer:p=!1,powerPreference:g="default",failIfMajorPerformanceCaveat:v=!1,reversedDepthBuffer:_=!1,outputBufferType:x=vs}=e;this.isWebGLRenderer=!0;let E;if(n!==null){if(typeof WebGLRenderingContext<"u"&&n instanceof WebGLRenderingContext)throw new Error("THREE.WebGLRenderer: WebGL 1 is not supported since r163.");E=n.getContextAttributes().alpha}else E=o;const C=x,w=new Set([fS,hS,xy]),T=new Set([vs,So,ag,og,cS,uS]),N=new Uint32Array(4),L=new Int32Array(4);let F=null,G=null;const k=[],O=[];let D=null;this.domElement=t,this.debug={checkShaderErrors:!0,onShaderError:null},this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.sortObjects=!0,this.clippingPlanes=[],this.localClippingEnabled=!1,this.toneMapping=ol,this.toneMappingExposure=1,this.transmissionResolutionScale=1;const R=this;let P=!1;this._outputColorSpace=Fs;let z=0,Y=0,j=null,ce=-1,fe=null;const te=new zi,se=new zi;let Ae=null;const Pe=new Gt(0);let Re=0,$=t.width,ae=t.height,Se=1,ke=null,dt=null;const ve=new zi(0,0,$,ae),Le=new zi(0,0,$,ae);let lt=!1;const _t=new wg;let Dt=!1,qt=!1;const un=new vn,Yt=new ie,qe=new zi,rt={background:null,fog:null,environment:null,overrideMaterial:null,isScene:!0};let Je=!1;function xt(){return j===null?Se:1}let re=n;function Lt(J,le){return t.getContext(J,le)}try{const J={alpha:!0,depth:r,stencil:s,antialias:u,premultipliedAlpha:f,preserveDrawingBuffer:p,powerPreference:g,failIfMajorPerformanceCaveat:v};if("setAttribute"in t&&t.setAttribute("data-engine",`three.js r${gy}`),t.addEventListener("webglcontextlost",rn,!1),t.addEventListener("webglcontextrestored",Tn,!1),t.addEventListener("webglcontextcreationerror",yn,!1),re===null){const le="webgl2";if(re=Lt(le,J),re===null)throw Lt(le)?new Error("Error creating WebGL context with your selected attributes."):new Error("Error creating WebGL context.")}}catch(J){throw cn("WebGLRenderer: "+J.message),J}let vt,Qt,bt,ee,q,ge,Fe,Xe,Ue,Ft,Ct,Xt,an,tt,it,Ut,oe,Te,ot,ue,Ce,at,gt,ut;function Ye(){vt=new uW(re),vt.init(),at=new $L(re,vt),Qt=new tW(re,vt,e,at),bt=new $q(re,vt),Qt.reversedDepthBuffer&&_&&bt.buffers.depth.setReversed(!0),ee=new dW(re),q=new Fq,ge=new eX(re,vt,bt,q,Qt,at,ee),Fe=new iW(R),Xe=new cW(R),Ue=new v2(re),gt=new $j(re,Ue),Ft=new hW(re,Ue,ee,gt),Ct=new mW(re,Ft,Ue,ee),ot=new pW(re,Qt,ge),Ut=new nW(q),Xt=new Uq(R,Fe,Xe,vt,Qt,gt,Ut),an=new aX(R,q),tt=new zq,it=new qq(vt),Te=new Zj(R,Fe,Xe,bt,Ct,E,f),oe=new Qq(R,Ct,Qt),ut=new oX(re,ee,Qt,bt),ue=new eW(re,vt,ee),Ce=new fW(re,vt,ee),ee.programs=Xt.programs,R.capabilities=Qt,R.extensions=vt,R.properties=q,R.renderLists=tt,R.shadowMap=oe,R.state=bt,R.info=ee}Ye(),C!==vs&&(D=new vW(C,t.width,t.height,r,s));const pt=new rX(R,re);this.xr=pt,this.getContext=function(){return re},this.getContextAttributes=function(){return re.getContextAttributes()},this.forceContextLoss=function(){const J=vt.get("WEBGL_lose_context");J&&J.loseContext()},this.forceContextRestore=function(){const J=vt.get("WEBGL_lose_context");J&&J.restoreContext()},this.getPixelRatio=function(){return Se},this.setPixelRatio=function(J){J!==void 0&&(Se=J,this.setSize($,ae,!1))},this.getSize=function(J){return J.set($,ae)},this.setSize=function(J,le,ye=!0){if(pt.isPresenting){Ht("WebGLRenderer: Can't change size while VR device is presenting.");return}$=J,ae=le,t.width=Math.floor(J*Se),t.height=Math.floor(le*Se),ye===!0&&(t.style.width=J+"px",t.style.height=le+"px"),D!==null&&D.setSize(t.width,t.height),this.setViewport(0,0,J,le)},this.getDrawingBufferSize=function(J){return J.set($*Se,ae*Se).floor()},this.setDrawingBufferSize=function(J,le,ye){$=J,ae=le,Se=ye,t.width=Math.floor(J*ye),t.height=Math.floor(le*ye),this.setViewport(0,0,J,le)},this.setEffects=function(J){if(C===vs){console.error("THREE.WebGLRenderer: setEffects() requires outputBufferType set to HalfFloatType or FloatType.");return}if(J){for(let le=0;le<J.length;le++)if(J[le].isOutputPass===!0){console.warn("THREE.WebGLRenderer: OutputPass is not needed in setEffects(). Tone mapping and color space conversion are applied automatically.");break}}D.setEffects(J||[])},this.getCurrentViewport=function(J){return J.copy(te)},this.getViewport=function(J){return J.copy(ve)},this.setViewport=function(J,le,ye,xe){J.isVector4?ve.set(J.x,J.y,J.z,J.w):ve.set(J,le,ye,xe),bt.viewport(te.copy(ve).multiplyScalar(Se).round())},this.getScissor=function(J){return J.copy(Le)},this.setScissor=function(J,le,ye,xe){J.isVector4?Le.set(J.x,J.y,J.z,J.w):Le.set(J,le,ye,xe),bt.scissor(se.copy(Le).multiplyScalar(Se).round())},this.getScissorTest=function(){return lt},this.setScissorTest=function(J){bt.setScissorTest(lt=J)},this.setOpaqueSort=function(J){ke=J},this.setTransparentSort=function(J){dt=J},this.getClearColor=function(J){return J.copy(Te.getClearColor())},this.setClearColor=function(){Te.setClearColor(...arguments)},this.getClearAlpha=function(){return Te.getClearAlpha()},this.setClearAlpha=function(){Te.setClearAlpha(...arguments)},this.clear=function(J=!0,le=!0,ye=!0){let xe=0;if(J){let me=!1;if(j!==null){const Qe=j.texture.format;me=w.has(Qe)}if(me){const Qe=j.texture.type,yt=T.has(Qe),Ze=Te.getClearColor(),Pt=Te.getClearAlpha(),It=Ze.r,jt=Ze.g,At=Ze.b;yt?(N[0]=It,N[1]=jt,N[2]=At,N[3]=Pt,re.clearBufferuiv(re.COLOR,0,N)):(L[0]=It,L[1]=jt,L[2]=At,L[3]=Pt,re.clearBufferiv(re.COLOR,0,L))}else xe|=re.COLOR_BUFFER_BIT}le&&(xe|=re.DEPTH_BUFFER_BIT),ye&&(xe|=re.STENCIL_BUFFER_BIT,this.state.buffers.stencil.setMask(4294967295)),re.clear(xe)},this.clearColor=function(){this.clear(!0,!1,!1)},this.clearDepth=function(){this.clear(!1,!0,!1)},this.clearStencil=function(){this.clear(!1,!1,!0)},this.dispose=function(){t.removeEventListener("webglcontextlost",rn,!1),t.removeEventListener("webglcontextrestored",Tn,!1),t.removeEventListener("webglcontextcreationerror",yn,!1),Te.dispose(),tt.dispose(),it.dispose(),q.dispose(),Fe.dispose(),Xe.dispose(),Ct.dispose(),gt.dispose(),ut.dispose(),Xt.dispose(),pt.dispose(),pt.removeEventListener("sessionstart",fr),pt.removeEventListener("sessionend",Es),sn.stop()};function rn(J){J.preventDefault(),Kv("WebGLRenderer: Context Lost."),P=!0}function Tn(){Kv("WebGLRenderer: Context Restored."),P=!1;const J=ee.autoReset,le=oe.enabled,ye=oe.autoUpdate,xe=oe.needsUpdate,me=oe.type;Ye(),ee.autoReset=J,oe.enabled=le,oe.autoUpdate=ye,oe.needsUpdate=xe,oe.type=me}function yn(J){cn("WebGLRenderer: A WebGL context could not be created. Reason: ",J.statusMessage)}function Ii(J){const le=J.target;le.removeEventListener("dispose",Ii),Xi(le)}function Xi(J){As(J),q.remove(J)}function As(J){const le=q.get(J).programs;le!==void 0&&(le.forEach(function(ye){Xt.releaseProgram(ye)}),J.isShaderMaterial&&Xt.releaseShaderCache(J))}this.renderBufferDirect=function(J,le,ye,xe,me,Qe){le===null&&(le=rt);const yt=me.isMesh&&me.matrixWorld.determinant()<0,Ze=mt(J,le,ye,xe,me);bt.setMaterial(xe,yt);let Pt=ye.index,It=1;if(xe.wireframe===!0){if(Pt=Ft.getWireframeAttribute(ye),Pt===void 0)return;It=2}const jt=ye.drawRange,At=ye.attributes.position;let Vt=jt.start*It,_n=(jt.start+jt.count)*It;Qe!==null&&(Vt=Math.max(Vt,Qe.start*It),_n=Math.min(_n,(Qe.start+Qe.count)*It)),Pt!==null?(Vt=Math.max(Vt,0),_n=Math.min(_n,Pt.count)):At!=null&&(Vt=Math.max(Vt,0),_n=Math.min(_n,At.count));const Kn=_n-Vt;if(Kn<0||Kn===1/0)return;gt.setup(me,xe,Ze,ye,Pt);let Zt,zt=ue;if(Pt!==null&&(Zt=Ue.get(Pt),zt=Ce,zt.setIndex(Zt)),me.isMesh)xe.wireframe===!0?(bt.setLineWidth(xe.wireframeLinewidth*xt()),zt.setMode(re.LINES)):zt.setMode(re.TRIANGLES);else if(me.isLine){let St=xe.linewidth;St===void 0&&(St=1),bt.setLineWidth(St*xt()),me.isLineSegments?zt.setMode(re.LINES):me.isLineLoop?zt.setMode(re.LINE_LOOP):zt.setMode(re.LINE_STRIP)}else me.isPoints?zt.setMode(re.POINTS):me.isSprite&&zt.setMode(re.TRIANGLES);if(me.isBatchedMesh)if(me._multiDrawInstances!==null)hg("WebGLRenderer: renderMultiDrawInstances has been deprecated and will be removed in r184. Append to renderMultiDraw arguments and use indirection."),zt.renderMultiDrawInstances(me._multiDrawStarts,me._multiDrawCounts,me._multiDrawCount,me._multiDrawInstances);else if(vt.get("WEBGL_multi_draw"))zt.renderMultiDraw(me._multiDrawStarts,me._multiDrawCounts,me._multiDrawCount);else{const St=me._multiDrawStarts,en=me._multiDrawCounts,kt=me._multiDrawCount,Qn=Pt?Ue.get(Pt).bytesPerElement:1,dr=q.get(xe).currentProgram.getUniforms();for(let Ln=0;Ln<kt;Ln++)dr.setValue(re,"_gl_DrawID",Ln),zt.render(St[Ln]/Qn,en[Ln])}else if(me.isInstancedMesh)zt.renderInstances(Vt,Kn,me.count);else if(ye.isInstancedBufferGeometry){const St=ye._maxInstanceCount!==void 0?ye._maxInstanceCount:1/0,en=Math.min(ye.instanceCount,St);zt.renderInstances(Vt,Kn,en)}else zt.render(Vt,Kn)};function fa(J,le,ye){J.transparent===!0&&J.side===yo&&J.forceSinglePass===!1?(J.side=Ca,J.needsUpdate=!0,Ie(J,le,ye),J.side=Gc,J.needsUpdate=!0,Ie(J,le,ye),J.side=yo):Ie(J,le,ye)}this.compile=function(J,le,ye=null){ye===null&&(ye=J),G=it.get(ye),G.init(le),O.push(G),ye.traverseVisible(function(me){me.isLight&&me.layers.test(le.layers)&&(G.pushLight(me),me.castShadow&&G.pushShadow(me))}),J!==ye&&J.traverseVisible(function(me){me.isLight&&me.layers.test(le.layers)&&(G.pushLight(me),me.castShadow&&G.pushShadow(me))}),G.setupLights();const xe=new Set;return J.traverse(function(me){if(!(me.isMesh||me.isPoints||me.isLine||me.isSprite))return;const Qe=me.material;if(Qe)if(Array.isArray(Qe))for(let yt=0;yt<Qe.length;yt++){const Ze=Qe[yt];fa(Ze,ye,me),xe.add(Ze)}else fa(Qe,ye,me),xe.add(Qe)}),G=O.pop(),xe},this.compileAsync=function(J,le,ye=null){const xe=this.compile(J,le,ye);return new Promise(me=>{function Qe(){if(xe.forEach(function(yt){q.get(yt).currentProgram.isReady()&&xe.delete(yt)}),xe.size===0){me(J);return}setTimeout(Qe,10)}vt.get("KHR_parallel_shader_compile")!==null?Qe():setTimeout(Qe,10)})};let Ss=null;function Ws(J){Ss&&Ss(J)}function fr(){sn.stop()}function Es(){sn.start()}const sn=new YL;sn.setAnimationLoop(Ws),typeof self<"u"&&sn.setContext(self),this.setAnimationLoop=function(J){Ss=J,pt.setAnimationLoop(J),J===null?sn.stop():sn.start()},pt.addEventListener("sessionstart",fr),pt.addEventListener("sessionend",Es),this.render=function(J,le){if(le!==void 0&&le.isCamera!==!0){cn("WebGLRenderer.render: camera is not an instance of THREE.Camera.");return}if(P===!0)return;const ye=pt.enabled===!0&&pt.isPresenting===!0,xe=D!==null&&(j===null||ye)&&D.begin(R,j);if(J.matrixWorldAutoUpdate===!0&&J.updateMatrixWorld(),le.parent===null&&le.matrixWorldAutoUpdate===!0&&le.updateMatrixWorld(),pt.enabled===!0&&pt.isPresenting===!0&&(D===null||D.isCompositing()===!1)&&(pt.cameraAutoUpdate===!0&&pt.updateCamera(le),le=pt.getCamera()),J.isScene===!0&&J.onBeforeRender(R,J,le,j),G=it.get(J,O.length),G.init(le),O.push(G),un.multiplyMatrices(le.projectionMatrix,le.matrixWorldInverse),_t.setFromProjectionMatrix(un,xo,le.reversedDepth),qt=this.localClippingEnabled,Dt=Ut.init(this.clippingPlanes,qt),F=tt.get(J,k.length),F.init(),k.push(F),pt.enabled===!0&&pt.isPresenting===!0){const yt=R.xr.getDepthSensingMesh();yt!==null&&Br(yt,le,-1/0,R.sortObjects)}Br(J,le,0,R.sortObjects),F.finish(),R.sortObjects===!0&&F.sort(ke,dt),Je=pt.enabled===!1||pt.isPresenting===!1||pt.hasDepthSensing()===!1,Je&&Te.addToRenderList(F,J),this.info.render.frame++,Dt===!0&&Ut.beginShadows();const me=G.state.shadowsArray;if(oe.render(me,J,le),Dt===!0&&Ut.endShadows(),this.info.autoReset===!0&&this.info.reset(),(xe&&D.hasRenderPass())===!1){const yt=F.opaque,Ze=F.transmissive;if(G.setupLights(),le.isArrayCamera){const Pt=le.cameras;if(Ze.length>0)for(let It=0,jt=Pt.length;It<jt;It++){const At=Pt[It];X(yt,Ze,J,At)}Je&&Te.render(J);for(let It=0,jt=Pt.length;It<jt;It++){const At=Pt[It];Si(F,J,At,At.viewport)}}else Ze.length>0&&X(yt,Ze,J,le),Je&&Te.render(J),Si(F,J,le)}j!==null&&Y===0&&(ge.updateMultisampleRenderTarget(j),ge.updateRenderTargetMipmap(j)),xe&&D.end(R),J.isScene===!0&&J.onAfterRender(R,J,le),gt.resetDefaultState(),ce=-1,fe=null,O.pop(),O.length>0?(G=O[O.length-1],Dt===!0&&Ut.setGlobalState(R.clippingPlanes,G.state.camera)):G=null,k.pop(),k.length>0?F=k[k.length-1]:F=null};function Br(J,le,ye,xe){if(J.visible===!1)return;if(J.layers.test(le.layers)){if(J.isGroup)ye=J.renderOrder;else if(J.isLOD)J.autoUpdate===!0&&J.update(le);else if(J.isLight)G.pushLight(J),J.castShadow&&G.pushShadow(J);else if(J.isSprite){if(!J.frustumCulled||_t.intersectsSprite(J)){xe&&qe.setFromMatrixPosition(J.matrixWorld).applyMatrix4(un);const yt=Ct.update(J),Ze=J.material;Ze.visible&&F.push(J,yt,Ze,ye,qe.z,null)}}else if((J.isMesh||J.isLine||J.isPoints)&&(!J.frustumCulled||_t.intersectsObject(J))){const yt=Ct.update(J),Ze=J.material;if(xe&&(J.boundingSphere!==void 0?(J.boundingSphere===null&&J.computeBoundingSphere(),qe.copy(J.boundingSphere.center)):(yt.boundingSphere===null&&yt.computeBoundingSphere(),qe.copy(yt.boundingSphere.center)),qe.applyMatrix4(J.matrixWorld).applyMatrix4(un)),Array.isArray(Ze)){const Pt=yt.groups;for(let It=0,jt=Pt.length;It<jt;It++){const At=Pt[It],Vt=Ze[At.materialIndex];Vt&&Vt.visible&&F.push(J,yt,Vt,ye,qe.z,At)}}else Ze.visible&&F.push(J,yt,Ze,ye,qe.z,null)}}const Qe=J.children;for(let yt=0,Ze=Qe.length;yt<Ze;yt++)Br(Qe[yt],le,ye,xe)}function Si(J,le,ye,xe){const{opaque:me,transmissive:Qe,transparent:yt}=J;G.setupLightsView(ye),Dt===!0&&Ut.setGlobalState(R.clippingPlanes,ye),xe&&bt.viewport(te.copy(xe)),me.length>0&&Z(me,le,ye),Qe.length>0&&Z(Qe,le,ye),yt.length>0&&Z(yt,le,ye),bt.buffers.depth.setTest(!0),bt.buffers.depth.setMask(!0),bt.buffers.color.setMask(!0),bt.setPolygonOffset(!1)}function X(J,le,ye,xe){if((ye.isScene===!0?ye.overrideMaterial:null)!==null)return;if(G.state.transmissionRenderTarget[xe.id]===void 0){const Vt=vt.has("EXT_color_buffer_half_float")||vt.has("EXT_color_buffer_float");G.state.transmissionRenderTarget[xe.id]=new _s(1,1,{generateMipmaps:!0,type:Vt?Er:vs,minFilter:sl,samples:Qt.samples,stencilBuffer:s,resolveDepthBuffer:!1,resolveStencilBuffer:!1,colorSpace:oi.workingColorSpace})}const Qe=G.state.transmissionRenderTarget[xe.id],yt=xe.viewport||te;Qe.setSize(yt.z*R.transmissionResolutionScale,yt.w*R.transmissionResolutionScale);const Ze=R.getRenderTarget(),Pt=R.getActiveCubeFace(),It=R.getActiveMipmapLevel();R.setRenderTarget(Qe),R.getClearColor(Pe),Re=R.getClearAlpha(),Re<1&&R.setClearColor(16777215,.5),R.clear(),Je&&Te.render(ye);const jt=R.toneMapping;R.toneMapping=ol;const At=xe.viewport;if(xe.viewport!==void 0&&(xe.viewport=void 0),G.setupLightsView(xe),Dt===!0&&Ut.setGlobalState(R.clippingPlanes,xe),Z(J,ye,xe),ge.updateMultisampleRenderTarget(Qe),ge.updateRenderTargetMipmap(Qe),vt.has("WEBGL_multisampled_render_to_texture")===!1){let Vt=!1;for(let _n=0,Kn=le.length;_n<Kn;_n++){const Zt=le[_n],{object:zt,geometry:St,material:en,group:kt}=Zt;if(en.side===yo&&zt.layers.test(xe.layers)){const Qn=en.side;en.side=Ca,en.needsUpdate=!0,he(zt,ye,xe,St,en,kt),en.side=Qn,en.needsUpdate=!0,Vt=!0}}Vt===!0&&(ge.updateMultisampleRenderTarget(Qe),ge.updateRenderTargetMipmap(Qe))}R.setRenderTarget(Ze,Pt,It),R.setClearColor(Pe,Re),At!==void 0&&(xe.viewport=At),R.toneMapping=jt}function Z(J,le,ye){const xe=le.isScene===!0?le.overrideMaterial:null;for(let me=0,Qe=J.length;me<Qe;me++){const yt=J[me],{object:Ze,geometry:Pt,group:It}=yt;let jt=yt.material;jt.allowOverride===!0&&xe!==null&&(jt=xe),Ze.layers.test(ye.layers)&&he(Ze,le,ye,Pt,jt,It)}}function he(J,le,ye,xe,me,Qe){J.onBeforeRender(R,le,ye,xe,me,Qe),J.modelViewMatrix.multiplyMatrices(ye.matrixWorldInverse,J.matrixWorld),J.normalMatrix.getNormalMatrix(J.modelViewMatrix),me.onBeforeRender(R,le,ye,xe,J,Qe),me.transparent===!0&&me.side===yo&&me.forceSinglePass===!1?(me.side=Ca,me.needsUpdate=!0,R.renderBufferDirect(ye,le,xe,me,J,Qe),me.side=Gc,me.needsUpdate=!0,R.renderBufferDirect(ye,le,xe,me,J,Qe),me.side=yo):R.renderBufferDirect(ye,le,xe,me,J,Qe),J.onAfterRender(R,le,ye,xe,me,Qe)}function Ie(J,le,ye){le.isScene!==!0&&(le=rt);const xe=q.get(J),me=G.state.lights,Qe=G.state.shadowsArray,yt=me.state.version,Ze=Xt.getParameters(J,me.state,Qe,le,ye),Pt=Xt.getProgramCacheKey(Ze);let It=xe.programs;xe.environment=J.isMeshStandardMaterial?le.environment:null,xe.fog=le.fog,xe.envMap=(J.isMeshStandardMaterial?Xe:Fe).get(J.envMap||xe.environment),xe.envMapRotation=xe.environment!==null&&J.envMap===null?le.environmentRotation:J.envMapRotation,It===void 0&&(J.addEventListener("dispose",Ii),It=new Map,xe.programs=It);let jt=It.get(Pt);if(jt!==void 0){if(xe.currentProgram===jt&&xe.lightsStateVersion===yt)return Ge(J,Ze),jt}else Ze.uniforms=Xt.getUniforms(J),J.onBeforeCompile(Ze,R),jt=Xt.acquireProgram(Ze,Pt),It.set(Pt,jt),xe.uniforms=Ze.uniforms;const At=xe.uniforms;return(!J.isShaderMaterial&&!J.isRawShaderMaterial||J.clipping===!0)&&(At.clippingPlanes=Ut.uniform),Ge(J,Ze),xe.needsLights=Rt(J),xe.lightsStateVersion=yt,xe.needsLights&&(At.ambientLightColor.value=me.state.ambient,At.lightProbe.value=me.state.probe,At.directionalLights.value=me.state.directional,At.directionalLightShadows.value=me.state.directionalShadow,At.spotLights.value=me.state.spot,At.spotLightShadows.value=me.state.spotShadow,At.rectAreaLights.value=me.state.rectArea,At.ltc_1.value=me.state.rectAreaLTC1,At.ltc_2.value=me.state.rectAreaLTC2,At.pointLights.value=me.state.point,At.pointLightShadows.value=me.state.pointShadow,At.hemisphereLights.value=me.state.hemi,At.directionalShadowMap.value=me.state.directionalShadowMap,At.directionalShadowMatrix.value=me.state.directionalShadowMatrix,At.spotShadowMap.value=me.state.spotShadowMap,At.spotLightMatrix.value=me.state.spotLightMatrix,At.spotLightMap.value=me.state.spotLightMap,At.pointShadowMap.value=me.state.pointShadowMap,At.pointShadowMatrix.value=me.state.pointShadowMatrix),xe.currentProgram=jt,xe.uniformsList=null,jt}function He(J){if(J.uniformsList===null){const le=J.currentProgram.getUniforms();J.uniformsList=gb.seqWithValue(le.seq,J.uniforms)}return J.uniformsList}function Ge(J,le){const ye=q.get(J);ye.outputColorSpace=le.outputColorSpace,ye.batching=le.batching,ye.batchingColor=le.batchingColor,ye.instancing=le.instancing,ye.instancingColor=le.instancingColor,ye.instancingMorph=le.instancingMorph,ye.skinning=le.skinning,ye.morphTargets=le.morphTargets,ye.morphNormals=le.morphNormals,ye.morphColors=le.morphColors,ye.morphTargetsCount=le.morphTargetsCount,ye.numClippingPlanes=le.numClippingPlanes,ye.numIntersection=le.numClipIntersection,ye.vertexAlphas=le.vertexAlphas,ye.vertexTangents=le.vertexTangents,ye.toneMapping=le.toneMapping}function mt(J,le,ye,xe,me){le.isScene!==!0&&(le=rt),ge.resetTextureUnits();const Qe=le.fog,yt=xe.isMeshStandardMaterial?le.environment:null,Ze=j===null?R.outputColorSpace:j.isXRRenderTarget===!0?j.texture.colorSpace:Xl,Pt=(xe.isMeshStandardMaterial?Xe:Fe).get(xe.envMap||yt),It=xe.vertexColors===!0&&!!ye.attributes.color&&ye.attributes.color.itemSize===4,jt=!!ye.attributes.tangent&&(!!xe.normalMap||xe.anisotropy>0),At=!!ye.morphAttributes.position,Vt=!!ye.morphAttributes.normal,_n=!!ye.morphAttributes.color;let Kn=ol;xe.toneMapped&&(j===null||j.isXRRenderTarget===!0)&&(Kn=R.toneMapping);const Zt=ye.morphAttributes.position||ye.morphAttributes.normal||ye.morphAttributes.color,zt=Zt!==void 0?Zt.length:0,St=q.get(xe),en=G.state.lights;if(Dt===!0&&(qt===!0||J!==fe)){const pr=J===fe&&xe.id===ce;Ut.setState(xe,J,pr)}let kt=!1;xe.version===St.__version?(St.needsLights&&St.lightsStateVersion!==en.state.version||St.outputColorSpace!==Ze||me.isBatchedMesh&&St.batching===!1||!me.isBatchedMesh&&St.batching===!0||me.isBatchedMesh&&St.batchingColor===!0&&me.colorTexture===null||me.isBatchedMesh&&St.batchingColor===!1&&me.colorTexture!==null||me.isInstancedMesh&&St.instancing===!1||!me.isInstancedMesh&&St.instancing===!0||me.isSkinnedMesh&&St.skinning===!1||!me.isSkinnedMesh&&St.skinning===!0||me.isInstancedMesh&&St.instancingColor===!0&&me.instanceColor===null||me.isInstancedMesh&&St.instancingColor===!1&&me.instanceColor!==null||me.isInstancedMesh&&St.instancingMorph===!0&&me.morphTexture===null||me.isInstancedMesh&&St.instancingMorph===!1&&me.morphTexture!==null||St.envMap!==Pt||xe.fog===!0&&St.fog!==Qe||St.numClippingPlanes!==void 0&&(St.numClippingPlanes!==Ut.numPlanes||St.numIntersection!==Ut.numIntersection)||St.vertexAlphas!==It||St.vertexTangents!==jt||St.morphTargets!==At||St.morphNormals!==Vt||St.morphColors!==_n||St.toneMapping!==Kn||St.morphTargetsCount!==zt)&&(kt=!0):(kt=!0,St.__version=xe.version);let Qn=St.currentProgram;kt===!0&&(Qn=Ie(xe,le,me));let dr=!1,Ln=!1,Di=!1;const ui=Qn.getUniforms(),Ui=St.uniforms;if(bt.useProgram(Qn.program)&&(dr=!0,Ln=!0,Di=!0),xe.id!==ce&&(ce=xe.id,Ln=!0),dr||fe!==J){bt.buffers.depth.getReversed()&&J.reversedDepth!==!0&&(J._reversedDepth=!0,J.updateProjectionMatrix()),ui.setValue(re,"projectionMatrix",J.projectionMatrix),ui.setValue(re,"viewMatrix",J.matrixWorldInverse);const mr=ui.map.cameraPosition;mr!==void 0&&mr.setValue(re,Yt.setFromMatrixPosition(J.matrixWorld)),Qt.logarithmicDepthBuffer&&ui.setValue(re,"logDepthBufFC",2/(Math.log(J.far+1)/Math.LN2)),(xe.isMeshPhongMaterial||xe.isMeshToonMaterial||xe.isMeshLambertMaterial||xe.isMeshBasicMaterial||xe.isMeshStandardMaterial||xe.isShaderMaterial)&&ui.setValue(re,"isOrthographic",J.isOrthographicCamera===!0),fe!==J&&(fe=J,Ln=!0,Di=!0)}if(St.needsLights&&(en.state.directionalShadowMap.length>0&&ui.setValue(re,"directionalShadowMap",en.state.directionalShadowMap,ge),en.state.spotShadowMap.length>0&&ui.setValue(re,"spotShadowMap",en.state.spotShadowMap,ge),en.state.pointShadowMap.length>0&&ui.setValue(re,"pointShadowMap",en.state.pointShadowMap,ge)),me.isSkinnedMesh){ui.setOptional(re,me,"bindMatrix"),ui.setOptional(re,me,"bindMatrixInverse");const pr=me.skeleton;pr&&(pr.boneTexture===null&&pr.computeBoneTexture(),ui.setValue(re,"boneTexture",pr.boneTexture,ge))}me.isBatchedMesh&&(ui.setOptional(re,me,"batchingTexture"),ui.setValue(re,"batchingTexture",me._matricesTexture,ge),ui.setOptional(re,me,"batchingIdTexture"),ui.setValue(re,"batchingIdTexture",me._indirectTexture,ge),ui.setOptional(re,me,"batchingColorTexture"),me._colorsTexture!==null&&ui.setValue(re,"batchingColorTexture",me._colorsTexture,ge));const Ei=ye.morphAttributes;if((Ei.position!==void 0||Ei.normal!==void 0||Ei.color!==void 0)&&ot.update(me,ye,Qn),(Ln||St.receiveShadow!==me.receiveShadow)&&(St.receiveShadow=me.receiveShadow,ui.setValue(re,"receiveShadow",me.receiveShadow)),xe.isMeshGouraudMaterial&&xe.envMap!==null&&(Ui.envMap.value=Pt,Ui.flipEnvMap.value=Pt.isCubeTexture&&Pt.isRenderTargetTexture===!1?-1:1),xe.isMeshStandardMaterial&&xe.envMap===null&&le.environment!==null&&(Ui.envMapIntensity.value=le.environmentIntensity),Ui.dfgLUT!==void 0&&(Ui.dfgLUT.value=cX()),Ln&&(ui.setValue(re,"toneMappingExposure",R.toneMappingExposure),St.needsLights&&ht(Ui,Di),Qe&&xe.fog===!0&&an.refreshFogUniforms(Ui,Qe),an.refreshMaterialUniforms(Ui,xe,Se,ae,G.state.transmissionRenderTarget[J.id]),gb.upload(re,He(St),Ui,ge)),xe.isShaderMaterial&&xe.uniformsNeedUpdate===!0&&(gb.upload(re,He(St),Ui,ge),xe.uniformsNeedUpdate=!1),xe.isSpriteMaterial&&ui.setValue(re,"center",me.center),ui.setValue(re,"modelViewMatrix",me.modelViewMatrix),ui.setValue(re,"normalMatrix",me.normalMatrix),ui.setValue(re,"modelMatrix",me.matrixWorld),xe.isShaderMaterial||xe.isRawShaderMaterial){const pr=xe.uniformsGroups;for(let mr=0,To=pr.length;mr<To;mr++){const Ts=pr[mr];ut.update(Ts,Qn),ut.bind(Ts,Qn)}}return Qn}function ht(J,le){J.ambientLightColor.needsUpdate=le,J.lightProbe.needsUpdate=le,J.directionalLights.needsUpdate=le,J.directionalLightShadows.needsUpdate=le,J.pointLights.needsUpdate=le,J.pointLightShadows.needsUpdate=le,J.spotLights.needsUpdate=le,J.spotLightShadows.needsUpdate=le,J.rectAreaLights.needsUpdate=le,J.hemisphereLights.needsUpdate=le}function Rt(J){return J.isMeshLambertMaterial||J.isMeshToonMaterial||J.isMeshPhongMaterial||J.isMeshStandardMaterial||J.isShadowMaterial||J.isShaderMaterial&&J.lights===!0}this.getActiveCubeFace=function(){return z},this.getActiveMipmapLevel=function(){return Y},this.getRenderTarget=function(){return j},this.setRenderTargetTextures=function(J,le,ye){const xe=q.get(J);xe.__autoAllocateDepthBuffer=J.resolveDepthBuffer===!1,xe.__autoAllocateDepthBuffer===!1&&(xe.__useRenderToTexture=!1),q.get(J.texture).__webglTexture=le,q.get(J.depthTexture).__webglTexture=xe.__autoAllocateDepthBuffer?void 0:ye,xe.__hasExternalTextures=!0},this.setRenderTargetFramebuffer=function(J,le){const ye=q.get(J);ye.__webglFramebuffer=le,ye.__useDefaultFramebuffer=le===void 0};const Tt=re.createFramebuffer();this.setRenderTarget=function(J,le=0,ye=0){j=J,z=le,Y=ye;let xe=null,me=!1,Qe=!1;if(J){const Ze=q.get(J);if(Ze.__useDefaultFramebuffer!==void 0){bt.bindFramebuffer(re.FRAMEBUFFER,Ze.__webglFramebuffer),te.copy(J.viewport),se.copy(J.scissor),Ae=J.scissorTest,bt.viewport(te),bt.scissor(se),bt.setScissorTest(Ae),ce=-1;return}else if(Ze.__webglFramebuffer===void 0)ge.setupRenderTarget(J);else if(Ze.__hasExternalTextures)ge.rebindTextures(J,q.get(J.texture).__webglTexture,q.get(J.depthTexture).__webglTexture);else if(J.depthBuffer){const jt=J.depthTexture;if(Ze.__boundDepthTexture!==jt){if(jt!==null&&q.has(jt)&&(J.width!==jt.image.width||J.height!==jt.image.height))throw new Error("WebGLRenderTarget: Attached DepthTexture is initialized to the incorrect size.");ge.setupDepthRenderbuffer(J)}}const Pt=J.texture;(Pt.isData3DTexture||Pt.isDataArrayTexture||Pt.isCompressedArrayTexture)&&(Qe=!0);const It=q.get(J).__webglFramebuffer;J.isWebGLCubeRenderTarget?(Array.isArray(It[le])?xe=It[le][ye]:xe=It[le],me=!0):J.samples>0&&ge.useMultisampledRTT(J)===!1?xe=q.get(J).__webglMultisampledFramebuffer:Array.isArray(It)?xe=It[ye]:xe=It,te.copy(J.viewport),se.copy(J.scissor),Ae=J.scissorTest}else te.copy(ve).multiplyScalar(Se).floor(),se.copy(Le).multiplyScalar(Se).floor(),Ae=lt;if(ye!==0&&(xe=Tt),bt.bindFramebuffer(re.FRAMEBUFFER,xe)&&bt.drawBuffers(J,xe),bt.viewport(te),bt.scissor(se),bt.setScissorTest(Ae),me){const Ze=q.get(J.texture);re.framebufferTexture2D(re.FRAMEBUFFER,re.COLOR_ATTACHMENT0,re.TEXTURE_CUBE_MAP_POSITIVE_X+le,Ze.__webglTexture,ye)}else if(Qe){const Ze=le;for(let Pt=0;Pt<J.textures.length;Pt++){const It=q.get(J.textures[Pt]);re.framebufferTextureLayer(re.FRAMEBUFFER,re.COLOR_ATTACHMENT0+Pt,It.__webglTexture,ye,Ze)}}else if(J!==null&&ye!==0){const Ze=q.get(J.texture);re.framebufferTexture2D(re.FRAMEBUFFER,re.COLOR_ATTACHMENT0,re.TEXTURE_2D,Ze.__webglTexture,ye)}ce=-1},this.readRenderTargetPixels=function(J,le,ye,xe,me,Qe,yt,Ze=0){if(!(J&&J.isWebGLRenderTarget)){cn("WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");return}let Pt=q.get(J).__webglFramebuffer;if(J.isWebGLCubeRenderTarget&&yt!==void 0&&(Pt=Pt[yt]),Pt){bt.bindFramebuffer(re.FRAMEBUFFER,Pt);try{const It=J.textures[Ze],jt=It.format,At=It.type;if(!Qt.textureFormatReadable(jt)){cn("WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format.");return}if(!Qt.textureTypeReadable(At)){cn("WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type.");return}le>=0&&le<=J.width-xe&&ye>=0&&ye<=J.height-me&&(J.textures.length>1&&re.readBuffer(re.COLOR_ATTACHMENT0+Ze),re.readPixels(le,ye,xe,me,at.convert(jt),at.convert(At),Qe))}finally{const It=j!==null?q.get(j).__webglFramebuffer:null;bt.bindFramebuffer(re.FRAMEBUFFER,It)}}},this.readRenderTargetPixelsAsync=async function(J,le,ye,xe,me,Qe,yt,Ze=0){if(!(J&&J.isWebGLRenderTarget))throw new Error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");let Pt=q.get(J).__webglFramebuffer;if(J.isWebGLCubeRenderTarget&&yt!==void 0&&(Pt=Pt[yt]),Pt)if(le>=0&&le<=J.width-xe&&ye>=0&&ye<=J.height-me){bt.bindFramebuffer(re.FRAMEBUFFER,Pt);const It=J.textures[Ze],jt=It.format,At=It.type;if(!Qt.textureFormatReadable(jt))throw new Error("THREE.WebGLRenderer.readRenderTargetPixelsAsync: renderTarget is not in RGBA or implementation defined format.");if(!Qt.textureTypeReadable(At))throw new Error("THREE.WebGLRenderer.readRenderTargetPixelsAsync: renderTarget is not in UnsignedByteType or implementation defined type.");const Vt=re.createBuffer();re.bindBuffer(re.PIXEL_PACK_BUFFER,Vt),re.bufferData(re.PIXEL_PACK_BUFFER,Qe.byteLength,re.STREAM_READ),J.textures.length>1&&re.readBuffer(re.COLOR_ATTACHMENT0+Ze),re.readPixels(le,ye,xe,me,at.convert(jt),at.convert(At),0);const _n=j!==null?q.get(j).__webglFramebuffer:null;bt.bindFramebuffer(re.FRAMEBUFFER,_n);const Kn=re.fenceSync(re.SYNC_GPU_COMMANDS_COMPLETE,0);return re.flush(),await EH(re,Kn,4),re.bindBuffer(re.PIXEL_PACK_BUFFER,Vt),re.getBufferSubData(re.PIXEL_PACK_BUFFER,0,Qe),re.deleteBuffer(Vt),re.deleteSync(Kn),Qe}else throw new Error("THREE.WebGLRenderer.readRenderTargetPixelsAsync: requested read bounds are out of range.")},this.copyFramebufferToTexture=function(J,le=null,ye=0){const xe=Math.pow(2,-ye),me=Math.floor(J.image.width*xe),Qe=Math.floor(J.image.height*xe),yt=le!==null?le.x:0,Ze=le!==null?le.y:0;ge.setTexture2D(J,0),re.copyTexSubImage2D(re.TEXTURE_2D,ye,0,0,yt,Ze,me,Qe),bt.unbindTexture()};const wt=re.createFramebuffer(),Mt=re.createFramebuffer();this.copyTextureToTexture=function(J,le,ye=null,xe=null,me=0,Qe=null){Qe===null&&(me!==0?(hg("WebGLRenderer: copyTextureToTexture function signature has changed to support src and dst mipmap levels."),Qe=me,me=0):Qe=0);let yt,Ze,Pt,It,jt,At,Vt,_n,Kn;const Zt=J.isCompressedTexture?J.mipmaps[Qe]:J.image;if(ye!==null)yt=ye.max.x-ye.min.x,Ze=ye.max.y-ye.min.y,Pt=ye.isBox3?ye.max.z-ye.min.z:1,It=ye.min.x,jt=ye.min.y,At=ye.isBox3?ye.min.z:0;else{const Ei=Math.pow(2,-me);yt=Math.floor(Zt.width*Ei),Ze=Math.floor(Zt.height*Ei),J.isDataArrayTexture?Pt=Zt.depth:J.isData3DTexture?Pt=Math.floor(Zt.depth*Ei):Pt=1,It=0,jt=0,At=0}xe!==null?(Vt=xe.x,_n=xe.y,Kn=xe.z):(Vt=0,_n=0,Kn=0);const zt=at.convert(le.format),St=at.convert(le.type);let en;le.isData3DTexture?(ge.setTexture3D(le,0),en=re.TEXTURE_3D):le.isDataArrayTexture||le.isCompressedArrayTexture?(ge.setTexture2DArray(le,0),en=re.TEXTURE_2D_ARRAY):(ge.setTexture2D(le,0),en=re.TEXTURE_2D),re.pixelStorei(re.UNPACK_FLIP_Y_WEBGL,le.flipY),re.pixelStorei(re.UNPACK_PREMULTIPLY_ALPHA_WEBGL,le.premultiplyAlpha),re.pixelStorei(re.UNPACK_ALIGNMENT,le.unpackAlignment);const kt=re.getParameter(re.UNPACK_ROW_LENGTH),Qn=re.getParameter(re.UNPACK_IMAGE_HEIGHT),dr=re.getParameter(re.UNPACK_SKIP_PIXELS),Ln=re.getParameter(re.UNPACK_SKIP_ROWS),Di=re.getParameter(re.UNPACK_SKIP_IMAGES);re.pixelStorei(re.UNPACK_ROW_LENGTH,Zt.width),re.pixelStorei(re.UNPACK_IMAGE_HEIGHT,Zt.height),re.pixelStorei(re.UNPACK_SKIP_PIXELS,It),re.pixelStorei(re.UNPACK_SKIP_ROWS,jt),re.pixelStorei(re.UNPACK_SKIP_IMAGES,At);const ui=J.isDataArrayTexture||J.isData3DTexture,Ui=le.isDataArrayTexture||le.isData3DTexture;if(J.isDepthTexture){const Ei=q.get(J),pr=q.get(le),mr=q.get(Ei.__renderTarget),To=q.get(pr.__renderTarget);bt.bindFramebuffer(re.READ_FRAMEBUFFER,mr.__webglFramebuffer),bt.bindFramebuffer(re.DRAW_FRAMEBUFFER,To.__webglFramebuffer);for(let Ts=0;Ts<Pt;Ts++)ui&&(re.framebufferTextureLayer(re.READ_FRAMEBUFFER,re.COLOR_ATTACHMENT0,q.get(J).__webglTexture,me,At+Ts),re.framebufferTextureLayer(re.DRAW_FRAMEBUFFER,re.COLOR_ATTACHMENT0,q.get(le).__webglTexture,Qe,Kn+Ts)),re.blitFramebuffer(It,jt,yt,Ze,Vt,_n,yt,Ze,re.DEPTH_BUFFER_BIT,re.NEAREST);bt.bindFramebuffer(re.READ_FRAMEBUFFER,null),bt.bindFramebuffer(re.DRAW_FRAMEBUFFER,null)}else if(me!==0||J.isRenderTargetTexture||q.has(J)){const Ei=q.get(J),pr=q.get(le);bt.bindFramebuffer(re.READ_FRAMEBUFFER,wt),bt.bindFramebuffer(re.DRAW_FRAMEBUFFER,Mt);for(let mr=0;mr<Pt;mr++)ui?re.framebufferTextureLayer(re.READ_FRAMEBUFFER,re.COLOR_ATTACHMENT0,Ei.__webglTexture,me,At+mr):re.framebufferTexture2D(re.READ_FRAMEBUFFER,re.COLOR_ATTACHMENT0,re.TEXTURE_2D,Ei.__webglTexture,me),Ui?re.framebufferTextureLayer(re.DRAW_FRAMEBUFFER,re.COLOR_ATTACHMENT0,pr.__webglTexture,Qe,Kn+mr):re.framebufferTexture2D(re.DRAW_FRAMEBUFFER,re.COLOR_ATTACHMENT0,re.TEXTURE_2D,pr.__webglTexture,Qe),me!==0?re.blitFramebuffer(It,jt,yt,Ze,Vt,_n,yt,Ze,re.COLOR_BUFFER_BIT,re.NEAREST):Ui?re.copyTexSubImage3D(en,Qe,Vt,_n,Kn+mr,It,jt,yt,Ze):re.copyTexSubImage2D(en,Qe,Vt,_n,It,jt,yt,Ze);bt.bindFramebuffer(re.READ_FRAMEBUFFER,null),bt.bindFramebuffer(re.DRAW_FRAMEBUFFER,null)}else Ui?J.isDataTexture||J.isData3DTexture?re.texSubImage3D(en,Qe,Vt,_n,Kn,yt,Ze,Pt,zt,St,Zt.data):le.isCompressedArrayTexture?re.compressedTexSubImage3D(en,Qe,Vt,_n,Kn,yt,Ze,Pt,zt,Zt.data):re.texSubImage3D(en,Qe,Vt,_n,Kn,yt,Ze,Pt,zt,St,Zt):J.isDataTexture?re.texSubImage2D(re.TEXTURE_2D,Qe,Vt,_n,yt,Ze,zt,St,Zt.data):J.isCompressedTexture?re.compressedTexSubImage2D(re.TEXTURE_2D,Qe,Vt,_n,Zt.width,Zt.height,zt,Zt.data):re.texSubImage2D(re.TEXTURE_2D,Qe,Vt,_n,yt,Ze,zt,St,Zt);re.pixelStorei(re.UNPACK_ROW_LENGTH,kt),re.pixelStorei(re.UNPACK_IMAGE_HEIGHT,Qn),re.pixelStorei(re.UNPACK_SKIP_PIXELS,dr),re.pixelStorei(re.UNPACK_SKIP_ROWS,Ln),re.pixelStorei(re.UNPACK_SKIP_IMAGES,Di),Qe===0&&le.generateMipmaps&&re.generateMipmap(en),bt.unbindTexture()},this.initRenderTarget=function(J){q.get(J).__webglFramebuffer===void 0&&ge.setupRenderTarget(J)},this.initTexture=function(J){J.isCubeTexture?ge.setTextureCube(J,0):J.isData3DTexture?ge.setTexture3D(J,0):J.isDataArrayTexture||J.isCompressedArrayTexture?ge.setTexture2DArray(J,0):ge.setTexture2D(J,0),bt.unbindTexture()},this.resetState=function(){z=0,Y=0,j=null,bt.reset(),gt.reset()},typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}get coordinateSystem(){return xo}get outputColorSpace(){return this._outputColorSpace}set outputColorSpace(e){this._outputColorSpace=e;const t=this.getContext();t.drawingBufferColorSpace=oi._getDrawingBufferColorSpace(e),t.unpackColorSpace=oi._getUnpackColorSpace()}}const uX=Object.freeze(Object.defineProperty({__proto__:null,ACESFilmicToneMapping:sS,AddEquation:Qh,AddOperation:OB,AdditiveAnimationBlendMode:aw,AdditiveBlending:ST,AgXToneMapping:ew,AlphaFormat:rw,AlwaysCompare:JB,AlwaysDepth:zb,AlwaysStencilFunc:CT,AmbientLight:UL,AnimationAction:qL,AnimationClip:gg,AnimationLoader:f8,AnimationMixer:U8,AnimationObjectGroup:L8,AnimationUtils:l8,ArcCurve:fL,ArrayCamera:GL,ArrowHelper:l2,AttachedBindMode:MT,Audio:jL,AudioAnalyser:T8,AudioContext:Lw,AudioListener:A8,AudioLoader:_8,AxesHelper:c2,BackSide:Ca,BasicDepthPacking:HB,BasicShadowMap:gB,BatchedMesh:lL,Bone:AS,BooleanKeyframeTrack:dp,Box2:q8,Box3:xs,Box3Helper:a2,BoxGeometry:fp,BoxHelper:s2,BufferAttribute:gi,BufferGeometry:wn,BufferGeometryLoader:VL,ByteType:oS,Cache:Oc,Camera:yS,CameraHelper:r2,CanvasTexture:DG,CapsuleGeometry:MS,CatmullRomCurve3:dL,CineonToneMapping:ZM,CircleGeometry:wS,ClampToEdgeWrapping:Sr,Clock:Ow,Color:Gt,ColorKeyframeTrack:Cw,ColorManagement:oi,CompressedArrayTexture:RG,CompressedCubeTexture:IG,CompressedTexture:TS,CompressedTextureLoader:d8,ConeGeometry:My,ConstantAlphaFactor:PB,ConstantColorFactor:DB,Controls:h2,CubeCamera:rL,CubeDepthTexture:uL,CubeReflectionMapping:ql,CubeRefractionMapping:yf,CubeTexture:by,CubeTextureLoader:BL,CubeUVReflectionMapping:Mg,CubicBezierCurve:_w,CubicBezierCurve3:pL,CubicInterpolant:IL,CullFaceBack:AT,CullFaceFront:mB,CullFaceFrontBack:F9,CullFaceNone:pB,Curve:Jl,CurvePath:gL,CustomBlending:vB,CustomToneMapping:$M,CylinderGeometry:Ty,Cylindrical:W8,Data3DTexture:vS,DataArrayTexture:gS,DataTexture:ll,DataTextureLoader:Rw,DataUtils:Od,DecrementStencilOp:Z9,DecrementWrapStencilOp:eH,DefaultLoadingManager:PL,DepthFormat:jc,DepthStencilFormat:$h,DepthTexture:ep,DetachedBindMode:UB,DirectionalLight:Pw,DirectionalLightHelper:i2,DiscreteInterpolant:DL,DodecahedronGeometry:CS,DoubleSide:yo,DstAlphaFactor:MB,DstColorFactor:CB,DynamicCopyUsage:mH,DynamicDrawUsage:cH,DynamicReadUsage:fH,EdgesGeometry:hL,EllipseCurve:RS,EqualCompare:qB,EqualDepth:Hb,EqualStencilFunc:rH,EquirectangularReflectionMapping:rg,EquirectangularRefractionMapping:Wv,Euler:Eo,EventDispatcher:Wc,ExternalTexture:vw,ExtrudeGeometry:IS,FileLoader:zs,Float16BufferAttribute:oG,Float32BufferAttribute:tn,FloatType:ir,Fog:bS,FogExp2:xS,FramebufferTexture:CG,FrontSide:Gc,Frustum:wg,FrustumArray:SS,GLBufferAttribute:H8,GLSL1:vH,GLSL3:RT,GreaterCompare:XB,GreaterDepth:jb,GreaterEqualCompare:mS,GreaterEqualDepth:Gb,GreaterEqualStencilFunc:lH,GreaterStencilFunc:aH,GridHelper:t2,Group:Ou,HalfFloatType:Er,HemisphereLight:OL,HemisphereLightHelper:e2,IcosahedronGeometry:wy,ImageBitmapLoader:HL,ImageLoader:ey,ImageUtils:eL,IncrementStencilOp:Q9,IncrementWrapStencilOp:$9,InstancedBufferAttribute:$d,InstancedBufferGeometry:zL,InstancedInterleavedBuffer:V8,InstancedMesh:pw,Int16BufferAttribute:sG,Int32BufferAttribute:aG,Int8BufferAttribute:nG,IntType:yy,InterleavedBuffer:Sy,InterleavedBufferAttribute:bf,Interpolant:Rg,InterpolateDiscrete:lg,InterpolateLinear:cg,InterpolateSmooth:pb,InterpolationSamplingMode:xH,InterpolationSamplingType:_H,InvertStencilOp:tH,KeepStencilOp:Cd,KeyframeTrack:ul,LOD:oL,LatheGeometry:DS,Layers:dg,LessCompare:WB,LessDepth:Vb,LessEqualCompare:pS,LessEqualDepth:Qd,LessEqualStencilFunc:sH,LessStencilFunc:iH,Light:Mf,LightProbe:kL,Line:ju,Line3:J8,LineBasicMaterial:ha,LineCurve:xw,LineCurve3:mL,LineDashedMaterial:CL,LineLoop:mw,LineSegments:Yl,LinearFilter:Jn,LinearInterpolant:ww,LinearMipMapLinearFilter:wT,LinearMipMapNearestFilter:V9,LinearMipmapLinearFilter:sl,LinearMipmapNearestFilter:qm,LinearSRGBColorSpace:Xl,LinearToneMapping:KM,LinearTransfer:Xv,Loader:js,LoaderUtils:uf,LoadingManager:kS,LoopOnce:FB,LoopPingPong:zB,LoopRepeat:kB,MOUSE:Md,Material:os,MaterialLoader:zS,MathUtils:$B,Matrix2:Vw,Matrix3:Un,Matrix4:vn,MaxEquation:bB,Mesh:rr,MeshBasicMaterial:to,MeshDepthMaterial:FS,MeshDistanceMaterial:Tw,MeshLambertMaterial:ML,MeshMatcapMaterial:wL,MeshNormalMaterial:TL,MeshPhongMaterial:SL,MeshPhysicalMaterial:cl,MeshStandardMaterial:Cg,MeshToonMaterial:EL,MinEquation:xB,MirroredRepeatWrapping:sg,MixOperation:LB,MultiplyBlending:TT,MultiplyOperation:vy,NearestFilter:Pr,NearestMipMapLinearFilter:z9,NearestMipMapNearestFilter:k9,NearestMipmapLinearFilter:Pd,NearestMipmapNearestFilter:aS,NeutralToneMapping:tw,NeverCompare:jB,NeverDepth:kb,NeverStencilFunc:nH,NoBlending:Gl,NoColorSpace:Nu,NoNormalPacking:q9,NoToneMapping:ol,NormalAnimationBlendMode:dS,NormalBlending:Hd,NormalGAPacking:Y9,NormalRGPacking:X9,NotEqualCompare:YB,NotEqualDepth:Wb,NotEqualStencilFunc:oH,NumberKeyframeTrack:np,Object3D:fi,ObjectLoader:v8,ObjectSpaceNormalMap:GB,OctahedronGeometry:Cy,OneFactor:SB,OneMinusConstantAlphaFactor:BB,OneMinusConstantColorFactor:NB,OneMinusDstAlphaFactor:wB,OneMinusDstColorFactor:RB,OneMinusSrcAlphaFactor:Fb,OneMinusSrcColorFactor:TB,OrthographicCamera:Ao,PCFShadowMap:Wm,PCFSoftShadowMap:Tv,PMREMGenerator:UT,Path:CA,PerspectiveCamera:hr,Plane:Du,PlaneGeometry:Xu,PlaneHelper:o2,PointLight:Nw,PointLightHelper:Z8,Points:gw,PointsMaterial:ES,PolarGridHelper:n2,PolyhedronGeometry:Tf,PositionalAudio:E8,PropertyBinding:mi,PropertyMixer:WL,QuadraticBezierCurve:bw,QuadraticBezierCurve3:Aw,Quaternion:ys,QuaternionKeyframeTrack:ip,QuaternionLinearInterpolant:NL,R11_EAC_Format:$b,RED_GREEN_RGTC2_Format:AA,RED_RGTC1_Format:xA,REVISION:gy,RG11_EAC_Format:tA,RGBADepthPacking:G9,RGBAFormat:jr,RGBAIntegerFormat:fS,RGBA_ASTC_10x10_Format:pA,RGBA_ASTC_10x5_Format:hA,RGBA_ASTC_10x6_Format:fA,RGBA_ASTC_10x8_Format:dA,RGBA_ASTC_12x10_Format:mA,RGBA_ASTC_12x12_Format:gA,RGBA_ASTC_4x4_Format:iA,RGBA_ASTC_5x4_Format:rA,RGBA_ASTC_5x5_Format:sA,RGBA_ASTC_6x5_Format:aA,RGBA_ASTC_6x6_Format:oA,RGBA_ASTC_8x5_Format:lA,RGBA_ASTC_8x6_Format:cA,RGBA_ASTC_8x8_Format:uA,RGBA_BPTC_Format:vA,RGBA_ETC2_EAC_Format:Zb,RGBA_PVRTC_2BPPV1_Format:Jb,RGBA_PVRTC_4BPPV1_Format:Yb,RGBA_S3TC_DXT1_Format:wv,RGBA_S3TC_DXT3_Format:Cv,RGBA_S3TC_DXT5_Format:Rv,RGBDepthPacking:j9,RGBFormat:sw,RGBIntegerFormat:H9,RGB_BPTC_SIGNED_Format:yA,RGB_BPTC_UNSIGNED_Format:_A,RGB_ETC1_Format:Kb,RGB_ETC2_Format:Qb,RGB_PVRTC_2BPPV1_Format:Xb,RGB_PVRTC_4BPPV1_Format:qb,RGB_S3TC_DXT1_Format:Mv,RGDepthPacking:W9,RGFormat:Zd,RGIntegerFormat:hS,RawShaderMaterial:Ew,Ray:hp,Raycaster:zw,RectAreaLight:FL,RedFormat:_y,RedIntegerFormat:xy,ReinhardToneMapping:QM,RenderTarget:cw,RenderTarget3D:F8,RepeatWrapping:_f,ReplaceStencilOp:K9,ReverseSubtractEquation:_B,RingGeometry:NS,SIGNED_R11_EAC_Format:eA,SIGNED_RED_GREEN_RGTC2_Format:SA,SIGNED_RED_RGTC1_Format:bA,SIGNED_RG11_EAC_Format:nA,SRGBColorSpace:Fs,SRGBTransfer:wi,Scene:Ay,ShaderChunk:Gn,ShaderLib:Ul,ShaderMaterial:Gs,ShadowMaterial:AL,Shape:jd,ShapeGeometry:PS,ShapePath:u2,ShapeUtils:zl,ShortType:lS,Skeleton:Ey,SkeletonHelper:Q8,SkinnedMesh:dw,Source:ef,Sphere:bs,SphereGeometry:Ry,Spherical:LT,SphericalHarmonics3:Bw,SplineCurve:Sw,SpotLight:Dw,SpotLightHelper:K8,Sprite:aL,SpriteMaterial:fw,SrcAlphaFactor:Ub,SrcAlphaSaturateFactor:IB,SrcColorFactor:EB,StaticCopyUsage:pH,StaticDrawUsage:Yv,StaticReadUsage:hH,StereoCamera:x8,StreamCopyUsage:gH,StreamDrawUsage:uH,StreamReadUsage:dH,StringKeyframeTrack:pp,SubtractEquation:yB,SubtractiveBlending:ET,TOUCH:wd,TangentSpaceNormalMap:Ef,TetrahedronGeometry:BS,Texture:Ci,TextureLoader:LL,TextureUtils:g2,Timer:G8,TimestampQuery:yH,TorusGeometry:LS,TorusKnotGeometry:OS,Triangle:eo,TriangleFanDrawMode:EA,TriangleStripDrawMode:ow,TrianglesDrawMode:VB,TubeGeometry:US,UVMapping:vf,Uint16BufferAttribute:uw,Uint32BufferAttribute:hw,Uint8BufferAttribute:iG,Uint8ClampedBufferAttribute:rG,Uniform:kw,UniformsGroup:z8,UniformsLib:Wt,UniformsUtils:iL,UnsignedByteType:vs,UnsignedInt101111Type:iw,UnsignedInt248Type:og,UnsignedInt5999Type:nw,UnsignedIntType:So,UnsignedShort4444Type:cS,UnsignedShort5551Type:uS,UnsignedShortType:ag,VSMShadowMap:Nd,Vector2:$e,Vector3:ie,Vector4:zi,VectorKeyframeTrack:rp,VideoFrameTexture:wG,VideoTexture:cL,WebGL3DRenderTarget:WH,WebGLArrayRenderTarget:jH,WebGLCoordinateSystem:xo,WebGLCubeRenderTarget:_S,WebGLRenderTarget:_s,WebGLRenderer:Hw,WebGLUtils:$L,WebGPUCoordinateSystem:ug,WebXRController:mb,WireframeGeometry:bL,WrapAroundEnding:qv,ZeroCurvatureEnding:Bd,ZeroFactor:AB,ZeroSlopeEnding:Ld,ZeroStencilOp:J9,createCanvasElement:ZB,error:cn,getConsoleFunction:SH,log:Kv,setConsoleFunction:AH,warn:Ht,warnOnce:hg},Symbol.toStringTag,{value:"Module"}));var D1={exports:{}},N1={},P1={exports:{}},B1={};/**
 * @license React
 * use-sync-external-store-shim.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var nN;function hX(){if(nN)return B1;nN=1;var i=iy();function e(v,_){return v===_&&(v!==0||1/v===1/_)||v!==v&&_!==_}var t=typeof Object.is=="function"?Object.is:e,n=i.useState,r=i.useEffect,s=i.useLayoutEffect,o=i.useDebugValue;function u(v,_){var x=_(),E=n({inst:{value:x,getSnapshot:_}}),C=E[0].inst,w=E[1];return s(function(){C.value=x,C.getSnapshot=_,f(C)&&w({inst:C})},[v,x,_]),r(function(){return f(C)&&w({inst:C}),v(function(){f(C)&&w({inst:C})})},[v]),o(x),x}function f(v){var _=v.getSnapshot;v=v.value;try{var x=_();return!t(v,x)}catch{return!0}}function p(v,_){return _()}var g=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?p:u;return B1.useSyncExternalStore=i.useSyncExternalStore!==void 0?i.useSyncExternalStore:g,B1}var iN;function fX(){return iN||(iN=1,P1.exports=hX()),P1.exports}/**
 * @license React
 * use-sync-external-store-shim/with-selector.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var rN;function dX(){if(rN)return N1;rN=1;var i=iy(),e=fX();function t(p,g){return p===g&&(p!==0||1/p===1/g)||p!==p&&g!==g}var n=typeof Object.is=="function"?Object.is:t,r=e.useSyncExternalStore,s=i.useRef,o=i.useEffect,u=i.useMemo,f=i.useDebugValue;return N1.useSyncExternalStoreWithSelector=function(p,g,v,_,x){var E=s(null);if(E.current===null){var C={hasValue:!1,value:null};E.current=C}else C=E.current;E=u(function(){function T(k){if(!N){if(N=!0,L=k,k=_(k),x!==void 0&&C.hasValue){var O=C.value;if(x(O,k))return F=O}return F=k}if(O=F,n(L,k))return O;var D=_(k);return x!==void 0&&x(O,D)?(L=k,O):(L=k,F=D)}var N=!1,L,F,G=v===void 0?null:v;return[function(){return T(g())},G===null?void 0:function(){return T(G())}]},[g,v,_,x]);var w=r(p,E[0],E[1]);return o(function(){C.hasValue=!0,C.value=w},[w]),f(w),w},N1}var sN;function pX(){return sN||(sN=1,D1.exports=dX()),D1.exports}var mX=pX();const gX=LA(mX),aN=i=>{let e;const t=new Set,n=(p,g)=>{const v=typeof p=="function"?p(e):p;if(!Object.is(v,e)){const _=e;e=g??(typeof v!="object"||v===null)?v:Object.assign({},e,v),t.forEach(x=>x(e,_))}},r=()=>e,u={setState:n,getState:r,getInitialState:()=>f,subscribe:p=>(t.add(p),()=>t.delete(p))},f=e=i(n,r,u);return u},vX=(i=>i?aN(i):aN),{useSyncExternalStoreWithSelector:yX}=gX,_X=i=>i;function xX(i,e=_X,t){const n=yX(i.subscribe,i.getState,i.getInitialState,e,t);return OA.useDebugValue(n),n}const oN=(i,e)=>{const t=vX(i),n=(r,s=e)=>xX(t,r,s);return Object.assign(n,t),n},eO=((i,e)=>i?oN(i,e):oN),bX=i=>typeof i=="object"&&typeof i.then=="function",Fd=[];function tO(i,e,t=(n,r)=>n===r){if(i===e)return!0;if(!i||!e)return!1;const n=i.length;if(e.length!==n)return!1;for(let r=0;r<n;r++)if(!t(i[r],e[r]))return!1;return!0}function nO(i,e=null,t=!1,n={}){e===null&&(e=[i]);for(const s of Fd)if(tO(e,s.keys,s.equal)){if(t)return;if(Object.prototype.hasOwnProperty.call(s,"error"))throw s.error;if(Object.prototype.hasOwnProperty.call(s,"response"))return n.lifespan&&n.lifespan>0&&(s.timeout&&clearTimeout(s.timeout),s.timeout=setTimeout(s.remove,n.lifespan)),s.response;if(!t)throw s.promise}const r={keys:e,equal:n.equal,remove:()=>{const s=Fd.indexOf(r);s!==-1&&Fd.splice(s,1)},promise:(bX(i)?i:i(...e)).then(s=>{r.response=s,n.lifespan&&n.lifespan>0&&(r.timeout=setTimeout(r.remove,n.lifespan))}).catch(s=>r.error=s)};if(Fd.push(r),!t)throw r.promise}const AX=(i,e,t)=>nO(i,e,!1,t),SX=(i,e,t)=>void nO(i,e,!0,t),EX=i=>{if(i===void 0||i.length===0)Fd.splice(0,Fd.length);else{const e=Fd.find(t=>tO(i,t.keys,t.equal));e&&e.remove()}};var zT=DN();const TX=LA(zT);function Gw(i,e,t){if(!i)return;if(t(i)===!0)return i;let n=e?i.return:i.child;for(;n;){const r=Gw(n,e,t);if(r)return r;n=e?null:n.sibling}}function iO(i){try{return Object.defineProperties(i,{_currentRenderer:{get(){return null},set(){}},_currentRenderer2:{get(){return null},set(){}}})}catch{return i}}const jw=iO(be.createContext(null));class rO extends be.Component{render(){return be.createElement(jw.Provider,{value:this._reactInternals},this.props.children)}}function sO(){const i=be.useContext(jw);if(i===null)throw new Error("its-fine: useFiber must be called within a <FiberProvider />!");const e=be.useId();return be.useMemo(()=>{for(const t of[i,i==null?void 0:i.alternate]){if(!t)continue;const n=Gw(t,!1,r=>{let s=r.memoizedState;for(;s;){if(s.memoizedState===e)return!0;s=s.next}});if(n)return n}},[i,e])}const MX=Symbol.for("react.context"),wX=i=>i!==null&&typeof i=="object"&&"$$typeof"in i&&i.$$typeof===MX;function CX(){const i=sO(),[e]=be.useState(()=>new Map);e.clear();let t=i;for(;t;){const n=t.type;wX(n)&&n!==jw&&!e.has(n)&&e.set(n,be.use(iO(n))),t=t.return}return e}function RX(){const i=CX();return be.useMemo(()=>Array.from(i.keys()).reduce((e,t)=>n=>be.createElement(e,null,be.createElement(t.Provider,{...n,value:i.get(t)})),e=>be.createElement(rO,{...e})),[i])}function aO(i){let e=i.root;for(;e.getState().previousRoot;)e=e.getState().previousRoot;return e}const oO=i=>i&&i.isOrthographicCamera,IX=i=>i&&i.hasOwnProperty("current"),DX=i=>i!=null&&(typeof i=="string"||typeof i=="number"||i.isColor),Iy=((i,e)=>typeof window<"u"&&(((i=window.document)==null?void 0:i.createElement)||((e=window.navigator)==null?void 0:e.product)==="ReactNative"))()?be.useLayoutEffect:be.useEffect;function Ww(i){const e=be.useRef(i);return Iy(()=>void(e.current=i),[i]),e}function NX(){const i=sO(),e=RX();return be.useMemo(()=>({children:t})=>{const r=!!Gw(i,!0,s=>s.type===be.StrictMode)?be.StrictMode:be.Fragment;return V.jsx(r,{children:V.jsx(e,{children:t})})},[i,e])}function PX({set:i}){return Iy(()=>(i(new Promise(()=>null)),()=>i(!1)),[i]),null}const BX=(i=>(i=class extends be.Component{constructor(...t){super(...t),this.state={error:!1}}componentDidCatch(t){this.props.set(t)}render(){return this.state.error?null:this.props.children}},i.getDerivedStateFromError=()=>({error:!0}),i))();function lO(i){var e;const t=typeof window<"u"?(e=window.devicePixelRatio)!=null?e:2:1;return Array.isArray(i)?Math.min(Math.max(i[0],t),i[1]):i}function Dm(i){var e;return(e=i.__r3f)==null?void 0:e.root.getState()}const ur={obj:i=>i===Object(i)&&!ur.arr(i)&&typeof i!="function",fun:i=>typeof i=="function",str:i=>typeof i=="string",num:i=>typeof i=="number",boo:i=>typeof i=="boolean",und:i=>i===void 0,nul:i=>i===null,arr:i=>Array.isArray(i),equ(i,e,{arrays:t="shallow",objects:n="reference",strict:r=!0}={}){if(typeof i!=typeof e||!!i!=!!e)return!1;if(ur.str(i)||ur.num(i)||ur.boo(i))return i===e;const s=ur.obj(i);if(s&&n==="reference")return i===e;const o=ur.arr(i);if(o&&t==="reference")return i===e;if((o||s)&&i===e)return!0;let u;for(u in i)if(!(u in e))return!1;if(s&&t==="shallow"&&n==="shallow"){for(u in r?e:i)if(!ur.equ(i[u],e[u],{strict:r,objects:"reference"}))return!1}else for(u in r?e:i)if(i[u]!==e[u])return!1;if(ur.und(u)){if(o&&i.length===0&&e.length===0||s&&Object.keys(i).length===0&&Object.keys(e).length===0)return!0;if(i!==e)return!1}return!0}};function LX(i){const e={nodes:{},materials:{},meshes:{}};return i&&i.traverse(t=>{t.name&&(e.nodes[t.name]=t),t.material&&!e.materials[t.material.name]&&(e.materials[t.material.name]=t.material),t.isMesh&&!e.meshes[t.name]&&(e.meshes[t.name]=t)}),e}function OX(i){i.type!=="Scene"&&(i.dispose==null||i.dispose());for(const e in i){const t=i[e];(t==null?void 0:t.type)!=="Scene"&&(t==null||t.dispose==null||t.dispose())}}const cO=["children","key","ref"];function UX(i){const e={};for(const t in i)cO.includes(t)||(e[t]=i[t]);return e}function RA(i,e,t,n){const r=i;let s=r==null?void 0:r.__r3f;return s||(s={root:e,type:t,parent:null,children:[],props:UX(n),object:r,eventCount:0,handlers:{},isHidden:!1},r&&(r.__r3f=s)),s}function ty(i,e){if(!e.includes("-"))return{root:i,key:e,target:i[e]};if(e in i)return{root:i,key:e,target:i[e]};let t=i;const n=e.split("-");for(const r of n){if(typeof t!="object"||t===null){if(t!==void 0){const s=n.slice(n.indexOf(r)).join("-");return{root:t,key:s,target:void 0}}return{root:i,key:e,target:void 0}}e=r,i=t,t=t[e]}return{root:i,key:e,target:t}}const lN=/-\d+$/;function IA(i,e){if(ur.str(e.props.attach)){if(lN.test(e.props.attach)){const r=e.props.attach.replace(lN,""),{root:s,key:o}=ty(i.object,r);Array.isArray(s[o])||(s[o]=[])}const{root:t,key:n}=ty(i.object,e.props.attach);e.previousAttach=t[n],t[n]=e.object}else ur.fun(e.props.attach)&&(e.previousAttach=e.props.attach(i.object,e.object))}function DA(i,e){if(ur.str(e.props.attach)){const{root:t,key:n}=ty(i.object,e.props.attach),r=e.previousAttach;r===void 0?delete t[n]:t[n]=r}else e.previousAttach==null||e.previousAttach(i.object,e.object);delete e.previousAttach}const VT=[...cO,"args","dispose","attach","object","onUpdate","dispose"],cN=new Map;function FX(i){let e=cN.get(i.constructor);try{e||(e=new i.constructor,cN.set(i.constructor,e))}catch{}return e}function kX(i,e){const t={};for(const n in e)if(!VT.includes(n)&&!ur.equ(e[n],i.props[n])){t[n]=e[n];for(const r in e)r.startsWith(`${n}-`)&&(t[r]=e[r])}for(const n in i.props){if(VT.includes(n)||e.hasOwnProperty(n))continue;const{root:r,key:s}=ty(i.object,n);if(r.constructor&&r.constructor.length===0){const o=FX(r);ur.und(o)||(t[s]=o[s])}else t[s]=0}return t}const zX=["map","emissiveMap","sheenColorMap","specularColorMap","envMap"],VX=/^on(Pointer|Click|DoubleClick|ContextMenu|Wheel)/;function Bc(i,e){var t;const n=i.__r3f,r=n&&aO(n).getState(),s=n==null?void 0:n.eventCount;for(const u in e){let f=e[u];if(VT.includes(u))continue;if(n&&VX.test(u)){typeof f=="function"?n.handlers[u]=f:delete n.handlers[u],n.eventCount=Object.keys(n.handlers).length;continue}if(f===void 0)continue;let{root:p,key:g,target:v}=ty(i,u);if(v===void 0&&(typeof p!="object"||p===null))throw Error(`R3F: Cannot set "${u}". Ensure it is an object before setting "${g}".`);if(v instanceof dg&&f instanceof dg)v.mask=f.mask;else if(v instanceof Gt&&DX(f))v.set(f);else if(v!==null&&typeof v=="object"&&typeof v.set=="function"&&typeof v.copy=="function"&&f!=null&&f.constructor&&v.constructor===f.constructor)v.copy(f);else if(v!==null&&typeof v=="object"&&typeof v.set=="function"&&Array.isArray(f))typeof v.fromArray=="function"?v.fromArray(f):v.set(...f);else if(v!==null&&typeof v=="object"&&typeof v.set=="function"&&typeof f=="number")typeof v.setScalar=="function"?v.setScalar(f):v.set(f);else{var o;p[g]=f,r&&!r.linear&&zX.includes(g)&&(o=p[g])!=null&&o.isTexture&&p[g].format===jr&&p[g].type===vs&&(p[g].colorSpace=Fs)}}if(n!=null&&n.parent&&r!=null&&r.internal&&(t=n.object)!=null&&t.isObject3D&&s!==n.eventCount){const u=n.object,f=r.internal.interaction.indexOf(u);f>-1&&r.internal.interaction.splice(f,1),n.eventCount&&u.raycast!==null&&r.internal.interaction.push(u)}return n&&n.props.attach===void 0&&(n.object.isBufferGeometry?n.props.attach="geometry":n.object.isMaterial&&(n.props.attach="material")),n&&Dg(n),i}function Dg(i){var e;if(!i.parent)return;i.props.onUpdate==null||i.props.onUpdate(i.object);const t=(e=i.root)==null||e.getState==null?void 0:e.getState();t&&t.internal.frames===0&&t.invalidate()}function uO(i,e){i.manual||(oO(i)?(i.left=e.width/-2,i.right=e.width/2,i.top=e.height/2,i.bottom=e.height/-2):i.aspect=e.width/e.height,i.updateProjectionMatrix())}const Ma=i=>i==null?void 0:i.isObject3D;function Jx(i){return(i.eventObject||i.object).uuid+"/"+i.index+i.instanceId}function hO(i,e,t,n){const r=t.get(e);r&&(t.delete(e),t.size===0&&(i.delete(n),r.target.releasePointerCapture(n)))}function HX(i,e){const{internal:t}=i.getState();t.interaction=t.interaction.filter(n=>n!==e),t.initialHits=t.initialHits.filter(n=>n!==e),t.hovered.forEach((n,r)=>{(n.eventObject===e||n.object===e)&&t.hovered.delete(r)}),t.capturedMap.forEach((n,r)=>{hO(t.capturedMap,e,n,r)})}function GX(i){function e(f){const{internal:p}=i.getState(),g=f.offsetX-p.initialClick[0],v=f.offsetY-p.initialClick[1];return Math.round(Math.sqrt(g*g+v*v))}function t(f){return f.filter(p=>["Move","Over","Enter","Out","Leave"].some(g=>{var v;return(v=p.__r3f)==null?void 0:v.handlers["onPointer"+g]}))}function n(f,p){const g=i.getState(),v=new Set,_=[],x=p?p(g.internal.interaction):g.internal.interaction;for(let T=0;T<x.length;T++){const N=Dm(x[T]);N&&(N.raycaster.camera=void 0)}g.previousRoot||g.events.compute==null||g.events.compute(f,g);function E(T){const N=Dm(T);if(!N||!N.events.enabled||N.raycaster.camera===null)return[];if(N.raycaster.camera===void 0){var L;N.events.compute==null||N.events.compute(f,N,(L=N.previousRoot)==null?void 0:L.getState()),N.raycaster.camera===void 0&&(N.raycaster.camera=null)}return N.raycaster.camera?N.raycaster.intersectObject(T,!0):[]}let C=x.flatMap(E).sort((T,N)=>{const L=Dm(T.object),F=Dm(N.object);return!L||!F?T.distance-N.distance:F.events.priority-L.events.priority||T.distance-N.distance}).filter(T=>{const N=Jx(T);return v.has(N)?!1:(v.add(N),!0)});g.events.filter&&(C=g.events.filter(C,g));for(const T of C){let N=T.object;for(;N;){var w;(w=N.__r3f)!=null&&w.eventCount&&_.push({...T,eventObject:N}),N=N.parent}}if("pointerId"in f&&g.internal.capturedMap.has(f.pointerId))for(let T of g.internal.capturedMap.get(f.pointerId).values())v.has(Jx(T.intersection))||_.push(T.intersection);return _}function r(f,p,g,v){if(f.length){const _={stopped:!1};for(const x of f){let E=Dm(x.object);if(E||x.object.traverseAncestors(C=>{const w=Dm(C);if(w)return E=w,!1}),E){const{raycaster:C,pointer:w,camera:T,internal:N}=E,L=new ie(w.x,w.y,0).unproject(T),F=R=>{var P,z;return(P=(z=N.capturedMap.get(R))==null?void 0:z.has(x.eventObject))!=null?P:!1},G=R=>{const P={intersection:x,target:p.target};N.capturedMap.has(R)?N.capturedMap.get(R).set(x.eventObject,P):N.capturedMap.set(R,new Map([[x.eventObject,P]])),p.target.setPointerCapture(R)},k=R=>{const P=N.capturedMap.get(R);P&&hO(N.capturedMap,x.eventObject,P,R)};let O={};for(let R in p){let P=p[R];typeof P!="function"&&(O[R]=P)}let D={...x,...O,pointer:w,intersections:f,stopped:_.stopped,delta:g,unprojectedPoint:L,ray:C.ray,camera:T,stopPropagation(){const R="pointerId"in p&&N.capturedMap.get(p.pointerId);if((!R||R.has(x.eventObject))&&(D.stopped=_.stopped=!0,N.hovered.size&&Array.from(N.hovered.values()).find(P=>P.eventObject===x.eventObject))){const P=f.slice(0,f.indexOf(x));s([...P,x])}},target:{hasPointerCapture:F,setPointerCapture:G,releasePointerCapture:k},currentTarget:{hasPointerCapture:F,setPointerCapture:G,releasePointerCapture:k},nativeEvent:p};if(v(D),_.stopped===!0)break}}}return f}function s(f){const{internal:p}=i.getState();for(const g of p.hovered.values())if(!f.length||!f.find(v=>v.object===g.object&&v.index===g.index&&v.instanceId===g.instanceId)){const _=g.eventObject.__r3f;if(p.hovered.delete(Jx(g)),_!=null&&_.eventCount){const x=_.handlers,E={...g,intersections:f};x.onPointerOut==null||x.onPointerOut(E),x.onPointerLeave==null||x.onPointerLeave(E)}}}function o(f,p){for(let g=0;g<p.length;g++){const v=p[g].__r3f;v==null||v.handlers.onPointerMissed==null||v.handlers.onPointerMissed(f)}}function u(f){switch(f){case"onPointerLeave":case"onPointerCancel":return()=>s([]);case"onLostPointerCapture":return p=>{const{internal:g}=i.getState();"pointerId"in p&&g.capturedMap.has(p.pointerId)&&requestAnimationFrame(()=>{g.capturedMap.has(p.pointerId)&&(g.capturedMap.delete(p.pointerId),s([]))})}}return function(g){const{onPointerMissed:v,internal:_}=i.getState();_.lastEvent.current=g;const x=f==="onPointerMove",E=f==="onClick"||f==="onContextMenu"||f==="onDoubleClick",w=n(g,x?t:void 0),T=E?e(g):0;f==="onPointerDown"&&(_.initialClick=[g.offsetX,g.offsetY],_.initialHits=w.map(L=>L.eventObject)),E&&!w.length&&T<=2&&(o(g,_.interaction),v&&v(g)),x&&s(w);function N(L){const F=L.eventObject,G=F.__r3f;if(!(G!=null&&G.eventCount))return;const k=G.handlers;if(x){if(k.onPointerOver||k.onPointerEnter||k.onPointerOut||k.onPointerLeave){const O=Jx(L),D=_.hovered.get(O);D?D.stopped&&L.stopPropagation():(_.hovered.set(O,L),k.onPointerOver==null||k.onPointerOver(L),k.onPointerEnter==null||k.onPointerEnter(L))}k.onPointerMove==null||k.onPointerMove(L)}else{const O=k[f];O?(!E||_.initialHits.includes(F))&&(o(g,_.interaction.filter(D=>!_.initialHits.includes(D))),O(L)):E&&_.initialHits.includes(F)&&o(g,_.interaction.filter(D=>!_.initialHits.includes(D)))}}r(w,g,T,N)}}return{handlePointer:u}}const uN=i=>!!(i!=null&&i.render),qw=be.createContext(null),jX=(i,e)=>{const t=eO((u,f)=>{const p=new ie,g=new ie,v=new ie;function _(T=f().camera,N=g,L=f().size){const{width:F,height:G,top:k,left:O}=L,D=F/G;N.isVector3?v.copy(N):v.set(...N);const R=T.getWorldPosition(p).distanceTo(v);if(oO(T))return{width:F/T.zoom,height:G/T.zoom,top:k,left:O,factor:1,distance:R,aspect:D};{const P=T.fov*Math.PI/180,z=2*Math.tan(P/2)*R,Y=z*(F/G);return{width:Y,height:z,top:k,left:O,factor:F/Y,distance:R,aspect:D}}}let x;const E=T=>u(N=>({performance:{...N.performance,current:T}})),C=new $e;return{set:u,get:f,gl:null,camera:null,raycaster:null,events:{priority:1,enabled:!0,connected:!1},scene:null,xr:null,invalidate:(T=1)=>i(f(),T),advance:(T,N)=>e(T,N,f()),legacy:!1,linear:!1,flat:!1,controls:null,clock:new Ow,pointer:C,mouse:C,frameloop:"always",onPointerMissed:void 0,performance:{current:1,min:.5,max:1,debounce:200,regress:()=>{const T=f();x&&clearTimeout(x),T.performance.current!==T.performance.min&&E(T.performance.min),x=setTimeout(()=>E(f().performance.max),T.performance.debounce)}},size:{width:0,height:0,top:0,left:0},viewport:{initialDpr:0,dpr:0,width:0,height:0,top:0,left:0,aspect:0,distance:0,factor:0,getCurrentViewport:_},setEvents:T=>u(N=>({...N,events:{...N.events,...T}})),setSize:(T,N,L=0,F=0)=>{const G=f().camera,k={width:T,height:N,top:L,left:F};u(O=>({size:k,viewport:{...O.viewport,..._(G,g,k)}}))},setDpr:T=>u(N=>{const L=lO(T);return{viewport:{...N.viewport,dpr:L,initialDpr:N.viewport.initialDpr||L}}}),setFrameloop:(T="always")=>{const N=f().clock;N.stop(),N.elapsedTime=0,T!=="never"&&(N.start(),N.elapsedTime=0),u(()=>({frameloop:T}))},previousRoot:void 0,internal:{interaction:[],hovered:new Map,subscribers:[],initialClick:[0,0],initialHits:[],capturedMap:new Map,lastEvent:be.createRef(),active:!1,frames:0,priority:0,subscribe:(T,N,L)=>{const F=f().internal;return F.priority=F.priority+(N>0?1:0),F.subscribers.push({ref:T,priority:N,store:L}),F.subscribers=F.subscribers.sort((G,k)=>G.priority-k.priority),()=>{const G=f().internal;G!=null&&G.subscribers&&(G.priority=G.priority-(N>0?1:0),G.subscribers=G.subscribers.filter(k=>k.ref!==T))}}}}}),n=t.getState();let r=n.size,s=n.viewport.dpr,o=n.camera;return t.subscribe(()=>{const{camera:u,size:f,viewport:p,gl:g,set:v}=t.getState();if(f.width!==r.width||f.height!==r.height||p.dpr!==s){r=f,s=p.dpr,uO(u,f),p.dpr>0&&g.setPixelRatio(p.dpr);const _=typeof HTMLCanvasElement<"u"&&g.domElement instanceof HTMLCanvasElement;g.setSize(f.width,f.height,_)}u!==o&&(o=u,v(_=>({viewport:{..._.viewport,..._.viewport.getCurrentViewport(u)}})))}),t.subscribe(u=>i(u)),t};function Xw(){const i=be.useContext(qw);if(!i)throw new Error("R3F: Hooks can only be used within the Canvas component!");return i}function Hr(i=t=>t,e){return Xw()(i,e)}function Ng(i,e=0){const t=Xw(),n=t.getState().internal.subscribe,r=Ww(i);return Iy(()=>n(r,e,t),[e,n,t]),null}const hN=new WeakMap,WX=i=>{var e;return typeof i=="function"&&(i==null||(e=i.prototype)==null?void 0:e.constructor)===i};function fO(i,e){return function(t,...n){let r;return WX(t)?(r=hN.get(t),r||(r=new t,hN.set(t,r))):r=t,i&&i(r),Promise.all(n.map(s=>new Promise((o,u)=>r.load(s,f=>{Ma(f==null?void 0:f.scene)&&Object.assign(f,LX(f.scene)),o(f)},e,f=>u(new Error(`Could not load ${s}: ${f==null?void 0:f.message}`))))))}}function Wu(i,e,t,n){const r=Array.isArray(e)?e:[e],s=AX(fO(t,n),[i,...r],{equal:ur.equ});return Array.isArray(e)?s:s[0]}Wu.preload=function(i,e,t){const n=Array.isArray(e)?e:[e];return SX(fO(t),[i,...n])};Wu.clear=function(i,e){const t=Array.isArray(e)?e:[e];return EX([i,...t])};/**
 * @license React
 * react-reconciler-constants.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */const qX=1,XX=8,YX=32,JX=2;var KX={version:"9.5.0"};function QX(i){return i&&i.__esModule&&Object.prototype.hasOwnProperty.call(i,"default")?i.default:i}var fN={exports:{}},dN={exports:{}},pN;function ZX(){return pN||(pN=1,(function(i){i.exports=function(e){function t(c,h,y,A){return new qg(c,h,y,A)}function n(){}function r(c){var h="https://react.dev/errors/"+c;if(1<arguments.length){h+="?args[]="+encodeURIComponent(arguments[1]);for(var y=2;y<arguments.length;y++)h+="&args[]="+encodeURIComponent(arguments[y])}return"Minified React error #"+c+"; visit "+h+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function s(c){var h=c,y=c;if(c.alternate)for(;h.return;)h=h.return;else{c=h;do h=c,(h.flags&4098)!==0&&(y=h.return),c=h.return;while(c)}return h.tag===3?y:null}function o(c){if(s(c)!==c)throw Error(r(188))}function u(c){var h=c.alternate;if(!h){if(h=s(c),h===null)throw Error(r(188));return h!==c?null:c}for(var y=c,A=h;;){var I=y.return;if(I===null)break;var B=I.alternate;if(B===null){if(A=I.return,A!==null){y=A;continue}break}if(I.child===B.child){for(B=I.child;B;){if(B===y)return o(I),c;if(B===A)return o(I),h;B=B.sibling}throw Error(r(188))}if(y.return!==A.return)y=I,A=B;else{for(var K=!1,pe=I.child;pe;){if(pe===y){K=!0,y=I,A=B;break}if(pe===A){K=!0,A=I,y=B;break}pe=pe.sibling}if(!K){for(pe=B.child;pe;){if(pe===y){K=!0,y=B,A=I;break}if(pe===A){K=!0,A=B,y=I;break}pe=pe.sibling}if(!K)throw Error(r(189))}}if(y.alternate!==A)throw Error(r(190))}if(y.tag!==3)throw Error(r(188));return y.stateNode.current===y?c:h}function f(c){var h=c.tag;if(h===5||h===26||h===27||h===6)return c;for(c=c.child;c!==null;){if(h=f(c),h!==null)return h;c=c.sibling}return null}function p(c){var h=c.tag;if(h===5||h===26||h===27||h===6)return c;for(c=c.child;c!==null;){if(c.tag!==4&&(h=p(c),h!==null))return h;c=c.sibling}return null}function g(c){return c===null||typeof c!="object"?null:(c=Sl&&c[Sl]||c["@@iterator"],typeof c=="function"?c:null)}function v(c){if(c==null)return null;if(typeof c=="function")return c.$$typeof===dc?null:c.displayName||c.name||null;if(typeof c=="string")return c;switch(c){case au:return"Fragment";case lu:return"Profiler";case ou:return"StrictMode";case Np:return"Suspense";case Al:return"SuspenseList";case Wf:return"Activity"}if(typeof c=="object")switch(c.$$typeof){case su:return"Portal";case Fa:return c.displayName||"Context";case jf:return(c._context.displayName||"Context")+".Consumer";case mh:var h=c.render;return c=c.displayName,c||(c=h.displayName||h.name||"",c=c!==""?"ForwardRef("+c+")":"ForwardRef"),c;case Pp:return h=c.displayName||null,h!==null?h:v(c.type)||"Memo";case Is:h=c._payload,c=c._init;try{return v(c(h))}catch{}}return null}function _(c){return{current:c}}function x(c){0>du||(c.current=qp[du],qp[du]=null,du--)}function E(c,h){du++,qp[du]=c.current,c.current=h}function C(c){return c>>>=0,c===0?32:31-(Xp(c)/N_|0)|0}function w(c){var h=c&42;if(h!==0)return h;switch(c&-c){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:return c&261888;case 262144:case 524288:case 1048576:case 2097152:return c&3932160;case 4194304:case 8388608:case 16777216:case 33554432:return c&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return c}}function T(c,h,y){var A=c.pendingLanes;if(A===0)return 0;var I=0,B=c.suspendedLanes,K=c.pingedLanes;c=c.warmLanes;var pe=A&134217727;return pe!==0?(A=pe&~B,A!==0?I=w(A):(K&=pe,K!==0?I=w(K):y||(y=pe&~c,y!==0&&(I=w(y))))):(pe=A&~B,pe!==0?I=w(pe):K!==0?I=w(K):y||(y=A&~c,y!==0&&(I=w(y)))),I===0?0:h!==0&&h!==I&&(h&B)===0&&(B=I&-I,y=h&-h,B>=y||B===32&&(y&4194048)!==0)?h:I}function N(c,h){return(c.pendingLanes&~(c.suspendedLanes&~c.pingedLanes)&h)===0}function L(c,h){switch(c){case 1:case 2:case 4:case 8:case 64:return h+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return h+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function F(){var c=Ah;return Ah<<=1,(Ah&62914560)===0&&(Ah=4194304),c}function G(c){for(var h=[],y=0;31>y;y++)h.push(c);return h}function k(c,h){c.pendingLanes|=h,h!==268435456&&(c.suspendedLanes=0,c.pingedLanes=0,c.warmLanes=0)}function O(c,h,y,A,I,B){var K=c.pendingLanes;c.pendingLanes=y,c.suspendedLanes=0,c.pingedLanes=0,c.warmLanes=0,c.expiredLanes&=y,c.entangledLanes&=y,c.errorRecoveryDisabledLanes&=y,c.shellSuspendCounter=0;var pe=c.entanglements,je=c.expirationTimes,ft=c.hiddenUpdates;for(y=K&~y;0<y;){var Bt=31-Zs(y),Et=1<<Bt;pe[Bt]=0,je[Bt]=-1;var Jt=ft[Bt];if(Jt!==null)for(ft[Bt]=null,Bt=0;Bt<Jt.length;Bt++){var Rn=Jt[Bt];Rn!==null&&(Rn.lane&=-536870913)}y&=~Et}A!==0&&D(c,A,0),B!==0&&I===0&&c.tag!==0&&(c.suspendedLanes|=B&~(K&~h))}function D(c,h,y){c.pendingLanes|=h,c.suspendedLanes&=~h;var A=31-Zs(h);c.entangledLanes|=h,c.entanglements[A]=c.entanglements[A]|1073741824|y&261930}function R(c,h){var y=c.entangledLanes|=h;for(c=c.entanglements;y;){var A=31-Zs(y),I=1<<A;I&h|c[A]&h&&(c[A]|=h),y&=~I}}function P(c,h){var y=h&-h;return y=(y&42)!==0?1:z(y),(y&(c.suspendedLanes|h))!==0?0:y}function z(c){switch(c){case 2:c=1;break;case 8:c=4;break;case 32:c=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:c=128;break;case 268435456:c=134217728;break;default:c=0}return c}function Y(c){return c&=-c,2<c?8<c?(c&134217727)!==0?32:268435456:8:2}function j(c){if(typeof D0=="function"&&L_(c),$s&&typeof $s.setStrictMode=="function")try{$s.setStrictMode(mu,c)}catch{}}function ce(c,h){return c===h&&(c!==0||1/c===1/h)||c!==c&&h!==h}function fe(c){if($p===void 0)try{throw Error()}catch(y){var h=y.stack.trim().match(/\n( *(at )?)/);$p=h&&h[1]||"",Wo=-1<y.stack.indexOf(`
    at`)?" (<anonymous>)":-1<y.stack.indexOf("@")?"@unknown:0:0":""}return`
`+$p+c+Wo}function te(c,h){if(!c||ed)return"";ed=!0;var y=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var A={DetermineComponentFrameRoot:function(){try{if(h){var Et=function(){throw Error()};if(Object.defineProperty(Et.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(Et,[])}catch(Rn){var Jt=Rn}Reflect.construct(c,[],Et)}else{try{Et.call()}catch(Rn){Jt=Rn}c.call(Et.prototype)}}else{try{throw Error()}catch(Rn){Jt=Rn}(Et=c())&&typeof Et.catch=="function"&&Et.catch(function(){})}}catch(Rn){if(Rn&&Jt&&typeof Rn.stack=="string")return[Rn.stack,Jt.stack]}return[null,null]}};A.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var I=Object.getOwnPropertyDescriptor(A.DetermineComponentFrameRoot,"name");I&&I.configurable&&Object.defineProperty(A.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var B=A.DetermineComponentFrameRoot(),K=B[0],pe=B[1];if(K&&pe){var je=K.split(`
`),ft=pe.split(`
`);for(I=A=0;A<je.length&&!je[A].includes("DetermineComponentFrameRoot");)A++;for(;I<ft.length&&!ft[I].includes("DetermineComponentFrameRoot");)I++;if(A===je.length||I===ft.length)for(A=je.length-1,I=ft.length-1;1<=A&&0<=I&&je[A]!==ft[I];)I--;for(;1<=A&&0<=I;A--,I--)if(je[A]!==ft[I]){if(A!==1||I!==1)do if(A--,I--,0>I||je[A]!==ft[I]){var Bt=`
`+je[A].replace(" at new "," at ");return c.displayName&&Bt.includes("<anonymous>")&&(Bt=Bt.replace("<anonymous>",c.displayName)),Bt}while(1<=A&&0<=I);break}}}finally{ed=!1,Error.prepareStackTrace=y}return(y=c?c.displayName||c.name:"")?fe(y):""}function se(c,h){switch(c.tag){case 26:case 27:case 5:return fe(c.type);case 16:return fe("Lazy");case 13:return c.child!==h&&h!==null?fe("Suspense Fallback"):fe("Suspense");case 19:return fe("SuspenseList");case 0:case 15:return te(c.type,!1);case 11:return te(c.type.render,!1);case 1:return te(c.type,!0);case 31:return fe("Activity");default:return""}}function Ae(c){try{var h="",y=null;do h+=se(c,y),y=c,c=c.return;while(c);return h}catch(A){return`
Error generating stack: `+A.message+`
`+A.stack}}function Pe(c,h){if(typeof c=="object"&&c!==null){var y=N0.get(c);return y!==void 0?y:(h={value:c,source:h,stack:Ae(h)},N0.set(c,h),h)}return{value:c,source:h,stack:Ae(h)}}function Re(c,h){Ml[qo++]=td,Ml[qo++]=Mi,Mi=c,td=h}function $(c,h,y){Va[_a++]=ns,Va[_a++]=uo,Va[_a++]=Ha,Ha=c;var A=ns;c=uo;var I=32-Zs(A)-1;A&=~(1<<I),y+=1;var B=32-Zs(h)+I;if(30<B){var K=I-I%5;B=(A&(1<<K)-1).toString(32),A>>=K,I-=K,ns=1<<32-Zs(h)+I|y<<I|A,uo=B+c}else ns=1<<B|y<<I|A,uo=c}function ae(c){c.return!==null&&(Re(c,1),$(c,1,0))}function Se(c){for(;c===Mi;)Mi=Ml[--qo],Ml[qo]=null,td=Ml[--qo],Ml[qo]=null;for(;c===Ha;)Ha=Va[--_a],Va[_a]=null,uo=Va[--_a],Va[_a]=null,ns=Va[--_a],Va[_a]=null}function ke(c,h){Va[_a++]=ns,Va[_a++]=uo,Va[_a++]=Ha,ns=h.id,uo=h.overflow,Ha=c}function dt(c,h){E(is,h),E(wl,c),E(Jr,null),c=Yy(h),x(Jr),E(Jr,c)}function ve(){x(Jr),x(wl),x(is)}function Le(c){c.memoizedState!==null&&E(nd,c);var h=Jr.current,y=yh(h,c.type);h!==y&&(E(wl,c),E(Jr,y))}function lt(c){wl.current===c&&(x(Jr),x(wl)),nd.current===c&&(x(nd),gr?hu._currentValue=uu:hu._currentValue2=uu)}function _t(c){var h=Error(r(418,1<arguments.length&&arguments[1]!==void 0&&arguments[1]?"text":"HTML",""));throw rt(Pe(h,c)),em}function Dt(c,h){if(!Gi)throw Error(r(175));x_(c.stateNode,c.type,c.memoizedProps,h,c)||_t(c,!0)}function qt(c){for(Ur=c.return;Ur;)switch(Ur.tag){case 5:case 31:case 13:Ns=!1;return;case 27:case 3:Ns=!0;return;default:Ur=Ur.return}}function un(c){if(!Gi||c!==Ur)return!1;if(!Xn)return qt(c),Xn=!0,!1;var h=c.tag;if(Or?h!==3&&h!==27&&(h!==5||bh(c.type)&&!Ds(c.type,c.memoizedProps))&&ji&&_t(c):h!==3&&(h!==5||bh(c.type)&&!Ds(c.type,c.memoizedProps))&&ji&&_t(c),qt(c),h===13){if(!Gi)throw Error(r(316));if(c=c.memoizedState,c=c!==null?c.dehydrated:null,!c)throw Error(r(317));ji=x0(c)}else if(h===31){if(c=c.memoizedState,c=c!==null?c.dehydrated:null,!c)throw Error(r(317));ji=A_(c)}else ji=Or&&h===27?f_(c.type,ji):Ur?h_(c.stateNode):null;return!0}function Yt(){Gi&&(ji=Ur=null,Xn=!1)}function qe(){var c=Xo;return c!==null&&(na===null?na=c:na.push.apply(na,c),Xo=null),c}function rt(c){Xo===null?Xo=[c]:Xo.push(c)}function Je(c,h,y){gr?(E(Ga,h._currentValue),h._currentValue=y):(E(Ga,h._currentValue2),h._currentValue2=y)}function xt(c){var h=Ga.current;gr?c._currentValue=h:c._currentValue2=h,x(Ga)}function re(c,h,y){for(;c!==null;){var A=c.alternate;if((c.childLanes&h)!==h?(c.childLanes|=h,A!==null&&(A.childLanes|=h)):A!==null&&(A.childLanes&h)!==h&&(A.childLanes|=h),c===y)break;c=c.return}}function Lt(c,h,y,A){var I=c.child;for(I!==null&&(I.return=c);I!==null;){var B=I.dependencies;if(B!==null){var K=I.child;B=B.firstContext;e:for(;B!==null;){var pe=B;B=I;for(var je=0;je<h.length;je++)if(pe.context===h[je]){B.lanes|=y,pe=B.alternate,pe!==null&&(pe.lanes|=y),re(B.return,y,c),A||(K=null);break e}B=pe.next}}else if(I.tag===18){if(K=I.return,K===null)throw Error(r(341));K.lanes|=y,B=K.alternate,B!==null&&(B.lanes|=y),re(K,y,c),K=null}else K=I.child;if(K!==null)K.return=I;else for(K=I;K!==null;){if(K===c){K=null;break}if(I=K.sibling,I!==null){I.return=K.return,K=I;break}K=K.return}I=K}}function vt(c,h,y,A){c=null;for(var I=h,B=!1;I!==null;){if(!B){if((I.flags&524288)!==0)B=!0;else if((I.flags&262144)!==0)break}if(I.tag===10){var K=I.alternate;if(K===null)throw Error(r(387));if(K=K.memoizedProps,K!==null){var pe=I.type;yr(I.pendingProps.value,K.value)||(c!==null?c.push(pe):c=[pe])}}else if(I===nd.current){if(K=I.alternate,K===null)throw Error(r(387));K.memoizedState.memoizedState!==I.memoizedState.memoizedState&&(c!==null?c.push(hu):c=[hu])}I=I.return}c!==null&&Lt(h,c,y,A),h.flags|=262144}function Qt(c){for(c=c.firstContext;c!==null;){var h=c.context;if(!yr(gr?h._currentValue:h._currentValue2,c.memoizedValue))return!0;c=c.next}return!1}function bt(c){Bi=c,ho=null,c=c.dependencies,c!==null&&(c.firstContext=null)}function ee(c){return ge(Bi,c)}function q(c,h){return Bi===null&&bt(c),ge(c,h)}function ge(c,h){var y=gr?h._currentValue:h._currentValue2;if(h={context:h,memoizedValue:y,next:null},ho===null){if(c===null)throw Error(r(308));ho=h,c.dependencies={lanes:0,firstContext:h},c.flags|=524288}else ho=ho.next=h;return y}function Fe(){return{controller:new O_,data:new Map,refCount:0}}function Xe(c){c.refCount--,c.refCount===0&&Kr(eE,function(){c.controller.abort()})}function Ue(){}function Ft(c){c!==xi&&c.next===null&&(xi===null?id=xi=c:xi=xi.next=c),ja=!0,ds||(ds=!0,oe())}function Ct(c,h){if(!tm&&ja){tm=!0;do for(var y=!1,A=id;A!==null;){if(c!==0){var I=A.pendingLanes;if(I===0)var B=0;else{var K=A.suspendedLanes,pe=A.pingedLanes;B=(1<<31-Zs(42|c)+1)-1,B&=I&~(K&~pe),B=B&201326741?B&201326741|1:B?B|2:0}B!==0&&(y=!0,Ut(A,B))}else B=Yn,B=T(A,A===zn?B:0,A.cancelPendingCommit!==null||A.timeoutHandle!==Qs),(B&3)===0||N(A,B)||(y=!0,Ut(A,B));A=A.next}while(y);tm=!1}}function Xt(){an()}function an(){ja=ds=!1;var c=0;yc!==0&&cu()&&(c=yc);for(var h=fs(),y=null,A=id;A!==null;){var I=A.next,B=tt(A,h);B===0?(A.next=null,y===null?id=I:y.next=I,I===null&&(xi=y)):(y=A,(c!==0||(B&3)!==0)&&(ja=!0)),A=I}Rr!==0&&Rr!==5||Ct(c),yc!==0&&(yc=0)}function tt(c,h){for(var y=c.suspendedLanes,A=c.pingedLanes,I=c.expirationTimes,B=c.pendingLanes&-62914561;0<B;){var K=31-Zs(B),pe=1<<K,je=I[K];je===-1?((pe&y)===0||(pe&A)!==0)&&(I[K]=L(pe,h)):je<=h&&(c.expiredLanes|=pe),B&=~pe}if(h=zn,y=Yn,y=T(c,c===h?y:0,c.cancelPendingCommit!==null||c.timeoutHandle!==Qs),A=c.callbackNode,y===0||c===h&&(Ai===2||Ai===9)||c.cancelPendingCommit!==null)return A!==null&&A!==null&&Jp(A),c.callbackNode=null,c.callbackPriority=0;if((y&3)===0||N(c,y)){if(h=y&-y,h===c.callbackPriority)return h;switch(A!==null&&Jp(A),Y(y)){case 2:case 8:y=B_;break;case 32:y=$f;break;case 268435456:y=Qp;break;default:y=$f}return A=it.bind(null,c),y=Zf(y,A),c.callbackPriority=h,c.callbackNode=y,h}return A!==null&&A!==null&&Jp(A),c.callbackPriority=2,c.callbackNode=null,2}function it(c,h){if(Rr!==0&&Rr!==5)return c.callbackNode=null,c.callbackPriority=0,null;var y=c.callbackNode;if(Ho()&&c.callbackNode!==y)return null;var A=Yn;return A=T(c,c===zn?A:0,c.cancelPendingCommit!==null||c.timeoutHandle!==Qs),A===0?null:(co(c,A,h),tt(c,fs()),c.callbackNode!=null&&c.callbackNode===y?it.bind(null,c):null)}function Ut(c,h){if(Ho())return null;co(c,h,!0)}function oe(){r0?s0(function(){(jn&6)!==0?Zf(Kp,Xt):an()}):Zf(Kp,Xt)}function Te(){if(yc===0){var c=Cl;c===0&&(c=Yp,Yp<<=1,(Yp&261888)===0&&(Yp=256)),yc=c}return yc}function ot(c,h){if(Sh===null){var y=Sh=[];P0=0,Cl=Te(),Fr={status:"pending",value:void 0,then:function(A){y.push(A)}}}return P0++,h.then(ue,ue),h}function ue(){if(--P0===0&&Sh!==null){Fr!==null&&(Fr.status="fulfilled");var c=Sh;Sh=null,Cl=0,Fr=null;for(var h=0;h<c.length;h++)(0,c[h])()}}function Ce(c,h){var y=[],A={status:"pending",value:null,reason:null,then:function(I){y.push(I)}};return c.then(function(){A.status="fulfilled",A.value=h;for(var I=0;I<y.length;I++)(0,y[I])(h)},function(I){for(A.status="rejected",A.reason=I,I=0;I<y.length;I++)(0,y[I])(void 0)}),A}function at(){var c=_c.current;return c!==null?c:zn.pooledCache}function gt(c,h){h===null?E(_c,_c.current):E(_c,h.pool)}function ut(){var c=at();return c===null?null:{parent:gr?Wi._currentValue:Wi._currentValue2,pool:c}}function Ye(c,h){if(yr(c,h))return!0;if(typeof c!="object"||c===null||typeof h!="object"||h===null)return!1;var y=Object.keys(c),A=Object.keys(h);if(y.length!==A.length)return!1;for(A=0;A<y.length;A++){var I=y[A];if(!$S.call(h,I)||!yr(c[I],h[I]))return!1}return!0}function pt(c){return c=c.status,c==="fulfilled"||c==="rejected"}function rn(c,h,y){switch(y=c[y],y===void 0?c.push(h):y!==h&&(h.then(Ue,Ue),h=y),h.status){case"fulfilled":return h.value;case"rejected":throw c=h.reason,Ii(c),c;default:if(typeof h.status=="string")h.then(Ue,Ue);else{if(c=zn,c!==null&&100<c.shellSuspendCounter)throw Error(r(482));c=h,c.status="pending",c.then(function(A){if(h.status==="pending"){var I=h;I.status="fulfilled",I.value=A}},function(A){if(h.status==="pending"){var I=h;I.status="rejected",I.reason=A}})}switch(h.status){case"fulfilled":return h.value;case"rejected":throw c=h.reason,Ii(c),c}throw Ps=h,kr}}function Tn(c){try{var h=c._init;return h(c._payload)}catch(y){throw y!==null&&typeof y=="object"&&typeof y.then=="function"?(Ps=y,kr):y}}function yn(){if(Ps===null)throw Error(r(459));var c=Ps;return Ps=null,c}function Ii(c){if(c===kr||c===qa)throw Error(r(483))}function Xi(c){var h=gu;return gu+=1,xc===null&&(xc=[]),rn(xc,c,h)}function As(c,h){h=h.props.ref,c.ref=h!==void 0?h:null}function fa(c,h){throw h.$$typeof===ru?Error(r(525)):(c=Object.prototype.toString.call(h),Error(r(31,c==="[object Object]"?"object with keys {"+Object.keys(h).join(", ")+"}":c)))}function Ss(c){function h(Be,we){if(c){var Ve=Be.deletions;Ve===null?(Be.deletions=[we],Be.flags|=16):Ve.push(we)}}function y(Be,we){if(!c)return null;for(;we!==null;)h(Be,we),we=we.sibling;return null}function A(Be){for(var we=new Map;Be!==null;)Be.key!==null?we.set(Be.key,Be):we.set(Be.index,Be),Be=Be.sibling;return we}function I(Be,we){return Be=va(Be,we),Be.index=0,Be.sibling=null,Be}function B(Be,we,Ve){return Be.index=Ve,c?(Ve=Be.alternate,Ve!==null?(Ve=Ve.index,Ve<we?(Be.flags|=67108866,we):Ve):(Be.flags|=67108866,we)):(Be.flags|=1048576,we)}function K(Be){return c&&Be.alternate===null&&(Be.flags|=67108866),Be}function pe(Be,we,Ve,Nt){return we===null||we.tag!==6?(we=Xg(Ve,Be.mode,Nt),we.return=Be,we):(we=I(we,Ve),we.return=Be,we)}function je(Be,we,Ve,Nt){var pn=Ve.type;return pn===au?Bt(Be,we,Ve.props.children,Nt,Ve.key):we!==null&&(we.elementType===pn||typeof pn=="object"&&pn!==null&&pn.$$typeof===Is&&Tn(pn)===we.type)?(we=I(we,Ve.props),As(we,Ve),we.return=Be,we):(we=bl(Ve.type,Ve.key,Ve.props,null,Be.mode,Nt),As(we,Ve),we.return=Be,we)}function ft(Be,we,Ve,Nt){return we===null||we.tag!==4||we.stateNode.containerInfo!==Ve.containerInfo||we.stateNode.implementation!==Ve.implementation?(we=Jg(Ve,Be.mode,Nt),we.return=Be,we):(we=I(we,Ve.children||[]),we.return=Be,we)}function Bt(Be,we,Ve,Nt,pn){return we===null||we.tag!==7?(we=Ua(Ve,Be.mode,Nt,pn),we.return=Be,we):(we=I(we,Ve),we.return=Be,we)}function Et(Be,we,Ve){if(typeof we=="string"&&we!==""||typeof we=="number"||typeof we=="bigint")return we=Xg(""+we,Be.mode,Ve),we.return=Be,we;if(typeof we=="object"&&we!==null){switch(we.$$typeof){case Go:return Ve=bl(we.type,we.key,we.props,null,Be.mode,Ve),As(Ve,we),Ve.return=Be,Ve;case su:return we=Jg(we,Be.mode,Ve),we.return=Be,we;case Is:return we=Tn(we),Et(Be,we,Ve)}if(pc(we)||g(we))return we=Ua(we,Be.mode,Ve,null),we.return=Be,we;if(typeof we.then=="function")return Et(Be,Xi(we),Ve);if(we.$$typeof===Fa)return Et(Be,q(Be,we),Ve);fa(Be,we)}return null}function Jt(Be,we,Ve,Nt){var pn=we!==null?we.key:null;if(typeof Ve=="string"&&Ve!==""||typeof Ve=="number"||typeof Ve=="bigint")return pn!==null?null:pe(Be,we,""+Ve,Nt);if(typeof Ve=="object"&&Ve!==null){switch(Ve.$$typeof){case Go:return Ve.key===pn?je(Be,we,Ve,Nt):null;case su:return Ve.key===pn?ft(Be,we,Ve,Nt):null;case Is:return Ve=Tn(Ve),Jt(Be,we,Ve,Nt)}if(pc(Ve)||g(Ve))return pn!==null?null:Bt(Be,we,Ve,Nt,null);if(typeof Ve.then=="function")return Jt(Be,we,Xi(Ve),Nt);if(Ve.$$typeof===Fa)return Jt(Be,we,q(Be,Ve),Nt);fa(Be,Ve)}return null}function Rn(Be,we,Ve,Nt,pn){if(typeof Nt=="string"&&Nt!==""||typeof Nt=="number"||typeof Nt=="bigint")return Be=Be.get(Ve)||null,pe(we,Be,""+Nt,pn);if(typeof Nt=="object"&&Nt!==null){switch(Nt.$$typeof){case Go:return Be=Be.get(Nt.key===null?Ve:Nt.key)||null,je(we,Be,Nt,pn);case su:return Be=Be.get(Nt.key===null?Ve:Nt.key)||null,ft(we,Be,Nt,pn);case Is:return Nt=Tn(Nt),Rn(Be,we,Ve,Nt,pn)}if(pc(Nt)||g(Nt))return Be=Be.get(Ve)||null,Bt(we,Be,Nt,pn,null);if(typeof Nt.then=="function")return Rn(Be,we,Ve,Xi(Nt),pn);if(Nt.$$typeof===Fa)return Rn(Be,we,Ve,q(we,Nt),pn);fa(we,Nt)}return null}function br(Be,we,Ve,Nt){for(var pn=null,er=null,mn=we,ri=we=0,Qr=null;mn!==null&&ri<Ve.length;ri++){mn.index>ri?(Qr=mn,mn=null):Qr=mn.sibling;var di=Jt(Be,mn,Ve[ri],Nt);if(di===null){mn===null&&(mn=Qr);break}c&&mn&&di.alternate===null&&h(Be,mn),we=B(di,we,ri),er===null?pn=di:er.sibling=di,er=di,mn=Qr}if(ri===Ve.length)return y(Be,mn),Xn&&Re(Be,ri),pn;if(mn===null){for(;ri<Ve.length;ri++)mn=Et(Be,Ve[ri],Nt),mn!==null&&(we=B(mn,we,ri),er===null?pn=mn:er.sibling=mn,er=mn);return Xn&&Re(Be,ri),pn}for(mn=A(mn);ri<Ve.length;ri++)Qr=Rn(mn,Be,ri,Ve[ri],Nt),Qr!==null&&(c&&Qr.alternate!==null&&mn.delete(Qr.key===null?ri:Qr.key),we=B(Qr,we,ri),er===null?pn=Qr:er.sibling=Qr,er=Qr);return c&&mn.forEach(function(Ja){return h(Be,Ja)}),Xn&&Re(Be,ri),pn}function Dh(Be,we,Ve,Nt){if(Ve==null)throw Error(r(151));for(var pn=null,er=null,mn=we,ri=we=0,Qr=null,di=Ve.next();mn!==null&&!di.done;ri++,di=Ve.next()){mn.index>ri?(Qr=mn,mn=null):Qr=mn.sibling;var Ja=Jt(Be,mn,di.value,Nt);if(Ja===null){mn===null&&(mn=Qr);break}c&&mn&&Ja.alternate===null&&h(Be,mn),we=B(Ja,we,ri),er===null?pn=Ja:er.sibling=Ja,er=Ja,mn=Qr}if(di.done)return y(Be,mn),Xn&&Re(Be,ri),pn;if(mn===null){for(;!di.done;ri++,di=Ve.next())di=Et(Be,di.value,Nt),di!==null&&(we=B(di,we,ri),er===null?pn=di:er.sibling=di,er=di);return Xn&&Re(Be,ri),pn}for(mn=A(mn);!di.done;ri++,di=Ve.next())di=Rn(mn,Be,ri,di.value,Nt),di!==null&&(c&&di.alternate!==null&&mn.delete(di.key===null?ri:di.key),we=B(di,we,ri),er===null?pn=di:er.sibling=di,er=di);return c&&mn.forEach(function(tE){return h(Be,tE)}),Xn&&Re(Be,ri),pn}function Cc(Be,we,Ve,Nt){if(typeof Ve=="object"&&Ve!==null&&Ve.type===au&&Ve.key===null&&(Ve=Ve.props.children),typeof Ve=="object"&&Ve!==null){switch(Ve.$$typeof){case Go:e:{for(var pn=Ve.key;we!==null;){if(we.key===pn){if(pn=Ve.type,pn===au){if(we.tag===7){y(Be,we.sibling),Nt=I(we,Ve.props.children),Nt.return=Be,Be=Nt;break e}}else if(we.elementType===pn||typeof pn=="object"&&pn!==null&&pn.$$typeof===Is&&Tn(pn)===we.type){y(Be,we.sibling),Nt=I(we,Ve.props),As(Nt,Ve),Nt.return=Be,Be=Nt;break e}y(Be,we);break}else h(Be,we);we=we.sibling}Ve.type===au?(Nt=Ua(Ve.props.children,Be.mode,Nt,Ve.key),Nt.return=Be,Be=Nt):(Nt=bl(Ve.type,Ve.key,Ve.props,null,Be.mode,Nt),As(Nt,Ve),Nt.return=Be,Be=Nt)}return K(Be);case su:e:{for(pn=Ve.key;we!==null;){if(we.key===pn)if(we.tag===4&&we.stateNode.containerInfo===Ve.containerInfo&&we.stateNode.implementation===Ve.implementation){y(Be,we.sibling),Nt=I(we,Ve.children||[]),Nt.return=Be,Be=Nt;break e}else{y(Be,we);break}else h(Be,we);we=we.sibling}Nt=Jg(Ve,Be.mode,Nt),Nt.return=Be,Be=Nt}return K(Be);case Is:return Ve=Tn(Ve),Cc(Be,we,Ve,Nt)}if(pc(Ve))return br(Be,we,Ve,Nt);if(g(Ve)){if(pn=g(Ve),typeof pn!="function")throw Error(r(150));return Ve=pn.call(Ve),Dh(Be,we,Ve,Nt)}if(typeof Ve.then=="function")return Cc(Be,we,Xi(Ve),Nt);if(Ve.$$typeof===Fa)return Cc(Be,we,q(Be,Ve),Nt);fa(Be,Ve)}return typeof Ve=="string"&&Ve!==""||typeof Ve=="number"||typeof Ve=="bigint"?(Ve=""+Ve,we!==null&&we.tag===6?(y(Be,we.sibling),Nt=I(we,Ve),Nt.return=Be,Be=Nt):(y(Be,we),Nt=Xg(Ve,Be.mode,Nt),Nt.return=Be,Be=Nt),K(Be)):y(Be,we)}return function(Be,we,Ve,Nt){try{gu=0;var pn=Cc(Be,we,Ve,Nt);return xc=null,pn}catch(mn){if(mn===kr||mn===qa)throw mn;var er=t(29,mn,null,Be.mode);return er.lanes=Nt,er.return=Be,er}finally{}}}function Ws(){for(var c=Jo,h=vu=Jo=0;h<c;){var y=ss[h];ss[h++]=null;var A=ss[h];ss[h++]=null;var I=ss[h];ss[h++]=null;var B=ss[h];if(ss[h++]=null,A!==null&&I!==null){var K=A.pending;K===null?I.next=I:(I.next=K.next,K.next=I),A.pending=I}B!==0&&Br(y,I,B)}}function fr(c,h,y,A){ss[Jo++]=c,ss[Jo++]=h,ss[Jo++]=y,ss[Jo++]=A,vu|=A,c.lanes|=A,c=c.alternate,c!==null&&(c.lanes|=A)}function Es(c,h,y,A){return fr(c,h,y,A),Si(c)}function sn(c,h){return fr(c,null,null,h),Si(c)}function Br(c,h,y){c.lanes|=y;var A=c.alternate;A!==null&&(A.lanes|=y);for(var I=!1,B=c.return;B!==null;)B.childLanes|=y,A=B.alternate,A!==null&&(A.childLanes|=y),B.tag===22&&(c=B.stateNode,c===null||c._visibility&1||(I=!0)),c=B,B=B.return;return c.tag===3?(B=c.stateNode,I&&h!==null&&(I=31-Zs(y),c=B.hiddenUpdates,A=c[I],A===null?c[I]=[h]:A.push(h),h.lane=y|536870912),B):null}function Si(c){if(50<hi)throw hi=0,cd=null,Error(r(185));for(var h=c.return;h!==null;)c=h,h=c.return;return c.tag===3?c.stateNode:null}function X(c){c.updateQueue={baseState:c.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function Z(c,h){c=c.updateQueue,h.updateQueue===c&&(h.updateQueue={baseState:c.baseState,firstBaseUpdate:c.firstBaseUpdate,lastBaseUpdate:c.lastBaseUpdate,shared:c.shared,callbacks:null})}function he(c){return{lane:c,tag:0,payload:null,callback:null,next:null}}function Ie(c,h,y){var A=c.updateQueue;if(A===null)return null;if(A=A.shared,(jn&2)!==0){var I=A.pending;return I===null?h.next=h:(h.next=I.next,I.next=h),A.pending=h,h=Si(c),Br(c,null,y),h}return fr(c,A,h,y),Si(c)}function He(c,h,y){if(h=h.updateQueue,h!==null&&(h=h.shared,(y&4194048)!==0)){var A=h.lanes;A&=c.pendingLanes,y|=A,h.lanes=y,R(c,y)}}function Ge(c,h){var y=c.updateQueue,A=c.alternate;if(A!==null&&(A=A.updateQueue,y===A)){var I=null,B=null;if(y=y.firstBaseUpdate,y!==null){do{var K={lane:y.lane,tag:y.tag,payload:y.payload,callback:null,next:null};B===null?I=B=K:B=B.next=K,y=y.next}while(y!==null);B===null?I=B=h:B=B.next=h}else I=B=h;y={baseState:A.baseState,firstBaseUpdate:I,lastBaseUpdate:B,shared:A.shared,callbacks:A.callbacks},c.updateQueue=y;return}c=y.lastBaseUpdate,c===null?y.firstBaseUpdate=h:c.next=h,y.lastBaseUpdate=h}function mt(){if(im){var c=Fr;if(c!==null)throw c}}function ht(c,h,y,A){im=!1;var I=c.updateQueue;xa=!1;var B=I.firstBaseUpdate,K=I.lastBaseUpdate,pe=I.shared.pending;if(pe!==null){I.shared.pending=null;var je=pe,ft=je.next;je.next=null,K===null?B=ft:K.next=ft,K=je;var Bt=c.alternate;Bt!==null&&(Bt=Bt.updateQueue,pe=Bt.lastBaseUpdate,pe!==K&&(pe===null?Bt.firstBaseUpdate=ft:pe.next=ft,Bt.lastBaseUpdate=je))}if(B!==null){var Et=I.baseState;K=0,Bt=ft=je=null,pe=B;do{var Jt=pe.lane&-536870913,Rn=Jt!==pe.lane;if(Rn?(Yn&Jt)===Jt:(A&Jt)===Jt){Jt!==0&&Jt===Cl&&(im=!0),Bt!==null&&(Bt=Bt.next={lane:0,tag:pe.tag,payload:pe.payload,callback:null,next:null});e:{var br=c,Dh=pe;Jt=h;var Cc=y;switch(Dh.tag){case 1:if(br=Dh.payload,typeof br=="function"){Et=br.call(Cc,Et,Jt);break e}Et=br;break e;case 3:br.flags=br.flags&-65537|128;case 0:if(br=Dh.payload,Jt=typeof br=="function"?br.call(Cc,Et,Jt):br,Jt==null)break e;Et=Dp({},Et,Jt);break e;case 2:xa=!0}}Jt=pe.callback,Jt!==null&&(c.flags|=64,Rn&&(c.flags|=8192),Rn=I.callbacks,Rn===null?I.callbacks=[Jt]:Rn.push(Jt))}else Rn={lane:Jt,tag:pe.tag,payload:pe.payload,callback:pe.callback,next:null},Bt===null?(ft=Bt=Rn,je=Et):Bt=Bt.next=Rn,K|=Jt;if(pe=pe.next,pe===null){if(pe=I.shared.pending,pe===null)break;Rn=pe,pe=Rn.next,Rn.next=null,I.lastBaseUpdate=Rn,I.shared.pending=null}}while(!0);Bt===null&&(je=Et),I.baseState=je,I.firstBaseUpdate=ft,I.lastBaseUpdate=Bt,B===null&&(I.shared.lanes=0),Il|=K,c.lanes=K,c.memoizedState=Et}}function Rt(c,h){if(typeof c!="function")throw Error(r(191,c));c.call(h)}function Tt(c,h){var y=c.callbacks;if(y!==null)for(c.callbacks=null,c=0;c<y.length;c++)Rt(y[c],h)}function wt(c,h){c=Qo,E(bc,c),E(yu,h),Qo=c|h.baseLanes}function Mt(){E(bc,Qo),E(yu,yu.current)}function J(){Qo=bc.current,x(yu),x(bc)}function le(c){var h=c.alternate;E(or,or.current&1),E(ea,c),ta===null&&(h===null||yu.current!==null||h.memoizedState!==null)&&(ta=c)}function ye(c){E(or,or.current),E(ea,c),ta===null&&(ta=c)}function xe(c){c.tag===22?(E(or,or.current),E(ea,c),ta===null&&(ta=c)):me()}function me(){E(or,or.current),E(ea,ea.current)}function Qe(c){x(ea),ta===c&&(ta=null),x(or)}function yt(c){for(var h=c;h!==null;){if(h.tag===13){var y=h.memoizedState;if(y!==null&&(y=y.dehydrated,y===null||gc(y)||kp(y)))return h}else if(h.tag===19&&(h.memoizedProps.revealOrder==="forwards"||h.memoizedProps.revealOrder==="backwards"||h.memoizedProps.revealOrder==="unstable_legacy-backwards"||h.memoizedProps.revealOrder==="together")){if((h.flags&128)!==0)return h}else if(h.child!==null){h.child.return=h,h=h.child;continue}if(h===c)break;for(;h.sibling===null;){if(h.return===null||h.return===c)return null;h=h.return}h.sibling.return=h.return,h=h.sibling}return null}function Ze(){throw Error(r(321))}function Pt(c,h){if(h===null)return!1;for(var y=0;y<h.length&&y<c.length;y++)if(!yr(c[y],h[y]))return!1;return!0}function It(c,h,y,A,I,B){return Rl=B,Nn=h,h.memoizedState=null,h.updateQueue=null,h.lanes=0,hn.H=c===null||c.memoizedState===null?Qi:Ko,ti=!1,B=y(A,I),ti=!1,On&&(B=At(h,y,A,I)),jt(c),B}function jt(c){hn.H=ba;var h=ln!==null&&ln.next!==null;if(Rl=0,En=ln=Nn=null,kn=!1,Xa=0,fo=null,h)throw Error(r(300));c===null||ki||(c=c.dependencies,c!==null&&Qt(c)&&(ki=!0))}function At(c,h,y,A){Nn=c;var I=0;do{if(On&&(fo=null),Xa=0,On=!1,25<=I)throw Error(r(301));if(I+=1,En=ln=null,c.updateQueue!=null){var B=c.updateQueue;B.lastEffect=null,B.events=null,B.stores=null,B.memoCache!=null&&(B.memoCache.index=0)}hn.H=Ac,B=h(y,A)}while(On);return B}function Vt(){var c=hn.H,h=c.useState()[0];return h=typeof h.then=="function"?kt(h):h,c=c.useState()[0],(ln!==null?ln.memoizedState:null)!==c&&(Nn.flags|=1024),h}function _n(){var c=ps!==0;return ps=0,c}function Kn(c,h,y){h.updateQueue=c.updateQueue,h.flags&=-2053,c.lanes&=~y}function Zt(c){if(kn){for(c=c.memoizedState;c!==null;){var h=c.queue;h!==null&&(h.pending=null),c=c.next}kn=!1}Rl=0,En=ln=Nn=null,On=!1,Xa=ps=0,fo=null}function zt(){var c={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return En===null?Nn.memoizedState=En=c:En=En.next=c,En}function St(){if(ln===null){var c=Nn.alternate;c=c!==null?c.memoizedState:null}else c=ln.next;var h=En===null?Nn.memoizedState:En.next;if(h!==null)En=h,ln=c;else{if(c===null)throw Nn.alternate===null?Error(r(467)):Error(r(310));ln=c,c={memoizedState:ln.memoizedState,baseState:ln.baseState,baseQueue:ln.baseQueue,queue:ln.queue,next:null},En===null?Nn.memoizedState=En=c:En=En.next=c}return En}function en(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function kt(c){var h=Xa;return Xa+=1,fo===null&&(fo=[]),c=rn(fo,c,h),h=Nn,(En===null?h.memoizedState:En.next)===null&&(h=h.alternate,hn.H=h===null||h.memoizedState===null?Qi:Ko),c}function Qn(c){if(c!==null&&typeof c=="object"){if(typeof c.then=="function")return kt(c);if(c.$$typeof===Fa)return ee(c)}throw Error(r(438,String(c)))}function dr(c){var h=null,y=Nn.updateQueue;if(y!==null&&(h=y.memoCache),h==null){var A=Nn.alternate;A!==null&&(A=A.updateQueue,A!==null&&(A=A.memoCache,A!=null&&(h={data:A.data.map(function(I){return I.slice()}),index:0})))}if(h==null&&(h={data:[],index:0}),y===null&&(y=en(),Nn.updateQueue=y),y.memoCache=h,y=h.data[h.index],y===void 0)for(y=h.data[h.index]=Array(c),A=0;A<c;A++)y[A]=Qg;return h.index++,y}function Ln(c,h){return typeof h=="function"?h(c):h}function Di(c){var h=St();return ui(h,ln,c)}function ui(c,h,y){var A=c.queue;if(A===null)throw Error(r(311));A.lastRenderedReducer=y;var I=c.baseQueue,B=A.pending;if(B!==null){if(I!==null){var K=I.next;I.next=B.next,B.next=K}h.baseQueue=I=B,A.pending=null}if(B=c.baseState,I===null)c.memoizedState=B;else{h=I.next;var pe=K=null,je=null,ft=h,Bt=!1;do{var Et=ft.lane&-536870913;if(Et!==ft.lane?(Yn&Et)===Et:(Rl&Et)===Et){var Jt=ft.revertLane;if(Jt===0)je!==null&&(je=je.next={lane:0,revertLane:0,gesture:null,action:ft.action,hasEagerState:ft.hasEagerState,eagerState:ft.eagerState,next:null}),Et===Cl&&(Bt=!0);else if((Rl&Jt)===Jt){ft=ft.next,Jt===Cl&&(Bt=!0);continue}else Et={lane:0,revertLane:ft.revertLane,gesture:null,action:ft.action,hasEagerState:ft.hasEagerState,eagerState:ft.eagerState,next:null},je===null?(pe=je=Et,K=B):je=je.next=Et,Nn.lanes|=Jt,Il|=Jt;Et=ft.action,ti&&y(B,Et),B=ft.hasEagerState?ft.eagerState:y(B,Et)}else Jt={lane:Et,revertLane:ft.revertLane,gesture:ft.gesture,action:ft.action,hasEagerState:ft.hasEagerState,eagerState:ft.eagerState,next:null},je===null?(pe=je=Jt,K=B):je=je.next=Jt,Nn.lanes|=Et,Il|=Et;ft=ft.next}while(ft!==null&&ft!==h);if(je===null?K=B:je.next=pe,!yr(B,c.memoizedState)&&(ki=!0,Bt&&(y=Fr,y!==null)))throw y;c.memoizedState=B,c.baseState=K,c.baseQueue=je,A.lastRenderedState=B}return I===null&&(A.lanes=0),[c.memoizedState,A.dispatch]}function Ui(c){var h=St(),y=h.queue;if(y===null)throw Error(r(311));y.lastRenderedReducer=c;var A=y.dispatch,I=y.pending,B=h.memoizedState;if(I!==null){y.pending=null;var K=I=I.next;do B=c(B,K.action),K=K.next;while(K!==I);yr(B,h.memoizedState)||(ki=!0),h.memoizedState=B,h.baseQueue===null&&(h.baseState=B),y.lastRenderedState=B}return[B,A]}function Ei(c,h,y){var A=Nn,I=St(),B=Xn;if(B){if(y===void 0)throw Error(r(407));y=y()}else y=h();var K=!yr((ln||I).memoizedState,y);if(K&&(I.memoizedState=y,ki=!0),I=I.queue,io(To.bind(null,A,I,c),[c]),I.getSnapshot!==h||K||En!==null&&En.memoizedState.tag&1){if(A.flags|=2048,Ms(9,{destroy:void 0},mr.bind(null,A,I,y,h),null),zn===null)throw Error(r(349));B||(Rl&127)!==0||pr(A,h,y)}return y}function pr(c,h,y){c.flags|=16384,c={getSnapshot:h,value:y},h=Nn.updateQueue,h===null?(h=en(),Nn.updateQueue=h,h.stores=[c]):(y=h.stores,y===null?h.stores=[c]:y.push(c))}function mr(c,h,y,A){h.value=y,h.getSnapshot=A,Ts(h)&&wf(c)}function To(c,h,y){return y(function(){Ts(h)&&wf(c)})}function Ts(c){var h=c.getSnapshot;c=c.value;try{var y=h();return!yr(c,y)}catch{return!0}}function wf(c){var h=sn(c,2);h!==null&&Ji(h,c,2)}function Mo(c){var h=zt();if(typeof c=="function"){var y=c;if(c=y(),ti){j(!0);try{y()}finally{j(!1)}}}return h.memoizedState=h.baseState=c,h.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Ln,lastRenderedState:c},h}function qc(c,h,y,A){return c.baseState=y,ui(c,ln,typeof A=="function"?A:Ln)}function no(c,h,y,A,I){if(Kc(c))throw Error(r(485));if(c=h.action,c!==null){var B={payload:I,action:c,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(K){B.listeners.push(K)}};hn.T!==null?y(!0):B.isTransition=!1,A(B),y=h.pending,y===null?(B.next=h.pending=B,Yu(h,B)):(B.next=y.next,h.pending=y.next=B)}}function Yu(c,h){var y=h.action,A=h.payload,I=c.state;if(h.isTransition){var B=hn.T,K={};hn.T=K;try{var pe=y(I,A),je=hn.S;je!==null&&je(K,pe),da(c,h,pe)}catch(ft){Ra(c,h,ft)}finally{B!==null&&K.types!==null&&(B.types=K.types),hn.T=B}}else try{B=y(I,A),da(c,h,B)}catch(ft){Ra(c,h,ft)}}function da(c,h,y){y!==null&&typeof y=="object"&&typeof y.then=="function"?y.then(function(A){hl(c,h,A)},function(A){return Ra(c,h,A)}):hl(c,h,y)}function hl(c,h,y){h.status="fulfilled",h.value=y,Kl(h),c.state=y,h=c.pending,h!==null&&(y=h.next,y===h?c.pending=null:(y=y.next,h.next=y,Yu(c,y)))}function Ra(c,h,y){var A=c.pending;if(c.pending=null,A!==null){A=A.next;do h.status="rejected",h.reason=y,Kl(h),h=h.next;while(h!==A)}c.action=null}function Kl(c){c=c.listeners;for(var h=0;h<c.length;h++)(0,c[h])()}function Xc(c,h){return h}function fl(c,h){if(Xn){var y=zn.formState;if(y!==null){e:{var A=Nn;if(Xn){if(ji){var I=u_(ji,Ns);if(I){ji=h_(I),A=g0(I);break e}}_t(A)}A=!1}A&&(h=y[0])}}y=zt(),y.memoizedState=y.baseState=h,A={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Xc,lastRenderedState:h},y.queue=A,y=Rf.bind(null,Nn,A),A.dispatch=y,A=Mo(!1);var B=Da.bind(null,Nn,!1,A.queue);return A=zt(),I={state:h,dispatch:null,action:c,pending:null},A.queue=I,y=no.bind(null,Nn,I,B,y),I.dispatch=y,A.memoizedState=c,[h,y,!1]}function Ia(c){var h=St();return pa(h,ln,c)}function pa(c,h,y){if(h=ui(c,h,Xc)[0],c=Di(Ln)[0],typeof h=="object"&&h!==null&&typeof h.then=="function")try{var A=kt(h)}catch(K){throw K===kr?qa:K}else A=h;h=St();var I=h.queue,B=I.dispatch;return y!==h.memoizedState&&(Nn.flags|=2048,Ms(9,{destroy:void 0},Yc.bind(null,I,y),null)),[A,B,c]}function Yc(c,h){c.action=h}function _i(c){var h=St(),y=ln;if(y!==null)return pa(h,y,c);St(),h=h.memoizedState,y=St();var A=y.queue.dispatch;return y.memoizedState=c,[h,A,!1]}function Ms(c,h,y,A){return c={tag:c,create:y,deps:A,inst:h,next:null},h=Nn.updateQueue,h===null&&(h=en(),Nn.updateQueue=h),y=h.lastEffect,y===null?h.lastEffect=c.next=c:(A=y.next,y.next=c,c.next=A,h.lastEffect=c),c}function Ju(){return St().memoizedState}function wo(c,h,y,A){var I=zt();Nn.flags|=c,I.memoizedState=Ms(1|h,{destroy:void 0},y,A===void 0?null:A)}function Ql(c,h,y,A){var I=St();A=A===void 0?null:A;var B=I.memoizedState.inst;ln!==null&&A!==null&&Pt(A,ln.memoizedState.deps)?I.memoizedState=Ms(h,B,y,A):(Nn.flags|=c,I.memoizedState=Ms(1|h,B,y,A))}function Zl(c,h){wo(8390656,8,c,h)}function io(c,h){Ql(2048,8,c,h)}function ro(c){Nn.flags|=4;var h=Nn.updateQueue;if(h===null)h=en(),Nn.updateQueue=h,h.events=[c];else{var y=h.events;y===null?h.events=[c]:y.push(c)}}function Wr(c){var h=St().memoizedState;return ro({ref:h,nextImpl:c}),function(){if((jn&2)!==0)throw Error(r(440));return h.impl.apply(void 0,arguments)}}function Co(c,h){return Ql(4,2,c,h)}function so(c,h){return Ql(4,4,c,h)}function dl(c,h){if(typeof h=="function"){c=c();var y=h(c);return function(){typeof y=="function"?y():h(null)}}if(h!=null)return c=c(),h.current=c,function(){h.current=null}}function Ku(c,h,y){y=y!=null?y.concat([c]):null,Ql(4,4,dl.bind(null,h,c),y)}function Ro(){}function Jc(c,h){var y=St();h=h===void 0?null:h;var A=y.memoizedState;return h!==null&&Pt(h,A[1])?A[0]:(y.memoizedState=[c,h],c)}function ao(c,h){var y=St();h=h===void 0?null:h;var A=y.memoizedState;if(h!==null&&Pt(h,A[1]))return A[0];if(A=c(),ti){j(!0);try{c()}finally{j(!1)}}return y.memoizedState=[A,h],A}function $l(c,h,y){return y===void 0||(Rl&1073741824)!==0&&(Yn&261930)===0?c.memoizedState=h:(c.memoizedState=y,c=yl(),Nn.lanes|=c,Il|=c,y)}function Qu(c,h,y,A){return yr(y,h)?y:yu.current!==null?(c=$l(c,y,A),yr(c,h)||(ki=!0),c):(Rl&42)===0||(Rl&1073741824)!==0&&(Yn&261930)===0?(ki=!0,c.memoizedState=y):(c=yl(),Nn.lanes|=c,Il|=c,h)}function ec(c,h,y,A,I){var B=ka();qn(B!==0&&8>B?B:8);var K=hn.T,pe={};hn.T=pe,Da(c,!1,h,y);try{var je=I(),ft=hn.S;if(ft!==null&&ft(pe,je),je!==null&&typeof je=="object"&&typeof je.then=="function"){var Bt=Ce(je,A);nc(c,h,Bt,Hi(c))}else nc(c,h,A,Hi(c))}catch(Et){nc(c,h,{then:function(){},status:"rejected",reason:Et},Hi())}finally{qn(B),K!==null&&pe.types!==null&&(K.types=pe.types),hn.T=K}}function Cf(c){var h=c.memoizedState;if(h!==null)return h;h={memoizedState:uu,baseState:uu,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Ln,lastRenderedState:uu},next:null};var y={};return h.next={memoizedState:y,baseState:y,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Ln,lastRenderedState:y},next:null},c.memoizedState=h,c=c.alternate,c!==null&&(c.memoizedState=h),h}function Zu(){return ee(hu)}function tc(){return St().memoizedState}function $u(){return St().memoizedState}function mp(c){for(var h=c.return;h!==null;){switch(h.tag){case 24:case 3:var y=Hi();c=he(y);var A=Ie(h,c,y);A!==null&&(Ji(A,h,y),He(A,h,y)),h={cache:Fe()},c.payload=h;return}h=h.return}}function eh(c,h,y){var A=Hi();y={lane:A,revertLane:0,gesture:null,action:y,hasEagerState:!1,eagerState:null,next:null},Kc(c)?If(h,y):(y=Es(c,h,y,A),y!==null&&(Ji(y,c,A),Df(y,h,A)))}function Rf(c,h,y){var A=Hi();nc(c,h,y,A)}function nc(c,h,y,A){var I={lane:A,revertLane:0,gesture:null,action:y,hasEagerState:!1,eagerState:null,next:null};if(Kc(c))If(h,I);else{var B=c.alternate;if(c.lanes===0&&(B===null||B.lanes===0)&&(B=h.lastRenderedReducer,B!==null))try{var K=h.lastRenderedState,pe=B(K,y);if(I.hasEagerState=!0,I.eagerState=pe,yr(pe,K))return fr(c,h,I,0),zn===null&&Ws(),!1}catch{}finally{}if(y=Es(c,h,I,A),y!==null)return Ji(y,c,A),Df(y,h,A),!0}return!1}function Da(c,h,y,A){if(A={lane:2,revertLane:Te(),gesture:null,action:A,hasEagerState:!1,eagerState:null,next:null},Kc(c)){if(h)throw Error(r(479))}else h=Es(c,y,A,2),h!==null&&Ji(h,c,2)}function Kc(c){var h=c.alternate;return c===Nn||h!==null&&h===Nn}function If(c,h){On=kn=!0;var y=c.pending;y===null?h.next=h:(h.next=y.next,y.next=h),c.pending=h}function Df(c,h,y){if((y&4194048)!==0){var A=h.lanes;A&=c.pendingLanes,y|=A,h.lanes=y,R(c,y)}}function th(c,h,y,A){h=c.memoizedState,y=y(A,h),y=y==null?h:Dp({},h,y),c.memoizedState=y,c.lanes===0&&(c.updateQueue.baseState=y)}function pl(c,h,y,A,I,B,K){return c=c.stateNode,typeof c.shouldComponentUpdate=="function"?c.shouldComponentUpdate(A,B,K):h.prototype&&h.prototype.isPureReactComponent?!Ye(y,A)||!Ye(I,B):!0}function us(c,h,y,A){c=h.state,typeof h.componentWillReceiveProps=="function"&&h.componentWillReceiveProps(y,A),typeof h.UNSAFE_componentWillReceiveProps=="function"&&h.UNSAFE_componentWillReceiveProps(y,A),h.state!==c&&rd.enqueueReplaceState(h,h.state,null)}function Io(c,h){var y=h;if("ref"in h){y={};for(var A in h)A!=="ref"&&(y[A]=h[A])}if(c=c.defaultProps){y===h&&(y=Dp({},y));for(var I in c)y[I]===void 0&&(y[I]=c[I])}return y}function Qc(c,h){try{var y=c.onUncaughtError;y(h.value,{componentStack:h.stack})}catch(A){setTimeout(function(){throw A})}}function Do(c,h,y){try{var A=c.onCaughtError;A(y.value,{componentStack:y.stack,errorBoundary:h.tag===1?h.stateNode:null})}catch(I){setTimeout(function(){throw I})}}function b(c,h,y){return y=he(y),y.tag=3,y.payload={element:null},y.callback=function(){Qc(c,h)},y}function U(c){return c=he(c),c.tag=3,c}function W(c,h,y,A){var I=y.type.getDerivedStateFromError;if(typeof I=="function"){var B=A.value;c.payload=function(){return I(B)},c.callback=function(){Do(h,y,A)}}var K=y.stateNode;K!==null&&typeof K.componentDidCatch=="function"&&(c.callback=function(){Do(h,y,A),typeof I!="function"&&(Dl===null?Dl=new Set([this]):Dl.add(this));var pe=A.stack;this.componentDidCatch(A.value,{componentStack:pe!==null?pe:""})})}function ne(c,h,y,A,I){if(y.flags|=32768,A!==null&&typeof A=="object"&&typeof A.then=="function"){if(h=y.alternate,h!==null&&vt(h,y,I,!0),y=ea.current,y!==null){switch(y.tag){case 31:case 13:return ta===null?hh():y.alternate===null&&$i===0&&($i=3),y.flags&=-257,y.flags|=65536,y.lanes=I,A===Yo?y.flags|=16384:(h=y.updateQueue,h===null?y.updateQueue=new Set([A]):h.add(A),ph(c,A,I)),!1;case 22:return y.flags|=65536,A===Yo?y.flags|=16384:(h=y.updateQueue,h===null?(h={transitions:null,markerInstances:null,retryQueue:new Set([A])},y.updateQueue=h):(y=h.retryQueue,y===null?h.retryQueue=new Set([A]):y.add(A)),ph(c,A,I)),!1}throw Error(r(435,y.tag))}return ph(c,A,I),hh(),!1}if(Xn)return h=ea.current,h!==null?((h.flags&65536)===0&&(h.flags|=256),h.flags|=65536,h.lanes=I,A!==em&&(c=Error(r(422),{cause:A}),rt(Pe(c,y)))):(A!==em&&(h=Error(r(423),{cause:A}),rt(Pe(h,y))),c=c.current.alternate,c.flags|=65536,I&=-I,c.lanes|=I,A=Pe(A,y),I=b(c.stateNode,A,I),Ge(c,I),$i!==4&&($i=2)),!1;var B=Error(r(520),{cause:A});if(B=Pe(B,y),ad===null?ad=[B]:ad.push(B),$i!==4&&($i=2),h===null)return!0;A=Pe(A,y),y=h;do{switch(y.tag){case 3:return y.flags|=65536,c=I&-I,y.lanes|=c,c=b(y.stateNode,A,c),Ge(y,c),!1;case 1:if(h=y.type,B=y.stateNode,(y.flags&128)===0&&(typeof h.getDerivedStateFromError=="function"||B!==null&&typeof B.componentDidCatch=="function"&&(Dl===null||!Dl.has(B))))return y.flags|=65536,I&=-I,y.lanes|=I,I=U(I),W(I,c,y,A),Ge(y,I),!1}y=y.return}while(y!==null);return!1}function Ee(c,h,y,A){h.child=c===null?B0(h,null,y,A):rs(h,c.child,y,A)}function ze(c,h,y,A,I){y=y.render;var B=h.ref;if("ref"in A){var K={};for(var pe in A)pe!=="ref"&&(K[pe]=A[pe])}else K=A;return bt(h),A=It(c,h,y,K,B,I),pe=_n(),c!==null&&!ki?(Kn(c,h,I),No(c,h,I)):(Xn&&pe&&ae(h),h.flags|=1,Ee(c,h,A,I),h.child)}function Ot(c,h,y,A,I){if(c===null){var B=y.type;return typeof B=="function"&&!nu(B)&&B.defaultProps===void 0&&y.compare===null?(h.tag=15,h.type=B,Cn(c,h,B,A,I)):(c=bl(y.type,null,A,h,h.mode,I),c.ref=h.ref,c.return=h,h.child=c)}if(B=c.child,!Nf(c,I)){var K=B.memoizedProps;if(y=y.compare,y=y!==null?y:Ye,y(K,A)&&c.ref===h.ref)return No(c,h,I)}return h.flags|=1,c=va(B,A),c.ref=h.ref,c.return=h,h.child=c}function Cn(c,h,y,A,I){if(c!==null){var B=c.memoizedProps;if(Ye(B,A)&&c.ref===h.ref)if(ki=!1,h.pendingProps=A=B,Nf(c,I))(c.flags&131072)!==0&&(ki=!0);else return h.lanes=c.lanes,No(c,h,I)}return ml(c,h,y,A,I)}function sr(c,h,y,A){var I=A.children,B=c!==null?c.memoizedState:null;if(c===null&&h.stateNode===null&&(h.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),A.mode==="hidden"){if((h.flags&128)!==0){if(B=B!==null?B.baseLanes|y:y,c!==null){for(A=h.child=c.child,I=0;A!==null;)I=I|A.lanes|A.childLanes,A=A.sibling;A=I&~B}else A=0,h.child=null;return Fi(c,h,B,y,A)}if((y&536870912)!==0)h.memoizedState={baseLanes:0,cachePool:null},c!==null&&gt(h,B!==null?B.cachePool:null),B!==null?wt(h,B):Mt(),xe(h);else return A=h.lanes=536870912,Fi(c,h,B!==null?B.baseLanes|y:y,y,A)}else B!==null?(gt(h,B.cachePool),wt(h,B),me(),h.memoizedState=null):(c!==null&&gt(h,null),Mt(),me());return Ee(c,h,I,y),h.child}function ei(c,h){return c!==null&&c.tag===22||h.stateNode!==null||(h.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),h.sibling}function Fi(c,h,y,A,I){var B=at();return B=B===null?null:{parent:gr?Wi._currentValue:Wi._currentValue2,pool:B},h.memoizedState={baseLanes:y,cachePool:B},c!==null&&gt(h,null),Mt(),xe(h),c!==null&&vt(c,h,A,!0),h.childLanes=I,null}function ws(c,h){return h=ic({mode:h.mode,children:h.children},c.mode),h.ref=c.ref,c.child=h,h.return=c,h}function oo(c,h,y){return rs(h,c.child,null,y),c=ws(h,h.pendingProps),c.flags|=2,Qe(h),h.memoizedState=null,c}function lo(c,h,y){var A=h.pendingProps,I=(h.flags&128)!==0;if(h.flags&=-129,c===null){if(Xn){if(A.mode==="hidden")return c=ws(h,A),h.lanes=536870912,ei(null,c);if(ye(h),(c=ji)?(c=y0(c,Ns),c!==null&&(h.memoizedState={dehydrated:c,treeContext:Ha!==null?{id:ns,overflow:uo}:null,retryLane:536870912,hydrationErrors:null},y=Yg(c),y.return=h,h.child=y,Ur=h,ji=null)):c=null,c===null)throw _t(h);return h.lanes=536870912,null}return ws(h,A)}var B=c.memoizedState;if(B!==null){var K=B.dehydrated;if(ye(h),I)if(h.flags&256)h.flags&=-257,h=oo(c,h,y);else if(h.memoizedState!==null)h.child=c.child,h.flags|=128,h=null;else throw Error(r(558));else if(ki||vt(c,h,y,!1),I=(y&c.childLanes)!==0,ki||I){if(A=zn,A!==null&&(K=P(A,y),K!==0&&K!==B.retryLane))throw B.retryLane=K,sn(c,K),Ji(A,c,K),Bs;hh(),h=oo(c,h,y)}else c=B.treeContext,Gi&&(ji=m_(K),Ur=h,Xn=!0,Xo=null,Ns=!1,c!==null&&ke(h,c)),h=ws(h,A),h.flags|=4096;return h}return c=va(c.child,{mode:A.mode,children:A.children}),c.ref=h.ref,h.child=c,c.return=h,c}function qs(c,h){var y=h.ref;if(y===null)c!==null&&c.ref!==null&&(h.flags|=4194816);else{if(typeof y!="function"&&typeof y!="object")throw Error(r(284));(c===null||c.ref!==y)&&(h.flags|=4194816)}}function ml(c,h,y,A,I){return bt(h),y=It(c,h,y,A,void 0,I),A=_n(),c!==null&&!ki?(Kn(c,h,I),No(c,h,I)):(Xn&&A&&ae(h),h.flags|=1,Ee(c,h,y,I),h.child)}function Zc(c,h,y,A,I,B){return bt(h),h.updateQueue=null,y=At(h,A,y,I),jt(c),A=_n(),c!==null&&!ki?(Kn(c,h,B),No(c,h,B)):(Xn&&A&&ae(h),h.flags|=1,Ee(c,h,y,B),h.child)}function $c(c,h,y,A,I){if(bt(h),h.stateNode===null){var B=jo,K=y.contextType;typeof K=="object"&&K!==null&&(B=ee(K)),B=new y(A,B),h.memoizedState=B.state!==null&&B.state!==void 0?B.state:null,B.updater=rd,h.stateNode=B,B._reactInternals=h,B=h.stateNode,B.props=A,B.state=h.memoizedState,B.refs={},X(h),K=y.contextType,B.context=typeof K=="object"&&K!==null?ee(K):jo,B.state=h.memoizedState,K=y.getDerivedStateFromProps,typeof K=="function"&&(th(h,y,K,A),B.state=h.memoizedState),typeof y.getDerivedStateFromProps=="function"||typeof B.getSnapshotBeforeUpdate=="function"||typeof B.UNSAFE_componentWillMount!="function"&&typeof B.componentWillMount!="function"||(K=B.state,typeof B.componentWillMount=="function"&&B.componentWillMount(),typeof B.UNSAFE_componentWillMount=="function"&&B.UNSAFE_componentWillMount(),K!==B.state&&rd.enqueueReplaceState(B,B.state,null),ht(h,A,B,I),mt(),B.state=h.memoizedState),typeof B.componentDidMount=="function"&&(h.flags|=4194308),A=!0}else if(c===null){B=h.stateNode;var pe=h.memoizedProps,je=Io(y,pe);B.props=je;var ft=B.context,Bt=y.contextType;K=jo,typeof Bt=="object"&&Bt!==null&&(K=ee(Bt));var Et=y.getDerivedStateFromProps;Bt=typeof Et=="function"||typeof B.getSnapshotBeforeUpdate=="function",pe=h.pendingProps!==pe,Bt||typeof B.UNSAFE_componentWillReceiveProps!="function"&&typeof B.componentWillReceiveProps!="function"||(pe||ft!==K)&&us(h,B,A,K),xa=!1;var Jt=h.memoizedState;B.state=Jt,ht(h,A,B,I),mt(),ft=h.memoizedState,pe||Jt!==ft||xa?(typeof Et=="function"&&(th(h,y,Et,A),ft=h.memoizedState),(je=xa||pl(h,y,je,A,Jt,ft,K))?(Bt||typeof B.UNSAFE_componentWillMount!="function"&&typeof B.componentWillMount!="function"||(typeof B.componentWillMount=="function"&&B.componentWillMount(),typeof B.UNSAFE_componentWillMount=="function"&&B.UNSAFE_componentWillMount()),typeof B.componentDidMount=="function"&&(h.flags|=4194308)):(typeof B.componentDidMount=="function"&&(h.flags|=4194308),h.memoizedProps=A,h.memoizedState=ft),B.props=A,B.state=ft,B.context=K,A=je):(typeof B.componentDidMount=="function"&&(h.flags|=4194308),A=!1)}else{B=h.stateNode,Z(c,h),K=h.memoizedProps,Bt=Io(y,K),B.props=Bt,Et=h.pendingProps,Jt=B.context,ft=y.contextType,je=jo,typeof ft=="object"&&ft!==null&&(je=ee(ft)),pe=y.getDerivedStateFromProps,(ft=typeof pe=="function"||typeof B.getSnapshotBeforeUpdate=="function")||typeof B.UNSAFE_componentWillReceiveProps!="function"&&typeof B.componentWillReceiveProps!="function"||(K!==Et||Jt!==je)&&us(h,B,A,je),xa=!1,Jt=h.memoizedState,B.state=Jt,ht(h,A,B,I),mt();var Rn=h.memoizedState;K!==Et||Jt!==Rn||xa||c!==null&&c.dependencies!==null&&Qt(c.dependencies)?(typeof pe=="function"&&(th(h,y,pe,A),Rn=h.memoizedState),(Bt=xa||pl(h,y,Bt,A,Jt,Rn,je)||c!==null&&c.dependencies!==null&&Qt(c.dependencies))?(ft||typeof B.UNSAFE_componentWillUpdate!="function"&&typeof B.componentWillUpdate!="function"||(typeof B.componentWillUpdate=="function"&&B.componentWillUpdate(A,Rn,je),typeof B.UNSAFE_componentWillUpdate=="function"&&B.UNSAFE_componentWillUpdate(A,Rn,je)),typeof B.componentDidUpdate=="function"&&(h.flags|=4),typeof B.getSnapshotBeforeUpdate=="function"&&(h.flags|=1024)):(typeof B.componentDidUpdate!="function"||K===c.memoizedProps&&Jt===c.memoizedState||(h.flags|=4),typeof B.getSnapshotBeforeUpdate!="function"||K===c.memoizedProps&&Jt===c.memoizedState||(h.flags|=1024),h.memoizedProps=A,h.memoizedState=Rn),B.props=A,B.state=Rn,B.context=je,A=Bt):(typeof B.componentDidUpdate!="function"||K===c.memoizedProps&&Jt===c.memoizedState||(h.flags|=4),typeof B.getSnapshotBeforeUpdate!="function"||K===c.memoizedProps&&Jt===c.memoizedState||(h.flags|=1024),A=!1)}return B=A,qs(c,h),A=(h.flags&128)!==0,B||A?(B=h.stateNode,y=A&&typeof y.getDerivedStateFromError!="function"?null:B.render(),h.flags|=1,c!==null&&A?(h.child=rs(h,c.child,null,I),h.child=rs(h,null,y,I)):Ee(c,h,y,I),h.memoizedState=B.state,c=h.child):c=No(c,h,I),c}function Py(c,h,y,A){return Yt(),h.flags|=256,Ee(c,h,y,A),h.child}function Pg(c){return{baseLanes:c,cachePool:ut()}}function Bg(c,h,y){return c=c!==null?c.childLanes&~y:0,h&&(c|=Ls),c}function Lg(c,h,y){var A=h.pendingProps,I=!1,B=(h.flags&128)!==0,K;if((K=B)||(K=c!==null&&c.memoizedState===null?!1:(or.current&2)!==0),K&&(I=!0,h.flags&=-129),K=(h.flags&32)!==0,h.flags&=-33,c===null){if(Xn){if(I?le(h):me(),(c=ji)?(c=__(c,Ns),c!==null&&(h.memoizedState={dehydrated:c,treeContext:Ha!==null?{id:ns,overflow:uo}:null,retryLane:536870912,hydrationErrors:null},y=Yg(c),y.return=h,h.child=y,Ur=h,ji=null)):c=null,c===null)throw _t(h);return kp(c)?h.lanes=32:h.lanes=536870912,null}var pe=A.children;return A=A.fallback,I?(me(),I=h.mode,pe=ic({mode:"hidden",children:pe},I),A=Ua(A,I,y,null),pe.return=h,A.return=h,pe.sibling=A,h.child=pe,A=h.child,A.memoizedState=Pg(y),A.childLanes=Bg(c,K,y),h.memoizedState=_u,ei(null,A)):(le(h),gp(h,pe))}var je=c.memoizedState;if(je!==null&&(pe=je.dehydrated,pe!==null)){if(B)h.flags&256?(le(h),h.flags&=-257,h=eu(c,h,y)):h.memoizedState!==null?(me(),h.child=c.child,h.flags|=128,h=null):(me(),pe=A.fallback,I=h.mode,A=ic({mode:"visible",children:A.children},I),pe=Ua(pe,I,y,null),pe.flags|=2,A.return=h,pe.return=h,A.sibling=pe,h.child=A,rs(h,c.child,null,y),A=h.child,A.memoizedState=Pg(y),A.childLanes=Bg(c,K,y),h.memoizedState=_u,h=ei(null,A));else if(le(h),kp(pe))K=zp(pe).digest,A=Error(r(419)),A.stack="",A.digest=K,rt({value:A,source:null,stack:null}),h=eu(c,h,y);else if(ki||vt(c,h,y,!1),K=(y&c.childLanes)!==0,ki||K){if(K=zn,K!==null&&(A=P(K,y),A!==0&&A!==je.retryLane))throw je.retryLane=A,sn(c,A),Ji(K,c,A),Bs;gc(pe)||hh(),h=eu(c,h,y)}else gc(pe)?(h.flags|=192,h.child=c.child,h=null):(c=je.treeContext,Gi&&(ji=g_(pe),Ur=h,Xn=!0,Xo=null,Ns=!1,c!==null&&ke(h,c)),h=gp(h,A.children),h.flags|=4096);return h}return I?(me(),pe=A.fallback,I=h.mode,je=c.child,B=je.sibling,A=va(je,{mode:"hidden",children:A.children}),A.subtreeFlags=je.subtreeFlags&65011712,B!==null?pe=va(B,pe):(pe=Ua(pe,I,y,null),pe.flags|=2),pe.return=h,A.return=h,A.sibling=pe,h.child=A,ei(null,A),A=h.child,pe=c.child.memoizedState,pe===null?pe=Pg(y):(I=pe.cachePool,I!==null?(je=gr?Wi._currentValue:Wi._currentValue2,I=I.parent!==je?{parent:je,pool:je}:I):I=ut(),pe={baseLanes:pe.baseLanes|y,cachePool:I}),A.memoizedState=pe,A.childLanes=Bg(c,K,y),h.memoizedState=_u,ei(c.child,A)):(le(h),y=c.child,c=y.sibling,y=va(y,{mode:"visible",children:A.children}),y.return=h,y.sibling=null,c!==null&&(K=h.deletions,K===null?(h.deletions=[c],h.flags|=16):K.push(c)),h.child=y,h.memoizedState=null,y)}function gp(c,h){return h=ic({mode:"visible",children:h},c.mode),h.return=c,c.child=h}function ic(c,h){return c=t(22,c,null,h),c.lanes=0,c}function eu(c,h,y){return rs(h,c.child,null,y),c=gp(h,h.pendingProps.children),c.flags|=2,h.memoizedState=null,c}function By(c,h,y){c.lanes|=h;var A=c.alternate;A!==null&&(A.lanes|=h),re(c.return,h,y)}function nh(c,h,y,A,I,B){var K=c.memoizedState;K===null?c.memoizedState={isBackwards:h,rendering:null,renderingStartTime:0,last:A,tail:y,tailMode:I,treeForkCount:B}:(K.isBackwards=h,K.rendering=null,K.renderingStartTime=0,K.last=A,K.tail=y,K.tailMode=I,K.treeForkCount=B)}function Og(c,h,y){var A=h.pendingProps,I=A.revealOrder,B=A.tail;A=A.children;var K=or.current,pe=(K&2)!==0;if(pe?(K=K&1|2,h.flags|=128):K&=1,E(or,K),Ee(c,h,A,y),A=Xn?td:0,!pe&&c!==null&&(c.flags&128)!==0)e:for(c=h.child;c!==null;){if(c.tag===13)c.memoizedState!==null&&By(c,y,h);else if(c.tag===19)By(c,y,h);else if(c.child!==null){c.child.return=c,c=c.child;continue}if(c===h)break e;for(;c.sibling===null;){if(c.return===null||c.return===h)break e;c=c.return}c.sibling.return=c.return,c=c.sibling}switch(I){case"forwards":for(y=h.child,I=null;y!==null;)c=y.alternate,c!==null&&yt(c)===null&&(I=y),y=y.sibling;y=I,y===null?(I=h.child,h.child=null):(I=y.sibling,y.sibling=null),nh(h,!1,I,y,B,A);break;case"backwards":case"unstable_legacy-backwards":for(y=null,I=h.child,h.child=null;I!==null;){if(c=I.alternate,c!==null&&yt(c)===null){h.child=I;break}c=I.sibling,I.sibling=y,y=I,I=c}nh(h,!0,y,null,B,A);break;case"together":nh(h,!1,null,null,void 0,A);break;default:h.memoizedState=null}return h.child}function No(c,h,y){if(c!==null&&(h.dependencies=c.dependencies),Il|=h.lanes,(y&h.childLanes)===0)if(c!==null){if(vt(c,h,y,!1),(y&h.childLanes)===0)return null}else return null;if(c!==null&&h.child!==c.child)throw Error(r(153));if(h.child!==null){for(c=h.child,y=va(c,c.pendingProps),h.child=y,y.return=h;c.sibling!==null;)c=c.sibling,y=y.sibling=va(c,c.pendingProps),y.return=h;y.sibling=null}return h.child}function Nf(c,h){return(c.lanes&h)!==0?!0:(c=c.dependencies,!!(c!==null&&Qt(c)))}function Ug(c,h,y){switch(h.tag){case 3:dt(h,h.stateNode.containerInfo),Je(h,Wi,c.memoizedState.cache),Yt();break;case 27:case 5:Le(h);break;case 4:dt(h,h.stateNode.containerInfo);break;case 10:Je(h,h.type,h.memoizedProps.value);break;case 31:if(h.memoizedState!==null)return h.flags|=128,ye(h),null;break;case 13:var A=h.memoizedState;if(A!==null)return A.dehydrated!==null?(le(h),h.flags|=128,null):(y&h.child.childLanes)!==0?Lg(c,h,y):(le(h),c=No(c,h,y),c!==null?c.sibling:null);le(h);break;case 19:var I=(c.flags&128)!==0;if(A=(y&h.childLanes)!==0,A||(vt(c,h,y,!1),A=(y&h.childLanes)!==0),I){if(A)return Og(c,h,y);h.flags|=128}if(I=h.memoizedState,I!==null&&(I.rendering=null,I.tail=null,I.lastEffect=null),E(or,or.current),A)break;return null;case 22:return h.lanes=0,sr(c,h,y,h.pendingProps);case 24:Je(h,Wi,c.memoizedState.cache)}return No(c,h,y)}function Fg(c,h,y){if(c!==null)if(c.memoizedProps!==h.pendingProps)ki=!0;else{if(!Nf(c,y)&&(h.flags&128)===0)return ki=!1,Ug(c,h,y);ki=(c.flags&131072)!==0}else ki=!1,Xn&&(h.flags&1048576)!==0&&$(h,td,h.index);switch(h.lanes=0,h.tag){case 16:e:{var A=h.pendingProps;if(c=Tn(h.elementType),h.type=c,typeof c=="function")nu(c)?(A=Io(c,A),h.tag=1,h=$c(null,h,c,A,y)):(h.tag=0,h=ml(null,h,c,A,y));else{if(c!=null){var I=c.$$typeof;if(I===mh){h.tag=11,h=ze(null,h,c,A,y);break e}else if(I===Pp){h.tag=14,h=Ot(null,h,c,A,y);break e}}throw h=v(c)||c,Error(r(306,h,""))}}return h;case 0:return ml(c,h,h.type,h.pendingProps,y);case 1:return A=h.type,I=Io(A,h.pendingProps),$c(c,h,A,I,y);case 3:e:{if(dt(h,h.stateNode.containerInfo),c===null)throw Error(r(387));var B=h.pendingProps;I=h.memoizedState,A=I.element,Z(c,h),ht(h,B,null,y);var K=h.memoizedState;if(B=K.cache,Je(h,Wi,B),B!==I.cache&&Lt(h,[Wi],y,!0),mt(),B=K.element,Gi&&I.isDehydrated)if(I={element:B,isDehydrated:!1,cache:K.cache},h.updateQueue.baseState=I,h.memoizedState=I,h.flags&256){h=Py(c,h,B,y);break e}else if(B!==A){A=Pe(Error(r(424)),h),rt(A),h=Py(c,h,B,y);break e}else for(Gi&&(ji=p_(h.stateNode.containerInfo),Ur=h,Xn=!0,Xo=null,Ns=!0),y=B0(h,null,B,y),h.child=y;y;)y.flags=y.flags&-3|4096,y=y.sibling;else{if(Yt(),B===A){h=No(c,h,y);break e}Ee(c,h,B,y)}h=h.child}return h;case 26:if(za)return qs(c,h),c===null?(y=S0(h.type,null,h.pendingProps,null))?h.memoizedState=y:Xn||(h.stateNode=jp(h.type,h.pendingProps,is.current,h)):h.memoizedState=S0(h.type,c.memoizedProps,h.pendingProps,c.memoizedState),null;case 27:if(Or)return Le(h),c===null&&Or&&Xn&&(A=h.stateNode=Wp(h.type,h.pendingProps,is.current,Jr.current,!1),Ur=h,Ns=!0,ji=v0(h.type,A,ji)),Ee(c,h,h.pendingProps.children,y),qs(c,h),c===null&&(h.flags|=4194304),h.child;case 5:return c===null&&Xn&&(C_(h.type,h.pendingProps,Jr.current),(I=A=ji)&&(A=v_(A,h.type,h.pendingProps,Ns),A!==null?(h.stateNode=A,Ur=h,ji=d_(A),Ns=!1,I=!0):I=!1),I||_t(h)),Le(h),I=h.type,B=h.pendingProps,K=c!==null?c.memoizedProps:null,A=B.children,Ds(I,B)?A=null:K!==null&&Ds(I,K)&&(h.flags|=32),h.memoizedState!==null&&(I=It(c,h,Vt,null,null,y),gr?hu._currentValue=I:hu._currentValue2=I),qs(c,h),Ee(c,h,A,y),h.child;case 6:return c===null&&Xn&&(A0(h.pendingProps,Jr.current),(c=y=ji)&&(y=y_(y,h.pendingProps,Ns),y!==null?(h.stateNode=y,Ur=h,ji=null,c=!0):c=!1),c||_t(h)),null;case 13:return Lg(c,h,y);case 4:return dt(h,h.stateNode.containerInfo),A=h.pendingProps,c===null?h.child=rs(h,null,A,y):Ee(c,h,A,y),h.child;case 11:return ze(c,h,h.type,h.pendingProps,y);case 7:return Ee(c,h,h.pendingProps,y),h.child;case 8:return Ee(c,h,h.pendingProps.children,y),h.child;case 12:return Ee(c,h,h.pendingProps.children,y),h.child;case 10:return A=h.pendingProps,Je(h,h.type,A.value),Ee(c,h,A.children,y),h.child;case 9:return I=h.type._context,A=h.pendingProps.children,bt(h),I=ee(I),A=A(I),h.flags|=1,Ee(c,h,A,y),h.child;case 14:return Ot(c,h,h.type,h.pendingProps,y);case 15:return Cn(c,h,h.type,h.pendingProps,y);case 19:return Og(c,h,y);case 31:return lo(c,h,y);case 22:return sr(c,h,y,h.pendingProps);case 24:return bt(h),A=ee(Wi),c===null?(I=at(),I===null&&(I=zn,B=Fe(),I.pooledCache=B,B.refCount++,B!==null&&(I.pooledCacheLanes|=y),I=B),h.memoizedState={parent:A,cache:I},X(h),Je(h,Wi,I)):((c.lanes&y)!==0&&(Z(c,h),ht(h,null,null,y),mt()),I=c.memoizedState,B=h.memoizedState,I.parent!==A?(I={parent:A,cache:A},h.memoizedState=I,h.lanes===0&&(h.memoizedState=h.updateQueue.baseState=I),Je(h,Wi,A)):(A=B.cache,Je(h,Wi,A),A!==I.cache&&Lt(h,[Wi],y,!0))),Ee(c,h,h.pendingProps.children,y),h.child;case 29:throw h.pendingProps}throw Error(r(156,h.tag))}function Na(c){c.flags|=4}function Pf(c){ya&&(c.flags|=8)}function Ly(c,h){if(c!==null&&c.child===h.child)return!1;if((h.flags&16)!==0)return!0;for(c=h.child;c!==null;){if((c.flags&8218)!==0||(c.subtreeFlags&8218)!==0)return!0;c=c.sibling}return!1}function kg(c,h,y,A){if($n)for(y=h.child;y!==null;){if(y.tag===5||y.tag===6)Xf(c,y.stateNode);else if(!(y.tag===4||Or&&y.tag===27)&&y.child!==null){y.child.return=y,y=y.child;continue}if(y===h)break;for(;y.sibling===null;){if(y.return===null||y.return===h)return;y=y.return}y.sibling.return=y.return,y=y.sibling}else if(ya)for(var I=h.child;I!==null;){if(I.tag===5){var B=I.stateNode;y&&A&&(B=c_(B,I.type,I.memoizedProps)),Xf(c,B)}else if(I.tag===6)B=I.stateNode,y&&A&&(B=m0(B,I.memoizedProps)),Xf(c,B);else if(I.tag!==4){if(I.tag===22&&I.memoizedState!==null)B=I.child,B!==null&&(B.return=I),kg(c,I,!0,!0);else if(I.child!==null){I.child.return=I,I=I.child;continue}}if(I===h)break;for(;I.sibling===null;){if(I.return===null||I.return===h)return;I=I.return}I.sibling.return=I.return,I=I.sibling}}function Oy(c,h,y,A){var I=!1;if(ya)for(var B=h.child;B!==null;){if(B.tag===5){var K=B.stateNode;y&&A&&(K=c_(K,B.type,B.memoizedProps)),d0(c,K)}else if(B.tag===6)K=B.stateNode,y&&A&&(K=m0(K,B.memoizedProps)),d0(c,K);else if(B.tag!==4){if(B.tag===22&&B.memoizedState!==null)I=B.child,I!==null&&(I.return=B),Oy(c,B,!0,!0),I=!0;else if(B.child!==null){B.child.return=B,B=B.child;continue}}if(B===h)break;for(;B.sibling===null;){if(B.return===null||B.return===h)return I;B=B.return}B.sibling.return=B.return,B=B.sibling}return I}function Uy(c,h){if(ya&&Ly(c,h)){c=h.stateNode;var y=c.containerInfo,A=f0();Oy(A,h,!1,!1),c.pendingChildren=A,Na(h),l_(y,A)}}function zg(c,h,y,A){if($n)c.memoizedProps!==A&&Na(h);else if(ya){var I=c.stateNode,B=c.memoizedProps;if((c=Ly(c,h))||B!==A){var K=Jr.current;B=o_(I,y,B,A,!c,null),B===I?h.stateNode=I:(Pf(h),Ks(B,y,A,K)&&Na(h),h.stateNode=B,c&&kg(B,h,!1,!1))}else h.stateNode=I}}function Cs(c,h,y,A,I){if((c.mode&32)!==0&&(y===null?Yf(h,A):xh(h,y,A))){if(c.flags|=16777216,(I&335544128)===I||t0(h,A))if(Ki(c.stateNode,h,A))c.flags|=8192;else if(Zn())c.flags|=8192;else throw Ps=Yo,nm}else c.flags&=-16777217}function ih(c,h){if(w0(h)){if(c.flags|=16777216,!C0(h))if(Zn())c.flags|=8192;else throw Ps=Yo,nm}else c.flags&=-16777217}function Bf(c,h){h!==null&&(c.flags|=4),c.flags&16384&&(h=c.tag!==22?F():536870912,c.lanes|=h,Rh|=h)}function rh(c,h){if(!Xn)switch(c.tailMode){case"hidden":h=c.tail;for(var y=null;h!==null;)h.alternate!==null&&(y=h),h=h.sibling;y===null?c.tail=null:y.sibling=null;break;case"collapsed":y=c.tail;for(var A=null;y!==null;)y.alternate!==null&&(A=y),y=y.sibling;A===null?h||c.tail===null?c.tail=null:c.tail.sibling=null:A.sibling=null}}function Ni(c){var h=c.alternate!==null&&c.alternate.child===c.child,y=0,A=0;if(h)for(var I=c.child;I!==null;)y|=I.lanes|I.childLanes,A|=I.subtreeFlags&65011712,A|=I.flags&65011712,I.return=c,I=I.sibling;else for(I=c.child;I!==null;)y|=I.lanes|I.childLanes,A|=I.subtreeFlags,A|=I.flags,I.return=c,I=I.sibling;return c.subtreeFlags|=A,c.childLanes=y,h}function Fy(c,h,y){var A=h.pendingProps;switch(Se(h),h.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Ni(h),null;case 1:return Ni(h),null;case 3:return y=h.stateNode,A=null,c!==null&&(A=c.memoizedState.cache),h.memoizedState.cache!==A&&(h.flags|=2048),xt(Wi),ve(),y.pendingContext&&(y.context=y.pendingContext,y.pendingContext=null),(c===null||c.child===null)&&(un(h)?Na(h):c===null||c.memoizedState.isDehydrated&&(h.flags&256)===0||(h.flags|=1024,qe())),Uy(c,h),Ni(h),null;case 26:if(za){var I=h.type,B=h.memoizedState;return c===null?(Na(h),B!==null?(Ni(h),ih(h,B)):(Ni(h),Cs(h,I,null,A,y))):B?B!==c.memoizedState?(Na(h),Ni(h),ih(h,B)):(Ni(h),h.flags&=-16777217):(B=c.memoizedProps,$n?B!==A&&Na(h):zg(c,h,I,A),Ni(h),Cs(h,I,B,A,y)),null}case 27:if(Or){if(lt(h),y=is.current,I=h.type,c!==null&&h.stateNode!=null)$n?c.memoizedProps!==A&&Na(h):zg(c,h,I,A);else{if(!A){if(h.stateNode===null)throw Error(r(166));return Ni(h),null}c=Jr.current,un(h)?Dt(h,c):(c=Wp(I,A,y,c,!0),h.stateNode=c,Na(h))}return Ni(h),null}case 5:if(lt(h),I=h.type,c!==null&&h.stateNode!=null)zg(c,h,I,A);else{if(!A){if(h.stateNode===null)throw Error(r(166));return Ni(h),null}if(B=Jr.current,un(h))Dt(h,B),T_(h.stateNode,I,A,B)&&(h.flags|=64);else{var K=$g(I,A,is.current,B,h);Pf(h),kg(K,h,!1,!1),h.stateNode=K,Ks(K,I,A,B)&&Na(h)}}return Ni(h),Cs(h,h.type,c===null?null:c.memoizedProps,h.pendingProps,y),null;case 6:if(c&&h.stateNode!=null)y=c.memoizedProps,$n?y!==A&&Na(h):ya&&(y!==A?(c=is.current,y=Jr.current,Pf(h),h.stateNode=El(A,c,y,h)):h.stateNode=c.stateNode);else{if(typeof A!="string"&&h.stateNode===null)throw Error(r(166));if(c=is.current,y=Jr.current,un(h)){if(!Gi)throw Error(r(176));if(c=h.stateNode,y=h.memoizedProps,A=null,I=Ur,I!==null)switch(I.tag){case 27:case 5:A=I.memoizedProps}KS(c,y,h,A)||_t(h,!0)}else Pf(h),h.stateNode=El(A,c,y,h)}return Ni(h),null;case 31:if(y=h.memoizedState,c===null||c.memoizedState!==null){if(A=un(h),y!==null){if(c===null){if(!A)throw Error(r(318));if(!Gi)throw Error(r(556));if(c=h.memoizedState,c=c!==null?c.dehydrated:null,!c)throw Error(r(557));_0(c,h)}else Yt(),(h.flags&128)===0&&(h.memoizedState=null),h.flags|=4;Ni(h),c=!1}else y=qe(),c!==null&&c.memoizedState!==null&&(c.memoizedState.hydrationErrors=y),c=!0;if(!c)return h.flags&256?(Qe(h),h):(Qe(h),null);if((h.flags&128)!==0)throw Error(r(558))}return Ni(h),null;case 13:if(A=h.memoizedState,c===null||c.memoizedState!==null&&c.memoizedState.dehydrated!==null){if(I=un(h),A!==null&&A.dehydrated!==null){if(c===null){if(!I)throw Error(r(318));if(!Gi)throw Error(r(344));if(I=h.memoizedState,I=I!==null?I.dehydrated:null,!I)throw Error(r(317));b_(I,h)}else Yt(),(h.flags&128)===0&&(h.memoizedState=null),h.flags|=4;Ni(h),I=!1}else I=qe(),c!==null&&c.memoizedState!==null&&(c.memoizedState.hydrationErrors=I),I=!0;if(!I)return h.flags&256?(Qe(h),h):(Qe(h),null)}return Qe(h),(h.flags&128)!==0?(h.lanes=y,h):(y=A!==null,c=c!==null&&c.memoizedState!==null,y&&(A=h.child,I=null,A.alternate!==null&&A.alternate.memoizedState!==null&&A.alternate.memoizedState.cachePool!==null&&(I=A.alternate.memoizedState.cachePool.pool),B=null,A.memoizedState!==null&&A.memoizedState.cachePool!==null&&(B=A.memoizedState.cachePool.pool),B!==I&&(A.flags|=2048)),y!==c&&y&&(h.child.flags|=8192),Bf(h,h.updateQueue),Ni(h),null);case 4:return ve(),Uy(c,h),c===null&&Ti(h.stateNode.containerInfo),Ni(h),null;case 10:return xt(h.type),Ni(h),null;case 19:if(x(or),A=h.memoizedState,A===null)return Ni(h),null;if(I=(h.flags&128)!==0,B=A.rendering,B===null)if(I)rh(A,!1);else{if($i!==0||c!==null&&(c.flags&128)!==0)for(c=h.child;c!==null;){if(B=yt(c),B!==null){for(h.flags|=128,rh(A,!1),c=B.updateQueue,h.updateQueue=c,Bf(h,c),h.subtreeFlags=0,c=y,y=h.child;y!==null;)Cp(y,c),y=y.sibling;return E(or,or.current&1|2),Xn&&Re(h,A.treeForkCount),h.child}c=c.sibling}A.tail!==null&&fs()>wc&&(h.flags|=128,I=!0,rh(A,!1),h.lanes=4194304)}else{if(!I)if(c=yt(B),c!==null){if(h.flags|=128,I=!0,c=c.updateQueue,h.updateQueue=c,Bf(h,c),rh(A,!0),A.tail===null&&A.tailMode==="hidden"&&!B.alternate&&!Xn)return Ni(h),null}else 2*fs()-A.renderingStartTime>wc&&y!==536870912&&(h.flags|=128,I=!0,rh(A,!1),h.lanes=4194304);A.isBackwards?(B.sibling=h.child,h.child=B):(c=A.last,c!==null?c.sibling=B:h.child=B,A.last=B)}return A.tail!==null?(c=A.tail,A.rendering=c,A.tail=c.sibling,A.renderingStartTime=fs(),c.sibling=null,y=or.current,E(or,I?y&1|2:y&1),Xn&&Re(h,A.treeForkCount),c):(Ni(h),null);case 22:case 23:return Qe(h),J(),A=h.memoizedState!==null,c!==null?c.memoizedState!==null!==A&&(h.flags|=8192):A&&(h.flags|=8192),A?(y&536870912)!==0&&(h.flags&128)===0&&(Ni(h),h.subtreeFlags&6&&(h.flags|=8192)):Ni(h),y=h.updateQueue,y!==null&&Bf(h,y.retryQueue),y=null,c!==null&&c.memoizedState!==null&&c.memoizedState.cachePool!==null&&(y=c.memoizedState.cachePool.pool),A=null,h.memoizedState!==null&&h.memoizedState.cachePool!==null&&(A=h.memoizedState.cachePool.pool),A!==y&&(h.flags|=2048),c!==null&&x(_c),null;case 24:return y=null,c!==null&&(y=c.memoizedState.cache),h.memoizedState.cache!==y&&(h.flags|=2048),xt(Wi),Ni(h),null;case 25:return null;case 30:return null}throw Error(r(156,h.tag))}function Vg(c,h){switch(Se(h),h.tag){case 1:return c=h.flags,c&65536?(h.flags=c&-65537|128,h):null;case 3:return xt(Wi),ve(),c=h.flags,(c&65536)!==0&&(c&128)===0?(h.flags=c&-65537|128,h):null;case 26:case 27:case 5:return lt(h),null;case 31:if(h.memoizedState!==null){if(Qe(h),h.alternate===null)throw Error(r(340));Yt()}return c=h.flags,c&65536?(h.flags=c&-65537|128,h):null;case 13:if(Qe(h),c=h.memoizedState,c!==null&&c.dehydrated!==null){if(h.alternate===null)throw Error(r(340));Yt()}return c=h.flags,c&65536?(h.flags=c&-65537|128,h):null;case 19:return x(or),null;case 4:return ve(),null;case 10:return xt(h.type),null;case 22:case 23:return Qe(h),J(),c!==null&&x(_c),c=h.flags,c&65536?(h.flags=c&-65537|128,h):null;case 24:return xt(Wi),null;case 25:return null;default:return null}}function ky(c,h){switch(Se(h),h.tag){case 3:xt(Wi),ve();break;case 26:case 27:case 5:lt(h);break;case 4:ve();break;case 31:h.memoizedState!==null&&Qe(h);break;case 13:Qe(h);break;case 19:x(or);break;case 10:xt(h.type);break;case 22:case 23:Qe(h),J(),c!==null&&x(_c);break;case 24:xt(Wi)}}function Po(c,h){try{var y=h.updateQueue,A=y!==null?y.lastEffect:null;if(A!==null){var I=A.next;y=I;do{if((y.tag&c)===c){A=void 0;var B=y.create,K=y.inst;A=B(),K.destroy=A}y=y.next}while(y!==I)}}catch(pe){bn(h,h.return,pe)}}function Bo(c,h,y){try{var A=h.updateQueue,I=A!==null?A.lastEffect:null;if(I!==null){var B=I.next;A=B;do{if((A.tag&c)===c){var K=A.inst,pe=K.destroy;if(pe!==void 0){K.destroy=void 0,I=h;var je=y,ft=pe;try{ft()}catch(Bt){bn(I,je,Bt)}}}A=A.next}while(A!==B)}}catch(Bt){bn(h,h.return,Bt)}}function sh(c){var h=c.updateQueue;if(h!==null){var y=c.stateNode;try{Tt(h,y)}catch(A){bn(c,c.return,A)}}}function vp(c,h,y){y.props=Io(c.type,c.memoizedProps),y.state=c.memoizedState;try{y.componentWillUnmount()}catch(A){bn(c,h,A)}}function ah(c,h){try{var y=c.ref;if(y!==null){switch(c.tag){case 26:case 27:case 5:var A=vh(c.stateNode);break;case 30:A=c.stateNode;break;default:A=c.stateNode}typeof y=="function"?c.refCleanup=y(A):y.current=A}}catch(I){bn(c,h,I)}}function hs(c,h){var y=c.ref,A=c.refCleanup;if(y!==null)if(typeof A=="function")try{A()}catch(I){bn(c,h,I)}finally{c.refCleanup=null,c=c.alternate,c!=null&&(c.refCleanup=null)}else if(typeof y=="function")try{y(null)}catch(I){bn(c,h,I)}else y.current=null}function tu(c){var h=c.type,y=c.memoizedProps,A=c.stateNode;try{$y(A,h,y,c)}catch(I){bn(c,c.return,I)}}function Lf(c,h,y){try{e_(c.stateNode,c.type,y,h,c)}catch(A){bn(c,c.return,A)}}function Hg(c){return c.tag===5||c.tag===3||(za?c.tag===26:!1)||(Or?c.tag===27&&fu(c.type):!1)||c.tag===4}function gl(c){e:for(;;){for(;c.sibling===null;){if(c.return===null||Hg(c.return))return null;c=c.return}for(c.sibling.return=c.return,c=c.sibling;c.tag!==5&&c.tag!==6&&c.tag!==18;){if(Or&&c.tag===27&&fu(c.type)||c.flags&2||c.child===null||c.tag===4)continue e;c.child.return=c,c=c.child}if(!(c.flags&2))return c.stateNode}}function yp(c,h,y){var A=c.tag;if(A===5||A===6)c=c.stateNode,h?n_(y,c,h):l0(y,c);else if(A!==4&&(Or&&A===27&&fu(c.type)&&(y=c.stateNode,h=null),c=c.child,c!==null))for(yp(c,h,y),c=c.sibling;c!==null;)yp(c,h,y),c=c.sibling}function Of(c,h,y){var A=c.tag;if(A===5||A===6)c=c.stateNode,h?t_(y,c,h):o0(y,c);else if(A!==4&&(Or&&A===27&&fu(c.type)&&(y=c.stateNode),c=c.child,c!==null))for(Of(c,h,y),c=c.sibling;c!==null;)Of(c,h,y),c=c.sibling}function Gg(c,h,y){c=c.containerInfo;try{p0(c,y)}catch(A){bn(h,h.return,A)}}function zy(c){var h=c.stateNode,y=c.memoizedProps;try{wr(c.type,y,h,c)}catch(A){bn(c,c.return,A)}}function qS(c,h){for(Bp(c.containerInfo),_r=h;_r!==null;)if(c=_r,h=c.child,(c.subtreeFlags&1028)!==0&&h!==null)h.return=c,_r=h;else for(;_r!==null;){c=_r;var y=c.alternate;switch(h=c.flags,c.tag){case 0:if((h&4)!==0&&(h=c.updateQueue,h=h!==null?h.events:null,h!==null))for(var A=0;A<h.length;A++){var I=h[A];I.ref.impl=I.nextImpl}break;case 11:case 15:break;case 1:if((h&1024)!==0&&y!==null){h=void 0,A=c,I=y.memoizedProps,y=y.memoizedState;var B=A.stateNode;try{var K=Io(A.type,I);h=B.getSnapshotBeforeUpdate(K,y),B.__reactInternalSnapshotBeforeUpdate=h}catch(pe){bn(A,A.return,pe)}}break;case 3:(h&1024)!==0&&$n&&h0(c.stateNode.containerInfo);break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((h&1024)!==0)throw Error(r(163))}if(h=c.sibling,h!==null){h.return=c.return,_r=h;break}_r=c.return}}function Vy(c,h,y){var A=y.flags;switch(y.tag){case 0:case 11:case 15:Rs(c,y),A&4&&Po(5,y);break;case 1:if(Rs(c,y),A&4)if(c=y.stateNode,h===null)try{c.componentDidMount()}catch(K){bn(y,y.return,K)}else{var I=Io(y.type,h.memoizedProps);h=h.memoizedState;try{c.componentDidUpdate(I,h,c.__reactInternalSnapshotBeforeUpdate)}catch(K){bn(y,y.return,K)}}A&64&&sh(y),A&512&&ah(y,y.return);break;case 3:if(Rs(c,y),A&64&&(A=y.updateQueue,A!==null)){if(c=null,y.child!==null)switch(y.child.tag){case 27:case 5:c=vh(y.child.stateNode);break;case 1:c=y.child.stateNode}try{Tt(A,c)}catch(K){bn(y,y.return,K)}}break;case 27:Or&&h===null&&A&4&&zy(y);case 26:case 5:if(Rs(c,y),h===null){if(A&4)tu(y);else if(A&64){c=y.type,h=y.memoizedProps,I=y.stateNode;try{S_(I,c,h,y)}catch(K){bn(y,y.return,K)}}}A&512&&ah(y,y.return);break;case 12:Rs(c,y);break;case 31:Rs(c,y),A&4&&Ba(c,y);break;case 13:Rs(c,y),A&4&&Ff(c,y),A&64&&(A=y.memoizedState,A!==null&&(A=A.dehydrated,A!==null&&(y=XS.bind(null,y),Vp(A,y))));break;case 22:if(A=y.memoizedState!==null||lr,!A){h=h!==null&&h.memoizedState!==null||cr,I=lr;var B=cr;lr=A,(cr=h)&&!B?Oa(c,y,(y.subtreeFlags&8772)!==0):Rs(c,y),lr=I,cr=B}break;case 30:break;default:Rs(c,y)}}function jg(c){var h=c.alternate;h!==null&&(c.alternate=null,jg(h)),c.child=null,c.deletions=null,c.sibling=null,c.tag===5&&(h=c.stateNode,h!==null&&Lp(h)),c.stateNode=null,c.return=null,c.dependencies=null,c.memoizedProps=null,c.memoizedState=null,c.pendingProps=null,c.stateNode=null,c.updateQueue=null}function Pa(c,h,y){for(y=y.child;y!==null;)Uf(c,h,y),y=y.sibling}function Uf(c,h,y){if($s&&typeof $s.onCommitFiberUnmount=="function")try{$s.onCommitFiberUnmount(mu,y)}catch{}switch(y.tag){case 26:if(za){cr||hs(y,h),Pa(c,h,y),y.memoizedState?vc(y.memoizedState):y.stateNode&&M0(y.stateNode);break}case 27:if(Or){cr||hs(y,h);var A=Zi,I=xr;fu(y.type)&&(Zi=y.stateNode,xr=!1),Pa(c,h,y),Yr(y.stateNode),Zi=A,xr=I;break}case 5:cr||hs(y,h);case 6:if($n){if(A=Zi,I=xr,Zi=null,Pa(c,h,y),Zi=A,xr=I,Zi!==null)if(xr)try{c0(Zi,y.stateNode)}catch(B){bn(y,h,B)}else try{i_(Zi,y.stateNode)}catch(B){bn(y,h,B)}}else Pa(c,h,y);break;case 18:$n&&Zi!==null&&(xr?Hp(Zi,y.stateNode):b0(Zi,y.stateNode));break;case 4:$n?(A=Zi,I=xr,Zi=y.stateNode.containerInfo,xr=!0,Pa(c,h,y),Zi=A,xr=I):(ya&&Gg(y.stateNode,y,f0()),Pa(c,h,y));break;case 0:case 11:case 14:case 15:Bo(2,y,h),cr||Bo(4,y,h),Pa(c,h,y);break;case 1:cr||(hs(y,h),A=y.stateNode,typeof A.componentWillUnmount=="function"&&vp(y,h,A)),Pa(c,h,y);break;case 21:Pa(c,h,y);break;case 22:cr=(A=cr)||y.memoizedState!==null,Pa(c,h,y),cr=A;break;default:Pa(c,h,y)}}function Ba(c,h){if(Gi&&h.memoizedState===null&&(c=h.alternate,c!==null&&(c=c.memoizedState,c!==null))){c=c.dehydrated;try{QS(c)}catch(y){bn(h,h.return,y)}}}function Ff(c,h){if(Gi&&h.memoizedState===null&&(c=h.alternate,c!==null&&(c=c.memoizedState,c!==null&&(c=c.dehydrated,c!==null))))try{ZS(c)}catch(y){bn(h,h.return,y)}}function La(c){switch(c.tag){case 31:case 13:case 19:var h=c.stateNode;return h===null&&(h=c.stateNode=new O0),h;case 22:return c=c.stateNode,h=c._retryCache,h===null&&(h=c._retryCache=new O0),h;default:throw Error(r(435,c.tag))}}function vl(c,h){var y=La(c);h.forEach(function(A){if(!y.has(A)){y.add(A);var I=YS.bind(null,c,A);A.then(I,I)}})}function qr(c,h){var y=h.deletions;if(y!==null)for(var A=0;A<y.length;A++){var I=y[A],B=c,K=h;if($n){var pe=K;e:for(;pe!==null;){switch(pe.tag){case 27:if(Or){if(fu(pe.type)){Zi=pe.stateNode,xr=!1;break e}break}case 5:Zi=pe.stateNode,xr=!1;break e;case 3:case 4:Zi=pe.stateNode.containerInfo,xr=!0;break e}pe=pe.return}if(Zi===null)throw Error(r(160));Uf(B,K,I),Zi=null,xr=!1}else Uf(B,K,I);B=I.alternate,B!==null&&(B.return=null),I.return=null}if(h.subtreeFlags&13886)for(h=h.child;h!==null;)kf(h,c),h=h.sibling}function kf(c,h){var y=c.alternate,A=c.flags;switch(c.tag){case 0:case 11:case 14:case 15:qr(h,c),Xr(c),A&4&&(Bo(3,c,c.return),Po(3,c),Bo(5,c,c.return));break;case 1:qr(h,c),Xr(c),A&512&&(cr||y===null||hs(y,y.return)),A&64&&lr&&(c=c.updateQueue,c!==null&&(A=c.callbacks,A!==null&&(y=c.shared.hiddenCallbacks,c.shared.hiddenCallbacks=y===null?A:y.concat(A))));break;case 26:if(za){var I=bi;if(qr(h,c),Xr(c),A&512&&(cr||y===null||hs(y,y.return)),A&4){A=y!==null?y.memoizedState:null;var B=c.memoizedState;y===null?B===null?c.stateNode===null?c.stateNode=R_(I,c.type,c.memoizedProps,c):T0(I,c.type,c.stateNode):c.stateNode=E0(I,B,c.memoizedProps):A!==B?(A===null?y.stateNode!==null&&M0(y.stateNode):vc(A),B===null?T0(I,c.type,c.stateNode):E0(I,B,c.memoizedProps)):B===null&&c.stateNode!==null&&Lf(c,c.memoizedProps,y.memoizedProps)}break}case 27:if(Or){qr(h,c),Xr(c),A&512&&(cr||y===null||hs(y,y.return)),y!==null&&A&4&&Lf(c,c.memoizedProps,y.memoizedProps);break}case 5:if(qr(h,c),Xr(c),A&512&&(cr||y===null||hs(y,y.return)),$n){if(c.flags&32){I=c.stateNode;try{u0(I)}catch(Et){bn(c,c.return,Et)}}A&4&&c.stateNode!=null&&(I=c.memoizedProps,Lf(c,I,y!==null?y.memoizedProps:I)),A&1024&&(Eh=!0)}else ya&&c.alternate!==null&&(c.alternate.stateNode=c.stateNode);break;case 6:if(qr(h,c),Xr(c),A&4&&$n){if(c.stateNode===null)throw Error(r(162));A=c.memoizedProps,y=y!==null?y.memoizedProps:A,I=c.stateNode;try{Zy(I,y,A)}catch(Et){bn(c,c.return,Et)}}break;case 3:if(za?(I_(),I=bi,bi=Qf(h.containerInfo),qr(h,c),bi=I):qr(h,c),Xr(c),A&4){if($n&&Gi&&y!==null&&y.memoizedState.isDehydrated)try{E_(h.containerInfo)}catch(Et){bn(c,c.return,Et)}if(ya){A=h.containerInfo,y=h.pendingChildren;try{p0(A,y)}catch(Et){bn(c,c.return,Et)}}}Eh&&(Eh=!1,_p(c));break;case 4:za?(y=bi,bi=Qf(c.stateNode.containerInfo),qr(h,c),Xr(c),bi=y):(qr(h,c),Xr(c)),A&4&&ya&&Gg(c.stateNode,c,c.stateNode.pendingChildren);break;case 12:qr(h,c),Xr(c);break;case 31:qr(h,c),Xr(c),A&4&&(A=c.updateQueue,A!==null&&(c.updateQueue=null,vl(c,A)));break;case 13:qr(h,c),Xr(c),c.child.flags&8192&&c.memoizedState!==null!=(y!==null&&y.memoizedState!==null)&&(od=fs()),A&4&&(A=c.updateQueue,A!==null&&(c.updateQueue=null,vl(c,A)));break;case 22:I=c.memoizedState!==null;var K=y!==null&&y.memoizedState!==null,pe=lr,je=cr;if(lr=pe||I,cr=je||K,qr(h,c),cr=je,lr=pe,Xr(c),A&8192&&(h=c.stateNode,h._visibility=I?h._visibility&-2:h._visibility|1,I&&(y===null||K||lr||cr||rc(c)),$n)){e:if(y=null,$n)for(h=c;;){if(h.tag===5||za&&h.tag===26){if(y===null){K=y=h;try{B=K.stateNode,I?JS(B):s_(K.stateNode,K.memoizedProps)}catch(Et){bn(K,K.return,Et)}}}else if(h.tag===6){if(y===null){K=h;try{var ft=K.stateNode;I?r_(ft):a_(ft,K.memoizedProps)}catch(Et){bn(K,K.return,Et)}}}else if(h.tag===18){if(y===null){K=h;try{var Bt=K.stateNode;I?M_(Bt):w_(K.stateNode)}catch(Et){bn(K,K.return,Et)}}}else if((h.tag!==22&&h.tag!==23||h.memoizedState===null||h===c)&&h.child!==null){h.child.return=h,h=h.child;continue}if(h===c)break e;for(;h.sibling===null;){if(h.return===null||h.return===c)break e;y===h&&(y=null),h=h.return}y===h&&(y=null),h.sibling.return=h.return,h=h.sibling}}A&4&&(A=c.updateQueue,A!==null&&(y=A.retryQueue,y!==null&&(A.retryQueue=null,vl(c,y))));break;case 19:qr(h,c),Xr(c),A&4&&(A=c.updateQueue,A!==null&&(c.updateQueue=null,vl(c,A)));break;case 30:break;case 21:break;default:qr(h,c),Xr(c)}}function Xr(c){var h=c.flags;if(h&2){try{for(var y,A=c.return;A!==null;){if(Hg(A)){y=A;break}A=A.return}if($n){if(y==null)throw Error(r(160));switch(y.tag){case 27:if(Or){var I=y.stateNode,B=gl(c);Of(c,B,I);break}case 5:var K=y.stateNode;y.flags&32&&(u0(K),y.flags&=-33);var pe=gl(c);Of(c,pe,K);break;case 3:case 4:var je=y.stateNode.containerInfo,ft=gl(c);yp(c,ft,je);break;default:throw Error(r(161))}}}catch(Bt){bn(c,c.return,Bt)}c.flags&=-3}h&4096&&(c.flags&=-4097)}function _p(c){if(c.subtreeFlags&1024)for(c=c.child;c!==null;){var h=c;_p(h),h.tag===5&&h.flags&1024&&i0(h.stateNode),c=c.sibling}}function Rs(c,h){if(h.subtreeFlags&8772)for(h=h.child;h!==null;)Vy(c,h.alternate,h),h=h.sibling}function rc(c){for(c=c.child;c!==null;){var h=c;switch(h.tag){case 0:case 11:case 14:case 15:Bo(4,h,h.return),rc(h);break;case 1:hs(h,h.return);var y=h.stateNode;typeof y.componentWillUnmount=="function"&&vp(h,h.return,y),rc(h);break;case 27:Or&&Yr(h.stateNode);case 26:case 5:hs(h,h.return),rc(h);break;case 22:h.memoizedState===null&&rc(h);break;case 30:rc(h);break;default:rc(h)}c=c.sibling}}function Oa(c,h,y){for(y=y&&(h.subtreeFlags&8772)!==0,h=h.child;h!==null;){var A=h.alternate,I=c,B=h,K=B.flags;switch(B.tag){case 0:case 11:case 15:Oa(I,B,y),Po(4,B);break;case 1:if(Oa(I,B,y),A=B,I=A.stateNode,typeof I.componentDidMount=="function")try{I.componentDidMount()}catch(ft){bn(A,A.return,ft)}if(A=B,I=A.updateQueue,I!==null){var pe=A.stateNode;try{var je=I.shared.hiddenCallbacks;if(je!==null)for(I.shared.hiddenCallbacks=null,I=0;I<je.length;I++)Rt(je[I],pe)}catch(ft){bn(A,A.return,ft)}}y&&K&64&&sh(B),ah(B,B.return);break;case 27:Or&&zy(B);case 26:case 5:Oa(I,B,y),y&&A===null&&K&4&&tu(B),ah(B,B.return);break;case 12:Oa(I,B,y);break;case 31:Oa(I,B,y),y&&K&4&&Ba(I,B);break;case 13:Oa(I,B,y),y&&K&4&&Ff(I,B);break;case 22:B.memoizedState===null&&Oa(I,B,y),ah(B,B.return);break;case 30:break;default:Oa(I,B,y)}h=h.sibling}}function sc(c,h){var y=null;c!==null&&c.memoizedState!==null&&c.memoizedState.cachePool!==null&&(y=c.memoizedState.cachePool.pool),c=null,h.memoizedState!==null&&h.memoizedState.cachePool!==null&&(c=h.memoizedState.cachePool.pool),c!==y&&(c!=null&&c.refCount++,y!=null&&Xe(y))}function Wg(c,h){c=null,h.alternate!==null&&(c=h.alternate.memoizedState.cache),h=h.memoizedState.cache,h!==c&&(h.refCount++,c!=null&&Xe(c))}function Yi(c,h,y,A){if(h.subtreeFlags&10256)for(h=h.child;h!==null;)xp(c,h,y,A),h=h.sibling}function xp(c,h,y,A){var I=h.flags;switch(h.tag){case 0:case 11:case 15:Yi(c,h,y,A),I&2048&&Po(9,h);break;case 1:Yi(c,h,y,A);break;case 3:Yi(c,h,y,A),I&2048&&(c=null,h.alternate!==null&&(c=h.alternate.memoizedState.cache),h=h.memoizedState.cache,h!==c&&(h.refCount++,c!=null&&Xe(c)));break;case 12:if(I&2048){Yi(c,h,y,A),c=h.stateNode;try{var B=h.memoizedProps,K=B.id,pe=B.onPostCommit;typeof pe=="function"&&pe(K,h.alternate===null?"mount":"update",c.passiveEffectDuration,-0)}catch(je){bn(h,h.return,je)}}else Yi(c,h,y,A);break;case 31:Yi(c,h,y,A);break;case 13:Yi(c,h,y,A);break;case 23:break;case 22:B=h.stateNode,K=h.alternate,h.memoizedState!==null?B._visibility&2?Yi(c,h,y,A):oh(c,h):B._visibility&2?Yi(c,h,y,A):(B._visibility|=2,Xs(c,h,y,A,(h.subtreeFlags&10256)!==0||!1)),I&2048&&sc(K,h);break;case 24:Yi(c,h,y,A),I&2048&&Wg(h.alternate,h);break;default:Yi(c,h,y,A)}}function Xs(c,h,y,A,I){for(I=I&&((h.subtreeFlags&10256)!==0||!1),h=h.child;h!==null;){var B=c,K=h,pe=y,je=A,ft=K.flags;switch(K.tag){case 0:case 11:case 15:Xs(B,K,pe,je,I),Po(8,K);break;case 23:break;case 22:var Bt=K.stateNode;K.memoizedState!==null?Bt._visibility&2?Xs(B,K,pe,je,I):oh(B,K):(Bt._visibility|=2,Xs(B,K,pe,je,I)),I&&ft&2048&&sc(K.alternate,K);break;case 24:Xs(B,K,pe,je,I),I&&ft&2048&&Wg(K.alternate,K);break;default:Xs(B,K,pe,je,I)}h=h.sibling}}function oh(c,h){if(h.subtreeFlags&10256)for(h=h.child;h!==null;){var y=c,A=h,I=A.flags;switch(A.tag){case 22:oh(y,A),I&2048&&sc(A.alternate,A);break;case 24:oh(y,A),I&2048&&Wg(A.alternate,A);break;default:oh(y,A)}h=h.sibling}}function Lo(c,h,y){if(c.subtreeFlags&Aa)for(c=c.child;c!==null;)ac(c,h,y),c=c.sibling}function ac(c,h,y){switch(c.tag){case 26:if(Lo(c,h,y),c.flags&Aa)if(c.memoizedState!==null)D_(y,bi,c.memoizedState,c.memoizedProps);else{var A=c.stateNode,I=c.type;c=c.memoizedProps,((h&335544128)===h||t0(I,c))&&Op(y,A,I,c)}break;case 5:Lo(c,h,y),c.flags&Aa&&(A=c.stateNode,I=c.type,c=c.memoizedProps,((h&335544128)===h||t0(I,c))&&Op(y,A,I,c));break;case 3:case 4:za?(A=bi,bi=Qf(c.stateNode.containerInfo),Lo(c,h,y),bi=A):Lo(c,h,y);break;case 22:c.memoizedState===null&&(A=c.alternate,A!==null&&A.memoizedState!==null?(A=Aa,Aa=16777216,Lo(c,h,y),Aa=A):Lo(c,h,y));break;default:Lo(c,h,y)}}function bp(c){var h=c.alternate;if(h!==null&&(c=h.child,c!==null)){h.child=null;do h=c.sibling,c.sibling=null,c=h;while(c!==null)}}function lh(c){var h=c.deletions;if((c.flags&16)!==0){if(h!==null)for(var y=0;y<h.length;y++){var A=h[y];_r=A,ma(A,c)}bp(c)}if(c.subtreeFlags&10256)for(c=c.child;c!==null;)Ap(c),c=c.sibling}function Ap(c){switch(c.tag){case 0:case 11:case 15:lh(c),c.flags&2048&&Bo(9,c,c.return);break;case 3:lh(c);break;case 12:lh(c);break;case 22:var h=c.stateNode;c.memoizedState!==null&&h._visibility&2&&(c.return===null||c.return.tag!==13)?(h._visibility&=-3,zf(c)):lh(c);break;default:lh(c)}}function zf(c){var h=c.deletions;if((c.flags&16)!==0){if(h!==null)for(var y=0;y<h.length;y++){var A=h[y];_r=A,ma(A,c)}bp(c)}for(c=c.child;c!==null;){switch(h=c,h.tag){case 0:case 11:case 15:Bo(8,h,h.return),zf(h);break;case 22:y=h.stateNode,y._visibility&2&&(y._visibility&=-3,zf(h));break;default:zf(h)}c=c.sibling}}function ma(c,h){for(;_r!==null;){var y=_r;switch(y.tag){case 0:case 11:case 15:Bo(8,y,h);break;case 23:case 22:if(y.memoizedState!==null&&y.memoizedState.cachePool!==null){var A=y.memoizedState.cachePool.pool;A!=null&&A.refCount++}break;case 24:Xe(y.memoizedState.cache)}if(A=y.child,A!==null)A.return=y,_r=A;else e:for(y=c;_r!==null;){A=_r;var I=A.sibling,B=A.return;if(jg(A),A===y){_r=null;break e}if(I!==null){I.return=B,_r=I;break e}_r=B}}}function oc(c){var h=Dn(c);if(h!=null){if(typeof h.memoizedProps["data-testname"]!="string")throw Error(r(364));return h}if(c=vr(c),c===null)throw Error(r(362));return c.stateNode.current}function lc(c,h){var y=c.tag;switch(h.$$typeof){case Ya:if(c.type===h.value)return!0;break;case Mh:e:{for(h=h.value,c=[c,0],y=0;y<c.length;){var A=c[y++],I=A.tag,B=c[y++],K=h[B];if(I!==5&&I!==26&&I!==27||!mc(A)){for(;K!=null&&lc(A,K);)B++,K=h[B];if(B===h.length){h=!0;break e}else for(A=A.child;A!==null;)c.push(A,B),A=A.sibling}}h=!1}return h;case wh:if((y===5||y===26||y===27)&&a0(c.stateNode,h.value))return!0;break;case Sc:if((y===5||y===6||y===26||y===27)&&(c=Jf(c),c!==null&&0<=c.indexOf(h.value)))return!0;break;case sd:if((y===5||y===26||y===27)&&(c=c.memoizedProps["data-testname"],typeof c=="string"&&c.toLowerCase()===h.value.toLowerCase()))return!0;break;default:throw Error(r(365))}return!1}function ch(c){switch(c.$$typeof){case Ya:return"<"+(v(c.value)||"Unknown")+">";case Mh:return":has("+(ch(c)||"")+")";case wh:return'[role="'+c.value+'"]';case Sc:return'"'+c.value+'"';case sd:return'[data-testname="'+c.value+'"]';default:throw Error(r(365))}}function uh(c,h){var y=[];c=[c,0];for(var A=0;A<c.length;){var I=c[A++],B=I.tag,K=c[A++],pe=h[K];if(B!==5&&B!==26&&B!==27||!mc(I)){for(;pe!=null&&lc(I,pe);)K++,pe=h[K];if(K===h.length)y.push(I);else for(I=I.child;I!==null;)c.push(I,K),I=I.sibling}}return y}function Ys(c,h){if(!Lr)throw Error(r(363));c=oc(c),c=uh(c,h),h=[],c=Array.from(c);for(var y=0;y<c.length;){var A=c[y++],I=A.tag;if(I===5||I===26||I===27)mc(A)||h.push(A.stateNode);else for(A=A.child;A!==null;)c.push(A),A=A.sibling}return h}function Hi(){return(jn&2)!==0&&Yn!==0?Yn&-Yn:hn.T!==null?Te():_h()}function yl(){if(Ls===0)if((Yn&536870912)===0||Xn){var c=pu;pu<<=1,(pu&3932160)===0&&(pu=262144),Ls=c}else Ls=536870912;return c=ea.current,c!==null&&(c.flags|=32),Ls}function Ji(c,h,y){(c===zn&&(Ai===2||Ai===9)||c.cancelPendingCommit!==null)&&(ar(c,0),Uo(c,Yn,Ls,!1)),k(c,y),((jn&2)===0||c!==zn)&&(c===zn&&((jn&2)===0&&(Mc|=y),$i===4&&Uo(c,Yn,Ls,!1)),Ft(c))}function co(c,h,y){if((jn&6)!==0)throw Error(r(327));var A=!y&&(h&127)===0&&(h&c.expiredLanes)===0||N(c,h),I=A?jy(c,h):Fo(c,h,!0),B=A;do{if(I===0){Ec&&!A&&Uo(c,h,0,!1);break}else{if(y=c.current.alternate,B&&!Hy(y)){I=Fo(c,h,!1),B=!1;continue}if(I===2){if(B=h,c.errorRecoveryDisabledLanes&B)var K=0;else K=c.pendingLanes&-536870913,K=K!==0?K:K&536870912?536870912:0;if(K!==0){h=K;e:{var pe=c;I=ad;var je=Gi&&pe.current.memoizedState.isDehydrated;if(je&&(ar(pe,K).flags|=256),K=Fo(pe,K,!1),K!==2){if(Tc&&!je){pe.errorRecoveryDisabledLanes|=B,Mc|=B,I=4;break e}B=na,na=I,B!==null&&(na===null?na=B:na.push.apply(na,B))}I=K}if(B=!1,I!==2)continue}}if(I===1){ar(c,0),Uo(c,h,0,!0);break}e:{switch(A=c,B=I,B){case 0:case 1:throw Error(r(345));case 4:if((h&4194048)!==h)break;case 6:Uo(A,h,Ls,!po);break e;case 2:na=null;break;case 3:case 5:break;default:throw Error(r(329))}if((h&62914560)===h&&(I=od+300-fs(),10<I)){if(Uo(A,h,Ls,!po),T(A,0,!0)!==0)break e;Zo=h,A.timeoutHandle=e0(Oo.bind(null,A,y,na,ld,rm,h,Ls,Mc,Rh,po,B,"Throttled",-0,0),I);break e}Oo(A,y,na,ld,rm,h,Ls,Mc,Rh,po,B,null,-0,0)}}break}while(!0);Ft(c)}function Oo(c,h,y,A,I,B,K,pe,je,ft,Bt,Et,Jt,Rn){if(c.timeoutHandle=Qs,Et=h.subtreeFlags,Et&8192||(Et&16785408)===16785408){Et=n0(),ac(h,B,Et);var br=(B&62914560)===B?od-fs():(B&4194048)===B?bu-fs():0;if(br=Qy(Et,br),br!==null){Zo=B,c.cancelPendingCommit=br(zo.bind(null,c,h,B,y,A,I,K,pe,je,Bt,Et,null,Jt,Rn)),Uo(c,B,K,!ft);return}}zo(c,h,B,y,A,I,K,pe,je)}function Hy(c){for(var h=c;;){var y=h.tag;if((y===0||y===11||y===15)&&h.flags&16384&&(y=h.updateQueue,y!==null&&(y=y.stores,y!==null)))for(var A=0;A<y.length;A++){var I=y[A],B=I.getSnapshot;I=I.value;try{if(!yr(B(),I))return!1}catch{return!1}}if(y=h.child,h.subtreeFlags&16384&&y!==null)y.return=h,h=y;else{if(h===c)break;for(;h.sibling===null;){if(h.return===null||h.return===c)return!0;h=h.return}h.sibling.return=h.return,h=h.sibling}}return!0}function Uo(c,h,y,A){h&=~Ch,h&=~Mc,c.suspendedLanes|=h,c.pingedLanes&=~h,A&&(c.warmLanes|=h),A=c.expirationTimes;for(var I=h;0<I;){var B=31-Zs(I),K=1<<B;A[B]=-1,I&=~K}y!==0&&D(c,y,h)}function Sp(){return(jn&6)===0?(Ct(0),!1):!0}function Ep(){if(Wn!==null){if(Ai===0)var c=Wn.return;else c=Wn,ho=Bi=null,Zt(c),xc=null,gu=0,c=Wn;for(;c!==null;)ky(c.alternate,c),c=c.return;Wn=null}}function ar(c,h){var y=c.timeoutHandle;y!==Qs&&(c.timeoutHandle=Qs,Ky(y)),y=c.cancelPendingCommit,y!==null&&(c.cancelPendingCommit=null,y()),Zo=0,Ep(),zn=c,Wn=y=va(c.current,null),Yn=h,Ai=0,Cr=null,po=!1,Ec=N(c,h),Tc=!1,Rh=Ls=Ch=Mc=Il=$i=0,na=ad=null,rm=!1,(h&8)!==0&&(h|=h&32);var A=c.entangledLanes;if(A!==0)for(c=c.entanglements,A&=h;0<A;){var I=31-Zs(A),B=1<<I;h|=c[I],A&=~B}return Qo=h,Ws(),y}function Pi(c,h){Nn=null,hn.H=ba,h===kr||h===qa?(h=yn(),Ai=3):h===nm?(h=yn(),Ai=4):Ai=h===Bs?8:h!==null&&typeof h=="object"&&typeof h.then=="function"?6:1,Cr=h,Wn===null&&($i=1,Qc(c,Pe(h,c.current)))}function Zn(){var c=ea.current;return c===null?!0:(Yn&4194048)===Yn?ta===null:(Yn&62914560)===Yn||(Yn&536870912)!==0?c===ta:!1}function _l(){var c=hn.H;return hn.H=ba,c===null?ba:c}function ga(){var c=hn.A;return hn.A=Th,c}function hh(){$i=4,po||(Yn&4194048)!==Yn&&ea.current!==null||(Ec=!0),(Il&134217727)===0&&(Mc&134217727)===0||zn===null||Uo(zn,Yn,Ls,!1)}function Fo(c,h,y){var A=jn;jn|=2;var I=_l(),B=ga();(zn!==c||Yn!==h)&&(ld=null,ar(c,h)),h=!1;var K=$i;e:do try{if(Ai!==0&&Wn!==null){var pe=Wn,je=Cr;switch(Ai){case 8:Ep(),K=6;break e;case 3:case 2:case 9:case 6:ea.current===null&&(h=!0);var ft=Ai;if(Ai=0,Cr=null,ko(c,pe,je,ft),y&&Ec){K=0;break e}break;default:ft=Ai,Ai=0,Cr=null,ko(c,pe,je,ft)}}Gy(),K=$i;break}catch(Bt){Pi(c,Bt)}while(!0);return h&&c.shellSuspendCounter++,ho=Bi=null,jn=A,hn.H=I,hn.A=B,Wn===null&&(zn=null,Yn=0,Ws()),K}function Gy(){for(;Wn!==null;)cc(Wn)}function jy(c,h){var y=jn;jn|=2;var A=_l(),I=ga();zn!==c||Yn!==h?(ld=null,wc=fs()+500,ar(c,h)):Ec=N(c,h);e:do try{if(Ai!==0&&Wn!==null){h=Wn;var B=Cr;t:switch(Ai){case 1:Ai=0,Cr=null,ko(c,h,B,1);break;case 2:case 9:if(pt(B)){Ai=0,Cr=null,Tp(h);break}h=function(){Ai!==2&&Ai!==9||zn!==c||(Ai=7),Ft(c)},B.then(h,h);break e;case 3:Ai=7;break e;case 4:Ai=5;break e;case 7:pt(B)?(Ai=0,Cr=null,Tp(h)):(Ai=0,Cr=null,ko(c,h,B,7));break;case 5:var K=null;switch(Wn.tag){case 26:K=Wn.memoizedState;case 5:case 27:var pe=Wn,je=pe.type,ft=pe.pendingProps;if(K?C0(K):Ki(pe.stateNode,je,ft)){Ai=0,Cr=null;var Bt=pe.sibling;if(Bt!==null)Wn=Bt;else{var Et=pe.return;Et!==null?(Wn=Et,dh(Et)):Wn=null}break t}}Ai=0,Cr=null,ko(c,h,B,5);break;case 6:Ai=0,Cr=null,ko(c,h,B,6);break;case 8:Ep(),$i=6;break e;default:throw Error(r(462))}}fh();break}catch(Jt){Pi(c,Jt)}while(!0);return ho=Bi=null,hn.H=A,hn.A=I,jn=y,Wn!==null?0:(zn=null,Yn=0,Ws(),$i)}function fh(){for(;Wn!==null&&!P_();)cc(Wn)}function cc(c){var h=Fg(c.alternate,c,Qo);c.memoizedProps=c.pendingProps,h===null?dh(c):Wn=h}function Tp(c){var h=c,y=h.alternate;switch(h.tag){case 15:case 0:h=Zc(y,h,h.pendingProps,h.type,void 0,Yn);break;case 11:h=Zc(y,h,h.pendingProps,h.type.render,h.ref,Yn);break;case 5:Zt(h);default:ky(y,h),h=Wn=Cp(h,Qo),h=Fg(y,h,Qo)}c.memoizedProps=c.pendingProps,h===null?dh(c):Wn=h}function ko(c,h,y,A){ho=Bi=null,Zt(h),xc=null,gu=0;var I=h.return;try{if(ne(c,I,h,y,Yn)){$i=1,Qc(c,Pe(y,c.current)),Wn=null;return}}catch(B){if(I!==null)throw Wn=I,B;$i=1,Qc(c,Pe(y,c.current)),Wn=null;return}h.flags&32768?(Xn||A===1?c=!0:Ec||(Yn&536870912)!==0?c=!1:(po=c=!0,(A===2||A===9||A===3||A===6)&&(A=ea.current,A!==null&&A.tag===13&&(A.flags|=16384))),uc(h,c)):dh(h)}function dh(c){var h=c;do{if((h.flags&32768)!==0){uc(h,po);return}c=h.return;var y=Fy(h.alternate,h,Qo);if(y!==null){Wn=y;return}if(h=h.sibling,h!==null){Wn=h;return}Wn=h=c}while(h!==null);$i===0&&($i=5)}function uc(c,h){do{var y=Vg(c.alternate,c);if(y!==null){y.flags&=32767,Wn=y;return}if(y=c.return,y!==null&&(y.flags|=32768,y.subtreeFlags=0,y.deletions=null),!h&&(c=c.sibling,c!==null)){Wn=c;return}Wn=c=y}while(c!==null);$i=6,Wn=null}function zo(c,h,y,A,I,B,K,pe,je){c.cancelPendingCommit=null;do Ho();while(Rr!==0);if((jn&6)!==0)throw Error(r(327));if(h!==null){if(h===c.current)throw Error(r(177));if(B=h.lanes|h.childLanes,B|=vu,O(c,y,B,K,pe,je),c===zn&&(Wn=zn=null,Yn=0),Au=h,Nl=c,Zo=y,Ih=B,sm=I,U0=A,(h.subtreeFlags&10256)!==0||(h.flags&10256)!==0?(c.callbackNode=null,c.callbackPriority=0,Mr($f,function(){return Vf(),null})):(c.callbackNode=null,c.callbackPriority=0),A=(h.flags&13878)!==0,(h.subtreeFlags&13878)!==0||A){A=hn.T,hn.T=null,I=ka(),qn(2),K=jn,jn|=4;try{qS(c,h,y)}finally{jn=K,qn(I),hn.T=A}}Rr=1,xl(),Vo(),Mp()}}function xl(){if(Rr===1){Rr=0;var c=Nl,h=Au,y=(h.flags&13878)!==0;if((h.subtreeFlags&13878)!==0||y){y=hn.T,hn.T=null;var A=ka();qn(2);var I=jn;jn|=4;try{kf(h,c),Jy(c.containerInfo)}finally{jn=I,qn(A),hn.T=y}}c.current=h,Rr=2}}function Vo(){if(Rr===2){Rr=0;var c=Nl,h=Au,y=(h.flags&8772)!==0;if((h.subtreeFlags&8772)!==0||y){y=hn.T,hn.T=null;var A=ka();qn(2);var I=jn;jn|=4;try{Vy(c,h.alternate,h)}finally{jn=I,qn(A),hn.T=y}}Rr=3}}function Mp(){if(Rr===4||Rr===3){Rr=0,I0();var c=Nl,h=Au,y=Zo,A=U0;(h.subtreeFlags&10256)!==0||(h.flags&10256)!==0?Rr=5:(Rr=0,Au=Nl=null,wp(c,c.pendingLanes));var I=c.pendingLanes;if(I===0&&(Dl=null),Y(y),h=h.stateNode,$s&&typeof $s.onCommitFiberRoot=="function")try{$s.onCommitFiberRoot(mu,h,void 0,(h.current.flags&128)===128)}catch{}if(A!==null){h=hn.T,I=ka(),qn(2),hn.T=null;try{for(var B=c.onRecoverableError,K=0;K<A.length;K++){var pe=A[K];B(pe.value,{componentStack:pe.stack})}}finally{hn.T=h,qn(I)}}(Zo&3)!==0&&Ho(),Ft(c),I=c.pendingLanes,(y&261930)!==0&&(I&42)!==0?c===cd?hi++:(hi=0,cd=c):hi=0,Gi&&Kf(),Ct(0)}}function wp(c,h){(c.pooledCacheLanes&=h)===0&&(h=c.pooledCache,h!=null&&(c.pooledCache=null,Xe(h)))}function Ho(){return xl(),Vo(),Mp(),Vf()}function Vf(){if(Rr!==5)return!1;var c=Nl,h=Ih;Ih=0;var y=Y(Zo),A=32>y?32:y;y=hn.T;var I=ka();try{qn(A),hn.T=null,A=sm,sm=null;var B=Nl,K=Zo;if(Rr=0,Au=Nl=null,Zo=0,(jn&6)!==0)throw Error(r(331));var pe=jn;if(jn|=4,Ap(B.current),xp(B,B.current,K,A),jn=pe,Ct(0,!1),$s&&typeof $s.onPostCommitFiberRoot=="function")try{$s.onPostCommitFiberRoot(mu,B)}catch{}return!0}finally{qn(I),hn.T=y,wp(c,h)}}function hc(c,h,y){h=Pe(y,h),h=b(c.stateNode,h,2),c=Ie(c,h,2),c!==null&&(k(c,2),Ft(c))}function bn(c,h,y){if(c.tag===3)hc(c,c,y);else for(;h!==null;){if(h.tag===3){hc(h,c,y);break}else if(h.tag===1){var A=h.stateNode;if(typeof h.type.getDerivedStateFromError=="function"||typeof A.componentDidCatch=="function"&&(Dl===null||!Dl.has(A))){c=Pe(y,c),y=U(2),A=Ie(h,y,2),A!==null&&(W(y,A,h,c),k(A,2),Ft(A));break}}h=h.return}}function ph(c,h,y){var A=c.pingCache;if(A===null){A=c.pingCache=new Sa;var I=new Set;A.set(h,I)}else I=A.get(h),I===void 0&&(I=new Set,A.set(h,I));I.has(y)||(Tc=!0,I.add(y),c=Wy.bind(null,c,h,y),h.then(c,c))}function Wy(c,h,y){var A=c.pingCache;A!==null&&A.delete(h),c.pingedLanes|=c.suspendedLanes&y,c.warmLanes&=~y,zn===c&&(Yn&y)===y&&($i===4||$i===3&&(Yn&62914560)===Yn&&300>fs()-od?(jn&2)===0&&ar(c,0):Ch|=y,Rh===Yn&&(Rh=0)),Ft(c)}function qy(c,h){h===0&&(h=F()),c=sn(c,h),c!==null&&(k(c,h),Ft(c))}function XS(c){var h=c.memoizedState,y=0;h!==null&&(y=h.retryLane),qy(c,y)}function YS(c,h){var y=0;switch(c.tag){case 31:case 13:var A=c.stateNode,I=c.memoizedState;I!==null&&(y=I.retryLane);break;case 19:A=c.stateNode;break;case 22:A=c.stateNode._retryCache;break;default:throw Error(r(314))}A!==null&&A.delete(h),qy(c,y)}function Mr(c,h){return Zf(c,h)}function qg(c,h,y,A){this.tag=c,this.key=y,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=h,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=A,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function nu(c){return c=c.prototype,!(!c||!c.isReactComponent)}function va(c,h){var y=c.alternate;return y===null?(y=t(c.tag,h,c.key,c.mode),y.elementType=c.elementType,y.type=c.type,y.stateNode=c.stateNode,y.alternate=c,c.alternate=y):(y.pendingProps=h,y.type=c.type,y.flags=0,y.subtreeFlags=0,y.deletions=null),y.flags=c.flags&65011712,y.childLanes=c.childLanes,y.lanes=c.lanes,y.child=c.child,y.memoizedProps=c.memoizedProps,y.memoizedState=c.memoizedState,y.updateQueue=c.updateQueue,h=c.dependencies,y.dependencies=h===null?null:{lanes:h.lanes,firstContext:h.firstContext},y.sibling=c.sibling,y.index=c.index,y.ref=c.ref,y.refCleanup=c.refCleanup,y}function Cp(c,h){c.flags&=65011714;var y=c.alternate;return y===null?(c.childLanes=0,c.lanes=h,c.child=null,c.subtreeFlags=0,c.memoizedProps=null,c.memoizedState=null,c.updateQueue=null,c.dependencies=null,c.stateNode=null):(c.childLanes=y.childLanes,c.lanes=y.lanes,c.child=y.child,c.subtreeFlags=0,c.deletions=null,c.memoizedProps=y.memoizedProps,c.memoizedState=y.memoizedState,c.updateQueue=y.updateQueue,c.type=y.type,h=y.dependencies,c.dependencies=h===null?null:{lanes:h.lanes,firstContext:h.firstContext}),c}function bl(c,h,y,A,I,B){var K=0;if(A=c,typeof c=="function")nu(c)&&(K=1);else if(typeof c=="string")K=za&&Or?Gp(c,y,Jr.current)?26:R0(c)?27:5:za?Gp(c,y,Jr.current)?26:5:Or&&R0(c)?27:5;else e:switch(c){case Wf:return c=t(31,y,h,I),c.elementType=Wf,c.lanes=B,c;case au:return Ua(y.children,I,B,h);case ou:K=8,I|=24;break;case lu:return c=t(12,y,h,I|2),c.elementType=lu,c.lanes=B,c;case Np:return c=t(13,y,h,I),c.elementType=Np,c.lanes=B,c;case Al:return c=t(19,y,h,I),c.elementType=Al,c.lanes=B,c;default:if(typeof c=="object"&&c!==null)switch(c.$$typeof){case Fa:K=10;break e;case jf:K=9;break e;case mh:K=11;break e;case Pp:K=14;break e;case Is:K=16,A=null;break e}K=29,y=Error(r(130,c===null?"null":typeof c,"")),A=null}return h=t(K,y,h,I),h.elementType=c,h.type=A,h.lanes=B,h}function Ua(c,h,y,A){return c=t(7,c,A,h),c.lanes=y,c}function Xg(c,h,y){return c=t(6,c,null,h),c.lanes=y,c}function Yg(c){var h=t(18,null,null,0);return h.stateNode=c,h}function Jg(c,h,y){return h=t(4,c.children!==null?c.children:[],c.key,h),h.lanes=y,h.stateNode={containerInfo:c.containerInfo,pendingChildren:null,implementation:c.implementation},h}function Xy(c,h,y,A,I,B,K,pe,je){this.tag=1,this.containerInfo=c,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=Qs,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=G(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=G(0),this.hiddenUpdates=G(null),this.identifierPrefix=A,this.onUncaughtError=I,this.onCaughtError=B,this.onRecoverableError=K,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=je,this.incompleteTransitions=new Map}function fc(c,h,y,A,I,B,K,pe,je,ft,Bt,Et){return c=new Xy(c,h,y,K,je,ft,Bt,Et,pe),h=1,B===!0&&(h|=24),B=t(3,null,null,h),c.current=B,B.stateNode=c,h=Fe(),h.refCount++,c.pooledCache=h,h.refCount++,B.memoizedState={element:A,isDehydrated:y,cache:h},X(B),c}function Rp(c){return c?(c=jo,c):jo}function Hf(c){var h=c._reactInternals;if(h===void 0)throw typeof c.render=="function"?Error(r(188)):(c=Object.keys(c).join(","),Error(r(268,c)));return c=u(h),c=c!==null?f(c):null,c===null?null:vh(c.stateNode)}function Kg(c,h,y,A,I,B){I=Rp(I),A.context===null?A.context=I:A.pendingContext=I,A=he(h),A.payload={element:y},B=B===void 0?null:B,B!==null&&(A.callback=B),y=Ie(c,A,h),y!==null&&(Ji(y,c,h),He(y,c,h))}function iu(c,h){if(c=c.memoizedState,c!==null&&c.dehydrated!==null){var y=c.retryLane;c.retryLane=y!==0&&y<h?y:h}}function Gf(c,h){iu(c,h),(c=c.alternate)&&iu(c,h)}var Fn={},Ip=OA,Js=TX,Dp=Object.assign,ru=Symbol.for("react.element"),Go=Symbol.for("react.transitional.element"),su=Symbol.for("react.portal"),au=Symbol.for("react.fragment"),ou=Symbol.for("react.strict_mode"),lu=Symbol.for("react.profiler"),jf=Symbol.for("react.consumer"),Fa=Symbol.for("react.context"),mh=Symbol.for("react.forward_ref"),Np=Symbol.for("react.suspense"),Al=Symbol.for("react.suspense_list"),Pp=Symbol.for("react.memo"),Is=Symbol.for("react.lazy"),Wf=Symbol.for("react.activity"),Qg=Symbol.for("react.memo_cache_sentinel"),Sl=Symbol.iterator,dc=Symbol.for("react.client.reference"),pc=Array.isArray,hn=Ip.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,Zg=e.rendererVersion,qf=e.rendererPackageName,gh=e.extraDevToolsConfig,vh=e.getPublicInstance,Yy=e.getRootHostContext,yh=e.getChildHostContext,Bp=e.prepareForCommit,Jy=e.resetAfterCommit,$g=e.createInstance;e.cloneMutableInstance;var Xf=e.appendInitialChild,Ks=e.finalizeInitialChildren,Ds=e.shouldSetTextContent,El=e.createTextInstance;e.cloneMutableTextInstance;var e0=e.scheduleTimeout,Ky=e.cancelTimeout,Qs=e.noTimeout,gr=e.isPrimaryRenderer;e.warnsIfNotActing;var $n=e.supportsMutation,ya=e.supportsPersistence,Gi=e.supportsHydration,Dn=e.getInstanceFromNode;e.beforeActiveInstanceBlur;var Ti=e.preparePortalMount;e.prepareScopeUpdate,e.getInstanceFromScope;var qn=e.setCurrentUpdatePriority,ka=e.getCurrentUpdatePriority,_h=e.resolveUpdatePriority;e.trackSchedulerEvent,e.resolveEventType,e.resolveEventTimeStamp;var cu=e.shouldAttemptEagerTransition,Lp=e.detachDeletedInstance;e.requestPostPaintCallback;var Yf=e.maySuspendCommit,xh=e.maySuspendCommitOnUpdate,t0=e.maySuspendCommitInSyncRender,Ki=e.preloadInstance,n0=e.startSuspendingCommit,Op=e.suspendInstance;e.suspendOnActiveViewTransition;var Qy=e.waitForCommitToBeReady;e.getSuspendedCommitReason;var uu=e.NotPendingTransition,hu=e.HostTransitionContext,i0=e.resetFormInstance;e.bindToConsole;var r0=e.supportsMicrotasks,s0=e.scheduleMicrotask,Lr=e.supportsTestSelectors,vr=e.findFiberRoot,Up=e.getBoundingRect,Jf=e.getTextContent,mc=e.isHiddenSubtree,a0=e.matchAccessibilityRole,Tl=e.setFocusIfFocusable,Fp=e.setupIntersectionObserver,o0=e.appendChild,l0=e.appendChildToContainer,Zy=e.commitTextUpdate,$y=e.commitMount,e_=e.commitUpdate,t_=e.insertBefore,n_=e.insertInContainerBefore,i_=e.removeChild,c0=e.removeChildFromContainer,u0=e.resetTextContent,JS=e.hideInstance,r_=e.hideTextInstance,s_=e.unhideInstance,a_=e.unhideTextInstance;e.cancelViewTransitionName,e.cancelRootViewTransitionName,e.restoreRootViewTransitionName,e.cloneRootViewTransitionContainer,e.removeRootViewTransitionClone,e.measureClonedInstance,e.hasInstanceChanged,e.hasInstanceAffectedParent,e.startViewTransition,e.startGestureTransition,e.stopViewTransition,e.getCurrentGestureOffset,e.createViewTransitionInstance;var h0=e.clearContainer;e.createFragmentInstance,e.updateFragmentInstanceFiber,e.commitNewChildToFragmentInstance,e.deleteChildFromFragmentInstance;var o_=e.cloneInstance,f0=e.createContainerChildSet,d0=e.appendChildToContainerChildSet,l_=e.finalizeContainerChildren,p0=e.replaceContainerChildren,c_=e.cloneHiddenInstance,m0=e.cloneHiddenTextInstance,gc=e.isSuspenseInstancePending,kp=e.isSuspenseInstanceFallback,zp=e.getSuspenseInstanceFallbackErrorDetails,Vp=e.registerSuspenseInstanceRetry,u_=e.canHydrateFormStateMarker,g0=e.isFormStateMarkerMatching,h_=e.getNextHydratableSibling,f_=e.getNextHydratableSiblingAfterSingleton,d_=e.getFirstHydratableChild,p_=e.getFirstHydratableChildWithinContainer,m_=e.getFirstHydratableChildWithinActivityInstance,g_=e.getFirstHydratableChildWithinSuspenseInstance,v0=e.getFirstHydratableChildWithinSingleton,v_=e.canHydrateInstance,y_=e.canHydrateTextInstance,y0=e.canHydrateActivityInstance,__=e.canHydrateSuspenseInstance,x_=e.hydrateInstance,KS=e.hydrateTextInstance,_0=e.hydrateActivityInstance,b_=e.hydrateSuspenseInstance,A_=e.getNextHydratableInstanceAfterActivityInstance,x0=e.getNextHydratableInstanceAfterSuspenseInstance,S_=e.commitHydratedInstance,E_=e.commitHydratedContainer,QS=e.commitHydratedActivityInstance,ZS=e.commitHydratedSuspenseInstance,T_=e.finalizeHydratedChildren,Kf=e.flushHydrationEvents;e.clearActivityBoundary;var b0=e.clearSuspenseBoundary;e.clearActivityBoundaryFromContainer;var Hp=e.clearSuspenseBoundaryFromContainer,M_=e.hideDehydratedBoundary,w_=e.unhideDehydratedBoundary,bh=e.shouldDeleteUnhydratedTailInstances;e.diffHydratedPropsForDevWarnings,e.diffHydratedTextForDevWarnings,e.describeHydratableInstanceForDevWarnings;var C_=e.validateHydratableInstance,A0=e.validateHydratableTextInstance,za=e.supportsResources,Gp=e.isHostHoistableType,Qf=e.getHoistableRoot,S0=e.getResource,E0=e.acquireResource,vc=e.releaseResource,R_=e.hydrateHoistable,T0=e.mountHoistable,M0=e.unmountHoistable,jp=e.createHoistableInstance,I_=e.prepareToCommitHoistables,w0=e.mayResourceSuspendCommit,C0=e.preloadResource,D_=e.suspendResource,Or=e.supportsSingletons,Wp=e.resolveSingletonInstance,wr=e.acquireSingletonInstance,Yr=e.releaseSingletonInstance,R0=e.isHostSingletonType,fu=e.isSingletonScope,qp=[],du=-1,jo={},Zs=Math.clz32?Math.clz32:C,Xp=Math.log,N_=Math.LN2,Yp=256,pu=262144,Ah=4194304,Zf=Js.unstable_scheduleCallback,Jp=Js.unstable_cancelCallback,P_=Js.unstable_shouldYield,I0=Js.unstable_requestPaint,fs=Js.unstable_now,Kp=Js.unstable_ImmediatePriority,B_=Js.unstable_UserBlockingPriority,$f=Js.unstable_NormalPriority,Qp=Js.unstable_IdlePriority,D0=Js.log,L_=Js.unstable_setDisableYieldValue,mu=null,$s=null,yr=typeof Object.is=="function"?Object.is:ce,Zp=typeof reportError=="function"?reportError:function(c){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var h=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof c=="object"&&c!==null&&typeof c.message=="string"?String(c.message):String(c),error:c});if(!window.dispatchEvent(h))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",c);return}console.error(c)},$S=Object.prototype.hasOwnProperty,$p,Wo,ed=!1,N0=new WeakMap,Ml=[],qo=0,Mi=null,td=0,Va=[],_a=0,Ha=null,ns=1,uo="",Jr=_(null),wl=_(null),is=_(null),nd=_(null),Ur=null,ji=null,Xn=!1,Xo=null,Ns=!1,em=Error(r(519)),Ga=_(null),Bi=null,ho=null,O_=typeof AbortController<"u"?AbortController:function(){var c=[],h=this.signal={aborted:!1,addEventListener:function(y,A){c.push(A)}};this.abort=function(){h.aborted=!0,c.forEach(function(y){return y()})}},Kr=Js.unstable_scheduleCallback,eE=Js.unstable_NormalPriority,Wi={$$typeof:Fa,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0},id=null,xi=null,ds=!1,ja=!1,tm=!1,yc=0,Sh=null,P0=0,Cl=0,Fr=null,Wa=hn.S;hn.S=function(c,h){bu=fs(),typeof h=="object"&&h!==null&&typeof h.then=="function"&&ot(c,h),Wa!==null&&Wa(c,h)};var _c=_(null),kr=Error(r(460)),nm=Error(r(474)),qa=Error(r(542)),Yo={then:function(){}},Ps=null,xc=null,gu=0,rs=Ss(!0),B0=Ss(!1),ss=[],Jo=0,vu=0,xa=!1,im=!1,yu=_(null),bc=_(0),ea=_(null),ta=null,or=_(0),Rl=0,Nn=null,ln=null,En=null,kn=!1,On=!1,ti=!1,ps=0,Xa=0,fo=null,L0=0,ba={readContext:ee,use:Qn,useCallback:Ze,useContext:Ze,useEffect:Ze,useImperativeHandle:Ze,useLayoutEffect:Ze,useInsertionEffect:Ze,useMemo:Ze,useReducer:Ze,useRef:Ze,useState:Ze,useDebugValue:Ze,useDeferredValue:Ze,useTransition:Ze,useSyncExternalStore:Ze,useId:Ze,useHostTransitionStatus:Ze,useFormState:Ze,useActionState:Ze,useOptimistic:Ze,useMemoCache:Ze,useCacheRefresh:Ze};ba.useEffectEvent=Ze;var Qi={readContext:ee,use:Qn,useCallback:function(c,h){return zt().memoizedState=[c,h===void 0?null:h],c},useContext:ee,useEffect:Zl,useImperativeHandle:function(c,h,y){y=y!=null?y.concat([c]):null,wo(4194308,4,dl.bind(null,h,c),y)},useLayoutEffect:function(c,h){return wo(4194308,4,c,h)},useInsertionEffect:function(c,h){wo(4,2,c,h)},useMemo:function(c,h){var y=zt();h=h===void 0?null:h;var A=c();if(ti){j(!0);try{c()}finally{j(!1)}}return y.memoizedState=[A,h],A},useReducer:function(c,h,y){var A=zt();if(y!==void 0){var I=y(h);if(ti){j(!0);try{y(h)}finally{j(!1)}}}else I=h;return A.memoizedState=A.baseState=I,c={pending:null,lanes:0,dispatch:null,lastRenderedReducer:c,lastRenderedState:I},A.queue=c,c=c.dispatch=eh.bind(null,Nn,c),[A.memoizedState,c]},useRef:function(c){var h=zt();return c={current:c},h.memoizedState=c},useState:function(c){c=Mo(c);var h=c.queue,y=Rf.bind(null,Nn,h);return h.dispatch=y,[c.memoizedState,y]},useDebugValue:Ro,useDeferredValue:function(c,h){var y=zt();return $l(y,c,h)},useTransition:function(){var c=Mo(!1);return c=ec.bind(null,Nn,c.queue,!0,!1),zt().memoizedState=c,[!1,c]},useSyncExternalStore:function(c,h,y){var A=Nn,I=zt();if(Xn){if(y===void 0)throw Error(r(407));y=y()}else{if(y=h(),zn===null)throw Error(r(349));(Yn&127)!==0||pr(A,h,y)}I.memoizedState=y;var B={value:y,getSnapshot:h};return I.queue=B,Zl(To.bind(null,A,B,c),[c]),A.flags|=2048,Ms(9,{destroy:void 0},mr.bind(null,A,B,y,h),null),y},useId:function(){var c=zt(),h=zn.identifierPrefix;if(Xn){var y=uo,A=ns;y=(A&~(1<<32-Zs(A)-1)).toString(32)+y,h="_"+h+"R_"+y,y=ps++,0<y&&(h+="H"+y.toString(32)),h+="_"}else y=L0++,h="_"+h+"r_"+y.toString(32)+"_";return c.memoizedState=h},useHostTransitionStatus:Zu,useFormState:fl,useActionState:fl,useOptimistic:function(c){var h=zt();h.memoizedState=h.baseState=c;var y={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return h.queue=y,h=Da.bind(null,Nn,!0,y),y.dispatch=h,[c,h]},useMemoCache:dr,useCacheRefresh:function(){return zt().memoizedState=mp.bind(null,Nn)},useEffectEvent:function(c){var h=zt(),y={impl:c};return h.memoizedState=y,function(){if((jn&2)!==0)throw Error(r(440));return y.impl.apply(void 0,arguments)}}},Ko={readContext:ee,use:Qn,useCallback:Jc,useContext:ee,useEffect:io,useImperativeHandle:Ku,useInsertionEffect:Co,useLayoutEffect:so,useMemo:ao,useReducer:Di,useRef:Ju,useState:function(){return Di(Ln)},useDebugValue:Ro,useDeferredValue:function(c,h){var y=St();return Qu(y,ln.memoizedState,c,h)},useTransition:function(){var c=Di(Ln)[0],h=St().memoizedState;return[typeof c=="boolean"?c:kt(c),h]},useSyncExternalStore:Ei,useId:tc,useHostTransitionStatus:Zu,useFormState:Ia,useActionState:Ia,useOptimistic:function(c,h){var y=St();return qc(y,ln,c,h)},useMemoCache:dr,useCacheRefresh:$u};Ko.useEffectEvent=Wr;var Ac={readContext:ee,use:Qn,useCallback:Jc,useContext:ee,useEffect:io,useImperativeHandle:Ku,useInsertionEffect:Co,useLayoutEffect:so,useMemo:ao,useReducer:Ui,useRef:Ju,useState:function(){return Ui(Ln)},useDebugValue:Ro,useDeferredValue:function(c,h){var y=St();return ln===null?$l(y,c,h):Qu(y,ln.memoizedState,c,h)},useTransition:function(){var c=Ui(Ln)[0],h=St().memoizedState;return[typeof c=="boolean"?c:kt(c),h]},useSyncExternalStore:Ei,useId:tc,useHostTransitionStatus:Zu,useFormState:_i,useActionState:_i,useOptimistic:function(c,h){var y=St();return ln!==null?qc(y,ln,c,h):(y.baseState=c,[c,y.queue.dispatch])},useMemoCache:dr,useCacheRefresh:$u};Ac.useEffectEvent=Wr;var rd={enqueueSetState:function(c,h,y){c=c._reactInternals;var A=Hi(),I=he(A);I.payload=h,y!=null&&(I.callback=y),h=Ie(c,I,A),h!==null&&(Ji(h,c,A),He(h,c,A))},enqueueReplaceState:function(c,h,y){c=c._reactInternals;var A=Hi(),I=he(A);I.tag=1,I.payload=h,y!=null&&(I.callback=y),h=Ie(c,I,A),h!==null&&(Ji(h,c,A),He(h,c,A))},enqueueForceUpdate:function(c,h){c=c._reactInternals;var y=Hi(),A=he(y);A.tag=2,h!=null&&(A.callback=h),h=Ie(c,A,y),h!==null&&(Ji(h,c,y),He(h,c,y))}},Bs=Error(r(461)),ki=!1,_u={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null},lr=!1,cr=!1,Eh=!1,O0=typeof WeakSet=="function"?WeakSet:Set,_r=null,Zi=null,xr=!1,bi=null,Aa=8192,Th={getCacheForType:function(c){var h=ee(Wi),y=h.data.get(c);return y===void 0&&(y=c(),h.data.set(c,y)),y},cacheSignal:function(){return ee(Wi).controller.signal}},Ya=0,Mh=1,wh=2,sd=3,Sc=4;if(typeof Symbol=="function"&&Symbol.for){var xu=Symbol.for;Ya=xu("selector.component"),Mh=xu("selector.has_pseudo_class"),wh=xu("selector.role"),sd=xu("selector.test_id"),Sc=xu("selector.text")}var Sa=typeof WeakMap=="function"?WeakMap:Map,jn=0,zn=null,Wn=null,Yn=0,Ai=0,Cr=null,po=!1,Ec=!1,Tc=!1,Qo=0,$i=0,Il=0,Mc=0,Ch=0,Ls=0,Rh=0,ad=null,na=null,rm=!1,od=0,bu=0,wc=1/0,ld=null,Dl=null,Rr=0,Nl=null,Au=null,Zo=0,Ih=0,sm=null,U0=null,hi=0,cd=null;return Fn.attemptContinuousHydration=function(c){if(c.tag===13||c.tag===31){var h=sn(c,67108864);h!==null&&Ji(h,c,67108864),Gf(c,67108864)}},Fn.attemptHydrationAtCurrentPriority=function(c){if(c.tag===13||c.tag===31){var h=Hi();h=z(h);var y=sn(c,h);y!==null&&Ji(y,c,h),Gf(c,h)}},Fn.attemptSynchronousHydration=function(c){switch(c.tag){case 3:if(c=c.stateNode,c.current.memoizedState.isDehydrated){var h=w(c.pendingLanes);if(h!==0){for(c.pendingLanes|=2,c.entangledLanes|=2;h;){var y=1<<31-Zs(h);c.entanglements[1]|=y,h&=~y}Ft(c),(jn&6)===0&&(wc=fs()+500,Ct(0))}}break;case 31:case 13:h=sn(c,2),h!==null&&Ji(h,c,2),Sp(),Gf(c,2)}},Fn.batchedUpdates=function(c,h){return c(h)},Fn.createComponentSelector=function(c){return{$$typeof:Ya,value:c}},Fn.createContainer=function(c,h,y,A,I,B,K,pe,je,ft){return fc(c,h,!1,null,y,A,B,null,K,pe,je,ft)},Fn.createHasPseudoClassSelector=function(c){return{$$typeof:Mh,value:c}},Fn.createHydrationContainer=function(c,h,y,A,I,B,K,pe,je,ft,Bt,Et,Jt,Rn){var br;return c=fc(y,A,!0,c,I,B,pe,Rn,je,ft,Bt,Et),c.context=Rp(null),y=c.current,A=Hi(),A=z(A),I=he(A),I.callback=(br=h)!=null?br:null,Ie(y,I,A),h=A,c.current.lanes=h,k(c,h),Ft(c),c},Fn.createPortal=function(c,h,y){var A=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:su,key:A==null?null:""+A,children:c,containerInfo:h,implementation:y}},Fn.createRoleSelector=function(c){return{$$typeof:wh,value:c}},Fn.createTestNameSelector=function(c){return{$$typeof:sd,value:c}},Fn.createTextSelector=function(c){return{$$typeof:Sc,value:c}},Fn.defaultOnCaughtError=function(c){console.error(c)},Fn.defaultOnRecoverableError=function(c){Zp(c)},Fn.defaultOnUncaughtError=function(c){Zp(c)},Fn.deferredUpdates=function(c){var h=hn.T,y=ka();try{return qn(32),hn.T=null,c()}finally{qn(y),hn.T=h}},Fn.discreteUpdates=function(c,h,y,A,I){var B=hn.T,K=ka();try{return qn(2),hn.T=null,c(h,y,A,I)}finally{qn(K),hn.T=B,jn===0&&(wc=fs()+500)}},Fn.findAllNodes=Ys,Fn.findBoundingRects=function(c,h){if(!Lr)throw Error(r(363));h=Ys(c,h),c=[];for(var y=0;y<h.length;y++)c.push(Up(h[y]));for(h=c.length-1;0<h;h--){y=c[h];for(var A=y.x,I=A+y.width,B=y.y,K=B+y.height,pe=h-1;0<=pe;pe--)if(h!==pe){var je=c[pe],ft=je.x,Bt=ft+je.width,Et=je.y,Jt=Et+je.height;if(A>=ft&&B>=Et&&I<=Bt&&K<=Jt){c.splice(h,1);break}else if(A!==ft||y.width!==je.width||Jt<B||Et>K){if(!(B!==Et||y.height!==je.height||Bt<A||ft>I)){ft>A&&(je.width+=ft-A,je.x=A),Bt<I&&(je.width=I-ft),c.splice(h,1);break}}else{Et>B&&(je.height+=Et-B,je.y=B),Jt<K&&(je.height=K-Et),c.splice(h,1);break}}}return c},Fn.findHostInstance=Hf,Fn.findHostInstanceWithNoPortals=function(c){return c=u(c),c=c!==null?p(c):null,c===null?null:vh(c.stateNode)},Fn.findHostInstanceWithWarning=function(c){return Hf(c)},Fn.flushPassiveEffects=Ho,Fn.flushSyncFromReconciler=function(c){var h=jn;jn|=1;var y=hn.T,A=ka();try{if(qn(2),hn.T=null,c)return c()}finally{qn(A),hn.T=y,jn=h,(jn&6)===0&&Ct(0)}},Fn.flushSyncWork=Sp,Fn.focusWithin=function(c,h){if(!Lr)throw Error(r(363));for(c=oc(c),h=uh(c,h),h=Array.from(h),c=0;c<h.length;){var y=h[c++],A=y.tag;if(!mc(y)){if((A===5||A===26||A===27)&&Tl(y.stateNode))return!0;for(y=y.child;y!==null;)h.push(y),y=y.sibling}}return!1},Fn.getFindAllNodesFailureDescription=function(c,h){if(!Lr)throw Error(r(363));var y=0,A=[];c=[oc(c),0];for(var I=0;I<c.length;){var B=c[I++],K=B.tag,pe=c[I++],je=h[pe];if((K!==5&&K!==26&&K!==27||!mc(B))&&(lc(B,je)&&(A.push(ch(je)),pe++,pe>y&&(y=pe)),pe<h.length))for(B=B.child;B!==null;)c.push(B,pe),B=B.sibling}if(y<h.length){for(c=[];y<h.length;y++)c.push(ch(h[y]));return`findAllNodes was able to match part of the selector:
  `+(A.join(" > ")+`

No matching component was found for:
  `)+c.join(" > ")}return null},Fn.getPublicRootInstance=function(c){if(c=c.current,!c.child)return null;switch(c.child.tag){case 27:case 5:return vh(c.child.stateNode);default:return c.child.stateNode}},Fn.injectIntoDevTools=function(){var c={bundleType:0,version:Zg,rendererPackageName:qf,currentDispatcherRef:hn,reconcilerVersion:"19.2.0"};if(gh!==null&&(c.rendererConfig=gh),typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u")c=!1;else{var h=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(h.isDisabled||!h.supportsFiber)c=!0;else{try{mu=h.inject(c),$s=h}catch{}c=!!h.checkDCE}}return c},Fn.isAlreadyRendering=function(){return(jn&6)!==0},Fn.observeVisibleRects=function(c,h,y,A){if(!Lr)throw Error(r(363));c=Ys(c,h);var I=Fp(c,y,A).disconnect;return{disconnect:function(){I()}}},Fn.shouldError=function(){return null},Fn.shouldSuspend=function(){return!1},Fn.startHostTransition=function(c,h,y,A){if(c.tag!==5)throw Error(r(476));var I=Cf(c).queue;ec(c,I,h,uu,y===null?n:function(){var B=Cf(c);return B.next===null&&(B=c.alternate.memoizedState),nc(c,B.next.queue,{},Hi()),y(A)})},Fn.updateContainer=function(c,h,y,A){var I=h.current,B=Hi();return Kg(I,B,c,h,y,A),B},Fn.updateContainerSync=function(c,h,y,A){return Kg(h.current,2,c,h,y,A),2},Fn},i.exports.default=i.exports,Object.defineProperty(i.exports,"__esModule",{value:!0})})(dN)),dN.exports}var mN;function $X(){return mN||(mN=1,fN.exports=ZX()),fN.exports}var eY=$X();const tY=QX(eY);function nY(i){const e=tY(i);return e.injectIntoDevTools(),e}const dO=0,vg={},iY=/^three(?=[A-Z])/,GS=i=>`${i[0].toUpperCase()}${i.slice(1)}`;let rY=0;const sY=i=>typeof i=="function";function pO(i){if(sY(i)){const e=`${rY++}`;return vg[e]=i,e}else Object.assign(vg,i)}function mO(i,e){const t=GS(i),n=vg[t];if(i!=="primitive"&&!n)throw new Error(`R3F: ${t} is not part of the THREE namespace! Did you forget to extend? See: https://docs.pmnd.rs/react-three-fiber/api/objects#using-3rd-party-objects-declaratively`);if(i==="primitive"&&!e.object)throw new Error("R3F: Primitives without 'object' are invalid!");if(e.args!==void 0&&!Array.isArray(e.args))throw new Error("R3F: The args prop must be an array!")}function aY(i,e,t){var n;return i=GS(i)in vg?i:i.replace(iY,""),mO(i,e),i==="primitive"&&(n=e.object)!=null&&n.__r3f&&delete e.object.__r3f,RA(e.object,t,i,e)}function oY(i){if(!i.isHidden){var e;i.props.attach&&(e=i.parent)!=null&&e.object?DA(i.parent,i):Ma(i.object)&&(i.object.visible=!1),i.isHidden=!0,Dg(i)}}function gO(i){if(i.isHidden){var e;i.props.attach&&(e=i.parent)!=null&&e.object?IA(i.parent,i):Ma(i.object)&&i.props.visible!==!1&&(i.object.visible=!0),i.isHidden=!1,Dg(i)}}function Yw(i,e,t){const n=e.root.getState();if(!(!i.parent&&i.object!==n.scene)){if(!e.object){var r,s;const o=vg[GS(e.type)];e.object=(r=e.props.object)!=null?r:new o(...(s=e.props.args)!=null?s:[]),e.object.__r3f=e}if(Bc(e.object,e.props),e.props.attach)IA(i,e);else if(Ma(e.object)&&Ma(i.object)){const o=i.object.children.indexOf(t==null?void 0:t.object);if(t&&o!==-1){const u=i.object.children.indexOf(e.object);if(u!==-1){i.object.children.splice(u,1);const f=u<o?o-1:o;i.object.children.splice(f,0,e.object)}else e.object.parent=i.object,i.object.children.splice(o,0,e.object),e.object.dispatchEvent({type:"added"}),i.object.dispatchEvent({type:"childadded",child:e.object})}else i.object.add(e.object)}for(const o of e.children)Yw(e,o);Dg(e)}}function L1(i,e){e&&(e.parent=i,i.children.push(e),Yw(i,e))}function gN(i,e,t){if(!e||!t)return;e.parent=i;const n=i.children.indexOf(t);n!==-1?i.children.splice(n,0,e):i.children.push(e),Yw(i,e,t)}function vO(i){if(typeof i.dispose=="function"){const e=()=>{try{i.dispose()}catch{}};typeof IS_REACT_ACT_ENVIRONMENT<"u"?e():zT.unstable_scheduleCallback(zT.unstable_IdlePriority,e)}}function HT(i,e,t){if(!e)return;e.parent=null;const n=i.children.indexOf(e);n!==-1&&i.children.splice(n,1),e.props.attach?DA(i,e):Ma(e.object)&&Ma(i.object)&&(i.object.remove(e.object),HX(aO(e),e.object));const r=e.props.dispose!==null&&t!==!1;for(let s=e.children.length-1;s>=0;s--){const o=e.children[s];HT(e,o,r)}e.children.length=0,delete e.object.__r3f,r&&e.type!=="primitive"&&e.object.type!=="Scene"&&vO(e.object),t===void 0&&Dg(e)}function lY(i,e){for(const t of[i,i.alternate])if(t!==null)if(typeof t.ref=="function"){t.refCleanup==null||t.refCleanup();const n=t.ref(e);typeof n=="function"&&(t.refCleanup=n)}else t.ref&&(t.ref.current=e)}const vb=[];function cY(){for(const[t]of vb){const n=t.parent;if(n){t.props.attach?DA(n,t):Ma(t.object)&&Ma(n.object)&&n.object.remove(t.object);for(const r of t.children)r.props.attach?DA(t,r):Ma(r.object)&&Ma(t.object)&&t.object.remove(r.object)}t.isHidden&&gO(t),t.object.__r3f&&delete t.object.__r3f,t.type!=="primitive"&&vO(t.object)}for(const[t,n,r]of vb){t.props=n;const s=t.parent;if(s){var i,e;const o=vg[GS(t.type)];t.object=(i=t.props.object)!=null?i:new o(...(e=t.props.args)!=null?e:[]),t.object.__r3f=t,lY(r,t.object),Bc(t.object,t.props),t.props.attach?IA(s,t):Ma(t.object)&&Ma(s.object)&&s.object.add(t.object);for(const u of t.children)u.props.attach?IA(t,u):Ma(u.object)&&Ma(t.object)&&t.object.add(u.object);Dg(t)}}vb.length=0}const O1=()=>{},vN={};let Kx=dO;const uY=0,hY=4,NA=nY({isPrimaryRenderer:!1,warnsIfNotActing:!1,supportsMutation:!0,supportsPersistence:!1,supportsHydration:!1,createInstance:aY,removeChild:HT,appendChild:L1,appendInitialChild:L1,insertBefore:gN,appendChildToContainer(i,e){const t=i.getState().scene.__r3f;!e||!t||L1(t,e)},removeChildFromContainer(i,e){const t=i.getState().scene.__r3f;!e||!t||HT(t,e)},insertInContainerBefore(i,e,t){const n=i.getState().scene.__r3f;!e||!t||!n||gN(n,e,t)},getRootHostContext:()=>vN,getChildHostContext:()=>vN,commitUpdate(i,e,t,n,r){var s,o,u;mO(e,n);let f=!1;if((i.type==="primitive"&&t.object!==n.object||((s=n.args)==null?void 0:s.length)!==((o=t.args)==null?void 0:o.length)||(u=n.args)!=null&&u.some((g,v)=>{var _;return g!==((_=t.args)==null?void 0:_[v])}))&&(f=!0),f)vb.push([i,{...n},r]);else{const g=kX(i,n);Object.keys(g).length&&(Object.assign(i.props,g),Bc(i.object,g))}(r.sibling===null||(r.flags&hY)===uY)&&cY()},finalizeInitialChildren:()=>!1,commitMount(){},getPublicInstance:i=>i==null?void 0:i.object,prepareForCommit:()=>null,preparePortalMount:i=>RA(i.getState().scene,i,"",{}),resetAfterCommit:()=>{},shouldSetTextContent:()=>!1,clearContainer:()=>!1,hideInstance:oY,unhideInstance:gO,createTextInstance:O1,hideTextInstance:O1,unhideTextInstance:O1,scheduleTimeout:typeof setTimeout=="function"?setTimeout:void 0,cancelTimeout:typeof clearTimeout=="function"?clearTimeout:void 0,noTimeout:-1,getInstanceFromNode:()=>null,beforeActiveInstanceBlur(){},afterActiveInstanceBlur(){},detachDeletedInstance(){},prepareScopeUpdate(){},getInstanceFromScope:()=>null,shouldAttemptEagerTransition:()=>!1,trackSchedulerEvent:()=>{},resolveEventType:()=>null,resolveEventTimeStamp:()=>-1.1,requestPostPaintCallback(){},maySuspendCommit:()=>!1,preloadInstance:()=>!0,suspendInstance(){},waitForCommitToBeReady:()=>null,NotPendingTransition:null,HostTransitionContext:be.createContext(null),setCurrentUpdatePriority(i){Kx=i},getCurrentUpdatePriority(){return Kx},resolveUpdatePriority(){var i;if(Kx!==dO)return Kx;switch(typeof window<"u"&&((i=window.event)==null?void 0:i.type)){case"click":case"contextmenu":case"dblclick":case"pointercancel":case"pointerdown":case"pointerup":return JX;case"pointermove":case"pointerout":case"pointerover":case"pointerenter":case"pointerleave":case"wheel":return XX;default:return YX}},resetFormInstance(){},rendererPackageName:"@react-three/fiber",rendererVersion:KX.version,applyViewTransitionName(i,e,t){},restoreViewTransitionName(i,e){},cancelViewTransitionName(i,e,t){},cancelRootViewTransitionName(i){},restoreRootViewTransitionName(i){},InstanceMeasurement:null,measureInstance:i=>null,wasInstanceInViewport:i=>!0,hasInstanceChanged:(i,e)=>!1,hasInstanceAffectedParent:(i,e)=>!1,suspendOnActiveViewTransition(i,e){},startGestureTransition:()=>null,startViewTransition:()=>null,stopViewTransition(i){},createViewTransitionInstance:i=>null,getCurrentGestureOffset(i){throw new Error("startGestureTransition is not yet supported in react-three-fiber.")},cloneMutableInstance(i,e){return i},cloneMutableTextInstance(i){return i},cloneRootViewTransitionContainer(i){throw new Error("Not implemented.")},removeRootViewTransitionClone(i,e){throw new Error("Not implemented.")},createFragmentInstance:i=>null,updateFragmentInstanceFiber(i,e){},commitNewChildToFragmentInstance(i,e){},deleteChildFromFragmentInstance(i,e){},measureClonedInstance:i=>null,maySuspendCommitOnUpdate:(i,e,t)=>!1,maySuspendCommitInSyncRender:(i,e)=>!1,startSuspendingCommit:()=>null,getSuspendedCommitReason:(i,e)=>null}),sp=new Map,Nm={objects:"shallow",strict:!1};function fY(i,e){if(!e&&typeof HTMLCanvasElement<"u"&&i instanceof HTMLCanvasElement&&i.parentElement){const{width:t,height:n,top:r,left:s}=i.parentElement.getBoundingClientRect();return{width:t,height:n,top:r,left:s}}else if(!e&&typeof OffscreenCanvas<"u"&&i instanceof OffscreenCanvas)return{width:i.width,height:i.height,top:0,left:0};return{width:0,height:0,top:0,left:0,...e}}function dY(i){const e=sp.get(i),t=e==null?void 0:e.fiber,n=e==null?void 0:e.store;e&&console.warn("R3F.createRoot should only be called once!");const r=typeof reportError=="function"?reportError:console.error,s=n||jX(WT,_N),o=t||NA.createContainer(s,qX,null,!1,null,"",r,r,r,null);e||sp.set(i,{fiber:o,store:s});let u,f,p=!1,g=null;return{async configure(v={}){let _;g=new Promise($=>_=$);let{gl:x,size:E,scene:C,events:w,onCreated:T,shadows:N=!1,linear:L=!1,flat:F=!1,legacy:G=!1,orthographic:k=!1,frameloop:O="always",dpr:D=[1,2],performance:R,raycaster:P,camera:z,onPointerMissed:Y}=v,j=s.getState(),ce=j.gl;if(!j.gl){const $={canvas:i,powerPreference:"high-performance",antialias:!0,alpha:!0},ae=typeof x=="function"?await x($):x;uN(ae)?ce=ae:ce=new Hw({...$,...x}),j.set({gl:ce})}let fe=j.raycaster;fe||j.set({raycaster:fe=new zw});const{params:te,...se}=P||{};if(ur.equ(se,fe,Nm)||Bc(fe,{...se}),ur.equ(te,fe.params,Nm)||Bc(fe,{params:{...fe.params,...te}}),!j.camera||j.camera===f&&!ur.equ(f,z,Nm)){f=z;const $=z==null?void 0:z.isCamera,ae=$?z:k?new Ao(0,0,0,0,.1,1e3):new hr(75,0,.1,1e3);$||(ae.position.z=5,z&&(Bc(ae,z),ae.manual||("aspect"in z||"left"in z||"right"in z||"bottom"in z||"top"in z)&&(ae.manual=!0,ae.updateProjectionMatrix())),!j.camera&&!(z!=null&&z.rotation)&&ae.lookAt(0,0,0)),j.set({camera:ae}),fe.camera=ae}if(!j.scene){let $;C!=null&&C.isScene?($=C,RA($,s,"",{})):($=new Ay,RA($,s,"",{}),C&&Bc($,C)),j.set({scene:$})}w&&!j.events.handlers&&j.set({events:w(s)});const Ae=fY(i,E);if(ur.equ(Ae,j.size,Nm)||j.setSize(Ae.width,Ae.height,Ae.top,Ae.left),D&&j.viewport.dpr!==lO(D)&&j.setDpr(D),j.frameloop!==O&&j.setFrameloop(O),j.onPointerMissed||j.set({onPointerMissed:Y}),R&&!ur.equ(R,j.performance,Nm)&&j.set($=>({performance:{...$.performance,...R}})),!j.xr){var Pe;const $=(ke,dt)=>{const ve=s.getState();ve.frameloop!=="never"&&_N(ke,!0,ve,dt)},ae=()=>{const ke=s.getState();ke.gl.xr.enabled=ke.gl.xr.isPresenting,ke.gl.xr.setAnimationLoop(ke.gl.xr.isPresenting?$:null),ke.gl.xr.isPresenting||WT(ke)},Se={connect(){const ke=s.getState().gl;ke.xr.addEventListener("sessionstart",ae),ke.xr.addEventListener("sessionend",ae)},disconnect(){const ke=s.getState().gl;ke.xr.removeEventListener("sessionstart",ae),ke.xr.removeEventListener("sessionend",ae)}};typeof((Pe=ce.xr)==null?void 0:Pe.addEventListener)=="function"&&Se.connect(),j.set({xr:Se})}if(ce.shadowMap){const $=ce.shadowMap.enabled,ae=ce.shadowMap.type;if(ce.shadowMap.enabled=!!N,ur.boo(N))ce.shadowMap.type=Tv;else if(ur.str(N)){var Re;const Se={basic:gB,percentage:Wm,soft:Tv,variance:Nd};ce.shadowMap.type=(Re=Se[N])!=null?Re:Tv}else ur.obj(N)&&Object.assign(ce.shadowMap,N);($!==ce.shadowMap.enabled||ae!==ce.shadowMap.type)&&(ce.shadowMap.needsUpdate=!0)}return oi.enabled=!G,p||(ce.outputColorSpace=L?Xl:Fs,ce.toneMapping=F?ol:sS),j.legacy!==G&&j.set(()=>({legacy:G})),j.linear!==L&&j.set(()=>({linear:L})),j.flat!==F&&j.set(()=>({flat:F})),x&&!ur.fun(x)&&!uN(x)&&!ur.equ(x,ce,Nm)&&Bc(ce,x),u=T,p=!0,_(),this},render(v){return!p&&!g&&this.configure(),g.then(()=>{NA.updateContainer(V.jsx(pY,{store:s,children:v,onCreated:u,rootElement:i}),o,null,()=>{})}),s},unmount(){yO(i)}}}function pY({store:i,children:e,onCreated:t,rootElement:n}){return Iy(()=>{const r=i.getState();r.set(s=>({internal:{...s.internal,active:!0}})),t&&t(r),i.getState().events.connected||r.events.connect==null||r.events.connect(n)},[]),V.jsx(qw.Provider,{value:i,children:e})}function yO(i,e){const t=sp.get(i),n=t==null?void 0:t.fiber;if(n){const r=t==null?void 0:t.store.getState();r&&(r.internal.active=!1),NA.updateContainer(null,n,null,()=>{r&&setTimeout(()=>{try{var s,o,u,f;r.events.disconnect==null||r.events.disconnect(),(s=r.gl)==null||(o=s.renderLists)==null||o.dispose==null||o.dispose(),(u=r.gl)==null||u.forceContextLoss==null||u.forceContextLoss(),(f=r.gl)!=null&&f.xr&&r.xr.disconnect(),OX(r.scene),sp.delete(i)}catch{}},500)})}}function mY(i,e,t){return V.jsx(gY,{children:i,container:e,state:t})}function gY({state:i={},children:e,container:t}){const{events:n,size:r,...s}=i,o=Xw(),[u]=be.useState(()=>new zw),[f]=be.useState(()=>new $e),p=Ww((v,_)=>{let x;if(_.camera&&r){const E=_.camera;x=v.viewport.getCurrentViewport(E,new ie,r),E!==v.camera&&uO(E,r)}return{...v,..._,scene:t,raycaster:u,pointer:f,mouse:f,previousRoot:o,events:{...v.events,..._.events,...n},size:{...v.size,...r},viewport:{...v.viewport,...x},setEvents:E=>_.set(C=>({...C,events:{...C.events,...E}}))}}),g=be.useMemo(()=>{const v=eO((x,E)=>({...s,set:x,get:E})),_=x=>v.setState(E=>p.current(x,E));return _(o.getState()),o.subscribe(_),v},[o,t]);return V.jsx(V.Fragment,{children:NA.createPortal(V.jsx(qw.Provider,{value:g,children:e}),g,null)})}const vY=new Set,yY=new Set,_Y=new Set;function U1(i,e){if(i.size)for(const{callback:t}of i.values())t(e)}function Pv(i,e){switch(i){case"before":return U1(vY,e);case"after":return U1(yY,e);case"tail":return U1(_Y,e)}}let F1,k1;function GT(i,e,t){let n=e.clock.getDelta();e.frameloop==="never"&&typeof i=="number"&&(n=i-e.clock.elapsedTime,e.clock.oldTime=e.clock.elapsedTime,e.clock.elapsedTime=i),F1=e.internal.subscribers;for(let r=0;r<F1.length;r++)k1=F1[r],k1.ref.current(k1.store.getState(),n,t);return!e.internal.priority&&e.gl.render&&e.gl.render(e.scene,e.camera),e.internal.frames=Math.max(0,e.internal.frames-1),e.frameloop==="always"?1:e.internal.frames}let PA=!1,jT=!1,z1,yN,Pm;function _O(i){yN=requestAnimationFrame(_O),PA=!0,z1=0,Pv("before",i),jT=!0;for(const t of sp.values()){var e;Pm=t.store.getState(),Pm.internal.active&&(Pm.frameloop==="always"||Pm.internal.frames>0)&&!((e=Pm.gl.xr)!=null&&e.isPresenting)&&(z1+=GT(i,Pm))}if(jT=!1,Pv("after",i),z1===0)return Pv("tail",i),PA=!1,cancelAnimationFrame(yN)}function WT(i,e=1){var t;if(!i)return sp.forEach(n=>WT(n.store.getState(),e));(t=i.gl.xr)!=null&&t.isPresenting||!i.internal.active||i.frameloop==="never"||(e>1?i.internal.frames=Math.min(60,i.internal.frames+e):jT?i.internal.frames=2:i.internal.frames=1,PA||(PA=!0,requestAnimationFrame(_O)))}function _N(i,e=!0,t,n){if(e&&Pv("before",i),t)GT(i,t,n);else for(const r of sp.values())GT(i,r.store.getState());e&&Pv("after",i)}const V1={onClick:["click",!1],onContextMenu:["contextmenu",!1],onDoubleClick:["dblclick",!1],onWheel:["wheel",!0],onPointerDown:["pointerdown",!0],onPointerUp:["pointerup",!0],onPointerLeave:["pointerleave",!0],onPointerMove:["pointermove",!0],onPointerCancel:["pointercancel",!0],onLostPointerCapture:["lostpointercapture",!0]};function xY(i){const{handlePointer:e}=GX(i);return{priority:1,enabled:!0,compute(t,n,r){n.pointer.set(t.offsetX/n.size.width*2-1,-(t.offsetY/n.size.height)*2+1),n.raycaster.setFromCamera(n.pointer,n.camera)},connected:void 0,handlers:Object.keys(V1).reduce((t,n)=>({...t,[n]:e(n)}),{}),update:()=>{var t;const{events:n,internal:r}=i.getState();(t=r.lastEvent)!=null&&t.current&&n.handlers&&n.handlers.onPointerMove(r.lastEvent.current)},connect:t=>{const{set:n,events:r}=i.getState();if(r.disconnect==null||r.disconnect(),n(s=>({events:{...s.events,connected:t}})),r.handlers)for(const s in r.handlers){const o=r.handlers[s],[u,f]=V1[s];t.addEventListener(u,o,{passive:f})}},disconnect:()=>{const{set:t,events:n}=i.getState();if(n.connected){if(n.handlers)for(const r in n.handlers){const s=n.handlers[r],[o]=V1[r];n.connected.removeEventListener(o,s)}t(r=>({events:{...r.events,connected:void 0}}))}}}}function xN(i,e){let t;return(...n)=>{window.clearTimeout(t),t=window.setTimeout(()=>i(...n),e)}}function bY({debounce:i,scroll:e,polyfill:t,offsetSize:n}={debounce:0,scroll:!1,offsetSize:!1}){const r=t||(typeof window>"u"?class{}:window.ResizeObserver);if(!r)throw new Error("This browser does not support ResizeObserver out of the box. See: https://github.com/react-spring/react-use-measure/#resize-observer-polyfills");const[s,o]=be.useState({left:0,top:0,width:0,height:0,bottom:0,right:0,x:0,y:0}),u=be.useRef({element:null,scrollContainers:null,resizeObserver:null,lastBounds:s,orientationHandler:null}),f=i?typeof i=="number"?i:i.scroll:null,p=i?typeof i=="number"?i:i.resize:null,g=be.useRef(!1);be.useEffect(()=>(g.current=!0,()=>void(g.current=!1)));const[v,_,x]=be.useMemo(()=>{const T=()=>{if(!u.current.element)return;const{left:N,top:L,width:F,height:G,bottom:k,right:O,x:D,y:R}=u.current.element.getBoundingClientRect(),P={left:N,top:L,width:F,height:G,bottom:k,right:O,x:D,y:R};u.current.element instanceof HTMLElement&&n&&(P.height=u.current.element.offsetHeight,P.width=u.current.element.offsetWidth),Object.freeze(P),g.current&&!TY(u.current.lastBounds,P)&&o(u.current.lastBounds=P)};return[T,p?xN(T,p):T,f?xN(T,f):T]},[o,n,f,p]);function E(){u.current.scrollContainers&&(u.current.scrollContainers.forEach(T=>T.removeEventListener("scroll",x,!0)),u.current.scrollContainers=null),u.current.resizeObserver&&(u.current.resizeObserver.disconnect(),u.current.resizeObserver=null),u.current.orientationHandler&&("orientation"in screen&&"removeEventListener"in screen.orientation?screen.orientation.removeEventListener("change",u.current.orientationHandler):"onorientationchange"in window&&window.removeEventListener("orientationchange",u.current.orientationHandler))}function C(){u.current.element&&(u.current.resizeObserver=new r(x),u.current.resizeObserver.observe(u.current.element),e&&u.current.scrollContainers&&u.current.scrollContainers.forEach(T=>T.addEventListener("scroll",x,{capture:!0,passive:!0})),u.current.orientationHandler=()=>{x()},"orientation"in screen&&"addEventListener"in screen.orientation?screen.orientation.addEventListener("change",u.current.orientationHandler):"onorientationchange"in window&&window.addEventListener("orientationchange",u.current.orientationHandler))}const w=T=>{!T||T===u.current.element||(E(),u.current.element=T,u.current.scrollContainers=xO(T),C())};return SY(x,!!e),AY(_),be.useEffect(()=>{E(),C()},[e,x,_]),be.useEffect(()=>E,[]),[w,s,v]}function AY(i){be.useEffect(()=>{const e=i;return window.addEventListener("resize",e),()=>void window.removeEventListener("resize",e)},[i])}function SY(i,e){be.useEffect(()=>{if(e){const t=i;return window.addEventListener("scroll",t,{capture:!0,passive:!0}),()=>void window.removeEventListener("scroll",t,!0)}},[i,e])}function xO(i){const e=[];if(!i||i===document.body)return e;const{overflow:t,overflowX:n,overflowY:r}=window.getComputedStyle(i);return[t,n,r].some(s=>s==="auto"||s==="scroll")&&e.push(i),[...e,...xO(i.parentElement)]}const EY=["x","y","top","bottom","left","right","width","height"],TY=(i,e)=>EY.every(t=>i[t]===e[t]);function MY({ref:i,children:e,fallback:t,resize:n,style:r,gl:s,events:o=xY,eventSource:u,eventPrefix:f,shadows:p,linear:g,flat:v,legacy:_,orthographic:x,frameloop:E,dpr:C,performance:w,raycaster:T,camera:N,scene:L,onPointerMissed:F,onCreated:G,...k}){be.useMemo(()=>pO(uX),[]);const O=NX(),[D,R]=bY({scroll:!0,debounce:{scroll:50,resize:0},...n}),P=be.useRef(null),z=be.useRef(null);be.useImperativeHandle(i,()=>P.current);const Y=Ww(F),[j,ce]=be.useState(!1),[fe,te]=be.useState(!1);if(j)throw j;if(fe)throw fe;const se=be.useRef(null);Iy(()=>{const Pe=P.current;if(R.width>0&&R.height>0&&Pe){se.current||(se.current=dY(Pe));async function Re(){await se.current.configure({gl:s,scene:L,events:o,shadows:p,linear:g,flat:v,legacy:_,orthographic:x,frameloop:E,dpr:C,performance:w,raycaster:T,camera:N,size:R,onPointerMissed:(...$)=>Y.current==null?void 0:Y.current(...$),onCreated:$=>{$.events.connect==null||$.events.connect(u?IX(u)?u.current:u:z.current),f&&$.setEvents({compute:(ae,Se)=>{const ke=ae[f+"X"],dt=ae[f+"Y"];Se.pointer.set(ke/Se.size.width*2-1,-(dt/Se.size.height)*2+1),Se.raycaster.setFromCamera(Se.pointer,Se.camera)}}),G==null||G($)}}),se.current.render(V.jsx(O,{children:V.jsx(BX,{set:te,children:V.jsx(be.Suspense,{fallback:V.jsx(PX,{set:ce}),children:e??null})})}))}Re()}}),be.useEffect(()=>{const Pe=P.current;if(Pe)return()=>yO(Pe)},[]);const Ae=u?"none":"auto";return V.jsx("div",{ref:z,style:{position:"relative",width:"100%",height:"100%",overflow:"hidden",pointerEvents:Ae,...r},...k,children:V.jsx("div",{ref:D,style:{width:"100%",height:"100%"},children:V.jsx("canvas",{ref:P,style:{display:"block"},children:t})})})}function wY(i){return V.jsx(rO,{children:V.jsx(MY,{...i})})}function ap(){return ap=Object.assign?Object.assign.bind():function(i){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var n in t)({}).hasOwnProperty.call(t,n)&&(i[n]=t[n])}return i},ap.apply(null,arguments)}const Dy=new ie,Jw=new ie,CY=new ie,bN=new $e;function RY(i,e,t){const n=Dy.setFromMatrixPosition(i.matrixWorld);n.project(e);const r=t.width/2,s=t.height/2;return[n.x*r+r,-(n.y*s)+s]}function IY(i,e){const t=Dy.setFromMatrixPosition(i.matrixWorld),n=Jw.setFromMatrixPosition(e.matrixWorld),r=t.sub(n),s=e.getWorldDirection(CY);return r.angleTo(s)>Math.PI/2}function DY(i,e,t,n){const r=Dy.setFromMatrixPosition(i.matrixWorld),s=r.clone();s.project(e),bN.set(s.x,s.y),t.setFromCamera(bN,e);const o=t.intersectObjects(n,!0);if(o.length){const u=o[0].distance;return r.distanceTo(t.ray.origin)<u}return!0}function NY(i,e){if(e instanceof Ao)return e.zoom;if(e instanceof hr){const t=Dy.setFromMatrixPosition(i.matrixWorld),n=Jw.setFromMatrixPosition(e.matrixWorld),r=e.fov*Math.PI/180,s=t.distanceTo(n);return 1/(2*Math.tan(r/2)*s)}else return 1}function PY(i,e,t){if(e instanceof hr||e instanceof Ao){const n=Dy.setFromMatrixPosition(i.matrixWorld),r=Jw.setFromMatrixPosition(e.matrixWorld),s=n.distanceTo(r),o=(t[1]-t[0])/(e.far-e.near),u=t[1]-o*e.far;return Math.round(o*s+u)}}const qT=i=>Math.abs(i)<1e-10?0:i;function bO(i,e,t=""){let n="matrix3d(";for(let r=0;r!==16;r++)n+=qT(e[r]*i.elements[r])+(r!==15?",":")");return t+n}const BY=(i=>e=>bO(e,i))([1,-1,1,1,1,-1,1,1,1,-1,1,1,1,-1,1,1]),LY=(i=>(e,t)=>bO(e,i(t),"translate(-50%,-50%)"))(i=>[1/i,1/i,1/i,1,-1/i,-1/i,-1/i,-1,1/i,1/i,1/i,1,1,1,1,1]);function OY(i){return i&&typeof i=="object"&&"current"in i}const AO=be.forwardRef(({children:i,eps:e=.001,style:t,className:n,prepend:r,center:s,fullscreen:o,portal:u,distanceFactor:f,sprite:p=!1,transform:g=!1,occlude:v,onOcclude:_,castShadow:x,receiveShadow:E,material:C,geometry:w,zIndexRange:T=[16777271,0],calculatePosition:N=RY,as:L="div",wrapperClass:F,pointerEvents:G="auto",...k},O)=>{const{gl:D,camera:R,scene:P,size:z,raycaster:Y,events:j,viewport:ce}=Hr(),[fe]=be.useState(()=>document.createElement(L)),te=be.useRef(null),se=be.useRef(null),Ae=be.useRef(0),Pe=be.useRef([0,0]),Re=be.useRef(null),$=be.useRef(null),ae=(u==null?void 0:u.current)||j.connected||D.domElement.parentNode,Se=be.useRef(null),ke=be.useRef(!1),dt=be.useMemo(()=>v&&v!=="blending"||Array.isArray(v)&&v.length&&OY(v[0]),[v]);be.useLayoutEffect(()=>{const Dt=D.domElement;v&&v==="blending"?(Dt.style.zIndex=`${Math.floor(T[0]/2)}`,Dt.style.position="absolute",Dt.style.pointerEvents="none"):(Dt.style.zIndex=null,Dt.style.position=null,Dt.style.pointerEvents=null)},[v]),be.useLayoutEffect(()=>{if(se.current){const Dt=te.current=NN.createRoot(fe);if(P.updateMatrixWorld(),g)fe.style.cssText="position:absolute;top:0;left:0;pointer-events:none;overflow:hidden;";else{const qt=N(se.current,R,z);fe.style.cssText=`position:absolute;top:0;left:0;transform:translate3d(${qt[0]}px,${qt[1]}px,0);transform-origin:0 0;`}return ae&&(r?ae.prepend(fe):ae.appendChild(fe)),()=>{ae&&ae.removeChild(fe),Dt.unmount()}}},[ae,g]),be.useLayoutEffect(()=>{F&&(fe.className=F)},[F]);const ve=be.useMemo(()=>g?{position:"absolute",top:0,left:0,width:z.width,height:z.height,transformStyle:"preserve-3d",pointerEvents:"none"}:{position:"absolute",transform:s?"translate3d(-50%,-50%,0)":"none",...o&&{top:-z.height/2,left:-z.width/2,width:z.width,height:z.height},...t},[t,s,o,z,g]),Le=be.useMemo(()=>({position:"absolute",pointerEvents:G}),[G]);be.useLayoutEffect(()=>{if(ke.current=!1,g){var Dt;(Dt=te.current)==null||Dt.render(be.createElement("div",{ref:Re,style:ve},be.createElement("div",{ref:$,style:Le},be.createElement("div",{ref:O,className:n,style:t,children:i}))))}else{var qt;(qt=te.current)==null||qt.render(be.createElement("div",{ref:O,style:ve,className:n,children:i}))}});const lt=be.useRef(!0);Ng(Dt=>{if(se.current){R.updateMatrixWorld(),se.current.updateWorldMatrix(!0,!1);const qt=g?Pe.current:N(se.current,R,z);if(g||Math.abs(Ae.current-R.zoom)>e||Math.abs(Pe.current[0]-qt[0])>e||Math.abs(Pe.current[1]-qt[1])>e){const un=IY(se.current,R);let Yt=!1;dt&&(Array.isArray(v)?Yt=v.map(xt=>xt.current):v!=="blending"&&(Yt=[P]));const qe=lt.current;if(Yt){const xt=DY(se.current,R,Y,Yt);lt.current=xt&&!un}else lt.current=!un;qe!==lt.current&&(_?_(!lt.current):fe.style.display=lt.current?"block":"none");const rt=Math.floor(T[0]/2),Je=v?dt?[T[0],rt]:[rt-1,0]:T;if(fe.style.zIndex=`${PY(se.current,R,Je)}`,g){const[xt,re]=[z.width/2,z.height/2],Lt=R.projectionMatrix.elements[5]*re,{isOrthographicCamera:vt,top:Qt,left:bt,bottom:ee,right:q}=R,ge=BY(R.matrixWorldInverse),Fe=vt?`scale(${Lt})translate(${qT(-(q+bt)/2)}px,${qT((Qt+ee)/2)}px)`:`translateZ(${Lt}px)`;let Xe=se.current.matrixWorld;p&&(Xe=R.matrixWorldInverse.clone().transpose().copyPosition(Xe).scale(se.current.scale),Xe.elements[3]=Xe.elements[7]=Xe.elements[11]=0,Xe.elements[15]=1),fe.style.width=z.width+"px",fe.style.height=z.height+"px",fe.style.perspective=vt?"":`${Lt}px`,Re.current&&$.current&&(Re.current.style.transform=`${Fe}${ge}translate(${xt}px,${re}px)`,$.current.style.transform=LY(Xe,1/((f||10)/400)))}else{const xt=f===void 0?1:NY(se.current,R)*f;fe.style.transform=`translate3d(${qt[0]}px,${qt[1]}px,0) scale(${xt})`}Pe.current=qt,Ae.current=R.zoom}}if(!dt&&Se.current&&!ke.current)if(g){if(Re.current){const qt=Re.current.children[0];if(qt!=null&&qt.clientWidth&&qt!=null&&qt.clientHeight){const{isOrthographicCamera:un}=R;if(un||w)k.scale&&(Array.isArray(k.scale)?k.scale instanceof ie?Se.current.scale.copy(k.scale.clone().divideScalar(1)):Se.current.scale.set(1/k.scale[0],1/k.scale[1],1/k.scale[2]):Se.current.scale.setScalar(1/k.scale));else{const Yt=(f||10)/400,qe=qt.clientWidth*Yt,rt=qt.clientHeight*Yt;Se.current.scale.set(qe,rt,1)}ke.current=!0}}}else{const qt=fe.children[0];if(qt!=null&&qt.clientWidth&&qt!=null&&qt.clientHeight){const un=1/ce.factor,Yt=qt.clientWidth*un,qe=qt.clientHeight*un;Se.current.scale.set(Yt,qe,1),ke.current=!0}Se.current.lookAt(Dt.camera.position)}});const _t=be.useMemo(()=>({vertexShader:g?void 0:`
          /*
            This shader is from the THREE's SpriteMaterial.
            We need to turn the backing plane into a Sprite
            (make it always face the camera) if "transfrom"
            is false.
          */
          #include <common>

          void main() {
            vec2 center = vec2(0., 1.);
            float rotation = 0.0;

            // This is somewhat arbitrary, but it seems to work well
            // Need to figure out how to derive this dynamically if it even matters
            float size = 0.03;

            vec4 mvPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );
            vec2 scale;
            scale.x = length( vec3( modelMatrix[ 0 ].x, modelMatrix[ 0 ].y, modelMatrix[ 0 ].z ) );
            scale.y = length( vec3( modelMatrix[ 1 ].x, modelMatrix[ 1 ].y, modelMatrix[ 1 ].z ) );

            bool isPerspective = isPerspectiveMatrix( projectionMatrix );
            if ( isPerspective ) scale *= - mvPosition.z;

            vec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale * size;
            vec2 rotatedPosition;
            rotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;
            rotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;
            mvPosition.xy += rotatedPosition;

            gl_Position = projectionMatrix * mvPosition;
          }
      `,fragmentShader:`
        void main() {
          gl_FragColor = vec4(0.0, 0.0, 0.0, 0.0);
        }
      `}),[g]);return be.createElement("group",ap({},k,{ref:se}),v&&!dt&&be.createElement("mesh",{castShadow:x,receiveShadow:E,ref:Se},w||be.createElement("planeGeometry",null),C||be.createElement("shaderMaterial",{side:yo,vertexShader:_t.vertexShader,fragmentShader:_t.fragmentShader})))}),Kw=parseInt(gy.replace(/\D+/g,""));function AN(i,e){if(e===VB)return console.warn("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Geometry already defined as triangles."),i;if(e===EA||e===ow){let t=i.getIndex();if(t===null){const o=[],u=i.getAttribute("position");if(u!==void 0){for(let f=0;f<u.count;f++)o.push(f);i.setIndex(o),t=i.getIndex()}else return console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Undefined position attribute. Processing not possible."),i}const n=t.count-2,r=[];if(t)if(e===EA)for(let o=1;o<=n;o++)r.push(t.getX(0)),r.push(t.getX(o)),r.push(t.getX(o+1));else for(let o=0;o<n;o++)o%2===0?(r.push(t.getX(o)),r.push(t.getX(o+1)),r.push(t.getX(o+2))):(r.push(t.getX(o+2)),r.push(t.getX(o+1)),r.push(t.getX(o)));r.length/3!==n&&console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Unable to generate correct amount of triangles.");const s=i.clone();return s.setIndex(r),s.clearGroups(),s}else return console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Unknown draw mode:",e),i}var rl=Uint8Array,nf=Uint16Array,XT=Uint32Array,SO=new rl([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),EO=new rl([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),UY=new rl([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),TO=function(i,e){for(var t=new nf(31),n=0;n<31;++n)t[n]=e+=1<<i[n-1];for(var r=new XT(t[30]),n=1;n<30;++n)for(var s=t[n];s<t[n+1];++s)r[s]=s-t[n]<<5|n;return[t,r]},MO=TO(SO,2),wO=MO[0],FY=MO[1];wO[28]=258,FY[258]=28;var kY=TO(EO,0),zY=kY[0],YT=new nf(32768);for(var nr=0;nr<32768;++nr){var qh=(nr&43690)>>>1|(nr&21845)<<1;qh=(qh&52428)>>>2|(qh&13107)<<2,qh=(qh&61680)>>>4|(qh&3855)<<4,YT[nr]=((qh&65280)>>>8|(qh&255)<<8)>>>1}var Bv=(function(i,e,t){for(var n=i.length,r=0,s=new nf(e);r<n;++r)++s[i[r]-1];var o=new nf(e);for(r=0;r<e;++r)o[r]=o[r-1]+s[r-1]<<1;var u;if(t){u=new nf(1<<e);var f=15-e;for(r=0;r<n;++r)if(i[r])for(var p=r<<4|i[r],g=e-i[r],v=o[i[r]-1]++<<g,_=v|(1<<g)-1;v<=_;++v)u[YT[v]>>>f]=p}else for(u=new nf(n),r=0;r<n;++r)i[r]&&(u[r]=YT[o[i[r]-1]++]>>>15-i[r]);return u}),Ny=new rl(288);for(var nr=0;nr<144;++nr)Ny[nr]=8;for(var nr=144;nr<256;++nr)Ny[nr]=9;for(var nr=256;nr<280;++nr)Ny[nr]=7;for(var nr=280;nr<288;++nr)Ny[nr]=8;var CO=new rl(32);for(var nr=0;nr<32;++nr)CO[nr]=5;var VY=Bv(Ny,9,1),HY=Bv(CO,5,1),H1=function(i){for(var e=i[0],t=1;t<i.length;++t)i[t]>e&&(e=i[t]);return e},Ol=function(i,e,t){var n=e/8|0;return(i[n]|i[n+1]<<8)>>(e&7)&t},G1=function(i,e){var t=e/8|0;return(i[t]|i[t+1]<<8|i[t+2]<<16)>>(e&7)},GY=function(i){return(i/8|0)+(i&7&&1)},jY=function(i,e,t){(t==null||t>i.length)&&(t=i.length);var n=new(i instanceof nf?nf:i instanceof XT?XT:rl)(t-e);return n.set(i.subarray(e,t)),n},WY=function(i,e,t){var n=i.length;if(!n||t&&!t.l&&n<5)return e||new rl(0);var r=!e||t,s=!t||t.i;t||(t={}),e||(e=new rl(n*3));var o=function(ve){var Le=e.length;if(ve>Le){var lt=new rl(Math.max(Le*2,ve));lt.set(e),e=lt}},u=t.f||0,f=t.p||0,p=t.b||0,g=t.l,v=t.d,_=t.m,x=t.n,E=n*8;do{if(!g){t.f=u=Ol(i,f,1);var C=Ol(i,f+1,3);if(f+=3,C)if(C==1)g=VY,v=HY,_=9,x=5;else if(C==2){var L=Ol(i,f,31)+257,F=Ol(i,f+10,15)+4,G=L+Ol(i,f+5,31)+1;f+=14;for(var k=new rl(G),O=new rl(19),D=0;D<F;++D)O[UY[D]]=Ol(i,f+D*3,7);f+=F*3;for(var R=H1(O),P=(1<<R)-1,z=Bv(O,R,1),D=0;D<G;){var Y=z[Ol(i,f,P)];f+=Y&15;var w=Y>>>4;if(w<16)k[D++]=w;else{var j=0,ce=0;for(w==16?(ce=3+Ol(i,f,3),f+=2,j=k[D-1]):w==17?(ce=3+Ol(i,f,7),f+=3):w==18&&(ce=11+Ol(i,f,127),f+=7);ce--;)k[D++]=j}}var fe=k.subarray(0,L),te=k.subarray(L);_=H1(fe),x=H1(te),g=Bv(fe,_,1),v=Bv(te,x,1)}else throw"invalid block type";else{var w=GY(f)+4,T=i[w-4]|i[w-3]<<8,N=w+T;if(N>n){if(s)throw"unexpected EOF";break}r&&o(p+T),e.set(i.subarray(w,N),p),t.b=p+=T,t.p=f=N*8;continue}if(f>E){if(s)throw"unexpected EOF";break}}r&&o(p+131072);for(var se=(1<<_)-1,Ae=(1<<x)-1,Pe=f;;Pe=f){var j=g[G1(i,f)&se],Re=j>>>4;if(f+=j&15,f>E){if(s)throw"unexpected EOF";break}if(!j)throw"invalid length/literal";if(Re<256)e[p++]=Re;else if(Re==256){Pe=f,g=null;break}else{var $=Re-254;if(Re>264){var D=Re-257,ae=SO[D];$=Ol(i,f,(1<<ae)-1)+wO[D],f+=ae}var Se=v[G1(i,f)&Ae],ke=Se>>>4;if(!Se)throw"invalid distance";f+=Se&15;var te=zY[ke];if(ke>3){var ae=EO[ke];te+=G1(i,f)&(1<<ae)-1,f+=ae}if(f>E){if(s)throw"unexpected EOF";break}r&&o(p+131072);for(var dt=p+$;p<dt;p+=4)e[p]=e[p-te],e[p+1]=e[p+1-te],e[p+2]=e[p+2-te],e[p+3]=e[p+3-te];p=dt}}t.l=g,t.p=Pe,t.b=p,g&&(u=1,t.m=_,t.d=v,t.n=x)}while(!u);return p==e.length?e:jY(e,0,p)},qY=new rl(0),XY=function(i){if((i[0]&15)!=8||i[0]>>>4>7||(i[0]<<8|i[1])%31)throw"invalid zlib data";if(i[1]&32)throw"invalid zlib data: preset dictionaries not supported"};function Qx(i,e){return WY((XY(i),i.subarray(2,-4)),e)}var YY=typeof TextDecoder<"u"&&new TextDecoder,JY=0;try{YY.decode(qY,{stream:!0}),JY=1}catch{}const KY=i=>i&&i.isCubeTexture;class QY extends rr{constructor(e,t){var n,r;const s=KY(e),u=((r=s?(n=e.image[0])==null?void 0:n.width:e.image.width)!=null?r:1024)/4,f=Math.floor(Math.log2(u)),p=Math.pow(2,f),g=3*Math.max(p,112),v=4*p,_=[s?"#define ENVMAP_TYPE_CUBE":"",`#define CUBEUV_TEXEL_WIDTH ${1/g}`,`#define CUBEUV_TEXEL_HEIGHT ${1/v}`,`#define CUBEUV_MAX_MIP ${f}.0`],x=`
        varying vec3 vWorldPosition;
        void main() 
        {
            vec4 worldPosition = ( modelMatrix * vec4( position, 1.0 ) );
            vWorldPosition = worldPosition.xyz;
            
            gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
        }
        `,E=_.join(`
`)+`
        #define ENVMAP_TYPE_CUBE_UV
        varying vec3 vWorldPosition;
        uniform float radius;
        uniform float height;
        uniform float angle;
        #ifdef ENVMAP_TYPE_CUBE
            uniform samplerCube map;
        #else
            uniform sampler2D map;
        #endif
        // From: https://www.shadertoy.com/view/4tsBD7
        float diskIntersectWithBackFaceCulling( vec3 ro, vec3 rd, vec3 c, vec3 n, float r ) 
        {
            float d = dot ( rd, n );
            
            if( d > 0.0 ) { return 1e6; }
            
            vec3  o = ro - c;
            float t = - dot( n, o ) / d;
            vec3  q = o + rd * t;
            
            return ( dot( q, q ) < r * r ) ? t : 1e6;
        }
        // From: https://www.iquilezles.org/www/articles/intersectors/intersectors.htm
        float sphereIntersect( vec3 ro, vec3 rd, vec3 ce, float ra ) 
        {
            vec3 oc = ro - ce;
            float b = dot( oc, rd );
            float c = dot( oc, oc ) - ra * ra;
            float h = b * b - c;
            
            if( h < 0.0 ) { return -1.0; }
            
            h = sqrt( h );
            
            return - b + h;
        }
        vec3 project() 
        {
            vec3 p = normalize( vWorldPosition );
            vec3 camPos = cameraPosition;
            camPos.y -= height;
            float intersection = sphereIntersect( camPos, p, vec3( 0.0 ), radius );
            if( intersection > 0.0 ) {
                
                vec3 h = vec3( 0.0, - height, 0.0 );
                float intersection2 = diskIntersectWithBackFaceCulling( camPos, p, h, vec3( 0.0, 1.0, 0.0 ), radius );
                p = ( camPos + min( intersection, intersection2 ) * p ) / radius;
            } else {
                p = vec3( 0.0, 1.0, 0.0 );
            }
            return p;
        }
        #include <common>
        #include <cube_uv_reflection_fragment>
        void main() 
        {
            vec3 projectedWorldPosition = project();
            
            #ifdef ENVMAP_TYPE_CUBE
                vec3 outcolor = textureCube( map, projectedWorldPosition ).rgb;
            #else
                vec3 direction = normalize( projectedWorldPosition );
                vec2 uv = equirectUv( direction );
                vec3 outcolor = texture2D( map, uv ).rgb;
            #endif
            gl_FragColor = vec4( outcolor, 1.0 );
            #include <tonemapping_fragment>
            #include <${Kw>=154?"colorspace_fragment":"encodings_fragment"}>
        }
        `,C={map:{value:e},height:{value:(t==null?void 0:t.height)||15},radius:{value:(t==null?void 0:t.radius)||100}},w=new wy(1,16),T=new Gs({uniforms:C,fragmentShader:E,vertexShader:x,side:yo});super(w,T)}set radius(e){this.material.uniforms.radius.value=e}get radius(){return this.material.uniforms.radius.value}set height(e){this.material.uniforms.height.value=e}get height(){return this.material.uniforms.height.value}}var ZY=Object.defineProperty,$Y=(i,e,t)=>e in i?ZY(i,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):i[e]=t,eJ=(i,e,t)=>($Y(i,e+"",t),t);class tJ{constructor(){eJ(this,"_listeners")}addEventListener(e,t){this._listeners===void 0&&(this._listeners={});const n=this._listeners;n[e]===void 0&&(n[e]=[]),n[e].indexOf(t)===-1&&n[e].push(t)}hasEventListener(e,t){if(this._listeners===void 0)return!1;const n=this._listeners;return n[e]!==void 0&&n[e].indexOf(t)!==-1}removeEventListener(e,t){if(this._listeners===void 0)return;const r=this._listeners[e];if(r!==void 0){const s=r.indexOf(t);s!==-1&&r.splice(s,1)}}dispatchEvent(e){if(this._listeners===void 0)return;const n=this._listeners[e.type];if(n!==void 0){e.target=this;const r=n.slice(0);for(let s=0,o=r.length;s<o;s++)r[s].call(this,e);e.target=null}}}var nJ=Object.defineProperty,iJ=(i,e,t)=>e in i?nJ(i,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):i[e]=t,gn=(i,e,t)=>(iJ(i,typeof e!="symbol"?e+"":e,t),t);const Zx=new hp,SN=new Du,rJ=Math.cos(70*(Math.PI/180)),EN=(i,e)=>(i%e+e)%e;let sJ=class extends tJ{constructor(e,t){super(),gn(this,"object"),gn(this,"domElement"),gn(this,"enabled",!0),gn(this,"target",new ie),gn(this,"minDistance",0),gn(this,"maxDistance",1/0),gn(this,"minZoom",0),gn(this,"maxZoom",1/0),gn(this,"minPolarAngle",0),gn(this,"maxPolarAngle",Math.PI),gn(this,"minAzimuthAngle",-1/0),gn(this,"maxAzimuthAngle",1/0),gn(this,"enableDamping",!1),gn(this,"dampingFactor",.05),gn(this,"enableZoom",!0),gn(this,"zoomSpeed",1),gn(this,"enableRotate",!0),gn(this,"rotateSpeed",1),gn(this,"enablePan",!0),gn(this,"panSpeed",1),gn(this,"screenSpacePanning",!0),gn(this,"keyPanSpeed",7),gn(this,"zoomToCursor",!1),gn(this,"autoRotate",!1),gn(this,"autoRotateSpeed",2),gn(this,"reverseOrbit",!1),gn(this,"reverseHorizontalOrbit",!1),gn(this,"reverseVerticalOrbit",!1),gn(this,"keys",{LEFT:"ArrowLeft",UP:"ArrowUp",RIGHT:"ArrowRight",BOTTOM:"ArrowDown"}),gn(this,"mouseButtons",{LEFT:Md.ROTATE,MIDDLE:Md.DOLLY,RIGHT:Md.PAN}),gn(this,"touches",{ONE:wd.ROTATE,TWO:wd.DOLLY_PAN}),gn(this,"target0"),gn(this,"position0"),gn(this,"zoom0"),gn(this,"_domElementKeyEvents",null),gn(this,"getPolarAngle"),gn(this,"getAzimuthalAngle"),gn(this,"setPolarAngle"),gn(this,"setAzimuthalAngle"),gn(this,"getDistance"),gn(this,"getZoomScale"),gn(this,"listenToKeyEvents"),gn(this,"stopListenToKeyEvents"),gn(this,"saveState"),gn(this,"reset"),gn(this,"update"),gn(this,"connect"),gn(this,"dispose"),gn(this,"dollyIn"),gn(this,"dollyOut"),gn(this,"getScale"),gn(this,"setScale"),this.object=e,this.domElement=t,this.target0=this.target.clone(),this.position0=this.object.position.clone(),this.zoom0=this.object.zoom,this.getPolarAngle=()=>g.phi,this.getAzimuthalAngle=()=>g.theta,this.setPolarAngle=oe=>{let Te=EN(oe,2*Math.PI),ot=g.phi;ot<0&&(ot+=2*Math.PI),Te<0&&(Te+=2*Math.PI);let ue=Math.abs(Te-ot);2*Math.PI-ue<ue&&(Te<ot?Te+=2*Math.PI:ot+=2*Math.PI),v.phi=Te-ot,n.update()},this.setAzimuthalAngle=oe=>{let Te=EN(oe,2*Math.PI),ot=g.theta;ot<0&&(ot+=2*Math.PI),Te<0&&(Te+=2*Math.PI);let ue=Math.abs(Te-ot);2*Math.PI-ue<ue&&(Te<ot?Te+=2*Math.PI:ot+=2*Math.PI),v.theta=Te-ot,n.update()},this.getDistance=()=>n.object.position.distanceTo(n.target),this.listenToKeyEvents=oe=>{oe.addEventListener("keydown",Ue),this._domElementKeyEvents=oe},this.stopListenToKeyEvents=()=>{this._domElementKeyEvents.removeEventListener("keydown",Ue),this._domElementKeyEvents=null},this.saveState=()=>{n.target0.copy(n.target),n.position0.copy(n.object.position),n.zoom0=n.object.zoom},this.reset=()=>{n.target.copy(n.target0),n.object.position.copy(n.position0),n.object.zoom=n.zoom0,n.object.updateProjectionMatrix(),n.dispatchEvent(r),n.update(),f=u.NONE},this.update=(()=>{const oe=new ie,Te=new ie(0,1,0),ot=new ys().setFromUnitVectors(e.up,Te),ue=ot.clone().invert(),Ce=new ie,at=new ys,gt=2*Math.PI;return function(){const Ye=n.object.position;ot.setFromUnitVectors(e.up,Te),ue.copy(ot).invert(),oe.copy(Ye).sub(n.target),oe.applyQuaternion(ot),g.setFromVector3(oe),n.autoRotate&&f===u.NONE&&ce(Y()),n.enableDamping?(g.theta+=v.theta*n.dampingFactor,g.phi+=v.phi*n.dampingFactor):(g.theta+=v.theta,g.phi+=v.phi);let pt=n.minAzimuthAngle,rn=n.maxAzimuthAngle;isFinite(pt)&&isFinite(rn)&&(pt<-Math.PI?pt+=gt:pt>Math.PI&&(pt-=gt),rn<-Math.PI?rn+=gt:rn>Math.PI&&(rn-=gt),pt<=rn?g.theta=Math.max(pt,Math.min(rn,g.theta)):g.theta=g.theta>(pt+rn)/2?Math.max(pt,g.theta):Math.min(rn,g.theta)),g.phi=Math.max(n.minPolarAngle,Math.min(n.maxPolarAngle,g.phi)),g.makeSafe(),n.enableDamping===!0?n.target.addScaledVector(x,n.dampingFactor):n.target.add(x),n.zoomToCursor&&R||n.object.isOrthographicCamera?g.radius=Se(g.radius):g.radius=Se(g.radius*_),oe.setFromSpherical(g),oe.applyQuaternion(ue),Ye.copy(n.target).add(oe),n.object.matrixAutoUpdate||n.object.updateMatrix(),n.object.lookAt(n.target),n.enableDamping===!0?(v.theta*=1-n.dampingFactor,v.phi*=1-n.dampingFactor,x.multiplyScalar(1-n.dampingFactor)):(v.set(0,0,0),x.set(0,0,0));let Tn=!1;if(n.zoomToCursor&&R){let yn=null;if(n.object instanceof hr&&n.object.isPerspectiveCamera){const Ii=oe.length();yn=Se(Ii*_);const Xi=Ii-yn;n.object.position.addScaledVector(O,Xi),n.object.updateMatrixWorld()}else if(n.object.isOrthographicCamera){const Ii=new ie(D.x,D.y,0);Ii.unproject(n.object),n.object.zoom=Math.max(n.minZoom,Math.min(n.maxZoom,n.object.zoom/_)),n.object.updateProjectionMatrix(),Tn=!0;const Xi=new ie(D.x,D.y,0);Xi.unproject(n.object),n.object.position.sub(Xi).add(Ii),n.object.updateMatrixWorld(),yn=oe.length()}else console.warn("WARNING: OrbitControls.js encountered an unknown camera type - zoom to cursor disabled."),n.zoomToCursor=!1;yn!==null&&(n.screenSpacePanning?n.target.set(0,0,-1).transformDirection(n.object.matrix).multiplyScalar(yn).add(n.object.position):(Zx.origin.copy(n.object.position),Zx.direction.set(0,0,-1).transformDirection(n.object.matrix),Math.abs(n.object.up.dot(Zx.direction))<rJ?e.lookAt(n.target):(SN.setFromNormalAndCoplanarPoint(n.object.up,n.target),Zx.intersectPlane(SN,n.target))))}else n.object instanceof Ao&&n.object.isOrthographicCamera&&(Tn=_!==1,Tn&&(n.object.zoom=Math.max(n.minZoom,Math.min(n.maxZoom,n.object.zoom/_)),n.object.updateProjectionMatrix()));return _=1,R=!1,Tn||Ce.distanceToSquared(n.object.position)>p||8*(1-at.dot(n.object.quaternion))>p?(n.dispatchEvent(r),Ce.copy(n.object.position),at.copy(n.object.quaternion),Tn=!1,!0):!1}})(),this.connect=oe=>{n.domElement=oe,n.domElement.style.touchAction="none",n.domElement.addEventListener("contextmenu",Xt),n.domElement.addEventListener("pointerdown",bt),n.domElement.addEventListener("pointercancel",q),n.domElement.addEventListener("wheel",Xe)},this.dispose=()=>{var oe,Te,ot,ue,Ce,at;n.domElement&&(n.domElement.style.touchAction="auto"),(oe=n.domElement)==null||oe.removeEventListener("contextmenu",Xt),(Te=n.domElement)==null||Te.removeEventListener("pointerdown",bt),(ot=n.domElement)==null||ot.removeEventListener("pointercancel",q),(ue=n.domElement)==null||ue.removeEventListener("wheel",Xe),(Ce=n.domElement)==null||Ce.ownerDocument.removeEventListener("pointermove",ee),(at=n.domElement)==null||at.ownerDocument.removeEventListener("pointerup",q),n._domElementKeyEvents!==null&&n._domElementKeyEvents.removeEventListener("keydown",Ue)};const n=this,r={type:"change"},s={type:"start"},o={type:"end"},u={NONE:-1,ROTATE:0,DOLLY:1,PAN:2,TOUCH_ROTATE:3,TOUCH_PAN:4,TOUCH_DOLLY_PAN:5,TOUCH_DOLLY_ROTATE:6};let f=u.NONE;const p=1e-6,g=new LT,v=new LT;let _=1;const x=new ie,E=new $e,C=new $e,w=new $e,T=new $e,N=new $e,L=new $e,F=new $e,G=new $e,k=new $e,O=new ie,D=new $e;let R=!1;const P=[],z={};function Y(){return 2*Math.PI/60/60*n.autoRotateSpeed}function j(){return Math.pow(.95,n.zoomSpeed)}function ce(oe){n.reverseOrbit||n.reverseHorizontalOrbit?v.theta+=oe:v.theta-=oe}function fe(oe){n.reverseOrbit||n.reverseVerticalOrbit?v.phi+=oe:v.phi-=oe}const te=(()=>{const oe=new ie;return function(ot,ue){oe.setFromMatrixColumn(ue,0),oe.multiplyScalar(-ot),x.add(oe)}})(),se=(()=>{const oe=new ie;return function(ot,ue){n.screenSpacePanning===!0?oe.setFromMatrixColumn(ue,1):(oe.setFromMatrixColumn(ue,0),oe.crossVectors(n.object.up,oe)),oe.multiplyScalar(ot),x.add(oe)}})(),Ae=(()=>{const oe=new ie;return function(ot,ue){const Ce=n.domElement;if(Ce&&n.object instanceof hr&&n.object.isPerspectiveCamera){const at=n.object.position;oe.copy(at).sub(n.target);let gt=oe.length();gt*=Math.tan(n.object.fov/2*Math.PI/180),te(2*ot*gt/Ce.clientHeight,n.object.matrix),se(2*ue*gt/Ce.clientHeight,n.object.matrix)}else Ce&&n.object instanceof Ao&&n.object.isOrthographicCamera?(te(ot*(n.object.right-n.object.left)/n.object.zoom/Ce.clientWidth,n.object.matrix),se(ue*(n.object.top-n.object.bottom)/n.object.zoom/Ce.clientHeight,n.object.matrix)):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - pan disabled."),n.enablePan=!1)}})();function Pe(oe){n.object instanceof hr&&n.object.isPerspectiveCamera||n.object instanceof Ao&&n.object.isOrthographicCamera?_=oe:(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),n.enableZoom=!1)}function Re(oe){Pe(_/oe)}function $(oe){Pe(_*oe)}function ae(oe){if(!n.zoomToCursor||!n.domElement)return;R=!0;const Te=n.domElement.getBoundingClientRect(),ot=oe.clientX-Te.left,ue=oe.clientY-Te.top,Ce=Te.width,at=Te.height;D.x=ot/Ce*2-1,D.y=-(ue/at)*2+1,O.set(D.x,D.y,1).unproject(n.object).sub(n.object.position).normalize()}function Se(oe){return Math.max(n.minDistance,Math.min(n.maxDistance,oe))}function ke(oe){E.set(oe.clientX,oe.clientY)}function dt(oe){ae(oe),F.set(oe.clientX,oe.clientY)}function ve(oe){T.set(oe.clientX,oe.clientY)}function Le(oe){C.set(oe.clientX,oe.clientY),w.subVectors(C,E).multiplyScalar(n.rotateSpeed);const Te=n.domElement;Te&&(ce(2*Math.PI*w.x/Te.clientHeight),fe(2*Math.PI*w.y/Te.clientHeight)),E.copy(C),n.update()}function lt(oe){G.set(oe.clientX,oe.clientY),k.subVectors(G,F),k.y>0?Re(j()):k.y<0&&$(j()),F.copy(G),n.update()}function _t(oe){N.set(oe.clientX,oe.clientY),L.subVectors(N,T).multiplyScalar(n.panSpeed),Ae(L.x,L.y),T.copy(N),n.update()}function Dt(oe){ae(oe),oe.deltaY<0?$(j()):oe.deltaY>0&&Re(j()),n.update()}function qt(oe){let Te=!1;switch(oe.code){case n.keys.UP:Ae(0,n.keyPanSpeed),Te=!0;break;case n.keys.BOTTOM:Ae(0,-n.keyPanSpeed),Te=!0;break;case n.keys.LEFT:Ae(n.keyPanSpeed,0),Te=!0;break;case n.keys.RIGHT:Ae(-n.keyPanSpeed,0),Te=!0;break}Te&&(oe.preventDefault(),n.update())}function un(){if(P.length==1)E.set(P[0].pageX,P[0].pageY);else{const oe=.5*(P[0].pageX+P[1].pageX),Te=.5*(P[0].pageY+P[1].pageY);E.set(oe,Te)}}function Yt(){if(P.length==1)T.set(P[0].pageX,P[0].pageY);else{const oe=.5*(P[0].pageX+P[1].pageX),Te=.5*(P[0].pageY+P[1].pageY);T.set(oe,Te)}}function qe(){const oe=P[0].pageX-P[1].pageX,Te=P[0].pageY-P[1].pageY,ot=Math.sqrt(oe*oe+Te*Te);F.set(0,ot)}function rt(){n.enableZoom&&qe(),n.enablePan&&Yt()}function Je(){n.enableZoom&&qe(),n.enableRotate&&un()}function xt(oe){if(P.length==1)C.set(oe.pageX,oe.pageY);else{const ot=Ut(oe),ue=.5*(oe.pageX+ot.x),Ce=.5*(oe.pageY+ot.y);C.set(ue,Ce)}w.subVectors(C,E).multiplyScalar(n.rotateSpeed);const Te=n.domElement;Te&&(ce(2*Math.PI*w.x/Te.clientHeight),fe(2*Math.PI*w.y/Te.clientHeight)),E.copy(C)}function re(oe){if(P.length==1)N.set(oe.pageX,oe.pageY);else{const Te=Ut(oe),ot=.5*(oe.pageX+Te.x),ue=.5*(oe.pageY+Te.y);N.set(ot,ue)}L.subVectors(N,T).multiplyScalar(n.panSpeed),Ae(L.x,L.y),T.copy(N)}function Lt(oe){const Te=Ut(oe),ot=oe.pageX-Te.x,ue=oe.pageY-Te.y,Ce=Math.sqrt(ot*ot+ue*ue);G.set(0,Ce),k.set(0,Math.pow(G.y/F.y,n.zoomSpeed)),Re(k.y),F.copy(G)}function vt(oe){n.enableZoom&&Lt(oe),n.enablePan&&re(oe)}function Qt(oe){n.enableZoom&&Lt(oe),n.enableRotate&&xt(oe)}function bt(oe){var Te,ot;n.enabled!==!1&&(P.length===0&&((Te=n.domElement)==null||Te.ownerDocument.addEventListener("pointermove",ee),(ot=n.domElement)==null||ot.ownerDocument.addEventListener("pointerup",q)),an(oe),oe.pointerType==="touch"?Ft(oe):ge(oe))}function ee(oe){n.enabled!==!1&&(oe.pointerType==="touch"?Ct(oe):Fe(oe))}function q(oe){var Te,ot,ue;tt(oe),P.length===0&&((Te=n.domElement)==null||Te.releasePointerCapture(oe.pointerId),(ot=n.domElement)==null||ot.ownerDocument.removeEventListener("pointermove",ee),(ue=n.domElement)==null||ue.ownerDocument.removeEventListener("pointerup",q)),n.dispatchEvent(o),f=u.NONE}function ge(oe){let Te;switch(oe.button){case 0:Te=n.mouseButtons.LEFT;break;case 1:Te=n.mouseButtons.MIDDLE;break;case 2:Te=n.mouseButtons.RIGHT;break;default:Te=-1}switch(Te){case Md.DOLLY:if(n.enableZoom===!1)return;dt(oe),f=u.DOLLY;break;case Md.ROTATE:if(oe.ctrlKey||oe.metaKey||oe.shiftKey){if(n.enablePan===!1)return;ve(oe),f=u.PAN}else{if(n.enableRotate===!1)return;ke(oe),f=u.ROTATE}break;case Md.PAN:if(oe.ctrlKey||oe.metaKey||oe.shiftKey){if(n.enableRotate===!1)return;ke(oe),f=u.ROTATE}else{if(n.enablePan===!1)return;ve(oe),f=u.PAN}break;default:f=u.NONE}f!==u.NONE&&n.dispatchEvent(s)}function Fe(oe){if(n.enabled!==!1)switch(f){case u.ROTATE:if(n.enableRotate===!1)return;Le(oe);break;case u.DOLLY:if(n.enableZoom===!1)return;lt(oe);break;case u.PAN:if(n.enablePan===!1)return;_t(oe);break}}function Xe(oe){n.enabled===!1||n.enableZoom===!1||f!==u.NONE&&f!==u.ROTATE||(oe.preventDefault(),n.dispatchEvent(s),Dt(oe),n.dispatchEvent(o))}function Ue(oe){n.enabled===!1||n.enablePan===!1||qt(oe)}function Ft(oe){switch(it(oe),P.length){case 1:switch(n.touches.ONE){case wd.ROTATE:if(n.enableRotate===!1)return;un(),f=u.TOUCH_ROTATE;break;case wd.PAN:if(n.enablePan===!1)return;Yt(),f=u.TOUCH_PAN;break;default:f=u.NONE}break;case 2:switch(n.touches.TWO){case wd.DOLLY_PAN:if(n.enableZoom===!1&&n.enablePan===!1)return;rt(),f=u.TOUCH_DOLLY_PAN;break;case wd.DOLLY_ROTATE:if(n.enableZoom===!1&&n.enableRotate===!1)return;Je(),f=u.TOUCH_DOLLY_ROTATE;break;default:f=u.NONE}break;default:f=u.NONE}f!==u.NONE&&n.dispatchEvent(s)}function Ct(oe){switch(it(oe),f){case u.TOUCH_ROTATE:if(n.enableRotate===!1)return;xt(oe),n.update();break;case u.TOUCH_PAN:if(n.enablePan===!1)return;re(oe),n.update();break;case u.TOUCH_DOLLY_PAN:if(n.enableZoom===!1&&n.enablePan===!1)return;vt(oe),n.update();break;case u.TOUCH_DOLLY_ROTATE:if(n.enableZoom===!1&&n.enableRotate===!1)return;Qt(oe),n.update();break;default:f=u.NONE}}function Xt(oe){n.enabled!==!1&&oe.preventDefault()}function an(oe){P.push(oe)}function tt(oe){delete z[oe.pointerId];for(let Te=0;Te<P.length;Te++)if(P[Te].pointerId==oe.pointerId){P.splice(Te,1);return}}function it(oe){let Te=z[oe.pointerId];Te===void 0&&(Te=new $e,z[oe.pointerId]=Te),Te.set(oe.pageX,oe.pageY)}function Ut(oe){const Te=oe.pointerId===P[0].pointerId?P[1]:P[0];return z[Te.pointerId]}this.dollyIn=(oe=j())=>{$(oe),n.update()},this.dollyOut=(oe=j())=>{Re(oe),n.update()},this.getScale=()=>_,this.setScale=oe=>{Pe(oe),n.update()},this.getZoomScale=()=>j(),t!==void 0&&this.connect(t),this.update()}};function BA(i){if(typeof TextDecoder<"u")return new TextDecoder().decode(i);let e="";for(let t=0,n=i.length;t<n;t++)e+=String.fromCharCode(i[t]);try{return decodeURIComponent(escape(e))}catch{return e}}const kd="srgb",ku="srgb-linear",TN=3001,aJ=3e3;class Qw extends js{constructor(e){super(e),this.dracoLoader=null,this.ktx2Loader=null,this.meshoptDecoder=null,this.pluginCallbacks=[],this.register(function(t){return new hJ(t)}),this.register(function(t){return new fJ(t)}),this.register(function(t){return new bJ(t)}),this.register(function(t){return new AJ(t)}),this.register(function(t){return new SJ(t)}),this.register(function(t){return new pJ(t)}),this.register(function(t){return new mJ(t)}),this.register(function(t){return new gJ(t)}),this.register(function(t){return new vJ(t)}),this.register(function(t){return new uJ(t)}),this.register(function(t){return new yJ(t)}),this.register(function(t){return new dJ(t)}),this.register(function(t){return new xJ(t)}),this.register(function(t){return new _J(t)}),this.register(function(t){return new lJ(t)}),this.register(function(t){return new EJ(t)}),this.register(function(t){return new TJ(t)})}load(e,t,n,r){const s=this;let o;if(this.resourcePath!=="")o=this.resourcePath;else if(this.path!==""){const p=uf.extractUrlBase(e);o=uf.resolveURL(p,this.path)}else o=uf.extractUrlBase(e);this.manager.itemStart(e);const u=function(p){r?r(p):console.error(p),s.manager.itemError(e),s.manager.itemEnd(e)},f=new zs(this.manager);f.setPath(this.path),f.setResponseType("arraybuffer"),f.setRequestHeader(this.requestHeader),f.setWithCredentials(this.withCredentials),f.load(e,function(p){try{s.parse(p,o,function(g){t(g),s.manager.itemEnd(e)},u)}catch(g){u(g)}},n,u)}setDRACOLoader(e){return this.dracoLoader=e,this}setDDSLoader(){throw new Error('THREE.GLTFLoader: "MSFT_texture_dds" no longer supported. Please update to "KHR_texture_basisu".')}setKTX2Loader(e){return this.ktx2Loader=e,this}setMeshoptDecoder(e){return this.meshoptDecoder=e,this}register(e){return this.pluginCallbacks.indexOf(e)===-1&&this.pluginCallbacks.push(e),this}unregister(e){return this.pluginCallbacks.indexOf(e)!==-1&&this.pluginCallbacks.splice(this.pluginCallbacks.indexOf(e),1),this}parse(e,t,n,r){let s;const o={},u={};if(typeof e=="string")s=JSON.parse(e);else if(e instanceof ArrayBuffer)if(BA(new Uint8Array(e.slice(0,4)))===RO){try{o[ii.KHR_BINARY_GLTF]=new MJ(e)}catch(g){r&&r(g);return}s=JSON.parse(o[ii.KHR_BINARY_GLTF].content)}else s=JSON.parse(BA(new Uint8Array(e)));else s=e;if(s.asset===void 0||s.asset.version[0]<2){r&&r(new Error("THREE.GLTFLoader: Unsupported asset. glTF versions >=2.0 are supported."));return}const f=new kJ(s,{path:t||this.resourcePath||"",crossOrigin:this.crossOrigin,requestHeader:this.requestHeader,manager:this.manager,ktx2Loader:this.ktx2Loader,meshoptDecoder:this.meshoptDecoder});f.fileLoader.setRequestHeader(this.requestHeader);for(let p=0;p<this.pluginCallbacks.length;p++){const g=this.pluginCallbacks[p](f);g.name||console.error("THREE.GLTFLoader: Invalid plugin found: missing name"),u[g.name]=g,o[g.name]=!0}if(s.extensionsUsed)for(let p=0;p<s.extensionsUsed.length;++p){const g=s.extensionsUsed[p],v=s.extensionsRequired||[];switch(g){case ii.KHR_MATERIALS_UNLIT:o[g]=new cJ;break;case ii.KHR_DRACO_MESH_COMPRESSION:o[g]=new wJ(s,this.dracoLoader);break;case ii.KHR_TEXTURE_TRANSFORM:o[g]=new CJ;break;case ii.KHR_MESH_QUANTIZATION:o[g]=new RJ;break;default:v.indexOf(g)>=0&&u[g]===void 0&&console.warn('THREE.GLTFLoader: Unknown extension "'+g+'".')}}f.setExtensions(o),f.setPlugins(u),f.parse(n,r)}parseAsync(e,t){const n=this;return new Promise(function(r,s){n.parse(e,t,r,s)})}}function oJ(){let i={};return{get:function(e){return i[e]},add:function(e,t){i[e]=t},remove:function(e){delete i[e]},removeAll:function(){i={}}}}const ii={KHR_BINARY_GLTF:"KHR_binary_glTF",KHR_DRACO_MESH_COMPRESSION:"KHR_draco_mesh_compression",KHR_LIGHTS_PUNCTUAL:"KHR_lights_punctual",KHR_MATERIALS_CLEARCOAT:"KHR_materials_clearcoat",KHR_MATERIALS_DISPERSION:"KHR_materials_dispersion",KHR_MATERIALS_IOR:"KHR_materials_ior",KHR_MATERIALS_SHEEN:"KHR_materials_sheen",KHR_MATERIALS_SPECULAR:"KHR_materials_specular",KHR_MATERIALS_TRANSMISSION:"KHR_materials_transmission",KHR_MATERIALS_IRIDESCENCE:"KHR_materials_iridescence",KHR_MATERIALS_ANISOTROPY:"KHR_materials_anisotropy",KHR_MATERIALS_UNLIT:"KHR_materials_unlit",KHR_MATERIALS_VOLUME:"KHR_materials_volume",KHR_TEXTURE_BASISU:"KHR_texture_basisu",KHR_TEXTURE_TRANSFORM:"KHR_texture_transform",KHR_MESH_QUANTIZATION:"KHR_mesh_quantization",KHR_MATERIALS_EMISSIVE_STRENGTH:"KHR_materials_emissive_strength",EXT_MATERIALS_BUMP:"EXT_materials_bump",EXT_TEXTURE_WEBP:"EXT_texture_webp",EXT_TEXTURE_AVIF:"EXT_texture_avif",EXT_MESHOPT_COMPRESSION:"EXT_meshopt_compression",EXT_MESH_GPU_INSTANCING:"EXT_mesh_gpu_instancing"};class lJ{constructor(e){this.parser=e,this.name=ii.KHR_LIGHTS_PUNCTUAL,this.cache={refs:{},uses:{}}}_markDefs(){const e=this.parser,t=this.parser.json.nodes||[];for(let n=0,r=t.length;n<r;n++){const s=t[n];s.extensions&&s.extensions[this.name]&&s.extensions[this.name].light!==void 0&&e._addNodeRef(this.cache,s.extensions[this.name].light)}}_loadLight(e){const t=this.parser,n="light:"+e;let r=t.cache.get(n);if(r)return r;const s=t.json,f=((s.extensions&&s.extensions[this.name]||{}).lights||[])[e];let p;const g=new Gt(16777215);f.color!==void 0&&g.setRGB(f.color[0],f.color[1],f.color[2],ku);const v=f.range!==void 0?f.range:0;switch(f.type){case"directional":p=new Pw(g),p.target.position.set(0,0,-1),p.add(p.target);break;case"point":p=new Nw(g),p.distance=v;break;case"spot":p=new Dw(g),p.distance=v,f.spot=f.spot||{},f.spot.innerConeAngle=f.spot.innerConeAngle!==void 0?f.spot.innerConeAngle:0,f.spot.outerConeAngle=f.spot.outerConeAngle!==void 0?f.spot.outerConeAngle:Math.PI/4,p.angle=f.spot.outerConeAngle,p.penumbra=1-f.spot.innerConeAngle/f.spot.outerConeAngle,p.target.position.set(0,0,-1),p.add(p.target);break;default:throw new Error("THREE.GLTFLoader: Unexpected light type: "+f.type)}return p.position.set(0,0,0),p.decay=2,Iu(p,f),f.intensity!==void 0&&(p.intensity=f.intensity),p.name=t.createUniqueName(f.name||"light_"+e),r=Promise.resolve(p),t.cache.add(n,r),r}getDependency(e,t){if(e==="light")return this._loadLight(t)}createNodeAttachment(e){const t=this,n=this.parser,s=n.json.nodes[e],u=(s.extensions&&s.extensions[this.name]||{}).light;return u===void 0?null:this._loadLight(u).then(function(f){return n._getNodeRef(t.cache,u,f)})}}class cJ{constructor(){this.name=ii.KHR_MATERIALS_UNLIT}getMaterialType(){return to}extendParams(e,t,n){const r=[];e.color=new Gt(1,1,1),e.opacity=1;const s=t.pbrMetallicRoughness;if(s){if(Array.isArray(s.baseColorFactor)){const o=s.baseColorFactor;e.color.setRGB(o[0],o[1],o[2],ku),e.opacity=o[3]}s.baseColorTexture!==void 0&&r.push(n.assignTexture(e,"map",s.baseColorTexture,kd))}return Promise.all(r)}}class uJ{constructor(e){this.parser=e,this.name=ii.KHR_MATERIALS_EMISSIVE_STRENGTH}extendMaterialParams(e,t){const r=this.parser.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const s=r.extensions[this.name].emissiveStrength;return s!==void 0&&(t.emissiveIntensity=s),Promise.resolve()}}class hJ{constructor(e){this.parser=e,this.name=ii.KHR_MATERIALS_CLEARCOAT}getMaterialType(e){const n=this.parser.json.materials[e];return!n.extensions||!n.extensions[this.name]?null:cl}extendMaterialParams(e,t){const n=this.parser,r=n.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const s=[],o=r.extensions[this.name];if(o.clearcoatFactor!==void 0&&(t.clearcoat=o.clearcoatFactor),o.clearcoatTexture!==void 0&&s.push(n.assignTexture(t,"clearcoatMap",o.clearcoatTexture)),o.clearcoatRoughnessFactor!==void 0&&(t.clearcoatRoughness=o.clearcoatRoughnessFactor),o.clearcoatRoughnessTexture!==void 0&&s.push(n.assignTexture(t,"clearcoatRoughnessMap",o.clearcoatRoughnessTexture)),o.clearcoatNormalTexture!==void 0&&(s.push(n.assignTexture(t,"clearcoatNormalMap",o.clearcoatNormalTexture)),o.clearcoatNormalTexture.scale!==void 0)){const u=o.clearcoatNormalTexture.scale;t.clearcoatNormalScale=new $e(u,u)}return Promise.all(s)}}class fJ{constructor(e){this.parser=e,this.name=ii.KHR_MATERIALS_DISPERSION}getMaterialType(e){const n=this.parser.json.materials[e];return!n.extensions||!n.extensions[this.name]?null:cl}extendMaterialParams(e,t){const r=this.parser.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const s=r.extensions[this.name];return t.dispersion=s.dispersion!==void 0?s.dispersion:0,Promise.resolve()}}class dJ{constructor(e){this.parser=e,this.name=ii.KHR_MATERIALS_IRIDESCENCE}getMaterialType(e){const n=this.parser.json.materials[e];return!n.extensions||!n.extensions[this.name]?null:cl}extendMaterialParams(e,t){const n=this.parser,r=n.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const s=[],o=r.extensions[this.name];return o.iridescenceFactor!==void 0&&(t.iridescence=o.iridescenceFactor),o.iridescenceTexture!==void 0&&s.push(n.assignTexture(t,"iridescenceMap",o.iridescenceTexture)),o.iridescenceIor!==void 0&&(t.iridescenceIOR=o.iridescenceIor),t.iridescenceThicknessRange===void 0&&(t.iridescenceThicknessRange=[100,400]),o.iridescenceThicknessMinimum!==void 0&&(t.iridescenceThicknessRange[0]=o.iridescenceThicknessMinimum),o.iridescenceThicknessMaximum!==void 0&&(t.iridescenceThicknessRange[1]=o.iridescenceThicknessMaximum),o.iridescenceThicknessTexture!==void 0&&s.push(n.assignTexture(t,"iridescenceThicknessMap",o.iridescenceThicknessTexture)),Promise.all(s)}}class pJ{constructor(e){this.parser=e,this.name=ii.KHR_MATERIALS_SHEEN}getMaterialType(e){const n=this.parser.json.materials[e];return!n.extensions||!n.extensions[this.name]?null:cl}extendMaterialParams(e,t){const n=this.parser,r=n.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const s=[];t.sheenColor=new Gt(0,0,0),t.sheenRoughness=0,t.sheen=1;const o=r.extensions[this.name];if(o.sheenColorFactor!==void 0){const u=o.sheenColorFactor;t.sheenColor.setRGB(u[0],u[1],u[2],ku)}return o.sheenRoughnessFactor!==void 0&&(t.sheenRoughness=o.sheenRoughnessFactor),o.sheenColorTexture!==void 0&&s.push(n.assignTexture(t,"sheenColorMap",o.sheenColorTexture,kd)),o.sheenRoughnessTexture!==void 0&&s.push(n.assignTexture(t,"sheenRoughnessMap",o.sheenRoughnessTexture)),Promise.all(s)}}class mJ{constructor(e){this.parser=e,this.name=ii.KHR_MATERIALS_TRANSMISSION}getMaterialType(e){const n=this.parser.json.materials[e];return!n.extensions||!n.extensions[this.name]?null:cl}extendMaterialParams(e,t){const n=this.parser,r=n.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const s=[],o=r.extensions[this.name];return o.transmissionFactor!==void 0&&(t.transmission=o.transmissionFactor),o.transmissionTexture!==void 0&&s.push(n.assignTexture(t,"transmissionMap",o.transmissionTexture)),Promise.all(s)}}class gJ{constructor(e){this.parser=e,this.name=ii.KHR_MATERIALS_VOLUME}getMaterialType(e){const n=this.parser.json.materials[e];return!n.extensions||!n.extensions[this.name]?null:cl}extendMaterialParams(e,t){const n=this.parser,r=n.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const s=[],o=r.extensions[this.name];t.thickness=o.thicknessFactor!==void 0?o.thicknessFactor:0,o.thicknessTexture!==void 0&&s.push(n.assignTexture(t,"thicknessMap",o.thicknessTexture)),t.attenuationDistance=o.attenuationDistance||1/0;const u=o.attenuationColor||[1,1,1];return t.attenuationColor=new Gt().setRGB(u[0],u[1],u[2],ku),Promise.all(s)}}class vJ{constructor(e){this.parser=e,this.name=ii.KHR_MATERIALS_IOR}getMaterialType(e){const n=this.parser.json.materials[e];return!n.extensions||!n.extensions[this.name]?null:cl}extendMaterialParams(e,t){const r=this.parser.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const s=r.extensions[this.name];return t.ior=s.ior!==void 0?s.ior:1.5,Promise.resolve()}}class yJ{constructor(e){this.parser=e,this.name=ii.KHR_MATERIALS_SPECULAR}getMaterialType(e){const n=this.parser.json.materials[e];return!n.extensions||!n.extensions[this.name]?null:cl}extendMaterialParams(e,t){const n=this.parser,r=n.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const s=[],o=r.extensions[this.name];t.specularIntensity=o.specularFactor!==void 0?o.specularFactor:1,o.specularTexture!==void 0&&s.push(n.assignTexture(t,"specularIntensityMap",o.specularTexture));const u=o.specularColorFactor||[1,1,1];return t.specularColor=new Gt().setRGB(u[0],u[1],u[2],ku),o.specularColorTexture!==void 0&&s.push(n.assignTexture(t,"specularColorMap",o.specularColorTexture,kd)),Promise.all(s)}}class _J{constructor(e){this.parser=e,this.name=ii.EXT_MATERIALS_BUMP}getMaterialType(e){const n=this.parser.json.materials[e];return!n.extensions||!n.extensions[this.name]?null:cl}extendMaterialParams(e,t){const n=this.parser,r=n.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const s=[],o=r.extensions[this.name];return t.bumpScale=o.bumpFactor!==void 0?o.bumpFactor:1,o.bumpTexture!==void 0&&s.push(n.assignTexture(t,"bumpMap",o.bumpTexture)),Promise.all(s)}}class xJ{constructor(e){this.parser=e,this.name=ii.KHR_MATERIALS_ANISOTROPY}getMaterialType(e){const n=this.parser.json.materials[e];return!n.extensions||!n.extensions[this.name]?null:cl}extendMaterialParams(e,t){const n=this.parser,r=n.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const s=[],o=r.extensions[this.name];return o.anisotropyStrength!==void 0&&(t.anisotropy=o.anisotropyStrength),o.anisotropyRotation!==void 0&&(t.anisotropyRotation=o.anisotropyRotation),o.anisotropyTexture!==void 0&&s.push(n.assignTexture(t,"anisotropyMap",o.anisotropyTexture)),Promise.all(s)}}class bJ{constructor(e){this.parser=e,this.name=ii.KHR_TEXTURE_BASISU}loadTexture(e){const t=this.parser,n=t.json,r=n.textures[e];if(!r.extensions||!r.extensions[this.name])return null;const s=r.extensions[this.name],o=t.options.ktx2Loader;if(!o){if(n.extensionsRequired&&n.extensionsRequired.indexOf(this.name)>=0)throw new Error("THREE.GLTFLoader: setKTX2Loader must be called before loading KTX2 textures");return null}return t.loadTextureImage(e,s.source,o)}}class AJ{constructor(e){this.parser=e,this.name=ii.EXT_TEXTURE_WEBP,this.isSupported=null}loadTexture(e){const t=this.name,n=this.parser,r=n.json,s=r.textures[e];if(!s.extensions||!s.extensions[t])return null;const o=s.extensions[t],u=r.images[o.source];let f=n.textureLoader;if(u.uri){const p=n.options.manager.getHandler(u.uri);p!==null&&(f=p)}return this.detectSupport().then(function(p){if(p)return n.loadTextureImage(e,o.source,f);if(r.extensionsRequired&&r.extensionsRequired.indexOf(t)>=0)throw new Error("THREE.GLTFLoader: WebP required by asset but unsupported.");return n.loadTexture(e)})}detectSupport(){return this.isSupported||(this.isSupported=new Promise(function(e){const t=new Image;t.src="data:image/webp;base64,UklGRiIAAABXRUJQVlA4IBYAAAAwAQCdASoBAAEADsD+JaQAA3AAAAAA",t.onload=t.onerror=function(){e(t.height===1)}})),this.isSupported}}class SJ{constructor(e){this.parser=e,this.name=ii.EXT_TEXTURE_AVIF,this.isSupported=null}loadTexture(e){const t=this.name,n=this.parser,r=n.json,s=r.textures[e];if(!s.extensions||!s.extensions[t])return null;const o=s.extensions[t],u=r.images[o.source];let f=n.textureLoader;if(u.uri){const p=n.options.manager.getHandler(u.uri);p!==null&&(f=p)}return this.detectSupport().then(function(p){if(p)return n.loadTextureImage(e,o.source,f);if(r.extensionsRequired&&r.extensionsRequired.indexOf(t)>=0)throw new Error("THREE.GLTFLoader: AVIF required by asset but unsupported.");return n.loadTexture(e)})}detectSupport(){return this.isSupported||(this.isSupported=new Promise(function(e){const t=new Image;t.src="data:image/avif;base64,AAAAIGZ0eXBhdmlmAAAAAGF2aWZtaWYxbWlhZk1BMUIAAADybWV0YQAAAAAAAAAoaGRscgAAAAAAAAAAcGljdAAAAAAAAAAAAAAAAGxpYmF2aWYAAAAADnBpdG0AAAAAAAEAAAAeaWxvYwAAAABEAAABAAEAAAABAAABGgAAABcAAAAoaWluZgAAAAAAAQAAABppbmZlAgAAAAABAABhdjAxQ29sb3IAAAAAamlwcnAAAABLaXBjbwAAABRpc3BlAAAAAAAAAAEAAAABAAAAEHBpeGkAAAAAAwgICAAAAAxhdjFDgQAMAAAAABNjb2xybmNseAACAAIABoAAAAAXaXBtYQAAAAAAAAABAAEEAQKDBAAAAB9tZGF0EgAKCBgABogQEDQgMgkQAAAAB8dSLfI=",t.onload=t.onerror=function(){e(t.height===1)}})),this.isSupported}}class EJ{constructor(e){this.name=ii.EXT_MESHOPT_COMPRESSION,this.parser=e}loadBufferView(e){const t=this.parser.json,n=t.bufferViews[e];if(n.extensions&&n.extensions[this.name]){const r=n.extensions[this.name],s=this.parser.getDependency("buffer",r.buffer),o=this.parser.options.meshoptDecoder;if(!o||!o.supported){if(t.extensionsRequired&&t.extensionsRequired.indexOf(this.name)>=0)throw new Error("THREE.GLTFLoader: setMeshoptDecoder must be called before loading compressed files");return null}return s.then(function(u){const f=r.byteOffset||0,p=r.byteLength||0,g=r.count,v=r.byteStride,_=new Uint8Array(u,f,p);return o.decodeGltfBufferAsync?o.decodeGltfBufferAsync(g,v,_,r.mode,r.filter).then(function(x){return x.buffer}):o.ready.then(function(){const x=new ArrayBuffer(g*v);return o.decodeGltfBuffer(new Uint8Array(x),g,v,_,r.mode,r.filter),x})})}else return null}}class TJ{constructor(e){this.name=ii.EXT_MESH_GPU_INSTANCING,this.parser=e}createNodeMesh(e){const t=this.parser.json,n=t.nodes[e];if(!n.extensions||!n.extensions[this.name]||n.mesh===void 0)return null;const r=t.meshes[n.mesh];for(const p of r.primitives)if(p.mode!==nl.TRIANGLES&&p.mode!==nl.TRIANGLE_STRIP&&p.mode!==nl.TRIANGLE_FAN&&p.mode!==void 0)return null;const o=n.extensions[this.name].attributes,u=[],f={};for(const p in o)u.push(this.parser.getDependency("accessor",o[p]).then(g=>(f[p]=g,f[p])));return u.length<1?null:(u.push(this.parser.createNodeMesh(e)),Promise.all(u).then(p=>{const g=p.pop(),v=g.isGroup?g.children:[g],_=p[0].count,x=[];for(const E of v){const C=new vn,w=new ie,T=new ys,N=new ie(1,1,1),L=new pw(E.geometry,E.material,_);for(let F=0;F<_;F++)f.TRANSLATION&&w.fromBufferAttribute(f.TRANSLATION,F),f.ROTATION&&T.fromBufferAttribute(f.ROTATION,F),f.SCALE&&N.fromBufferAttribute(f.SCALE,F),L.setMatrixAt(F,C.compose(w,T,N));for(const F in f)if(F==="_COLOR_0"){const G=f[F];L.instanceColor=new $d(G.array,G.itemSize,G.normalized)}else F!=="TRANSLATION"&&F!=="ROTATION"&&F!=="SCALE"&&E.geometry.setAttribute(F,f[F]);fi.prototype.copy.call(L,E),this.parser.assignFinalMaterial(L),x.push(L)}return g.isGroup?(g.clear(),g.add(...x),g):x[0]}))}}const RO="glTF",cv=12,MN={JSON:1313821514,BIN:5130562};class MJ{constructor(e){this.name=ii.KHR_BINARY_GLTF,this.content=null,this.body=null;const t=new DataView(e,0,cv);if(this.header={magic:BA(new Uint8Array(e.slice(0,4))),version:t.getUint32(4,!0),length:t.getUint32(8,!0)},this.header.magic!==RO)throw new Error("THREE.GLTFLoader: Unsupported glTF-Binary header.");if(this.header.version<2)throw new Error("THREE.GLTFLoader: Legacy binary file detected.");const n=this.header.length-cv,r=new DataView(e,cv);let s=0;for(;s<n;){const o=r.getUint32(s,!0);s+=4;const u=r.getUint32(s,!0);if(s+=4,u===MN.JSON){const f=new Uint8Array(e,cv+s,o);this.content=BA(f)}else if(u===MN.BIN){const f=cv+s;this.body=e.slice(f,f+o)}s+=o}if(this.content===null)throw new Error("THREE.GLTFLoader: JSON content not found.")}}class wJ{constructor(e,t){if(!t)throw new Error("THREE.GLTFLoader: No DRACOLoader instance provided.");this.name=ii.KHR_DRACO_MESH_COMPRESSION,this.json=e,this.dracoLoader=t,this.dracoLoader.preload()}decodePrimitive(e,t){const n=this.json,r=this.dracoLoader,s=e.extensions[this.name].bufferView,o=e.extensions[this.name].attributes,u={},f={},p={};for(const g in o){const v=JT[g]||g.toLowerCase();u[v]=o[g]}for(const g in e.attributes){const v=JT[g]||g.toLowerCase();if(o[g]!==void 0){const _=n.accessors[e.attributes[g]],x=Ym[_.componentType];p[v]=x.name,f[v]=_.normalized===!0}}return t.getDependency("bufferView",s).then(function(g){return new Promise(function(v,_){r.decodeDracoFile(g,function(x){for(const E in x.attributes){const C=x.attributes[E],w=f[E];w!==void 0&&(C.normalized=w)}v(x)},u,p,ku,_)})})}}class CJ{constructor(){this.name=ii.KHR_TEXTURE_TRANSFORM}extendTexture(e,t){return(t.texCoord===void 0||t.texCoord===e.channel)&&t.offset===void 0&&t.rotation===void 0&&t.scale===void 0||(e=e.clone(),t.texCoord!==void 0&&(e.channel=t.texCoord),t.offset!==void 0&&e.offset.fromArray(t.offset),t.rotation!==void 0&&(e.rotation=t.rotation),t.scale!==void 0&&e.repeat.fromArray(t.scale),e.needsUpdate=!0),e}}class RJ{constructor(){this.name=ii.KHR_MESH_QUANTIZATION}}class IO extends Rg{constructor(e,t,n,r){super(e,t,n,r)}copySampleValue_(e){const t=this.resultBuffer,n=this.sampleValues,r=this.valueSize,s=e*r*3+r;for(let o=0;o!==r;o++)t[o]=n[s+o];return t}interpolate_(e,t,n,r){const s=this.resultBuffer,o=this.sampleValues,u=this.valueSize,f=u*2,p=u*3,g=r-t,v=(n-t)/g,_=v*v,x=_*v,E=e*p,C=E-p,w=-2*x+3*_,T=x-_,N=1-w,L=T-_+v;for(let F=0;F!==u;F++){const G=o[C+F+u],k=o[C+F+f]*g,O=o[E+F+u],D=o[E+F]*g;s[F]=N*G+L*k+w*O+T*D}return s}}const IJ=new ys;class DJ extends IO{interpolate_(e,t,n,r){const s=super.interpolate_(e,t,n,r);return IJ.fromArray(s).normalize().toArray(s),s}}const nl={POINTS:0,LINES:1,LINE_LOOP:2,LINE_STRIP:3,TRIANGLES:4,TRIANGLE_STRIP:5,TRIANGLE_FAN:6},Ym={5120:Int8Array,5121:Uint8Array,5122:Int16Array,5123:Uint16Array,5125:Uint32Array,5126:Float32Array},wN={9728:Pr,9729:Jn,9984:aS,9985:qm,9986:Pd,9987:sl},CN={33071:Sr,33648:sg,10497:_f},j1={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},JT={POSITION:"position",NORMAL:"normal",TANGENT:"tangent",...Kw>=152?{TEXCOORD_0:"uv",TEXCOORD_1:"uv1",TEXCOORD_2:"uv2",TEXCOORD_3:"uv3"}:{TEXCOORD_0:"uv",TEXCOORD_1:"uv2"},COLOR_0:"color",WEIGHTS_0:"skinWeight",JOINTS_0:"skinIndex"},Xh={scale:"scale",translation:"position",rotation:"quaternion",weights:"morphTargetInfluences"},NJ={CUBICSPLINE:void 0,LINEAR:cg,STEP:lg},W1={OPAQUE:"OPAQUE",MASK:"MASK",BLEND:"BLEND"};function PJ(i){return i.DefaultMaterial===void 0&&(i.DefaultMaterial=new Cg({color:16777215,emissive:0,metalness:1,roughness:1,transparent:!1,depthTest:!0,side:Gc})),i.DefaultMaterial}function Ed(i,e,t){for(const n in t.extensions)i[n]===void 0&&(e.userData.gltfExtensions=e.userData.gltfExtensions||{},e.userData.gltfExtensions[n]=t.extensions[n])}function Iu(i,e){e.extras!==void 0&&(typeof e.extras=="object"?Object.assign(i.userData,e.extras):console.warn("THREE.GLTFLoader: Ignoring primitive type .extras, "+e.extras))}function BJ(i,e,t){let n=!1,r=!1,s=!1;for(let p=0,g=e.length;p<g;p++){const v=e[p];if(v.POSITION!==void 0&&(n=!0),v.NORMAL!==void 0&&(r=!0),v.COLOR_0!==void 0&&(s=!0),n&&r&&s)break}if(!n&&!r&&!s)return Promise.resolve(i);const o=[],u=[],f=[];for(let p=0,g=e.length;p<g;p++){const v=e[p];if(n){const _=v.POSITION!==void 0?t.getDependency("accessor",v.POSITION):i.attributes.position;o.push(_)}if(r){const _=v.NORMAL!==void 0?t.getDependency("accessor",v.NORMAL):i.attributes.normal;u.push(_)}if(s){const _=v.COLOR_0!==void 0?t.getDependency("accessor",v.COLOR_0):i.attributes.color;f.push(_)}}return Promise.all([Promise.all(o),Promise.all(u),Promise.all(f)]).then(function(p){const g=p[0],v=p[1],_=p[2];return n&&(i.morphAttributes.position=g),r&&(i.morphAttributes.normal=v),s&&(i.morphAttributes.color=_),i.morphTargetsRelative=!0,i})}function LJ(i,e){if(i.updateMorphTargets(),e.weights!==void 0)for(let t=0,n=e.weights.length;t<n;t++)i.morphTargetInfluences[t]=e.weights[t];if(e.extras&&Array.isArray(e.extras.targetNames)){const t=e.extras.targetNames;if(i.morphTargetInfluences.length===t.length){i.morphTargetDictionary={};for(let n=0,r=t.length;n<r;n++)i.morphTargetDictionary[t[n]]=n}else console.warn("THREE.GLTFLoader: Invalid extras.targetNames length. Ignoring names.")}}function OJ(i){let e;const t=i.extensions&&i.extensions[ii.KHR_DRACO_MESH_COMPRESSION];if(t?e="draco:"+t.bufferView+":"+t.indices+":"+q1(t.attributes):e=i.indices+":"+q1(i.attributes)+":"+i.mode,i.targets!==void 0)for(let n=0,r=i.targets.length;n<r;n++)e+=":"+q1(i.targets[n]);return e}function q1(i){let e="";const t=Object.keys(i).sort();for(let n=0,r=t.length;n<r;n++)e+=t[n]+":"+i[t[n]]+";";return e}function KT(i){switch(i){case Int8Array:return 1/127;case Uint8Array:return 1/255;case Int16Array:return 1/32767;case Uint16Array:return 1/65535;default:throw new Error("THREE.GLTFLoader: Unsupported normalized accessor component type.")}}function UJ(i){return i.search(/\.jpe?g($|\?)/i)>0||i.search(/^data\:image\/jpeg/)===0?"image/jpeg":i.search(/\.webp($|\?)/i)>0||i.search(/^data\:image\/webp/)===0?"image/webp":"image/png"}const FJ=new vn;class kJ{constructor(e={},t={}){this.json=e,this.extensions={},this.plugins={},this.options=t,this.cache=new oJ,this.associations=new Map,this.primitiveCache={},this.nodeCache={},this.meshCache={refs:{},uses:{}},this.cameraCache={refs:{},uses:{}},this.lightCache={refs:{},uses:{}},this.sourceCache={},this.textureCache={},this.nodeNamesUsed={};let n=!1,r=!1,s=-1;typeof navigator<"u"&&typeof navigator.userAgent<"u"&&(n=/^((?!chrome|android).)*safari/i.test(navigator.userAgent)===!0,r=navigator.userAgent.indexOf("Firefox")>-1,s=r?navigator.userAgent.match(/Firefox\/([0-9]+)\./)[1]:-1),typeof createImageBitmap>"u"||n||r&&s<98?this.textureLoader=new LL(this.options.manager):this.textureLoader=new HL(this.options.manager),this.textureLoader.setCrossOrigin(this.options.crossOrigin),this.textureLoader.setRequestHeader(this.options.requestHeader),this.fileLoader=new zs(this.options.manager),this.fileLoader.setResponseType("arraybuffer"),this.options.crossOrigin==="use-credentials"&&this.fileLoader.setWithCredentials(!0)}setExtensions(e){this.extensions=e}setPlugins(e){this.plugins=e}parse(e,t){const n=this,r=this.json,s=this.extensions;this.cache.removeAll(),this.nodeCache={},this._invokeAll(function(o){return o._markDefs&&o._markDefs()}),Promise.all(this._invokeAll(function(o){return o.beforeRoot&&o.beforeRoot()})).then(function(){return Promise.all([n.getDependencies("scene"),n.getDependencies("animation"),n.getDependencies("camera")])}).then(function(o){const u={scene:o[0][r.scene||0],scenes:o[0],animations:o[1],cameras:o[2],asset:r.asset,parser:n,userData:{}};return Ed(s,u,r),Iu(u,r),Promise.all(n._invokeAll(function(f){return f.afterRoot&&f.afterRoot(u)})).then(function(){for(const f of u.scenes)f.updateMatrixWorld();e(u)})}).catch(t)}_markDefs(){const e=this.json.nodes||[],t=this.json.skins||[],n=this.json.meshes||[];for(let r=0,s=t.length;r<s;r++){const o=t[r].joints;for(let u=0,f=o.length;u<f;u++)e[o[u]].isBone=!0}for(let r=0,s=e.length;r<s;r++){const o=e[r];o.mesh!==void 0&&(this._addNodeRef(this.meshCache,o.mesh),o.skin!==void 0&&(n[o.mesh].isSkinnedMesh=!0)),o.camera!==void 0&&this._addNodeRef(this.cameraCache,o.camera)}}_addNodeRef(e,t){t!==void 0&&(e.refs[t]===void 0&&(e.refs[t]=e.uses[t]=0),e.refs[t]++)}_getNodeRef(e,t,n){if(e.refs[t]<=1)return n;const r=n.clone(),s=(o,u)=>{const f=this.associations.get(o);f!=null&&this.associations.set(u,f);for(const[p,g]of o.children.entries())s(g,u.children[p])};return s(n,r),r.name+="_instance_"+e.uses[t]++,r}_invokeOne(e){const t=Object.values(this.plugins);t.push(this);for(let n=0;n<t.length;n++){const r=e(t[n]);if(r)return r}return null}_invokeAll(e){const t=Object.values(this.plugins);t.unshift(this);const n=[];for(let r=0;r<t.length;r++){const s=e(t[r]);s&&n.push(s)}return n}getDependency(e,t){const n=e+":"+t;let r=this.cache.get(n);if(!r){switch(e){case"scene":r=this.loadScene(t);break;case"node":r=this._invokeOne(function(s){return s.loadNode&&s.loadNode(t)});break;case"mesh":r=this._invokeOne(function(s){return s.loadMesh&&s.loadMesh(t)});break;case"accessor":r=this.loadAccessor(t);break;case"bufferView":r=this._invokeOne(function(s){return s.loadBufferView&&s.loadBufferView(t)});break;case"buffer":r=this.loadBuffer(t);break;case"material":r=this._invokeOne(function(s){return s.loadMaterial&&s.loadMaterial(t)});break;case"texture":r=this._invokeOne(function(s){return s.loadTexture&&s.loadTexture(t)});break;case"skin":r=this.loadSkin(t);break;case"animation":r=this._invokeOne(function(s){return s.loadAnimation&&s.loadAnimation(t)});break;case"camera":r=this.loadCamera(t);break;default:if(r=this._invokeOne(function(s){return s!=this&&s.getDependency&&s.getDependency(e,t)}),!r)throw new Error("Unknown type: "+e);break}this.cache.add(n,r)}return r}getDependencies(e){let t=this.cache.get(e);if(!t){const n=this,r=this.json[e+(e==="mesh"?"es":"s")]||[];t=Promise.all(r.map(function(s,o){return n.getDependency(e,o)})),this.cache.add(e,t)}return t}loadBuffer(e){const t=this.json.buffers[e],n=this.fileLoader;if(t.type&&t.type!=="arraybuffer")throw new Error("THREE.GLTFLoader: "+t.type+" buffer type is not supported.");if(t.uri===void 0&&e===0)return Promise.resolve(this.extensions[ii.KHR_BINARY_GLTF].body);const r=this.options;return new Promise(function(s,o){n.load(uf.resolveURL(t.uri,r.path),s,void 0,function(){o(new Error('THREE.GLTFLoader: Failed to load buffer "'+t.uri+'".'))})})}loadBufferView(e){const t=this.json.bufferViews[e];return this.getDependency("buffer",t.buffer).then(function(n){const r=t.byteLength||0,s=t.byteOffset||0;return n.slice(s,s+r)})}loadAccessor(e){const t=this,n=this.json,r=this.json.accessors[e];if(r.bufferView===void 0&&r.sparse===void 0){const o=j1[r.type],u=Ym[r.componentType],f=r.normalized===!0,p=new u(r.count*o);return Promise.resolve(new gi(p,o,f))}const s=[];return r.bufferView!==void 0?s.push(this.getDependency("bufferView",r.bufferView)):s.push(null),r.sparse!==void 0&&(s.push(this.getDependency("bufferView",r.sparse.indices.bufferView)),s.push(this.getDependency("bufferView",r.sparse.values.bufferView))),Promise.all(s).then(function(o){const u=o[0],f=j1[r.type],p=Ym[r.componentType],g=p.BYTES_PER_ELEMENT,v=g*f,_=r.byteOffset||0,x=r.bufferView!==void 0?n.bufferViews[r.bufferView].byteStride:void 0,E=r.normalized===!0;let C,w;if(x&&x!==v){const T=Math.floor(_/x),N="InterleavedBuffer:"+r.bufferView+":"+r.componentType+":"+T+":"+r.count;let L=t.cache.get(N);L||(C=new p(u,T*x,r.count*x/g),L=new Sy(C,x/g),t.cache.add(N,L)),w=new bf(L,f,_%x/g,E)}else u===null?C=new p(r.count*f):C=new p(u,_,r.count*f),w=new gi(C,f,E);if(r.sparse!==void 0){const T=j1.SCALAR,N=Ym[r.sparse.indices.componentType],L=r.sparse.indices.byteOffset||0,F=r.sparse.values.byteOffset||0,G=new N(o[1],L,r.sparse.count*T),k=new p(o[2],F,r.sparse.count*f);u!==null&&(w=new gi(w.array.slice(),w.itemSize,w.normalized));for(let O=0,D=G.length;O<D;O++){const R=G[O];if(w.setX(R,k[O*f]),f>=2&&w.setY(R,k[O*f+1]),f>=3&&w.setZ(R,k[O*f+2]),f>=4&&w.setW(R,k[O*f+3]),f>=5)throw new Error("THREE.GLTFLoader: Unsupported itemSize in sparse BufferAttribute.")}}return w})}loadTexture(e){const t=this.json,n=this.options,s=t.textures[e].source,o=t.images[s];let u=this.textureLoader;if(o.uri){const f=n.manager.getHandler(o.uri);f!==null&&(u=f)}return this.loadTextureImage(e,s,u)}loadTextureImage(e,t,n){const r=this,s=this.json,o=s.textures[e],u=s.images[t],f=(u.uri||u.bufferView)+":"+o.sampler;if(this.textureCache[f])return this.textureCache[f];const p=this.loadImageSource(t,n).then(function(g){g.flipY=!1,g.name=o.name||u.name||"",g.name===""&&typeof u.uri=="string"&&u.uri.startsWith("data:image/")===!1&&(g.name=u.uri);const _=(s.samplers||{})[o.sampler]||{};return g.magFilter=wN[_.magFilter]||Jn,g.minFilter=wN[_.minFilter]||sl,g.wrapS=CN[_.wrapS]||_f,g.wrapT=CN[_.wrapT]||_f,r.associations.set(g,{textures:e}),g}).catch(function(){return null});return this.textureCache[f]=p,p}loadImageSource(e,t){const n=this,r=this.json,s=this.options;if(this.sourceCache[e]!==void 0)return this.sourceCache[e].then(v=>v.clone());const o=r.images[e],u=self.URL||self.webkitURL;let f=o.uri||"",p=!1;if(o.bufferView!==void 0)f=n.getDependency("bufferView",o.bufferView).then(function(v){p=!0;const _=new Blob([v],{type:o.mimeType});return f=u.createObjectURL(_),f});else if(o.uri===void 0)throw new Error("THREE.GLTFLoader: Image "+e+" is missing URI and bufferView");const g=Promise.resolve(f).then(function(v){return new Promise(function(_,x){let E=_;t.isImageBitmapLoader===!0&&(E=function(C){const w=new Ci(C);w.needsUpdate=!0,_(w)}),t.load(uf.resolveURL(v,s.path),E,void 0,x)})}).then(function(v){return p===!0&&u.revokeObjectURL(f),Iu(v,o),v.userData.mimeType=o.mimeType||UJ(o.uri),v}).catch(function(v){throw console.error("THREE.GLTFLoader: Couldn't load texture",f),v});return this.sourceCache[e]=g,g}assignTexture(e,t,n,r){const s=this;return this.getDependency("texture",n.index).then(function(o){if(!o)return null;if(n.texCoord!==void 0&&n.texCoord>0&&(o=o.clone(),o.channel=n.texCoord),s.extensions[ii.KHR_TEXTURE_TRANSFORM]){const u=n.extensions!==void 0?n.extensions[ii.KHR_TEXTURE_TRANSFORM]:void 0;if(u){const f=s.associations.get(o);o=s.extensions[ii.KHR_TEXTURE_TRANSFORM].extendTexture(o,u),s.associations.set(o,f)}}return r!==void 0&&(typeof r=="number"&&(r=r===TN?kd:ku),"colorSpace"in o?o.colorSpace=r:o.encoding=r===kd?TN:aJ),e[t]=o,o})}assignFinalMaterial(e){const t=e.geometry;let n=e.material;const r=t.attributes.tangent===void 0,s=t.attributes.color!==void 0,o=t.attributes.normal===void 0;if(e.isPoints){const u="PointsMaterial:"+n.uuid;let f=this.cache.get(u);f||(f=new ES,os.prototype.copy.call(f,n),f.color.copy(n.color),f.map=n.map,f.sizeAttenuation=!1,this.cache.add(u,f)),n=f}else if(e.isLine){const u="LineBasicMaterial:"+n.uuid;let f=this.cache.get(u);f||(f=new ha,os.prototype.copy.call(f,n),f.color.copy(n.color),f.map=n.map,this.cache.add(u,f)),n=f}if(r||s||o){let u="ClonedMaterial:"+n.uuid+":";r&&(u+="derivative-tangents:"),s&&(u+="vertex-colors:"),o&&(u+="flat-shading:");let f=this.cache.get(u);f||(f=n.clone(),s&&(f.vertexColors=!0),o&&(f.flatShading=!0),r&&(f.normalScale&&(f.normalScale.y*=-1),f.clearcoatNormalScale&&(f.clearcoatNormalScale.y*=-1)),this.cache.add(u,f),this.associations.set(f,this.associations.get(n))),n=f}e.material=n}getMaterialType(){return Cg}loadMaterial(e){const t=this,n=this.json,r=this.extensions,s=n.materials[e];let o;const u={},f=s.extensions||{},p=[];if(f[ii.KHR_MATERIALS_UNLIT]){const v=r[ii.KHR_MATERIALS_UNLIT];o=v.getMaterialType(),p.push(v.extendParams(u,s,t))}else{const v=s.pbrMetallicRoughness||{};if(u.color=new Gt(1,1,1),u.opacity=1,Array.isArray(v.baseColorFactor)){const _=v.baseColorFactor;u.color.setRGB(_[0],_[1],_[2],ku),u.opacity=_[3]}v.baseColorTexture!==void 0&&p.push(t.assignTexture(u,"map",v.baseColorTexture,kd)),u.metalness=v.metallicFactor!==void 0?v.metallicFactor:1,u.roughness=v.roughnessFactor!==void 0?v.roughnessFactor:1,v.metallicRoughnessTexture!==void 0&&(p.push(t.assignTexture(u,"metalnessMap",v.metallicRoughnessTexture)),p.push(t.assignTexture(u,"roughnessMap",v.metallicRoughnessTexture))),o=this._invokeOne(function(_){return _.getMaterialType&&_.getMaterialType(e)}),p.push(Promise.all(this._invokeAll(function(_){return _.extendMaterialParams&&_.extendMaterialParams(e,u)})))}s.doubleSided===!0&&(u.side=yo);const g=s.alphaMode||W1.OPAQUE;if(g===W1.BLEND?(u.transparent=!0,u.depthWrite=!1):(u.transparent=!1,g===W1.MASK&&(u.alphaTest=s.alphaCutoff!==void 0?s.alphaCutoff:.5)),s.normalTexture!==void 0&&o!==to&&(p.push(t.assignTexture(u,"normalMap",s.normalTexture)),u.normalScale=new $e(1,1),s.normalTexture.scale!==void 0)){const v=s.normalTexture.scale;u.normalScale.set(v,v)}if(s.occlusionTexture!==void 0&&o!==to&&(p.push(t.assignTexture(u,"aoMap",s.occlusionTexture)),s.occlusionTexture.strength!==void 0&&(u.aoMapIntensity=s.occlusionTexture.strength)),s.emissiveFactor!==void 0&&o!==to){const v=s.emissiveFactor;u.emissive=new Gt().setRGB(v[0],v[1],v[2],ku)}return s.emissiveTexture!==void 0&&o!==to&&p.push(t.assignTexture(u,"emissiveMap",s.emissiveTexture,kd)),Promise.all(p).then(function(){const v=new o(u);return s.name&&(v.name=s.name),Iu(v,s),t.associations.set(v,{materials:e}),s.extensions&&Ed(r,v,s),v})}createUniqueName(e){const t=mi.sanitizeNodeName(e||"");return t in this.nodeNamesUsed?t+"_"+ ++this.nodeNamesUsed[t]:(this.nodeNamesUsed[t]=0,t)}loadGeometries(e){const t=this,n=this.extensions,r=this.primitiveCache;function s(u){return n[ii.KHR_DRACO_MESH_COMPRESSION].decodePrimitive(u,t).then(function(f){return RN(f,u,t)})}const o=[];for(let u=0,f=e.length;u<f;u++){const p=e[u],g=OJ(p),v=r[g];if(v)o.push(v.promise);else{let _;p.extensions&&p.extensions[ii.KHR_DRACO_MESH_COMPRESSION]?_=s(p):_=RN(new wn,p,t),r[g]={primitive:p,promise:_},o.push(_)}}return Promise.all(o)}loadMesh(e){const t=this,n=this.json,r=this.extensions,s=n.meshes[e],o=s.primitives,u=[];for(let f=0,p=o.length;f<p;f++){const g=o[f].material===void 0?PJ(this.cache):this.getDependency("material",o[f].material);u.push(g)}return u.push(t.loadGeometries(o)),Promise.all(u).then(function(f){const p=f.slice(0,f.length-1),g=f[f.length-1],v=[];for(let x=0,E=g.length;x<E;x++){const C=g[x],w=o[x];let T;const N=p[x];if(w.mode===nl.TRIANGLES||w.mode===nl.TRIANGLE_STRIP||w.mode===nl.TRIANGLE_FAN||w.mode===void 0)T=s.isSkinnedMesh===!0?new dw(C,N):new rr(C,N),T.isSkinnedMesh===!0&&T.normalizeSkinWeights(),w.mode===nl.TRIANGLE_STRIP?T.geometry=AN(T.geometry,ow):w.mode===nl.TRIANGLE_FAN&&(T.geometry=AN(T.geometry,EA));else if(w.mode===nl.LINES)T=new Yl(C,N);else if(w.mode===nl.LINE_STRIP)T=new ju(C,N);else if(w.mode===nl.LINE_LOOP)T=new mw(C,N);else if(w.mode===nl.POINTS)T=new gw(C,N);else throw new Error("THREE.GLTFLoader: Primitive mode unsupported: "+w.mode);Object.keys(T.geometry.morphAttributes).length>0&&LJ(T,s),T.name=t.createUniqueName(s.name||"mesh_"+e),Iu(T,s),w.extensions&&Ed(r,T,w),t.assignFinalMaterial(T),v.push(T)}for(let x=0,E=v.length;x<E;x++)t.associations.set(v[x],{meshes:e,primitives:x});if(v.length===1)return s.extensions&&Ed(r,v[0],s),v[0];const _=new Ou;s.extensions&&Ed(r,_,s),t.associations.set(_,{meshes:e});for(let x=0,E=v.length;x<E;x++)_.add(v[x]);return _})}loadCamera(e){let t;const n=this.json.cameras[e],r=n[n.type];if(!r){console.warn("THREE.GLTFLoader: Missing camera parameters.");return}return n.type==="perspective"?t=new hr($B.radToDeg(r.yfov),r.aspectRatio||1,r.znear||1,r.zfar||2e6):n.type==="orthographic"&&(t=new Ao(-r.xmag,r.xmag,r.ymag,-r.ymag,r.znear,r.zfar)),n.name&&(t.name=this.createUniqueName(n.name)),Iu(t,n),Promise.resolve(t)}loadSkin(e){const t=this.json.skins[e],n=[];for(let r=0,s=t.joints.length;r<s;r++)n.push(this._loadNodeShallow(t.joints[r]));return t.inverseBindMatrices!==void 0?n.push(this.getDependency("accessor",t.inverseBindMatrices)):n.push(null),Promise.all(n).then(function(r){const s=r.pop(),o=r,u=[],f=[];for(let p=0,g=o.length;p<g;p++){const v=o[p];if(v){u.push(v);const _=new vn;s!==null&&_.fromArray(s.array,p*16),f.push(_)}else console.warn('THREE.GLTFLoader: Joint "%s" could not be found.',t.joints[p])}return new Ey(u,f)})}loadAnimation(e){const t=this.json,n=this,r=t.animations[e],s=r.name?r.name:"animation_"+e,o=[],u=[],f=[],p=[],g=[];for(let v=0,_=r.channels.length;v<_;v++){const x=r.channels[v],E=r.samplers[x.sampler],C=x.target,w=C.node,T=r.parameters!==void 0?r.parameters[E.input]:E.input,N=r.parameters!==void 0?r.parameters[E.output]:E.output;C.node!==void 0&&(o.push(this.getDependency("node",w)),u.push(this.getDependency("accessor",T)),f.push(this.getDependency("accessor",N)),p.push(E),g.push(C))}return Promise.all([Promise.all(o),Promise.all(u),Promise.all(f),Promise.all(p),Promise.all(g)]).then(function(v){const _=v[0],x=v[1],E=v[2],C=v[3],w=v[4],T=[];for(let N=0,L=_.length;N<L;N++){const F=_[N],G=x[N],k=E[N],O=C[N],D=w[N];if(F===void 0)continue;F.updateMatrix&&F.updateMatrix();const R=n._createAnimationTracks(F,G,k,O,D);if(R)for(let P=0;P<R.length;P++)T.push(R[P])}return new gg(s,void 0,T)})}createNodeMesh(e){const t=this.json,n=this,r=t.nodes[e];return r.mesh===void 0?null:n.getDependency("mesh",r.mesh).then(function(s){const o=n._getNodeRef(n.meshCache,r.mesh,s);return r.weights!==void 0&&o.traverse(function(u){if(u.isMesh)for(let f=0,p=r.weights.length;f<p;f++)u.morphTargetInfluences[f]=r.weights[f]}),o})}loadNode(e){const t=this.json,n=this,r=t.nodes[e],s=n._loadNodeShallow(e),o=[],u=r.children||[];for(let p=0,g=u.length;p<g;p++)o.push(n.getDependency("node",u[p]));const f=r.skin===void 0?Promise.resolve(null):n.getDependency("skin",r.skin);return Promise.all([s,Promise.all(o),f]).then(function(p){const g=p[0],v=p[1],_=p[2];_!==null&&g.traverse(function(x){x.isSkinnedMesh&&x.bind(_,FJ)});for(let x=0,E=v.length;x<E;x++)g.add(v[x]);return g})}_loadNodeShallow(e){const t=this.json,n=this.extensions,r=this;if(this.nodeCache[e]!==void 0)return this.nodeCache[e];const s=t.nodes[e],o=s.name?r.createUniqueName(s.name):"",u=[],f=r._invokeOne(function(p){return p.createNodeMesh&&p.createNodeMesh(e)});return f&&u.push(f),s.camera!==void 0&&u.push(r.getDependency("camera",s.camera).then(function(p){return r._getNodeRef(r.cameraCache,s.camera,p)})),r._invokeAll(function(p){return p.createNodeAttachment&&p.createNodeAttachment(e)}).forEach(function(p){u.push(p)}),this.nodeCache[e]=Promise.all(u).then(function(p){let g;if(s.isBone===!0?g=new AS:p.length>1?g=new Ou:p.length===1?g=p[0]:g=new fi,g!==p[0])for(let v=0,_=p.length;v<_;v++)g.add(p[v]);if(s.name&&(g.userData.name=s.name,g.name=o),Iu(g,s),s.extensions&&Ed(n,g,s),s.matrix!==void 0){const v=new vn;v.fromArray(s.matrix),g.applyMatrix4(v)}else s.translation!==void 0&&g.position.fromArray(s.translation),s.rotation!==void 0&&g.quaternion.fromArray(s.rotation),s.scale!==void 0&&g.scale.fromArray(s.scale);return r.associations.has(g)||r.associations.set(g,{}),r.associations.get(g).nodes=e,g}),this.nodeCache[e]}loadScene(e){const t=this.extensions,n=this.json.scenes[e],r=this,s=new Ou;n.name&&(s.name=r.createUniqueName(n.name)),Iu(s,n),n.extensions&&Ed(t,s,n);const o=n.nodes||[],u=[];for(let f=0,p=o.length;f<p;f++)u.push(r.getDependency("node",o[f]));return Promise.all(u).then(function(f){for(let g=0,v=f.length;g<v;g++)s.add(f[g]);const p=g=>{const v=new Map;for(const[_,x]of r.associations)(_ instanceof os||_ instanceof Ci)&&v.set(_,x);return g.traverse(_=>{const x=r.associations.get(_);x!=null&&v.set(_,x)}),v};return r.associations=p(s),s})}_createAnimationTracks(e,t,n,r,s){const o=[],u=e.name?e.name:e.uuid,f=[];Xh[s.path]===Xh.weights?e.traverse(function(_){_.morphTargetInfluences&&f.push(_.name?_.name:_.uuid)}):f.push(u);let p;switch(Xh[s.path]){case Xh.weights:p=np;break;case Xh.rotation:p=ip;break;case Xh.position:case Xh.scale:p=rp;break;default:switch(n.itemSize){case 1:p=np;break;case 2:case 3:default:p=rp;break}break}const g=r.interpolation!==void 0?NJ[r.interpolation]:cg,v=this._getArrayFromAccessor(n);for(let _=0,x=f.length;_<x;_++){const E=new p(f[_]+"."+Xh[s.path],t.array,v,g);r.interpolation==="CUBICSPLINE"&&this._createCubicSplineTrackInterpolant(E),o.push(E)}return o}_getArrayFromAccessor(e){let t=e.array;if(e.normalized){const n=KT(t.constructor),r=new Float32Array(t.length);for(let s=0,o=t.length;s<o;s++)r[s]=t[s]*n;t=r}return t}_createCubicSplineTrackInterpolant(e){e.createInterpolant=function(n){const r=this instanceof ip?DJ:IO;return new r(this.times,this.values,this.getValueSize()/3,n)},e.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline=!0}}function zJ(i,e,t){const n=e.attributes,r=new xs;if(n.POSITION!==void 0){const u=t.json.accessors[n.POSITION],f=u.min,p=u.max;if(f!==void 0&&p!==void 0){if(r.set(new ie(f[0],f[1],f[2]),new ie(p[0],p[1],p[2])),u.normalized){const g=KT(Ym[u.componentType]);r.min.multiplyScalar(g),r.max.multiplyScalar(g)}}else{console.warn("THREE.GLTFLoader: Missing min/max properties for accessor POSITION.");return}}else return;const s=e.targets;if(s!==void 0){const u=new ie,f=new ie;for(let p=0,g=s.length;p<g;p++){const v=s[p];if(v.POSITION!==void 0){const _=t.json.accessors[v.POSITION],x=_.min,E=_.max;if(x!==void 0&&E!==void 0){if(f.setX(Math.max(Math.abs(x[0]),Math.abs(E[0]))),f.setY(Math.max(Math.abs(x[1]),Math.abs(E[1]))),f.setZ(Math.max(Math.abs(x[2]),Math.abs(E[2]))),_.normalized){const C=KT(Ym[_.componentType]);f.multiplyScalar(C)}u.max(f)}else console.warn("THREE.GLTFLoader: Missing min/max properties for accessor POSITION.")}}r.expandByVector(u)}i.boundingBox=r;const o=new bs;r.getCenter(o.center),o.radius=r.min.distanceTo(r.max)/2,i.boundingSphere=o}function RN(i,e,t){const n=e.attributes,r=[];function s(o,u){return t.getDependency("accessor",o).then(function(f){i.setAttribute(u,f)})}for(const o in n){const u=JT[o]||o.toLowerCase();u in i.attributes||r.push(s(n[o],u))}if(e.indices!==void 0&&!i.index){const o=t.getDependency("accessor",e.indices).then(function(u){i.setIndex(u)});r.push(o)}return Iu(i,e),zJ(i,e,t),Promise.all(r).then(function(){return e.targets!==void 0?BJ(i,e.targets,t):i})}const VJ={uniforms:{tDiffuse:{value:null},h:{value:1/512}},vertexShader:`
      varying vec2 vUv;

      void main() {

        vUv = uv;
        gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );

      }
  `,fragmentShader:`
    uniform sampler2D tDiffuse;
    uniform float h;

    varying vec2 vUv;

    void main() {

    	vec4 sum = vec4( 0.0 );

    	sum += texture2D( tDiffuse, vec2( vUv.x - 4.0 * h, vUv.y ) ) * 0.051;
    	sum += texture2D( tDiffuse, vec2( vUv.x - 3.0 * h, vUv.y ) ) * 0.0918;
    	sum += texture2D( tDiffuse, vec2( vUv.x - 2.0 * h, vUv.y ) ) * 0.12245;
    	sum += texture2D( tDiffuse, vec2( vUv.x - 1.0 * h, vUv.y ) ) * 0.1531;
    	sum += texture2D( tDiffuse, vec2( vUv.x, vUv.y ) ) * 0.1633;
    	sum += texture2D( tDiffuse, vec2( vUv.x + 1.0 * h, vUv.y ) ) * 0.1531;
    	sum += texture2D( tDiffuse, vec2( vUv.x + 2.0 * h, vUv.y ) ) * 0.12245;
    	sum += texture2D( tDiffuse, vec2( vUv.x + 3.0 * h, vUv.y ) ) * 0.0918;
    	sum += texture2D( tDiffuse, vec2( vUv.x + 4.0 * h, vUv.y ) ) * 0.051;

    	gl_FragColor = sum;

    }
  `},HJ={uniforms:{tDiffuse:{value:null},v:{value:1/512}},vertexShader:`
    varying vec2 vUv;

    void main() {

      vUv = uv;
      gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );

    }
  `,fragmentShader:`

  uniform sampler2D tDiffuse;
  uniform float v;

  varying vec2 vUv;

  void main() {

    vec4 sum = vec4( 0.0 );

    sum += texture2D( tDiffuse, vec2( vUv.x, vUv.y - 4.0 * v ) ) * 0.051;
    sum += texture2D( tDiffuse, vec2( vUv.x, vUv.y - 3.0 * v ) ) * 0.0918;
    sum += texture2D( tDiffuse, vec2( vUv.x, vUv.y - 2.0 * v ) ) * 0.12245;
    sum += texture2D( tDiffuse, vec2( vUv.x, vUv.y - 1.0 * v ) ) * 0.1531;
    sum += texture2D( tDiffuse, vec2( vUv.x, vUv.y ) ) * 0.1633;
    sum += texture2D( tDiffuse, vec2( vUv.x, vUv.y + 1.0 * v ) ) * 0.1531;
    sum += texture2D( tDiffuse, vec2( vUv.x, vUv.y + 2.0 * v ) ) * 0.12245;
    sum += texture2D( tDiffuse, vec2( vUv.x, vUv.y + 3.0 * v ) ) * 0.0918;
    sum += texture2D( tDiffuse, vec2( vUv.x, vUv.y + 4.0 * v ) ) * 0.051;

    gl_FragColor = sum;

  }
  `};class GJ extends Rw{constructor(e){super(e),this.type=Er}parse(e){const o=function(D,R){switch(D){case 1:throw new Error("THREE.RGBELoader: Read Error: "+(R||""));case 2:throw new Error("THREE.RGBELoader: Write Error: "+(R||""));case 3:throw new Error("THREE.RGBELoader: Bad File Format: "+(R||""));default:case 4:throw new Error("THREE.RGBELoader: Memory Error: "+(R||""))}},v=function(D,R,P){R=R||1024;let Y=D.pos,j=-1,ce=0,fe="",te=String.fromCharCode.apply(null,new Uint16Array(D.subarray(Y,Y+128)));for(;0>(j=te.indexOf(`
`))&&ce<R&&Y<D.byteLength;)fe+=te,ce+=te.length,Y+=128,te+=String.fromCharCode.apply(null,new Uint16Array(D.subarray(Y,Y+128)));return-1<j?(D.pos+=ce+j+1,fe+te.slice(0,j)):!1},_=function(D){const R=/^#\?(\S+)/,P=/^\s*GAMMA\s*=\s*(\d+(\.\d+)?)\s*$/,z=/^\s*EXPOSURE\s*=\s*(\d+(\.\d+)?)\s*$/,Y=/^\s*FORMAT=(\S+)\s*$/,j=/^\s*\-Y\s+(\d+)\s+\+X\s+(\d+)\s*$/,ce={valid:0,string:"",comments:"",programtype:"RGBE",format:"",gamma:1,exposure:1,width:0,height:0};let fe,te;for((D.pos>=D.byteLength||!(fe=v(D)))&&o(1,"no header found"),(te=fe.match(R))||o(3,"bad initial token"),ce.valid|=1,ce.programtype=te[1],ce.string+=fe+`
`;fe=v(D),fe!==!1;){if(ce.string+=fe+`
`,fe.charAt(0)==="#"){ce.comments+=fe+`
`;continue}if((te=fe.match(P))&&(ce.gamma=parseFloat(te[1])),(te=fe.match(z))&&(ce.exposure=parseFloat(te[1])),(te=fe.match(Y))&&(ce.valid|=2,ce.format=te[1]),(te=fe.match(j))&&(ce.valid|=4,ce.height=parseInt(te[1],10),ce.width=parseInt(te[2],10)),ce.valid&2&&ce.valid&4)break}return ce.valid&2||o(3,"missing format specifier"),ce.valid&4||o(3,"missing image size specifier"),ce},x=function(D,R,P){const z=R;if(z<8||z>32767||D[0]!==2||D[1]!==2||D[2]&128)return new Uint8Array(D);z!==(D[2]<<8|D[3])&&o(3,"wrong scanline width");const Y=new Uint8Array(4*R*P);Y.length||o(4,"unable to allocate buffer space");let j=0,ce=0;const fe=4*z,te=new Uint8Array(4),se=new Uint8Array(fe);let Ae=P;for(;Ae>0&&ce<D.byteLength;){ce+4>D.byteLength&&o(1),te[0]=D[ce++],te[1]=D[ce++],te[2]=D[ce++],te[3]=D[ce++],(te[0]!=2||te[1]!=2||(te[2]<<8|te[3])!=z)&&o(3,"bad rgbe scanline format");let Pe=0,Re;for(;Pe<fe&&ce<D.byteLength;){Re=D[ce++];const ae=Re>128;if(ae&&(Re-=128),(Re===0||Pe+Re>fe)&&o(3,"bad scanline data"),ae){const Se=D[ce++];for(let ke=0;ke<Re;ke++)se[Pe++]=Se}else se.set(D.subarray(ce,ce+Re),Pe),Pe+=Re,ce+=Re}const $=z;for(let ae=0;ae<$;ae++){let Se=0;Y[j]=se[ae+Se],Se+=z,Y[j+1]=se[ae+Se],Se+=z,Y[j+2]=se[ae+Se],Se+=z,Y[j+3]=se[ae+Se],j+=4}Ae--}return Y},E=function(D,R,P,z){const Y=D[R+3],j=Math.pow(2,Y-128)/255;P[z+0]=D[R+0]*j,P[z+1]=D[R+1]*j,P[z+2]=D[R+2]*j,P[z+3]=1},C=function(D,R,P,z){const Y=D[R+3],j=Math.pow(2,Y-128)/255;P[z+0]=Od.toHalfFloat(Math.min(D[R+0]*j,65504)),P[z+1]=Od.toHalfFloat(Math.min(D[R+1]*j,65504)),P[z+2]=Od.toHalfFloat(Math.min(D[R+2]*j,65504)),P[z+3]=Od.toHalfFloat(1)},w=new Uint8Array(e);w.pos=0;const T=_(w),N=T.width,L=T.height,F=x(w.subarray(w.pos),N,L);let G,k,O;switch(this.type){case ir:O=F.length/4;const D=new Float32Array(O*4);for(let P=0;P<O;P++)E(F,P*4,D,P*4);G=D,k=ir;break;case Er:O=F.length/4;const R=new Uint16Array(O*4);for(let P=0;P<O;P++)C(F,P*4,R,P*4);G=R,k=Er;break;default:throw new Error("THREE.RGBELoader: Unsupported type: "+this.type)}return{width:N,height:L,data:G,header:T.string,gamma:T.gamma,exposure:T.exposure,type:k}}setDataType(e){return this.type=e,this}load(e,t,n,r){function s(o,u){switch(o.type){case ir:case Er:"colorSpace"in o?o.colorSpace="srgb-linear":o.encoding=3e3,o.minFilter=Jn,o.magFilter=Jn,o.generateMipmaps=!1,o.flipY=!0;break}t&&t(o,u)}return super.load(e,s,n,r)}}const uv=Kw>=152;class jJ extends Rw{constructor(e){super(e),this.type=Er}parse(e){const R=Math.pow(2.7182818,2.2);function P(X,Z){for(var he=0,Ie=0;Ie<65536;++Ie)(Ie==0||X[Ie>>3]&1<<(Ie&7))&&(Z[he++]=Ie);for(var He=he-1;he<65536;)Z[he++]=0;return He}function z(X){for(var Z=0;Z<16384;Z++)X[Z]={},X[Z].len=0,X[Z].lit=0,X[Z].p=null}const Y={l:0,c:0,lc:0};function j(X,Z,he,Ie,He){for(;he<X;)Z=Z<<8|Ut(Ie,He),he+=8;he-=X,Y.l=Z>>he&(1<<X)-1,Y.c=Z,Y.lc=he}const ce=new Array(59);function fe(X){for(var Z=0;Z<=58;++Z)ce[Z]=0;for(var Z=0;Z<65537;++Z)ce[X[Z]]+=1;for(var he=0,Z=58;Z>0;--Z){var Ie=he+ce[Z]>>1;ce[Z]=he,he=Ie}for(var Z=0;Z<65537;++Z){var He=X[Z];He>0&&(X[Z]=He|ce[He]++<<6)}}function te(X,Z,he,Ie,He,Ge,mt){for(var ht=he,Rt=0,Tt=0;He<=Ge;He++){if(ht.value-he.value>Ie)return!1;j(6,Rt,Tt,X,ht);var wt=Y.l;if(Rt=Y.c,Tt=Y.lc,mt[He]=wt,wt==63){if(ht.value-he.value>Ie)throw"Something wrong with hufUnpackEncTable";j(8,Rt,Tt,X,ht);var Mt=Y.l+6;if(Rt=Y.c,Tt=Y.lc,He+Mt>Ge+1)throw"Something wrong with hufUnpackEncTable";for(;Mt--;)mt[He++]=0;He--}else if(wt>=59){var Mt=wt-59+2;if(He+Mt>Ge+1)throw"Something wrong with hufUnpackEncTable";for(;Mt--;)mt[He++]=0;He--}}fe(mt)}function se(X){return X&63}function Ae(X){return X>>6}function Pe(X,Z,he,Ie){for(;Z<=he;Z++){var He=Ae(X[Z]),Ge=se(X[Z]);if(He>>Ge)throw"Invalid table entry";if(Ge>14){var mt=Ie[He>>Ge-14];if(mt.len)throw"Invalid table entry";if(mt.lit++,mt.p){var ht=mt.p;mt.p=new Array(mt.lit);for(var Rt=0;Rt<mt.lit-1;++Rt)mt.p[Rt]=ht[Rt]}else mt.p=new Array(1);mt.p[mt.lit-1]=Z}else if(Ge)for(var Tt=0,Rt=1<<14-Ge;Rt>0;Rt--){var mt=Ie[(He<<14-Ge)+Tt];if(mt.len||mt.p)throw"Invalid table entry";mt.len=Ge,mt.lit=Z,Tt++}}return!0}const Re={c:0,lc:0};function $(X,Z,he,Ie){X=X<<8|Ut(he,Ie),Z+=8,Re.c=X,Re.lc=Z}const ae={c:0,lc:0};function Se(X,Z,he,Ie,He,Ge,mt,ht,Rt,Tt){if(X==Z){Ie<8&&($(he,Ie,He,mt),he=Re.c,Ie=Re.lc),Ie-=8;var wt=he>>Ie,wt=new Uint8Array([wt])[0];if(Rt.value+wt>Tt)return!1;for(var Mt=ht[Rt.value-1];wt-- >0;)ht[Rt.value++]=Mt}else if(Rt.value<Tt)ht[Rt.value++]=X;else return!1;ae.c=he,ae.lc=Ie}function ke(X){return X&65535}function dt(X){var Z=ke(X);return Z>32767?Z-65536:Z}const ve={a:0,b:0};function Le(X,Z){var he=dt(X),Ie=dt(Z),He=Ie,Ge=he+(He&1)+(He>>1),mt=Ge,ht=Ge-He;ve.a=mt,ve.b=ht}function lt(X,Z){var he=ke(X),Ie=ke(Z),He=he-(Ie>>1)&65535,Ge=Ie+He-32768&65535;ve.a=Ge,ve.b=He}function _t(X,Z,he,Ie,He,Ge,mt){for(var ht=mt<16384,Rt=he>He?He:he,Tt=1,wt;Tt<=Rt;)Tt<<=1;for(Tt>>=1,wt=Tt,Tt>>=1;Tt>=1;){for(var Mt=0,J=Mt+Ge*(He-wt),le=Ge*Tt,ye=Ge*wt,xe=Ie*Tt,me=Ie*wt,Qe,yt,Ze,Pt;Mt<=J;Mt+=ye){for(var It=Mt,jt=Mt+Ie*(he-wt);It<=jt;It+=me){var At=It+xe,Vt=It+le,_n=Vt+xe;ht?(Le(X[It+Z],X[Vt+Z]),Qe=ve.a,Ze=ve.b,Le(X[At+Z],X[_n+Z]),yt=ve.a,Pt=ve.b,Le(Qe,yt),X[It+Z]=ve.a,X[At+Z]=ve.b,Le(Ze,Pt),X[Vt+Z]=ve.a,X[_n+Z]=ve.b):(lt(X[It+Z],X[Vt+Z]),Qe=ve.a,Ze=ve.b,lt(X[At+Z],X[_n+Z]),yt=ve.a,Pt=ve.b,lt(Qe,yt),X[It+Z]=ve.a,X[At+Z]=ve.b,lt(Ze,Pt),X[Vt+Z]=ve.a,X[_n+Z]=ve.b)}if(he&Tt){var Vt=It+le;ht?Le(X[It+Z],X[Vt+Z]):lt(X[It+Z],X[Vt+Z]),Qe=ve.a,X[Vt+Z]=ve.b,X[It+Z]=Qe}}if(He&Tt)for(var It=Mt,jt=Mt+Ie*(he-wt);It<=jt;It+=me){var At=It+xe;ht?Le(X[It+Z],X[At+Z]):lt(X[It+Z],X[At+Z]),Qe=ve.a,X[At+Z]=ve.b,X[It+Z]=Qe}wt=Tt,Tt>>=1}return Mt}function Dt(X,Z,he,Ie,He,Ge,mt,ht,Rt,Tt){for(var wt=0,Mt=0,J=ht,le=Math.trunc(He.value+(Ge+7)/8);He.value<le;)for($(wt,Mt,he,He),wt=Re.c,Mt=Re.lc;Mt>=14;){var ye=wt>>Mt-14&16383,xe=Z[ye];if(xe.len)Mt-=xe.len,Se(xe.lit,mt,wt,Mt,he,Ie,He,Rt,Tt,J),wt=ae.c,Mt=ae.lc;else{if(!xe.p)throw"hufDecode issues";var me;for(me=0;me<xe.lit;me++){for(var Qe=se(X[xe.p[me]]);Mt<Qe&&He.value<le;)$(wt,Mt,he,He),wt=Re.c,Mt=Re.lc;if(Mt>=Qe&&Ae(X[xe.p[me]])==(wt>>Mt-Qe&(1<<Qe)-1)){Mt-=Qe,Se(xe.p[me],mt,wt,Mt,he,Ie,He,Rt,Tt,J),wt=ae.c,Mt=ae.lc;break}}if(me==xe.lit)throw"hufDecode issues"}}var yt=8-Ge&7;for(wt>>=yt,Mt-=yt;Mt>0;){var xe=Z[wt<<14-Mt&16383];if(xe.len)Mt-=xe.len,Se(xe.lit,mt,wt,Mt,he,Ie,He,Rt,Tt,J),wt=ae.c,Mt=ae.lc;else throw"hufDecode issues"}return!0}function qt(X,Z,he,Ie,He,Ge){var mt={value:0},ht=he.value,Rt=it(Z,he),Tt=it(Z,he);he.value+=4;var wt=it(Z,he);if(he.value+=4,Rt<0||Rt>=65537||Tt<0||Tt>=65537)throw"Something wrong with HUF_ENCSIZE";var Mt=new Array(65537),J=new Array(16384);z(J);var le=Ie-(he.value-ht);if(te(X,Z,he,le,Rt,Tt,Mt),wt>8*(Ie-(he.value-ht)))throw"Something wrong with hufUncompress";Pe(Mt,Rt,Tt,J),Dt(Mt,J,X,Z,he,wt,Tt,Ge,He,mt)}function un(X,Z,he){for(var Ie=0;Ie<he;++Ie)Z[Ie]=X[Z[Ie]]}function Yt(X){for(var Z=1;Z<X.length;Z++){var he=X[Z-1]+X[Z]-128;X[Z]=he}}function qe(X,Z){for(var he=0,Ie=Math.floor((X.length+1)/2),He=0,Ge=X.length-1;!(He>Ge||(Z[He++]=X[he++],He>Ge));)Z[He++]=X[Ie++]}function rt(X){for(var Z=X.byteLength,he=new Array,Ie=0,He=new DataView(X);Z>0;){var Ge=He.getInt8(Ie++);if(Ge<0){var mt=-Ge;Z-=mt+1;for(var ht=0;ht<mt;ht++)he.push(He.getUint8(Ie++))}else{var mt=Ge;Z-=2;for(var Rt=He.getUint8(Ie++),ht=0;ht<mt+1;ht++)he.push(Rt)}}return he}function Je(X,Z,he,Ie,He,Ge){var At=new DataView(Ge.buffer),mt=he[X.idx[0]].width,ht=he[X.idx[0]].height,Rt=3,Tt=Math.floor(mt/8),wt=Math.ceil(mt/8),Mt=Math.ceil(ht/8),J=mt-(wt-1)*8,le=ht-(Mt-1)*8,ye={value:0},xe=new Array(Rt),me=new Array(Rt),Qe=new Array(Rt),yt=new Array(Rt),Ze=new Array(Rt);for(let zt=0;zt<Rt;++zt)Ze[zt]=Z[X.idx[zt]],xe[zt]=zt<1?0:xe[zt-1]+wt*Mt,me[zt]=new Float32Array(64),Qe[zt]=new Uint16Array(64),yt[zt]=new Uint16Array(wt*64);for(let zt=0;zt<Mt;++zt){var Pt=8;zt==Mt-1&&(Pt=le);var It=8;for(let en=0;en<wt;++en){en==wt-1&&(It=J);for(let kt=0;kt<Rt;++kt)Qe[kt].fill(0),Qe[kt][0]=He[xe[kt]++],xt(ye,Ie,Qe[kt]),re(Qe[kt],me[kt]),Lt(me[kt]);vt(me);for(let kt=0;kt<Rt;++kt)Qt(me[kt],yt[kt],en*64)}let St=0;for(let en=0;en<Rt;++en){const kt=he[X.idx[en]].type;for(let Qn=8*zt;Qn<8*zt+Pt;++Qn){St=Ze[en][Qn];for(let dr=0;dr<Tt;++dr){const Ln=dr*64+(Qn&7)*8;At.setUint16(St+0*kt,yt[en][Ln+0],!0),At.setUint16(St+2*kt,yt[en][Ln+1],!0),At.setUint16(St+4*kt,yt[en][Ln+2],!0),At.setUint16(St+6*kt,yt[en][Ln+3],!0),At.setUint16(St+8*kt,yt[en][Ln+4],!0),At.setUint16(St+10*kt,yt[en][Ln+5],!0),At.setUint16(St+12*kt,yt[en][Ln+6],!0),At.setUint16(St+14*kt,yt[en][Ln+7],!0),St+=16*kt}}if(Tt!=wt)for(let Qn=8*zt;Qn<8*zt+Pt;++Qn){const dr=Ze[en][Qn]+8*Tt*2*kt,Ln=Tt*64+(Qn&7)*8;for(let Di=0;Di<It;++Di)At.setUint16(dr+Di*2*kt,yt[en][Ln+Di],!0)}}}for(var jt=new Uint16Array(mt),At=new DataView(Ge.buffer),Vt=0;Vt<Rt;++Vt){he[X.idx[Vt]].decoded=!0;var _n=he[X.idx[Vt]].type;if(he[Vt].type==2)for(var Kn=0;Kn<ht;++Kn){const zt=Ze[Vt][Kn];for(var Zt=0;Zt<mt;++Zt)jt[Zt]=At.getUint16(zt+Zt*2*_n,!0);for(var Zt=0;Zt<mt;++Zt)At.setFloat32(zt+Zt*2*_n,Ce(jt[Zt]),!0)}}}function xt(X,Z,he){for(var Ie,He=1;He<64;)Ie=Z[X.value],Ie==65280?He=64:Ie>>8==255?He+=Ie&255:(he[He]=Ie,He++),X.value++}function re(X,Z){Z[0]=Ce(X[0]),Z[1]=Ce(X[1]),Z[2]=Ce(X[5]),Z[3]=Ce(X[6]),Z[4]=Ce(X[14]),Z[5]=Ce(X[15]),Z[6]=Ce(X[27]),Z[7]=Ce(X[28]),Z[8]=Ce(X[2]),Z[9]=Ce(X[4]),Z[10]=Ce(X[7]),Z[11]=Ce(X[13]),Z[12]=Ce(X[16]),Z[13]=Ce(X[26]),Z[14]=Ce(X[29]),Z[15]=Ce(X[42]),Z[16]=Ce(X[3]),Z[17]=Ce(X[8]),Z[18]=Ce(X[12]),Z[19]=Ce(X[17]),Z[20]=Ce(X[25]),Z[21]=Ce(X[30]),Z[22]=Ce(X[41]),Z[23]=Ce(X[43]),Z[24]=Ce(X[9]),Z[25]=Ce(X[11]),Z[26]=Ce(X[18]),Z[27]=Ce(X[24]),Z[28]=Ce(X[31]),Z[29]=Ce(X[40]),Z[30]=Ce(X[44]),Z[31]=Ce(X[53]),Z[32]=Ce(X[10]),Z[33]=Ce(X[19]),Z[34]=Ce(X[23]),Z[35]=Ce(X[32]),Z[36]=Ce(X[39]),Z[37]=Ce(X[45]),Z[38]=Ce(X[52]),Z[39]=Ce(X[54]),Z[40]=Ce(X[20]),Z[41]=Ce(X[22]),Z[42]=Ce(X[33]),Z[43]=Ce(X[38]),Z[44]=Ce(X[46]),Z[45]=Ce(X[51]),Z[46]=Ce(X[55]),Z[47]=Ce(X[60]),Z[48]=Ce(X[21]),Z[49]=Ce(X[34]),Z[50]=Ce(X[37]),Z[51]=Ce(X[47]),Z[52]=Ce(X[50]),Z[53]=Ce(X[56]),Z[54]=Ce(X[59]),Z[55]=Ce(X[61]),Z[56]=Ce(X[35]),Z[57]=Ce(X[36]),Z[58]=Ce(X[48]),Z[59]=Ce(X[49]),Z[60]=Ce(X[57]),Z[61]=Ce(X[58]),Z[62]=Ce(X[62]),Z[63]=Ce(X[63])}function Lt(X){const Z=.5*Math.cos(.7853975),he=.5*Math.cos(3.14159/16),Ie=.5*Math.cos(3.14159/8),He=.5*Math.cos(3*3.14159/16),Ge=.5*Math.cos(5*3.14159/16),mt=.5*Math.cos(3*3.14159/8),ht=.5*Math.cos(7*3.14159/16);for(var Rt=new Array(4),Tt=new Array(4),wt=new Array(4),Mt=new Array(4),J=0;J<8;++J){var le=J*8;Rt[0]=Ie*X[le+2],Rt[1]=mt*X[le+2],Rt[2]=Ie*X[le+6],Rt[3]=mt*X[le+6],Tt[0]=he*X[le+1]+He*X[le+3]+Ge*X[le+5]+ht*X[le+7],Tt[1]=He*X[le+1]-ht*X[le+3]-he*X[le+5]-Ge*X[le+7],Tt[2]=Ge*X[le+1]-he*X[le+3]+ht*X[le+5]+He*X[le+7],Tt[3]=ht*X[le+1]-Ge*X[le+3]+He*X[le+5]-he*X[le+7],wt[0]=Z*(X[le+0]+X[le+4]),wt[3]=Z*(X[le+0]-X[le+4]),wt[1]=Rt[0]+Rt[3],wt[2]=Rt[1]-Rt[2],Mt[0]=wt[0]+wt[1],Mt[1]=wt[3]+wt[2],Mt[2]=wt[3]-wt[2],Mt[3]=wt[0]-wt[1],X[le+0]=Mt[0]+Tt[0],X[le+1]=Mt[1]+Tt[1],X[le+2]=Mt[2]+Tt[2],X[le+3]=Mt[3]+Tt[3],X[le+4]=Mt[3]-Tt[3],X[le+5]=Mt[2]-Tt[2],X[le+6]=Mt[1]-Tt[1],X[le+7]=Mt[0]-Tt[0]}for(var ye=0;ye<8;++ye)Rt[0]=Ie*X[16+ye],Rt[1]=mt*X[16+ye],Rt[2]=Ie*X[48+ye],Rt[3]=mt*X[48+ye],Tt[0]=he*X[8+ye]+He*X[24+ye]+Ge*X[40+ye]+ht*X[56+ye],Tt[1]=He*X[8+ye]-ht*X[24+ye]-he*X[40+ye]-Ge*X[56+ye],Tt[2]=Ge*X[8+ye]-he*X[24+ye]+ht*X[40+ye]+He*X[56+ye],Tt[3]=ht*X[8+ye]-Ge*X[24+ye]+He*X[40+ye]-he*X[56+ye],wt[0]=Z*(X[ye]+X[32+ye]),wt[3]=Z*(X[ye]-X[32+ye]),wt[1]=Rt[0]+Rt[3],wt[2]=Rt[1]-Rt[2],Mt[0]=wt[0]+wt[1],Mt[1]=wt[3]+wt[2],Mt[2]=wt[3]-wt[2],Mt[3]=wt[0]-wt[1],X[0+ye]=Mt[0]+Tt[0],X[8+ye]=Mt[1]+Tt[1],X[16+ye]=Mt[2]+Tt[2],X[24+ye]=Mt[3]+Tt[3],X[32+ye]=Mt[3]-Tt[3],X[40+ye]=Mt[2]-Tt[2],X[48+ye]=Mt[1]-Tt[1],X[56+ye]=Mt[0]-Tt[0]}function vt(X){for(var Z=0;Z<64;++Z){var he=X[0][Z],Ie=X[1][Z],He=X[2][Z];X[0][Z]=he+1.5747*He,X[1][Z]=he-.1873*Ie-.4682*He,X[2][Z]=he+1.8556*Ie}}function Qt(X,Z,he){for(var Ie=0;Ie<64;++Ie)Z[he+Ie]=Od.toHalfFloat(bt(X[Ie]))}function bt(X){return X<=1?Math.sign(X)*Math.pow(Math.abs(X),2.2):Math.sign(X)*Math.pow(R,Math.abs(X)-1)}function ee(X){return new DataView(X.array.buffer,X.offset.value,X.size)}function q(X){var Z=X.viewer.buffer.slice(X.offset.value,X.offset.value+X.size),he=new Uint8Array(rt(Z)),Ie=new Uint8Array(he.length);return Yt(he),qe(he,Ie),new DataView(Ie.buffer)}function ge(X){var Z=X.array.slice(X.offset.value,X.offset.value+X.size),he=Qx(Z),Ie=new Uint8Array(he.length);return Yt(he),qe(he,Ie),new DataView(Ie.buffer)}function Fe(X){for(var Z=X.viewer,he={value:X.offset.value},Ie=new Uint16Array(X.width*X.scanlineBlockSize*(X.channels*X.type)),He=new Uint8Array(8192),Ge=0,mt=new Array(X.channels),ht=0;ht<X.channels;ht++)mt[ht]={},mt[ht].start=Ge,mt[ht].end=mt[ht].start,mt[ht].nx=X.width,mt[ht].ny=X.lines,mt[ht].size=X.type,Ge+=mt[ht].nx*mt[ht].ny*mt[ht].size;var Rt=at(Z,he),Tt=at(Z,he);if(Tt>=8192)throw"Something is wrong with PIZ_COMPRESSION BITMAP_SIZE";if(Rt<=Tt)for(var ht=0;ht<Tt-Rt+1;ht++)He[ht+Rt]=oe(Z,he);var wt=new Uint16Array(65536),Mt=P(He,wt),J=it(Z,he);qt(X.array,Z,he,J,Ie,Ge);for(var ht=0;ht<X.channels;++ht)for(var le=mt[ht],ye=0;ye<mt[ht].size;++ye)_t(Ie,le.start+ye,le.nx,le.size,le.ny,le.nx*le.size,Mt);un(wt,Ie,Ge);for(var xe=0,me=new Uint8Array(Ie.buffer.byteLength),Qe=0;Qe<X.lines;Qe++)for(var yt=0;yt<X.channels;yt++){var le=mt[yt],Ze=le.nx*le.size,Pt=new Uint8Array(Ie.buffer,le.end*2,Ze*2);me.set(Pt,xe),xe+=Ze*2,le.end+=Ze}return new DataView(me.buffer)}function Xe(X){var Z=X.array.slice(X.offset.value,X.offset.value+X.size),he=Qx(Z);const Ie=X.lines*X.channels*X.width,He=X.type==1?new Uint16Array(Ie):new Uint32Array(Ie);let Ge=0,mt=0;const ht=new Array(4);for(let Rt=0;Rt<X.lines;Rt++)for(let Tt=0;Tt<X.channels;Tt++){let wt=0;switch(X.type){case 1:ht[0]=Ge,ht[1]=ht[0]+X.width,Ge=ht[1]+X.width;for(let Mt=0;Mt<X.width;++Mt){const J=he[ht[0]++]<<8|he[ht[1]++];wt+=J,He[mt]=wt,mt++}break;case 2:ht[0]=Ge,ht[1]=ht[0]+X.width,ht[2]=ht[1]+X.width,Ge=ht[2]+X.width;for(let Mt=0;Mt<X.width;++Mt){const J=he[ht[0]++]<<24|he[ht[1]++]<<16|he[ht[2]++]<<8;wt+=J,He[mt]=wt,mt++}break}}return new DataView(He.buffer)}function Ue(X){var Z=X.viewer,he={value:X.offset.value},Ie=new Uint8Array(X.width*X.lines*(X.channels*X.type*2)),He={version:Te(Z,he),unknownUncompressedSize:Te(Z,he),unknownCompressedSize:Te(Z,he),acCompressedSize:Te(Z,he),dcCompressedSize:Te(Z,he),rleCompressedSize:Te(Z,he),rleUncompressedSize:Te(Z,he),rleRawSize:Te(Z,he),totalAcUncompressedCount:Te(Z,he),totalDcUncompressedCount:Te(Z,he),acCompression:Te(Z,he)};if(He.version<2)throw"EXRLoader.parse: "+Es.compression+" version "+He.version+" is unsupported";for(var Ge=new Array,mt=at(Z,he)-2;mt>0;){var ht=Ft(Z.buffer,he),Rt=oe(Z,he),Tt=Rt>>2&3,wt=(Rt>>4)-1,Mt=new Int8Array([wt])[0],J=oe(Z,he);Ge.push({name:ht,index:Mt,type:J,compression:Tt}),mt-=ht.length+3}for(var le=Es.channels,ye=new Array(X.channels),xe=0;xe<X.channels;++xe){var me=ye[xe]={},Qe=le[xe];me.name=Qe.name,me.compression=0,me.decoded=!1,me.type=Qe.pixelType,me.pLinear=Qe.pLinear,me.width=X.width,me.height=X.lines}for(var yt={idx:new Array(3)},Ze=0;Ze<X.channels;++Ze)for(var me=ye[Ze],xe=0;xe<Ge.length;++xe){var Pt=Ge[xe];me.name==Pt.name&&(me.compression=Pt.compression,Pt.index>=0&&(yt.idx[Pt.index]=Ze),me.offset=Ze)}if(He.acCompressedSize>0)switch(He.acCompression){case 0:var At=new Uint16Array(He.totalAcUncompressedCount);qt(X.array,Z,he,He.acCompressedSize,At,He.totalAcUncompressedCount);break;case 1:var It=X.array.slice(he.value,he.value+He.totalAcUncompressedCount),jt=Qx(It),At=new Uint16Array(jt.buffer);he.value+=He.totalAcUncompressedCount;break}if(He.dcCompressedSize>0){var Vt={array:X.array,offset:he,size:He.dcCompressedSize},_n=new Uint16Array(ge(Vt).buffer);he.value+=He.dcCompressedSize}if(He.rleRawSize>0){var It=X.array.slice(he.value,he.value+He.rleCompressedSize),jt=Qx(It),Kn=rt(jt.buffer);he.value+=He.rleCompressedSize}for(var Zt=0,zt=new Array(ye.length),xe=0;xe<zt.length;++xe)zt[xe]=new Array;for(var St=0;St<X.lines;++St)for(var en=0;en<ye.length;++en)zt[en].push(Zt),Zt+=ye[en].width*X.type*2;Je(yt,zt,ye,At,_n,Ie);for(var xe=0;xe<ye.length;++xe){var me=ye[xe];if(!me.decoded)switch(me.compression){case 2:for(var kt=0,Qn=0,St=0;St<X.lines;++St){for(var dr=zt[xe][kt],Ln=0;Ln<me.width;++Ln){for(var Di=0;Di<2*me.type;++Di)Ie[dr++]=Kn[Qn+Di*me.width*me.height];Qn++}kt++}break;case 1:default:throw"EXRLoader.parse: unsupported channel compression"}}return new DataView(Ie.buffer)}function Ft(X,Z){for(var he=new Uint8Array(X),Ie=0;he[Z.value+Ie]!=0;)Ie+=1;var He=new TextDecoder().decode(he.slice(Z.value,Z.value+Ie));return Z.value=Z.value+Ie+1,He}function Ct(X,Z,he){var Ie=new TextDecoder().decode(new Uint8Array(X).slice(Z.value,Z.value+he));return Z.value=Z.value+he,Ie}function Xt(X,Z){var he=tt(X,Z),Ie=it(X,Z);return[he,Ie]}function an(X,Z){var he=it(X,Z),Ie=it(X,Z);return[he,Ie]}function tt(X,Z){var he=X.getInt32(Z.value,!0);return Z.value=Z.value+4,he}function it(X,Z){var he=X.getUint32(Z.value,!0);return Z.value=Z.value+4,he}function Ut(X,Z){var he=X[Z.value];return Z.value=Z.value+1,he}function oe(X,Z){var he=X.getUint8(Z.value);return Z.value=Z.value+1,he}const Te=function(X,Z){let he;return"getBigInt64"in DataView.prototype?he=Number(X.getBigInt64(Z.value,!0)):he=X.getUint32(Z.value+4,!0)+Number(X.getUint32(Z.value,!0)<<32),Z.value+=8,he};function ot(X,Z){var he=X.getFloat32(Z.value,!0);return Z.value+=4,he}function ue(X,Z){return Od.toHalfFloat(ot(X,Z))}function Ce(X){var Z=(X&31744)>>10,he=X&1023;return(X>>15?-1:1)*(Z?Z===31?he?NaN:1/0:Math.pow(2,Z-15)*(1+he/1024):6103515625e-14*(he/1024))}function at(X,Z){var he=X.getUint16(Z.value,!0);return Z.value+=2,he}function gt(X,Z){return Ce(at(X,Z))}function ut(X,Z,he,Ie){for(var He=he.value,Ge=[];he.value<He+Ie-1;){var mt=Ft(Z,he),ht=tt(X,he),Rt=oe(X,he);he.value+=3;var Tt=tt(X,he),wt=tt(X,he);Ge.push({name:mt,pixelType:ht,pLinear:Rt,xSampling:Tt,ySampling:wt})}return he.value+=1,Ge}function Ye(X,Z){var he=ot(X,Z),Ie=ot(X,Z),He=ot(X,Z),Ge=ot(X,Z),mt=ot(X,Z),ht=ot(X,Z),Rt=ot(X,Z),Tt=ot(X,Z);return{redX:he,redY:Ie,greenX:He,greenY:Ge,blueX:mt,blueY:ht,whiteX:Rt,whiteY:Tt}}function pt(X,Z){var he=["NO_COMPRESSION","RLE_COMPRESSION","ZIPS_COMPRESSION","ZIP_COMPRESSION","PIZ_COMPRESSION","PXR24_COMPRESSION","B44_COMPRESSION","B44A_COMPRESSION","DWAA_COMPRESSION","DWAB_COMPRESSION"],Ie=oe(X,Z);return he[Ie]}function rn(X,Z){var he=it(X,Z),Ie=it(X,Z),He=it(X,Z),Ge=it(X,Z);return{xMin:he,yMin:Ie,xMax:He,yMax:Ge}}function Tn(X,Z){var he=["INCREASING_Y"],Ie=oe(X,Z);return he[Ie]}function yn(X,Z){var he=ot(X,Z),Ie=ot(X,Z);return[he,Ie]}function Ii(X,Z){var he=ot(X,Z),Ie=ot(X,Z),He=ot(X,Z);return[he,Ie,He]}function Xi(X,Z,he,Ie,He){if(Ie==="string"||Ie==="stringvector"||Ie==="iccProfile")return Ct(Z,he,He);if(Ie==="chlist")return ut(X,Z,he,He);if(Ie==="chromaticities")return Ye(X,he);if(Ie==="compression")return pt(X,he);if(Ie==="box2i")return rn(X,he);if(Ie==="lineOrder")return Tn(X,he);if(Ie==="float")return ot(X,he);if(Ie==="v2f")return yn(X,he);if(Ie==="v3f")return Ii(X,he);if(Ie==="int")return tt(X,he);if(Ie==="rational")return Xt(X,he);if(Ie==="timecode")return an(X,he);if(Ie==="preview")return he.value+=He,"skipped";he.value+=He}function As(X,Z,he){const Ie={};if(X.getUint32(0,!0)!=20000630)throw"THREE.EXRLoader: provided file doesn't appear to be in OpenEXR format.";Ie.version=X.getUint8(4);const He=X.getUint8(5);Ie.spec={singleTile:!!(He&2),longName:!!(He&4),deepFormat:!!(He&8),multiPart:!!(He&16)},he.value=8;for(var Ge=!0;Ge;){var mt=Ft(Z,he);if(mt==0)Ge=!1;else{var ht=Ft(Z,he),Rt=it(X,he),Tt=Xi(X,Z,he,ht,Rt);Tt===void 0?console.warn(`EXRLoader.parse: skipped unknown header attribute type '${ht}'.`):Ie[mt]=Tt}}if((He&-5)!=0)throw console.error("EXRHeader:",Ie),"THREE.EXRLoader: provided file is currently unsupported.";return Ie}function fa(X,Z,he,Ie,He){const Ge={size:0,viewer:Z,array:he,offset:Ie,width:X.dataWindow.xMax-X.dataWindow.xMin+1,height:X.dataWindow.yMax-X.dataWindow.yMin+1,channels:X.channels.length,bytesPerLine:null,lines:null,inputSize:null,type:X.channels[0].pixelType,uncompress:null,getter:null,format:null,[uv?"colorSpace":"encoding"]:null};switch(X.compression){case"NO_COMPRESSION":Ge.lines=1,Ge.uncompress=ee;break;case"RLE_COMPRESSION":Ge.lines=1,Ge.uncompress=q;break;case"ZIPS_COMPRESSION":Ge.lines=1,Ge.uncompress=ge;break;case"ZIP_COMPRESSION":Ge.lines=16,Ge.uncompress=ge;break;case"PIZ_COMPRESSION":Ge.lines=32,Ge.uncompress=Fe;break;case"PXR24_COMPRESSION":Ge.lines=16,Ge.uncompress=Xe;break;case"DWAA_COMPRESSION":Ge.lines=32,Ge.uncompress=Ue;break;case"DWAB_COMPRESSION":Ge.lines=256,Ge.uncompress=Ue;break;default:throw"EXRLoader.parse: "+X.compression+" is unsupported"}if(Ge.scanlineBlockSize=Ge.lines,Ge.type==1)switch(He){case ir:Ge.getter=gt,Ge.inputSize=2;break;case Er:Ge.getter=at,Ge.inputSize=2;break}else if(Ge.type==2)switch(He){case ir:Ge.getter=ot,Ge.inputSize=4;break;case Er:Ge.getter=ue,Ge.inputSize=4}else throw"EXRLoader.parse: unsupported pixelType "+Ge.type+" for "+X.compression+".";Ge.blockCount=(X.dataWindow.yMax+1)/Ge.scanlineBlockSize;for(var mt=0;mt<Ge.blockCount;mt++)Te(Z,Ie);Ge.outputChannels=Ge.channels==3?4:Ge.channels;const ht=Ge.width*Ge.height*Ge.outputChannels;switch(He){case ir:Ge.byteArray=new Float32Array(ht),Ge.channels<Ge.outputChannels&&Ge.byteArray.fill(1,0,ht);break;case Er:Ge.byteArray=new Uint16Array(ht),Ge.channels<Ge.outputChannels&&Ge.byteArray.fill(15360,0,ht);break;default:console.error("THREE.EXRLoader: unsupported type: ",He);break}return Ge.bytesPerLine=Ge.width*Ge.inputSize*Ge.channels,Ge.outputChannels==4?Ge.format=jr:Ge.format=_y,uv?Ge.colorSpace="srgb-linear":Ge.encoding=3e3,Ge}const Ss=new DataView(e),Ws=new Uint8Array(e),fr={value:0},Es=As(Ss,e,fr),sn=fa(Es,Ss,Ws,fr,this.type),Br={value:0},Si={R:0,G:1,B:2,A:3,Y:0};for(let X=0;X<sn.height/sn.scanlineBlockSize;X++){const Z=it(Ss,fr);sn.size=it(Ss,fr),sn.lines=Z+sn.scanlineBlockSize>sn.height?sn.height-Z:sn.scanlineBlockSize;const Ie=sn.size<sn.lines*sn.bytesPerLine?sn.uncompress(sn):ee(sn);fr.value+=sn.size;for(let He=0;He<sn.scanlineBlockSize;He++){const Ge=He+X*sn.scanlineBlockSize;if(Ge>=sn.height)break;for(let mt=0;mt<sn.channels;mt++){const ht=Si[Es.channels[mt].name];for(let Rt=0;Rt<sn.width;Rt++){Br.value=(He*(sn.channels*sn.width)+mt*sn.width+Rt)*sn.inputSize;const Tt=(sn.height-1-Ge)*(sn.width*sn.outputChannels)+Rt*sn.outputChannels+ht;sn.byteArray[Tt]=sn.getter(Ie,Br)}}}}return{header:Es,width:sn.width,height:sn.height,data:sn.byteArray,format:sn.format,[uv?"colorSpace":"encoding"]:sn[uv?"colorSpace":"encoding"],type:this.type}}setDataType(e){return this.type=e,this}load(e,t,n,r){function s(o,u){uv?o.colorSpace=u.colorSpace:o.encoding=u.encoding,o.minFilter=Jn,o.magFilter=Jn,o.generateMipmaps=!1,o.flipY=!1,t&&t(o,u)}return super.load(e,s,n,r)}}const X1=new WeakMap;class WJ extends js{constructor(e){super(e),this.decoderPath="",this.decoderConfig={},this.decoderBinary=null,this.decoderPending=null,this.workerLimit=4,this.workerPool=[],this.workerNextTaskID=1,this.workerSourceURL="",this.defaultAttributeIDs={position:"POSITION",normal:"NORMAL",color:"COLOR",uv:"TEX_COORD"},this.defaultAttributeTypes={position:"Float32Array",normal:"Float32Array",color:"Float32Array",uv:"Float32Array"}}setDecoderPath(e){return this.decoderPath=e,this}setDecoderConfig(e){return this.decoderConfig=e,this}setWorkerLimit(e){return this.workerLimit=e,this}load(e,t,n,r){const s=new zs(this.manager);s.setPath(this.path),s.setResponseType("arraybuffer"),s.setRequestHeader(this.requestHeader),s.setWithCredentials(this.withCredentials),s.load(e,o=>{const u={attributeIDs:this.defaultAttributeIDs,attributeTypes:this.defaultAttributeTypes,useUniqueIDs:!1};this.decodeGeometry(o,u).then(t).catch(r)},n,r)}decodeDracoFile(e,t,n,r){const s={attributeIDs:n||this.defaultAttributeIDs,attributeTypes:r||this.defaultAttributeTypes,useUniqueIDs:!!n};this.decodeGeometry(e,s).then(t)}decodeGeometry(e,t){for(const f in t.attributeTypes){const p=t.attributeTypes[f];p.BYTES_PER_ELEMENT!==void 0&&(t.attributeTypes[f]=p.name)}const n=JSON.stringify(t);if(X1.has(e)){const f=X1.get(e);if(f.key===n)return f.promise;if(e.byteLength===0)throw new Error("THREE.DRACOLoader: Unable to re-decode a buffer with different settings. Buffer has already been transferred.")}let r;const s=this.workerNextTaskID++,o=e.byteLength,u=this._getWorker(s,o).then(f=>(r=f,new Promise((p,g)=>{r._callbacks[s]={resolve:p,reject:g},r.postMessage({type:"decode",id:s,taskConfig:t,buffer:e},[e])}))).then(f=>this._createGeometry(f.geometry));return u.catch(()=>!0).then(()=>{r&&s&&this._releaseTask(r,s)}),X1.set(e,{key:n,promise:u}),u}_createGeometry(e){const t=new wn;e.index&&t.setIndex(new gi(e.index.array,1));for(let n=0;n<e.attributes.length;n++){const r=e.attributes[n],s=r.name,o=r.array,u=r.itemSize;t.setAttribute(s,new gi(o,u))}return t}_loadLibrary(e,t){const n=new zs(this.manager);return n.setPath(this.decoderPath),n.setResponseType(t),n.setWithCredentials(this.withCredentials),new Promise((r,s)=>{n.load(e,r,void 0,s)})}preload(){return this._initDecoder(),this}_initDecoder(){if(this.decoderPending)return this.decoderPending;const e=typeof WebAssembly!="object"||this.decoderConfig.type==="js",t=[];return e?t.push(this._loadLibrary("draco_decoder.js","text")):(t.push(this._loadLibrary("draco_wasm_wrapper.js","text")),t.push(this._loadLibrary("draco_decoder.wasm","arraybuffer"))),this.decoderPending=Promise.all(t).then(n=>{const r=n[0];e||(this.decoderConfig.wasmBinary=n[1]);const s=qJ.toString(),o=["/* draco decoder */",r,"","/* worker */",s.substring(s.indexOf("{")+1,s.lastIndexOf("}"))].join(`
`);this.workerSourceURL=URL.createObjectURL(new Blob([o]))}),this.decoderPending}_getWorker(e,t){return this._initDecoder().then(()=>{if(this.workerPool.length<this.workerLimit){const r=new Worker(this.workerSourceURL);r._callbacks={},r._taskCosts={},r._taskLoad=0,r.postMessage({type:"init",decoderConfig:this.decoderConfig}),r.onmessage=function(s){const o=s.data;switch(o.type){case"decode":r._callbacks[o.id].resolve(o);break;case"error":r._callbacks[o.id].reject(o);break;default:console.error('THREE.DRACOLoader: Unexpected message, "'+o.type+'"')}},this.workerPool.push(r)}else this.workerPool.sort(function(r,s){return r._taskLoad>s._taskLoad?-1:1});const n=this.workerPool[this.workerPool.length-1];return n._taskCosts[e]=t,n._taskLoad+=t,n})}_releaseTask(e,t){e._taskLoad-=e._taskCosts[t],delete e._callbacks[t],delete e._taskCosts[t]}debug(){console.log("Task load: ",this.workerPool.map(e=>e._taskLoad))}dispose(){for(let e=0;e<this.workerPool.length;++e)this.workerPool[e].terminate();return this.workerPool.length=0,this}}function qJ(){let i,e;onmessage=function(o){const u=o.data;switch(u.type){case"init":i=u.decoderConfig,e=new Promise(function(g){i.onModuleLoaded=function(v){g({draco:v})},DracoDecoderModule(i)});break;case"decode":const f=u.buffer,p=u.taskConfig;e.then(g=>{const v=g.draco,_=new v.Decoder,x=new v.DecoderBuffer;x.Init(new Int8Array(f),f.byteLength);try{const E=t(v,_,x,p),C=E.attributes.map(w=>w.array.buffer);E.index&&C.push(E.index.array.buffer),self.postMessage({type:"decode",id:u.id,geometry:E},C)}catch(E){console.error(E),self.postMessage({type:"error",id:u.id,error:E.message})}finally{v.destroy(x),v.destroy(_)}});break}};function t(o,u,f,p){const g=p.attributeIDs,v=p.attributeTypes;let _,x;const E=u.GetEncodedGeometryType(f);if(E===o.TRIANGULAR_MESH)_=new o.Mesh,x=u.DecodeBufferToMesh(f,_);else if(E===o.POINT_CLOUD)_=new o.PointCloud,x=u.DecodeBufferToPointCloud(f,_);else throw new Error("THREE.DRACOLoader: Unexpected geometry type.");if(!x.ok()||_.ptr===0)throw new Error("THREE.DRACOLoader: Decoding failed: "+x.error_msg());const C={index:null,attributes:[]};for(const w in g){const T=self[v[w]];let N,L;if(p.useUniqueIDs)L=g[w],N=u.GetAttributeByUniqueId(_,L);else{if(L=u.GetAttributeId(_,o[g[w]]),L===-1)continue;N=u.GetAttribute(_,L)}C.attributes.push(r(o,u,_,w,T,N))}return E===o.TRIANGULAR_MESH&&(C.index=n(o,u,_)),o.destroy(_),C}function n(o,u,f){const g=f.num_faces()*3,v=g*4,_=o._malloc(v);u.GetTrianglesUInt32Array(f,v,_);const x=new Uint32Array(o.HEAPF32.buffer,_,g).slice();return o._free(_),{array:x,itemSize:1}}function r(o,u,f,p,g,v){const _=v.num_components(),E=f.num_points()*_,C=E*g.BYTES_PER_ELEMENT,w=s(o,g),T=o._malloc(C);u.GetAttributeDataArrayForAllPoints(f,v,w,C,T);const N=new g(o.HEAPF32.buffer,T,E).slice();return o._free(T),{name:p,array:N,itemSize:_}}function s(o,u){switch(u){case Float32Array:return o.DT_FLOAT32;case Int8Array:return o.DT_INT8;case Int16Array:return o.DT_INT16;case Int32Array:return o.DT_INT32;case Uint8Array:return o.DT_UINT8;case Uint16Array:return o.DT_UINT16;case Uint32Array:return o.DT_UINT32}}}let $x;const Y1=()=>{if($x)return $x;const i="B9h9z9tFBBBF8fL9gBB9gLaaaaaFa9gEaaaB9gFaFa9gEaaaFaEMcBFFFGGGEIIILF9wFFFLEFBFKNFaFCx/IFMO/LFVK9tv9t9vq95GBt9f9f939h9z9t9f9j9h9s9s9f9jW9vq9zBBp9tv9z9o9v9wW9f9kv9j9v9kv9WvqWv94h919m9mvqBF8Z9tv9z9o9v9wW9f9kv9j9v9kv9J9u9kv94h919m9mvqBGy9tv9z9o9v9wW9f9kv9j9v9kv9J9u9kv949TvZ91v9u9jvBEn9tv9z9o9v9wW9f9kv9j9v9kv69p9sWvq9P9jWBIi9tv9z9o9v9wW9f9kv9j9v9kv69p9sWvq9R919hWBLn9tv9z9o9v9wW9f9kv9j9v9kv69p9sWvq9F949wBKI9z9iqlBOc+x8ycGBM/qQFTa8jUUUUBCU/EBlHL8kUUUUBC9+RKGXAGCFJAI9LQBCaRKAE2BBC+gF9HQBALAEAIJHOAGlAGTkUUUBRNCUoBAG9uC/wgBZHKCUGAKCUG9JyRVAECFJRICBRcGXEXAcAF9PQFAVAFAclAcAVJAF9JyRMGXGXAG9FQBAMCbJHKC9wZRSAKCIrCEJCGrRQANCUGJRfCBRbAIRTEXGXAOATlAQ9PQBCBRISEMATAQJRIGXAS9FQBCBRtCBREEXGXAOAIlCi9PQBCBRISLMANCU/CBJAEJRKGXGXGXGXGXATAECKrJ2BBAtCKZrCEZfIBFGEBMAKhB83EBAKCNJhB83EBSEMAKAI2BIAI2BBHmCKrHYAYCE6HYy86BBAKCFJAICIJAYJHY2BBAmCIrCEZHPAPCE6HPy86BBAKCGJAYAPJHY2BBAmCGrCEZHPAPCE6HPy86BBAKCEJAYAPJHY2BBAmCEZHmAmCE6Hmy86BBAKCIJAYAmJHY2BBAI2BFHmCKrHPAPCE6HPy86BBAKCLJAYAPJHY2BBAmCIrCEZHPAPCE6HPy86BBAKCKJAYAPJHY2BBAmCGrCEZHPAPCE6HPy86BBAKCOJAYAPJHY2BBAmCEZHmAmCE6Hmy86BBAKCNJAYAmJHY2BBAI2BGHmCKrHPAPCE6HPy86BBAKCVJAYAPJHY2BBAmCIrCEZHPAPCE6HPy86BBAKCcJAYAPJHY2BBAmCGrCEZHPAPCE6HPy86BBAKCMJAYAPJHY2BBAmCEZHmAmCE6Hmy86BBAKCSJAYAmJHm2BBAI2BEHICKrHYAYCE6HYy86BBAKCQJAmAYJHm2BBAICIrCEZHYAYCE6HYy86BBAKCfJAmAYJHm2BBAICGrCEZHYAYCE6HYy86BBAKCbJAmAYJHK2BBAICEZHIAICE6HIy86BBAKAIJRISGMAKAI2BNAI2BBHmCIrHYAYCb6HYy86BBAKCFJAICNJAYJHY2BBAmCbZHmAmCb6Hmy86BBAKCGJAYAmJHm2BBAI2BFHYCIrHPAPCb6HPy86BBAKCEJAmAPJHm2BBAYCbZHYAYCb6HYy86BBAKCIJAmAYJHm2BBAI2BGHYCIrHPAPCb6HPy86BBAKCLJAmAPJHm2BBAYCbZHYAYCb6HYy86BBAKCKJAmAYJHm2BBAI2BEHYCIrHPAPCb6HPy86BBAKCOJAmAPJHm2BBAYCbZHYAYCb6HYy86BBAKCNJAmAYJHm2BBAI2BIHYCIrHPAPCb6HPy86BBAKCVJAmAPJHm2BBAYCbZHYAYCb6HYy86BBAKCcJAmAYJHm2BBAI2BLHYCIrHPAPCb6HPy86BBAKCMJAmAPJHm2BBAYCbZHYAYCb6HYy86BBAKCSJAmAYJHm2BBAI2BKHYCIrHPAPCb6HPy86BBAKCQJAmAPJHm2BBAYCbZHYAYCb6HYy86BBAKCfJAmAYJHm2BBAI2BOHICIrHYAYCb6HYy86BBAKCbJAmAYJHK2BBAICbZHIAICb6HIy86BBAKAIJRISFMAKAI8pBB83BBAKCNJAICNJ8pBB83BBAICTJRIMAtCGJRtAECTJHEAS9JQBMMGXAIQBCBRISEMGXAM9FQBANAbJ2BBRtCBRKAfREEXAEANCU/CBJAKJ2BBHTCFrCBATCFZl9zAtJHt86BBAEAGJREAKCFJHKAM9HQBMMAfCFJRfAIRTAbCFJHbAG9HQBMMABAcAG9sJANCUGJAMAG9sTkUUUBpANANCUGJAMCaJAG9sJAGTkUUUBpMAMCBAIyAcJRcAIQBMC9+RKSFMCBC99AOAIlAGCAAGCA9Ly6yRKMALCU/EBJ8kUUUUBAKM+OmFTa8jUUUUBCoFlHL8kUUUUBC9+RKGXAFCE9uHOCtJAI9LQBCaRKAE2BBHNC/wFZC/gF9HQBANCbZHVCF9LQBALCoBJCgFCUFT+JUUUBpALC84Jha83EBALC8wJha83EBALC8oJha83EBALCAJha83EBALCiJha83EBALCTJha83EBALha83ENALha83EBAEAIJC9wJRcAECFJHNAOJRMGXAF9FQBCQCbAVCF6yRSABRECBRVCBRQCBRfCBRICBRKEXGXAMAcuQBC9+RKSEMGXGXAN2BBHOC/vF9LQBALCoBJAOCIrCa9zAKJCbZCEWJHb8oGIRTAb8oGBRtGXAOCbZHbAS9PQBALAOCa9zAIJCbZCGWJ8oGBAVAbyROAb9FRbGXGXAGCG9HQBABAt87FBABCIJAO87FBABCGJAT87FBSFMAEAtjGBAECNJAOjGBAECIJATjGBMAVAbJRVALCoBJAKCEWJHmAOjGBAmATjGIALAICGWJAOjGBALCoBJAKCFJCbZHKCEWJHTAtjGBATAOjGIAIAbJRIAKCFJRKSGMGXGXAbCb6QBAQAbJAbC989zJCFJRQSFMAM1BBHbCgFZROGXGXAbCa9MQBAMCFJRMSFMAM1BFHbCgBZCOWAOCgBZqROGXAbCa9MQBAMCGJRMSFMAM1BGHbCgBZCfWAOqROGXAbCa9MQBAMCEJRMSFMAM1BEHbCgBZCdWAOqROGXAbCa9MQBAMCIJRMSFMAM2BIC8cWAOqROAMCLJRMMAOCFrCBAOCFZl9zAQJRQMGXGXAGCG9HQBABAt87FBABCIJAQ87FBABCGJAT87FBSFMAEAtjGBAECNJAQjGBAECIJATjGBMALCoBJAKCEWJHOAQjGBAOATjGIALAICGWJAQjGBALCoBJAKCFJCbZHKCEWJHOAtjGBAOAQjGIAICFJRIAKCFJRKSFMGXAOCDF9LQBALAIAcAOCbZJ2BBHbCIrHTlCbZCGWJ8oGBAVCFJHtATyROALAIAblCbZCGWJ8oGBAtAT9FHmJHtAbCbZHTyRbAT9FRTGXGXAGCG9HQBABAV87FBABCIJAb87FBABCGJAO87FBSFMAEAVjGBAECNJAbjGBAECIJAOjGBMALAICGWJAVjGBALCoBJAKCEWJHYAOjGBAYAVjGIALAICFJHICbZCGWJAOjGBALCoBJAKCFJCbZCEWJHYAbjGBAYAOjGIALAIAmJCbZHICGWJAbjGBALCoBJAKCGJCbZHKCEWJHOAVjGBAOAbjGIAKCFJRKAIATJRIAtATJRVSFMAVCBAM2BBHYyHTAOC/+F6HPJROAYCbZRtGXGXAYCIrHmQBAOCFJRbSFMAORbALAIAmlCbZCGWJ8oGBROMGXGXAtQBAbCFJRVSFMAbRVALAIAYlCbZCGWJ8oGBRbMGXGXAP9FQBAMCFJRYSFMAM1BFHYCgFZRTGXGXAYCa9MQBAMCGJRYSFMAM1BGHYCgBZCOWATCgBZqRTGXAYCa9MQBAMCEJRYSFMAM1BEHYCgBZCfWATqRTGXAYCa9MQBAMCIJRYSFMAM1BIHYCgBZCdWATqRTGXAYCa9MQBAMCLJRYSFMAMCKJRYAM2BLC8cWATqRTMATCFrCBATCFZl9zAQJHQRTMGXGXAmCb6QBAYRPSFMAY1BBHMCgFZROGXGXAMCa9MQBAYCFJRPSFMAY1BFHMCgBZCOWAOCgBZqROGXAMCa9MQBAYCGJRPSFMAY1BGHMCgBZCfWAOqROGXAMCa9MQBAYCEJRPSFMAY1BEHMCgBZCdWAOqROGXAMCa9MQBAYCIJRPSFMAYCLJRPAY2BIC8cWAOqROMAOCFrCBAOCFZl9zAQJHQROMGXGXAtCb6QBAPRMSFMAP1BBHMCgFZRbGXGXAMCa9MQBAPCFJRMSFMAP1BFHMCgBZCOWAbCgBZqRbGXAMCa9MQBAPCGJRMSFMAP1BGHMCgBZCfWAbqRbGXAMCa9MQBAPCEJRMSFMAP1BEHMCgBZCdWAbqRbGXAMCa9MQBAPCIJRMSFMAPCLJRMAP2BIC8cWAbqRbMAbCFrCBAbCFZl9zAQJHQRbMGXGXAGCG9HQBABAT87FBABCIJAb87FBABCGJAO87FBSFMAEATjGBAECNJAbjGBAECIJAOjGBMALCoBJAKCEWJHYAOjGBAYATjGIALAICGWJATjGBALCoBJAKCFJCbZCEWJHYAbjGBAYAOjGIALAICFJHICbZCGWJAOjGBALCoBJAKCGJCbZCEWJHOATjGBAOAbjGIALAIAm9FAmCb6qJHICbZCGWJAbjGBAIAt9FAtCb6qJRIAKCEJRKMANCFJRNABCKJRBAECSJREAKCbZRKAICbZRIAfCEJHfAF9JQBMMCBC99AMAc6yRKMALCoFJ8kUUUUBAKM/tIFGa8jUUUUBCTlRLC9+RKGXAFCLJAI9LQBCaRKAE2BBC/+FZC/QF9HQBALhB83ENAECFJRKAEAIJC98JREGXAF9FQBGXAGCG6QBEXGXAKAE9JQBC9+bMAK1BBHGCgFZRIGXGXAGCa9MQBAKCFJRKSFMAK1BFHGCgBZCOWAICgBZqRIGXAGCa9MQBAKCGJRKSFMAK1BGHGCgBZCfWAIqRIGXAGCa9MQBAKCEJRKSFMAK1BEHGCgBZCdWAIqRIGXAGCa9MQBAKCIJRKSFMAK2BIC8cWAIqRIAKCLJRKMALCNJAICFZCGWqHGAICGrCBAICFrCFZl9zAG8oGBJHIjGBABAIjGBABCIJRBAFCaJHFQBSGMMEXGXAKAE9JQBC9+bMAK1BBHGCgFZRIGXGXAGCa9MQBAKCFJRKSFMAK1BFHGCgBZCOWAICgBZqRIGXAGCa9MQBAKCGJRKSFMAK1BGHGCgBZCfWAIqRIGXAGCa9MQBAKCEJRKSFMAK1BEHGCgBZCdWAIqRIGXAGCa9MQBAKCIJRKSFMAK2BIC8cWAIqRIAKCLJRKMABAICGrCBAICFrCFZl9zALCNJAICFZCGWqHI8oGBJHG87FBAIAGjGBABCGJRBAFCaJHFQBMMCBC99AKAE6yRKMAKM+lLKFaF99GaG99FaG99GXGXAGCI9HQBAF9FQFEXGXGX9DBBB8/9DBBB+/ABCGJHG1BB+yAB1BBHE+yHI+L+TABCFJHL1BBHK+yHO+L+THN9DBBBB9gHVyAN9DBB/+hANAN+U9DBBBBANAVyHcAc+MHMAECa3yAI+SHIAI+UAcAMAKCa3yAO+SHcAc+U+S+S+R+VHO+U+SHN+L9DBBB9P9d9FQBAN+oRESFMCUUUU94REMAGAE86BBGXGX9DBBB8/9DBBB+/Ac9DBBBB9gyAcAO+U+SHN+L9DBBB9P9d9FQBAN+oRGSFMCUUUU94RGMALAG86BBGXGX9DBBB8/9DBBB+/AI9DBBBB9gyAIAO+U+SHN+L9DBBB9P9d9FQBAN+oRGSFMCUUUU94RGMABAG86BBABCIJRBAFCaJHFQBSGMMAF9FQBEXGXGX9DBBB8/9DBBB+/ABCIJHG8uFB+yAB8uFBHE+yHI+L+TABCGJHL8uFBHK+yHO+L+THN9DBBBB9gHVyAN9DB/+g6ANAN+U9DBBBBANAVyHcAc+MHMAECa3yAI+SHIAI+UAcAMAKCa3yAO+SHcAc+U+S+S+R+VHO+U+SHN+L9DBBB9P9d9FQBAN+oRESFMCUUUU94REMAGAE87FBGXGX9DBBB8/9DBBB+/Ac9DBBBB9gyAcAO+U+SHN+L9DBBB9P9d9FQBAN+oRGSFMCUUUU94RGMALAG87FBGXGX9DBBB8/9DBBB+/AI9DBBBB9gyAIAO+U+SHN+L9DBBB9P9d9FQBAN+oRGSFMCUUUU94RGMABAG87FBABCNJRBAFCaJHFQBMMM/SEIEaE99EaF99GXAF9FQBCBREABRIEXGXGX9D/zI818/AICKJ8uFBHLCEq+y+VHKAI8uFB+y+UHO9DB/+g6+U9DBBB8/9DBBB+/AO9DBBBB9gy+SHN+L9DBBB9P9d9FQBAN+oRVSFMCUUUU94RVMAICIJ8uFBRcAICGJ8uFBRMABALCFJCEZAEqCFWJAV87FBGXGXAKAM+y+UHN9DB/+g6+U9DBBB8/9DBBB+/AN9DBBBB9gy+SHS+L9DBBB9P9d9FQBAS+oRMSFMCUUUU94RMMABALCGJCEZAEqCFWJAM87FBGXGXAKAc+y+UHK9DB/+g6+U9DBBB8/9DBBB+/AK9DBBBB9gy+SHS+L9DBBB9P9d9FQBAS+oRcSFMCUUUU94RcMABALCaJCEZAEqCFWJAc87FBGXGX9DBBU8/AOAO+U+TANAN+U+TAKAK+U+THO9DBBBBAO9DBBBB9gy+R9DB/+g6+U9DBBB8/+SHO+L9DBBB9P9d9FQBAO+oRcSFMCUUUU94RcMABALCEZAEqCFWJAc87FBAICNJRIAECIJREAFCaJHFQBMMM9JBGXAGCGrAF9sHF9FQBEXABAB8oGBHGCNWCN91+yAGCi91CnWCUUU/8EJ+++U84GBABCIJRBAFCaJHFQBMMM9TFEaCBCB8oGUkUUBHFABCEJC98ZJHBjGUkUUBGXGXAB8/BCTWHGuQBCaREABAGlCggEJCTrXBCa6QFMAFREMAEM/lFFFaGXGXAFABqCEZ9FQBABRESFMGXGXAGCT9PQBABRESFMABREEXAEAF8oGBjGBAECIJAFCIJ8oGBjGBAECNJAFCNJ8oGBjGBAECSJAFCSJ8oGBjGBAECTJREAFCTJRFAGC9wJHGCb9LQBMMAGCI9JQBEXAEAF8oGBjGBAFCIJRFAECIJREAGC98JHGCE9LQBMMGXAG9FQBEXAEAF2BB86BBAECFJREAFCFJRFAGCaJHGQBMMABMoFFGaGXGXABCEZ9FQBABRESFMAFCgFZC+BwsN9sRIGXGXAGCT9PQBABRESFMABREEXAEAIjGBAECSJAIjGBAECNJAIjGBAECIJAIjGBAECTJREAGC9wJHGCb9LQBMMAGCI9JQBEXAEAIjGBAECIJREAGC98JHGCE9LQBMMGXAG9FQBEXAEAF86BBAECFJREAGCaJHGQBMMABMMMFBCUNMIT9kBB",e="B9h9z9tFBBBFiI9gBB9gLaaaaaFa9gEaaaB9gFaFaEMcBBFBFFGGGEILF9wFFFLEFBFKNFaFCx/aFMO/LFVK9tv9t9vq95GBt9f9f939h9z9t9f9j9h9s9s9f9jW9vq9zBBp9tv9z9o9v9wW9f9kv9j9v9kv9WvqWv94h919m9mvqBG8Z9tv9z9o9v9wW9f9kv9j9v9kv9J9u9kv94h919m9mvqBIy9tv9z9o9v9wW9f9kv9j9v9kv9J9u9kv949TvZ91v9u9jvBLn9tv9z9o9v9wW9f9kv9j9v9kv69p9sWvq9P9jWBKi9tv9z9o9v9wW9f9kv9j9v9kv69p9sWvq9R919hWBOn9tv9z9o9v9wW9f9kv9j9v9kv69p9sWvq9F949wBNI9z9iqlBVc+N9IcIBTEM9+FLa8jUUUUBCTlRBCBRFEXCBRGCBREEXABCNJAGJAECUaAFAGrCFZHIy86BBAEAIJREAGCFJHGCN9HQBMAFCx+YUUBJAE86BBAFCEWCxkUUBJAB8pEN83EBAFCFJHFCUG9HQBMMk8lLbaE97F9+FaL978jUUUUBCU/KBlHL8kUUUUBC9+RKGXAGCFJAI9LQBCaRKAE2BBC+gF9HQBALAEAIJHOAGlAG/8cBBCUoBAG9uC/wgBZHKCUGAKCUG9JyRNAECFJRKCBRVGXEXAVAF9PQFANAFAVlAVANJAF9JyRcGXGXAG9FQBAcCbJHIC9wZHMCE9sRSAMCFWRQAICIrCEJCGrRfCBRbEXAKRTCBRtGXEXGXAOATlAf9PQBCBRKSLMALCU/CBJAtAM9sJRmATAfJRKCBREGXAMCoB9JQBAOAKlC/gB9JQBCBRIEXAmAIJREGXGXGXGXGXATAICKrJ2BBHYCEZfIBFGEBMAECBDtDMIBSEMAEAKDBBIAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnHPCGD+MFAPDQBTFtGmEYIPLdKeOnC0+G+MiDtD9OHdCEDbD8jHPAPDQBFGENVcMILKOSQfbHeD8dBh+BsxoxoUwN0AeD8dFhxoUwkwk+gUa0sHnhTkAnsHnhNkAnsHn7CgFZHiCEWCxkUUBJDBEBAiCx+YUUBJDBBBHeAeDQBBBBBBBBBBBBBBBBAnhAk7CgFZHiCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMIBAKCIJAeDeBJAiCx+YUUBJ2BBJRKSGMAEAKDBBNAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnC+P+e+8/4BDtD9OHdCbDbD8jHPAPDQBFGENVcMILKOSQfbHeD8dBh+BsxoxoUwN0AeD8dFhxoUwkwk+gUa0sHnhTkAnsHnhNkAnsHn7CgFZHiCEWCxkUUBJDBEBAiCx+YUUBJDBBBHeAeDQBBBBBBBBBBBBBBBBAnhAk7CgFZHiCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMIBAKCNJAeDeBJAiCx+YUUBJ2BBJRKSFMAEAKDBBBDMIBAKCTJRKMGXGXGXGXGXAYCGrCEZfIBFGEBMAECBDtDMITSEMAEAKDBBIAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnHPCGD+MFAPDQBTFtGmEYIPLdKeOnC0+G+MiDtD9OHdCEDbD8jHPAPDQBFGENVcMILKOSQfbHeD8dBh+BsxoxoUwN0AeD8dFhxoUwkwk+gUa0sHnhTkAnsHnhNkAnsHn7CgFZHiCEWCxkUUBJDBEBAiCx+YUUBJDBBBHeAeDQBBBBBBBBBBBBBBBBAnhAk7CgFZHiCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMITAKCIJAeDeBJAiCx+YUUBJ2BBJRKSGMAEAKDBBNAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnC+P+e+8/4BDtD9OHdCbDbD8jHPAPDQBFGENVcMILKOSQfbHeD8dBh+BsxoxoUwN0AeD8dFhxoUwkwk+gUa0sHnhTkAnsHnhNkAnsHn7CgFZHiCEWCxkUUBJDBEBAiCx+YUUBJDBBBHeAeDQBBBBBBBBBBBBBBBBAnhAk7CgFZHiCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMITAKCNJAeDeBJAiCx+YUUBJ2BBJRKSFMAEAKDBBBDMITAKCTJRKMGXGXGXGXGXAYCIrCEZfIBFGEBMAECBDtDMIASEMAEAKDBBIAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnHPCGD+MFAPDQBTFtGmEYIPLdKeOnC0+G+MiDtD9OHdCEDbD8jHPAPDQBFGENVcMILKOSQfbHeD8dBh+BsxoxoUwN0AeD8dFhxoUwkwk+gUa0sHnhTkAnsHnhNkAnsHn7CgFZHiCEWCxkUUBJDBEBAiCx+YUUBJDBBBHeAeDQBBBBBBBBBBBBBBBBAnhAk7CgFZHiCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMIAAKCIJAeDeBJAiCx+YUUBJ2BBJRKSGMAEAKDBBNAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnC+P+e+8/4BDtD9OHdCbDbD8jHPAPDQBFGENVcMILKOSQfbHeD8dBh+BsxoxoUwN0AeD8dFhxoUwkwk+gUa0sHnhTkAnsHnhNkAnsHn7CgFZHiCEWCxkUUBJDBEBAiCx+YUUBJDBBBHeAeDQBBBBBBBBBBBBBBBBAnhAk7CgFZHiCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMIAAKCNJAeDeBJAiCx+YUUBJ2BBJRKSFMAEAKDBBBDMIAAKCTJRKMGXGXGXGXGXAYCKrfIBFGEBMAECBDtDMI8wSEMAEAKDBBIAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnHPCGD+MFAPDQBTFtGmEYIPLdKeOnC0+G+MiDtD9OHdCEDbD8jHPAPDQBFGENVcMILKOSQfbHeD8dBh+BsxoxoUwN0AeD8dFhxoUwkwk+gUa0sHnhTkAnsHnhNkAnsHn7CgFZHYCEWCxkUUBJDBEBAYCx+YUUBJDBBBHeAeDQBBBBBBBBBBBBBBBBAnhAk7CgFZHYCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMI8wAKCIJAeDeBJAYCx+YUUBJ2BBJRKSGMAEAKDBBNAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnC+P+e+8/4BDtD9OHdCbDbD8jHPAPDQBFGENVcMILKOSQfbHeD8dBh+BsxoxoUwN0AeD8dFhxoUwkwk+gUa0sHnhTkAnsHnhNkAnsHn7CgFZHYCEWCxkUUBJDBEBAYCx+YUUBJDBBBHeAeDQBBBBBBBBBBBBBBBBAnhAk7CgFZHYCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMI8wAKCNJAeDeBJAYCx+YUUBJ2BBJRKSFMAEAKDBBBDMI8wAKCTJRKMAICoBJREAICUFJAM9LQFAERIAOAKlC/fB9LQBMMGXAEAM9PQBAECErRIEXGXAOAKlCi9PQBCBRKSOMAmAEJRYGXGXGXGXGXATAECKrJ2BBAICKZrCEZfIBFGEBMAYCBDtDMIBSEMAYAKDBBIAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnHPCGD+MFAPDQBTFtGmEYIPLdKeOnC0+G+MiDtD9OHdCEDbD8jHPAPDQBFGENVcMILKOSQfbHeD8dBh+BsxoxoUwN0AeD8dFhxoUwkwk+gUa0sHnhTkAnsHnhNkAnsHn7CgFZHiCEWCxkUUBJDBEBAiCx+YUUBJDBBBHeAeDQBBBBBBBBBBBBBBBBAnhAk7CgFZHiCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMIBAKCIJAeDeBJAiCx+YUUBJ2BBJRKSGMAYAKDBBNAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnC+P+e+8/4BDtD9OHdCbDbD8jHPAPDQBFGENVcMILKOSQfbHeD8dBh+BsxoxoUwN0AeD8dFhxoUwkwk+gUa0sHnhTkAnsHnhNkAnsHn7CgFZHiCEWCxkUUBJDBEBAiCx+YUUBJDBBBHeAeDQBBBBBBBBBBBBBBBBAnhAk7CgFZHiCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMIBAKCNJAeDeBJAiCx+YUUBJ2BBJRKSFMAYAKDBBBDMIBAKCTJRKMAICGJRIAECTJHEAM9JQBMMGXAK9FQBAKRTAtCFJHtCI6QGSFMMCBRKSEMGXAM9FQBALCUGJAbJREALAbJDBGBReCBRYEXAEALCU/CBJAYJHIDBIBHdCFD9tAdCFDbHPD9OD9hD9RHdAIAMJDBIBH8ZCFD9tA8ZAPD9OD9hD9RH8ZDQBTFtGmEYIPLdKeOnHpAIAQJDBIBHyCFD9tAyAPD9OD9hD9RHyAIASJDBIBH8cCFD9tA8cAPD9OD9hD9RH8cDQBTFtGmEYIPLdKeOnH8dDQBFTtGEmYILPdKOenHPAPDQBFGEBFGEBFGEBFGEAeD9uHeDyBjGBAEAGJHIAeAPAPDQILKOILKOILKOILKOD9uHeDyBjGBAIAGJHIAeAPAPDQNVcMNVcMNVcMNVcMD9uHeDyBjGBAIAGJHIAeAPAPDQSQfbSQfbSQfbSQfbD9uHeDyBjGBAIAGJHIAeApA8dDQNVi8ZcMpySQ8c8dfb8e8fHPAPDQBFGEBFGEBFGEBFGED9uHeDyBjGBAIAGJHIAeAPAPDQILKOILKOILKOILKOD9uHeDyBjGBAIAGJHIAeAPAPDQNVcMNVcMNVcMNVcMD9uHeDyBjGBAIAGJHIAeAPAPDQSQfbSQfbSQfbSQfbD9uHeDyBjGBAIAGJHIAeAdA8ZDQNiV8ZcpMyS8cQ8df8eb8fHdAyA8cDQNiV8ZcpMyS8cQ8df8eb8fH8ZDQBFTtGEmYILPdKOenHPAPDQBFGEBFGEBFGEBFGED9uHeDyBjGBAIAGJHIAeAPAPDQILKOILKOILKOILKOD9uHeDyBjGBAIAGJHIAeAPAPDQNVcMNVcMNVcMNVcMD9uHeDyBjGBAIAGJHIAeAPAPDQSQfbSQfbSQfbSQfbD9uHeDyBjGBAIAGJHIAeAdA8ZDQNVi8ZcMpySQ8c8dfb8e8fHPAPDQBFGEBFGEBFGEBFGED9uHeDyBjGBAIAGJHIAeAPAPDQILKOILKOILKOILKOD9uHeDyBjGBAIAGJHIAeAPAPDQNVcMNVcMNVcMNVcMD9uHeDyBjGBAIAGJHIAeAPAPDQSQfbSQfbSQfbSQfbD9uHeDyBjGBAIAGJREAYCTJHYAM9JQBMMAbCIJHbAG9JQBMMABAVAG9sJALCUGJAcAG9s/8cBBALALCUGJAcCaJAG9sJAG/8cBBMAcCBAKyAVJRVAKQBMC9+RKSFMCBC99AOAKlAGCAAGCA9Ly6yRKMALCU/KBJ8kUUUUBAKMNBT+BUUUBM+KmFTa8jUUUUBCoFlHL8kUUUUBC9+RKGXAFCE9uHOCtJAI9LQBCaRKAE2BBHNC/wFZC/gF9HQBANCbZHVCF9LQBALCoBJCgFCUF/8MBALC84Jha83EBALC8wJha83EBALC8oJha83EBALCAJha83EBALCiJha83EBALCTJha83EBALha83ENALha83EBAEAIJC9wJRcAECFJHNAOJRMGXAF9FQBCQCbAVCF6yRSABRECBRVCBRQCBRfCBRICBRKEXGXAMAcuQBC9+RKSEMGXGXAN2BBHOC/vF9LQBALCoBJAOCIrCa9zAKJCbZCEWJHb8oGIRTAb8oGBRtGXAOCbZHbAS9PQBALAOCa9zAIJCbZCGWJ8oGBAVAbyROAb9FRbGXGXAGCG9HQBABAt87FBABCIJAO87FBABCGJAT87FBSFMAEAtjGBAECNJAOjGBAECIJATjGBMAVAbJRVALCoBJAKCEWJHmAOjGBAmATjGIALAICGWJAOjGBALCoBJAKCFJCbZHKCEWJHTAtjGBATAOjGIAIAbJRIAKCFJRKSGMGXGXAbCb6QBAQAbJAbC989zJCFJRQSFMAM1BBHbCgFZROGXGXAbCa9MQBAMCFJRMSFMAM1BFHbCgBZCOWAOCgBZqROGXAbCa9MQBAMCGJRMSFMAM1BGHbCgBZCfWAOqROGXAbCa9MQBAMCEJRMSFMAM1BEHbCgBZCdWAOqROGXAbCa9MQBAMCIJRMSFMAM2BIC8cWAOqROAMCLJRMMAOCFrCBAOCFZl9zAQJRQMGXGXAGCG9HQBABAt87FBABCIJAQ87FBABCGJAT87FBSFMAEAtjGBAECNJAQjGBAECIJATjGBMALCoBJAKCEWJHOAQjGBAOATjGIALAICGWJAQjGBALCoBJAKCFJCbZHKCEWJHOAtjGBAOAQjGIAICFJRIAKCFJRKSFMGXAOCDF9LQBALAIAcAOCbZJ2BBHbCIrHTlCbZCGWJ8oGBAVCFJHtATyROALAIAblCbZCGWJ8oGBAtAT9FHmJHtAbCbZHTyRbAT9FRTGXGXAGCG9HQBABAV87FBABCIJAb87FBABCGJAO87FBSFMAEAVjGBAECNJAbjGBAECIJAOjGBMALAICGWJAVjGBALCoBJAKCEWJHYAOjGBAYAVjGIALAICFJHICbZCGWJAOjGBALCoBJAKCFJCbZCEWJHYAbjGBAYAOjGIALAIAmJCbZHICGWJAbjGBALCoBJAKCGJCbZHKCEWJHOAVjGBAOAbjGIAKCFJRKAIATJRIAtATJRVSFMAVCBAM2BBHYyHTAOC/+F6HPJROAYCbZRtGXGXAYCIrHmQBAOCFJRbSFMAORbALAIAmlCbZCGWJ8oGBROMGXGXAtQBAbCFJRVSFMAbRVALAIAYlCbZCGWJ8oGBRbMGXGXAP9FQBAMCFJRYSFMAM1BFHYCgFZRTGXGXAYCa9MQBAMCGJRYSFMAM1BGHYCgBZCOWATCgBZqRTGXAYCa9MQBAMCEJRYSFMAM1BEHYCgBZCfWATqRTGXAYCa9MQBAMCIJRYSFMAM1BIHYCgBZCdWATqRTGXAYCa9MQBAMCLJRYSFMAMCKJRYAM2BLC8cWATqRTMATCFrCBATCFZl9zAQJHQRTMGXGXAmCb6QBAYRPSFMAY1BBHMCgFZROGXGXAMCa9MQBAYCFJRPSFMAY1BFHMCgBZCOWAOCgBZqROGXAMCa9MQBAYCGJRPSFMAY1BGHMCgBZCfWAOqROGXAMCa9MQBAYCEJRPSFMAY1BEHMCgBZCdWAOqROGXAMCa9MQBAYCIJRPSFMAYCLJRPAY2BIC8cWAOqROMAOCFrCBAOCFZl9zAQJHQROMGXGXAtCb6QBAPRMSFMAP1BBHMCgFZRbGXGXAMCa9MQBAPCFJRMSFMAP1BFHMCgBZCOWAbCgBZqRbGXAMCa9MQBAPCGJRMSFMAP1BGHMCgBZCfWAbqRbGXAMCa9MQBAPCEJRMSFMAP1BEHMCgBZCdWAbqRbGXAMCa9MQBAPCIJRMSFMAPCLJRMAP2BIC8cWAbqRbMAbCFrCBAbCFZl9zAQJHQRbMGXGXAGCG9HQBABAT87FBABCIJAb87FBABCGJAO87FBSFMAEATjGBAECNJAbjGBAECIJAOjGBMALCoBJAKCEWJHYAOjGBAYATjGIALAICGWJATjGBALCoBJAKCFJCbZCEWJHYAbjGBAYAOjGIALAICFJHICbZCGWJAOjGBALCoBJAKCGJCbZCEWJHOATjGBAOAbjGIALAIAm9FAmCb6qJHICbZCGWJAbjGBAIAt9FAtCb6qJRIAKCEJRKMANCFJRNABCKJRBAECSJREAKCbZRKAICbZRIAfCEJHfAF9JQBMMCBC99AMAc6yRKMALCoFJ8kUUUUBAKM/tIFGa8jUUUUBCTlRLC9+RKGXAFCLJAI9LQBCaRKAE2BBC/+FZC/QF9HQBALhB83ENAECFJRKAEAIJC98JREGXAF9FQBGXAGCG6QBEXGXAKAE9JQBC9+bMAK1BBHGCgFZRIGXGXAGCa9MQBAKCFJRKSFMAK1BFHGCgBZCOWAICgBZqRIGXAGCa9MQBAKCGJRKSFMAK1BGHGCgBZCfWAIqRIGXAGCa9MQBAKCEJRKSFMAK1BEHGCgBZCdWAIqRIGXAGCa9MQBAKCIJRKSFMAK2BIC8cWAIqRIAKCLJRKMALCNJAICFZCGWqHGAICGrCBAICFrCFZl9zAG8oGBJHIjGBABAIjGBABCIJRBAFCaJHFQBSGMMEXGXAKAE9JQBC9+bMAK1BBHGCgFZRIGXGXAGCa9MQBAKCFJRKSFMAK1BFHGCgBZCOWAICgBZqRIGXAGCa9MQBAKCGJRKSFMAK1BGHGCgBZCfWAIqRIGXAGCa9MQBAKCEJRKSFMAK1BEHGCgBZCdWAIqRIGXAGCa9MQBAKCIJRKSFMAK2BIC8cWAIqRIAKCLJRKMABAICGrCBAICFrCFZl9zALCNJAICFZCGWqHI8oGBJHG87FBAIAGjGBABCGJRBAFCaJHFQBMMCBC99AKAE6yRKMAKM/dLEK97FaF97GXGXAGCI9HQBAF9FQFCBRGEXABABDBBBHECiD+rFCiD+sFD/6FHIAECND+rFCiD+sFD/6FAID/gFAECTD+rFCiD+sFD/6FHLD/gFD/kFD/lFHKCBDtD+2FHOAICUUUU94DtHND9OD9RD/kFHI9DBB/+hDYAIAID/mFAKAKD/mFALAOALAND9OD9RD/kFHIAID/mFD/kFD/kFD/jFD/nFHLD/mF9DBBX9LDYHOD/kFCgFDtD9OAECUUU94DtD9OD9QAIALD/mFAOD/kFCND+rFCU/+EDtD9OD9QAKALD/mFAOD/kFCTD+rFCUU/8ODtD9OD9QDMBBABCTJRBAGCIJHGAF9JQBSGMMAF9FQBCBRGEXABCTJHVAVDBBBHECBDtHOCUU98D8cFCUU98D8cEHND9OABDBBBHKAEDQILKOSQfbPden8c8d8e8fCggFDtD9OD/6FAKAEDQBFGENVcMTtmYi8ZpyHECTD+sFD/6FHID/gFAECTD+rFCTD+sFD/6FHLD/gFD/kFD/lFHE9DB/+g6DYALAEAOD+2FHOALCUUUU94DtHcD9OD9RD/kFHLALD/mFAEAED/mFAIAOAIAcD9OD9RD/kFHEAED/mFD/kFD/kFD/jFD/nFHID/mF9DBBX9LDYHOD/kFCTD+rFALAID/mFAOD/kFCggEDtD9OD9QHLAEAID/mFAOD/kFCaDbCBDnGCBDnECBDnKCBDnOCBDncCBDnMCBDnfCBDnbD9OHEDQNVi8ZcMpySQ8c8dfb8e8fD9QDMBBABAKAND9OALAEDQBFTtGEmYILPdKOenD9QDMBBABCAJRBAGCIJHGAF9JQBMMM/hEIGaF97FaL978jUUUUBCTlREGXAF9FQBCBRIEXAEABDBBBHLABCTJHKDBBBHODQILKOSQfbPden8c8d8e8fHNCTD+sFHVCID+rFDMIBAB9DBBU8/DY9D/zI818/DYAVCEDtD9QD/6FD/nFHVALAODQBFGENVcMTtmYi8ZpyHLCTD+rFCTD+sFD/6FD/mFHOAOD/mFAVALCTD+sFD/6FD/mFHcAcD/mFAVANCTD+rFCTD+sFD/6FD/mFHNAND/mFD/kFD/kFD/lFCBDtD+4FD/jF9DB/+g6DYHVD/mF9DBBX9LDYHLD/kFCggEDtHMD9OAcAVD/mFALD/kFCTD+rFD9QHcANAVD/mFALD/kFCTD+rFAOAVD/mFALD/kFAMD9OD9QHVDQBFTtGEmYILPdKOenHLD8dBAEDBIBDyB+t+J83EBABCNJALD8dFAEDBIBDyF+t+J83EBAKAcAVDQNVi8ZcMpySQ8c8dfb8e8fHVD8dBAEDBIBDyG+t+J83EBABCiJAVD8dFAEDBIBDyE+t+J83EBABCAJRBAICIJHIAF9JQBMMM9jFF97GXAGCGrAF9sHG9FQBCBRFEXABABDBBBHECND+rFCND+sFD/6FAECiD+sFCnD+rFCUUU/8EDtD+uFD/mFDMBBABCTJRBAFCIJHFAG9JQBMMM9TFEaCBCB8oGUkUUBHFABCEJC98ZJHBjGUkUUBGXGXAB8/BCTWHGuQBCaREABAGlCggEJCTrXBCa6QFMAFREMAEMMMFBCUNMIT9tBB",t=new Uint8Array([0,97,115,109,1,0,0,0,1,4,1,96,0,0,3,3,2,0,0,5,3,1,0,1,12,1,0,10,22,2,12,0,65,0,65,0,65,0,252,10,0,0,11,7,0,65,0,253,15,26,11]),n=new Uint8Array([32,0,65,253,3,1,2,34,4,106,6,5,11,8,7,20,13,33,12,16,128,9,116,64,19,113,127,15,10,21,22,14,255,66,24,54,136,107,18,23,192,26,114,118,132,17,77,101,130,144,27,87,131,44,45,74,156,154,70,167]);if(typeof WebAssembly!="object")return{supported:!1};let r=i;WebAssembly.validate(t)&&(r=e);let s;const o=WebAssembly.instantiate(u(r),{}).then(v=>{s=v.instance,s.exports.__wasm_call_ctors()});function u(v){const _=new Uint8Array(v.length);for(let E=0;E<v.length;++E){const C=v.charCodeAt(E);_[E]=C>96?C-71:C>64?C-65:C>47?C+4:C>46?63:62}let x=0;for(let E=0;E<v.length;++E)_[x++]=_[E]<60?n[_[E]]:(_[E]-60)*64+_[++E];return _.buffer.slice(0,x)}function f(v,_,x,E,C,w){const T=s.exports.sbrk,N=x+3&-4,L=T(N*E),F=T(C.length),G=new Uint8Array(s.exports.memory.buffer);G.set(C,F);const k=v(L,x,E,F,C.length);if(k===0&&w&&w(L,N,E),_.set(G.subarray(L,L+x*E)),T(L-T(0)),k!==0)throw new Error(`Malformed buffer data: ${k}`)}const p={0:"",1:"meshopt_decodeFilterOct",2:"meshopt_decodeFilterQuat",3:"meshopt_decodeFilterExp",NONE:"",OCTAHEDRAL:"meshopt_decodeFilterOct",QUATERNION:"meshopt_decodeFilterQuat",EXPONENTIAL:"meshopt_decodeFilterExp"},g={0:"meshopt_decodeVertexBuffer",1:"meshopt_decodeIndexBuffer",2:"meshopt_decodeIndexSequence",ATTRIBUTES:"meshopt_decodeVertexBuffer",TRIANGLES:"meshopt_decodeIndexBuffer",INDICES:"meshopt_decodeIndexSequence"};return $x={ready:o,supported:!0,decodeVertexBuffer(v,_,x,E,C){f(s.exports.meshopt_decodeVertexBuffer,v,_,x,E,s.exports[p[C]])},decodeIndexBuffer(v,_,x,E){f(s.exports.meshopt_decodeIndexBuffer,v,_,x,E)},decodeIndexSequence(v,_,x,E){f(s.exports.meshopt_decodeIndexSequence,v,_,x,E)},decodeGltfBuffer(v,_,x,E,C,w){f(s.exports[g[C]],v,_,x,E,s.exports[p[w]])}},$x};let eb=null,DO="https://www.gstatic.com/draco/versioned/decoders/1.5.5/";function NO(i=!0,e=!0,t){return n=>{t&&t(n),i&&(eb||(eb=new WJ),eb.setDecoderPath(typeof i=="string"?i:DO),n.setDRACOLoader(eb)),e&&n.setMeshoptDecoder(typeof Y1=="function"?Y1():Y1)}}const jS=(i,e,t,n)=>Wu(Qw,i,NO(e,t,n));jS.preload=(i,e,t,n)=>Wu.preload(Qw,i,NO(e,t,n));jS.clear=i=>Wu.clear(Qw,i);jS.setDecoderPath=i=>{DO=i};function XJ(i,e,t){const n=Hr(x=>x.size),r=Hr(x=>x.viewport),s=typeof i=="number"?i:n.width*r.dpr,o=n.height*r.dpr,u=(typeof i=="number"?t:i)||{},{samples:f=0,depth:p,...g}=u,v=p??u.depthBuffer,_=be.useMemo(()=>{const x=new _s(s,o,{minFilter:Jn,magFilter:Jn,type:Er,...g});return v&&(x.depthTexture=new ep(s,o,ir)),x.samples=f,x},[]);return be.useLayoutEffect(()=>{_.setSize(s,o),f&&(_.samples=f)},[f,_,s,o]),be.useEffect(()=>()=>_.dispose(),[]),_}const YJ=i=>typeof i=="function",JJ=be.forwardRef(({envMap:i,resolution:e=256,frames:t=1/0,makeDefault:n,children:r,...s},o)=>{const u=Hr(({set:w})=>w),f=Hr(({camera:w})=>w),p=Hr(({size:w})=>w),g=be.useRef(null);be.useImperativeHandle(o,()=>g.current,[]);const v=be.useRef(null),_=XJ(e);be.useLayoutEffect(()=>{s.manual||(g.current.aspect=p.width/p.height)},[p,s]),be.useLayoutEffect(()=>{g.current.updateProjectionMatrix()});let x=0,E=null;const C=YJ(r);return Ng(w=>{C&&(t===1/0||x<t)&&(v.current.visible=!1,w.gl.setRenderTarget(_),E=w.scene.background,i&&(w.scene.background=i),w.gl.render(w.scene,g.current),w.scene.background=E,w.gl.setRenderTarget(null),v.current.visible=!0,x++)}),be.useLayoutEffect(()=>{if(n){const w=f;return u(()=>({camera:g.current})),()=>u(()=>({camera:w}))}},[g,n,u]),be.createElement(be.Fragment,null,be.createElement("perspectiveCamera",ap({ref:g},s),!C&&r),be.createElement("group",{ref:v},C&&r(_.texture)))}),KJ=be.forwardRef(({makeDefault:i,camera:e,regress:t,domElement:n,enableDamping:r=!0,keyEvents:s=!1,onChange:o,onStart:u,onEnd:f,...p},g)=>{const v=Hr(k=>k.invalidate),_=Hr(k=>k.camera),x=Hr(k=>k.gl),E=Hr(k=>k.events),C=Hr(k=>k.setEvents),w=Hr(k=>k.set),T=Hr(k=>k.get),N=Hr(k=>k.performance),L=e||_,F=n||E.connected||x.domElement,G=be.useMemo(()=>new sJ(L),[L]);return Ng(()=>{G.enabled&&G.update()},-1),be.useEffect(()=>(s&&G.connect(s===!0?F:s),G.connect(F),()=>void G.dispose()),[s,F,t,G,v]),be.useEffect(()=>{const k=R=>{v(),t&&N.regress(),o&&o(R)},O=R=>{u&&u(R)},D=R=>{f&&f(R)};return G.addEventListener("change",k),G.addEventListener("start",O),G.addEventListener("end",D),()=>{G.removeEventListener("start",O),G.removeEventListener("end",D),G.removeEventListener("change",k)}},[o,u,f,G,v,C]),be.useEffect(()=>{if(i){const k=T().controls;return w({controls:G}),()=>w({controls:k})}},[i,G]),be.createElement("primitive",ap({ref:g,object:G,enableDamping:r},p))}),PO=(i,e,t)=>{let n;switch(i){case vs:n=new Uint8ClampedArray(e*t*4);break;case Er:n=new Uint16Array(e*t*4);break;case So:n=new Uint32Array(e*t*4);break;case oS:n=new Int8Array(e*t*4);break;case lS:n=new Int16Array(e*t*4);break;case yy:n=new Int32Array(e*t*4);break;case ir:n=new Float32Array(e*t*4);break;default:throw new Error("Unsupported data type")}return n};let tb;const QJ=(i,e,t,n)=>{if(tb!==void 0)return tb;const r=new _s(1,1,n);e.setRenderTarget(r);const s=new rr(new Xu,new to({color:16777215}));e.render(s,t),e.setRenderTarget(null);const o=PO(i,r.width,r.height);return e.readRenderTargetPixels(r,0,0,r.width,r.height,o),r.dispose(),s.geometry.dispose(),s.material.dispose(),tb=o[0]!==0,tb};class Zw{constructor(e){Ir(this,"_renderer");Ir(this,"_rendererIsDisposable",!1);Ir(this,"_material");Ir(this,"_scene");Ir(this,"_camera");Ir(this,"_quad");Ir(this,"_renderTarget");Ir(this,"_width");Ir(this,"_height");Ir(this,"_type");Ir(this,"_colorSpace");Ir(this,"_supportsReadPixels",!0);Ir(this,"render",()=>{this._renderer.setRenderTarget(this._renderTarget);try{this._renderer.render(this._scene,this._camera)}catch(e){throw this._renderer.setRenderTarget(null),e}this._renderer.setRenderTarget(null)});var n,r,s,o,u,f,p,g,v,_,x,E,C,w,T,N;this._width=e.width,this._height=e.height,this._type=e.type,this._colorSpace=e.colorSpace;const t={format:jr,depthBuffer:!1,stencilBuffer:!1,type:this._type,colorSpace:this._colorSpace,anisotropy:((n=e.renderTargetOptions)==null?void 0:n.anisotropy)!==void 0?(r=e.renderTargetOptions)==null?void 0:r.anisotropy:1,generateMipmaps:((s=e.renderTargetOptions)==null?void 0:s.generateMipmaps)!==void 0?(o=e.renderTargetOptions)==null?void 0:o.generateMipmaps:!1,magFilter:((u=e.renderTargetOptions)==null?void 0:u.magFilter)!==void 0?(f=e.renderTargetOptions)==null?void 0:f.magFilter:Jn,minFilter:((p=e.renderTargetOptions)==null?void 0:p.minFilter)!==void 0?(g=e.renderTargetOptions)==null?void 0:g.minFilter:Jn,samples:((v=e.renderTargetOptions)==null?void 0:v.samples)!==void 0?(_=e.renderTargetOptions)==null?void 0:_.samples:void 0,wrapS:((x=e.renderTargetOptions)==null?void 0:x.wrapS)!==void 0?(E=e.renderTargetOptions)==null?void 0:E.wrapS:Sr,wrapT:((C=e.renderTargetOptions)==null?void 0:C.wrapT)!==void 0?(w=e.renderTargetOptions)==null?void 0:w.wrapT:Sr};if(this._material=e.material,e.renderer?this._renderer=e.renderer:(this._renderer=Zw.instantiateRenderer(),this._rendererIsDisposable=!0),this._scene=new Ay,this._camera=new Ao,this._camera.position.set(0,0,10),this._camera.left=-.5,this._camera.right=.5,this._camera.top=.5,this._camera.bottom=-.5,this._camera.updateProjectionMatrix(),!QJ(this._type,this._renderer,this._camera,t)){let L;switch(this._type){case Er:L=this._renderer.extensions.has("EXT_color_buffer_float")?ir:void 0;break}L!==void 0?(console.warn(`This browser does not support reading pixels from ${this._type} RenderTargets, switching to ${ir}`),this._type=L):(this._supportsReadPixels=!1,console.warn("This browser dos not support toArray or toDataTexture, calls to those methods will result in an error thrown"))}this._quad=new rr(new Xu,this._material),this._quad.geometry.computeBoundingBox(),this._scene.add(this._quad),this._renderTarget=new _s(this.width,this.height,t),this._renderTarget.texture.mapping=((T=e.renderTargetOptions)==null?void 0:T.mapping)!==void 0?(N=e.renderTargetOptions)==null?void 0:N.mapping:vf}static instantiateRenderer(){const e=new Hw;return e.setSize(128,128),e}toArray(){if(!this._supportsReadPixels)throw new Error("Can't read pixels in this browser");const e=PO(this._type,this._width,this._height);return this._renderer.readRenderTargetPixels(this._renderTarget,0,0,this._width,this._height,e),e}toDataTexture(e){const t=new ll(this.toArray(),this.width,this.height,jr,this._type,(e==null?void 0:e.mapping)||vf,(e==null?void 0:e.wrapS)||Sr,(e==null?void 0:e.wrapT)||Sr,(e==null?void 0:e.magFilter)||Jn,(e==null?void 0:e.minFilter)||Jn,(e==null?void 0:e.anisotropy)||1,Xl);return t.generateMipmaps=(e==null?void 0:e.generateMipmaps)!==void 0?e==null?void 0:e.generateMipmaps:!1,t}disposeOnDemandRenderer(){this._renderer.setRenderTarget(null),this._rendererIsDisposable&&(this._renderer.dispose(),this._renderer.forceContextLoss())}dispose(e){this.disposeOnDemandRenderer(),e&&this.renderTarget.dispose(),this.material instanceof Gs&&Object.values(this.material.uniforms).forEach(t=>{t.value instanceof Ci&&t.value.dispose()}),Object.values(this.material).forEach(t=>{t instanceof Ci&&t.dispose()}),this.material.dispose(),this._quad.geometry.dispose()}get width(){return this._width}set width(e){this._width=e,this._renderTarget.setSize(this._width,this._height)}get height(){return this._height}set height(e){this._height=e,this._renderTarget.setSize(this._width,this._height)}get renderer(){return this._renderer}get renderTarget(){return this._renderTarget}set renderTarget(e){this._renderTarget=e,this._width=e.width,this._height=e.height}get material(){return this._material}get type(){return this._type}get colorSpace(){return this._colorSpace}}class BO extends Error{}class LO extends Error{}const hv=(i,e,t)=>{const n=new RegExp(`${e}="([^"]*)"`,"i").exec(i);if(n)return n[1];const r=new RegExp(`<${e}[^>]*>([\\s\\S]*?)</${e}>`,"i").exec(i);if(r){const s=r[1].match(/<rdf:li>([^<]*)<\/rdf:li>/g);return s&&s.length===3?s.map(o=>o.replace(/<\/?rdf:li>/g,"")):r[1].trim()}if(t!==void 0)return t;throw new Error(`Can't find ${e} in gainmap metadata`)},ZJ=i=>{let e;typeof TextDecoder<"u"?e=new TextDecoder().decode(i):e=i.toString();let t=e.indexOf("<x:xmpmeta");for(;t!==-1;){const n=e.indexOf("x:xmpmeta>",t),r=e.slice(t,n+10);try{const s=hv(r,"hdrgm:GainMapMin","0"),o=hv(r,"hdrgm:GainMapMax"),u=hv(r,"hdrgm:Gamma","1"),f=hv(r,"hdrgm:OffsetSDR","0.015625"),p=hv(r,"hdrgm:OffsetHDR","0.015625"),g=/hdrgm:HDRCapacityMin="([^"]*)"/.exec(r),v=g?g[1]:"0",_=/hdrgm:HDRCapacityMax="([^"]*)"/.exec(r);if(!_)throw new Error("Incomplete gainmap metadata");const x=_[1];return{gainMapMin:Array.isArray(s)?s.map(E=>parseFloat(E)):[parseFloat(s),parseFloat(s),parseFloat(s)],gainMapMax:Array.isArray(o)?o.map(E=>parseFloat(E)):[parseFloat(o),parseFloat(o),parseFloat(o)],gamma:Array.isArray(u)?u.map(E=>parseFloat(E)):[parseFloat(u),parseFloat(u),parseFloat(u)],offsetSdr:Array.isArray(f)?f.map(E=>parseFloat(E)):[parseFloat(f),parseFloat(f),parseFloat(f)],offsetHdr:Array.isArray(p)?p.map(E=>parseFloat(E)):[parseFloat(p),parseFloat(p),parseFloat(p)],hdrCapacityMin:parseFloat(v),hdrCapacityMax:parseFloat(x)}}catch{}t=e.indexOf("<x:xmpmeta",n)}};class $J{constructor(e){Ir(this,"options");this.options={debug:e&&e.debug!==void 0?e.debug:!1,extractFII:e&&e.extractFII!==void 0?e.extractFII:!0,extractNonFII:e&&e.extractNonFII!==void 0?e.extractNonFII:!0}}extract(e){return new Promise((t,n)=>{const r=this.options.debug,s=new DataView(e.buffer);if(s.getUint16(0)!==65496){n(new Error("Not a valid jpeg"));return}const o=s.byteLength;let u=2,f=0,p;for(;u<o;){if(++f>250){n(new Error(`Found no marker after ${f} loops `));return}if(s.getUint8(u)!==255){n(new Error(`Not a valid marker at offset 0x${u.toString(16)}, found: 0x${s.getUint8(u).toString(16)}`));return}if(p=s.getUint8(u+1),r&&console.log(`Marker: ${p.toString(16)}`),p===226){r&&console.log("Found APP2 marker (0xffe2)");const g=u+4;if(s.getUint32(g)===1297106432){const v=g+4;let _;if(s.getUint16(v)===18761)_=!1;else if(s.getUint16(v)===19789)_=!0;else{n(new Error("No valid endianness marker found in TIFF header"));return}if(s.getUint16(v+2,!_)!==42){n(new Error("Not valid TIFF data! (no 0x002A marker)"));return}const x=s.getUint32(v+4,!_);if(x<8){n(new Error("Not valid TIFF data! (First offset less than 8)"));return}const E=v+x,C=s.getUint16(E,!_),w=E+2;let T=0;for(let G=w;G<w+12*C;G+=12)s.getUint16(G,!_)===45057&&(T=s.getUint32(G+8,!_));const L=E+2+C*12+4,F=[];for(let G=L;G<L+T*16;G+=16){const k={MPType:s.getUint32(G,!_),size:s.getUint32(G+4,!_),dataOffset:s.getUint32(G+8,!_),dependantImages:s.getUint32(G+12,!_),start:-1,end:-1,isFII:!1};k.dataOffset?(k.start=v+k.dataOffset,k.isFII=!1):(k.start=0,k.isFII=!0),k.end=k.start+k.size,F.push(k)}if(this.options.extractNonFII&&F.length){const G=new Blob([s]),k=[];for(const O of F){if(O.isFII&&!this.options.extractFII)continue;const D=G.slice(O.start,O.end+1,"image/jpeg");k.push(D)}t(k)}}}u+=2+s.getUint16(u+2)}})}}const eK=async i=>{const e=ZJ(i);if(!e)throw new LO("Gain map XMP metadata not found");const n=await new $J({extractFII:!0,extractNonFII:!0}).extract(i);if(n.length!==2)throw new BO("Gain map recovery image not found");return{sdr:new Uint8Array(await n[0].arrayBuffer()),gainMap:new Uint8Array(await n[1].arrayBuffer()),metadata:e}},IN=i=>new Promise((e,t)=>{const n=document.createElement("img");n.onload=()=>{e(n)},n.onerror=r=>{t(r)},n.src=URL.createObjectURL(i)});class tK extends js{constructor(t,n){super(n);Ir(this,"_renderer");Ir(this,"_renderTargetOptions");Ir(this,"_internalLoadingManager");Ir(this,"_config");this._config=t,t.renderer&&(this._renderer=t.renderer),this._internalLoadingManager=new kS}setRenderer(t){return this._renderer=t,this}setRenderTargetOptions(t){return this._renderTargetOptions=t,this}prepareQuadRenderer(){this._renderer||console.warn("WARNING: A Renderer was not passed to this Loader constructor or in setRenderer, the result of this Loader will need to be converted to a Data Texture with toDataTexture() before you can use it in your renderer.");const t=this._config.createMaterial({gainMapMax:[1,1,1],gainMapMin:[0,0,0],gamma:[1,1,1],offsetHdr:[1,1,1],offsetSdr:[1,1,1],hdrCapacityMax:1,hdrCapacityMin:0,maxDisplayBoost:1,gainMap:new Ci,sdr:new Ci});return this._config.createQuadRenderer({width:16,height:16,type:Er,colorSpace:Xl,material:t,renderer:this._renderer,renderTargetOptions:this._renderTargetOptions})}async processImages(t,n,r){const s=n?new Blob([n],{type:"image/jpeg"}):void 0,o=new Blob([t],{type:"image/jpeg"});let u,f,p=!1;if(typeof createImageBitmap>"u"){const g=await Promise.all([s?IN(s):Promise.resolve(void 0),IN(o)]);f=g[0],u=g[1],p=r==="flipY"}else{const g=await Promise.all([s?createImageBitmap(s,{imageOrientation:r||"flipY"}):Promise.resolve(void 0),createImageBitmap(o,{imageOrientation:r||"flipY"})]);f=g[0],u=g[1]}return{sdrImage:u,gainMapImage:f,needsFlip:p}}createTextures(t,n,r){const s=new Ci(n||new ImageData(2,2),vf,Sr,Sr,Jn,wT,jr,vs,1,Xl);s.flipY=r,s.needsUpdate=!0;const o=new Ci(t,vf,Sr,Sr,Jn,wT,jr,vs,1,Fs);return o.flipY=r,o.needsUpdate=!0,{gainMap:s,sdr:o}}updateQuadRenderer(t,n,r,s,o){t.width=n.width,t.height=n.height,t.material.gainMap=r,t.material.sdr=s,t.material.gainMapMin=o.gainMapMin,t.material.gainMapMax=o.gainMapMax,t.material.offsetHdr=o.offsetHdr,t.material.offsetSdr=o.offsetSdr,t.material.gamma=o.gamma,t.material.hdrCapacityMin=o.hdrCapacityMin,t.material.hdrCapacityMax=o.hdrCapacityMax,t.material.maxDisplayBoost=Math.pow(2,o.hdrCapacityMax),t.material.needsUpdate=!0}}const nK=`
varying vec2 vUv;

void main() {
  vUv = uv;
  gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);
}
`,iK=`
// min half float value
#define HALF_FLOAT_MIN vec3( -65504, -65504, -65504 )
// max half float value
#define HALF_FLOAT_MAX vec3( 65504, 65504, 65504 )

uniform sampler2D sdr;
uniform sampler2D gainMap;
uniform vec3 gamma;
uniform vec3 offsetHdr;
uniform vec3 offsetSdr;
uniform vec3 gainMapMin;
uniform vec3 gainMapMax;
uniform float weightFactor;

varying vec2 vUv;

void main() {
  vec3 rgb = texture2D( sdr, vUv ).rgb;
  vec3 recovery = texture2D( gainMap, vUv ).rgb;
  vec3 logRecovery = pow( recovery, gamma );
  vec3 logBoost = gainMapMin * ( 1.0 - logRecovery ) + gainMapMax * logRecovery;
  vec3 hdrColor = (rgb + offsetSdr) * exp2( logBoost * weightFactor ) - offsetHdr;
  vec3 clampedHdrColor = max( HALF_FLOAT_MIN, min( HALF_FLOAT_MAX, hdrColor ));
  gl_FragColor = vec4( clampedHdrColor , 1.0 );
}
`;class rK extends Gs{constructor({gamma:t,offsetHdr:n,offsetSdr:r,gainMapMin:s,gainMapMax:o,maxDisplayBoost:u,hdrCapacityMin:f,hdrCapacityMax:p,sdr:g,gainMap:v}){super({name:"GainMapDecoderMaterial",vertexShader:nK,fragmentShader:iK,uniforms:{sdr:{value:g},gainMap:{value:v},gamma:{value:new ie(1/t[0],1/t[1],1/t[2])},offsetHdr:{value:new ie().fromArray(n)},offsetSdr:{value:new ie().fromArray(r)},gainMapMin:{value:new ie().fromArray(s)},gainMapMax:{value:new ie().fromArray(o)},weightFactor:{value:(Math.log2(u)-f)/(p-f)}},blending:Gl,depthTest:!1,depthWrite:!1});Ir(this,"_maxDisplayBoost");Ir(this,"_hdrCapacityMin");Ir(this,"_hdrCapacityMax");this._maxDisplayBoost=u,this._hdrCapacityMin=f,this._hdrCapacityMax=p,this.needsUpdate=!0,this.uniformsNeedUpdate=!0}get sdr(){return this.uniforms.sdr.value}set sdr(t){this.uniforms.sdr.value=t}get gainMap(){return this.uniforms.gainMap.value}set gainMap(t){this.uniforms.gainMap.value=t}get offsetHdr(){return this.uniforms.offsetHdr.value.toArray()}set offsetHdr(t){this.uniforms.offsetHdr.value.fromArray(t)}get offsetSdr(){return this.uniforms.offsetSdr.value.toArray()}set offsetSdr(t){this.uniforms.offsetSdr.value.fromArray(t)}get gainMapMin(){return this.uniforms.gainMapMin.value.toArray()}set gainMapMin(t){this.uniforms.gainMapMin.value.fromArray(t)}get gainMapMax(){return this.uniforms.gainMapMax.value.toArray()}set gainMapMax(t){this.uniforms.gainMapMax.value.fromArray(t)}get gamma(){const t=this.uniforms.gamma.value;return[1/t.x,1/t.y,1/t.z]}set gamma(t){const n=this.uniforms.gamma.value;n.x=1/t[0],n.y=1/t[1],n.z=1/t[2]}get hdrCapacityMin(){return this._hdrCapacityMin}set hdrCapacityMin(t){this._hdrCapacityMin=t,this.calculateWeight()}get hdrCapacityMax(){return this._hdrCapacityMax}set hdrCapacityMax(t){this._hdrCapacityMax=t,this.calculateWeight()}get maxDisplayBoost(){return this._maxDisplayBoost}set maxDisplayBoost(t){this._maxDisplayBoost=Math.max(1,Math.min(65504,t)),this.calculateWeight()}calculateWeight(){const t=(Math.log2(this._maxDisplayBoost)-this._hdrCapacityMin)/(this._hdrCapacityMax-this._hdrCapacityMin);this.uniforms.weightFactor.value=Math.max(0,Math.min(1,t))}}class OO extends tK{constructor(e,t){super({renderer:e,createMaterial:n=>new rK(n),createQuadRenderer:n=>new Zw(n)},t)}async render(e,t,n,r){const{sdrImage:s,gainMapImage:o,needsFlip:u}=await this.processImages(n,r,"flipY"),{gainMap:f,sdr:p}=this.createTextures(s,o,u);this.updateQuadRenderer(e,s,f,p,t),e.render()}}class sK extends OO{load([e,t,n],r,s,o){const u=this.prepareQuadRenderer();let f,p,g;const v=async()=>{if(f&&p&&g){try{await this.render(u,g,f,p)}catch(R){this.manager.itemError(e),this.manager.itemError(t),this.manager.itemError(n),typeof o=="function"&&o(R),u.disposeOnDemandRenderer();return}typeof r=="function"&&r(u),this.manager.itemEnd(e),this.manager.itemEnd(t),this.manager.itemEnd(n),u.disposeOnDemandRenderer()}};let _=!0,x=0,E=0,C=!0,w=0,T=0,N=!0,L=0,F=0;const G=()=>{if(typeof s=="function"){const R=x+w+L,P=E+T+F,z=_&&C&&N;s(new ProgressEvent("progress",{lengthComputable:z,loaded:P,total:R}))}};this.manager.itemStart(e),this.manager.itemStart(t),this.manager.itemStart(n);const k=new zs(this._internalLoadingManager);k.setResponseType("arraybuffer"),k.setRequestHeader(this.requestHeader),k.setPath(this.path),k.setWithCredentials(this.withCredentials),k.load(e,async R=>{if(typeof R=="string")throw new Error("Invalid sdr buffer");f=R,await v()},R=>{_=R.lengthComputable,E=R.loaded,x=R.total,G()},R=>{this.manager.itemError(e),typeof o=="function"&&o(R)});const O=new zs(this._internalLoadingManager);O.setResponseType("arraybuffer"),O.setRequestHeader(this.requestHeader),O.setPath(this.path),O.setWithCredentials(this.withCredentials),O.load(t,async R=>{if(typeof R=="string")throw new Error("Invalid gainmap buffer");p=R,await v()},R=>{C=R.lengthComputable,T=R.loaded,w=R.total,G()},R=>{this.manager.itemError(t),typeof o=="function"&&o(R)});const D=new zs(this._internalLoadingManager);return D.setRequestHeader(this.requestHeader),D.setPath(this.path),D.setWithCredentials(this.withCredentials),D.load(n,async R=>{if(typeof R!="string")throw new Error("Invalid metadata string");g=JSON.parse(R),await v()},R=>{N=R.lengthComputable,F=R.loaded,L=R.total,G()},R=>{this.manager.itemError(n),typeof o=="function"&&o(R)}),u}}class aK extends OO{load(e,t,n,r){const s=this.prepareQuadRenderer(),o=new zs(this._internalLoadingManager);return o.setResponseType("arraybuffer"),o.setRequestHeader(this.requestHeader),o.setPath(this.path),o.setWithCredentials(this.withCredentials),this.manager.itemStart(e),o.load(e,async u=>{if(typeof u=="string")throw new Error("Invalid buffer, received [string], was expecting [ArrayBuffer]");const f=new Uint8Array(u);let p,g,v;try{const _=await eK(f);p=_.sdr,g=_.gainMap,v=_.metadata}catch(_){if(_ instanceof LO||_ instanceof BO)console.warn(`Failure to reconstruct an HDR image from ${e}: Gain map metadata not found in the file, HDRJPGLoader will render the SDR jpeg`),v={gainMapMin:[0,0,0],gainMapMax:[1,1,1],gamma:[1,1,1],hdrCapacityMin:0,hdrCapacityMax:1,offsetHdr:[0,0,0],offsetSdr:[0,0,0]},p=f;else throw _}try{await this.render(s,v,p.buffer,g==null?void 0:g.buffer)}catch(_){this.manager.itemError(e),typeof r=="function"&&r(_),s.disposeOnDemandRenderer();return}typeof t=="function"&&t(s),this.manager.itemEnd(e),s.disposeOnDemandRenderer()},n,u=>{this.manager.itemError(e),typeof r=="function"&&r(u)}),s}}const ny={apartment:"lebombo_1k.hdr",city:"potsdamer_platz_1k.hdr",dawn:"kiara_1_dawn_1k.hdr",forest:"forest_slope_1k.hdr",lobby:"st_fagans_interior_1k.hdr",night:"dikhololo_night_1k.hdr",park:"rooitou_park_1k.hdr",studio:"studio_small_03_1k.hdr",sunset:"venice_sunset_1k.hdr",warehouse:"empty_warehouse_01_1k.hdr"},UO="https://raw.githack.com/pmndrs/drei-assets/456060a26bbeb8fdf79326f224b6d99b8bcce736/hdri/",Jm=i=>Array.isArray(i),$w=["/px.png","/nx.png","/py.png","/ny.png","/pz.png","/nz.png"];function WS({files:i=$w,path:e="",preset:t=void 0,colorSpace:n=void 0,extensions:r}={}){t&&(eC(t),i=ny[t],e=UO);const s=Jm(i),{extension:o,isCubemap:u}=tC(i),f=nC(o);if(!f)throw new Error("useEnvironment: Unrecognized file extension: "+i);const p=Hr(x=>x.gl);be.useLayoutEffect(()=>{if(o!=="webp"&&o!=="jpg"&&o!=="jpeg")return;function x(){Wu.clear(f,s?[i]:i)}p.domElement.addEventListener("webglcontextlost",x,{once:!0})},[i,p.domElement]);const g=Wu(f,s?[i]:i,x=>{(o==="webp"||o==="jpg"||o==="jpeg")&&x.setRenderer(p),x.setPath==null||x.setPath(e),r&&r(x)});let v=s?g[0]:g;if(o==="jpg"||o==="jpeg"||o==="webp"){var _;v=(_=v.renderTarget)==null?void 0:_.texture}return v.mapping=u?ql:rg,v.colorSpace=n??(u?"srgb":"srgb-linear"),v}const oK={files:$w,path:"",preset:void 0,extensions:void 0};WS.preload=i=>{const e={...oK,...i};let{files:t,path:n=""}=e;const{preset:r,extensions:s}=e;r&&(eC(r),t=ny[r],n=UO);const{extension:o}=tC(t);if(o==="webp"||o==="jpg"||o==="jpeg")throw new Error("useEnvironment: Preloading gainmaps is not supported");const u=nC(o);if(!u)throw new Error("useEnvironment: Unrecognized file extension: "+t);Wu.preload(u,Jm(t)?[t]:t,f=>{f.setPath==null||f.setPath(n),s&&s(f)})};const lK={files:$w,preset:void 0};WS.clear=i=>{const e={...lK,...i};let{files:t}=e;const{preset:n}=e;n&&(eC(n),t=ny[n]);const{extension:r}=tC(t),s=nC(r);if(!s)throw new Error("useEnvironment: Unrecognized file extension: "+t);Wu.clear(s,Jm(t)?[t]:t)};function eC(i){if(!(i in ny))throw new Error("Preset must be one of: "+Object.keys(ny).join(", "))}function tC(i){var e;const t=Jm(i)&&i.length===6,n=Jm(i)&&i.length===3&&i.some(o=>o.endsWith("json")),r=Jm(i)?i[0]:i;return{extension:t?"cube":n?"webp":r.startsWith("data:application/exr")?"exr":r.startsWith("data:application/hdr")?"hdr":r.startsWith("data:image/jpeg")?"jpg":(e=r.split(".").pop())==null||(e=e.split("?"))==null||(e=e.shift())==null?void 0:e.toLowerCase(),isCubemap:t,isGainmap:n}}function nC(i){return i==="cube"?BL:i==="hdr"?GJ:i==="exr"?jJ:i==="jpg"||i==="jpeg"?aK:i==="webp"?sK:null}const cK=i=>i.current&&i.current.isScene,uK=i=>cK(i)?i.current:i;function iC(i,e,t,n,r={}){var s,o,u,f;r={backgroundBlurriness:0,backgroundIntensity:1,backgroundRotation:[0,0,0],environmentIntensity:1,environmentRotation:[0,0,0],...r};const p=uK(e||t),g=p.background,v=p.environment,_={backgroundBlurriness:p.backgroundBlurriness,backgroundIntensity:p.backgroundIntensity,backgroundRotation:(s=(o=p.backgroundRotation)==null||o.clone==null?void 0:o.clone())!==null&&s!==void 0?s:[0,0,0],environmentIntensity:p.environmentIntensity,environmentRotation:(u=(f=p.environmentRotation)==null||f.clone==null?void 0:f.clone())!==null&&u!==void 0?u:[0,0,0]};return i!=="only"&&(p.environment=n),i&&(p.background=n),Bc(p,r),()=>{i!=="only"&&(p.environment=v),i&&(p.background=g),Bc(p,_)}}function rC({scene:i,background:e=!1,map:t,...n}){const r=Hr(s=>s.scene);return be.useLayoutEffect(()=>{if(t)return iC(e,i,r,t,n)}),null}function FO({background:i=!1,scene:e,blur:t,backgroundBlurriness:n,backgroundIntensity:r,backgroundRotation:s,environmentIntensity:o,environmentRotation:u,...f}){const p=WS(f),g=Hr(v=>v.scene);return be.useLayoutEffect(()=>iC(i,e,g,p,{backgroundBlurriness:t??n,backgroundIntensity:r,backgroundRotation:s,environmentIntensity:o,environmentRotation:u})),be.useEffect(()=>()=>{p.dispose()},[p]),null}function hK({children:i,near:e=.1,far:t=1e3,resolution:n=256,frames:r=1,map:s,background:o=!1,blur:u,backgroundBlurriness:f,backgroundIntensity:p,backgroundRotation:g,environmentIntensity:v,environmentRotation:_,scene:x,files:E,path:C,preset:w=void 0,extensions:T}){const N=Hr(D=>D.gl),L=Hr(D=>D.scene),F=be.useRef(null),[G]=be.useState(()=>new Ay),k=be.useMemo(()=>{const D=new _S(n);return D.texture.type=Er,D},[n]);be.useEffect(()=>()=>{k.dispose()},[k]),be.useLayoutEffect(()=>{if(r===1){const D=N.autoClear;N.autoClear=!0,F.current.update(N,G),N.autoClear=D}return iC(o,x,L,k.texture,{backgroundBlurriness:u??f,backgroundIntensity:p,backgroundRotation:g,environmentIntensity:v,environmentRotation:_})},[i,G,k.texture,x,L,o,r,N]);let O=1;return Ng(()=>{if(r===1/0||O<r){const D=N.autoClear;N.autoClear=!0,F.current.update(N,G),N.autoClear=D,O++}}),be.createElement(be.Fragment,null,mY(be.createElement(be.Fragment,null,i,be.createElement("cubeCamera",{ref:F,args:[e,t,k]}),E||w?be.createElement(FO,{background:!0,files:E,preset:w,path:C,extensions:T}):s?be.createElement(rC,{background:!0,map:s,extensions:T}):null),G))}function fK(i){var e,t,n,r;const s=WS(i),o=i.map||s;be.useMemo(()=>pO({GroundProjectedEnvImpl:QY}),[]),be.useEffect(()=>()=>{s.dispose()},[s]);const u=be.useMemo(()=>[o],[o]),f=(e=i.ground)==null?void 0:e.height,p=(t=i.ground)==null?void 0:t.radius,g=(n=(r=i.ground)==null?void 0:r.scale)!==null&&n!==void 0?n:1e3;return be.createElement(be.Fragment,null,be.createElement(rC,ap({},i,{map:o})),be.createElement("groundProjectedEnvImpl",{args:u,scale:g,height:f,radius:p}))}function dK(i){return i.ground?be.createElement(fK,i):i.map?be.createElement(rC,i):i.children?be.createElement(hK,i):be.createElement(FO,i)}const pK=be.forwardRef(({scale:i=10,frames:e=1/0,opacity:t=1,width:n=1,height:r=1,blur:s=1,near:o=0,far:u=10,resolution:f=512,smooth:p=!0,color:g="#000000",depthWrite:v=!1,renderOrder:_,...x},E)=>{const C=be.useRef(null),w=Hr(ce=>ce.scene),T=Hr(ce=>ce.gl),N=be.useRef(null);n=n*(Array.isArray(i)?i[0]:i||1),r=r*(Array.isArray(i)?i[1]:i||1);const[L,F,G,k,O,D,R]=be.useMemo(()=>{const ce=new _s(f,f),fe=new _s(f,f);fe.texture.generateMipmaps=ce.texture.generateMipmaps=!1;const te=new Xu(n,r).rotateX(Math.PI/2),se=new rr(te),Ae=new FS;Ae.depthTest=Ae.depthWrite=!1,Ae.onBeforeCompile=$=>{$.uniforms={...$.uniforms,ucolor:{value:new Gt(g)}},$.fragmentShader=$.fragmentShader.replace("void main() {",`uniform vec3 ucolor;
           void main() {
          `),$.fragmentShader=$.fragmentShader.replace("vec4( vec3( 1.0 - fragCoordZ ), opacity );","vec4( ucolor * fragCoordZ * 2.0, ( 1.0 - fragCoordZ ) * 1.0 );")};const Pe=new Gs(VJ),Re=new Gs(HJ);return Re.depthTest=Pe.depthTest=!1,[ce,te,Ae,se,Pe,Re,fe]},[f,n,r,i,g]),P=ce=>{k.visible=!0,k.material=O,O.uniforms.tDiffuse.value=L.texture,O.uniforms.h.value=ce*1/256,T.setRenderTarget(R),T.render(k,N.current),k.material=D,D.uniforms.tDiffuse.value=R.texture,D.uniforms.v.value=ce*1/256,T.setRenderTarget(L),T.render(k,N.current),k.visible=!1};let z=0,Y,j;return Ng(()=>{N.current&&(e===1/0||z<e)&&(z++,Y=w.background,j=w.overrideMaterial,C.current.visible=!1,w.background=null,w.overrideMaterial=G,T.setRenderTarget(L),T.render(w,N.current),P(s),p&&P(s*.4),T.setRenderTarget(null),C.current.visible=!0,w.overrideMaterial=j,w.background=Y)}),be.useImperativeHandle(E,()=>C.current,[]),be.createElement("group",ap({"rotation-x":Math.PI/2},x,{ref:C}),be.createElement("mesh",{renderOrder:_,geometry:F,scale:[1,-1,1],rotation:[-Math.PI/2,0,0]},be.createElement("meshBasicMaterial",{transparent:!0,map:L.texture,opacity:t,depthWrite:v})),be.createElement("orthographicCamera",{ref:N,args:[-n/2,n/2,r/2,-r/2,o,u]}))}),mK="https://raw.githubusercontent.com/mrdoob/three.js/dev/examples/models/gltf/Xbot.glb",gK=({point:i,onClick:e,isHighlighted:t})=>V.jsxs("group",{position:[i.position.x,i.position.y,i.position.z],children:[V.jsxs("mesh",{onClick:n=>{n.stopPropagation(),e(i)},children:[V.jsx("sphereGeometry",{args:[t?.035:.02,16,16]}),V.jsx("meshStandardMaterial",{color:t?"#ff0000":"#2563eb",emissive:t?"#ff0000":"#2563eb",emissiveIntensity:t?2:.8,transparent:!t,opacity:t?1:.6})]}),V.jsxs("mesh",{rotation:[Math.PI/2,0,0],children:[V.jsx("ringGeometry",{args:[.035,.045,32]}),V.jsx("meshBasicMaterial",{color:t?"#ff0000":"#94a3b8",transparent:!0,opacity:t?.8:.3})]}),t&&V.jsx(AO,{distanceFactor:5,position:[.06,.06,0],children:V.jsx("div",{className:"bg-white/95 text-slate-900 px-3 py-1.5 rounded-lg border-2 border-red-500 text-[10px] font-black whitespace-nowrap shadow-2xl backdrop-blur-sm animate-bounce",children:i.code})})]}),vK=({url:i})=>{const{scene:e}=jS(i);return be.useMemo(()=>{e.traverse(u=>{if(u.isMesh){const f=u;if(f.castShadow=!0,f.receiveShadow=!0,f.material){const p=new Cg({color:"#e2e8f0",roughness:.6,metalness:.1,flatShading:!1});f.material=p}}});const t=new xs().setFromObject(e),n=t.getSize(new ie),r=t.getCenter(new ie),o=1.8/n.y;e.scale.setScalar(o),e.position.x=-r.x*o,e.position.y=-t.min.y*o,e.position.z=-r.z*o},[e]),V.jsx("primitive",{object:e})},yK=()=>V.jsx(AO,{center:!0,children:V.jsxs("div",{className:"flex flex-col items-center gap-4 whitespace-nowrap",children:[V.jsx("div",{className:"w-12 h-12 border-4 border-red-500 border-t-transparent rounded-full animate-spin"}),V.jsx("div",{className:"bg-white/95 px-6 py-3 rounded-2xl border border-slate-200 shadow-2xl backdrop-blur-sm",children:V.jsx("p",{className:"text-slate-600 font-bold text-xs uppercase tracking-widest text-center",children:"Loading Anatomy"})})]})}),_K=({protocol:i,onPointSelect:e,activePointId:t,isRolling:n})=>{const r=be.useRef(null);return Ng((s,o)=>{n&&r.current&&(r.current.rotation.y+=o*.4)}),V.jsxs(V.Fragment,{children:[V.jsx(JJ,{makeDefault:!0,position:[0,1.2,4],fov:40}),V.jsx(KJ,{enablePan:!1,minDistance:1.2,maxDistance:6,target:[0,1,0],makeDefault:!0}),V.jsx("ambientLight",{intensity:1.5}),V.jsx("directionalLight",{position:[10,10,10],intensity:1.2,castShadow:!0}),V.jsx("directionalLight",{position:[-10,5,5],intensity:.8}),V.jsxs(be.Suspense,{fallback:V.jsx(yK,{}),children:[V.jsxs("group",{ref:r,children:[V.jsx(vK,{url:mK}),i==null?void 0:i.points.map(s=>V.jsx(gK,{point:s,onClick:e,isHighlighted:t===s.id},s.id))]}),V.jsx(dK,{preset:"city"}),V.jsx(pK,{position:[0,0,0],opacity:.3,scale:15,blur:3,far:10,resolution:512,color:"#000000"})]}),V.jsx("gridHelper",{args:[20,50,14870768,15857145],position:[0,-.01,0]})]})},xK=({patient:i,protocol:e,onSave:t,onBack:n,saveStatus:r,onFinish:s})=>{const[o,u]=be.useState(null),[f,p]=be.useState(!0),[g,v]=be.useState(null),[_,x]=be.useState([]),[E,C]=be.useState(null),[w,T]=be.useState(!0),[N,L]=be.useState(""),F=be.useCallback(async()=>{p(!0),v(null);try{const D=e.points;if(!D||D.length===0){u({...e,points:[]});return}const R=D.map(Y=>jM(vo(Nr,"acupuncture_points",Y))),z=(await Promise.all(R)).map(Y=>{if(!Y.exists())throw new Error(`Point with ID ${Y.id} not found.`);const j=Y.data();return(!j.position||j.position.x===void 0||j.position.y===void 0||j.position.z===void 0)&&console.warn(`Point ${Y.id} is missing 3D coordinate data.`),{...j,id:Y.id}});u({...e,points:z})}catch(D){console.error("Error hydrating protocol:",D);const R=D instanceof Error?D.message:"An unknown error occurred.";v(`Failed to load 3D model data. ${R}`)}finally{p(!1)}},[e]);be.useEffect(()=>{F()},[F]);const G=be.useCallback(D=>{_.some(R=>R.id===D.id)||x(R=>[...R,D]),C(D.id)},[_]),k=D=>{x(_.filter(R=>R.id!==D)),E===D&&C(null)},O=()=>{const D=_.map(R=>R.id);t(D,N)};return f?V.jsxs("div",{className:"flex justify-center items-center h-96",children:[V.jsx(jv,{className:"animate-spin h-10 w-10 text-red-500"}),V.jsx("p",{className:"ml-4 text-slate-500",children:"Loading protocol points..."})]}):g?V.jsxs("div",{className:"text-center p-8 bg-white rounded-3xl shadow-lg border border-slate-100 max-w-lg mx-auto",children:[V.jsx(my,{className:"mx-auto h-12 w-12 text-yellow-400"}),V.jsx("h3",{className:"mt-4 text-lg font-bold text-slate-800",children:"Error Loading Data"}),V.jsx("p",{className:"mt-2 text-sm text-slate-600",children:g}),V.jsx("p",{className:"mt-2 text-xs text-slate-500",children:"Please ensure all points in the protocol exist in the database and have valid coordinate data."}),V.jsx("button",{onClick:n,className:"mt-6 bg-slate-800 text-white font-bold py-2 px-6 rounded-lg",children:"Back"})]}):V.jsxs("div",{className:"max-w-full mx-auto animate-fade-in px-4",children:[V.jsxs("div",{className:"flex justify-between items-center mb-4",children:[V.jsxs("div",{children:[V.jsx("h2",{className:"text-3xl font-black text-slate-900 tracking-tighter",children:"Perform Treatment"}),V.jsxs("p",{className:"text-slate-500",children:["For: ",V.jsx("span",{className:"font-bold",children:i.fullName})," | Protocol: ",V.jsx("span",{className:"font-bold",children:e.name})]})]}),V.jsx("button",{onClick:n,className:"text-sm font-bold text-slate-600 hover:text-slate-900",children:"Back"})]}),V.jsxs("div",{className:"grid grid-cols-12 gap-4",children:[V.jsxs("div",{className:"col-span-3 bg-white rounded-3xl p-6 border border-slate-100 shadow-lg flex flex-col",children:[V.jsxs("div",{className:"flex justify-between items-center mb-2",children:[V.jsxs("h3",{className:"text-lg font-black text-slate-900 tracking-tighter flex items-center",children:[V.jsx(hB,{size:20,className:"mr-2"})," Protocol Points"]}),V.jsxs("label",{htmlFor:"autorotate",className:"flex items-center cursor-pointer",children:[V.jsx("span",{className:"text-sm font-bold text-slate-600 mr-2",children:"Auto-Rotate"}),V.jsxs("div",{className:"relative",children:[V.jsx("input",{id:"autorotate",type:"checkbox",className:"sr-only",checked:w,onChange:()=>T(!w)}),V.jsx("div",{className:`block w-10 h-6 rounded-full ${w?"bg-red-500":"bg-slate-300"}`}),V.jsx("div",{className:`dot absolute left-1 top-1 bg-white w-4 h-4 rounded-full transition-transform ${w?"translate-x-full":""}`})]})]})]}),V.jsx("p",{className:"text-xs text-slate-500 mb-3",children:"Hover to find, click to add."}),V.jsx("div",{className:"flex-grow space-y-2 overflow-y-auto pr-1",children:o==null?void 0:o.points.map(D=>V.jsxs("div",{onMouseEnter:()=>C(D.id),onMouseLeave:()=>C(null),onClick:()=>G(D),className:`flex justify-between items-center p-2 rounded-lg border-2 transition-all cursor-pointer ${E===D.id?"bg-red-100 border-red-300":"bg-white border-slate-200 hover:border-red-400"}`,children:[V.jsxs("div",{children:[V.jsx("span",{className:"font-bold text-red-600 text-sm",children:D.code}),V.jsxs("span",{className:"text-slate-600 text-xs",children:[" - ",D.label]})]}),_.some(R=>R.id===D.id)&&V.jsx(MI,{size:16,className:"text-green-500"})]},D.id))})]}),V.jsx("div",{className:"col-span-6 bg-white rounded-3xl p-2 border border-slate-100 shadow-lg h-[650px] relative",children:V.jsx(wY,{className:"bg-slate-50 rounded-2xl",children:V.jsx(_K,{protocol:o,onPointSelect:G,activePointId:E,isRolling:w})})}),V.jsxs("div",{className:"col-span-3 bg-white rounded-3xl p-6 border border-slate-100 shadow-lg flex flex-col",children:[V.jsxs("h3",{className:"text-lg font-black text-slate-900 tracking-tighter flex items-center mb-2",children:[V.jsx(d9,{size:20,className:"mr-2"}),"Treatment Data"]}),V.jsxs("div",{className:"flex-grow flex flex-col mb-4",children:[V.jsxs("label",{className:"text-[10px] font-bold text-slate-500 uppercase",children:["Stung Points (",_.length,")"]}),V.jsx("div",{className:"mt-1 p-3 min-h-[12rem] max-h-[12rem] overflow-y-auto bg-slate-50 border border-slate-200 rounded-xl text-sm space-y-2",children:_.length>0?_.map(D=>V.jsxs("div",{onClick:()=>C(D.id),className:`flex justify-between items-center p-2 rounded-lg border transition-all cursor-pointer ${E===D.id?"bg-red-100 border-red-300":"bg-white border-slate-200 hover:border-red-400"}`,children:[V.jsxs("div",{children:[V.jsx("span",{className:"font-bold text-red-600",children:D.code})," - ",V.jsx("span",{className:"font-semibold text-slate-800",children:D.label})]}),V.jsx("button",{onClick:R=>{R.stopPropagation(),k(D.id)},className:"text-red-500 hover:text-red-700",children:V.jsx(rS,{size:16})})]},D.id)):V.jsx("p",{className:"text-slate-400 text-center py-10",children:"No points stung yet."})})]}),V.jsxs("div",{className:"mb-4",children:[V.jsx("label",{className:"text-[10px] font-bold text-slate-500 uppercase",htmlFor:"finalNotes",children:"Final Notes"}),V.jsx("textarea",{id:"finalNotes",value:N,onChange:D=>L(D.target.value),className:"w-full p-3 mt-1 bg-slate-50 border border-slate-200 rounded-xl",rows:4,placeholder:"Add any final observations..."})]}),V.jsxs("div",{className:"mt-auto",children:[r==="error"&&V.jsxs("div",{className:"text-red-600 text-xs mb-2 flex items-center",children:[V.jsx(n9,{size:14,className:"mr-1"})," Failed to save."]}),r==="success"&&V.jsxs("div",{className:"text-green-600 text-xs mb-2 flex items-center",children:[V.jsx(MI,{size:14,className:"mr-1"})," Saved successfully."]}),r==="success"?V.jsx("button",{onClick:s,className:"w-full bg-green-500 hover:bg-green-700 text-white font-bold py-3 px-8 rounded-xl transition",children:"Back to Dashboard"}):V.jsx("button",{onClick:O,disabled:r==="saving"||_.length===0,className:"w-full bg-red-600 hover:bg-red-700 text-white font-bold py-3 px-8 rounded-xl transition shadow-lg shadow-red-500/20 disabled:bg-slate-300 disabled:shadow-none",children:r==="saving"?"Saving...":"Save Final Treatment"})]})]})]})]})},bK=({patient:i,onBack:e})=>{const[t,n]=be.useState([]),[r,s]=be.useState(!0),[o,u]=be.useState(null),f=be.useCallback(async()=>{s(!0),u(null);try{const g=Lc(Nr,`patients/${i.id}/treatments`),v=hb(g,P5("date","desc")),x=(await cf(v)).docs.map(L=>({id:L.id,...L.data()})),E=x.reduce((L,F)=>(Array.isArray(F.stungPoints)&&F.stungPoints.forEach(G=>L.add(G)),L),new Set);if(E.size===0){n(x.map(L=>({...L,stungPoints:[]}))),s(!1);return}const C=Array.from(E).map(L=>jM(vo(Nr,"acupuncture_points",L))),w=await Promise.all(C),T=new Map;w.forEach(L=>{L.exists()&&T.set(L.id,{id:L.id,...L.data()})});const N=x.map(L=>{const F=(Array.isArray(L.stungPoints)?L.stungPoints:[]).map(G=>T.get(G)).filter(G=>G!==void 0);return{...L,stungPoints:F}});n(N)}catch(g){console.error("Error fetching treatment history:",g),u("Failed to load treatment history.")}finally{s(!1)}},[i.id]);be.useEffect(()=>{f()},[f]);const p=g=>{if(!g)return"N/A";try{return new Date(g).toLocaleString(void 0,{year:"numeric",month:"numeric",day:"numeric",hour:"2-digit",minute:"2-digit"})}catch{return"Invalid Date"}};return r?V.jsxs("div",{className:"flex justify-center items-center h-64",children:[V.jsx(jv,{className:"animate-spin h-8 w-8 text-red-500"}),V.jsx("p",{className:"ml-3 text-slate-500",children:"Loading Treatment History..."})]}):o?V.jsxs("div",{className:"text-center p-8 bg-white rounded-3xl shadow-lg border border-slate-100 max-w-lg mx-auto",children:[V.jsx(my,{className:"mx-auto h-12 w-12 text-yellow-400"}),V.jsx("h3",{className:"mt-4 text-lg font-bold text-slate-800",children:"Error"}),V.jsx("p",{className:"mt-2 text-sm text-slate-600",children:o}),V.jsx("button",{onClick:e,className:"mt-6 bg-slate-800 text-white font-bold py-2 px-6 rounded-lg",children:"Back"})]}):V.jsxs("div",{className:"max-w-4xl mx-auto p-4 animate-fade-in",children:[V.jsxs("div",{className:"flex items-center mb-6",children:[V.jsx("button",{onClick:e,className:"p-2 rounded-full hover:bg-slate-200 mr-4",children:V.jsx(XM,{})}),V.jsxs("h1",{className:"text-3xl font-black text-slate-900 tracking-tighter",children:["Treatment History for ",i.fullName]})]}),t.length===0?V.jsx("p",{className:"text-center text-slate-500 py-10 bg-white rounded-3xl shadow-md border border-slate-100",children:"No treatments recorded for this patient."}):V.jsx("div",{className:"space-y-6",children:t.map(g=>V.jsxs("div",{className:"bg-white p-8 rounded-3xl shadow-lg border border-slate-100",children:[V.jsxs("div",{className:"flex justify-between items-start mb-6",children:[V.jsx("h2",{className:"text-2xl font-bold text-slate-800 tracking-tight",children:g.protocolName}),V.jsxs("div",{className:"text-right",children:[V.jsxs("div",{className:"flex items-center justify-end text-sm text-slate-500 gap-2",children:[V.jsx(lB,{size:16}),V.jsx("span",{children:p(g.date)})]}),V.jsxs("div",{className:"flex items-center justify-end text-xs text-slate-400 gap-2 mt-1",children:[V.jsx(JM,{size:14}),V.jsx("span",{children:g.caretakerId})]})]})]}),V.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-8 mb-6",children:[V.jsxs("div",{className:"space-y-1",children:[V.jsxs("h3",{className:"font-bold text-slate-500 text-sm uppercase tracking-wider flex items-center",children:[V.jsx(bT,{size:16,className:"mr-2"}),"Patient Report"]}),V.jsx("p",{className:"p-3 bg-slate-50 rounded-lg text-slate-800 h-24 overflow-y-auto",children:g.patientReport||"Not provided"})]}),V.jsxs("div",{className:"space-y-1",children:[V.jsxs("h3",{className:"font-bold text-slate-500 text-sm uppercase tracking-wider flex items-center",children:[V.jsx(G5,{size:16,className:"mr-2"}),"Vitals"]}),V.jsx("p",{className:"p-3 bg-slate-50 rounded-lg text-slate-800",children:g.vitals||"Not provided"})]})]}),V.jsxs("div",{className:"mb-6",children:[V.jsxs("h3",{className:"font-bold text-slate-500 text-sm uppercase tracking-wider flex items-center mb-2",children:[V.jsx(A9,{size:16,className:"mr-2"}),"Stung Points"]}),V.jsx("ul",{className:"p-4 bg-slate-50 rounded-lg space-y-2",children:g.stungPoints.length>0?g.stungPoints.map(v=>V.jsx("li",{className:"flex items-center justify-between text-slate-700",children:V.jsxs("div",{className:"flex items-center gap-3",children:[V.jsx(h9,{size:16,className:"text-red-500"}),V.jsxs("span",{className:"text-sm",children:[V.jsx("span",{className:"font-bold text-red-700",children:v.code})," - ",V.jsx("span",{className:"text-slate-800 font-semibold",children:v.label})]})]})},v.id)):V.jsx("li",{children:"No points were recorded for this treatment."})})]}),V.jsxs("div",{children:[V.jsxs("h3",{className:"font-bold text-slate-500 text-sm uppercase tracking-wider flex items-center",children:[V.jsx(bT,{size:16,className:"mr-2"}),"Final Notes"]}),V.jsx("p",{className:"p-3 mt-1 bg-slate-50 rounded-lg text-slate-800 min-h-[5rem] overflow-y-auto",children:g.finalNotes||"No notes."})]})]},g.id))})]})},AK=({user:i,onSave:e,onBack:t})=>{const[n,r]=be.useState(i),[s,o]=be.useState(null),u=p=>{const{name:g,value:v}=p.target;r(_=>({..._,[g]:v}))},f=()=>{if(!n.fullName.trim()){o("Full name is required.");return}if(!n.mobile.trim()){o("Mobile number is required.");return}o(null),e(n)};return V.jsxs("div",{className:"max-w-4xl mx-auto animate-fade-in",children:[V.jsx("h2",{className:"text-3xl font-black text-slate-900 tracking-tighter",children:"My Profile"}),V.jsxs("div",{className:"mt-6 bg-white rounded-3xl p-8 border border-slate-100 shadow-lg",children:[s&&V.jsx("p",{className:"bg-red-100 text-red-700 p-3 rounded-lg text-sm mb-4",children:s}),V.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[V.jsxs("div",{children:[V.jsx("label",{className:"text-sm font-bold text-slate-500 uppercase",htmlFor:"fullName",children:"Full Name"}),V.jsx("input",{id:"fullName",name:"fullName",type:"text",value:n.fullName,onChange:u,className:"w-full p-3 mt-1 bg-slate-50 border border-slate-200 rounded-xl",required:!0})]}),V.jsxs("div",{children:[V.jsx("label",{className:"text-sm font-bold text-slate-500 uppercase",htmlFor:"email",children:"Email"}),V.jsx("p",{style:{cursor:"not-allowed"},className:"w-full p-3 mt-1 bg-slate-100 border border-slate-200 rounded-xl text-slate-600",children:n.email})]}),V.jsxs("div",{children:[V.jsx("label",{className:"text-sm font-bold text-slate-500 uppercase",htmlFor:"mobile",children:"Mobile"}),V.jsx("input",{id:"mobile",name:"mobile",type:"text",value:n.mobile,onChange:u,className:"w-full p-3 mt-1 bg-slate-50 border border-slate-200 rounded-xl",required:!0})]}),V.jsxs("div",{children:[V.jsx("label",{className:"text-sm font-bold text-slate-500 uppercase",htmlFor:"userId",children:"User ID"}),V.jsx("p",{style:{cursor:"not-allowed"},className:"w-full p-3 mt-1 bg-slate-100 border border-slate-200 rounded-xl text-slate-600",children:n.userId})]}),V.jsxs("div",{children:[V.jsx("label",{className:"text-sm font-bold text-slate-500 uppercase",children:"Role"}),V.jsx("p",{style:{cursor:"not-allowed"},className:"w-full p-3 mt-1 bg-slate-100 border border-slate-200 rounded-xl text-slate-600 capitalize",children:n.role})]})]}),V.jsxs("div",{className:"flex justify-end mt-8 space-x-4",children:[V.jsx("button",{onClick:t,className:"text-sm font-bold text-slate-600 hover:text-slate-900 transition",children:"Back to Dashboard"}),V.jsx("button",{onClick:f,className:"bg-yellow-500 hover:bg-yellow-400 text-slate-900 font-bold py-3 px-8 rounded-xl transition shadow-lg shadow-yellow-500/10",children:"Save Changes"})]})]})]})},SK=()=>{const[i,e]=be.useState(null),[t,n]=be.useState([]),[r,s]=be.useState(null),[o,u]=be.useState(null),[f,p]=be.useState({report:"",bloodPressure:"",heartRate:""}),[g,v]=be.useState("dashboard"),[_,x]=be.useState(!0),[E,C]=be.useState(!1),[w,T]=be.useState("idle"),[N,L]=be.useState(""),F=async ae=>{const Se=vo(Nr,"users",ae.uid),ke=await jM(Se);if(ke.exists())return{uid:ae.uid,...ke.data()};{const dt={uid:ae.uid,userId:ae.uid,email:ae.email||"",fullName:ae.displayName||"New User",displayName:ae.displayName||"New User",mobile:"",role:"caretaker"};return await db(Se,dt),dt}},G=be.useCallback(async ae=>{if(!(!ae||!ae.userId)){x(!0);try{const Se=hb(Lc(Nr,"patients"),VE("caretakerId","==",ae.userId)),dt=(await cf(Se)).docs.map(ve=>({id:ve.id,...ve.data()}));n(dt)}catch(Se){console.error("Error fetching patient data:",Se)}finally{x(!1)}}},[]);be.useEffect(()=>{const ae=ik(xT,async Se=>{if(Se){const ke=await F(Se);e(ke)}else e(null),n([]);C(!0)});return()=>ae()},[]),be.useEffect(()=>{i&&G(i)},[i,G]);const k=async()=>{await rk(xT)},O=()=>{v("admin_protocols")},D=()=>{v("admin_points")},R=()=>{v("user_details")},P=async ae=>{if(!i)return;T("saving");const Se=vo(Nr,"users",i.uid),{uid:ke,...dt}=ae;await WM(Se,dt),e(ae),T("idle"),v("dashboard")},z=ae=>{s(ae),v("patient_details")},Y=()=>{if(!i)return;const ae={id:`p${Date.now()}`,fullName:"",birthDate:"",identityNumber:"",email:"",mobile:"",condition:"",severity:"Mild",caretakerId:i.userId};s(ae),v("patient_details")},j=async ae=>{if(!i)return;T("saving"),L("");const Se=hb(Lc(Nr,"patients"),VE("identityNumber","==",ae.identityNumber)),ke=hb(Lc(Nr,"patients"),VE("email","==",ae.email)),dt=await cf(Se),ve=await cf(ke);if(dt.docs.find(_t=>_t.id!==ae.id)){const _t=`Error: A patient with identity number '${ae.identityNumber}' already exists.`;console.error(_t),L(_t),T("error");return}if(ve.docs.find(_t=>_t.id!==ae.id)){const _t=`Error: A patient with email '${ae.email}' already exists.`;console.error(_t),L(_t),T("error");return}await db(vo(Nr,"patients",ae.id),ae,{merge:!0}),i&&await G(i),s(null),v("dashboard"),T("idle")},ce=async ae=>{if(i)try{await qM(vo(Nr,"patients",ae)),i&&await G(i)}catch(Se){console.error("Error deleting patient:",Se)}},fe=()=>{s(null),u(null),p({report:"",bloodPressure:"",heartRate:""}),v("dashboard"),T("idle"),L("")},te=()=>{r&&v("protocol_selection")},se=ae=>{s(ae),v("protocol_selection")},Ae=ae=>{s(ae),v("treatment_history")},Pe=ae=>{u(ae),v("treatment_execution")},Re=async(ae,Se)=>{if(!(!r||!o||!i)){T("saving");try{const ke={date:new Date().toISOString(),protocolId:o.id,protocolName:o.name,patientReport:f.report,vitals:`BP: ${f.bloodPressure}, HR: ${f.heartRate}`,stungPoints:ae,finalNotes:Se,caretakerId:i.userId};await sB(Lc(Nr,`patients/${r.id}/treatments`),ke),await db(vo(Nr,"patients",r.id),{lastTreatment:new Date().toISOString().split("T")[0]},{merge:!0}),i&&await G(i),T("success")}catch(ke){console.error("Error saving new treatment:",ke),T("error")}}},$=()=>E?i?_?V.jsx("div",{className:"flex justify-center items-center h-screen",children:V.jsx("div",{children:"Loading Patient Data..."})}):V.jsxs("div",{className:"flex min-h-screen bg-slate-50",children:[V.jsx(P9,{user:i,onLogout:k,onAdminClick:O,onPointsAdminClick:D,onUserDetailsClick:R,onPatientsClick:fe}),V.jsx("main",{className:"flex-grow p-4 md:p-8",children:(()=>{switch(g){case"user_details":return V.jsx(AK,{user:i,onSave:P,onBack:fe});case"patient_details":return r&&i&&V.jsx(N9,{user:i,patient:r,onSave:j,onBack:fe,onStartTreatment:te,saveStatus:w,errorMessage:N});case"protocol_selection":return r&&V.jsx(U9,{patient:r,onBack:fe,onProtocolSelect:Pe,treatmentNotes:f,setTreatmentNotes:p});case"treatment_execution":return r&&o&&V.jsx(xK,{patient:r,protocol:o,onSave:Re,onBack:()=>v("protocol_selection"),saveStatus:w,onFinish:fe});case"treatment_history":return r&&V.jsx(bK,{patient:r,onBack:fe});case"admin_protocols":return V.jsx(B9,{});case"admin_points":return V.jsx(L9,{});default:return V.jsx(R9,{user:i,patients:t,onAddPatient:Y,onUpdatePatient:z,onShowTreatments:Ae,onStartTreatment:se,onDeletePatient:ce})}})()})]}):V.jsx(C9,{}):V.jsx("div",{className:"flex justify-center items-center h-screen",children:V.jsx("div",{children:"Initializing..."})});return V.jsx(V.Fragment,{children:$()})},kO=document.getElementById("root");if(!kO)throw new Error("Could not find root element to mount to");const EK=IU.createRoot(kO);EK.render(V.jsx(OA.StrictMode,{children:V.jsx(SK,{})}));
